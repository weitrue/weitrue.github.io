<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>【Linux】Docker安装与使用</title>
    <link href="/2020/06/24/Docker%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8/"/>
    <url>/2020/06/24/Docker%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8/</url>
    
    <content type="html"><![CDATA[<p><img src="/images/Mac%E7%94%B5%E8%84%91%E4%BD%BF%E7%94%A8/mac.jpg" srcset="/img/loading.gif" alt><a id="more"></a> </p><p><strong>Docker安装与使用</strong></p><p><strong>官方文档</strong></p><p><a href="https://links.jianshu.com/go?to=https%3A%2F%2Fdocs.docker.com%2Finstall%2Flinux%2Fdocker-ce%2Fcentos%2F" target="_blank" rel="noopener">https://docs.docker.com/install/linux/docker-ce/centos/</a></p><p><strong>安装方式</strong></p><ul><li>设置docker源的方式来安装(简单， 官方推荐)</li><li>下载rpm包的方式安装(适用于离线环境)</li><li>使用脚本安装(适用于测试和开发环境)</li></ul><p><strong>docker源方式安装</strong></p><p>（1）更新yum， 安装依赖</p><pre><code class="hljs sql">yum <span class="hljs-keyword">update</span>yum <span class="hljs-keyword">install</span> -y yum-utils device-mapper-persistent-<span class="hljs-keyword">data</span> lvm2</code></pre><p><img src="/images/Docker%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8/1.png" srcset="/img/loading.gif" alt></p><p>（2）将docker源添加到系统中</p><pre><code class="hljs vim">yum-config-manager --<span class="hljs-built_in">add</span>-repo http<span class="hljs-variable">s:</span>//download.docker.<span class="hljs-keyword">com</span>/linux/centos/docker-<span class="hljs-keyword">ce</span>.repo</code></pre><p><img src="/images/Docker%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8/1-1.png" srcset="/img/loading.gif" alt></p><p>（3）Docker安装</p><pre><code class="hljs vim">yum install docker-<span class="hljs-keyword">ce</span> docker-<span class="hljs-keyword">ce</span>-cli containerd.io</code></pre><p>此时，可能会报错：</p><p><img src="/images/Docker%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8/2.png" srcset="/img/loading.gif" alt></p><p>该图中原因是</p><p>containerd.io此软件包已经安装，并且是较低版本，与要安装的docker-ce所依赖containerd.io的版本不符，因此最好安装较新版本的containerd.io</p><pre><code class="hljs crystal"><span class="hljs-comment"># 下面网址可以看到一系列版本的containerd.io</span><span class="hljs-symbol">https:</span>/<span class="hljs-regexp">/download.docker.com/linux</span><span class="hljs-regexp">/centos/</span><span class="hljs-number">7</span>/x86_64/edge/Packages/<span class="hljs-comment">#wget 命令下载指定版本的containerd.io（如果未安装wget，需要yum -y install wget）</span>wget <span class="hljs-symbol">https:</span>/<span class="hljs-regexp">/download.docker.com/linux</span><span class="hljs-regexp">/centos/</span><span class="hljs-number">7</span>/x86_64/edge/Packages/containerd.io-<span class="hljs-number">1.2</span>.<span class="hljs-number">6</span>-<span class="hljs-number">3.3</span>.el7.x86_64.rpm</code></pre><p><img src="/images/Docker%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8/3.png" srcset="/img/loading.gif" alt></p><p> 重新安装Docker</p><pre><code class="hljs cmake">yum -y <span class="hljs-keyword">install</span> docker-ce</code></pre><p><img src="/images/Docker%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8/4.png" srcset="/img/loading.gif" alt></p><p>（4）Docker启动设置-—启动docker和添加开启自启动</p><pre><code class="hljs pgsql">systemctl <span class="hljs-keyword">enable</span> dockersystemctl <span class="hljs-keyword">start</span> docker</code></pre><p><img src="/images/Docker%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8/5.png" srcset="/img/loading.gif" alt></p><p>（5）查看Docker版本</p><pre><code class="hljs ebnf"><span class="hljs-attribute">docker -v</span></code></pre><p><strong>3. Docker使用</strong></p><p><strong>3.1 docker命令</strong></p><p>（1）命令帮助（-h已被弃用）</p><pre><code class="hljs ada">docker <span class="hljs-comment">--help</span></code></pre><p>（2）常用选项说明</p><ul><li><p>-d, –detach=false， 指定容器运行于前台还是后台，默认为false</p></li><li><p>-i, –interactive=false， 打开STDIN，用于控制台交互</p></li><li><p>-t, –tty=false， 分配tty设备，该可以支持终端登录，默认为false</p></li><li><p>-u, –user=””， 指定容器的用户</p></li><li><p>-a, –attach=[]， 登录容器（必须是以docker run -d启动的容器）</p></li><li><p>-w, –workdir=””， 指定容器的工作目录</p></li><li><p>-c, –cpu-shares=0， 设置容器CPU权重，在CPU共享场景使用</p></li><li><p>-e, –env=[]， 指定环境变量，容器中可以使用该环境变量</p></li><li><p>-m, –memory=””， 指定容器的内存上限</p></li><li><p>-P, –publish-all=false， 指定容器暴露的端口</p></li><li><p>-p, –publish=[]， 指定容器暴露的端口</p></li><li><p>-h, –hostname=””， 指定容器的主机名</p></li><li><p>-v, –volume=[]， 给容器挂载存储卷，挂载到容器的某个目录</p></li><li><p>–volumes-from=[]， 给容器挂载其他容器上的卷，挂载到容器的某个目录</p></li><li><p>–cap-add=[]， 添加权限，权限清单详见：<a href="http://linux.die.net/man/7/capabilities" target="_blank" rel="noopener">http://linux.die.net/man/7/capabilities</a></p></li><li><p>–cap-drop=[]， 删除权限，权限清单详见：<a href="http://linux.die.net/man/7/capabilities" target="_blank" rel="noopener">http://linux.die.net/man/7/capabilities</a></p></li><li><p>–cidfile=””， 运行容器后，在指定文件中写入容器PID值，一种典型的监控系统用法</p></li><li><p>–cpuset=””， 设置容器可以使用哪些CPU，此参数可以用来容器独占CPU</p></li><li><p>–device=[]， 添加主机设备给容器，相当于设备直通</p></li><li><p>–dns=[]， 指定容器的dns服务器</p></li><li><p>–dns-search=[]， 指定容器的dns搜索域名，写入到容器的/etc/resolv.conf文件</p></li><li><p>–entrypoint=””， 覆盖image的入口点</p></li><li><p>–env-file=[]， 指定环境变量文件，文件格式为每行一个环境变量</p></li><li><p>–expose=[]， 指定容器暴露的端口，即修改镜像的暴露端口</p></li><li><p>–link=[]， 指定容器间的关联，使用其他容器的IP、env等信息</p></li><li><p>–lxc-conf=[]， 指定容器的配置文件，只有在指定–exec-driver=lxc时使用</p></li><li><p>–name=””， 指定容器名字，后续可以通过名字进行容器管理，links特性需要使用名字</p></li><li><p>–net=”bridge”， 容器网络设置:</p></li><li><ul><li>bridge 使用docker daemon指定的网桥</li><li>host //容器使用主机的网络</li><li>container:NAME_or_ID &gt;//使用其他容器的网路，共享IP和PORT等网络资源</li><li>none 容器使用自己的网络（类似–net=bridge），但是不进行配置</li></ul></li><li><p>–privileged=false， 指定容器是否为特权容器，特权容器拥有所有的capabilities</p></li><li><p>–restart=”no”， 指定容器停止后的重启策略:</p></li><li><ul><li>no：容器退出时不重启</li><li>on-failure：容器故障退出（返回值非零）时重启</li><li>always：容器退出时总是重启</li></ul></li><li><p>–rm=false， 指定容器停止后自动删除容器(不支持以docker run -d启动的容器)</p></li><li><p>–sig-proxy=true， 设置由代理接受并处理信号，但是SIGCHLD、SIGSTOP和SIGKILL不能被代理</p></li></ul><p><strong>3.2 部署/运行镜像</strong></p><p><strong>3.2.1 pull方式</strong></p><p>（1）下载命令</p><pre><code class="hljs nginx"><span class="hljs-attribute">docker</span> pull 镜像名</code></pre><p>（2）[例如]下载gitlab</p><pre><code class="hljs nginx"><span class="hljs-attribute">docker</span> pull gitlab/gitlab-ce</code></pre><p>下载的镜像所在位置（其中一个）</p><pre><code class="hljs crystal">cd var/<span class="hljs-class"><span class="hljs-keyword">lib</span>/<span class="hljs-title">docker</span>/<span class="hljs-title">containers</span></span></code></pre><p><img src="/images/Docker%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8/6.png" srcset="/img/loading.gif" alt></p><p>（3）查看镜像详细信息</p><pre><code class="hljs gradle">docker <span class="hljs-keyword">inspect</span> gitlab<span class="hljs-regexp">/gitlab-ce</span></code></pre><p>（4）运行镜像</p><pre><code class="hljs jboss-cli">docker run <span class="hljs-params">--detach</span> \  <span class="hljs-params">--hostname</span> 127.0.0.1 \  <span class="hljs-params">--publish</span> 10443<span class="hljs-function">:443</span> <span class="hljs-params">--publish</span> 1080<span class="hljs-function">:80</span> <span class="hljs-params">--publish</span> 1022<span class="hljs-function">:22</span> \  <span class="hljs-params">--name</span> gitlab \  <span class="hljs-params">--restart</span> always \  <span class="hljs-params">--volume</span> <span class="hljs-string">/srv/gitlab/config</span>:<span class="hljs-string">/etc/gitlab</span> \  <span class="hljs-params">--volume</span> <span class="hljs-string">/srv/gitlab/logs</span>:<span class="hljs-string">/var/log/gitlab</span> \  <span class="hljs-params">--volume</span> <span class="hljs-string">/srv/gitlab/data</span>:<span class="hljs-string">/var/opt/gitlab</span> \  gitlab/gitlab-ce<span class="hljs-function">:latest</span></code></pre><p>这里，</p><p>127.0.0.1为服务器IP地址；</p><p>–publish 10443:443 –publish 1080:80 –publish 1022:22 是指将443端口对外映射（暴露）成10443，22端口对外映射（暴露）成1022，80端口对外映射（暴露）成1080。</p><p>（5）访问gitlab</p><p><img src="/images/Docker%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8/7.png" srcset="/img/loading.gif" alt></p><p><strong>3.2.2 容器化（github.com上项目）</strong></p><p><strong>3.3 删除镜像</strong></p><p>（1）查看镜像</p><pre><code class="hljs ebnf"><span class="hljs-attribute">docker ps -a</span></code></pre><p>这里docker ps 的命令包括： </p><ul><li>-a 列出所有容器 </li><li>-l 列出最新创建容器 </li><li>-n=2 列出最近创建的2个容器 </li><li>-q 仅列出容器ID </li><li>-s 显示容器大小 </li></ul><p><img src="/images/Docker%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8/8.png" srcset="/img/loading.gif" alt></p><p>其中，</p><p>CONTAINER ID：容器ID</p><p>IMAGE：镜像名</p><p><strong>注意</strong>：如果容器正在运行是无法删除，需要先停止</p><p>（2）stop容器</p><pre><code class="hljs sql">docker <span class="hljs-keyword">stop</span>&lt;容器<span class="hljs-keyword">ID</span>或容器名&gt;</code></pre><p><img src="/images/Docker%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8/9.png" srcset="/img/loading.gif" alt></p><p>（3）删除容器</p><pre><code class="hljs xml">docker rm <span class="hljs-tag">&lt;<span class="hljs-name">容器ID或容器名</span>&gt;</span></code></pre><p>（4）删除镜像</p><pre><code class="hljs xml">docker rmi <span class="hljs-tag">&lt;<span class="hljs-name">镜像ID或镜像名</span>&gt;</span></code></pre><p>镜像ID可以通过docker images</p><pre><code class="hljs ebnf"><span class="hljs-attribute">docker images</span></code></pre><p><img src="/images/Docker%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8/10.png" srcset="/img/loading.gif" alt></p><p>或docker image ls</p><pre><code class="hljs mel">docker <span class="hljs-keyword">image</span> <span class="hljs-keyword">ls</span></code></pre><p><img src="/images/Docker%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8/11.png" srcset="/img/loading.gif" alt></p><p><strong>3.4 修改映射端口</strong></p><p><strong>3.4.1 重新部署镜像</strong></p><p><strong>3.4.2 修改部署容器配置文件</strong></p><p>（1）停止需要修改的容器</p><pre><code class="hljs livecodeserver">docker ps -<span class="hljs-keyword">a</span> docker <span class="hljs-built_in">stop</span> &lt;容器ID或容器名&gt;</code></pre><p>（2）找到hostconfig.json文件</p><pre><code class="hljs crystal">cd /var/<span class="hljs-class"><span class="hljs-keyword">lib</span>/<span class="hljs-title">docker</span>/<span class="hljs-title">containers</span>/&lt;容器对应<span class="hljs-title">ID</span>目录，例如651<span class="hljs-title">dcd904c5eec9617ea006f2ac3e59a9a015de237cae891fc5ef46a17bd3033</span>&gt;/</span></code></pre><p><img src="/images/Docker%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8/12.png" srcset="/img/loading.gif" alt></p><p>（3）修改hostconfig.json文件中”PortBindings”配置</p><pre><code class="hljs css"><span class="hljs-selector-tag">vim</span> <span class="hljs-selector-tag">hostconfig</span><span class="hljs-selector-class">.json</span></code></pre><p><img src="/images/Docker%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8/13.png" srcset="/img/loading.gif" alt></p><p>（4）重启docker[非常重要]，否则修改会失效</p><pre><code class="hljs ebnf"><span class="hljs-attribute">systemctl restart docker</span></code></pre><p>（5）启动修改后的容器</p><pre><code class="hljs sql">docker <span class="hljs-keyword">start</span> &lt;容器<span class="hljs-keyword">ID</span>或容器名&gt;</code></pre><p>（6）查看是否修改成功</p><pre><code class="hljs ebnf"><span class="hljs-attribute">docker ps -a</span></code></pre><p><img src="/images/Docker%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8/14.png" srcset="/img/loading.gif" alt></p><p><strong>Docker镜像部署容器</strong></p><p><strong>拉取远端镜像方式</strong></p><p><strong>1.部署gitlab（私有代码库）</strong></p><pre><code class="hljs jboss-cli">docker pull gitlab/gitlab-cedocker run <span class="hljs-params">--detach</span> \  <span class="hljs-params">--publish</span> 443<span class="hljs-function">:443</span> <span class="hljs-params">--publish</span> 80<span class="hljs-function">:80</span> <span class="hljs-params">--publish</span> 1022<span class="hljs-function">:22</span> \  <span class="hljs-params">--name</span> gitlab \  <span class="hljs-params">--restart</span> always \  <span class="hljs-params">--volume</span> <span class="hljs-string">/srv/gitlab/config</span>:<span class="hljs-string">/etc/gitlab</span> \  <span class="hljs-params">--volume</span> <span class="hljs-string">/srv/gitlab/logs</span>:<span class="hljs-string">/var/log/gitlab</span> \  <span class="hljs-params">--volume</span> <span class="hljs-string">/srv/gitlab/data</span>:<span class="hljs-string">/var/opt/gitlab</span> \  gitlab/gitlab-ce<span class="hljs-function">:latest</span></code></pre><p><strong>2.部署portainer（docker可视化管理工具）</strong></p><pre><code class="hljs elm"><span class="hljs-title">docker</span> pull docker.io/portainer/portainer<span class="hljs-title">docker</span> run <span class="hljs-comment">--detach \</span>    <span class="hljs-comment">--hostname 127.0.0.1 \</span>    <span class="hljs-comment">--publish 9000:9000 \</span>    <span class="hljs-comment">--name portainer\</span>    <span class="hljs-comment">--restart=always \</span>    <span class="hljs-comment">--volume /var/run/docker.sock:/var/run/docker.sock \</span>    docker.io/portainer/portainer</code></pre><p><strong>3.部署jenkins</strong></p><pre><code class="hljs jboss-cli">mkdir -p <span class="hljs-string">/srv/jenkins</span>chown -R 1000<span class="hljs-function">:1000</span> <span class="hljs-string">/srv/jenkins/</span>docker pull jenkins/jenkins<span class="hljs-function">:alpine</span>docker inspect jenkins/jenkins<span class="hljs-function">:alpine</span>docker run <span class="hljs-params">--detach</span> \    <span class="hljs-params">--publish</span> 8080<span class="hljs-function">:8080</span> <span class="hljs-params">--publish</span> 50000<span class="hljs-function">:50000</span> \    <span class="hljs-params">--restart</span> unless-stopped \    <span class="hljs-params">--name</span> jenkins \    <span class="hljs-params">--volume</span> <span class="hljs-string">/srv/jenkins</span>:<span class="hljs-string">/var/jenkins_home</span> \    jenkins/jenkins<span class="hljs-function">:alpine</span></code></pre><p><strong>4.部署gitlab-runner</strong></p><pre><code class="hljs jboss-cli">mkdir -p <span class="hljs-string">/srv/</span>docker pull gitlab/gitlab-runnerdocker run -d <span class="hljs-params">--name</span> gitlab-runner <span class="hljs-params">--restart</span> always \    <span class="hljs-params">--volume</span> <span class="hljs-string">/srv/gitlab-runner/config</span>:<span class="hljs-string">/etc/gitlab-runner</span> \    <span class="hljs-params">--volume</span> <span class="hljs-string">/srv/gitlab-runner/run/docker.sock</span>:<span class="hljs-string">/var/run/docker.sock</span> \    gitlab/gitlab-runner<span class="hljs-function">:latest</span></code></pre><p><strong>5.部署RabbitMQ</strong></p><p>获取查询的镜像 </p><pre><code class="hljs css"><span class="hljs-selector-tag">docker</span> <span class="hljs-selector-tag">search</span> <span class="hljs-selector-tag">rabbitmq</span><span class="hljs-selector-pseudo">:management</span></code></pre><p><img src="/images/Docker%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8/15.png" srcset="/img/loading.gif" alt></p><p>拉取镜像 </p><pre><code class="hljs css"><span class="hljs-selector-tag">docker</span> <span class="hljs-selector-tag">pull</span> <span class="hljs-selector-tag">rabbitmq</span><span class="hljs-selector-pseudo">:management</span></code></pre><p><img src="/images/Docker%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8/16.png" srcset="/img/loading.gif" alt></p><pre><code class="hljs crystal"><span class="hljs-comment"># 运行镜像    </span>docker run -d \    -p <span class="hljs-number">5672</span>:<span class="hljs-number">5672</span> -p <span class="hljs-number">15672</span>:<span class="hljs-number">15672</span> \    --restart=always \    --name rabbitmq \    -v <span class="hljs-string">`pwd`</span>/<span class="hljs-symbol">data:</span>/var/<span class="hljs-class"><span class="hljs-keyword">lib</span>/<span class="hljs-title">rabbitmq</span> \</span>    -e RABBITMQ_DEFAULT_USER=admin -e RABBITMQ_DEFAULT_PASS=<span class="hljs-number">2018251</span> \     <span class="hljs-symbol">rabbitmq:</span>management</code></pre><pre><code class="hljs crystal">docker run -d \    -p <span class="hljs-number">5000</span>:<span class="hljs-number">5000</span> \    --restart always \    --name registry \    -v /srv/registry/<span class="hljs-symbol">registry:</span>/var/<span class="hljs-class"><span class="hljs-keyword">lib</span>/<span class="hljs-title">registry</span> \</span>    <span class="hljs-symbol">registry:</span>latest</code></pre>]]></content>
    
    
    <categories>
      
      <category>Develop</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Docker</tag>
      
      <tag>Linux</tag>
      
      <tag>Center OS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【Mac】Mac使用</title>
    <link href="/2020/06/22/Mac%E7%94%B5%E8%84%91%E4%BD%BF%E7%94%A8/"/>
    <url>/2020/06/22/Mac%E7%94%B5%E8%84%91%E4%BD%BF%E7%94%A8/</url>
    
    <content type="html"><![CDATA[<p><img src="/images/Mac%E7%94%B5%E8%84%91%E4%BD%BF%E7%94%A8/mac.jpg" srcset="/img/loading.gif" alt><a id="more"></a> </p><h3 id="Homebrew"><a href="#Homebrew" class="headerlink" title="Homebrew"></a>Homebrew</h3><h4 id="官网"><a href="#官网" class="headerlink" title="官网:"></a>官网:</h4><p><a href="https://docs.brew.sh/Installation.html" target="_blank" rel="noopener">https://docs.brew.sh/Installation.html</a></p><h4 id="gihub源"><a href="#gihub源" class="headerlink" title="gihub源"></a>gihub源</h4><p><a href="https://github.com/Homebrew/install" target="_blank" rel="noopener">https://github.com/Homebrew/install</a></p><h4 id="homebrew安装"><a href="#homebrew安装" class="headerlink" title="homebrew安装"></a>homebrew安装</h4><pre><code class="hljs awk"><span class="hljs-regexp">/usr/</span>bin<span class="hljs-regexp">/ruby -e "$(curl -fsSL https:/</span><span class="hljs-regexp">/raw.githubusercontent.com/</span>Homebrew<span class="hljs-regexp">/install/m</span>aster<span class="hljs-regexp">/install)"</span></code></pre><p>可能会出现报错</p><pre><code class="hljs routeros">curl: (7) Failed <span class="hljs-keyword">to</span> connect <span class="hljs-keyword">to</span> raw.githubusercontent.com<span class="hljs-built_in"> port </span>443:<span class="hljs-built_in"> Connection </span>refused</code></pre><p>根据提示可以知道被raw.githubusercontent.com拒绝访问，打开浏览器访问<a href="https://raw.githubusercontent.com也是失败的，所以此时是电脑与https://raw.githubusercontent.com的连接问题：可以考虑ruby的更新源" target="_blank" rel="noopener">https://raw.githubusercontent.com也是失败的，所以此时是电脑与https://raw.githubusercontent.com的连接问题：可以考虑ruby的更新源</a></p><pre><code class="hljs vim">查看当前更新源gem sources -<span class="hljs-keyword">l</span>                // 默认情况下会显示http<span class="hljs-variable">s:</span>//rubygems.org/ 该<span class="hljs-keyword">ruby</span>源在墙内，很多内容无法访问到gem <span class="hljs-keyword">source</span> -<span class="hljs-keyword">a</span> http<span class="hljs-variable">s:</span>//gems.<span class="hljs-keyword">ruby</span>-china.<span class="hljs-keyword">com</span>    // 更新更新源为http<span class="hljs-variable">s:</span>//gems.<span class="hljs-keyword">ruby</span>-china.<span class="hljs-keyword">com</span>gem sources --<span class="hljs-built_in">remove</span> http<span class="hljs-variable">s:</span>//rubygems.org/   // 删除原更新源gem sources -<span class="hljs-keyword">l</span>      　　　　　　              // 检测是否成功</code></pre><p>继续安装</p><p><img src="/images/Mac%E7%94%B5%E8%84%91%E4%BD%BF%E7%94%A8/clipboard.png" srcset="/img/loading.gif" alt="img"></p><p><code>brew -v</code>检查是否已安装成功</p><pre><code class="hljs angelscript">Homebrew <span class="hljs-number">2.4</span><span class="hljs-number">.0</span> Homebrew/homebrew-core (git revision c948b; last commit <span class="hljs-number">2020</span><span class="hljs-number">-06</span><span class="hljs-number">-13</span>)</code></pre><h4 id="基本用法"><a href="#基本用法" class="headerlink" title="基本用法"></a>基本用法</h4><p>基于brew安装的所有软件及其依赖均会安装到目录<code>/usr/local/Cellar</code></p><h5 id="Brew-帮助信息"><a href="#Brew-帮助信息" class="headerlink" title="Brew 帮助信息"></a>Brew 帮助信息</h5><pre><code class="hljs properties"><span class="hljs-meta">$</span> <span class="hljs-string">brew help</span><span class="hljs-attr">Example</span> <span class="hljs-string">usage:</span>  <span class="hljs-attr">brew</span> <span class="hljs-string">search [TEXT|/REGEX/]</span>  <span class="hljs-attr">brew</span> <span class="hljs-string">info [FORMULA...]</span>  <span class="hljs-attr">brew</span> <span class="hljs-string">install FORMULA...</span>  <span class="hljs-attr">brew</span> <span class="hljs-string">update</span>  <span class="hljs-attr">brew</span> <span class="hljs-string">upgrade [FORMULA...]</span>  <span class="hljs-attr">brew</span> <span class="hljs-string">uninstall FORMULA...</span>  <span class="hljs-attr">brew</span> <span class="hljs-string">list [FORMULA...]</span><span class="hljs-attr">Troubleshooting</span>:<span class="hljs-string"></span>  <span class="hljs-attr">brew</span> <span class="hljs-string">config</span>  <span class="hljs-attr">brew</span> <span class="hljs-string">doctor</span>  <span class="hljs-attr">brew</span> <span class="hljs-string">install --verbose --debug FORMULA</span><span class="hljs-attr">Contributing</span>:<span class="hljs-string"></span>  <span class="hljs-attr">brew</span> <span class="hljs-string">create [URL [--no-fetch]]</span>  <span class="hljs-attr">brew</span> <span class="hljs-string">edit [FORMULA...]</span><span class="hljs-attr">Further</span> <span class="hljs-string">help:</span>  <span class="hljs-attr">brew</span> <span class="hljs-string">commands</span>  <span class="hljs-attr">brew</span> <span class="hljs-string">help [COMMAND]</span>  <span class="hljs-attr">man</span> <span class="hljs-string">brew</span>  <span class="hljs-attr">https</span>:<span class="hljs-string">//docs.brew.sh</span></code></pre><h5 id="子命令帮助信息"><a href="#子命令帮助信息" class="headerlink" title="子命令帮助信息"></a>子命令帮助信息</h5><p><code>brew help [COMMAND]或brew [COMMAND] -h</code> 用于查看具体某个子命令的帮助信息。</p><p>例如，查看<code>install</code>命令的帮助详情：</p><pre><code class="hljs applescript">$ brew install -hUsage: brew install [options] formulaInstall formula. Additional options specific <span class="hljs-keyword">to</span> formula may be appended <span class="hljs-keyword">to</span><span class="hljs-keyword">the</span> command.Unless HOMEBREW_NO_INSTALL_CLEANUP <span class="hljs-keyword">is</span> <span class="hljs-keyword">set</span>, brew cleanup will <span class="hljs-keyword">then</span> be <span class="hljs-built_in">run</span> <span class="hljs-keyword">for</span><span class="hljs-keyword">the</span> installed formulae <span class="hljs-keyword">or</span>, <span class="hljs-keyword">every</span> <span class="hljs-number">30</span> days, <span class="hljs-keyword">for</span> all formulae.    -d, <span class="hljs-comment">--debug                      If brewing fails, open an interactive</span>                                     debugging session <span class="hljs-keyword">with</span> access <span class="hljs-keyword">to</span> IRB <span class="hljs-keyword">or</span> a                                     shell inside <span class="hljs-keyword">the</span> temporary build directory.        <span class="hljs-comment">--env                        If std is passed, use the standard build</span>                                     environment <span class="hljs-keyword">instead of</span> superenv. If super                                     <span class="hljs-keyword">is</span> passed, use superenv even <span class="hljs-keyword">if</span> <span class="hljs-keyword">the</span> formula                                     specifies <span class="hljs-keyword">the</span> standard build environment.        <span class="hljs-comment">--ignore-dependencies        An unsupported Homebrew development flag to</span>                                     skip installing any dependencies <span class="hljs-keyword">of</span> any                                     kind. If <span class="hljs-keyword">the</span> dependencies are <span class="hljs-keyword">not</span> already                                     present, <span class="hljs-keyword">the</span> formula will have issues. If                                     you're <span class="hljs-keyword">not</span> developing Homebrew, consider                                     adjusting your PATH rather than using this                                     flag.        <span class="hljs-comment">--only-dependencies          Install the dependencies with specified</span>                                     options <span class="hljs-keyword">but</span> do <span class="hljs-keyword">not</span> install <span class="hljs-keyword">the</span> formula                                     itself.        <span class="hljs-comment">--cc                         Attempt to compile using the specified</span>                                     compiler, which should be <span class="hljs-keyword">the</span> <span class="hljs-built_in">name</span> <span class="hljs-keyword">of</span> <span class="hljs-keyword">the</span>                                     compiler's executable, e.g. gcc<span class="hljs-number">-7</span> <span class="hljs-keyword">for</span> GCC                                     <span class="hljs-number">7.</span> In order <span class="hljs-keyword">to</span> use LLVM's clang, specify                                     llvm_clang. To use <span class="hljs-keyword">the</span> Apple-provided                                     clang, specify clang. This option will                                     only accept compilers <span class="hljs-keyword">that</span> are provided <span class="hljs-keyword">by</span>                                     Homebrew <span class="hljs-keyword">or</span> bundled <span class="hljs-keyword">with</span> macOS. Please do                                     <span class="hljs-keyword">not</span> <span class="hljs-built_in">file</span> issues <span class="hljs-keyword">if</span> you encounter errors                                     <span class="hljs-keyword">while</span> using this option.    -s, <span class="hljs-comment">--build-from-source          Compile formula from source even if a</span>                                     bottle <span class="hljs-keyword">is</span> provided. Dependencies will still                                     be installed <span class="hljs-keyword">from</span> bottles <span class="hljs-keyword">if</span> they are                                     available.        <span class="hljs-comment">--force-bottle               Install from a bottle if it exists for the</span>                                     current <span class="hljs-keyword">or</span> newest <span class="hljs-built_in">version</span> <span class="hljs-keyword">of</span> macOS, even <span class="hljs-keyword">if</span>                                     <span class="hljs-keyword">it</span> would <span class="hljs-keyword">not</span> normally be used <span class="hljs-keyword">for</span>                                     installation.        <span class="hljs-comment">--include-test               Install testing dependencies required to</span>                                     <span class="hljs-built_in">run</span> brew test formula.        <span class="hljs-comment">--devel                      If formula defines it, install the</span>                                     development <span class="hljs-built_in">version</span>.        <span class="hljs-comment">--HEAD                       If formula defines it, install the HEAD</span>                                     <span class="hljs-built_in">version</span>, aka. master, trunk, unstable.        <span class="hljs-comment">--fetch-HEAD                 Fetch the upstream repository to detect if</span>                                     <span class="hljs-keyword">the</span> HEAD installation <span class="hljs-keyword">of</span> <span class="hljs-keyword">the</span> formula <span class="hljs-keyword">is</span>                                     outdated. Otherwise, <span class="hljs-keyword">the</span> repository's HEAD                                     will only be checked <span class="hljs-keyword">for</span> updates when a new                                     stable <span class="hljs-keyword">or</span> development <span class="hljs-built_in">version</span> has been                                     released.        <span class="hljs-comment">--keep-tmp                   Retain the temporary files created during</span>                                     installation.        <span class="hljs-comment">--build-bottle               Prepare the formula for eventual bottling</span>                                     during installation, skipping any                                     post-install steps.        <span class="hljs-comment">--bottle-arch                Optimise bottles for the specified</span>                                     architecture rather than <span class="hljs-keyword">the</span> oldest                                     architecture supported <span class="hljs-keyword">by</span> <span class="hljs-keyword">the</span> <span class="hljs-built_in">version</span> <span class="hljs-keyword">of</span>                                     macOS <span class="hljs-keyword">the</span> bottles are built <span class="hljs-keyword">on</span>.    -f, <span class="hljs-comment">--force                      Install without checking for previously</span>                                     installed keg-only <span class="hljs-keyword">or</span> non-migrated                                     versions.    -v, <span class="hljs-comment">--verbose                    Print the verification and postinstall</span>                                     steps.        <span class="hljs-comment">--display-times              Print install times for each formula at the</span>                                     <span class="hljs-keyword">end</span> <span class="hljs-keyword">of</span> <span class="hljs-keyword">the</span> <span class="hljs-built_in">run</span>.    -i, <span class="hljs-comment">--interactive                Download and patch formula, then open a</span>                                     shell. This allows <span class="hljs-keyword">the</span> user <span class="hljs-keyword">to</span> <span class="hljs-built_in">run</span>                                     ./configure <span class="hljs-comment">--help and otherwise</span>                                     determine how <span class="hljs-keyword">to</span> turn <span class="hljs-keyword">the</span> software package                                     <span class="hljs-keyword">into</span> a Homebrew package.    -g, <span class="hljs-comment">--git                        Create a Git repository, useful for</span>                                     creating patches <span class="hljs-keyword">to</span> <span class="hljs-keyword">the</span> software.    -h, <span class="hljs-comment">--help                       Show this message.</span></code></pre><h5 id="搜索软件"><a href="#搜索软件" class="headerlink" title="搜索软件"></a>搜索软件</h5><p> <code>brew search [TEXT|/REGEX/]</code> 用于搜索软件，支持使用正则表达式进行复杂的搜索。</p><p>例如，查询静态博客生成工具hugo：</p><pre><code class="hljs haml">$ brew search hugo=<span class="ruby">=&gt; Formulae</span>hugo</code></pre><h5 id="查看软件信息"><a href="#查看软件信息" class="headerlink" title="查看软件信息"></a>查看软件信息</h5><p> <code>brew info [FORMULA...]</code> 用于查询软件的详细信息。</p><p>例如，查看软件hugo的详细信息：</p><pre><code class="hljs angelscript">$ brew search hugo==&gt; Formulaehugo$ brew info hugohugo: stable <span class="hljs-number">0.72</span><span class="hljs-number">.0</span> (bottled), HEADConfigurable static site generatorhttps:<span class="hljs-comment">//gohugo.io/</span>Not installedFrom: https:<span class="hljs-comment">//mirrors.tuna.tsinghua.edu.cn/git/homebrew/homebrew-core.git/Formula/hugo.rb</span>==&gt; DependenciesBuild: go ✘==&gt; Options--HEADInstall HEAD version==&gt; Analyticsinstall: <span class="hljs-number">26</span>,<span class="hljs-number">782</span> (<span class="hljs-number">30</span> days), <span class="hljs-number">84</span>,<span class="hljs-number">656</span> (<span class="hljs-number">90</span> days), <span class="hljs-number">287</span>,<span class="hljs-number">304</span> (<span class="hljs-number">365</span> days)install-on-request: <span class="hljs-number">26</span>,<span class="hljs-number">266</span> (<span class="hljs-number">30</span> days), <span class="hljs-number">82</span>,<span class="hljs-number">887</span> (<span class="hljs-number">90</span> days), <span class="hljs-number">279</span>,<span class="hljs-number">634</span> (<span class="hljs-number">365</span> days)build-error: <span class="hljs-number">0</span> (<span class="hljs-number">30</span> days)</code></pre><p>以上查询所得信息，包含了软件的最新可用版本，本机是否已安装，本机已安装的版本，安装的路径、大小、时间、Tap 源，所依赖的包，以及安装的可选项等详细信息。而这些信息可以帮助我们很方便快捷的了解如何对该软件进行相应的操作。</p><h5 id="安装软件包"><a href="#安装软件包" class="headerlink" title="安装软件包"></a>安装软件包</h5><p> <code>brew install FORMULA...</code>用于安装一个或多个软件。</p><p>例如，安装软件hugo：</p><pre><code class="hljs mipsasm"><span class="hljs-keyword">brew </span><span class="hljs-keyword">install </span>hugo</code></pre><p>安装软件命令执行之前，brew 一般会先检查更新 Homebrew 自身及 Tap 源。</p><h5 id="更新软件包"><a href="#更新软件包" class="headerlink" title="更新软件包"></a>更新软件包</h5><p> <code>brew upgrade [FORMULA...]</code> 用于更新一个或多个软件，不指定软件名则更新所有软件。</p><h5 id="卸载软件包"><a href="#卸载软件包" class="headerlink" title="卸载软件包"></a>卸载软件包</h5><p><code>brew uninstall FORMULA...</code> 用于卸载指定的一个或多个软件</p><p><code>brew uninstall --force FORMULA...</code> 彻底卸载指定软件，包括旧版本</p><h5 id="已安装的软件列表"><a href="#已安装的软件列表" class="headerlink" title="已安装的软件列表"></a>已安装的软件列表</h5><p> <code>brew list</code> 用于查询本机已安装的软件列表</p><pre><code class="hljs angelscript">$ brew listaprgettextlz4pcre2pythonsqliteutf8procapr-utilgomysql-clientperl<span class="hljs-symbol">python@</span><span class="hljs-number">2</span>subversionxzgdbmlibzip<span class="hljs-symbol">openssl@</span><span class="hljs-number">1.1</span>pkg-configreadlinetldr</code></pre><h5 id="服务管理"><a href="#服务管理" class="headerlink" title="服务管理"></a>服务管理</h5><p> <code>brew services</code> 用于方便的管理 brew 安装的软件软件，类似于 Linux 下的 service 命令。</p><h5 id="检查可更新的软件列表"><a href="#检查可更新的软件列表" class="headerlink" title="检查可更新的软件列表"></a>检查可更新的软件列表</h5><p> <code>brew outdated</code> 可查询有更新版本的软件</p><pre><code class="hljs angelscript">$ brew outdated gettext (<span class="hljs-number">0.20</span><span class="hljs-number">.1</span>) &lt; <span class="hljs-number">0.20</span><span class="hljs-number">.2</span>_1go (<span class="hljs-number">1.13</span><span class="hljs-number">.8</span>) &lt; <span class="hljs-number">1.14</span><span class="hljs-number">.3</span>libzip (<span class="hljs-number">1.6</span><span class="hljs-number">.1</span>) &lt; <span class="hljs-number">1.7</span><span class="hljs-number">.1</span>mysql-client (<span class="hljs-number">8.0</span><span class="hljs-number">.18</span>) &lt; <span class="hljs-number">8.0</span><span class="hljs-number">.19</span><span class="hljs-symbol">openssl@</span><span class="hljs-number">1.1</span> (<span class="hljs-number">1.1</span><span class="hljs-number">.1</span>d) &lt; <span class="hljs-number">1.1</span><span class="hljs-number">.1</span>gpcre2 (<span class="hljs-number">10.34</span>) &lt; <span class="hljs-number">10.35</span>perl (<span class="hljs-number">5.30</span><span class="hljs-number">.1</span>) &lt; <span class="hljs-number">5.30</span><span class="hljs-number">.3</span>pkg-config (<span class="hljs-number">0.29</span><span class="hljs-number">.2</span>) &lt; <span class="hljs-number">0.29</span><span class="hljs-number">.2</span>_3python (<span class="hljs-number">3.7</span><span class="hljs-number">.6</span>_1) &lt; <span class="hljs-number">3.7</span><span class="hljs-number">.7</span>readline (<span class="hljs-number">8.0</span><span class="hljs-number">.1</span>) &lt; <span class="hljs-number">8.0</span><span class="hljs-number">.4</span>sqlite (<span class="hljs-number">3.30</span><span class="hljs-number">.1</span>) &lt; <span class="hljs-number">3.32</span><span class="hljs-number">.1</span>subversion (<span class="hljs-number">1.13</span><span class="hljs-number">.0</span>_1) &lt; <span class="hljs-number">1.14</span><span class="hljs-number">.0</span>_1utf8proc (<span class="hljs-number">2.4</span><span class="hljs-number">.0</span>) &lt; <span class="hljs-number">2.5</span><span class="hljs-number">.0</span>xz (<span class="hljs-number">5.2</span><span class="hljs-number">.4</span>) &lt; <span class="hljs-number">5.2</span><span class="hljs-number">.5</span></code></pre><h5 id="清理软件"><a href="#清理软件" class="headerlink" title="清理软件"></a>清理软件</h5><p><code>brew cleanup -n</code> 列出需要清理的内容</p><p><code>brew cleanup</code> 清理所有的过时软件 </p><p><code>brew cleanup [FORMULA]</code> 清理指定软件的过时包</p><h5 id="查看配置信息"><a href="#查看配置信息" class="headerlink" title="查看配置信息"></a>查看配置信息</h5><p><code>brew config</code> 用于查看 brew 所在环境及相关的配置情况</p><pre><code class="hljs yaml"><span class="hljs-string">$</span> <span class="hljs-string">brew</span> <span class="hljs-string">config</span><span class="hljs-attr">HOMEBREW_VERSION:</span> <span class="hljs-number">2.4</span><span class="hljs-number">.0</span><span class="hljs-attr">ORIGIN:</span> <span class="hljs-string">https://mirrors.tuna.tsinghua.edu.cn/git/homebrew/homebrew-cask-drivers.git</span><span class="hljs-attr">HEAD:</span> <span class="hljs-string">28ed0801ed5807e176e62a3ba66e47ec867ec17d</span><span class="hljs-attr">Last commit:</span> <span class="hljs-number">3</span> <span class="hljs-string">days</span> <span class="hljs-string">ago</span><span class="hljs-attr">Core tap ORIGIN:</span> <span class="hljs-string">https://mirrors.tuna.tsinghua.edu.cn/git/homebrew/homebrew-core.git</span><span class="hljs-attr">Core tap HEAD:</span> <span class="hljs-string">c948bc65d13a2bdd43e5ef2ed4196930c731283c</span><span class="hljs-attr">Core tap last commit:</span> <span class="hljs-number">11</span> <span class="hljs-string">hours</span> <span class="hljs-string">ago</span><span class="hljs-attr">HOMEBREW_PREFIX:</span> <span class="hljs-string">/usr/local</span><span class="hljs-attr">HOMEBREW_BOTTLE_DOMAIN:</span> <span class="hljs-string">https://mirrors.tuna.tsinghua.edu.cn/homebrew-bottles</span><span class="hljs-attr">HOMEBREW_MAKE_JOBS:</span> <span class="hljs-number">8</span><span class="hljs-attr">CPU:</span> <span class="hljs-string">octa-core</span> <span class="hljs-number">64</span><span class="hljs-string">-bit</span> <span class="hljs-string">kabylake</span><span class="hljs-attr">Homebrew Ruby:</span> <span class="hljs-number">2.6</span><span class="hljs-number">.3</span> <span class="hljs-string">=&gt;</span> <span class="hljs-string">/usr/local/Homebrew/Library/Homebrew/vendor/portable-ruby/2.6.3_1/bin/ruby</span><span class="hljs-attr">Clang:</span> <span class="hljs-number">11.0</span> <span class="hljs-string">build</span> <span class="hljs-number">1103</span><span class="hljs-attr">Git:</span> <span class="hljs-number">2.24</span><span class="hljs-number">.1</span> <span class="hljs-string">=&gt;</span> <span class="hljs-string">/Library/Developer/CommandLineTools/usr/bin/git</span><span class="hljs-attr">Curl:</span> <span class="hljs-number">7.64</span><span class="hljs-number">.1</span> <span class="hljs-string">=&gt;</span> <span class="hljs-string">/usr/bin/curl</span><span class="hljs-attr">Java:</span> <span class="hljs-number">1.8</span><span class="hljs-string">.0_212</span><span class="hljs-attr">macOS:</span> <span class="hljs-number">10.15</span><span class="hljs-number">.4</span><span class="hljs-string">-x86_64</span><span class="hljs-attr">CLT:</span> <span class="hljs-number">1103.0</span><span class="hljs-number">.32</span><span class="hljs-number">.29</span><span class="hljs-attr">Xcode:</span> <span class="hljs-string">N/A</span></code></pre><h5 id="诊断问题"><a href="#诊断问题" class="headerlink" title="诊断问题"></a>诊断问题</h5><p> <code>brew doctor</code> 诊断当前 brew 存在哪些问题，并给出解决方案</p><h5 id="仓库管理"><a href="#仓库管理" class="headerlink" title="仓库管理"></a>仓库管理</h5><p><code>brew tap</code> 已安装的仓库列表</p><p><code>brew tap [--full] user/repo [URL]</code> 添加仓库</p><p><code>brew untap tap</code> 移除仓库</p><pre><code class="hljs armasm">$ <span class="hljs-keyword">brew </span>tap<span class="hljs-symbol">homebrew</span>/cask<span class="hljs-symbol">homebrew</span>/cask-drivers<span class="hljs-symbol">homebrew</span>/cask-fonts<span class="hljs-symbol">homebrew</span>/core<span class="hljs-symbol">homebrew</span>/services<span class="hljs-symbol">tldr</span>-pages/tldr</code></pre><h4 id="镜像源"><a href="#镜像源" class="headerlink" title="镜像源"></a>镜像源</h4><p>清华大学开源软件镜像站</p><p><a href="https://mirrors.tuna.tsinghua.edu.cn/help/homebrew/" target="_blank" rel="noopener">Homebrew 镜像使用帮助</a></p><pre><code class="hljs dsconfig"><span class="hljs-comment"># 替换现有上游</span><span class="hljs-comment"># 以下针对 mac OS 系统上的 Homebrew</span><span class="hljs-string">git </span>-C <span class="hljs-string">"$(brew --repo homebrew/core)"</span> <span class="hljs-string">remote </span><span class="hljs-built_in">set-url</span> <span class="hljs-string">origin </span><span class="hljs-string">https:</span>//<span class="hljs-string">mirrors.</span><span class="hljs-string">tuna.</span><span class="hljs-string">tsinghua.</span><span class="hljs-string">edu.</span><span class="hljs-string">cn/</span><span class="hljs-string">git/</span><span class="hljs-string">homebrew/</span><span class="hljs-string">homebrew-core.</span><span class="hljs-string">git</span><span class="hljs-string">git </span>-C <span class="hljs-string">"$(brew --repo homebrew/cask)"</span> <span class="hljs-string">remote </span><span class="hljs-built_in">set-url</span> <span class="hljs-string">origin </span><span class="hljs-string">https:</span>//<span class="hljs-string">mirrors.</span><span class="hljs-string">tuna.</span><span class="hljs-string">tsinghua.</span><span class="hljs-string">edu.</span><span class="hljs-string">cn/</span><span class="hljs-string">git/</span><span class="hljs-string">homebrew/</span><span class="hljs-string">homebrew-cask.</span><span class="hljs-string">git</span><span class="hljs-string">git </span>-C <span class="hljs-string">"$(brew --repo homebrew/cask-fonts)"</span> <span class="hljs-string">remote </span><span class="hljs-built_in">set-url</span> <span class="hljs-string">origin </span><span class="hljs-string">https:</span>//<span class="hljs-string">mirrors.</span><span class="hljs-string">tuna.</span><span class="hljs-string">tsinghua.</span><span class="hljs-string">edu.</span><span class="hljs-string">cn/</span><span class="hljs-string">git/</span><span class="hljs-string">homebrew/</span><span class="hljs-string">homebrew-cask-</span><span class="hljs-string">fonts.</span><span class="hljs-string">git</span><span class="hljs-string">git </span>-C <span class="hljs-string">"$(brew --repo homebrew/cask-drivers)"</span> <span class="hljs-string">remote </span><span class="hljs-built_in">set-url</span> <span class="hljs-string">origin </span><span class="hljs-string">https:</span>//<span class="hljs-string">mirrors.</span><span class="hljs-string">tuna.</span><span class="hljs-string">tsinghua.</span><span class="hljs-string">edu.</span><span class="hljs-string">cn/</span><span class="hljs-string">git/</span><span class="hljs-string">homebrew/</span><span class="hljs-string">homebrew-cask-</span><span class="hljs-string">drivers.</span><span class="hljs-string">git</span><span class="hljs-comment"># 更换后测试工作是否正常</span><span class="hljs-string">brew </span><span class="hljs-string">update</span><span class="hljs-comment"># 复原</span><span class="hljs-comment"># 以下针对 mac OS 系统上的 Homebrew</span><span class="hljs-string">git </span>-C <span class="hljs-string">"$(brew --repo homebrew/core)"</span> <span class="hljs-string">remote </span><span class="hljs-built_in">set-url</span> <span class="hljs-string">origin </span><span class="hljs-string">https:</span>//<span class="hljs-string">github.</span><span class="hljs-string">com/</span><span class="hljs-string">Homebrew/</span><span class="hljs-string">homebrew-core.</span><span class="hljs-string">git</span><span class="hljs-string">git </span>-C <span class="hljs-string">"$(brew --repo homebrew/cask)"</span> <span class="hljs-string">remote </span><span class="hljs-built_in">set-url</span> <span class="hljs-string">origin </span><span class="hljs-string">https:</span>//<span class="hljs-string">github.</span><span class="hljs-string">com/</span><span class="hljs-string">Homebrew/</span><span class="hljs-string">homebrew-cask.</span><span class="hljs-string">git</span><span class="hljs-string">git </span>-C <span class="hljs-string">"$(brew --repo homebrew/cask-fonts)"</span> <span class="hljs-string">remote </span><span class="hljs-built_in">set-url</span> <span class="hljs-string">origin </span><span class="hljs-string">https:</span>//<span class="hljs-string">github.</span><span class="hljs-string">com/</span><span class="hljs-string">Homebrew/</span><span class="hljs-string">homebrew-cask-</span><span class="hljs-string">fonts.</span><span class="hljs-string">git</span><span class="hljs-string">git </span>-C <span class="hljs-string">"$(brew --repo homebrew/cask-drivers)"</span> <span class="hljs-string">remote </span><span class="hljs-built_in">set-url</span> <span class="hljs-string">origin </span><span class="hljs-string">https:</span>//<span class="hljs-string">github.</span><span class="hljs-string">com/</span><span class="hljs-string">Homebrew/</span><span class="hljs-string">homebrew-cask-</span><span class="hljs-string">drivers.</span><span class="hljs-string">git</span><span class="hljs-comment"># 更换后测试工作是否正常</span><span class="hljs-string">brew </span><span class="hljs-string">update</span></code></pre><p><a href="https://mirrors.tuna.tsinghua.edu.cn/help/homebrew-bottles/" target="_blank" rel="noopener">Homebrew-bottles 镜像使用帮助</a></p><pre><code class="hljs jboss-cli"><span class="hljs-comment"># 临时替换</span>export HOMEBREW_BOTTLE_DOMAIN=https:<span class="hljs-string">//mirrors.tuna.tsinghua.edu.cn/homebrew-bottles</span><span class="hljs-comment"># 长期替换</span><span class="hljs-keyword">echo</span> 'export HOMEBREW_BOTTLE_DOMAIN=https:<span class="hljs-string">//mirrors.tuna.tsinghua.edu.cn/homebrew-bottles</span>' &gt;&gt; ~<span class="hljs-string">/.bash_profile</span>source ~<span class="hljs-string">/.bash_profile</span></code></pre><h3 id="安装Python虚拟环境（VirtualEnv）"><a href="#安装Python虚拟环境（VirtualEnv）" class="headerlink" title="安装Python虚拟环境（VirtualEnv）"></a>安装Python虚拟环境（VirtualEnv）</h3><h4 id="安装virtualenv环境"><a href="#安装virtualenv环境" class="headerlink" title="安装virtualenv环境"></a>安装virtualenv环境</h4><pre><code class="hljs properties"><span class="hljs-attr">pip</span> <span class="hljs-string">install virtualenv</span><span class="hljs-comment">#检查是否安装成功</span><span class="hljs-attr">virtualenv</span> <span class="hljs-string">--version</span></code></pre><h4 id="创建以及使用虚拟环境"><a href="#创建以及使用虚拟环境" class="headerlink" title="创建以及使用虚拟环境"></a>创建以及使用虚拟环境</h4><h5 id="创建时指定位置方式"><a href="#创建时指定位置方式" class="headerlink" title="创建时指定位置方式"></a>创建时指定位置方式</h5><pre><code class="hljs awk"><span class="hljs-comment"># 创建python3环境</span>virtualenv -p python3 ~<span class="hljs-regexp">/Projects/</span>PythonEnv<span class="hljs-regexp">/py3_normal/</span><span class="hljs-comment"># 进入虚拟环境</span>cd ~<span class="hljs-regexp">/Projects/</span>PythonEnv<span class="hljs-regexp">/py3_normal/</span>binsource activate<span class="hljs-comment"># 退出环境</span>deactivate</code></pre><h5 id="虚拟环境管理器方式"><a href="#虚拟环境管理器方式" class="headerlink" title="虚拟环境管理器方式"></a>虚拟环境管理器方式</h5><pre><code class="hljs properties"><span class="hljs-comment"># 安装虚拟环境管理器</span><span class="hljs-attr">pip</span> <span class="hljs-string">install virtualenvwrapper</span><span class="hljs-comment"># 配置虚拟环境管理器环境-添加配置</span><span class="hljs-attr">vim</span> <span class="hljs-string">~/.bash_profile</span><span class="hljs-attr">WORKON_HOME</span>=<span class="hljs-string">~/Projects/PythonEnv</span><span class="hljs-attr">PROJECT_HOME</span>=<span class="hljs-string">~/Projects/MyPython</span><span class="hljs-attr">export</span> <span class="hljs-string">WORKON_HOME</span><span class="hljs-attr">export</span> <span class="hljs-string">PROJECT_HOME</span><span class="hljs-attr">VIRTUALENVWRAPPER_PYTHON</span>=<span class="hljs-string">/usr/local/bin/python3</span><span class="hljs-attr">source</span> <span class="hljs-string">/usr/local/bin/virtualenvwrapper.sh</span><span class="hljs-comment">#保存-生效配置</span><span class="hljs-attr">source</span> <span class="hljs-string">~/.bash_profile</span><span class="hljs-comment"># 创建虚拟环境</span><span class="hljs-comment">## 创建python2的虚拟环境</span><span class="hljs-attr">mkvirtualenv</span> <span class="hljs-string">&lt;虚拟环境名&gt;</span><span class="hljs-comment">## 创建python3的虚拟环境</span><span class="hljs-attr">mkvirtualenv</span> <span class="hljs-string">-p python3 &lt;虚拟环境名&gt;</span><span class="hljs-comment"># 进入/切换虚拟环境</span><span class="hljs-attr">workon</span> <span class="hljs-string">&lt;虚拟环境名&gt;</span><span class="hljs-comment"># 退出虚拟环境</span><span class="hljs-attr">deactivate</span><span class="hljs-comment"># 其他命令</span><span class="hljs-attr">lssitepackages</span> <span class="hljs-string">查看当前环境中安装的那些包（启动虚拟环境后）</span><span class="hljs-attr">rmvirtualenv</span> <span class="hljs-string">虚拟环境名 删除虚拟环境</span></code></pre><h3 id="Python-pip-配置国内源-pip-install-Read-timed-out"><a href="#Python-pip-配置国内源-pip-install-Read-timed-out" class="headerlink" title="Python pip 配置国内源[pip install Read timed out]"></a>Python pip 配置国内源[pip install Read timed out]</h3><h4 id="【方式一】临时生效"><a href="#【方式一】临时生效" class="headerlink" title="【方式一】临时生效"></a>【方式一】临时生效</h4><pre><code class="hljs dts"><span class="hljs-meta"># 在安装时加上镜像源</span>pip install <span class="hljs-params">&lt;库名&gt;</span> -i https:<span class="hljs-comment">//pypi.tuna.tsinghua.edu.cn/simple --trusted-host pypi.douban.compyth</span></code></pre><p><strong>方式二】永久指定</strong></p><h5 id="国内源列表（推荐用阿里云的）"><a href="#国内源列表（推荐用阿里云的）" class="headerlink" title="国内源列表（推荐用阿里云的）"></a>国内源列表（推荐用阿里云的）</h5><p>阿里云<code>http://mirrors.aliyun.com/pypi/simple/</code></p><p>中国科技大学 <code>https://pypi.mirrors.ustc.edu.cn/simple/</code></p><p>豆瓣 (douban) <code>http://pypi.douban.com/simple/</code></p><p>清华大学 <code>https://pypi.tuna.tsinghua.edu.cn/simple/</code></p><p>中国科学技术大学 <code>http://pypi.mirrors.ustc.edu.cn/simple/</code></p><h5 id="永久指定方式"><a href="#永久指定方式" class="headerlink" title="永久指定方式"></a>永久指定方式</h5><pre><code class="hljs pgsql">mkdir .pip# 在家目录下创建一个.pip目录~ cd pip~ touch pip.conf # 创建一个pip配置文件# 写入配置[<span class="hljs-keyword">global</span>]<span class="hljs-keyword">index</span>-url = http://mirrors.aliyun.com/pypi/simple/[install]<span class="hljs-keyword">trusted</span>-host = mirrors.aliyun.com</code></pre>]]></content>
    
    
    <categories>
      
      <category>Develop</category>
      
    </categories>
    
    
    <tags>
      
      <tag>mac</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【Mac】hadoop开发环境配置</title>
    <link href="/2020/06/17/mac%E7%8E%AF%E5%A2%83%E4%B8%8Bhadoop%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/"/>
    <url>/2020/06/17/mac%E7%8E%AF%E5%A2%83%E4%B8%8Bhadoop%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/</url>
    
    <content type="html"><![CDATA[<p><img src="/images/mac%E7%8E%AF%E5%A2%83%E4%B8%8B%E6%90%AD%E5%BB%BAhadoop%E9%9B%86%E7%BE%A4%E7%8E%AF%E5%A2%83/hadoops.png" srcset="/img/loading.gif" alt><a id="more"></a> </p><h3 id="hdfs的java-API开发环境准备"><a href="#hdfs的java-API开发环境准备" class="headerlink" title="hdfs的java API开发环境准备"></a>hdfs的java API开发环境准备</h3><h4 id="修改hosts文件"><a href="#修改hosts文件" class="headerlink" title="修改hosts文件"></a>修改hosts文件</h4><ul><li><p>mac下修改hosts文件</p><p>文件所在位置<code>/etc/hosts</code></p><p>将虚拟机中/etc/hosts文件一下内容，添加到以上hosts文件末尾</p></li></ul><pre><code class="hljs accesslog"><span class="hljs-number">192.168.51.100</span> node01.hadoop.com node01<span class="hljs-number">192.168.51.110</span> node02.hadoop.com node02<span class="hljs-number">192.168.51.120</span> node03.hadoop.com node03</code></pre><p><img src="/images/mac%E7%8E%AF%E5%A2%83%E4%B8%8B%E6%90%AD%E5%BB%BAhadoop%E9%9B%86%E7%BE%A4%E7%8E%AF%E5%A2%83/hosts.png" srcset="/img/loading.gif" alt></p><h4 id="安装jdk"><a href="#安装jdk" class="headerlink" title="安装jdk"></a>安装jdk</h4><p>拷贝集群环境下的jdk到本地</p><pre><code class="hljs routeros"><span class="hljs-comment">#添加以下配置内容，配置jdk环境变量</span><span class="hljs-builtin-name">export</span> <span class="hljs-attribute">JAVA_HOME</span>=/weitrue/install/jdk1.8.0_141<span class="hljs-builtin-name">export</span> <span class="hljs-attribute">PATH</span>=<span class="hljs-variable">$PATH</span>:$JAVA_HOME/binCopy</code></pre><p>让修改马上生效</p><pre><code class="hljs gradle"><span class="hljs-keyword">source</span> <span class="hljs-regexp">/etc/</span>profile</code></pre><h4 id="mac下hadoop环境配置"><a href="#mac下hadoop环境配置" class="headerlink" title="mac下hadoop环境配置"></a>mac下hadoop环境配置</h4><p>拷贝集群环境下<code>hadoop-2.6.0-cdh5.14.2</code>目录文件到本地，配置环境变量</p><p><img src="/images/mac%E7%8E%AF%E5%A2%83%E4%B8%8B%E6%90%AD%E5%BB%BAhadoop%E9%9B%86%E7%BE%A4%E7%8E%AF%E5%A2%83/hadoop.png" srcset="/img/loading.gif" alt></p><h4 id="安装maven"><a href="#安装maven" class="headerlink" title="安装maven"></a>安装maven</h4><h5 id="maven是什么？"><a href="#maven是什么？" class="headerlink" title="maven是什么？"></a>maven是什么？</h5><p>Apache Maven是一个软件项目管理和理解工具。基于项目对象模型（POM）的概念，Maven可以从一个中心信息管理项目的构建，报告和文档。</p><h5 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h5><p>解压安装包<code>apache-maven-3.6.1-bin.zip</code>到安装目录</p><p>编辑<code>.bash_profile</code>，新增maven环境配置</p><p><img src="/images/mac%E7%8E%AF%E5%A2%83%E4%B8%8B%E6%90%AD%E5%BB%BAhadoop%E9%9B%86%E7%BE%A4%E7%8E%AF%E5%A2%83/maven.png" srcset="/img/loading.gif" alt></p><h6 id="maven的仓库"><a href="#maven的仓库" class="headerlink" title="maven的仓库"></a>maven的仓库</h6><ul><li><p>创建maven工程后，maven会自动的去本地仓库查看时候有所需的jar包，如果没有的话，默认去中央仓库，将jar包下载到本地；以后如果再次使用此jar时，就直接使用本地仓库的jar即可</p></li><li><p>此过程是maven自动完成的</p></li><li><p>本地仓库：</p><p>![1583204026610](/Users/wangpeng/Desktop/大数据/07 预修课/2、其他环境准备/assets/1583204026610.png)</p></li><li><p>私服仓库：就是我们自己搭建的一个远程仓库</p></li><li><p>中央仓库：是官方或者第三方提供的仓库</p></li></ul><h6 id="settings文件"><a href="#settings文件" class="headerlink" title="settings文件"></a>settings文件</h6><ul><li>声明文件规范</li></ul><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">settings</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"http://maven.apache.org/SETTINGS/1.0.0"</span>          <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span>          <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">"http://maven.apache.org/SETTINGS/1.0.0 http://maven.apache.org/xsd/settings-1.0.0.xsd"</span>&gt;</span></code></pre><ul><li>本地仓库路径</li></ul><p><code>&lt;localRepository&gt;/path/to/local/repo&lt;/localRepository&gt;</code></p><ul><li>Maven是否需要和用户交互以获得输入。如果Maven需要和用户交互以获得输入，则设置成true，反之则应为false。默认为true </li></ul><p><code>&lt;interactiveMode&gt;true&lt;/interactiveMode&gt;</code></p><ul><li>表示Maven是否需要在离线模式下运行。如果构建系统需要在离线模式下运行，则为true，默认为false。当由于网络设置原因或者安全因素，构建服务器不能连接远程仓库的时候，该配置就十分有用 </li></ul><p><code>&lt;offline&gt;false&lt;/offline&gt;</code></p><ul><li>当插件的组织Id（groupId）没有显式提供时，供搜寻插件组织Id（groupId）的列表。该元素包含一个pluginGroup元素列表，每个子元素包含了一个组织Id（groupId）。</li></ul><p><code>pluginGroups</code></p><ul><li>为仓库列表配置的下载镜像列表 </li></ul><p><code>mirrors</code></p><h6 id="pom文件"><a href="#pom文件" class="headerlink" title="pom文件"></a>pom文件</h6><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">modelVersion</span>&gt;</span>4.0.0<span class="hljs-tag">&lt;/<span class="hljs-name">modelVersion</span>&gt;</span>     项目的模板版本<span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.hadoop<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>         可以用这个来标识公司<span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>TestFlume<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>     可以标识工程的作用<span class="hljs-tag">&lt;<span class="hljs-name">packaging</span>&gt;</span>jar<span class="hljs-tag">&lt;/<span class="hljs-name">packaging</span>&gt;</span>             指定打包类型       <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.0-SNAPSHOT<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>        制定项目版本<span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span>...<span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span>       项目的依赖关系<span class="hljs-tag">&lt;<span class="hljs-name">build</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">build</span>&gt;</span>                        构建项目的信息</code></pre><p>总项目/ pom.xml 总项目的pom配置文件 </p><p>子项目1/ pom.xml 子项目1的pom文件 </p><p>子项目2/ pom.xml 子项目2的pom文件 </p><h6 id="maven简单的命令"><a href="#maven简单的命令" class="headerlink" title="maven简单的命令"></a>maven简单的命令</h6><p>mvn clean </p><p>mvn clean package</p><p>mvn install:install-file -Dfile=junit-3.8.2.jar -DgroupId=junit -DartifactId=junit -Dversion=3.8.2 -Dpackaging=jar</p><p>如果依赖下载有问题，需要自己添加依赖包进仓库，不要复制粘贴，要用 mvn install这个命令将jar包打进仓库</p><h5 id="安装idea"><a href="#安装idea" class="headerlink" title="安装idea"></a>安装idea</h5>]]></content>
    
    
    <categories>
      
      <category>Bdata</category>
      
    </categories>
    
    
    <tags>
      
      <tag>mac</tag>
      
      <tag>Hadoop</tag>
      
      <tag>大数据</tag>
      
      <tag>Java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【Mac】搭建hadoop集群环境（三台）</title>
    <link href="/2020/06/15/mac%E7%8E%AF%E5%A2%83%E4%B8%8B%E6%90%AD%E5%BB%BAhadoop%E9%9B%86%E7%BE%A4%E7%8E%AF%E5%A2%83/"/>
    <url>/2020/06/15/mac%E7%8E%AF%E5%A2%83%E4%B8%8B%E6%90%AD%E5%BB%BAhadoop%E9%9B%86%E7%BE%A4%E7%8E%AF%E5%A2%83/</url>
    
    <content type="html"><![CDATA[<p><img src="/images/mac%E7%8E%AF%E5%A2%83%E4%B8%8B%E6%90%AD%E5%BB%BAhadoop%E9%9B%86%E7%BE%A4%E7%8E%AF%E5%A2%83/hadoops.png" srcset="/img/loading.gif" alt><a id="more"></a> </p><h3 id="1-三台linux服务器的安装"><a href="#1-三台linux服务器的安装" class="headerlink" title="1. 三台linux服务器的安装"></a>1. 三台linux服务器的安装</h3><h4 id="1-安装VmWare-Fusion"><a href="#1-安装VmWare-Fusion" class="headerlink" title="1. 安装VmWare Fusion"></a>1. 安装VmWare Fusion</h4><p><img src="/images/mac%E7%8E%AF%E5%A2%83%E4%B8%8B%E6%90%AD%E5%BB%BAhadoop%E9%9B%86%E7%BE%A4%E7%8E%AF%E5%A2%83/fusion.png" srcset="/img/loading.gif" alt></p><h4 id="2-通过Vmware安装三台linux机器"><a href="#2-通过Vmware安装三台linux机器" class="headerlink" title="2.通过Vmware安装三台linux机器"></a>2.通过Vmware安装三台linux机器</h4><p><img src="/images/mac%E7%8E%AF%E5%A2%83%E4%B8%8B%E6%90%AD%E5%BB%BAhadoop%E9%9B%86%E7%BE%A4%E7%8E%AF%E5%A2%83/linux.png" srcset="/img/loading.gif" alt></p><h4 id="3-为linux虚拟机设置网络配置"><a href="#3-为linux虚拟机设置网络配置" class="headerlink" title="3.为linux虚拟机设置网络配置"></a>3.为linux虚拟机设置网络配置</h4><p>安装VMWare Fusion成功后，Mac OS会新增两张网卡vmnet1以及vmnet8，其中vmnet1是Host-only模式，vmnet8是NAT模式，这里选择vmnet8使用NAT进行网络设置。</p><h5 id="1-修改Fusion网络配置"><a href="#1-修改Fusion网络配置" class="headerlink" title="1.修改Fusion网络配置"></a>1.修改Fusion网络配置</h5><p>修改配置文件:/Library/Preferences/VMware\ Fusion/networking</p><p><img src="/images/mac%E7%8E%AF%E5%A2%83%E4%B8%8B%E6%90%AD%E5%BB%BAhadoop%E9%9B%86%E7%BE%A4%E7%8E%AF%E5%A2%83/fusion_net.png" srcset="/img/loading.gif" alt></p><h5 id="2-修改网关"><a href="#2-修改网关" class="headerlink" title="2.修改网关"></a>2.修改网关</h5><p>修改配置文件：/Library/Preferences/VMware Fusion/vmnet8/nat.conf</p><p><img src="/images/mac%E7%8E%AF%E5%A2%83%E4%B8%8B%E6%90%AD%E5%BB%BAhadoop%E9%9B%86%E7%BE%A4%E7%8E%AF%E5%A2%83/net8.png" srcset="/img/loading.gif" alt></p><h5 id="3-修改linux虚拟机网卡"><a href="#3-修改linux虚拟机网卡" class="headerlink" title="3.修改linux虚拟机网卡"></a>3.修改linux虚拟机网卡</h5><p>修改配置文件(服务器版linux):/etc/sysconfig/network-scripts/ifcfg-ens33</p><p><img src="/images/mac%E7%8E%AF%E5%A2%83%E4%B8%8B%E6%90%AD%E5%BB%BAhadoop%E9%9B%86%E7%BE%A4%E7%8E%AF%E5%A2%83/linux_net.png" srcset="/img/loading.gif" alt></p><p>更改完成配置，重启网络服务</p><pre><code class="hljs shell">systemctl restart network</code></pre><p>安装一些常用的软件</p><pre><code class="hljs shell">yum -y install vimyum -y install net-tools</code></pre><p>关机</p><pre><code class="hljs angelscript">init <span class="hljs-number">0</span></code></pre><h5 id="4-克隆第一台linux虚拟机"><a href="#4-克隆第一台linux虚拟机" class="headerlink" title="4.克隆第一台linux虚拟机"></a>4.克隆第一台linux虚拟机</h5><p>现在已经有了种子机器了，我们可以通过种子机器进行复制或者克隆出三台机器</p><h6 id="更改克隆机器的IP地址"><a href="#更改克隆机器的IP地址" class="headerlink" title="更改克隆机器的IP地址"></a>更改克隆机器的IP地址</h6><ul><li><p>三台机器的ip地址分别是<code>192.168.51.100、192.168.51.110、192.168.51.120</code></p></li><li><p>克隆出来的机器IP地址与种子的ip地址一样，我们将第二台机器的IP地址更改为192.168.51.110即可</p></li><li><p>启动虚拟机，并通过root用户，密码<strong>**</strong>来进行登录，然后来更改linux机器的IP地址</p></li></ul><pre><code class="hljs shell">vi /etc/sysconfig/network-scripts/ifcfg-ens33</code></pre><pre><code class="hljs shell">IPADDR=192.168.51.110NETMASK=255.255.255.0GATEWAY=192.168.51.1DNS1=8.8.8.8</code></pre><ul><li><p>依照上面步骤，接着克隆第三台机器，并将第三台机器的IP地址设置为</p><p>192.168.51.120</p></li></ul><h3 id="2-安装大数据集群前环境准备"><a href="#2-安装大数据集群前环境准备" class="headerlink" title="2.安装大数据集群前环境准备"></a>2.安装大数据集群前环境准备</h3><h4 id="1-三台虚拟机关闭防火墙"><a href="#1-三台虚拟机关闭防火墙" class="headerlink" title="1. 三台虚拟机关闭防火墙"></a>1. 三台虚拟机关闭防火墙</h4><p>三台机器执行以下命令（<font color="red">root</font>用户来执行）</p><pre><code class="hljs shell">systemctl stop firewalldsystemctl disable firewalld</code></pre><h4 id="2-三台机器关闭selinux"><a href="#2-三台机器关闭selinux" class="headerlink" title="2. 三台机器关闭selinux"></a>2. 三台机器关闭selinux</h4><p>三台机器执行以下命令关闭selinux</p><pre><code class="hljs shell">vim /etc/sysconfig/selinuxSELINUX=disabled</code></pre><h4 id="3-三台机器更改主机名"><a href="#3-三台机器更改主机名" class="headerlink" title="3. 三台机器更改主机名"></a>3. 三台机器更改主机名</h4><p>三台机器执行以下命令更改主机名</p><pre><code class="hljs shell">vim /etc/hostname</code></pre><p>第一台机器更改内容</p><pre><code class="hljs css"><span class="hljs-selector-tag">node01</span><span class="hljs-selector-class">.hadoop</span><span class="hljs-selector-class">.com</span></code></pre><p>第二台机器更改内容</p><pre><code class="hljs css"><span class="hljs-selector-tag">node02</span><span class="hljs-selector-class">.hadoop</span><span class="hljs-selector-class">.com</span></code></pre><p>第三台机器更改内容</p><pre><code class="hljs css"><span class="hljs-selector-tag">node03</span><span class="hljs-selector-class">.hadoop</span><span class="hljs-selector-class">.com</span></code></pre><h4 id="4-三台机器做主机名与IP地址的映射"><a href="#4-三台机器做主机名与IP地址的映射" class="headerlink" title="4. 三台机器做主机名与IP地址的映射"></a>4. 三台机器做主机名与IP地址的映射</h4><p>三台机器执行以下命令更改主机名与IP地址的映射/etc/hosts</p><pre><code class="hljs shell">192.168.51.100 node01.hadoop.com node01192.168.51.110 node02.hadoop.com node02192.168.51.120 node03.hadoop.com node03</code></pre><h4 id="5-三台机器时钟同步"><a href="#5-三台机器时钟同步" class="headerlink" title="5. 三台机器时钟同步"></a>5. 三台机器时钟同步</h4><h5 id="第一种同步方式：通过网络进行时钟同步"><a href="#第一种同步方式：通过网络进行时钟同步" class="headerlink" title="第一种同步方式：通过网络进行时钟同步"></a>第一种同步方式：通过网络进行时钟同步</h5><p>通过网络连接外网进行时钟同步,必须保证虚拟机连上外网</p><p>三台机器都安装ntpdate</p><pre><code class="hljs shell">yum -y install ntpdate</code></pre><p>阿里云时钟同步服务器</p><pre><code class="hljs css"><span class="hljs-selector-tag">ntpdate</span> <span class="hljs-selector-tag">ntp4</span><span class="hljs-selector-class">.aliyun</span><span class="hljs-selector-class">.com</span></code></pre><p>三台机器定时任务</p><pre><code class="hljs shell">crontab -e</code></pre><p>添加如下内容</p><pre><code class="hljs shell">*/1 * * * * /usr/sbin/ntpdate ntp4.aliyun.com;</code></pre><h4 id="6-三台机器添加普通用户"><a href="#6-三台机器添加普通用户" class="headerlink" title="6. 三台机器添加普通用户"></a>6. 三台机器添加普通用户</h4><p>三台linux服务器统一添加普通用户hadoop，并给以sudo权限，用于以后所有的大数据软件的安装</p><p>并统一设置普通用户的密码为 ==<strong>**</strong>==</p><pre><code class="hljs shell">useradd hadooppasswd hadoop</code></pre><p>普通用户的密码设置为<strong>**</strong></p><p>三台机器为普通用户添加sudo权限</p><pre><code class="hljs shell">visudo</code></pre><p> 增加如下内容</p><pre><code class="hljs shell">hadoop ALL=(ALL)    ALL</code></pre><h4 id="7-三台定义统一目录"><a href="#7-三台定义统一目录" class="headerlink" title="7. 三台定义统一目录"></a>7. 三台定义统一目录</h4><p>定义三台linux服务器软件压缩包存放目录，以及解压后安装目录，三台机器执行以下命令，创建两个文件夹，一个用于存放软件压缩包目录，一个用于存放解压后目录</p><pre><code class="hljs shell">mkdir -p /weitrue/soft   # 软件压缩包存放目录mkdir -p /weitrue/install # 软件解压后存放目录chown -R hadoop:hadoop /weitrue  # 将文件夹权限更改为hadoop用户</code></pre><h4 id="8-三台机器hadoop用户免密码登录"><a href="#8-三台机器hadoop用户免密码登录" class="headerlink" title="8. 三台机器hadoop用户免密码登录"></a>8. 三台机器hadoop用户免密码登录</h4><p>切换用户为hadoop</p><pre><code class="hljs shell">su hadoop</code></pre><p>第一步：三台机器在<font color="red">hadoop</font>用户下执行以下命令生成公钥与私钥</p><pre><code class="hljs shell">ssh-keygen -t rsa</code></pre><p><font color="red">执行上述命令之后，按三次Enter键即可生成了</font></p><p>第二步：三台机器在hadoop用户下，执行命令拷贝公钥到node01服务器</p><pre><code class="hljs shell">ssh-copy-id node01</code></pre><p>第三步：node01服务器将公钥拷贝给node02与node03</p><p>node01在hadoop用户下，执行以下命令，将authorized_keys拷贝到node02与node03服务器</p><pre><code class="hljs shell">cd /home/hadoop/.ssh/scp authorized_keys node02:$PWDscp authorized_keys node03:$PWD</code></pre><p>第四步：验证；从任意节点是否能免秘钥登陆其他节点；如node01免密登陆node02</p><pre><code class="hljs sh">ssh node02</code></pre><h4 id="9-三台机器关机重启"><a href="#9-三台机器关机重启" class="headerlink" title="9. 三台机器关机重启"></a>9. 三台机器关机重启</h4><p>三台机器在hadoop用户下执行以下命令，实现关机重启</p><pre><code class="hljs shell">sudo reboot -h now</code></pre><h4 id="10-三台机器安装jdk"><a href="#10-三台机器安装jdk" class="headerlink" title="10. 三台机器安装jdk"></a>10. 三台机器安装jdk</h4><ul><li><p>使用hadoop用户来重新连接三台机器，然后使用hadoop用户来安装jdk软件</p></li><li><p>上传压缩包到第一台服务器的/weitrue/soft下面，然后进行解压，配置环境变量即可，三台机器都依次安装即可</p></li></ul><pre><code class="hljs shell">cd /weitrue/soft/tar -xzvf jdk-8u141-linux-x64.tar.gz -C /weitrue/install/sudo vim /etc/profile</code></pre><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">添加以下配置内容，配置jdk环境变量</span>export JAVA_HOME=/weitrue/install/jdk1.8.0_141export PATH=$PATH:$JAVA_HOME/bin</code></pre><p>让修改马上生效</p><pre><code class="hljs shell">source /etc/profile</code></pre><h3 id="3-hadoop集群的安装"><a href="#3-hadoop集群的安装" class="headerlink" title="3. hadoop集群的安装"></a>3. hadoop集群的安装</h3><p>注意：这里使用打包好的包“hadoop-2.6.0-cdh5.14.2_after_compile.tar.gz”安装部署集群</p><p>编译没有什么技巧，主要跟网络好坏有关</p><h4 id="1-CDH软件版本重新进行编译"><a href="#1-CDH软件版本重新进行编译" class="headerlink" title="1. CDH软件版本重新进行编译"></a>1. CDH软件版本重新进行编译</h4><h4 id="2-hadoop集群的安装"><a href="#2-hadoop集群的安装" class="headerlink" title="2. hadoop集群的安装"></a>2. hadoop集群的安装</h4><p>安装环境服务部署规划</p><table><thead><tr><th>服务器IP</th><th>192.168.51.100</th><th>192.168.51.110</th><th>192.168.51.120</th></tr></thead><tbody><tr><td>HDFS</td><td>NameNode</td><td></td><td></td></tr><tr><td>HDFS</td><td>SecondaryNameNode</td><td></td><td></td></tr><tr><td>HDFS</td><td>DataNode</td><td>DataNode</td><td>DataNode</td></tr><tr><td>YARN</td><td>ResourceManager</td><td></td><td></td></tr><tr><td>YARN</td><td>NodeManager</td><td>NodeManager</td><td>NodeManager</td></tr><tr><td>历史日志服务器</td><td>JobHistoryServer</td><td></td><td></td></tr></tbody></table><h5 id="第一步：上传压缩包并解压"><a href="#第一步：上传压缩包并解压" class="headerlink" title="第一步：上传压缩包并解压"></a>第一步：上传压缩包并解压</h5><ul><li>将我们重新编译之后支持snappy压缩的hadoop包上传到第一台服务器并解压；第一台机器执行以下命令</li></ul><pre><code class="hljs shell">cd /weitrue/soft/tar -xzvf hadoop-2.6.0-cdh5.14.2_after_compile.tar.gz -C /weitrue/install/</code></pre><h5 id="第二步：查看hadoop支持的压缩方式以及本地库"><a href="#第二步：查看hadoop支持的压缩方式以及本地库" class="headerlink" title="第二步：查看hadoop支持的压缩方式以及本地库"></a>第二步：查看hadoop支持的压缩方式以及本地库</h5><p>第一台机器执行以下命令</p><pre><code class="hljs shell">cd /weitrue/install/hadoop-2.6.0-cdh5.14.2bin/hadoop checknative</code></pre><p>如果出现openssl为false，那么所有机器在线安装openssl即可，执行以下命令，虚拟机联网之后就可以在线进行安装了</p><pre><code class="hljs shell">sudo yum -y install openssl-devel</code></pre><h5 id="第三步：修改配置文件"><a href="#第三步：修改配置文件" class="headerlink" title="第三步：修改配置文件"></a>第三步：修改配置文件</h5><h6 id="修改hadoop-env-sh"><a href="#修改hadoop-env-sh" class="headerlink" title="修改hadoop-env.sh"></a>修改hadoop-env.sh</h6><p>第一台机器执行以下命令</p><pre><code class="hljs shell">cd /weitrue/install/hadoop-2.6.0-cdh5.14.2/etc/hadoopvim hadoop-env.sh</code></pre><pre><code class="hljs shell">export JAVA_HOME=/weitrue/install/jdk1.8.0_141</code></pre><h6 id="修改core-site-xml"><a href="#修改core-site-xml" class="headerlink" title="修改core-site.xml"></a>修改core-site.xml</h6><p>第一台机器执行以下命令</p><pre><code class="hljs shell">cd /weitrue/install/hadoop-2.6.0-cdh5.14.2/etc/hadoopvim core-site.xml</code></pre><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">configuration</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>fs.defaultFS<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>hdfs://node01:8020<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span>    <span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>hadoop.tmp.dir<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>/weitrue/install/hadoop-2.6.0-cdh5.14.2/hadoopDatas/tempDatas<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span>    <span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>    <span class="hljs-comment">&lt;!-- 缓冲区大小，实际工作中根据服务器性能动态调整 --&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>io.file.buffer.size<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>4096<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span>    <span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>    <span class="hljs-comment">&lt;!-- 开启hdfs的垃圾桶机制，删除掉的数据可以从垃圾桶中回收，单位分钟 --&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>fs.trash.interval<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>10080<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span>    <span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">configuration</span>&gt;</span></code></pre><h6 id="修改hdfs-site-xml"><a href="#修改hdfs-site-xml" class="headerlink" title="修改hdfs-site.xml"></a>修改hdfs-site.xml</h6><p>第一台机器执行以下命令</p><pre><code class="hljs shell">cd /weitrue/install/hadoop-2.6.0-cdh5.14.2/etc/hadoopvim hdfs-site.xml</code></pre><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">configuration</span>&gt;</span><span class="hljs-comment">&lt;!-- NameNode存储元数据信息的路径，实际工作中，一般先确定磁盘的挂载目录，然后多个目录用，进行分割   --&gt;</span> <span class="hljs-comment">&lt;!--   集群动态上下线 &lt;property&gt;&lt;name&gt;dfs.hosts&lt;/name&gt;&lt;value&gt;/weitrue/install/hadoop-2.6.0-cdh5.14.2/etc/hadoop/accept_host&lt;/value&gt;&lt;/property&gt;&lt;property&gt;&lt;name&gt;dfs.hosts.exclude&lt;/name&gt;&lt;value&gt;/weitrue/install/hadoop-2.6.0-cdh5.14.2/etc/hadoop/deny_host&lt;/value&gt;&lt;/property&gt;--&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>dfs.namenode.secondary.http-address<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>node01:50090<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>dfs.namenode.http-address<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>node01:50070<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>dfs.namenode.name.dir<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>file:///weitrue/install/hadoop-2.6.0-cdh5.14.2/hadoopDatas/namenodeDatas<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><span class="hljs-comment">&lt;!-- 定义dataNode数据存储的节点位置，实际工作中，一般先确定磁盘的挂载目录，然后多个目录用，进行分割 --&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>dfs.datanode.data.dir<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>file:///weitrue/install/hadoop-2.6.0-cdh5.14.2/hadoopDatas/datanodeDatas<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>dfs.namenode.edits.dir<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>file:///weitrue/install/hadoop-2.6.0-cdh5.14.2/hadoopDatas/dfs/nn/edits<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>dfs.namenode.checkpoint.dir<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>file:///weitrue/install/hadoop-2.6.0-cdh5.14.2/hadoopDatas/dfs/snn/name<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>dfs.namenode.checkpoint.edits.dir<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>file:///weitrue/install/hadoop-2.6.0-cdh5.14.2/hadoopDatas/dfs/nn/snn/edits<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>dfs.replication<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>3<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>dfs.permissions<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>false<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>dfs.blocksize<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>134217728<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">configuration</span>&gt;</span></code></pre><h6 id="修改mapred-site-xml"><a href="#修改mapred-site-xml" class="headerlink" title="修改mapred-site.xml"></a>修改mapred-site.xml</h6><p>第一台机器执行以下命令</p><pre><code class="hljs shell">cd /weitrue/install/hadoop-2.6.0-cdh5.14.2/etc/hadoopmv mapred-site.xml.template mapred-site.xml vim mapred-site.xml</code></pre><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">configuration</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>mapreduce.framework.name<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>yarn<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span>    <span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>mapreduce.job.ubertask.enable<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span>    <span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>mapreduce.jobhistory.address<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>node01:10020<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span>    <span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>mapreduce.jobhistory.webapp.address<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>node01:19888<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span>    <span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">configuration</span>&gt;</span></code></pre><h6 id="修改yarn-site-xml"><a href="#修改yarn-site-xml" class="headerlink" title="修改yarn-site.xml"></a>修改yarn-site.xml</h6><p>第一台机器执行以下命令</p><pre><code class="hljs shell">cd /weitrue/install/hadoop-2.6.0-cdh5.14.2/etc/hadoopvim yarn-site.xml</code></pre><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">configuration</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>yarn.resourcemanager.hostname<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>node01<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span>    <span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>yarn.nodemanager.aux-services<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>mapreduce_shuffle<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span>    <span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">configuration</span>&gt;</span></code></pre><h6 id="修改slaves文件"><a href="#修改slaves文件" class="headerlink" title="修改slaves文件"></a>修改slaves文件</h6><p>第一台机器执行以下命令</p><pre><code class="hljs shell">cd /weitrue/install/hadoop-2.6.0-cdh5.14.2/etc/hadoopvim slaves</code></pre><p>原内容替换为</p><pre><code class="hljs gcode"><span class="hljs-symbol">node01</span><span class="hljs-symbol">node02</span><span class="hljs-symbol">node03</span></code></pre><h5 id="第四步：创建文件存放目录"><a href="#第四步：创建文件存放目录" class="headerlink" title="第四步：创建文件存放目录"></a>第四步：创建文件存放目录</h5><p>第一台机器执行以下命令</p><p>node01机器上面创建以下目录</p><pre><code class="hljs shell">mkdir -p /weitrue/install/hadoop-2.6.0-cdh5.14.2/hadoopDatas/tempDatasmkdir -p /weitrue/install/hadoop-2.6.0-cdh5.14.2/hadoopDatas/namenodeDatasmkdir -p /weitrue/install/hadoop-2.6.0-cdh5.14.2/hadoopDatas/datanodeDatas mkdir -p /weitrue/install/hadoop-2.6.0-cdh5.14.2/hadoopDatas/dfs/nn/editsmkdir -p /weitrue/install/hadoop-2.6.0-cdh5.14.2/hadoopDatas/dfs/snn/namemkdir -p /weitrue/install/hadoop-2.6.0-cdh5.14.2/hadoopDatas/dfs/nn/snn/edits</code></pre><h5 id="第五步：安装包的分发scp与rsync"><a href="#第五步：安装包的分发scp与rsync" class="headerlink" title="第五步：安装包的分发scp与rsync"></a>第五步：安装包的分发scp与rsync</h5><p>在linux当中，用于向远程服务器拷贝文件或者文件夹可以使用scp或者rsync，这两个命令功能类似都是向远程服务器进行拷贝，只不过scp是全量拷贝，rsync可以做到增量拷贝，rsync的效率比scp更高一些</p><h6 id="通过scp直接拷贝"><a href="#通过scp直接拷贝" class="headerlink" title="通过scp直接拷贝"></a>通过scp直接拷贝</h6><p>scp（secure copy）安全拷贝</p><p>可以通过scp进行不同服务器之间的文件或者文件夹的复制</p><p>使用语法 </p><pre><code class="hljs shell">scp -r sourceFile  username@host:destpath</code></pre><p>用法示例</p><pre><code class="hljs shell">scp -r hadoop-lzo-0.4.20.jar hadoop@node01:/weitrue/</code></pre><p>node01执行以下命令进行拷贝</p><pre><code class="hljs shell">cd /weitrue/install/scp -r hadoop-2.6.0-cdh5.14.2/ node02:$PWDscp -r hadoop-2.6.0-cdh5.14.2/ node03:$PWD</code></pre><h5 id="第六步：配置hadoop的环境变量"><a href="#第六步：配置hadoop的环境变量" class="headerlink" title="第六步：配置hadoop的环境变量"></a>第六步：配置hadoop的环境变量</h5><p>三台机器都要进行配置hadoop的环境变量</p><p>三台机器执行以下命令</p><pre><code class="hljs shell">sudo vim /etc/profile</code></pre><pre><code class="hljs shell">export HADOOP_HOME=/weitrue/install/hadoop-2.6.0-cdh5.14.2export PATH=$PATH:$HADOOP_HOME/bin:$HADOOP_HOME/sbin</code></pre><p>配置完成之后生效</p><pre><code class="hljs shell">source /etc/profile</code></pre><h5 id="第七步：集群启动"><a href="#第七步：集群启动" class="headerlink" title="第七步：集群启动"></a>第七步：集群启动</h5><h6 id="1-格式化集群"><a href="#1-格式化集群" class="headerlink" title="1. 格式化集群"></a>1. 格式化集群</h6><p>要启动 Hadoop 集群，需要启动 HDFS 和 YARN 两个集群。 </p><p>注意：首次启动HDFS时，必须对其进行格式化操作。本质上是一些清理和准备工作，因为此时的 HDFS 在物理上还是不存在的。<font color="red">格式化操作只有在首次启动的时候需要，以后再也不需要了</font></p><p><font color="red">node01执行一遍即可</font></p><pre><code class="hljs shell">hdfs namenode -format</code></pre><p>或者</p><pre><code class="hljs shell">hadoop namenode –format</code></pre><p><img src="/images/mac%E7%8E%AF%E5%A2%83%E4%B8%8B%E6%90%AD%E5%BB%BAhadoop%E9%9B%86%E7%BE%A4%E7%8E%AF%E5%A2%83/hadoop.png" srcset="/img/loading.gif" alt></p><p>启动集群有两种方式：①脚本一键启动；②单个进程逐个启动</p><h6 id="2-脚本一键启动"><a href="#2-脚本一键启动" class="headerlink" title="2. 脚本一键启动"></a>2. 脚本一键启动</h6><p>如果配置了 etc/hadoop/slaves 和 ssh 免密登录，则可以使用程序脚本启动所有Hadoop 两个集群的相关进程，在主节点所设定的机器上执行。</p><p>启动集群</p><p>node01节点上执行以下命令</p><p>第一台机器执行以下命令(hadoop/sbin目录下)</p><pre><code class="hljs shell">start-dfs.shstart-yarn.shmr-jobhistory-daemon.sh start historyserver</code></pre><p>停止集群：</p><pre><code class="hljs shell">stop-dfs.shstop-yarn.sh</code></pre><h6 id="3-单个进程逐个启动"><a href="#3-单个进程逐个启动" class="headerlink" title="3. 单个进程逐个启动"></a>3. 单个进程逐个启动</h6><pre><code class="hljs shell">在主节点上使用以下命令启动 HDFS NameNode： hadoop-daemon.sh start namenode 在每个从节点上使用以下命令启动 HDFS DataNode： hadoop-daemon.sh start datanode在主节点上使用以下命令启动 YARN ResourceManager： yarn-daemon.sh start resourcemanager 在每个从节点上使用以下命令启动 YARN nodemanager： yarn-daemon.sh start nodemanager 以上脚本位于$HADOOP_HOME/sbin/目录下。如果想要停止某个节点上某个角色，只需要把命令中的start 改为stop 即可。</code></pre><h6 id="4-一键启动hadoop集群的脚本"><a href="#4-一键启动hadoop集群的脚本" class="headerlink" title="4.一键启动hadoop集群的脚本"></a>4.一键启动hadoop集群的脚本</h6><p>我们也可以创建一键启动hadoop的脚本，以后启动hadoop都可以通过一个脚本即可</p><p>在node01服务器的/home/hadoop/bin目录下创建脚本</p><pre><code class="hljs shell">[hadoop@node01 bin]$ cd /home/hadoop/bin/[hadoop@node01 bin]$ vim hadoop.sh</code></pre><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">!/bin/bash</span>case $1 in"start" )&#123; source /etc/profile; /weitrue/install/hadoop-2.6.0-cdh5.14.2/sbin/start-dfs.sh /weitrue/install/hadoop-2.6.0-cdh5.14.2/sbin/start-yarn.sh /weitrue/install/hadoop-2.6.0-cdh5.14.2/sbin/mr-jobhistory-daemon.sh start historyserver&#125;;;"stop")&#123; /weitrue/install/hadoop-2.6.0-cdh5.14.2/sbin/stop-dfs.sh /weitrue/install/hadoop-2.6.0-cdh5.14.2/sbin/stop-yarn.sh /weitrue/install/hadoop-2.6.0-cdh5.14.2/sbin/mr-jobhistory-daemon.sh stop  historyserver&#125;;;esac</code></pre><p>修改脚本权限</p><pre><code class="hljs shell">[hadoop@node01 bin]$ chmod 777 hadoop.sh[hadoop@node01 bin]$ ./hadoop.sh start  # 启动hadoop集群[hadoop@node01 bin]$ ./hadoop.sh stop   # 停止hadoop集群</code></pre><h5 id="第八步：浏览器查看启动页面"><a href="#第八步：浏览器查看启动页面" class="headerlink" title="第八步：浏览器查看启动页面"></a>第八步：浏览器查看启动页面</h5><p>hdfs集群访问地址</p><p><a href="http://192.168.51.100:50070/" target="_blank" rel="noopener">http://192.168.51.100:50070/</a></p><p>yarn集群访问地址</p><p><a href="http://192.168.51.100:8088" target="_blank" rel="noopener">http://192.168.51.100:8088</a></p><p>jobhistory访问地址：</p><p><a href="http://192.168.51.100:19888" target="_blank" rel="noopener">http://192.168.51.100:19888</a></p><p>==如果要关闭电脑时，清一定要按照以下顺序操作，否则集群可能会出问题==</p><ul><li><p>关闭hadoop集群</p></li><li><p>关闭虚拟机</p></li><li><p>关闭电脑</p></li></ul>]]></content>
    
    
    <categories>
      
      <category>Bdata</category>
      
    </categories>
    
    
    <tags>
      
      <tag>mac</tag>
      
      <tag>Hadoop</tag>
      
      <tag>大数据</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【All】Git动图图解</title>
    <link href="/2020/06/14/git%E5%8A%A8%E5%9B%BE%E5%9B%BE%E8%A7%A3/"/>
    <url>/2020/06/14/git%E5%8A%A8%E5%9B%BE%E5%9B%BE%E8%A7%A3/</url>
    
    <content type="html"><![CDATA[<p><img src="/images/Windows%E4%B8%8B%E7%9A%84git%E7%9A%84%E5%AE%89%E8%A3%85%E4%B8%8E%E9%85%8D%E7%BD%AE/git.jpg" srcset="/img/loading.gif" alt><a id="more"></a> </p><h3 id="合并"><a href="#合并" class="headerlink" title="合并"></a>合并</h3><p>拥有多个分支是很方便的，这样可以将不同的新修改互相隔离开，而且还能确保你不会意外地向生产代码推送未经许可或破损的代码修改。但一旦这些修改得到了批准许可，我们就需要将其部署到我们的生产分支中！</p><p>可将一个分支的修改融入到另一个分支的一种方式是执行 git merge。Git 可执行两种类型的合并：fast-forward 和 no-fast-forward。现在你可能分不清，但我们马上就来看看它们的差异所在。</p><h4 id="Fast-forward-—ff"><a href="#Fast-forward-—ff" class="headerlink" title="Fast-forward (—ff)"></a>Fast-forward (—ff)</h4><p>在当前分支相比于我们要合并的分支没有额外的提交（commit）时，可以执行 fast-forward 合并。Git 很懒，首先会尝试执行最简单的选项：fast-forward！这类合并不会创建新的提交，而是会将我们正在合并的分支上的提交直接合并到当前分支。</p><p><img src="/images/git%E5%8A%A8%E6%80%81%E5%9B%BE%E8%A7%A3/image1.gif" srcset="/img/loading.gif" alt></p><p>完美！现在，我们在 dev 分支上所做的所有改变都合并到了 master 分支上。那么 no-fast-forward 又是什么意思呢？</p><h4 id="No-fast-foward-—no-ff"><a href="#No-fast-foward-—no-ff" class="headerlink" title="No-fast-foward (—no-ff)"></a>No-fast-foward (—no-ff)</h4><p>如果你的当前分支相比于你想要合并的分支没有任何提交，那当然很好，但很遗憾现实情况很少如此！如果我们在当前分支上提交我们想要合并的分支不具备的改变，那么 git 将会执行 no-fast-forward 合并。</p><p>使用 no-fast-forward 合并时，Git 会在当前活动分支上创建新的 merging commit。这个提交的父提交（parent commit）即指向这个活动分支，也指向我们想要合并的分支！</p><p><img src="/images/git%E5%8A%A8%E6%80%81%E5%9B%BE%E8%A7%A3/image2.gif" srcset="/img/loading.gif" alt></p><p>没什么大不了的，完美的合并！现在，我们在 dev 分支上所做的所有改变都合并到了 master 分支上。</p><h4 id="合并冲突"><a href="#合并冲突" class="headerlink" title="合并冲突"></a>合并冲突</h4><p>尽管 Git 能够很好地决定如何合并分支以及如何向文件添加修改，但它并不总是能完全自己做决定。当我们想要合并的两个分支的同一文件中的同一行代码上有不同的修改，或者一个分支删除了一个文件而另一个分支修改了这个文件时，Git 就不知道如何取舍了。</p><p>在这样的情况下，Git 会询问你想要保留哪种选择？假设在这两个分支中，我们都编辑了 README.md 的第一行。</p><p><img src="/images/git%E5%8A%A8%E6%80%81%E5%9B%BE%E8%A7%A3/image3.png" srcset="/img/loading.gif" alt></p><p>如果我们想把 dev 合并到 master，就会出现一个合并冲突：你想要标题是 Hello! 还是 Hey!？</p><p>当尝试合并这些分支时，Git 会向你展示冲突出现的位置。我们可以手动移除我们不想保留的修改，保存这些修改，再次添加这个已修改的文件，然后提交这些修改。</p><p><img src="/images/git%E5%8A%A8%E6%80%81%E5%9B%BE%E8%A7%A3/image4.gif" srcset="/img/loading.gif" alt></p><p>完成！尽管合并冲突往往很让人厌烦，但这是合理的：Git 不应该瞎猜我们想要保留哪些修改。</p><h3 id="变基（Rebasing）"><a href="#变基（Rebasing）" class="headerlink" title="变基（Rebasing）"></a>变基（Rebasing）</h3><p>我们刚看到可通过执行 git merge 将一个分支的修改应用到另一个分支。另一种可将一个分支的修改融入到另一个分支的方式是执行 git rebase。</p><p>git rebase 会将当前分支的提交复制到指定的分支之上。</p><p><img src="/images/git%E5%8A%A8%E6%80%81%E5%9B%BE%E8%A7%A3/image5.gif" srcset="/img/loading.gif" alt></p><p>完美，现在我们在 dev 分支上获取了 master 分支上的所有修改。</p><p>变基与合并有一个重大的区别：Git 不会尝试确定要保留或不保留哪些文件。我们执行 rebase 的分支总是含有我们想要保留的最新近的修改！这样我们不会遇到任何合并冲突，而且可以保留一个漂亮的、线性的 Git 历史记录。</p><p>上面这个例子展示了在 master 分支上的变基。但是，在更大型的项目中，你通常不需要这样的操作。git rebase 在为复制的提交创建新的 hash 时会修改项目的历史记录。</p><p>如果你在开发一个 feature 分支并且 master 分支已经更新过，那么变基就很好用。你可以在你的分支上获取所有更新，这能防止未来出现合并冲突。</p><h3 id="交互式变基（Interactive-Rebase）"><a href="#交互式变基（Interactive-Rebase）" class="headerlink" title="交互式变基（Interactive Rebase）"></a>交互式变基（Interactive Rebase）</h3><p>在为提交执行变基之前，我们可以修改它们！我们可以使用交互式变基来完成这一任务。交互式变基在你当前开发的分支上以及想要修改某些提交时会很有用。</p><p>在我们正在 rebase 的提交上，我们可以执行以下 6 个动作：</p><p>reword：修改提交信息；</p><p>edit：修改此提交；</p><p>squash：将提交融合到前一个提交中；</p><p>fixup：将提交融合到前一个提交中，不保留该提交的日志消息；</p><p>exec：在每个提交上运行我们想要 rebase 的命令；</p><p>drop：移除该提交。</p><p>很棒！这样我们就能完全控制我们的提交了。如果你想要移除一个提交，只需 drop 即可。</p><p><img src="/images/git%E5%8A%A8%E6%80%81%E5%9B%BE%E8%A7%A3/image6.gif" srcset="/img/loading.gif" alt></p><p>如果你想把多个提交融合到一起以便得到清晰的提交历史，那也没有问题！</p><p><img src="/images/git%E5%8A%A8%E6%80%81%E5%9B%BE%E8%A7%A3/image7.gif" srcset="/img/loading.gif" alt></p><p>交互式变基能为你在 rebase 时提供大量控制，甚至可以控制当前的活动分支。</p><h3 id="重置（Resetting）"><a href="#重置（Resetting）" class="headerlink" title="重置（Resetting）"></a>重置（Resetting）</h3><p>当我们不想要之前提交的修改时，就会用到这个命令。也许这是一个 WIP 提交或者可能是引入了 bug 的提交，这时候就要执行 git reset。</p><p>git reset 能让我们不再使用当前台面上的文件，让我们可以控制 HEAD 应该指向的位置。</p><h4 id="软重置"><a href="#软重置" class="headerlink" title="软重置"></a>软重置</h4><p>软重置会将 HEAD 移至指定的提交（或与 HEAD 相比的提交的索引），而不会移除该提交之后加入的修改！</p><p>假设我们不想保留添加了一个 style.css 文件的提交 9e78i，而且我们也不想保留添加了一个 index.js 文件的提交 035cc。但是，我们确实又想要保留新添加的 style.css 和 index.js 文件！这是软重置的一个完美用例。</p><p><img src="/images/git%E5%8A%A8%E6%80%81%E5%9B%BE%E8%A7%A3/image8.gif" srcset="/img/loading.gif" alt></p><p>输入 git status 后，你会看到我们仍然可以访问在之前的提交上做过的所有修改。这很好，这意味着我们可以修复这些文件的内容，之后再重新提交它们！</p><h4 id="硬重置"><a href="#硬重置" class="headerlink" title="硬重置"></a>硬重置</h4><p>有时候我们并不想保留特定提交引入的修改。不同于软重置，我们应该再也无需访问它们。Git 应该直接将整体状态直接重置到特定提交之前的状态：这甚至包括你在工作目录中和暂存文件上的修改。</p><p><img src="/images/git%E5%8A%A8%E6%80%81%E5%9B%BE%E8%A7%A3/image9.gif" srcset="/img/loading.gif" alt></p><p>Git 丢弃了 9e78i 和 035cc 引入的修改，并将状态重置到了 ec5be 的状态。</p><h3 id="还原（Reverting）"><a href="#还原（Reverting）" class="headerlink" title="还原（Reverting）"></a>还原（Reverting）</h3><p>另一种撤销修改的方法是执行 git revert。通过对特定的提交执行还原操作，我们会创建一个包含已还原修改的新提交。</p><p>假设 ec5be 添加了一个 index.js 文件。但之后我们发现其实我们再也不需要由这个提交引入的修改了。那就还原 ec5be 提交吧！</p><p><img src="/images/git%E5%8A%A8%E6%80%81%E5%9B%BE%E8%A7%A3/image10.gif" srcset="/img/loading.gif" alt></p><p>完美！提交 9e78i 还原了由提交 ec5be 引入的修改。在撤销特定的提交时，git revert 非常有用，同时也不会修改分支的历史。</p><h3 id="拣选（Cherry-picking）"><a href="#拣选（Cherry-picking）" class="headerlink" title="拣选（Cherry-picking）"></a>拣选（Cherry-picking）</h3><p>当一个特定分支包含我们的活动分支需要的某个提交时，我们对那个提交执行 cherry-pick！对一个提交执行 cherry-pick 时，我们会在活动分支上创建一个新的提交，其中包含由拣选出来的提交所引入的修改。</p><p>假设 dev 分支上的提交 76d12 为 index.js 文件添加了一项修改，而我们希望将其整合到 master 分支中。我们并不想要整个 dev 分支，而只需要这个提交！</p><p><img src="/images/git%E5%8A%A8%E6%80%81%E5%9B%BE%E8%A7%A3/image11.gif" srcset="/img/loading.gif" alt></p><p>现在 master 分支包含 76d12 引入的修改了。</p><h3 id="取回（Fetching）"><a href="#取回（Fetching）" class="headerlink" title="取回（Fetching）"></a>取回（Fetching）</h3><p>如果你有一个远程 Git 分支，比如在 GitHub 上的分支，当远程分支上包含当前分支没有的提交时，可以使用取回。比如当合并了另一个分支或你的同事推送了一个快速修复时。</p><p>通过在这个远程分支上执行 git fetch，我们就可在本地获取这些修改。这不会以任何方式影响你的本地分支：fetch 只是单纯地下载新的数据而已。</p><p><img src="/images/git%E5%8A%A8%E6%80%81%E5%9B%BE%E8%A7%A3/image12.gif" srcset="/img/loading.gif" alt></p><p>现在我们可以看到自上次推送以来的所有修改了。这些新数据也已经在本地了，我们可以决定用这些新数据做什么了。</p><h3 id="拉取（Pulling）"><a href="#拉取（Pulling）" class="headerlink" title="拉取（Pulling）"></a>拉取（Pulling）</h3><p>尽管 git fetch 可用于获取某个分支的远程信息，但我们也可以执行 git pull。git pull 实际上是两个命令合成了一个：git fetch 和 git merge。当我们从来源拉取修改时，我们首先是像 git fetch 那样取回所有数据，然后最新的修改会自动合并到本地分支中。</p><p><img src="/images/git%E5%8A%A8%E6%80%81%E5%9B%BE%E8%A7%A3/image13.gif" srcset="/img/loading.gif" alt></p><p>很好，我们现在与远程分支完美同步了，并且也有了所有最新的修改！</p><h3 id="Reflog"><a href="#Reflog" class="headerlink" title="Reflog"></a>Reflog</h3><p>每个人都会犯错，但犯错其实没啥！有时候你可能感觉你把 git repo 完全搞坏了，让你想完全删了了事。</p><p>git reflog 是一个非常有用的命令，可以展示已经执行过的所有动作的日志。包括合并、重置、还原，基本上包含你对你的分支所做的任何修改。</p><p><img src="/images/git%E5%8A%A8%E6%80%81%E5%9B%BE%E8%A7%A3/image14.gif" srcset="/img/loading.gif" alt></p><p>如果你犯了错，你可以根据 reflog 提供的信息通过重置 HEAD 来轻松地重做！</p><p>假设我们实际上并不需要合并原有分支。当我们执行 git reflog 命令时，我们可以看到这个 repo 的状态在合并前位于 HEAD@{1}。那我们就执行一次 git reset，将 HEAD 重新指向在 HEAD@{1} 的位置。</p><p><img src="/images/git%E5%8A%A8%E6%80%81%E5%9B%BE%E8%A7%A3/image15.gif" srcset="/img/loading.gif" alt></p><p>我们可以看到最新的动作已被推送给 reflog。</p>]]></content>
    
    
    <categories>
      
      <category>Develop</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Git</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【windows】Git的安装与配置</title>
    <link href="/2020/06/14/Windows%E4%B8%8B%E7%9A%84git%E7%9A%84%E5%AE%89%E8%A3%85%E4%B8%8E%E9%85%8D%E7%BD%AE/"/>
    <url>/2020/06/14/Windows%E4%B8%8B%E7%9A%84git%E7%9A%84%E5%AE%89%E8%A3%85%E4%B8%8E%E9%85%8D%E7%BD%AE/</url>
    
    <content type="html"><![CDATA[<p><img src="/images/Windows%E4%B8%8B%E7%9A%84git%E7%9A%84%E5%AE%89%E8%A3%85%E4%B8%8E%E9%85%8D%E7%BD%AE/git.jpg" srcset="/img/loading.gif" alt><a id="more"></a> </p><h3 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h3><h4 id="查看Git所有配置"><a href="#查看Git所有配置" class="headerlink" title="查看Git所有配置"></a>查看Git所有配置</h4><p>git config –list </p><h4 id="删除全局配置项"><a href="#删除全局配置项" class="headerlink" title="删除全局配置项"></a>删除全局配置项</h4><p>(1)终端执行命令：</p><p><code>git config --global --unset user.name</code></p><p>(2)编辑配置文件：</p><p><code>git config --global --edit</code></p><p>查看系统config</p><p><code>git config --system --list</code></p><p>查看当前用户（global）配置</p><p><code>git config --global --list</code></p><p>查看当前仓库配置信息</p><p><code>git config --local --list</code></p><h4 id="切换到需要提交的分支"><a href="#切换到需要提交的分支" class="headerlink" title="切换到需要提交的分支"></a>切换到需要提交的分支</h4><pre><code class="hljs haxe">git status     <span class="hljs-meta">#  查看git状态  </span>git branch     <span class="hljs-meta">#  查看git分支  </span>git checkout feature/<span class="hljs-keyword">new</span><span class="hljs-type">_branch</span> <span class="hljs-meta"># 切换到feature/new_branch分支</span></code></pre><h4 id="提交代码"><a href="#提交代码" class="headerlink" title="提交代码"></a>提交代码</h4><pre><code class="hljs dockerfile">git <span class="hljs-keyword">add</span><span class="bash"> .                                          <span class="hljs-comment"># 添加数据到镜像仓库                                             </span></span>                                                   <span class="hljs-comment"># 提交单个文件，进入你要提交的文件目录          </span>                                                   <span class="hljs-comment"># git add &lt;你要提交的文件&gt; </span>git commit -m <span class="hljs-string">'你要写的注释'</span>                         <span class="hljs-comment"># 提交到本地镜像仓库</span>git push -u origin feature/new_branch    <span class="hljs-comment"># 提交到远程镜像仓库</span></code></pre><h4 id="将远程分支拉取到本地"><a href="#将远程分支拉取到本地" class="headerlink" title="将远程分支拉取到本地"></a>将远程分支拉取到本地</h4><pre><code class="hljs arduino">git branch -a                                            # 查询所有分支,包括远程分支 git checkout -b <span class="hljs-built_in">release</span> remotes/origin/<span class="hljs-built_in">release</span>  # 将远程<span class="hljs-built_in">release</span>分支拉取到本地，并在本地创建<span class="hljs-built_in">release</span>分支</code></pre><p>绿色是当前所在本地分支，白色是本地分支，红色是远程分支<br><img src="/images/Windows%E4%B8%8B%E7%9A%84git%E7%9A%84%E5%AE%89%E8%A3%85%E4%B8%8E%E9%85%8D%E7%BD%AE/git-a.png" srcset="/img/loading.gif" alt></p><h3 id="分支代码拉取提交流程"><a href="#分支代码拉取提交流程" class="headerlink" title="分支代码拉取提交流程"></a>分支代码拉取提交流程</h3><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> 获取主干最新代码 </span><span class="hljs-meta">$</span><span class="bash"> git <span class="hljs-built_in">clone</span> &lt;repo&gt; </span><span class="hljs-meta">$</span><span class="bash"> git checkout develop   <span class="hljs-comment"># 开发分支 </span></span><span class="hljs-meta">$</span><span class="bash"> git pull               <span class="hljs-comment"># 同步分支 </span></span><span class="hljs-meta">#</span><span class="bash"> 新建一个开发分支my_feature </span><span class="hljs-meta">$</span><span class="bash"> git checkout -b feature/my_feature  </span><span class="hljs-meta">#</span><span class="bash"> 确认已切换到当前分支 </span><span class="hljs-meta">$</span><span class="bash"> git branch </span><span class="hljs-meta">#</span><span class="bash"> 保存所有的修改变化 </span><span class="hljs-meta">$</span><span class="bash"> git add --all 或者 git add . </span><span class="hljs-meta">#</span><span class="bash"> 查看发生变动的文件 </span><span class="hljs-meta">$</span><span class="bash"> git status  </span><span class="hljs-meta">#</span><span class="bash"> 编辑备注 $ git commit -m <span class="hljs-string">"implement api architecture"</span> </span><span class="hljs-meta">#</span><span class="bash"> 将分支代码push到服务器 $ git push origin -u feature/my_feature </span><span class="hljs-meta">#</span><span class="bash"> 合并分支feature/my_feature到develop </span><span class="hljs-meta">$</span><span class="bash"> git checkout develop </span><span class="hljs-meta">#</span><span class="bash"> 确保当前分支是最新的 </span><span class="hljs-meta">$</span><span class="bash"> git pull </span><span class="hljs-meta">$</span><span class="bash"> git merge --no-ff feature/my_feature  </span><span class="hljs-meta">#</span><span class="bash"> 分支开发过程中，为了减少冲突，尽量要多与主干同步 </span><span class="hljs-meta">$</span><span class="bash"> git fetch origin </span><span class="hljs-meta">$</span><span class="bash"> git rebase origin/develop </span><span class="hljs-meta">$</span><span class="bash"> git add .                <span class="hljs-comment"># 解决冲突后add </span></span><span class="hljs-meta">$</span><span class="bash"> git rebase --<span class="hljs-built_in">continue</span></span><span class="hljs-meta">#</span><span class="bash">删除分支 $ git branch -d feature/my_feature</span><span class="hljs-meta">#</span><span class="bash">取消commit </span><span class="hljs-meta">$</span><span class="bash"> git reset --hard &lt;commit <span class="hljs-built_in">log</span>&gt;</span></code></pre>]]></content>
    
    
    <categories>
      
      <category>Develop</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Windows</tag>
      
      <tag>Git</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【windows】基于PyCharm构建与开发Django项目</title>
    <link href="/2020/06/14/windows%E4%B8%8B%E5%9F%BA%E4%BA%8Epycharm%E6%9E%84%E5%BB%BAdjango-web%E9%A1%B9%E7%9B%AE/"/>
    <url>/2020/06/14/windows%E4%B8%8B%E5%9F%BA%E4%BA%8Epycharm%E6%9E%84%E5%BB%BAdjango-web%E9%A1%B9%E7%9B%AE/</url>
    
    <content type="html"><![CDATA[<p><img src="/images/windows%E4%B8%8B%E5%9F%BA%E4%BA%8Epycharm%E6%9E%84%E5%BB%BAdjango-web%E9%A1%B9%E7%9B%AE/logo.jpg" srcset="/img/loading.gif" alt><a id="more"></a> </p><p><strong>1.安装第三方库Django</strong></p><p><img src="/images/windows%E4%B8%8B%E5%9F%BA%E4%BA%8Epycharm%E6%9E%84%E5%BB%BAdjango-web%E9%A1%B9%E7%9B%AE/1.png" srcset="/img/loading.gif" alt></p><p><strong>2.pycharm创建Django项目</strong></p><p><img src="/images/windows%E4%B8%8B%E5%9F%BA%E4%BA%8Epycharm%E6%9E%84%E5%BB%BAdjango-web%E9%A1%B9%E7%9B%AE/2.png" srcset="/img/loading.gif" alt></p><p><strong>3.安装mysql第三方库</strong></p><p><img src="/images/windows%E4%B8%8B%E5%9F%BA%E4%BA%8Epycharm%E6%9E%84%E5%BB%BAdjango-web%E9%A1%B9%E7%9B%AE/3.png" srcset="/img/loading.gif" alt></p><p><strong>4.配置mysql数据库环境</strong></p><p><img src="/images/windows%E4%B8%8B%E5%9F%BA%E4%BA%8Epycharm%E6%9E%84%E5%BB%BAdjango-web%E9%A1%B9%E7%9B%AE/4.png" srcset="/img/loading.gif" alt></p><p><strong>5.生成django默认数据表</strong></p><p>tool –&gt;Run manage.py task</p><pre><code class="hljs ebnf"><span class="hljs-attribute">makemigrations migrate</span></code></pre><p><img src="/images/windows%E4%B8%8B%E5%9F%BA%E4%BA%8Epycharm%E6%9E%84%E5%BB%BAdjango-web%E9%A1%B9%E7%9B%AE/5.png" srcset="/img/loading.gif" alt></p><p>查看数据表，会发现生成了django的数据表</p><p><img src="/images/windows%E4%B8%8B%E5%9F%BA%E4%BA%8Epycharm%E6%9E%84%E5%BB%BAdjango-web%E9%A1%B9%E7%9B%AE/5-1.png" srcset="/img/loading.gif" alt></p><p><strong>6.创建一个app</strong></p><p>startapp user</p><p><img src="/images/windows%E4%B8%8B%E5%9F%BA%E4%BA%8Epycharm%E6%9E%84%E5%BB%BAdjango-web%E9%A1%B9%E7%9B%AE/6-1.png" srcset="/img/loading.gif" alt></p><p>项目目录下会生成</p><p><img src="/images/windows%E4%B8%8B%E5%9F%BA%E4%BA%8Epycharm%E6%9E%84%E5%BB%BAdjango-web%E9%A1%B9%E7%9B%AE/6-2.png" srcset="/img/loading.gif" alt></p><p><strong>7.自定义user表</strong></p><p>Django生成的user表</p><ul><li>id: 主键, password 密码, last_login Django自动记录用户最后登录时间,。</li><li>is_superuser 表明用户是否是超级用户(后台管理会用到)。</li><li>username 用户名字段不要随便改动, email 邮箱,</li><li>is_staff 表示是否是员工(后台管理会用到)。</li><li>is_active 用户是否是激活状态, date_joined 注册时间。</li></ul><p>这些往往不能满足我们自身的需求，因此需要自定义user表，在user下的models.py文件添加代码</p><pre><code class="hljs python"><span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> datetime<span class="hljs-keyword">from</span> django.db <span class="hljs-keyword">import</span> models<span class="hljs-keyword">from</span> django.contrib.auth.models <span class="hljs-keyword">import</span> AbstractUser<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TbUser</span><span class="hljs-params">(AbstractUser)</span>:</span>    nickname = models.CharField(null=<span class="hljs-literal">True</span>, max_length=<span class="hljs-number">50</span>, verbose_name=<span class="hljs-string">'昵称'</span>,)    birthday = models.DateField(null=<span class="hljs-literal">True</span>, verbose_name=<span class="hljs-string">'生日'</span>)    gender = models.IntegerField(choices=((<span class="hljs-number">1</span>, <span class="hljs-string">'男'</span>), (<span class="hljs-number">0</span>, <span class="hljs-string">'女'</span>)), verbose_name=<span class="hljs-string">'性别'</span>, default=<span class="hljs-number">1</span>)    address = models.CharField(null=<span class="hljs-literal">True</span>, max_length=<span class="hljs-number">200</span>, verbose_name=<span class="hljs-string">'地址'</span>)   phone = models.CharField(null=<span class="hljs-literal">True</span>, blank=<span class="hljs-literal">True</span>, max_length=<span class="hljs-number">11</span>, verbose_name=<span class="hljs-string">'手机'</span>)   head = models.ImageField(upload_to=<span class="hljs-string">'image/%Y/%m'</span>, max_length=<span class="hljs-number">100</span>, verbose_name=<span class="hljs-string">'头像'</span>, default=<span class="hljs-string">'image/default_m.png'</span>) <span class="hljs-comment"># 注意这里的head使用ImageField，需要安装依赖库pip install pillow</span>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Meta</span>:</span>        db_table = <span class="hljs-string">'tb_user'</span>        verbose_name = <span class="hljs-string">'用户信息'</span>        verbose_name_plural = verbose_name    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__str__</span><span class="hljs-params">(self)</span>:</span>        <span class="hljs-keyword">return</span> self.username</code></pre><p>修改settings.py文件</p><p><img src="/images/windows%E4%B8%8B%E5%9F%BA%E4%BA%8Epycharm%E6%9E%84%E5%BB%BAdjango-web%E9%A1%B9%E7%9B%AE/7-1.png" srcset="/img/loading.gif" alt></p><p>在这里，def <strong>str</strong>(self)：方法在python3.x版本使用，用于后台展示样式是显示的是用户名。保存后，使用django敏玲重新生成表</p><p>tool –&gt;Run manage.py task</p><pre><code class="hljs routeros">makemigrations<span class="hljs-built_in"> user </span>migrate user</code></pre><p>创建后台管理用户</p><pre><code class="hljs ebnf"><span class="hljs-attribute">createsuperuser</span></code></pre><p>填写用户名、邮箱和密码</p><p><img src="/images/windows%E4%B8%8B%E5%9F%BA%E4%BA%8Epycharm%E6%9E%84%E5%BB%BAdjango-web%E9%A1%B9%E7%9B%AE/7-2.png" srcset="/img/loading.gif" alt></p><p>可以查看到数据库中新增一条数据</p><p><img src="/images/windows%E4%B8%8B%E5%9F%BA%E4%BA%8Epycharm%E6%9E%84%E5%BB%BAdjango-web%E9%A1%B9%E7%9B%AE/7-3.png" srcset="/img/loading.gif" alt></p><p>这样就可以登录后台管理页面了</p><p><strong>8.集成xadmin组件</strong></p><p>python3.x无法直接使用安装包</p><pre><code class="hljs awk">pip install git+git:<span class="hljs-regexp">//gi</span>thub.com<span class="hljs-regexp">/sshwsfc/</span>xadmin.git@django2</code></pre><p>或者访问<a href="https://github.com/sshwsfc/xadmin/tree/django2，（git" target="_blank" rel="noopener">https://github.com/sshwsfc/xadmin/tree/django2，（git</a> clone -b django2 <a href="https://github.com/sshwsfc/xadmin.git）将xadmin目录下文件拷贝到项目下" target="_blank" rel="noopener">https://github.com/sshwsfc/xadmin.git）将xadmin目录下文件拷贝到项目下</a></p><p><img src="/images/windows%E4%B8%8B%E5%9F%BA%E4%BA%8Epycharm%E6%9E%84%E5%BB%BAdjango-web%E9%A1%B9%E7%9B%AE/8-1.png" srcset="/img/loading.gif" alt></p><p>在settings.py文件下添加相应配置</p><p><img src="/images/windows%E4%B8%8B%E5%9F%BA%E4%BA%8Epycharm%E6%9E%84%E5%BB%BAdjango-web%E9%A1%B9%E7%9B%AE/8-2.png" srcset="/img/loading.gif" alt></p><p>把urls中默认admin指向Xadmin</p><pre><code class="hljs python"><span class="hljs-comment"># 导入x admin，替换admin</span><span class="hljs-keyword">import</span> xadminurlpatterns = [    path(<span class="hljs-string">'xadmin/'</span>, xadmin.site.urls),, <span class="hljs-comment"># django2中也可以是 url(r'^xadmin/', xadmin.site.urls)</span>]</code></pre><p>点击Tools 菜单下 Run manage.py Task</p><pre><code class="hljs ebnf"><span class="hljs-attribute">makemigrations migrate</span></code></pre><p>访问<a href="http://127.0.0.1/admin/" target="_blank" rel="noopener">http://127.0.0.1/admin/</a></p><p><img src="/images/windows%E4%B8%8B%E5%9F%BA%E4%BA%8Epycharm%E6%9E%84%E5%BB%BAdjango-web%E9%A1%B9%E7%9B%AE/8-3.png" srcset="/img/loading.gif" alt></p><p>新建user/adminx.py，进行app model注册：</p><pre><code class="hljs python"><span class="hljs-comment"># 创建xadmin的全局管理器并与view绑定。</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BaseSetting</span><span class="hljs-params">(object)</span>:</span>    <span class="hljs-comment"># 开启主题功能</span>    enable_themes = <span class="hljs-literal">True</span>    use_bootswatch = <span class="hljs-literal">True</span><span class="hljs-comment"># xadmin 全局配置参数信息设置</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">GlobalSettings</span><span class="hljs-params">(object)</span>:</span>    site_title = <span class="hljs-string">"supe-wa慕课小站"</span>    site_footer = <span class="hljs-string">"supe-wa慕课小站|后台管理系统"</span>    <span class="hljs-comment"># 收起菜单</span>    menu_style = <span class="hljs-string">"accordion"</span>    <span class="hljs-comment"># 自定义导航楼目录</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_site_menu</span><span class="hljs-params">(self)</span>:</span>        <span class="hljs-keyword">return</span> (            &#123;<span class="hljs-string">'title'</span>: <span class="hljs-string">'课程信息管理'</span>, <span class="hljs-string">'menus'</span>: (                &#123;<span class="hljs-string">'title'</span>: <span class="hljs-string">'课程信息管理'</span>, <span class="hljs-string">'url'</span>: self.get_model_url(TbCourse, <span class="hljs-string">'changelist'</span>)&#125;,                &#123;<span class="hljs-string">'title'</span>: <span class="hljs-string">'章节信息管理'</span>, <span class="hljs-string">'url'</span>: self.get_model_url(TbCourseLesson, <span class="hljs-string">'changelist'</span>)&#125;,                &#123;<span class="hljs-string">'title'</span>: <span class="hljs-string">'视频信息管理'</span>, <span class="hljs-string">'url'</span>: self.get_model_url(TbCourseVideo, <span class="hljs-string">'changelist'</span>)&#125;,                &#123;<span class="hljs-string">'title'</span>: <span class="hljs-string">'课程资源管理'</span>, <span class="hljs-string">'url'</span>: self.get_model_url(TbCourseResource, <span class="hljs-string">'changelist'</span>)&#125;,                &#123;<span class="hljs-string">'title'</span>: <span class="hljs-string">'课程评论管理'</span>, <span class="hljs-string">'url'</span>: self.get_model_url(TbCourseComment, <span class="hljs-string">'changelist'</span>)&#125;,            )&#125;,            &#123;<span class="hljs-string">'title'</span>: <span class="hljs-string">'机构信息管理'</span>, <span class="hljs-string">'menus'</span>: (                &#123;<span class="hljs-string">'title'</span>: <span class="hljs-string">'城市信息管理'</span>, <span class="hljs-string">'url'</span>: self.get_model_url(TcCityDict, <span class="hljs-string">'changelist'</span>)&#125;,                &#123;<span class="hljs-string">'title'</span>: <span class="hljs-string">'机构信息管理'</span>, <span class="hljs-string">'url'</span>: self.get_model_url(TbOrg, <span class="hljs-string">'changelist'</span>)&#125;,                &#123;<span class="hljs-string">'title'</span>: <span class="hljs-string">'机构讲师管理'</span>, <span class="hljs-string">'url'</span>: self.get_model_url(TbOrgTeacher, <span class="hljs-string">'changelist'</span>)&#125;,            )&#125;,            &#123;<span class="hljs-string">'title'</span>: <span class="hljs-string">'用户信息管理'</span>, <span class="hljs-string">'menus'</span>: (                &#123;<span class="hljs-string">'title'</span>: <span class="hljs-string">'用户信息管理'</span>, <span class="hljs-string">'url'</span>: self.get_model_url(TbUser, <span class="hljs-string">'changelist'</span>)&#125;,                &#123;<span class="hljs-string">'title'</span>: <span class="hljs-string">'用户验证管理'</span>, <span class="hljs-string">'url'</span>: self.get_model_url(TbEmailVerifyRecord, <span class="hljs-string">'changelist'</span>)&#125;,                &#123;<span class="hljs-string">'title'</span>: <span class="hljs-string">'用户课程管理'</span>, <span class="hljs-string">'url'</span>: self.get_model_url(TbUserCourse, <span class="hljs-string">'changelist'</span>)&#125;,                &#123;<span class="hljs-string">'title'</span>: <span class="hljs-string">'用户收藏管理'</span>, <span class="hljs-string">'url'</span>: self.get_model_url(TbUserFavorite, <span class="hljs-string">'changelist'</span>)&#125;,                &#123;<span class="hljs-string">'title'</span>: <span class="hljs-string">'用户消息管理'</span>, <span class="hljs-string">'url'</span>: self.get_model_url(TbUserMessage, <span class="hljs-string">'changelist'</span>)&#125;,            )&#125;,            &#123;<span class="hljs-string">'title'</span>: <span class="hljs-string">'系统信息管理'</span>, <span class="hljs-string">'menus'</span>: (                &#123;<span class="hljs-string">'title'</span>: <span class="hljs-string">'用户咨询'</span>, <span class="hljs-string">'url'</span>: self.get_model_url(TbUserAsk, <span class="hljs-string">'changelist'</span>)&#125;,                &#123;<span class="hljs-string">'title'</span>: <span class="hljs-string">'首页轮播'</span>, <span class="hljs-string">'url'</span>: self.get_model_url(TcBanner, <span class="hljs-string">'changelist'</span>)&#125;,                &#123;<span class="hljs-string">'title'</span>: <span class="hljs-string">'用户分组'</span>, <span class="hljs-string">'url'</span>: self.get_model_url(Group, <span class="hljs-string">'changelist'</span>)&#125;,                &#123;<span class="hljs-string">'title'</span>: <span class="hljs-string">'用户权限'</span>, <span class="hljs-string">'url'</span>: self.get_model_url(Permission, <span class="hljs-string">'changelist'</span>)&#125;,                &#123;<span class="hljs-string">'title'</span>: <span class="hljs-string">'日志记录'</span>, <span class="hljs-string">'url'</span>: self.get_model_url(Log, <span class="hljs-string">'changelist'</span>)&#125;,            )&#125;,)            <span class="hljs-comment"># 将全局配置管理与view绑定注册</span>xadmin.site.register(views.CommAdminView, GlobalSettings)xadmin.site.register(views.BaseAdminView, BaseSetting)</code></pre><p>登录后</p><p><img src="/images/windows%E4%B8%8B%E5%9F%BA%E4%BA%8Epycharm%E6%9E%84%E5%BB%BAdjango-web%E9%A1%B9%E7%9B%AE/8-4.png" srcset="/img/loading.gif" alt></p>]]></content>
    
    
    <categories>
      
      <category>Python</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Windows</tag>
      
      <tag>Python</tag>
      
      <tag>Django</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
