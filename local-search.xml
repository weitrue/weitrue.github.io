<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>ã€ALLã€‘ETCDé”®å€¼å­˜å‚¨ç³»ç»Ÿ</title>
    <link href="/2021/07/01/etcd/"/>
    <url>/2021/07/01/etcd/</url>
    
    <content type="html"><![CDATA[<blockquote><p>A highly-available key value store for shared configuration and service discovery.<a id="more"></a> </p></blockquote>]]></content>
    
    
    <categories>
      
      <category>Develop</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Raft</tag>
      
      <tag>Etcd</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€LeetCodeã€‘æŸ¥æ‰¾ä¸æœç´¢</title>
    <link href="/2021/06/21/lt-search/"/>
    <url>/2021/06/21/lt-search/</url>
    
    <content type="html"><![CDATA[<h3 id="æŸ¥æ‰¾ä¸æœç´¢"><a href="#æŸ¥æ‰¾ä¸æœç´¢" class="headerlink" title="æŸ¥æ‰¾ä¸æœç´¢"></a><a id="more"></a>æŸ¥æ‰¾ä¸æœç´¢</h3><h4 id="äºŒåˆ†ç®—æ³•"><a href="#äºŒåˆ†ç®—æ³•" class="headerlink" title="äºŒåˆ†ç®—æ³•"></a><strong>äºŒåˆ†ç®—æ³•</strong></h4><h4 id="å“ˆå¸Œä¸å¸ƒéš†è¿‡æ»¤å™¨"><a href="#å“ˆå¸Œä¸å¸ƒéš†è¿‡æ»¤å™¨" class="headerlink" title="å“ˆå¸Œä¸å¸ƒéš†è¿‡æ»¤å™¨"></a>å“ˆå¸Œä¸å¸ƒéš†è¿‡æ»¤å™¨</h4><h4 id="DFS-amp-amp-BFS"><a href="#DFS-amp-amp-BFS" class="headerlink" title="DFS &amp;&amp; BFS"></a>DFS &amp;&amp; BFS</h4>]]></content>
    
    
    <categories>
      
      <category>Leetcode</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Python</tag>
      
      <tag>Go</tag>
      
      <tag>Java</tag>
      
      <tag>LeetCode</tag>
      
      <tag>scala</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€Goã€‘é¢è¯•/ç¬”è¯•ä¹‹é“</title>
    <link href="/2021/06/02/golang-interview/"/>
    <url>/2021/06/02/golang-interview/</url>
    
    <content type="html"><![CDATA[]]></content>
    
    
    <categories>
      
      <category>Golang</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Go</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€Goã€‘ä½¿ç”¨ä¹‹é“</title>
    <link href="/2021/06/02/golang-src/"/>
    <url>/2021/06/02/golang-src/</url>
    
    <content type="html"><![CDATA[<h3 id="å¸¸è§åº“-æ¡†æ¶"><a href="#å¸¸è§åº“-æ¡†æ¶" class="headerlink" title="å¸¸è§åº“/æ¡†æ¶"></a>å¸¸è§åº“/æ¡†æ¶</h3><h4 id="åŸç”Ÿåº“"><a href="#åŸç”Ÿåº“" class="headerlink" title="åŸç”Ÿåº“"></a>åŸç”Ÿåº“</h4><h5 id="unsafe"><a href="#unsafe" class="headerlink" title="unsafe"></a>unsafe</h5><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">Test</span><span class="hljs-params">(t *testing.T)</span></span>  &#123;<span class="hljs-comment">// ä»»ä½•ç±»å‹çš„æŒ‡é’ˆå€¼éƒ½å¯ä»¥è½¬æ¢ä¸ºPointer // unsafe.Pointer(&amp;a1)</span><span class="hljs-comment">// Pointerå¯ä»¥è½¬æ¢ä¸ºä»»ä½•ç±»å‹çš„æŒ‡é’ˆå€¼ // (*float32)(unsafe.Pointer(numPointer))</span><span class="hljs-comment">// uintptrå¯ä»¥è½¬æ¢ä¸º Pointer // unsafe.Pointer(uintptr(nPointer) + + unsafe.Sizeof(&amp;a) * 3)</span><span class="hljs-comment">// Pointerå¯ä»¥è½¬æ¢ä¸º uintptr // uintptr(unsafe.Pointer(numPointer))</span><span class="hljs-comment">// uintptr æ˜¯ä¸€ä¸ªæ•´æ•°ç±»å‹ï¼Œå®ƒè¶³å¤Ÿå¤§ï¼Œå¯ä»¥å­˜å‚¨. åªæœ‰å°†Pointerè½¬æ¢æˆuintptræ‰èƒ½è¿›è¡ŒæŒ‡é’ˆçš„ç›¸å…³æ“ä½œ</span><span class="hljs-keyword">var</span> a <span class="hljs-keyword">int32</span> = <span class="hljs-number">10</span>tt := unsafe.Sizeof(a)fmt.Println(tt)  <span class="hljs-comment">// 4</span><span class="hljs-keyword">var</span> ab <span class="hljs-keyword">int64</span> = <span class="hljs-number">10</span>fmt.Println(unsafe.Sizeof(ab))  <span class="hljs-comment">// 8</span><span class="hljs-keyword">var</span> abc <span class="hljs-keyword">int</span> = <span class="hljs-number">10</span>fmt.Println(unsafe.Sizeof(abc))  <span class="hljs-comment">// 8</span><span class="hljs-keyword">var</span> b <span class="hljs-keyword">string</span> = <span class="hljs-string">&quot;test&quot;</span>fmt.Println(unsafe.Sizeof(b))   <span class="hljs-comment">// 16 Sizeof(string)å è®¡ç®—string headerçš„å¤§å°, struct string &#123; uint8 *str; int len;&#125;</span><span class="hljs-keyword">var</span> bc <span class="hljs-keyword">string</span> = <span class="hljs-string">&quot;test-test-test-test-test-test-test-test-test-test-test-test-test-test&quot;</span>fmt.Println(unsafe.Sizeof(bc))  <span class="hljs-comment">// 16 Sizeof(string)å è®¡ç®—string headerçš„å¤§å°, struct string &#123; uint8 *str; int len;&#125;</span><span class="hljs-keyword">type</span> aa <span class="hljs-keyword">struct</span> &#123;B <span class="hljs-keyword">bool</span>C <span class="hljs-keyword">uint64</span>&#125;c := aa&#123;&#125;fmt.Println(unsafe.Sizeof(c))  <span class="hljs-comment">// 16 æ¶‰åŠåˆ°å†…å­˜å¯¹é½çš„é—®é¢˜</span><span class="hljs-comment">// è¿”å›ç»“æ„ä½“ä¸­æŸä¸ªå­—æ®µçš„åç§»é‡, è¿™ä¸ªå­—æ®µå¿…é¡»æ˜¯structValue.fieldå½¢å¼. ä¹Ÿå°±æ˜¯è¿”å›ç»“æ„ä½“å˜é‡çš„å¼€å§‹ä½ç½®åˆ°é‚£ä¸ªå­—æ®µçš„å¼€å§‹ä½ç½®ä¹‹é—´å­—èŠ‚æ•°.</span>fmt.Println(unsafe.Offsetof(c.B), unsafe.Offsetof(c.C)) <span class="hljs-comment">// 0 8</span>fmt.Println(unsafe.Sizeof(<span class="hljs-keyword">bool</span>(<span class="hljs-literal">true</span>)))           <span class="hljs-comment">// 1</span><span class="hljs-keyword">type</span> bb <span class="hljs-keyword">struct</span> &#123;B *<span class="hljs-keyword">bool</span>&#125;c1 := bb&#123;&#125;fmt.Println(unsafe.Sizeof(c1)) <span class="hljs-comment">// æŒ‡é’ˆå 8ä¸ªå­—èŠ‚(64ä½æœºå™¨)</span><span class="hljs-comment">// å†…å­˜å¯¹é½</span><span class="hljs-comment">// å°±æ˜¯ä¸ºäº†åŠ å¿«å†…å­˜çš„å­˜å–é€Ÿåº¦, ç”¨ç©ºé—´æ¢æ—¶é—´çš„åšæ³•</span>fmt.Printf(<span class="hljs-string">&quot;bool: %d\n&quot;</span>, unsafe.Alignof(<span class="hljs-keyword">bool</span>(<span class="hljs-literal">true</span>)))           <span class="hljs-comment">// 1</span>fmt.Printf(<span class="hljs-string">&quot;int32: %d\n&quot;</span>, unsafe.Alignof(<span class="hljs-keyword">int32</span>(<span class="hljs-number">0</span>)))            <span class="hljs-comment">// 4</span>fmt.Printf(<span class="hljs-string">&quot;int8: %d\n&quot;</span>, unsafe.Alignof(<span class="hljs-keyword">int8</span>(<span class="hljs-number">0</span>)))              <span class="hljs-comment">// 1</span>fmt.Printf(<span class="hljs-string">&quot;int64: %d\n&quot;</span>, unsafe.Alignof(<span class="hljs-keyword">int64</span>(<span class="hljs-number">0</span>)))            <span class="hljs-comment">// 8</span>fmt.Printf(<span class="hljs-string">&quot;byte: %d\n&quot;</span>, unsafe.Alignof(<span class="hljs-keyword">byte</span>(<span class="hljs-number">0</span>)))              <span class="hljs-comment">// 1</span>fmt.Printf(<span class="hljs-string">&quot;string: %d\n&quot;</span>, unsafe.Alignof(<span class="hljs-keyword">string</span>(<span class="hljs-string">&quot;true&quot;</span>)))     <span class="hljs-comment">// 8</span>fmt.Printf(<span class="hljs-string">&quot;map: %d\n&quot;</span>, unsafe.Alignof(<span class="hljs-keyword">map</span>[<span class="hljs-keyword">string</span>]<span class="hljs-keyword">string</span>&#123;&#125;))   <span class="hljs-comment">// 8</span><span class="hljs-comment">// å¯¹é½è§„åˆ™</span><span class="hljs-comment">// 1.ç»“æ„ä½“çš„æˆå‘˜å˜é‡ï¼Œç¬¬ä¸€ä¸ªæˆå‘˜å˜é‡çš„åç§»é‡ä¸º 0ã€‚å¾€åçš„æ¯ä¸ªæˆå‘˜å˜é‡çš„å¯¹é½å€¼å¿…é¡»ä¸ºç¼–è¯‘å™¨é»˜è®¤å¯¹é½é•¿åº¦ï¼ˆ#pragma pack(n)ï¼‰æˆ–å½“å‰æˆå‘˜å˜é‡ç±»å‹çš„é•¿åº¦ï¼ˆunsafe.Sizeofï¼‰ï¼Œå–æœ€å°å€¼ä½œä¸ºå½“å‰ç±»å‹çš„å¯¹é½å€¼ã€‚å…¶åç§»é‡å¿…é¡»ä¸ºå¯¹é½å€¼çš„æ•´æ•°å€</span><span class="hljs-comment">// 2.ç»“æ„ä½“æœ¬èº«ï¼Œå¯¹é½å€¼å¿…é¡»ä¸ºç¼–è¯‘å™¨é»˜è®¤å¯¹é½é•¿åº¦ï¼ˆ#pragma pack(n)ï¼‰æˆ–ç»“æ„ä½“çš„æ‰€æœ‰æˆå‘˜å˜é‡ç±»å‹ä¸­çš„æœ€å¤§é•¿åº¦ï¼Œå–æœ€å¤§æ•°çš„æœ€å°æ•´æ•°å€ä½œä¸ºå¯¹é½å€¼</span><span class="hljs-comment">// 3.ç»“åˆä»¥ä¸Šä¸¤ç‚¹ï¼Œå¯å¾—çŸ¥è‹¥ç¼–è¯‘å™¨é»˜è®¤å¯¹é½é•¿åº¦ï¼ˆ#pragma pack(n)ï¼‰è¶…è¿‡ç»“æ„ä½“å†…æˆå‘˜å˜é‡çš„ç±»å‹æœ€å¤§é•¿åº¦æ—¶ï¼Œé»˜è®¤å¯¹é½é•¿åº¦æ˜¯æ²¡æœ‰ä»»ä½•æ„ä¹‰çš„</span><span class="hljs-keyword">type</span> Part1 <span class="hljs-keyword">struct</span> &#123;a <span class="hljs-keyword">bool</span>b <span class="hljs-keyword">int32</span>c <span class="hljs-keyword">int8</span>d <span class="hljs-keyword">int64</span>e <span class="hljs-keyword">byte</span>&#125;part := Part1&#123;&#125;fmt.Printf(<span class="hljs-string">&quot;Part1 Size: %d, align: %d\n&quot;</span>, unsafe.Sizeof(part), unsafe.Alignof(part))   <span class="hljs-comment">// 32 8</span><span class="hljs-keyword">type</span> Part2 <span class="hljs-keyword">struct</span> &#123;a <span class="hljs-keyword">bool</span>e <span class="hljs-keyword">byte</span>c <span class="hljs-keyword">int8</span>b <span class="hljs-keyword">int32</span>d <span class="hljs-keyword">int64</span>&#125;par2 := Part2&#123;&#125;fmt.Printf(<span class="hljs-string">&quot;Part1 Size: %d, align: %d\n&quot;</span>, unsafe.Sizeof(par2), unsafe.Alignof(par2))   <span class="hljs-comment">// 16 8</span>&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">TestApply</span><span class="hljs-params">(t *testing.T)</span></span> &#123;<span class="hljs-comment">// Float64çš„bits</span><span class="hljs-keyword">var</span> f <span class="hljs-keyword">float64</span> = <span class="hljs-number">0.1</span>fmt.Println(*(*<span class="hljs-keyword">uint64</span>)(unsafe.Pointer(&amp;f)))  <span class="hljs-comment">// 4591870180066957722</span><span class="hljs-comment">// è®¡ç®—åç§»é‡</span><span class="hljs-keyword">type</span> aa <span class="hljs-keyword">struct</span> &#123;B <span class="hljs-keyword">bool</span>C <span class="hljs-keyword">uint64</span>&#125;c := aa&#123;&#125;fmt.Println(c)  <span class="hljs-comment">// &#123;false 0&#125;</span>aac := (*<span class="hljs-keyword">uint64</span>)(unsafe.Pointer(<span class="hljs-keyword">uintptr</span>(unsafe.Pointer(&amp;c)) + unsafe.Offsetof(c.C)))*aac = <span class="hljs-number">10</span>fmt.Println(c)  <span class="hljs-comment">// &#123;false 10&#125;</span>&#125;</code></pre><h5 id="flag"><a href="#flag" class="headerlink" title="flag"></a>flag</h5><h5 id="sync"><a href="#sync" class="headerlink" title="sync"></a>sync</h5><h5 id="os-signal"><a href="#os-signal" class="headerlink" title="os/signal"></a>os/signal</h5><pre><code class="hljs go"><span class="hljs-comment">// Signals</span><span class="hljs-keyword">const</span> (SIGABRT   = Signal(<span class="hljs-number">0x6</span>)SIGALRM   = Signal(<span class="hljs-number">0xe</span>)SIGBUS    = Signal(<span class="hljs-number">0xa</span>)SIGCHLD   = Signal(<span class="hljs-number">0x14</span>)SIGCONT   = Signal(<span class="hljs-number">0x13</span>)SIGEMT    = Signal(<span class="hljs-number">0x7</span>)SIGFPE    = Signal(<span class="hljs-number">0x8</span>)SIGHUP    = Signal(<span class="hljs-number">0x1</span>)SIGILL    = Signal(<span class="hljs-number">0x4</span>)SIGINFO   = Signal(<span class="hljs-number">0x1d</span>)SIGINT    = Signal(<span class="hljs-number">0x2</span>)SIGIO     = Signal(<span class="hljs-number">0x17</span>)SIGIOT    = Signal(<span class="hljs-number">0x6</span>)SIGKILL   = Signal(<span class="hljs-number">0x9</span>)SIGPIPE   = Signal(<span class="hljs-number">0xd</span>)SIGPROF   = Signal(<span class="hljs-number">0x1b</span>)SIGQUIT   = Signal(<span class="hljs-number">0x3</span>)SIGSEGV   = Signal(<span class="hljs-number">0xb</span>)SIGSTOP   = Signal(<span class="hljs-number">0x11</span>)SIGSYS    = Signal(<span class="hljs-number">0xc</span>)SIGTERM   = Signal(<span class="hljs-number">0xf</span>)SIGTRAP   = Signal(<span class="hljs-number">0x5</span>)SIGTSTP   = Signal(<span class="hljs-number">0x12</span>)SIGTTIN   = Signal(<span class="hljs-number">0x15</span>)SIGTTOU   = Signal(<span class="hljs-number">0x16</span>)SIGURG    = Signal(<span class="hljs-number">0x10</span>)SIGUSR1   = Signal(<span class="hljs-number">0x1e</span>)SIGUSR2   = Signal(<span class="hljs-number">0x1f</span>)SIGVTALRM = Signal(<span class="hljs-number">0x1a</span>)SIGWINCH  = Signal(<span class="hljs-number">0x1c</span>)SIGXCPU   = Signal(<span class="hljs-number">0x18</span>)SIGXFSZ   = Signal(<span class="hljs-number">0x19</span>))<span class="hljs-comment">// Signal table</span><span class="hljs-keyword">var</span> signals = [...]<span class="hljs-keyword">string</span>&#123;<span class="hljs-number">1</span>:  <span class="hljs-string">&quot;hangup&quot;</span>,<span class="hljs-number">2</span>:  <span class="hljs-string">&quot;interrupt&quot;</span>,<span class="hljs-number">3</span>:  <span class="hljs-string">&quot;quit&quot;</span>,<span class="hljs-number">4</span>:  <span class="hljs-string">&quot;illegal instruction&quot;</span>,<span class="hljs-number">5</span>:  <span class="hljs-string">&quot;trace/BPT trap&quot;</span>,<span class="hljs-number">6</span>:  <span class="hljs-string">&quot;abort trap&quot;</span>,<span class="hljs-number">7</span>:  <span class="hljs-string">&quot;EMT trap&quot;</span>,<span class="hljs-number">8</span>:  <span class="hljs-string">&quot;floating point exception&quot;</span>,<span class="hljs-number">9</span>:  <span class="hljs-string">&quot;killed&quot;</span>,<span class="hljs-number">10</span>: <span class="hljs-string">&quot;bus error&quot;</span>,<span class="hljs-number">11</span>: <span class="hljs-string">&quot;segmentation fault&quot;</span>,<span class="hljs-number">12</span>: <span class="hljs-string">&quot;bad system call&quot;</span>,<span class="hljs-number">13</span>: <span class="hljs-string">&quot;broken pipe&quot;</span>,<span class="hljs-number">14</span>: <span class="hljs-string">&quot;alarm clock&quot;</span>,<span class="hljs-number">15</span>: <span class="hljs-string">&quot;terminated&quot;</span>,<span class="hljs-number">16</span>: <span class="hljs-string">&quot;urgent I/O condition&quot;</span>,<span class="hljs-number">17</span>: <span class="hljs-string">&quot;suspended (signal)&quot;</span>,<span class="hljs-number">18</span>: <span class="hljs-string">&quot;suspended&quot;</span>,<span class="hljs-number">19</span>: <span class="hljs-string">&quot;continued&quot;</span>,<span class="hljs-number">20</span>: <span class="hljs-string">&quot;child exited&quot;</span>,<span class="hljs-number">21</span>: <span class="hljs-string">&quot;stopped (tty input)&quot;</span>,<span class="hljs-number">22</span>: <span class="hljs-string">&quot;stopped (tty output)&quot;</span>,<span class="hljs-number">23</span>: <span class="hljs-string">&quot;I/O possible&quot;</span>,<span class="hljs-number">24</span>: <span class="hljs-string">&quot;cputime limit exceeded&quot;</span>,<span class="hljs-number">25</span>: <span class="hljs-string">&quot;filesize limit exceeded&quot;</span>,<span class="hljs-number">26</span>: <span class="hljs-string">&quot;virtual timer expired&quot;</span>,<span class="hljs-number">27</span>: <span class="hljs-string">&quot;profiling timer expired&quot;</span>,<span class="hljs-number">28</span>: <span class="hljs-string">&quot;window size changes&quot;</span>,<span class="hljs-number">29</span>: <span class="hljs-string">&quot;information request&quot;</span>,<span class="hljs-number">30</span>: <span class="hljs-string">&quot;user defined signal 1&quot;</span>,<span class="hljs-number">31</span>: <span class="hljs-string">&quot;user defined signal 2&quot;</span>,&#125;</code></pre><h5 id="encoding-json"><a href="#encoding-json" class="headerlink" title="encoding/json"></a>encoding/json</h5><p>å®ç°äº†ç¨‹åºå‘½ä»¤è¡Œå‚æ•°çš„è§£æã€‚</p><h4 id="çˆ¬è™«ç›¸å…³"><a href="#çˆ¬è™«ç›¸å…³" class="headerlink" title="çˆ¬è™«ç›¸å…³"></a>çˆ¬è™«ç›¸å…³</h4><ul><li>henrylee2cn/pholcus</li><li>gocrawl</li><li>colly</li><li>hu17889/go_spider</li></ul><h4 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h4><ul><li><a href="https://github.com/spf13/viper">https://github.com/spf13/viper</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>Golang</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Go</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€Goã€‘æ–‡æ¡£ä¹‹é“</title>
    <link href="/2021/06/02/golang-doc/"/>
    <url>/2021/06/02/golang-doc/</url>
    
    <content type="html"><![CDATA[<h3 id="æ–‡æ¡£"><a href="#æ–‡æ¡£" class="headerlink" title="æ–‡æ¡£"></a>æ–‡æ¡£</h3><p><code>godoc -http :6060</code>,ç”Ÿæˆç½‘é¡µæ–‡æ¡£</p><p><img src="/images/golang/doc.jpg"></p><p><img src="/images/golang/doc1.jpg"></p><p><code>go doc æ–¹æ³•åï¼ˆåŒ…æ‹¬åŒ…åï¼‰</code>,æŸ¥çœ‹æ–¹æ³•æ³¨é‡Š</p><p><img src="/images/golang/doc2.jpg"></p><p><code>xxx_test.go</code>ç”Ÿæˆç¤ºä¾‹</p><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">ExampleQueue_Pop</span><span class="hljs-params">()</span></span> &#123;q := Queue&#123;&#125;_ = q.Push(<span class="hljs-string">&quot;asd&quot;</span>)_ = q.Push(<span class="hljs-number">123</span>)<span class="hljs-keyword">if</span> v, ok := q.Pop(); ok &#123;fmt.Println(v)&#125;<span class="hljs-keyword">if</span> v, ok := q.Pop(); ok &#123;fmt.Println(v)&#125;<span class="hljs-comment">//Output:</span><span class="hljs-comment">//asd</span><span class="hljs-comment">//123</span>&#125;</code></pre><p><img src="/images/golang/doc_output.jpg"></p>]]></content>
    
    
    <categories>
      
      <category>Golang</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Go</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€Goã€‘æµ‹è¯•ä¹‹é“</title>
    <link href="/2021/06/02/golang-test/"/>
    <url>/2021/06/02/golang-test/</url>
    
    <content type="html"><![CDATA[<blockquote><a id="more"></a></blockquote><h3 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h3><p><em>è¡¨æ ¼é©±åŠ¨</em>æµ‹è¯•</p><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">TestMaxNoRepeatedZhn</span><span class="hljs-params">(t *testing.T)</span></span> &#123;tests := []<span class="hljs-keyword">struct</span>&#123;s <span class="hljs-keyword">string</span>ans <span class="hljs-keyword">int</span>&#125;&#123;&#123;<span class="hljs-string">&quot;a&quot;</span>, <span class="hljs-number">1</span>&#125;,&#123;<span class="hljs-string">&quot;yes, æˆ‘çˆ±gogogo&quot;</span>, <span class="hljs-number">9</span>&#125;,&#123;<span class="hljs-string">&quot;abcadcb&quot;</span>, <span class="hljs-number">4</span>&#125;,&#123;<span class="hljs-string">&quot;é»‘åŒ–è‚¥æŒ¥å‘å‘ç°ä¼šèŠ±é£ç°åŒ–è‚¥æŒ¥å‘å‘é»‘ä¼šé£èŠ±&quot;</span>, <span class="hljs-number">8</span>&#125;,&#125;<span class="hljs-keyword">for</span> _, tt := <span class="hljs-keyword">range</span> tests &#123;act := MaxNoRepeatedZhn(tt.s)<span class="hljs-keyword">if</span> act != tt.ans &#123;t.Errorf(<span class="hljs-string">&quot;get %d for input %s , but expect %d&quot;</span>, act, tt.s, tt.ans)&#125;&#125;&#125;<span class="hljs-comment">// è¾“å‡º</span>=== RUN   TestMaxNoRepeatedZhn--- PASS: TestMaxNoRepeatedZhn (<span class="hljs-number">0.00</span>s)PASS</code></pre><h4 id="è¦†ç›–æµ‹è¯•"><a href="#è¦†ç›–æµ‹è¯•" class="headerlink" title="è¦†ç›–æµ‹è¯•"></a>è¦†ç›–æµ‹è¯•</h4><p><code>go tool cover</code></p><pre><code class="hljs shell">Usage of &#x27;go tool cover&#x27;:Given a coverage profile produced by &#x27;go test&#x27;:        go test -coverprofile=c.outOpen a web browser displaying annotated source code:        go tool cover -html=c.out    # å¸¸ç”¨Write out an HTML file instead of launching a web browser:        go tool cover -html=c.out -o coverage.htmlDisplay coverage percentages to stdout for each function:        go tool cover -func=c.outFinally, to generate modified source code with coverage annotations(what go test -cover does):        go tool cover -mode=set -var=CoverageVariableName program.goFlags:  -V    print version and exit  -func string        output coverage profile information for each function  -html string        generate HTML representation of coverage profile  -mode string        coverage mode: set, count, atomic  -o string        file for output; default: stdout  -var string        name of coverage variable to generate (default &quot;GoCover&quot;)  Only one of -html, -func, or -mode may be set.</code></pre><h4 id="Benchmark"><a href="#Benchmark" class="headerlink" title="Benchmark"></a><code>Benchmark</code></h4><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">BenchmarkMaxNoRepeatedZhn</span><span class="hljs-params">(b *testing.B)</span></span> &#123;s := <span class="hljs-string">&quot;é»‘åŒ–è‚¥æŒ¥å‘å‘ç°ä¼šèŠ±é£ç°åŒ–è‚¥æŒ¥å‘å‘é»‘ä¼šé£èŠ±&quot;</span>ans := <span class="hljs-number">8</span><span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; b.N; i++ &#123;act := MaxNoRepeatedZhn(s)<span class="hljs-keyword">if</span> act != ans &#123;b.Errorf(<span class="hljs-string">&quot;get %d for input %s , but expect %d&quot;</span>, act, s, ans)&#125;&#125;&#125;<span class="hljs-comment">// è¾“å‡º</span>goos: darwingoarch: amd64pkg: offer/note/collectionsBenchmarkMaxNoRepeatedZhnBenchmarkMaxNoRepeatedZhn<span class="hljs-number">-8</span>    <span class="hljs-number">1097594</span>      <span class="hljs-number">1024</span> ns/opPASS</code></pre><p><a href="https://github.com/weitrue/note/collections/strings_test.go">https://github.com/weitrue/note/collections/strings_test.go</a></p><h4 id="pprofæ€§èƒ½æµ‹è¯•"><a href="#pprofæ€§èƒ½æµ‹è¯•" class="headerlink" title="pprofæ€§èƒ½æµ‹è¯•"></a>pprofæ€§èƒ½æµ‹è¯•</h4><pre><code class="hljs shell">xxx@xxxdeMacBook-Pro î‚° ~/Projects/golang/src/offer/note/collections master Â±âœš go test -bench . -cpuprofile cpu.outgoos: darwingoarch: amd64pkg: offer/note/collectionsBenchmarkMaxNoRepeatedZhn-8      1286594               934 ns/opPASSok      offer/note/collections  2.656sxxx@xxxdeMacBook-Pro î‚° ~/Projects/golang/src/offer/note/collections master Â±âœš go tool pprof cpu.out               Type: cpuTime: Mar 2, 2021 at 6:03pm (CST)Duration: 2.34s, Total samples = 2.05s (87.57%)Entering interactive mode (type &quot;help&quot; for commands, &quot;o&quot; for options)(pprof) webfailed to execute dot. Is Graphviz installed? Error: exec: &quot;dot&quot;: executable file not found in $PATH(pprof)</code></pre><p>â˜<code>failed to execute dot. Is Graphviz installed? Error: exec: &quot;dot&quot;: executable file not found in $PATH</code>æ˜¯å› ä¸ºç”µè„‘æœªå®‰è£…ç”Ÿæˆ.svgæ–‡ä»¶çš„å·¥å…·<code>Graphviz</code></p><h5 id="å®‰è£…Graphviz"><a href="#å®‰è£…Graphviz" class="headerlink" title="å®‰è£…Graphviz"></a>å®‰è£…<code>Graphviz</code></h5><pre><code class="hljs shell">brew install graphvizxxx@xxxdeMacBook-Pro î‚° ~/Projects/golang/src/github.com î‚° brew install graphvizError:  homebrew-core is a shallow clone.  homebrew-cask is a shallow clone.To `brew update`, first run:  git -C /usr/local/Homebrew/Library/Taps/homebrew/homebrew-core fetch --unshallow  git -C /usr/local/Homebrew/Library/Taps/homebrew/homebrew-cask fetch --unshallowThese commands may take a few minutes to run due to the large size of the repositories.This restriction has been made on GitHub&#x27;s request because updating shallowclones is an extremely expensive operation due to the tree layout and traffic ofHomebrew/homebrew-core and Homebrew/homebrew-cask. We don&#x27;t do this for youautomatically to avoid repeatedly performing an expensive unshallow operation inCI systems (which should instead be fixed to not use shallow clones). Sorry forthe inconvenience!==&gt; Downloading https://mirrors.tuna.tsinghua.edu.cn/homebrew-bottles/bottles/libpng-1.6.37.big_sur.bottle.tar.gz<span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment">####################################################################### 100.0%</span></span>==&gt; Downloading https://mirrors.tuna.tsinghua.edu.cn/homebrew-bottles/bottles/freetype-2.10.4.big_sur.bottle.tar.gz<span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment">####################################################################### 100.0%</span></span>==&gt; Downloading https://mirrors.tuna.tsinghua.edu.cn/homebrew-bottles/bottles/fontconfig-2.13.1.big_sur.bottle.tar.gz<span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment">####################################################################### 100.0%</span></span>==&gt; Downloading https://mirrors.tuna.tsinghua.edu.cn/homebrew-bottles/bottles/jpeg-9d.big_sur.bottle.tar.gz<span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment">####################################################################### 100.0%</span></span>==&gt; Downloading https://mirrors.tuna.tsinghua.edu.cn/homebrew-bottles/bottles/libtiff-4.1.0_1.big_sur.bottle.tar.gz<span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment">########################################                                 58.1%</span></span>curl: (56) LibreSSL SSL_read: SSL_ERROR_SYSCALL, errno 54Error: Failed to download resource &quot;libtiff&quot;Download failed: https://mirrors.tuna.tsinghua.edu.cn/homebrew-bottles/bottles/libtiff-4.1.0_1.big_sur.bottle.tar.gzWarning: Bottle installation failed: building from source.==&gt; Downloading https://download.osgeo.org/libtiff/tiff-4.1.0.tar.gz<span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment">####################################################################### 100.0%</span></span>==&gt; Downloading https://mirrors.tuna.tsinghua.edu.cn/homebrew-bottles/bottles/webp-1.1.0.big_sur.bottle.tar.gz<span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment">####################################################################### 100.0%</span></span>==&gt; Downloading https://mirrors.tuna.tsinghua.edu.cn/homebrew-bottles/bottles/gd-2.3.0.big_sur.bottle.tar.gz<span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment">####################################################################### 100.0%</span></span>==&gt; Downloading https://mirrors.tuna.tsinghua.edu.cn/homebrew-bottles/bottles/libffi-3.3.big_sur.bottle.tar.gz<span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment">####################################################################### 100.0%</span></span>==&gt; Downloading https://mirrors.tuna.tsinghua.edu.cn/homebrew-bottles/bottles/pcre-8.44.big_sur.bottle.tar.gz<span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment">####################################################################### 100.0%</span></span>==&gt; Downloading https://mirrors.tuna.tsinghua.edu.cn/homebrew-bottles/bottles/glib-2.66.2_1.big_sur.bottle.tar.gz<span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment">#########                                                                14.5%</span></span>curl: (56) LibreSSL SSL_read: SSL_ERROR_SYSCALL, errno 54Error: Failed to download resource &quot;glib&quot;Download failed: https://mirrors.tuna.tsinghua.edu.cn/homebrew-bottles/bottles/glib-2.66.2_1.big_sur.bottle.tar.gzWarning: Bottle installation failed: building from source.==&gt; Downloading https://raw.githubusercontent.com/Homebrew/formula-patches/6164294a75541c278f3863b111791376caa3ad26/glib/hardcoded-paths.diff<span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment">####################################################################### 100.0%</span></span>==&gt; Downloading https://download.gnome.org/sources/glib/2.66/glib-2.66.2.tar.xz==&gt; Downloading from https://mirrors.ustc.edu.cn/gnome/sources/glib/2.66/glib-2.66.2.tar.xz<span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment">####################################################################### 100.0%</span></span>==&gt; Downloading https://mirrors.tuna.tsinghua.edu.cn/homebrew-bottles/bottles/jasper-2.0.22.big_sur.bottle.tar.gz==&gt; Downloading from https://d29vzk4ow07wi7.cloudfront.net/ad3715537b3001b9a8924896e5c4e7eb90b21bb37e7171d964de2008edb13910?response-content-disposition=attachment%3Bfilename%3D%22jasper-2.0.22.big_sur.bo<span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment">####################################################################### 100.0%</span></span>==&gt; Downloading https://mirrors.tuna.tsinghua.edu.cn/homebrew-bottles/bottles/netpbm-10.86.17.big_sur.bottle.tar.gz==&gt; Downloading from https://d29vzk4ow07wi7.cloudfront.net/3540b31b88e9d8fc7288de5dac7b96be6f1c6652c604cfd167113bdf07738ca7?response-content-disposition=attachment%3Bfilename%3D%22netpbm-10.86.17.big_sur.<span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment">####################################################################### 100.0%</span></span>==&gt; Downloading https://mirrors.tuna.tsinghua.edu.cn/homebrew-bottles/bottles/gts-0.7.6_2.big_sur.bottle.tar.gz<span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment">####################################################################### 100.0%</span></span>==&gt; Downloading https://mirrors.tuna.tsinghua.edu.cn/homebrew-bottles/bottles/lzo-2.10.big_sur.bottle.tar.gz<span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment">####################################################################### 100.0%</span></span>==&gt; Downloading https://mirrors.tuna.tsinghua.edu.cn/homebrew-bottles/bottles/pixman-0.40.0.big_sur.bottle.tar.gz<span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment">####################################################################### 100.0%</span></span>==&gt; Downloading https://mirrors.tuna.tsinghua.edu.cn/homebrew-bottles/bottles/cairo-1.16.0_3.big_sur.bottle.tar.gz<span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment">####################################################################### 100.0%</span></span>==&gt; Downloading https://mirrors.tuna.tsinghua.edu.cn/homebrew-bottles/bottles/gdk-pixbuf-2.42.0.big_sur.bottle.tar.gz==&gt; Downloading from https://d29vzk4ow07wi7.cloudfront.net/1819bb48f7487d522a69c564dca6fe5dff4da658269f067e47edccddfaab9440?response-content-disposition=attachment%3Bfilename%3D%22gdk-pixbuf-2.42.0.big_su<span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment">####################################################################### 100.0%</span></span>==&gt; Downloading https://mirrors.tuna.tsinghua.edu.cn/homebrew-bottles/bottles/fribidi-1.0.10.big_sur.bottle.tar.gz<span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment">####################################################################### 100.0%</span></span>==&gt; Downloading https://mirrors.tuna.tsinghua.edu.cn/homebrew-bottles/bottles/pkg-config-0.29.2_3.big_sur.bottle.tar.gz<span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment">####################################################################### 100.0%</span></span>==&gt; Downloading https://mirrors.tuna.tsinghua.edu.cn/homebrew-bottles/bottles/gobject-introspection-1.66.1_1.big_sur.bottle.tar.gz<span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment">####################################################################### 100.0%</span></span>==&gt; Downloading https://mirrors.tuna.tsinghua.edu.cn/homebrew-bottles/bottles/graphite2-1.3.14.big_sur.bottle.tar.gz<span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment">####################################################################### 100.0%</span></span>==&gt; Downloading https://mirrors.tuna.tsinghua.edu.cn/homebrew-bottles/bottles/icu4c-67.1.big_sur.bottle.tar.gz<span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment">####################################################################### 100.0%</span></span>==&gt; Downloading https://mirrors.tuna.tsinghua.edu.cn/homebrew-bottles/bottles/harfbuzz-2.7.2.big_sur.bottle.tar.gz<span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment">####################################################################### 100.0%</span></span>==&gt; Downloading https://mirrors.tuna.tsinghua.edu.cn/homebrew-bottles/bottles/pango-1.48.0.big_sur.bottle.tar.gz<span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment">####################################################################### 100.0%</span></span>==&gt; Downloading https://mirrors.tuna.tsinghua.edu.cn/homebrew-bottles/bottles/librsvg-2.50.2.big_sur.bottle.tar.gz<span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment">####################                                                     29.6%</span></span>curl: (18) transfer closed with 28187304 bytes remaining to readError: Failed to download resource &quot;librsvg&quot;Download failed: https://mirrors.tuna.tsinghua.edu.cn/homebrew-bottles/bottles/librsvg-2.50.2.big_sur.bottle.tar.gzWarning: Bottle installation failed: building from source.==&gt; Downloading https://download.gnome.org/sources/librsvg/2.50/librsvg-2.50.2.tar.xz==&gt; Downloading from https://mirrors.ustc.edu.cn/gnome/sources/librsvg/2.50/librsvg-2.50.2.tar.xz<span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment">####################################################################### 100.0%</span></span>==&gt; Downloading https://mirrors.tuna.tsinghua.edu.cn/homebrew-bottles/bottles/libtool-2.4.6_2.big_sur.bottle.tar.gz<span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment">####################################################################### 100.0%</span></span>==&gt; Downloading https://mirrors.tuna.tsinghua.edu.cn/homebrew-bottles/bottles/graphviz-2.44.1.big_sur.bottle.1.tar.gz<span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment">#####################################                                    52.9%</span></span>curl: (18) transfer closed with 6363689 bytes remaining to readError: Failed to download resource &quot;graphviz&quot;Download failed: https://mirrors.tuna.tsinghua.edu.cn/homebrew-bottles/bottles/graphviz-2.44.1.big_sur.bottle.1.tar.gzWarning: Bottle installation failed: building from source.==&gt; Downloading https://mirrors.tuna.tsinghua.edu.cn/homebrew-bottles/bottles/autoconf-2.69.big_sur.bottle.4.tar.gz<span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment">####################################################################### 100.0%</span></span>==&gt; Downloading https://mirrors.tuna.tsinghua.edu.cn/homebrew-bottles/bottles/automake-1.16.3.big_sur.bottle.tar.gz<span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment">####################################################################### 100.0%</span></span>==&gt; Downloading https://mirrors.tuna.tsinghua.edu.cn/homebrew-bottles/bottles/pkg-config-0.29.2_3.big_sur.bottle.tar.gzAlready downloaded: /Users/wangpeng/Library/Caches/Homebrew/downloads/c393e3a39326eab27929f0f2ce40cb425e78bd8812166e6d835a08a8bf0c5f56--pkg-config-0.29.2_3.big_sur.bottle.tar.gz==&gt; Downloading https://mirrors.tuna.tsinghua.edu.cn/homebrew-bottles/bottles/libpng-1.6.37.big_sur.bottle.tar.gzAlready downloaded: /Users/wangpeng/Library/Caches/Homebrew/downloads/3bd2e2a75fbfc893d9acc20eeafc5274e260ed2ca39483ccbb1450a734bc6775--libpng-1.6.37.big_sur.bottle.tar.gz==&gt; Downloading https://mirrors.tuna.tsinghua.edu.cn/homebrew-bottles/bottles/freetype-2.10.4.big_sur.bottle.tar.gzAlready downloaded: /Users/wangpeng/Library/Caches/Homebrew/downloads/1399fc577f7998623378e7bb01f8a716a43eff701304059936d592a76d5a4d31--freetype-2.10.4.big_sur.bottle.tar.gz==&gt; Downloading https://mirrors.tuna.tsinghua.edu.cn/homebrew-bottles/bottles/fontconfig-2.13.1.big_sur.bottle.tar.gzAlready downloaded: /Users/wangpeng/Library/Caches/Homebrew/downloads/3790f4e94c8e7c868307933e3445a1244aadd794adaa6ed5f743533334489f93--fontconfig-2.13.1.big_sur.bottle.tar.gz==&gt; Downloading https://mirrors.tuna.tsinghua.edu.cn/homebrew-bottles/bottles/jpeg-9d.big_sur.bottle.tar.gzAlready downloaded: /Users/wangpeng/Library/Caches/Homebrew/downloads/7ed5b41c2937740eca747a8077502454971fbbe02cfb5cfbd9b9e7379345d0cd--jpeg-9d.big_sur.bottle.tar.gz==&gt; Downloading https://mirrors.tuna.tsinghua.edu.cn/homebrew-bottles/bottles/libtiff-4.1.0_1.big_sur.bottle.tar.gz<span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment">####################################################################### 100.0%</span></span>==&gt; Downloading https://mirrors.tuna.tsinghua.edu.cn/homebrew-bottles/bottles/webp-1.1.0.big_sur.bottle.tar.gzAlready downloaded: /Users/wangpeng/Library/Caches/Homebrew/downloads/1ae441623b4c63d896b5566300b24c06d772ff9f2676d7c9bd692ff6b8e22edb--webp-1.1.0.big_sur.bottle.tar.gz==&gt; Downloading https://mirrors.tuna.tsinghua.edu.cn/homebrew-bottles/bottles/gd-2.3.0.big_sur.bottle.tar.gzAlready downloaded: /Users/wangpeng/Library/Caches/Homebrew/downloads/d71eed744db212a24cc7f607842253aacf0e1d25cd7891c884ec7ffc969162ac--gd-2.3.0.big_sur.bottle.tar.gz==&gt; Downloading https://mirrors.tuna.tsinghua.edu.cn/homebrew-bottles/bottles/libffi-3.3.big_sur.bottle.tar.gzAlready downloaded: /Users/wangpeng/Library/Caches/Homebrew/downloads/49892306006d42a1f69ae4b36ff44b37c8e7170f6cf73a20e97f10bf9fa10e72--libffi-3.3.big_sur.bottle.tar.gz==&gt; Downloading https://mirrors.tuna.tsinghua.edu.cn/homebrew-bottles/bottles/pcre-8.44.big_sur.bottle.tar.gzAlready downloaded: /Users/wangpeng/Library/Caches/Homebrew/downloads/9998b74590fa558f4c346e9770a62495d4aca8e992d0e883435e3574303ee241--pcre-8.44.big_sur.bottle.tar.gz==&gt; Downloading https://mirrors.tuna.tsinghua.edu.cn/homebrew-bottles/bottles/glib-2.66.2_1.big_sur.bottle.tar.gz<span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment">####################################################################### 100.0%</span></span>==&gt; Downloading https://mirrors.tuna.tsinghua.edu.cn/homebrew-bottles/bottles/jasper-2.0.22.big_sur.bottle.tar.gzAlready downloaded: /Users/wangpeng/Library/Caches/Homebrew/downloads/86ba13e63264cbcafb0dbec9e35960e2662f9e4bde0306bd52984bf487e6581a--jasper-2.0.22.big_sur.bottle.tar.gz==&gt; Downloading https://mirrors.tuna.tsinghua.edu.cn/homebrew-bottles/bottles/netpbm-10.86.17.big_sur.bottle.tar.gzAlready downloaded: /Users/wangpeng/Library/Caches/Homebrew/downloads/9f8fa63491038e9bb811b03f09660342641c7f8132169bdb3800631d8d2b189e--netpbm-10.86.17.big_sur.bottle.tar.gz==&gt; Downloading https://mirrors.tuna.tsinghua.edu.cn/homebrew-bottles/bottles/gts-0.7.6_2.big_sur.bottle.tar.gzAlready downloaded: /Users/wangpeng/Library/Caches/Homebrew/downloads/eab94b3870ce0c63232e9a992963c8a32ea53a7efa8a09e639066b40ae0a132b--gts-0.7.6_2.big_sur.bottle.tar.gz==&gt; Downloading https://mirrors.tuna.tsinghua.edu.cn/homebrew-bottles/bottles/lzo-2.10.big_sur.bottle.tar.gzAlready downloaded: /Users/wangpeng/Library/Caches/Homebrew/downloads/0020e09d8a2c473efa8db2af4b402358f5184578c801c7a7650de6c8bedca06a--lzo-2.10.big_sur.bottle.tar.gz==&gt; Downloading https://mirrors.tuna.tsinghua.edu.cn/homebrew-bottles/bottles/pixman-0.40.0.big_sur.bottle.tar.gzAlready downloaded: /Users/wangpeng/Library/Caches/Homebrew/downloads/ddf94c89d763f2c63c00ce2090ff16d5abd832ca0e1e9beb2245da3cc159ce41--pixman-0.40.0.big_sur.bottle.tar.gz==&gt; Downloading https://mirrors.tuna.tsinghua.edu.cn/homebrew-bottles/bottles/cairo-1.16.0_3.big_sur.bottle.tar.gzAlready downloaded: /Users/wangpeng/Library/Caches/Homebrew/downloads/8ad096f68fcc70615ff77f14b50eafbed94e4a261c7860dcda41ba25c7d12f52--cairo-1.16.0_3.big_sur.bottle.tar.gz==&gt; Downloading https://mirrors.tuna.tsinghua.edu.cn/homebrew-bottles/bottles/gdk-pixbuf-2.42.0.big_sur.bottle.tar.gzAlready downloaded: /Users/wangpeng/Library/Caches/Homebrew/downloads/fb191d15b537de812241fe664f4149209c4d58ce3fbdd5e98a292fe495420f39--gdk-pixbuf-2.42.0.big_sur.bottle.tar.gz==&gt; Downloading https://mirrors.tuna.tsinghua.edu.cn/homebrew-bottles/bottles/fribidi-1.0.10.big_sur.bottle.tar.gzAlready downloaded: /Users/wangpeng/Library/Caches/Homebrew/downloads/9013c8a0aeb1d2fee9a999ef14adfb2416fef4e8399d87a65d753d44a586427b--fribidi-1.0.10.big_sur.bottle.tar.gz==&gt; Downloading https://mirrors.tuna.tsinghua.edu.cn/homebrew-bottles/bottles/gobject-introspection-1.66.1_1.big_sur.bottle.tar.gzAlready downloaded: /Users/wangpeng/Library/Caches/Homebrew/downloads/a7f9a1bcb83a7d322e495d163f15b4b8f4d0c05649eeacfcef2681a23b3eb8dd--gobject-introspection-1.66.1_1.big_sur.bottle.tar.gz==&gt; Downloading https://mirrors.tuna.tsinghua.edu.cn/homebrew-bottles/bottles/graphite2-1.3.14.big_sur.bottle.tar.gzAlready downloaded: /Users/wangpeng/Library/Caches/Homebrew/downloads/5ce053636ab73845d956142cfd518a21701d3ec972e73367d204b81619b8b845--graphite2-1.3.14.big_sur.bottle.tar.gz==&gt; Downloading https://mirrors.tuna.tsinghua.edu.cn/homebrew-bottles/bottles/icu4c-67.1.big_sur.bottle.tar.gzAlready downloaded: /Users/wangpeng/Library/Caches/Homebrew/downloads/ddca8d436054c0f9c8c333d2e8dd957ccd3902680baf619e4baed434c9806998--icu4c-67.1.big_sur.bottle.tar.gz==&gt; Downloading https://mirrors.tuna.tsinghua.edu.cn/homebrew-bottles/bottles/harfbuzz-2.7.2.big_sur.bottle.tar.gzAlready downloaded: /Users/wangpeng/Library/Caches/Homebrew/downloads/1aead0f1ab97b4307a9c487a3191213ff63fd200d5eb9be947a11e8ca78df24a--harfbuzz-2.7.2.big_sur.bottle.tar.gz==&gt; Downloading https://mirrors.tuna.tsinghua.edu.cn/homebrew-bottles/bottles/pango-1.48.0.big_sur.bottle.tar.gzAlready downloaded: /Users/wangpeng/Library/Caches/Homebrew/downloads/eded163bf136aa7a73e07f22c8b16f3a406bbd849b865246a95ee89ecd60aa4e--pango-1.48.0.big_sur.bottle.tar.gz==&gt; Downloading https://mirrors.tuna.tsinghua.edu.cn/homebrew-bottles/bottles/librsvg-2.50.2.big_sur.bottle.tar.gz<span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment">##################################################                       71.3%</span></span>curl: (18) transfer closed with 11492026 bytes remaining to readError: Failed to download resource &quot;librsvg&quot;Download failed: https://mirrors.tuna.tsinghua.edu.cn/homebrew-bottles/bottles/librsvg-2.50.2.big_sur.bottle.tar.gzWarning: Bottle installation failed: building from source.==&gt; Downloading https://download.gnome.org/sources/librsvg/2.50/librsvg-2.50.2.tar.xzAlready downloaded: /Users/wangpeng/Library/Caches/Homebrew/downloads/0388827e738392e3705cbb8800e43f279723caf5126ba50c7cd4e1ca5e2af872--librsvg-2.50.2.tar.xz==&gt; Downloading https://mirrors.tuna.tsinghua.edu.cn/homebrew-bottles/bottles/libtool-2.4.6_2.big_sur.bottle.tar.gzAlready downloaded: /Users/wangpeng/Library/Caches/Homebrew/downloads/59a8e4e9bff6153b4cb25fda4de99648330e04fefdd7e9c98f92fa4d049a9f30--libtool-2.4.6_2.big_sur.bottle.tar.gz==&gt; Downloading https://www2.graphviz.org/Packages/stable/portable_source/graphviz-2.44.1.tar.gz<span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment">###################                                                      28.5%</span></span><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment">####################################################################### 100.0%</span></span>==&gt; Installing dependencies for graphviz: autoconf, automake, pkg-config, libpng, freetype, fontconfig, jpeg, libtiff, webp, gd, libffi, pcre, glib, jasper, netpbm, gts, lzo, pixman, cairo, gdk-pixbuf, fribidi, gobject-introspection, graphite2, icu4c, harfbuzz, pango, librsvg and libtool==&gt; Installing graphviz dependency: autoconf==&gt; Pouring autoconf-2.69.big_sur.bottle.4.tar.gzğŸº  /usr/local/Cellar/autoconf/2.69: 68 files, 3.0MB==&gt; Installing graphviz dependency: automake==&gt; Pouring automake-1.16.3.big_sur.bottle.tar.gzğŸº  /usr/local/Cellar/automake/1.16.3: 131 files, 3.4MB==&gt; Installing graphviz dependency: pkg-config==&gt; Pouring pkg-config-0.29.2_3.big_sur.bottle.tar.gzğŸº  /usr/local/Cellar/pkg-config/0.29.2_3: 11 files, 656.6KB==&gt; Installing graphviz dependency: libpng==&gt; Pouring libpng-1.6.37.big_sur.bottle.tar.gzğŸº  /usr/local/Cellar/libpng/1.6.37: 27 files, 1.3MB==&gt; Installing graphviz dependency: freetype==&gt; Pouring freetype-2.10.4.big_sur.bottle.tar.gzğŸº  /usr/local/Cellar/freetype/2.10.4: 64 files, 2.3MB==&gt; Installing graphviz dependency: fontconfig==&gt; Pouring fontconfig-2.13.1.big_sur.bottle.tar.gz==&gt; Regenerating font cache, this may take a while==&gt; /usr/local/Cellar/fontconfig/2.13.1/bin/fc-cache -frvğŸº  /usr/local/Cellar/fontconfig/2.13.1: 531 files, 3.6MB==&gt; Installing graphviz dependency: jpeg==&gt; Pouring jpeg-9d.big_sur.bottle.tar.gzğŸº  /usr/local/Cellar/jpeg/9d: 21 files, 953.8KB==&gt; Installing graphviz dependency: libtiff==&gt; Pouring libtiff-4.1.0_1.big_sur.bottle.tar.gzğŸº  /usr/local/Cellar/libtiff/4.1.0_1: 247 files, 4.2MB==&gt; Installing graphviz dependency: webp==&gt; Pouring webp-1.1.0.big_sur.bottle.tar.gzğŸº  /usr/local/Cellar/webp/1.1.0: 39 files, 2.4MB==&gt; Installing graphviz dependency: gd==&gt; Pouring gd-2.3.0.big_sur.bottle.tar.gzğŸº  /usr/local/Cellar/gd/2.3.0: 34 files, 1.4MB==&gt; Installing graphviz dependency: libffi==&gt; Pouring libffi-3.3.big_sur.bottle.tar.gz==&gt; Caveatslibffi is keg-only, which means it was not symlinked into /usr/local,because macOS already provides this software and installing another version inparallel can cause all kinds of trouble.For compilers to find libffi you may need to set:  export LDFLAGS=&quot;-L/usr/local/opt/libffi/lib&quot;  export CPPFLAGS=&quot;-I/usr/local/opt/libffi/include&quot;For pkg-config to find libffi you may need to set:  export PKG_CONFIG_PATH=&quot;/usr/local/opt/libffi/lib/pkgconfig&quot;==&gt; SummaryğŸº  /usr/local/Cellar/libffi/3.3: 17 files, 540.2KB==&gt; Installing graphviz dependency: pcre==&gt; Pouring pcre-8.44.big_sur.bottle.tar.gzğŸº  /usr/local/Cellar/pcre/8.44: 204 files, 5.8MB==&gt; Installing graphviz dependency: glib==&gt; Pouring glib-2.66.2_1.big_sur.bottle.tar.gzğŸº  /usr/local/Cellar/glib/2.66.2_1: 436 files, 15.5MB==&gt; Installing graphviz dependency: jasper==&gt; Pouring jasper-2.0.22.big_sur.bottle.tar.gzğŸº  /usr/local/Cellar/jasper/2.0.22: 42 files, 1.5MB==&gt; Installing graphviz dependency: netpbm==&gt; Pouring netpbm-10.86.17.big_sur.bottle.tar.gzğŸº  /usr/local/Cellar/netpbm/10.86.17: 410 files, 17.7MB==&gt; Installing graphviz dependency: gts==&gt; Pouring gts-0.7.6_2.big_sur.bottle.tar.gzğŸº  /usr/local/Cellar/gts/0.7.6_2: 27 files, 1.4MB==&gt; Installing graphviz dependency: lzo==&gt; Pouring lzo-2.10.big_sur.bottle.tar.gzğŸº  /usr/local/Cellar/lzo/2.10: 31 files, 570.7KB==&gt; Installing graphviz dependency: pixman==&gt; Pouring pixman-0.40.0.big_sur.bottle.tar.gzğŸº  /usr/local/Cellar/pixman/0.40.0: 14 files, 1.3MB==&gt; Installing graphviz dependency: cairo==&gt; Pouring cairo-1.16.0_3.big_sur.bottle.tar.gzğŸº  /usr/local/Cellar/cairo/1.16.0_3: 119 files, 5.9MB==&gt; Installing graphviz dependency: gdk-pixbuf==&gt; Pouring gdk-pixbuf-2.42.0.big_sur.bottle.tar.gz==&gt; /usr/local/Cellar/gdk-pixbuf/2.42.0/bin/gdk-pixbuf-query-loaders --update-cacheğŸº  /usr/local/Cellar/gdk-pixbuf/2.42.0: 149 files, 3.8MB==&gt; Installing graphviz dependency: fribidi==&gt; Pouring fribidi-1.0.10.big_sur.bottle.tar.gzğŸº  /usr/local/Cellar/fribidi/1.0.10: 67 files, 669.0KB==&gt; Installing graphviz dependency: gobject-introspection==&gt; Pouring gobject-introspection-1.66.1_1.big_sur.bottle.tar.gzğŸº  /usr/local/Cellar/gobject-introspection/1.66.1_1: 191 files, 12.7MB==&gt; Installing graphviz dependency: graphite2==&gt; Pouring graphite2-1.3.14.big_sur.bottle.tar.gzğŸº  /usr/local/Cellar/graphite2/1.3.14: 18 files, 291.7KB==&gt; Installing graphviz dependency: icu4c==&gt; Pouring icu4c-67.1.big_sur.bottle.tar.gz==&gt; Caveatsicu4c is keg-only, which means it was not symlinked into /usr/local,because macOS provides libicucore.dylib (but nothing else).If you need to have icu4c first in your PATH run:  echo &#x27;export PATH=&quot;/usr/local/opt/icu4c/bin:$PATH&quot;&#x27; &gt;&gt; ~/.zshrc  echo &#x27;export PATH=&quot;/usr/local/opt/icu4c/sbin:$PATH&quot;&#x27; &gt;&gt; ~/.zshrcFor compilers to find icu4c you may need to set:  export LDFLAGS=&quot;-L/usr/local/opt/icu4c/lib&quot;  export CPPFLAGS=&quot;-I/usr/local/opt/icu4c/include&quot;For pkg-config to find icu4c you may need to set:  export PKG_CONFIG_PATH=&quot;/usr/local/opt/icu4c/lib/pkgconfig&quot;==&gt; SummaryğŸº  /usr/local/Cellar/icu4c/67.1: 258 files, 71.8MB==&gt; Installing graphviz dependency: harfbuzz==&gt; Pouring harfbuzz-2.7.2.big_sur.bottle.tar.gzğŸº  /usr/local/Cellar/harfbuzz/2.7.2: 68 files, 6.4MB==&gt; Installing graphviz dependency: pango==&gt; Pouring pango-1.48.0.big_sur.bottle.tar.gzğŸº  /usr/local/Cellar/pango/1.48.0: 64 files, 3MB==&gt; Installing graphviz dependency: librsvg==&gt; Pouring librsvg-2.50.2.big_sur.bottle.tar.gztar: Error opening archive: Failed to open &#x27;/Users/wangpeng/Library/Caches/Homebrew/downloads/3eb605900a29b02eb026199f14474efc43e313ee2b9de389706c795eebdc24f5--librsvg-2.50.2.big_sur.bottle.tar.gz&#x27;Error: Failure while executing; `tar xof /Users/wangpeng/Library/Caches/Homebrew/downloads/3eb605900a29b02eb026199f14474efc43e313ee2b9de389706c795eebdc24f5--librsvg-2.50.2.big_sur.bottle.tar.gz -C /var/folders/zs/2875szcx7jn6lbmqd0jfbprr0000gn/T/d20210302-22554-102pbtw` exited with 1. Here&#x27;s the output:tar: Error opening archive: Failed to open &#x27;/Users/wangpeng/Library/Caches/Homebrew/downloads/3eb605900a29b02eb026199f14474efc43e313ee2b9de389706c795eebdc24f5--librsvg-2.50.2.big_sur.bottle.tar.gz&#x27;Warning: Bottle installation failed: building from source.==&gt; Installing dependencies for librsvg: libssh2 and rust==&gt; Installing librsvg dependency: libssh2==&gt; Pouring libssh2-1.9.0_1.big_sur.bottle.tar.gztar: Error opening archive: Failed to open &#x27;/Users/wangpeng/Library/Caches/Homebrew/downloads/45db0c196aa97bf6c0a9c6e7787ad2cd0d14d563c03d0f4e0d52392a0f3a1c81--libssh2-1.9.0_1.big_sur.bottle.tar.gz&#x27;Error: Failure while executing; `tar xof /Users/wangpeng/Library/Caches/Homebrew/downloads/45db0c196aa97bf6c0a9c6e7787ad2cd0d14d563c03d0f4e0d52392a0f3a1c81--libssh2-1.9.0_1.big_sur.bottle.tar.gz -C /var/folders/zs/2875szcx7jn6lbmqd0jfbprr0000gn/T/d20210302-22554-qzrgbb` exited with 1. Here&#x27;s the output:tar: Error opening archive: Failed to open &#x27;/Users/wangpeng/Library/Caches/Homebrew/downloads/45db0c196aa97bf6c0a9c6e7787ad2cd0d14d563c03d0f4e0d52392a0f3a1c81--libssh2-1.9.0_1.big_sur.bottle.tar.gz&#x27;Warning: Bottle installation failed: building from source.==&gt; Downloading https://libssh2.org/download/libssh2-1.9.0.tar.gz<span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment">####################################################################### 100.0%</span></span>==&gt; ./configure --prefix=/usr/local/Cellar/libssh2/1.9.0_1 --disable-examples-build --with-openssl --with-libz --with-libssl-prefix=/usr/local/opt/openssl@1.1==&gt; make installğŸº  /usr/local/Cellar/libssh2/1.9.0_1: 184 files, 969.9KB, built in 33 seconds==&gt; Installing librsvg dependency: rust==&gt; Pouring rust-1.47.0.big_sur.bottle.tar.gztar: Error opening archive: Failed to open &#x27;/Users/wangpeng/Library/Caches/Homebrew/downloads/f1482d118ddb120ff152e8f8aa88afa9bebc5674cc42aebca96249cffbdd8bdb--rust-1.47.0.big_sur.bottle.tar.gz&#x27;Error: Failure while executing; `tar xof /Users/wangpeng/Library/Caches/Homebrew/downloads/f1482d118ddb120ff152e8f8aa88afa9bebc5674cc42aebca96249cffbdd8bdb--rust-1.47.0.big_sur.bottle.tar.gz -C /var/folders/zs/2875szcx7jn6lbmqd0jfbprr0000gn/T/d20210302-22554-16tqegl` exited with 1. Here&#x27;s the output:tar: Error opening archive: Failed to open &#x27;/Users/wangpeng/Library/Caches/Homebrew/downloads/f1482d118ddb120ff152e8f8aa88afa9bebc5674cc42aebca96249cffbdd8bdb--rust-1.47.0.big_sur.bottle.tar.gz&#x27;Warning: Bottle installation failed: building from source.==&gt; Downloading https://static.rust-lang.org/dist/rustc-1.47.0-src.tar.gz<span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment">####################################################################### 100.0%</span></span>==&gt; ./configure --prefix=/usr/local/Cellar/rust/1.47.0 --release-channel=stable==&gt; makeLast 15 lines from /Users/wangpeng/Library/Logs/Homebrew/rust/02.make:error: failed to get `cc` as a dependency of package `bootstrap v0.0.0 (/private/tmp/rust-20210302-29879-dftrmf/rustc-1.47.0-src/src/bootstrap)`Caused by:  failed to fetch `https://github.com/rust-lang/crates.io-index`Caused by:  network failure seems to have happened  if a proxy or similar is necessary `net.git-fetch-with-cli` may help here  https://doc.rust-lang.org/cargo/reference/config.html#netgit-fetch-with-cliCaused by:  http parser error: stream ended at an unexpected time; class=Http (34)failed to run: /private/tmp/rust-20210302-29879-dftrmf/rustc-1.47.0-src/build/x86_64-apple-darwin/stage0/bin/cargo build --manifest-path /private/tmp/rust-20210302-29879-dftrmf/rustc-1.47.0-src/src/bootstrap/Cargo.tomlBuild completed unsuccessfully in 0:33:17make: *** [all] Error 1READ THIS: https://docs.brew.sh/TroubleshootingThese open issues may also help:rust 1.50.0 https://github.com/Homebrew/homebrew-core/pull/70922Rust-dependent formulae on Apple Silicon - upstream issue tracker https://github.com/Homebrew/homebrew-core/issues/68301</code></pre>]]></content>
    
    
    <categories>
      
      <category>Golang</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Go</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€Allã€‘bloom-filter</title>
    <link href="/2021/03/30/bloom-filter/"/>
    <url>/2021/03/30/bloom-filter/</url>
    
    <content type="html"><![CDATA[]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>ã€Redisã€‘å­¦ä¹ ç¬”è®°</title>
    <link href="/2021/03/22/redis/"/>
    <url>/2021/03/22/redis/</url>
    
    <content type="html"><![CDATA[<blockquote><p>Remote DictIOnary Serverï¼ˆè¿œç¨‹æ•°æ®æœåŠ¡ï¼‰ï¼Œæ˜¯ä¸€ä¸ªåŸºäºå†…å­˜ä¸”æ”¯æŒæŒä¹…åŒ–çš„é«˜æ€§èƒ½ key-value æ•°æ®åº“<a id="more"></a></p></blockquote><p><img src="/images/redis/top.png"></p><h3 id="Rediså®‰è£…"><a href="#Rediså®‰è£…" class="headerlink" title="Rediså®‰è£…"></a>Rediså®‰è£…</h3><h4 id="å•æœºç‰ˆredisç¯å¢ƒå®‰è£…"><a href="#å•æœºç‰ˆredisç¯å¢ƒå®‰è£…" class="headerlink" title="å•æœºç‰ˆredisç¯å¢ƒå®‰è£…"></a>å•æœºç‰ˆredisç¯å¢ƒå®‰è£…</h4><p>ç¯å¢ƒå‡†å¤‡:</p><p>  ç³»ç»Ÿï¼šcentos7 </p><h5 id="ä¸‹è½½rediså®‰è£…åŒ…"><a href="#ä¸‹è½½rediså®‰è£…åŒ…" class="headerlink" title="ä¸‹è½½rediså®‰è£…åŒ…"></a>ä¸‹è½½rediså®‰è£…åŒ…</h5><p>node01æœåŠ¡å™¨æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ä¸‹è½½rediså®‰è£…åŒ…</p><pre><code class="hljs zsh"><span class="hljs-built_in">cd</span> /weitrue/softwget http://download.redis.io/releases/redis-6.0.1.tar.gz</code></pre><h5 id="è§£å‹rediså‹ç¼©åŒ…åˆ°æŒ‡å®šç›®å½•"><a href="#è§£å‹rediså‹ç¼©åŒ…åˆ°æŒ‡å®šç›®å½•" class="headerlink" title="è§£å‹rediså‹ç¼©åŒ…åˆ°æŒ‡å®šç›®å½•"></a>è§£å‹rediså‹ç¼©åŒ…åˆ°æŒ‡å®šç›®å½•</h5><pre><code class="hljs zsh"><span class="hljs-comment">#node01æ‰§è¡Œä»¥ä¸‹å‘½ä»¤è¿›è¡Œè§£å‹redis</span><span class="hljs-built_in">cd</span> /weitrue/softtar -zxvf redis-6.0.1.tar.gz -C ../install/</code></pre><h5 id="å®‰è£…Cç¨‹åºè¿è¡Œç¯å¢ƒ"><a href="#å®‰è£…Cç¨‹åºè¿è¡Œç¯å¢ƒ" class="headerlink" title="å®‰è£…Cç¨‹åºè¿è¡Œç¯å¢ƒ"></a>å®‰è£…Cç¨‹åºè¿è¡Œç¯å¢ƒ</h5><p>node01æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å®‰è£…Cç¨‹åºè¿è¡Œç¯å¢ƒ</p><pre><code class="hljs shell">su rootyum -y install gcc-c++<span class="hljs-meta">#</span><span class="bash"> æŸ¥çœ‹gccç‰ˆæœ¬æ˜¯å¦åœ¨5.3ä»¥ä¸Šï¼Œcentos7.6é»˜è®¤å®‰è£…4.8.5</span>gcc -v<span class="hljs-meta">#</span><span class="bash"> å‡çº§gccåˆ°5.3åŠä»¥ä¸Š,å¦‚ä¸‹ï¼š</span><span class="hljs-meta">#</span><span class="bash">å‡çº§åˆ°gcc 9.3ï¼š</span>yum -y install centos-release-sclyum -y install devtoolset-9-gcc devtoolset-9-gcc-c++ devtoolset-9-binutilsscl enable devtoolset-9 bashéœ€è¦æ³¨æ„çš„æ˜¯sclå‘½ä»¤å¯ç”¨åªæ˜¯ä¸´æ—¶çš„ï¼Œé€€å‡ºshellæˆ–é‡å¯å°±ä¼šæ¢å¤åŸç³»ç»Ÿgccç‰ˆæœ¬ã€‚å¦‚æœè¦é•¿æœŸä½¿ç”¨gcc 9.3çš„è¯ï¼šecho &quot;source /opt/rh/devtoolset-9/enable&quot; &gt;&gt;/etc/profile<span class="hljs-meta">#</span><span class="bash">è¿™æ ·é€€å‡ºshellé‡æ–°æ‰“å¼€å°±æ˜¯æ–°ç‰ˆçš„gccäº†</span></code></pre><h5 id="å®‰è£…è¾ƒæ–°ç‰ˆæœ¬çš„tcl"><a href="#å®‰è£…è¾ƒæ–°ç‰ˆæœ¬çš„tcl" class="headerlink" title="å®‰è£…è¾ƒæ–°ç‰ˆæœ¬çš„tcl"></a>å®‰è£…è¾ƒæ–°ç‰ˆæœ¬çš„tcl</h5><p>ä¸‹è½½å®‰è£…è¾ƒæ–°ç‰ˆæœ¬çš„tcl</p><h6 id="ä½¿ç”¨å‹ç¼©åŒ…è¿›è¡Œå®‰è£…ï¼ˆä¸æ¨èï¼‰"><a href="#ä½¿ç”¨å‹ç¼©åŒ…è¿›è¡Œå®‰è£…ï¼ˆä¸æ¨èï¼‰" class="headerlink" title="ä½¿ç”¨å‹ç¼©åŒ…è¿›è¡Œå®‰è£…ï¼ˆä¸æ¨èï¼‰"></a>ä½¿ç”¨å‹ç¼©åŒ…è¿›è¡Œå®‰è£…ï¼ˆä¸æ¨èï¼‰</h6><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">node01æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ä¸‹è½½tclå®‰è£…åŒ…</span>cd /weitrue/softwget http://downloads.sourceforge.net/tcl/tcl8.6.1-src.tar.gz<span class="hljs-meta">#</span><span class="bash">è§£å‹tcl</span>tar -zxvf tcl8.6.1-src.tar.gz -C ../install/<span class="hljs-meta">#</span><span class="bash">è¿›å…¥æŒ‡å®šç›®å½•</span>cd ../install/tcl8.6.1/unix/./configuremake  &amp;&amp; make  install</code></pre><h6 id="åœ¨çº¿å®‰è£…tclï¼ˆå¢™è£‚æ¨èï¼‰"><a href="#åœ¨çº¿å®‰è£…tclï¼ˆå¢™è£‚æ¨èï¼‰" class="headerlink" title="åœ¨çº¿å®‰è£…tclï¼ˆå¢™è£‚æ¨èï¼‰"></a>åœ¨çº¿å®‰è£…tclï¼ˆå¢™è£‚æ¨èï¼‰</h6><p>node01æ‰§è¡Œä»¥ä¸‹å‘½ä»¤åœ¨çº¿å®‰è£…tcl</p><pre><code class="hljs shell">sudo yum  -y  install  tcl</code></pre><h5 id="è¿›è¡Œç¼–è¯‘redis"><a href="#è¿›è¡Œç¼–è¯‘redis" class="headerlink" title="è¿›è¡Œç¼–è¯‘redis"></a>è¿›è¡Œç¼–è¯‘redis</h5><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> node01æ‰§è¡Œä»¥ä¸‹å‘½ä»¤è¿›è¡Œç¼–è¯‘ï¼š</span>cd /weitrue/install/redis-6.0.1/<span class="hljs-meta">#</span><span class="bash"> make MALLOC=libc   æˆ–è€…ä½¿ç”¨å‘½ä»¤  make  è¿›è¡Œç¼–è¯‘</span>make test &amp;&amp; make install</code></pre><h5 id="ä¿®æ”¹redisé…ç½®æ–‡ä»¶"><a href="#ä¿®æ”¹redisé…ç½®æ–‡ä»¶" class="headerlink" title="ä¿®æ”¹redisé…ç½®æ–‡ä»¶"></a>ä¿®æ”¹redisé…ç½®æ–‡ä»¶</h5><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> node01æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ä¿®æ”¹redisé…ç½®æ–‡ä»¶</span>cd /weitrue/install/redis-6.0.1/mkdir -p /weitrue/install/redis-6.0.1/logsmkdir -p /weitrue/install/redis-6.0.1/redisdatavim redis.confbind node01daemonize yespidfile /weitrue/install/redis-6.0.1/redis_6379.pidlogfile &quot;/weitrue/install/redis-6.0.1/logs/redis.log&quot;dir /weitrue/install/redis-6.0.1/redisdata</code></pre><p><code>daemonize yes</code>: redisé‡‡ç”¨çš„æ˜¯å•è¿›ç¨‹å¤šçº¿ç¨‹çš„æ¨¡å¼ã€‚<br>å½“redis.confä¸­é€‰é¡¹daemonizeè®¾ç½®æˆyesæ—¶ï¼Œä»£è¡¨å¼€å¯å®ˆæŠ¤è¿›ç¨‹æ¨¡å¼ã€‚åœ¨è¯¥æ¨¡å¼ä¸‹ï¼Œredisä¼šåœ¨åå°è¿è¡Œï¼Œå¹¶å°†è¿›ç¨‹pidå·å†™å…¥è‡³redis.confé€‰é¡¹pidfileè®¾ç½®çš„æ–‡ä»¶ä¸­ï¼Œæ­¤æ—¶rediså°†ä¸€ç›´è¿è¡Œï¼Œé™¤éæ‰‹åŠ¨killè¯¥è¿›ç¨‹ã€‚<br><code>daemonize no</code>: å½“daemonizeé€‰é¡¹è®¾ç½®æˆnoæ—¶ï¼Œå½“å‰ç•Œé¢å°†è¿›å…¥redisçš„å‘½ä»¤è¡Œç•Œé¢ï¼Œexitå¼ºåˆ¶é€€å‡ºæˆ–è€…å…³é—­è¿æ¥å·¥å…·(putty,xshellç­‰)éƒ½ä¼šå¯¼è‡´redisè¿›ç¨‹é€€å‡ºã€‚</p><h5 id="å¯åŠ¨redis"><a href="#å¯åŠ¨redis" class="headerlink" title="å¯åŠ¨redis"></a>å¯åŠ¨redis</h5><p>node01æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å¯åŠ¨redis</p><pre><code class="hljs shell">cd  /weitrue/install/redis-6.0.1src/redis-server  redis.conf<span class="hljs-meta">#</span><span class="bash"> æŸ¥çœ‹è¿›ç¨‹</span>ps aux|grep redisæˆ–è€…ps -ef | grep redis | grep -v &quot;grep&quot;  # åŠ ä¸Š| grep -v &quot;grep&quot;ï¼Œæ˜¯æŒ‡ä¸çœ‹grepè¿›ç¨‹</code></pre><h5 id="è¿æ¥rediså®¢æˆ·ç«¯"><a href="#è¿æ¥rediså®¢æˆ·ç«¯" class="headerlink" title="è¿æ¥rediså®¢æˆ·ç«¯"></a>è¿æ¥rediså®¢æˆ·ç«¯</h5><p>node01æ‰§è¡Œä»¥ä¸‹å‘½ä»¤è¿æ¥rediså®¢æˆ·ç«¯</p><pre><code class="hljs shell">cd /weitrue/install/redis-6.0.1src/redis-cli -h node01</code></pre><h4 id="redisçš„æ“ä½œå‘½ä»¤"><a href="#redisçš„æ“ä½œå‘½ä»¤" class="headerlink" title="redisçš„æ“ä½œå‘½ä»¤"></a>redisçš„æ“ä½œå‘½ä»¤</h4><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">æ£€æµ‹redisæœåŠ¡æ˜¯å¦å¯åŠ¨</span>PING<span class="hljs-meta">#</span><span class="bash">è®¾ç½®keyã€value</span>SET KEY_NAME VALUE<span class="hljs-meta">#</span><span class="bash">åˆ é™¤</span>del key<span class="hljs-meta">#</span><span class="bash">è·å–keyæ˜¯å¦å­˜åœ¨</span>exists key<span class="hljs-meta">#</span><span class="bash">è·å–keyçš„ç±»å‹</span>type key<span class="hljs-meta">#</span><span class="bash">ä¸ºkeyæ”¹å</span>rename key newkeyrenamenx key newkey<span class="hljs-meta">#</span><span class="bash">åˆ‡æ¢æ•°æ®åº“</span>select index<span class="hljs-meta">#</span><span class="bash">é€€å‡ºå®¢æˆ·ç«¯</span>quit</code></pre><h3 id="redisçš„æ•°æ®ç±»å‹"><a href="#redisçš„æ•°æ®ç±»å‹" class="headerlink" title="redisçš„æ•°æ®ç±»å‹"></a><strong>redisçš„æ•°æ®ç±»å‹</strong></h3><p>Redisæ”¯æŒçš„å¸¸ç”¨5ç§æ•°æ®ç±»å‹æŒ‡çš„æ˜¯valueç±»å‹ï¼Œåˆ†åˆ«ä¸ºï¼š<strong>å­—ç¬¦ä¸²Stringã€åˆ—è¡¨Listã€å“ˆå¸ŒHashã€é›†åˆSetã€æœ‰åºé›†åˆZset</strong>ï¼Œä½†æ˜¯Redisåç»­åˆä¸°å¯Œäº†å‡ ç§æ•°æ®ç±»å‹åˆ†åˆ«æ˜¯Bitmapsã€HyperLogLogsã€GEOã€‚</p><p> ç”±äºRedisæ˜¯åŸºäºæ ‡å‡†Cå†™çš„ï¼Œåªæœ‰æœ€åŸºç¡€çš„æ•°æ®ç±»å‹ï¼Œå› æ­¤Redisä¸ºäº†æ»¡è¶³å¯¹å¤–ä½¿ç”¨çš„5ç§æ•°æ®ç±»å‹ï¼Œå¼€å‘äº†å±äºè‡ªå·±<strong>ç‹¬æœ‰çš„ä¸€å¥—åŸºç¡€æ•°æ®ç»“æ„</strong>ï¼Œä½¿ç”¨è¿™äº›æ•°æ®ç»“æ„æ¥å®ç°5ç§æ•°æ®ç±»å‹ã€‚</p><p>Redisä¸ºäº†å¹³è¡¡ç©ºé—´å’Œæ—¶é—´æ•ˆç‡ï¼Œé’ˆå¯¹valueçš„å…·ä½“ç±»å‹åœ¨åº•å±‚ä¼šé‡‡ç”¨ä¸åŒçš„æ•°æ®ç»“æ„æ¥å®ç°ï¼Œå…¶ä¸­å“ˆå¸Œè¡¨å’Œå‹ç¼©åˆ—è¡¨æ˜¯å¤ç”¨æ¯”è¾ƒå¤šçš„æ•°æ®ç»“æ„ï¼Œå¦‚ä¸‹å›¾å±•ç¤ºäº†å¯¹å¤–æ•°æ®ç±»å‹å’Œåº•å±‚æ•°æ®ç»“æ„ä¹‹é—´çš„æ˜ å°„å…³ç³»ï¼š</p><p><img src="/images/redis/wps4.jpg"></p><p>ä»å›¾ä¸­å¯ä»¥çœ‹åˆ°ziplistå‹ç¼©åˆ—è¡¨å¯ä»¥ä½œä¸ºZsetã€Setã€Listä¸‰ç§æ•°æ®ç±»å‹çš„åº•å±‚å®ç°ï¼Œçœ‹æ¥å¾ˆå¼ºå¤§ï¼Œå‹ç¼©åˆ—è¡¨æ˜¯ä¸€ç§ä¸ºäº†èŠ‚çº¦å†…å­˜è€Œå¼€å‘çš„ä¸”ç»è¿‡ç‰¹æ®Šç¼–ç ä¹‹åçš„è¿ç»­å†…å­˜å—é¡ºåºå‹æ•°æ®ç»“æ„ï¼Œåº•å±‚ç»“æ„è¿˜æ˜¯æ¯”è¾ƒå¤æ‚çš„ã€‚</p><h4 id="rediså½“ä¸­å„ç§æ•°æ®ç±»å‹çš„æ“ä½œ"><a href="#rediså½“ä¸­å„ç§æ•°æ®ç±»å‹çš„æ“ä½œ" class="headerlink" title="rediså½“ä¸­å„ç§æ•°æ®ç±»å‹çš„æ“ä½œ"></a>rediså½“ä¸­å„ç§æ•°æ®ç±»å‹çš„æ“ä½œ</h4><p>redisè‡ªèº«æ˜¯ä¸€ä¸ªMapï¼Œå…¶ä¸­æ‰€æœ‰çš„æ•°æ®éƒ½æ˜¯é‡‡ç”¨key : value çš„å½¢å¼å­˜å‚¨</p><p><img src="/images/redis/image-20200529015634835.png"></p><h4 id="å­—ç¬¦ä¸²"><a href="#å­—ç¬¦ä¸²" class="headerlink" title="å­—ç¬¦ä¸²"></a>å­—ç¬¦ä¸²</h4><pre><code class="hljs plain">å­˜å‚¨çš„æ•°æ®ï¼šå•ä¸ªæ•°æ®ï¼Œæœ€ç®€å•çš„æ•°æ®å­˜å‚¨ç±»å‹ï¼Œä¹Ÿæ˜¯æœ€å¸¸ç”¨çš„æ•°æ®å­˜å‚¨ç±»å‹å­˜å‚¨æ•°æ®çš„æ ¼å¼ï¼šä¸€ä¸ªå­˜å‚¨ç©ºé—´ä¿å­˜ä¸€ä¸ªæ•°æ®å­˜å‚¨å†…å®¹ï¼šé€šå¸¸ä½¿ç”¨å­—ç¬¦ä¸²ï¼Œå¦‚æœå­—ç¬¦ä¸²ä»¥æ•´æ•°çš„å½¢å¼å±•ç¤ºï¼Œå¯ä»¥ä½œä¸ºæ•°å­—æ“ä½œä½¿ç”¨</code></pre><p><img src="/images/redis/image-20200529020001463.png"></p><p>ä¸‹è¡¨åˆ—å‡ºäº†å¸¸ç”¨çš„ redis å­—ç¬¦ä¸²å‘½ä»¤</p><pre><code class="hljs shell">1.SET key value: è®¾ç½®æŒ‡å®š`key`çš„å€¼,O(1)ã€‚ç¤ºä¾‹ï¼š`SET hello world`2.GET key:è·å–æŒ‡å®š`key`çš„å€¼,O(1)ã€‚ç¤ºä¾‹ï¼š`GET hello`3.GETRANGE key start end:è¿”å›`key`ä¸­å­—ç¬¦ä¸²å€¼çš„å­å­—ç¬¦,åŒ…å«endã€‚ç¤ºä¾‹ï¼š`GETRANGE hello 0 3`4.GETSET key value:å°†ç»™å®š`key`çš„å€¼è®¾ä¸º`value`ï¼Œå¹¶è¿”å›`key`çš„æ—§å€¼(old value)ã€‚ç¤ºä¾‹ï¼š`GETSET hello world2`5.MGET key1 [key2...]:è·å–æ‰€æœ‰(ä¸€ä¸ªæˆ–å¤šä¸ª)ç»™å®š`key`çš„å€¼ã€‚ç¤ºä¾‹ï¼š`MGET hello world`6.SETEX key seconds value:å°†å€¼`value`å…³è”åˆ°`key`ï¼Œå¹¶å°†`key`çš„è¿‡æœŸæ—¶é—´è®¾ä¸º seconds (ä»¥ç§’ä¸ºå•ä½)ã€‚ç¤ºä¾‹ï¼š`SETEX hello 10 world3`7.SETNX key value: åªæœ‰åœ¨`key`ä¸å­˜åœ¨æ—¶è®¾ç½®`key`çš„å€¼ã€‚ç¤ºä¾‹ï¼š`SETNX weitrue 1`8.SETRANGE key offset value: ç”¨ value å‚æ•°è¦†å†™ç»™å®š key æ‰€å‚¨å­˜çš„å­—ç¬¦ä¸²å€¼ï¼Œä»åç§»é‡`offset`å¼€å§‹ã€‚ç¤ºä¾‹ï¼š`SETRANGE weitrue 0 helloredis`9.STRLEN key: è¿”å›`keyæ‰€å‚¨å­˜çš„å­—ç¬¦ä¸²å€¼çš„é•¿åº¦,O(1)ã€‚ç¤ºä¾‹ï¼š`STRLEN weitrue`10.MSET key value [key value ...]:åŒæ—¶è®¾ç½®ä¸€ä¸ªæˆ–å¤šä¸ª`key-value`å¯¹ï¼ŒåŸå­æ“ä½œã€‚ç¤ºä¾‹ï¼š`MSET weitrue2 weitruevalue2 weitrue3 weitruevalue3`11.MSETNX key value [key value ...]:åŒæ—¶è®¾ç½®ä¸€ä¸ªæˆ–å¤šä¸ª`key-value`å¯¹ï¼Œå½“ä¸”ä»…å½“æ‰€æœ‰ç»™å®š key éƒ½ä¸å­˜åœ¨ã€‚ç¤ºä¾‹ï¼š`MSETNX weitrue4 weitruevalue4 weitrue5 weitruevalue5`12.PSETEX key milliseconds value:è¿™ä¸ªå‘½ä»¤å’Œ SETEX å‘½ä»¤ç›¸ä¼¼ï¼Œä½†å®ƒä»¥æ¯«ç§’ä¸ºå•ä½è®¾ç½®`key`çš„ç”Ÿå­˜æ—¶é—´ï¼Œè€Œä¸æ˜¯åƒ`SETEX`å‘½ä»¤é‚£æ ·ï¼Œä»¥ç§’ä¸ºå•ä½ã€‚ç¤ºä¾‹ï¼š`PSETEX weitrue6 6000 weitrue6value`13.INCR key:å°† key ä¸­å‚¨å­˜çš„æ•°å­—å€¼å¢ä¸€, å¯ç”¨äºåˆ†å¸ƒå¼idç­‰ã€‚ç¤ºä¾‹ï¼š`set weitrue 1`,`INCR weitrue`,`GET weitrue` 14.INCRBY key increment:å°†`key`æ‰€å‚¨å­˜çš„å€¼åŠ ä¸Šç»™å®šçš„å¢é‡å€¼ï¼ˆincrementï¼‰ã€‚ç¤ºä¾‹ï¼š`INCRBY weitrue 2`, `get weitrue`15.INCRBYFLOAT key increment: å°†`key`æ‰€å‚¨å­˜çš„å€¼åŠ ä¸Šç»™å®šçš„æµ®ç‚¹å¢é‡å€¼ï¼ˆincrementï¼‰ã€‚ç¤ºä¾‹ï¼š`INCRBYFLOAT weitrue 0.8`16.DECR key:å°†`key`ä¸­å‚¨å­˜çš„æ•°å­—å€¼å‡ä¸€ã€‚ç¤ºä¾‹ï¼š`set weitrue 1`, `DECR weitrue`, `GET weitrue`17.DECRBY key: `key`æ‰€å‚¨å­˜çš„å€¼å‡å»ç»™å®šçš„å‡é‡å€¼ï¼ˆdecrementï¼‰ ã€‚ç¤ºä¾‹ï¼š`DECRBY weitrue 3`18.APPEND key value: å¦‚æœ`key`å·²ç»å­˜åœ¨å¹¶ä¸”æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œ APPEND å‘½ä»¤å°†æŒ‡å®šçš„`value`è¿½åŠ åˆ°è¯¥`key`åŸæ¥å€¼ï¼ˆvalueï¼‰çš„æœ«å°¾ã€‚ç¤ºä¾‹ï¼š`APPEND weitrue hello`</code></pre><h4 id="å¯¹keyçš„æ“ä½œ"><a href="#å¯¹keyçš„æ“ä½œ" class="headerlink" title="å¯¹keyçš„æ“ä½œ"></a>å¯¹keyçš„æ“ä½œ</h4><p>ä¸‹è¡¨ç»™å‡ºäº†ä¸ Redis é”®ç›¸å…³çš„åŸºæœ¬å‘½ä»¤ï¼š</p><ul><li><code>dbsize</code>ï¼šè®¡ç®—keyçš„æ€»æ•°ï¼ŒO(1)</li></ul><pre><code class="hljs shell">DEL key: è¯¥å‘½ä»¤ç”¨äºåœ¨`key`å­˜åœ¨æ—¶åˆ é™¤`key`ã€‚ç¤ºä¾‹ï¼š`del weitrue`DUMP key: åºåˆ—åŒ–ç»™å®š`key`ï¼Œå¹¶è¿”å›è¢«åºåˆ—åŒ–çš„å€¼ã€‚ç¤ºä¾‹ï¼š`DUMP key`EXISTS key: æ£€æŸ¥ç»™å®š key æ˜¯å¦å­˜åœ¨ã€‚ç¤ºä¾‹ï¼š`exists weitrue`EXPIRE key seconds: ä¸ºç»™å®š`key`è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œä»¥ç§’è®¡ã€‚ç¤ºä¾‹ï¼š`expire weitrue 5`PEXPIRE key milliseconds: è®¾ç½®`key`çš„è¿‡æœŸæ—¶é—´ä»¥æ¯«ç§’è®¡ã€‚ç¤ºä¾‹ï¼š`PEXPIRE set2 3000000`KEYS pattern: æŸ¥æ‰¾æ‰€æœ‰ç¬¦åˆç»™å®šæ¨¡å¼(pattern)çš„`key`ã€‚ç¤ºä¾‹ï¼š`keys *`PERSIST key: ç§»é™¤`key`çš„è¿‡æœŸæ—¶é—´ï¼Œ`key`å°†æŒä¹…ä¿æŒã€‚ç¤ºä¾‹ï¼š`persist set2`PTTL key: ä»¥æ¯«ç§’ä¸ºå•ä½è¿”å›`key`çš„å‰©ä½™çš„è¿‡æœŸæ—¶é—´ã€‚ç¤ºä¾‹ï¼š`pttl  set2`TTL key: ä»¥ç§’ä¸ºå•ä½ï¼Œè¿”å›ç»™å®š`key`çš„å‰©ä½™ç”Ÿå­˜æ—¶é—´(TTL, time to live)ã€‚ç¤ºä¾‹ï¼š`ttl set2`RANDOMKEY: ä»å½“å‰æ•°æ®åº“ä¸­éšæœºè¿”å›ä¸€ä¸ª`key`ã€‚ç¤ºä¾‹ï¼š `randomkey`RENAME key newkey: ä¿®æ”¹`key`çš„åç§°ç¤ºä¾‹ï¼š`rename set5 set8`RENAMENX key newkey: ä»…å½“`newkey`ä¸å­˜åœ¨æ—¶ï¼Œå°†`key`æ”¹åä¸º`newkey`ã€‚ç¤ºä¾‹ï¼š`renamenx  set8 set10`TYPE key: è¿”å›`key`æ‰€å‚¨å­˜çš„å€¼çš„ç±»å‹ã€‚ç¤ºä¾‹ï¼š`type  set10`</code></pre><h4 id="hashåˆ—è¡¨çš„æ“ä½œ"><a href="#hashåˆ—è¡¨çš„æ“ä½œ" class="headerlink" title="hashåˆ—è¡¨çš„æ“ä½œ"></a>hashåˆ—è¡¨çš„æ“ä½œ</h4><pre><code class="hljs angelscript">Redis hash æ˜¯ä¸€ä¸ª<span class="hljs-built_in">string</span>ç±»å‹çš„fieldå’Œvalueçš„æ˜ å°„è¡¨ï¼Œhashç‰¹åˆ«é€‚åˆç”¨äºå­˜å‚¨å¯¹è±¡ã€‚Redis ä¸­æ¯ä¸ª hash å¯ä»¥å­˜å‚¨ <span class="hljs-number">232</span> - <span class="hljs-number">1</span> é”®å€¼å¯¹ï¼ˆ<span class="hljs-number">40</span>å¤šäº¿ï¼‰</code></pre><p>ä¸‹è¡¨åˆ—å‡ºäº† redis hash åŸºæœ¬çš„ç›¸å…³å‘½ä»¤ï¼š</p><pre><code class="hljs shell">HSET key field value: å°†å“ˆå¸Œè¡¨ `key` ä¸­çš„å­—æ®µ `field` çš„å€¼è®¾ä¸º `value` ã€‚ç¤ºä¾‹ï¼š`HSET key1 field1 value1`HSETNX key field value: åªæœ‰åœ¨å­—æ®µ `field` ä¸å­˜åœ¨æ—¶ï¼Œè®¾ç½®å“ˆå¸Œè¡¨å­—æ®µçš„å€¼ã€‚ç¤ºä¾‹ï¼š`HSETNX key1 field2 value2`HMSET key field1 value1 [field2 value2 ...]: åŒæ—¶å°†å¤šä¸ª`field-value`(åŸŸ-å€¼)å¯¹è®¾ç½®åˆ°å“ˆå¸Œè¡¨`key`ä¸­, O(n)ã€‚ç¤ºä¾‹ï¼š`HMSET key1 field3 value3 field4 value4`HEXISTS key field: æŸ¥çœ‹å“ˆå¸Œè¡¨`key`ä¸­ï¼ŒæŒ‡å®šçš„å­—æ®µæ˜¯å¦å­˜åœ¨ã€‚ç¤ºä¾‹ï¼š`HEXISTS key1 field4HEXISTS key1 field6`HGET key field: è·å–å­˜å‚¨åœ¨å“ˆå¸Œè¡¨ä¸­æŒ‡å®šå­—æ®µçš„å€¼ã€‚ç¤ºä¾‹ï¼š`HGET key1 field4`HGETALL key: è·å–åœ¨å“ˆå¸Œè¡¨ä¸­æŒ‡å®š `key` çš„æ‰€æœ‰å­—æ®µå’Œå€¼ã€‚ç¤ºä¾‹ï¼š`HGETALL key1`HKEYS key: è·å–æ‰€æœ‰å“ˆå¸Œè¡¨ä¸­çš„å­—æ®µã€‚ç¤ºä¾‹ï¼š`HKEYS key1`HLEN key: è·å–å“ˆå¸Œè¡¨ä¸­å­—æ®µçš„æ•°é‡ã€‚ç¤ºä¾‹ï¼š`HLEN key1`HMGET key field1 [field2 ...]: è·å–æ‰€æœ‰ç»™å®šå­—æ®µçš„å€¼, O(n)ã€‚ç¤ºä¾‹ï¼š`HMGET key1 field1 field2`HINCRBY key field increment: ä¸ºå“ˆå¸Œè¡¨`key`ä¸­çš„æŒ‡å®šå­—æ®µçš„æ•´æ•°å€¼åŠ ä¸Šå¢é‡`increment`ã€‚ç¤ºä¾‹ï¼š`HSET key2 field1 1HINCRBY key2 field1 1HGET key2 field1`HINCRBYFLOAT key field increment: ä¸ºå“ˆå¸Œè¡¨`key`ä¸­çš„æŒ‡å®šå­—æ®µçš„æµ®ç‚¹æ•°å€¼åŠ ä¸Šå¢é‡`increment`ã€‚ç¤ºä¾‹ï¼š`HINCRBYFLOAT key2 field1 0.8`HVALS key: è·å–å“ˆå¸Œè¡¨ä¸­æ‰€æœ‰å€¼ã€‚ç¤ºä¾‹ï¼š`HVALS key1`HDEL key field1 [field2 ...]: åˆ é™¤ä¸€ä¸ªæˆ–å¤šä¸ªå“ˆå¸Œè¡¨å­—æ®µã€‚ç¤ºä¾‹ï¼š`HDEL key1 field1HVALS key1`</code></pre> <pre><code class="hljs shell">node01:6379&gt; HSET app:mytest1 test1 &quot;123&quot;OKnode01:6379&gt; HGET app:mytest test1&quot;123&quot;</code></pre><h4 id="liståˆ—è¡¨çš„æ“ä½œ"><a href="#liståˆ—è¡¨çš„æ“ä½œ" class="headerlink" title="liståˆ—è¡¨çš„æ“ä½œ"></a>liståˆ—è¡¨çš„æ“ä½œ</h4> <pre><code class="hljs angelscript">Redisåˆ—è¡¨æ˜¯ç®€å•çš„å­—ç¬¦ä¸²åˆ—è¡¨ï¼ŒæŒ‰ç…§æ’å…¥é¡ºåºæ’åºã€‚ä½ å¯ä»¥æ·»åŠ ä¸€ä¸ªå…ƒç´ åˆ°åˆ—è¡¨çš„å¤´éƒ¨ï¼ˆå·¦è¾¹ï¼‰æˆ–è€…å°¾éƒ¨ï¼ˆå³è¾¹ï¼‰ä¸€ä¸ªåˆ—è¡¨æœ€å¤šå¯ä»¥åŒ…å« <span class="hljs-number">232</span> - <span class="hljs-number">1</span> ä¸ªå…ƒç´  (<span class="hljs-number">4294967295</span>, æ¯ä¸ªåˆ—è¡¨è¶…è¿‡<span class="hljs-number">40</span>äº¿ä¸ªå…ƒç´ )ã€‚</code></pre><p>ä¸‹è¡¨åˆ—å‡ºäº†åˆ—è¡¨ç›¸å…³çš„åŸºæœ¬å‘½ä»¤:</p><pre><code class="hljs shell">LPUSH key value1 [value2]: å°†ä¸€ä¸ªæˆ–å¤šä¸ªå€¼æ’å…¥åˆ°åˆ—è¡¨å¤´éƒ¨ã€‚ç¤ºä¾‹ï¼š`LPUSH list1 value1 value2`LRANGE key start stop: æŸ¥çœ‹listå½“ä¸­æŒ‡å®šèŒƒå›´ï¼ˆåŒ…å«stopï¼‰çš„æ•°æ®ã€‚ç¤ºä¾‹ï¼š`LRANGE list1 0 -1`LPUSHX key value: å°†ä¸€ä¸ªå€¼æ’å…¥åˆ°å·²å­˜åœ¨çš„åˆ—è¡¨å¤´éƒ¨ã€‚ç¤ºä¾‹ï¼š`LPUSHX list1 value3` `LINDEX list1 0`RPUSH key value1 [value2]: åœ¨åˆ—è¡¨ä¸­æ·»åŠ ä¸€ä¸ªæˆ–å¤šä¸ªå€¼ã€‚ç¤ºä¾‹ï¼š`RPUSH list1 value4 value5` `LRANGE list1 0 -1`RPUSHX key value: ä¸ºå·²å­˜åœ¨çš„åˆ—è¡¨æ·»åŠ å€¼ã€‚ç¤ºä¾‹ï¼š`RPUSHX list1 value6`LINSERT key BEFORE|AFTER pivot value: åœ¨åˆ—è¡¨çš„å…ƒç´ å‰æˆ–è€…åæ’å…¥å…ƒç´ ã€‚ç¤ºä¾‹ï¼š`LINSERT list1 BEFORE value3 beforevalue3`LINDEX key index: é€šè¿‡ç´¢å¼•è·å–åˆ—è¡¨ä¸­çš„å…ƒç´ , O(n)ã€‚ç¤ºä¾‹ï¼š`LINDEX list1 0`LSET key index value: é€šè¿‡ç´¢å¼•è®¾ç½®åˆ—è¡¨å…ƒç´ çš„å€¼, O(n)ã€‚ç¤ºä¾‹ï¼š`LSET list1 0 hello`LLEN key: è·å–åˆ—è¡¨é•¿åº¦ã€‚ç¤ºä¾‹ï¼š`LLEN list1`LPOP key: ç§»å‡ºå¹¶è·å–åˆ—è¡¨çš„ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚ç¤ºä¾‹ï¼š`LPOP list1`RPOP key: ç§»é™¤åˆ—è¡¨çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œè¿”å›å€¼ä¸ºç§»é™¤çš„å…ƒç´ ã€‚ç¤ºä¾‹ï¼š`RPOP list1`BLPOP key1 [key2 ...] timeout: ç§»å‡ºå¹¶è·å–åˆ—è¡¨çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œ å¦‚æœåˆ—è¡¨æ²¡æœ‰å…ƒç´ ä¼šé˜»å¡åˆ—è¡¨ç›´åˆ°ç­‰å¾…è¶…æ—¶æˆ–å‘ç°å¯å¼¹å‡ºå…ƒç´ ä¸ºæ­¢ã€‚ç¤ºä¾‹ï¼š`BLPOP list1 2000`BRPOP key1 [key2 ...] timeout: ç§»å‡ºå¹¶è·å–åˆ—è¡¨çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œ å¦‚æœåˆ—è¡¨æ²¡æœ‰å…ƒç´ ä¼šé˜»å¡åˆ—è¡¨ç›´åˆ°ç­‰å¾…è¶…æ—¶æˆ–å‘ç°å¯å¼¹å‡ºå…ƒç´ ä¸ºæ­¢ã€‚ç¤ºä¾‹ï¼š`BRPOP list1 2000`RPOPLPUSH source destination: ç§»é™¤åˆ—è¡¨çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œå¹¶å°†è¯¥å…ƒç´ æ·»åŠ åˆ°å¦ä¸€ä¸ªåˆ—è¡¨å¹¶è¿”å›ã€‚ç¤ºä¾‹ï¼š`RPOPLPUSH list1 list2`BRPOPLPUSH source destination timeout: ä»åˆ—è¡¨ä¸­å¼¹å‡ºä¸€ä¸ªå€¼ï¼Œå°†å¼¹å‡ºçš„å…ƒç´ æ’å…¥åˆ°å¦å¤–ä¸€ä¸ªåˆ—è¡¨ä¸­å¹¶è¿”å›å®ƒï¼› å¦‚æœåˆ—è¡¨æ²¡æœ‰å…ƒç´ ä¼šé˜»å¡åˆ—è¡¨ç›´åˆ°ç­‰å¾…è¶…æ—¶æˆ–å‘ç°å¯å¼¹å‡ºå…ƒç´ ä¸ºæ­¢ã€‚ç¤ºä¾‹ï¼š`BRPOPLPUSH list1 list2 2000`LTRIM key start stop: å¯¹ä¸€ä¸ªåˆ—è¡¨è¿›è¡Œä¿®å‰ª(trim)ï¼Œå°±æ˜¯è¯´ï¼Œè®©åˆ—è¡¨åªä¿ç•™æŒ‡å®šåŒºé—´å†…çš„å…ƒç´ ï¼Œä¸åœ¨æŒ‡å®šåŒºé—´ä¹‹å†…çš„å…ƒç´ éƒ½å°†è¢«åˆ é™¤ã€‚ç¤ºä¾‹ï¼š`LTRIM list1 0 2`DEL key1 key2: åˆ é™¤æŒ‡å®škeyçš„åˆ—è¡¨ã€‚ç¤ºä¾‹ï¼š`DEL list2`</code></pre><pre><code class="hljs routeros">Tips:LPUSH + LPOP = STACKLPUSH + RPOP = QUEUELPUSH + LTRIM = å›ºå®šå¤§å°é›†åˆæˆ–è€…LRULPUSH + BRPOP = æ¶ˆæ¯é˜Ÿåˆ—</code></pre><h4 id="seté›†åˆ"><a href="#seté›†åˆ" class="headerlink" title="seté›†åˆ"></a>seté›†åˆ</h4> <pre><code class="hljs angelscript">redis çš„ Set æ˜¯ String ç±»å‹çš„æ— åºé›†åˆã€‚é›†åˆæˆå‘˜æ˜¯å”¯ä¸€çš„ï¼Œè¿™å°±æ„å‘³ç€é›†åˆä¸­ä¸èƒ½å‡ºç°é‡å¤çš„æ•°æ®ã€‚Redis ä¸­é›†åˆæ˜¯é€šè¿‡å“ˆå¸Œè¡¨å®ç°çš„ï¼Œæ‰€ä»¥æ·»åŠ ï¼Œåˆ é™¤ï¼ŒæŸ¥æ‰¾çš„å¤æ‚åº¦éƒ½æ˜¯ O(<span class="hljs-number">1</span>)ã€‚é›†åˆä¸­æœ€å¤§çš„æˆå‘˜æ•°ä¸º <span class="hljs-number">232</span> - <span class="hljs-number">1</span> (<span class="hljs-number">4294967295</span>, æ¯ä¸ªé›†åˆå¯å­˜å‚¨<span class="hljs-number">40</span>å¤šäº¿ä¸ªæˆå‘˜)ã€‚</code></pre><p>ä¸‹è¡¨åˆ—å‡ºäº† Redis é›†åˆåŸºæœ¬å‘½ä»¤ï¼š</p><pre><code class="hljs shell">SADD key member1 [member2 ...]: å‘é›†åˆæ·»åŠ ä¸€ä¸ªæˆ–å¤šä¸ªæˆå‘˜ã€‚ç¤ºä¾‹ï¼š`SADD set1 setvalue1 setvalue2`SMEMBERS key: è¿”å›é›†åˆä¸­çš„æ‰€æœ‰æˆå‘˜ã€‚ç¤ºä¾‹ï¼š`SMEMBERS set1`SCARD key: è·å–é›†åˆçš„æˆå‘˜æ•°ã€‚ç¤ºä¾‹ï¼š`SCARD set1`SDIFF key1 [key2 ...]: è¿”å›ç»™å®šæ‰€æœ‰é›†åˆçš„å·®é›†ã€‚ç¤ºä¾‹ï¼š`SADD set2 setvalue2 setvalue3SDIFF set1 set2`SDIFFSTORE destkey key1 [key2 ...]: è¿”å›ç»™å®šæ‰€æœ‰é›†åˆçš„å·®é›†å¹¶å­˜å‚¨åœ¨ destkey ä¸­ã€‚ç¤ºä¾‹ï¼š`SDIFFSTORE set3 set1 set2`SINTER key1 [key2 ...]: è¿”å›ç»™å®šæ‰€æœ‰é›†åˆçš„äº¤é›†ã€‚ç¤ºä¾‹ï¼š`SINTER set1 set2`SINTERSTORE destkey key1 [key2 ...]: è¿”å›ç»™å®šæ‰€æœ‰é›†åˆçš„äº¤é›†å¹¶å­˜å‚¨åœ¨`destkey`ä¸­ã€‚ç¤ºä¾‹ï¼š`SINTERSTORE set4 set1 set2`SISMEMBER key member: åˆ¤æ–­ member å…ƒç´ æ˜¯å¦æ˜¯é›†åˆ`key`çš„æˆå‘˜ã€‚ç¤ºä¾‹ï¼š`SISMEMBER set1 setvalue1`SMOVE sourcekey destkey member: å°†`member`å…ƒç´ ä»`sourcekey`é›†åˆç§»åŠ¨åˆ°`destkey`é›†åˆã€‚ç¤ºä¾‹ï¼š`SMOVE set1 set2 setvalue1`SPOP key: ç§»é™¤å¹¶è¿”å›é›†åˆä¸­çš„ä¸€ä¸ªéšæœºå…ƒç´ ã€‚ç¤ºä¾‹ï¼š`SPOP set2`SRANDMEMBER key [count ...]: è¿”å›é›†åˆä¸­ä¸€ä¸ªæˆ–å¤šä¸ªéšæœºæ•°ã€‚ç¤ºä¾‹ï¼š`SRANDMEMBER set2 2`SREM key member1 [member2 ...]: ç§»é™¤é›†åˆä¸­ä¸€ä¸ªæˆ–å¤šä¸ªæˆå‘˜ã€‚ç¤ºä¾‹ï¼š`SREM set2 setvalue1`SUNION key1 [key2 ...]: è¿”å›æ‰€æœ‰ç»™å®šé›†åˆçš„å¹¶é›†ã€‚ç¤ºä¾‹ï¼š`SUNION set1 set2`SUNIONSTORE destkey key1 [key2 ...]: æ‰€æœ‰ç»™å®šé›†åˆçš„å¹¶é›†å­˜å‚¨åœ¨`destkey`é›†åˆä¸­ã€‚ç¤ºä¾‹ï¼š`SUNIONSTORE set5 set1 set2`</code></pre><h4 id="zseté›†åˆ"><a href="#zseté›†åˆ" class="headerlink" title="zseté›†åˆ"></a>zseté›†åˆ</h4><p>ä¸‹è¡¨åˆ—å‡ºäº† redis æœ‰åºé›†åˆçš„åŸºæœ¬å‘½ä»¤:</p><pre><code class="hljs shell">ZADD key score1 member1 [score2 member2 ...]: å‘æœ‰åºé›†åˆæ·»åŠ ä¸€ä¸ªæˆ–å¤šä¸ªæˆå‘˜ï¼Œæˆ–è€…æ›´æ–°å·²å­˜åœ¨æˆå‘˜çš„åˆ†æ•°ã€‚ä¾‹å¦‚ï¼š`ADD zset1 90 ze1`ZCARD key: è·å–æœ‰åºé›†åˆçš„æˆå‘˜æ•°ã€‚ä¾‹å¦‚ï¼š`zcard zset1`ZCOUNT key min max: è®¡ç®—åœ¨æœ‰åºé›†åˆä¸­æŒ‡å®šåŒºé—´åˆ†æ•°çš„æˆå‘˜æ•°ã€‚ä¾‹å¦‚ï¼š`zcount zset1 90 91`ZINCRBY key increment member: æœ‰åºé›†åˆä¸­å¯¹æŒ‡å®šæˆå‘˜çš„åˆ†æ•°åŠ ä¸Šå¢é‡`increment`ã€‚ä¾‹å¦‚ï¼š`zincrby zset1 1 ze1`ZINTERSTORE destkey numkeys key [key ...]: è®¡ç®—ç»™å®šçš„ä¸€ä¸ªæˆ–å¤šä¸ªæœ‰åºé›†çš„äº¤é›†å¹¶å°†ç»“æœé›†å­˜å‚¨åœ¨æ–°çš„æœ‰åºé›†åˆ destkey ä¸­ã€‚ä¾‹å¦‚ï¼š`ZINTERSTORE destkey 1 zset1`ZLEXCOUNT key min max: åœ¨æœ‰åºé›†åˆä¸­è®¡ç®—æŒ‡å®šå­—å…¸åŒºé—´å†…æˆå‘˜æ•°é‡ã€‚ä¾‹å¦‚ï¼š``ZRANGE key start stop [WITHSCORES]: é€šè¿‡ç´¢å¼•åŒºé—´è¿”å›æœ‰åºé›†åˆæŒ‡å®šåŒºé—´å†…çš„æˆå‘˜ã€‚ä¾‹å¦‚ï¼š`ZRANGE destkey 0 -1`ZRANGEBYLEX key min max [LIMIT offset count]: é€šè¿‡å­—å…¸åŒºé—´è¿”å›æœ‰åºé›†åˆçš„æˆå‘˜ã€‚ä¾‹å¦‚ï¼šnode02:15&gt;ZADD myzset 0 a 0 b 0 c 0 d 0 e 0 f 0 g&quot;7&quot;node02:15&gt;ZRANGEBYLEX myzset - [c 1)  &quot;a&quot; 2)  &quot;b&quot; 3)  &quot;c&quot;ZRANGEBYSCORE key min max [WITHSCORES] [LIMIT]: é€šè¿‡åˆ†æ•°è¿”å›æœ‰åºé›†åˆæŒ‡å®šåŒºé—´å†…çš„æˆå‘˜ã€‚ä¾‹å¦‚ï¼š`ZRANGEBYSCORE zset1 90 99`ZRANK key member: è¿”å›æœ‰åºé›†åˆä¸­æŒ‡å®šæˆå‘˜çš„ç´¢å¼•ã€‚ä¾‹å¦‚ï¼š`ZRANK zset1 ze1`ZREM key member [member ...]: ç§»é™¤æœ‰åºé›†åˆä¸­çš„ä¸€ä¸ªæˆ–å¤šä¸ªæˆå‘˜ã€‚ä¾‹å¦‚ï¼š`ZREM destkey ze2`ZREMRANGEBYLEX key min max]: ç§»é™¤æœ‰åºé›†åˆä¸­ç»™å®šçš„å­—å…¸åŒºé—´çš„æ‰€æœ‰æˆå‘˜ã€‚ä¾‹å¦‚ï¼šnode02:15&gt;ZRANGE myzset 0 -1 1)  &quot;d&quot; 2)  &quot;e&quot; 3)  &quot;f&quot; 4)  &quot;g&quot;ZREMRANGEBYRANK key start stop: ç§»é™¤æœ‰åºé›†åˆä¸­ç»™å®šçš„æ’ååŒºé—´çš„æ‰€æœ‰æˆå‘˜ã€‚ä¾‹å¦‚ï¼šnode02:15&gt;ZADD salary 2000 jack 5000 tom 3500 peter&quot;3&quot;node02:15&gt;ZREMRANGEBYRANK salary 0 1&quot;2&quot;ZREMRANGEBYSCORE key min max: ç§»é™¤æœ‰åºé›†åˆä¸­ç»™å®šçš„åˆ†æ•°åŒºé—´çš„æ‰€æœ‰æˆå‘˜ã€‚ä¾‹å¦‚ï¼šnode02:15&gt;ZREMRANGEBYSCORE salary 1500 3500&quot;2&quot;node02:15&gt;ZRANGE salary 0 -1 WITHSCORES 1)  &quot;tom&quot; 2)  &quot;5000&quot;ZREVRANGE key start stop [WITHSCORES]: è¿”å›æœ‰åºé›†ä¸­æŒ‡å®šåŒºé—´å†…çš„æˆå‘˜ï¼Œé€šè¿‡ç´¢å¼•ï¼Œåˆ†æ•°ä»é«˜åˆ°ä½ã€‚ä¾‹å¦‚ï¼šnode02:15&gt;ZRANGE salary 0 -1 WITHSCORES 1)  &quot;jack&quot; 2)  &quot;2000&quot; 3)  &quot;peter&quot; 4)  &quot;3500&quot; 5)  &quot;tom&quot; 6)  &quot;5000&quot;node02:15&gt;ZREVRANGE salary 0 -1 WITHSCORES 1)  &quot;tom&quot; 2)  &quot;5000&quot; 3)  &quot;peter&quot; 4)  &quot;3500&quot; 5)  &quot;jack&quot; 6)  &quot;2000&quot;ZREVRANGEBYSCORE key max min [WITHSCORES]: è¿”å›æœ‰åºé›†ä¸­æŒ‡å®šåˆ†æ•°åŒºé—´å†…çš„æˆå‘˜ï¼Œåˆ†æ•°ä»é«˜åˆ°ä½æ’åºã€‚ä¾‹å¦‚ï¼šnode02:15&gt;ZREVRANGEBYSCORE salary 10000 2000 1)  &quot;tom&quot; 2)  &quot;peter&quot; 3)  &quot;jack&quot;ZREVRANK key member: è¿”å›æœ‰åºé›†åˆä¸­æŒ‡å®šæˆå‘˜çš„æ’åï¼Œæœ‰åºé›†æˆå‘˜æŒ‰åˆ†æ•°å€¼é€’å‡(ä»å¤§åˆ°å°)æ’åºã€‚ä¾‹å¦‚ï¼šnode02:15&gt;ZREVRANK salary peter&quot;1&quot;ZSCORE key member: è¿”å›æœ‰åºé›†ä¸­ï¼Œæˆå‘˜çš„åˆ†æ•°å€¼ã€‚ä¾‹å¦‚ï¼šnode02:15&gt;ZSCORE salary peter&quot;3500&quot;ZUNIONSTORE destkey numkeys key [key ...]: è®¡ç®—ç»™å®šçš„ä¸€ä¸ªæˆ–å¤šä¸ªæœ‰åºé›†çš„å¹¶é›†ï¼Œå¹¶å­˜å‚¨åœ¨æ–°çš„ key ä¸­ã€‚ä¾‹å¦‚ï¼šnode02:15&gt;ZADD zset1 1 &quot;one&quot;&quot;1&quot;node02:15&gt;ZADD zset1 2 &quot;two&quot;&quot;1&quot;node02:15&gt;ZADD zset2 1 &quot;one&quot;&quot;1&quot;node02:15&gt;ZADD zset2 2 &quot;two&quot;&quot;1&quot;node02:15&gt;ZADD zset2 3 &quot;three&quot;&quot;1&quot;node02:15&gt;ZUNIONSTORE out 2 zset1 zset2 WEIGHTS 2 3&quot;5&quot;node02:15&gt;ZRANGE out 0 -1 WITHSCORES 1)  &quot;one&quot; 2)  &quot;5&quot; 3)  &quot;three&quot; 4)  &quot;9&quot; 5)  &quot;two&quot; 6)  &quot;10&quot; 7)  &quot;ze1&quot; 8)  &quot;182&quot; 9)  &quot;ze2&quot; 10)  &quot;198&quot;ZSCAN key cursor [MATCH pattern] [COUNT count]: è¿­ä»£æœ‰åºé›†åˆä¸­çš„å…ƒç´ ï¼ˆåŒ…æ‹¬å…ƒç´ æˆå‘˜å’Œå…ƒç´ åˆ†å€¼ï¼‰ã€‚ä¾‹å¦‚ï¼šnode02:15&gt;ZSCAN out 0 match z* 1)  &quot;0&quot; 2)     1)   &quot;ze1&quot; 2)   &quot;182&quot; 3)   &quot;ze2&quot; 4)   &quot;198&quot;</code></pre><h5 id="Redisæœ‰åºé›†åˆzsetåº•å±‚æ€ä¹ˆå®ç°çš„"><a href="#Redisæœ‰åºé›†åˆzsetåº•å±‚æ€ä¹ˆå®ç°çš„" class="headerlink" title="Redisæœ‰åºé›†åˆzsetåº•å±‚æ€ä¹ˆå®ç°çš„"></a>Redisæœ‰åºé›†åˆzsetåº•å±‚æ€ä¹ˆå®ç°çš„</h5><p>Redisä¸­çš„setæ•°æ®ç»“æ„åº•å±‚ç”¨çš„æ˜¯è·³è¡¨å®ç°çš„.</p><p>è·³è¡¨æ˜¯ä¸€ä¸ªéšæœºåŒ–çš„æ•°æ®ç»“æ„ï¼Œå®è´¨å°±æ˜¯ä¸€ç§å¯ä»¥è¿›è¡ŒäºŒåˆ†æŸ¥æ‰¾çš„æœ‰åºé“¾è¡¨ã€‚</p><p>è·³è¡¨åœ¨åŸæœ‰çš„æœ‰åºé“¾è¡¨ä¸Šé¢å¢åŠ äº†å¤šçº§ç´¢å¼•ï¼Œé€šè¿‡ç´¢å¼•æ¥å®ç°å¿«é€ŸæŸ¥æ‰¾ã€‚</p><p>è·³è¡¨ä¸ä»…èƒ½æé«˜æœç´¢æ€§èƒ½ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥æé«˜æ’å…¥å’Œåˆ é™¤æ“ä½œçš„æ€§èƒ½ã€‚</p><p>(1)è·³è¡¨æ˜¯å¯ä»¥å®ç°äºŒåˆ†æŸ¥æ‰¾çš„æœ‰åºé“¾è¡¨ï¼› (2)æ¯ä¸ªå…ƒç´ æ’å…¥æ—¶éšæœºç”Ÿæˆå®ƒçš„levelï¼› (3)æœ€ä½å±‚åŒ…å«æ‰€æœ‰çš„å…ƒç´ ï¼› (4)å¦‚æœä¸€ä¸ªå…ƒç´ å‡ºç°åœ¨level(x)ï¼Œé‚£ä¹ˆå®ƒè‚¯å®šå‡ºç°åœ¨xä»¥ä¸‹çš„levelä¸­ï¼› (5)æ¯ä¸ªç´¢å¼•èŠ‚ç‚¹åŒ…å«ä¸¤ä¸ªæŒ‡é’ˆï¼Œä¸€ä¸ªå‘ä¸‹ï¼Œä¸€ä¸ªå‘å³ï¼› (6)è·³è¡¨æŸ¥è¯¢ã€æ’å…¥ã€åˆ é™¤çš„æ—¶é—´å¤æ‚åº¦ä¸ºO(log n)ï¼Œä¸å¹³è¡¡äºŒå‰æ ‘æ¥è¿‘ï¼›</p><p>ä¸ºä»€ä¹ˆRedisé€‰æ‹©ä½¿ç”¨è·³è¡¨è€Œä¸æ˜¯çº¢é»‘æ ‘æ¥å®ç°æœ‰åºé›†åˆï¼Ÿ(O(logN))</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬æ¥åˆ†æä¸‹Redisçš„æœ‰åºé›†åˆæ”¯æŒçš„æ“ä½œï¼š</p><ul><li>æ’å…¥å…ƒç´ </li><li>åˆ é™¤å…ƒç´ </li><li>æŸ¥æ‰¾å…ƒç´ </li><li>æœ‰åºè¾“å‡ºæ‰€æœ‰å…ƒç´ </li><li>æŸ¥æ‰¾åŒºé—´å†…æ‰€æœ‰å…ƒç´ </li></ul><p>å…¶ä¸­ï¼Œå‰4é¡¹çº¢é»‘æ ‘éƒ½å¯ä»¥å®Œæˆï¼Œä¸”æ—¶é—´å¤æ‚åº¦ä¸è·³è¡¨ä¸€è‡´ã€‚ä½†æ˜¯ï¼Œæœ€åä¸€é¡¹ï¼Œçº¢é»‘æ ‘çš„æ•ˆç‡å°±æ²¡æœ‰è·³è¡¨é«˜äº†ã€‚ åœ¨è·³è¡¨ä¸­ï¼Œè¦æŸ¥æ‰¾åŒºé—´çš„å…ƒç´ ï¼Œæˆ‘ä»¬åªè¦å®šä½åˆ°ä¸¤ä¸ªåŒºé—´ç«¯ç‚¹åœ¨æœ€ä½å±‚çº§çš„ä½ç½®ï¼Œç„¶åæŒ‰é¡ºåºéå†å…ƒç´ å°±å¯ä»¥äº†ï¼Œéå¸¸é«˜æ•ˆã€‚</p><p>è€Œçº¢é»‘æ ‘åªèƒ½å®šä½åˆ°ç«¯ç‚¹åï¼Œå†ä»é¦–ä½ç½®å¼€å§‹æ¯æ¬¡éƒ½è¦æŸ¥æ‰¾åç»§èŠ‚ç‚¹ï¼Œç›¸å¯¹æ¥è¯´æ˜¯æ¯”è¾ƒè€—æ—¶çš„ã€‚ æ­¤å¤–ï¼Œè·³è¡¨å®ç°èµ·æ¥å¾ˆå®¹æ˜“ä¸”æ˜“è¯»ï¼Œçº¢é»‘æ ‘å®ç°èµ·æ¥ç›¸å¯¹å›°éš¾ï¼Œæ‰€ä»¥Redisé€‰æ‹©ä½¿ç”¨è·³è¡¨æ¥å®ç°æœ‰åºé›†åˆã€‚</p><h3 id="ç‘å£«å†›åˆ€"><a href="#ç‘å£«å†›åˆ€" class="headerlink" title="ç‘å£«å†›åˆ€"></a>ç‘å£«å†›åˆ€</h3><h4 id="HyperLogLog"><a href="#HyperLogLog" class="headerlink" title="HyperLogLog"></a>HyperLogLog</h4> <pre><code class="hljs shell">Redis åœ¨ 2.8.9 ç‰ˆæœ¬æ·»åŠ äº† HyperLogLog ç»“æ„ã€‚Redis HyperLogLog æ˜¯ç”¨æ¥åšåŸºæ•°ç»Ÿè®¡çš„ç®—æ³•ï¼ŒHyperLogLog çš„ä¼˜ç‚¹æ˜¯ï¼Œåœ¨è¾“å…¥å…ƒç´ çš„æ•°é‡æˆ–è€…ä½“ç§¯éå¸¸éå¸¸å¤§æ—¶ï¼Œè®¡ç®—åŸºæ•°æ‰€éœ€çš„ç©ºé—´æ€»æ˜¯å›ºå®šçš„ã€å¹¶ä¸”æ˜¯å¾ˆå°çš„ã€‚åœ¨ Redis é‡Œé¢ï¼Œæ¯ä¸ª HyperLogLog é”®åªéœ€è¦èŠ±è´¹ 12 KB å†…å­˜ï¼Œå°±å¯ä»¥è®¡ç®—æ¥è¿‘ 2^64 ä¸ªä¸åŒå…ƒç´ çš„åŸºæ•°ã€‚è¿™å’Œè®¡ç®—åŸºæ•°æ—¶ï¼Œå…ƒç´ è¶Šå¤šè€—è´¹å†…å­˜å°±è¶Šå¤šçš„é›†åˆå½¢æˆé²œæ˜å¯¹æ¯”ã€‚ä½†æ˜¯ï¼Œå› ä¸º HyperLogLog åªä¼šæ ¹æ®è¾“å…¥å…ƒç´ æ¥è®¡ç®—åŸºæ•°ï¼Œè€Œä¸ä¼šå‚¨å­˜è¾“å…¥å…ƒç´ æœ¬èº«ï¼Œæ‰€ä»¥ HyperLogLog ä¸èƒ½åƒé›†åˆé‚£æ ·ï¼Œè¿”å›è¾“å…¥çš„å„ä¸ªå…ƒç´ ã€‚ä»€ä¹ˆæ˜¯åŸºæ•°?æ¯”å¦‚æ•°æ®é›† &#123;1, 3, 5, 7, 5, 7, 8&#125;ï¼Œ é‚£ä¹ˆè¿™ä¸ªæ•°æ®é›†çš„åŸºæ•°é›†ä¸º &#123;1, 3, 5 ,7, 8&#125;, åŸºæ•°(ä¸é‡å¤å…ƒç´ )ä¸º5ã€‚ åŸºæ•°ä¼°è®¡å°±æ˜¯åœ¨è¯¯å·®å¯æ¥å—çš„èŒƒå›´å†…ï¼Œå¿«é€Ÿè®¡ç®—åŸºæ•°ã€‚</code></pre> <pre><code class="hljs shell">Redis HyperLogLog å‘½ä»¤ä¸‹è¡¨åˆ—å‡ºäº† redis HyperLogLog çš„åŸºæœ¬å‘½ä»¤ï¼š1PFADD key element [element ...] node01:6379&gt;PFADD test 123æ·»åŠ æŒ‡å®šå…ƒç´ åˆ° HyperLogLog ä¸­ã€‚2PFCOUNT key [key ...] node01:6379&gt;PFCOUNT test è¿”å›ç»™å®š HyperLogLog çš„åŸºæ•°ä¼°ç®—å€¼ã€‚3PFMERGE destkey sourcekey [sourcekey ...] node01:6379&gt;PFCOUNT kbv weitrue kkv   å°†å¤šä¸ª HyperLogLog åˆå¹¶ä¸ºä¸€ä¸ª HyperLogLog</code></pre><h6 id="åº”ç”¨"><a href="#åº”ç”¨" class="headerlink" title="åº”ç”¨"></a>åº”ç”¨</h6><p><img src="/images/redis/hyperloglog.png"></p><p> ä½†æ˜¯ï¼Œè¿™ä¸ªç»Ÿè®¡æ˜¯ä¸å‡†ç¡®çš„ï¼Œå®˜æ–¹ç»™å‡ºé”™è¯¯ç‡ä¸º0.81%</p><h4 id="pipeline"><a href="#pipeline" class="headerlink" title="pipeline"></a>pipeline</h4><ul><li><p>1æ¬¡pipeline(næ¡å‘½ä»¤) = 1æ¬¡ç½‘ç»œäº‹ä»¶+næ¬¡å‘½ä»¤æ—¶é—´.</p></li><li><p>pipelineå‘½ä»¤ é<strong>åŸå­</strong>åŸå­å‘½ä»¤,è€ŒåŸç”Ÿæ‰¹é‡å‘½ä»¤<strong>mæ“ä½œ</strong>æ˜¯åŸå­å‘½ä»¤ã€‚</p><p><img src="/images/redis/pipem.png"></p><p><img src="/images/redis/pipeline.png"></p></li><li><p>pipelineæ¯æ¬¡åªèƒ½åæ‹¥åœ¨ä¸€ä¸ªredisèŠ‚ç‚¹ã€‚</p></li></ul><p>Javaä»£ç æ‰§è¡Œå¯¹æ¯”</p><pre><code class="hljs Java">        Jedis jedis = <span class="hljs-keyword">null</span>;        <span class="hljs-comment">// è¿æ¥æ± å¤§å°è®¾ç½®</span>        GenericObjectPoolConfig genericObjectPoolConfig = <span class="hljs-keyword">new</span> GenericObjectPoolConfig();        JedisPool jedisPool = <span class="hljs-keyword">new</span> JedisPool(genericObjectPoolConfig, <span class="hljs-string">&quot;node02&quot;</span>, <span class="hljs-number">6379</span>);        <span class="hljs-keyword">long</span> startTime = System.currentTimeMillis();        <span class="hljs-keyword">try</span>&#123;            jedis = jedisPool.getResource();            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt;<span class="hljs-number">10000</span> ; i++) &#123;                jedis.hset(<span class="hljs-string">&quot;pip_test&quot;</span>, <span class="hljs-string">&quot;field&quot;</span>+i, <span class="hljs-string">&quot;value&quot;</span>+i);            &#125;        &#125;<span class="hljs-keyword">catch</span> (Exception e) &#123;            e.printStackTrace();        &#125; <span class="hljs-keyword">finally</span> &#123;            <span class="hljs-keyword">if</span> (jedis != <span class="hljs-keyword">null</span>) &#123;                jedis.close();            &#125;        &#125;        System.out.println(System.currentTimeMillis() - startTime);        startTime = System.currentTimeMillis();        <span class="hljs-comment">// ä½¿ç”¨pipeline</span><span class="hljs-keyword">try</span>&#123;            jedis = jedisPool.getResource();            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">100</span>; i++) &#123;                Pipeline pipelined = jedis.pipelined();                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = i * <span class="hljs-number">100</span> ; j &lt;(i + <span class="hljs-number">1</span>) * <span class="hljs-number">100</span> ; j++) &#123;                    pipelined.hset(<span class="hljs-string">&quot;pip_test&quot;</span>, <span class="hljs-string">&quot;field&quot;</span>+j, <span class="hljs-string">&quot;value&quot;</span>+j);                &#125;                pipelined.syncAndReturnAll();            &#125;        &#125;<span class="hljs-keyword">catch</span> (Exception e) &#123;            e.printStackTrace();        &#125; <span class="hljs-keyword">finally</span> &#123;            <span class="hljs-keyword">if</span> (jedis != <span class="hljs-keyword">null</span>) &#123;                jedis.close();            &#125;        &#125;        System.out.println(System.currentTimeMillis() - startTime);<span class="hljs-comment">// è¾“å‡º</span><span class="hljs-number">12126</span><span class="hljs-number">165</span></code></pre><h4 id="bitmap-ä½å›¾"><a href="#bitmap-ä½å›¾" class="headerlink" title="bitmap(ä½å›¾)"></a>bitmap(ä½å›¾)</h4><p>rediså¯ä»¥ç›´æ¥æ“ä½œä½</p><p><img src="/images/redis/bitmap-big.png"></p><pre><code class="hljs shell">node02:15&gt;set bitkey big&quot;OK&quot;node02:15&gt;get bitkey&quot;big&quot;node02:15&gt;getbit bitkey 0&quot;0&quot;node02:15&gt;getbit bitkey 1&quot;1&quot;node02:15&gt;getbit bitkey 2&quot;1&quot;node02:15&gt;</code></pre><p>æ“ä½œå‘½ä»¤ï¼š</p><pre><code class="hljs shell">setbit key offset value            # ç»™ä½å›¾æŒ‡å®šç´¢å¼•ä½ç½®è®¾ç½®å€¼ï¼Œvalueåªèƒ½æ˜¯0æˆ–1getbit key offset                  # ä½å›¾æŒ‡å®šç´¢å¼•ä½ç½®äºŒè¿›åˆ¶å€¼bitcount key [start end]           # è·å–ä½å›¾æŒ‡å®šèŒƒå›´ï¼ˆstart åˆ° endï¼Œå•ä½ä¸ºå­—èŠ‚ï¼Œä¸æŒ‡å®šçš„è¯è·å–å…¨éƒ¨ï¼‰ä½å€¼ä¸º1çš„ä¸ªæ•°bitop op destkey key [key ...]     # åšå¤šä¸ªbitmapçš„andï¼ˆäº¤é›†ï¼‰ orï¼ˆå¹¶é›†ï¼‰ notï¼ˆéï¼‰ xorï¼ˆå¼‚æˆ–ï¼‰æ“ä½œå¹¶å°†ç»“æœç»“æœä¿å­˜åœ¨destkeyä¸­bitpos key targetBit [start] [end] # è®¡ç®—ä½å›¾æŒ‡å®šèŒƒå›´ï¼ˆstart åˆ° endï¼Œå•ä½ä¸ºå­—èŠ‚ï¼Œä¸æŒ‡å®šçš„è¯è·å–å…¨éƒ¨ï¼‰ç¬¬ä¸€ä¸ªä¾¿å®œé‡å¯¹åº”ä½ç½®çš„å€¼ç­‰äºtargetBitçš„ä½ç½®</code></pre><p><img src="/images/redis/bitc.png"></p><p><img src="/images/redis/bit2.png"></p><h4 id="GEO"><a href="#GEO" class="headerlink" title="GEO"></a>GEO</h4><p>GEO: åœ°ç†ä¿¡æ¯å®šä½ã€‚å­˜å‚¨ç»çº¬åº¦ï¼Œè®¡ç®—è·ç¦»ã€ä½ç½®ç­‰ã€‚</p><p><code>type getKey = zset</code></p><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> å¢åŠ åœ°ç†ä½ç½®ä¿¡æ¯</span>geoadd key longitude latitude member [longitude latitude member ...]node02:15&gt;geoadd cities:locations 116.28 39.55 beijing&quot;1&quot;node02:15&gt;geoadd cities:locations 117.12 39.08 tianjin&quot;1&quot;node02:15&gt;geoadd cities:locations 114.29 38.02 shijiazhuang 118.01 39.38 tangshan&quot;2&quot;<span class="hljs-meta">#</span><span class="bash"> è·å–åœ°ç†ä½ç½®ä¿¡æ¯</span>geopos key member [member ...]node02:15&gt;geopos cities:locations beijing 1)     1)   &quot;116.28000229597091675&quot; 2)   &quot;39.5500007245470826&quot;<span class="hljs-meta">#</span><span class="bash"> è®¡ç®—è·ç¦» unit:m(ç±³),km(åƒç±³),mi(è‹±é‡Œ),ft(å°º)</span>geodist key member1 member2 [unit]node02:15&gt;geodist cities:locations beijing tianjin&quot;89206.0576&quot;</code></pre><p><img src="/images/redis/georadius.png"></p><h3 id="redisçš„æŒä¹…åŒ–"><a href="#redisçš„æŒä¹…åŒ–" class="headerlink" title="redisçš„æŒä¹…åŒ–"></a>redisçš„æŒä¹…åŒ–</h3><p>ç”±äºredisæ˜¯ä¸€ä¸ªå†…å­˜æ•°æ®åº“ï¼Œæ‰€æœ‰çš„æ•°æ®éƒ½æ˜¯ä¿å­˜åœ¨å†…å­˜å½“ä¸­çš„ï¼Œå†…å­˜å½“ä¸­çš„æ•°æ®ææ˜“ä¸¢å¤±ï¼Œæ‰€ä»¥redisçš„æ•°æ®æŒä¹…åŒ–å°±æ˜¾å¾—å°¤ä¸ºé‡è¦ã€‚</p><p>ä»€ä¹ˆæ˜¯æŒä¹…åŒ–å‘¢?<br>åˆ©ç”¨æ°¸ä¹…æ€§å­˜å‚¨ä»‹è´¨å°†æ•°æ®è¿›è¡Œä¿å­˜ï¼Œåœ¨ç‰¹å®šçš„æ—¶é—´å°†ä¿å­˜çš„æ•°æ®è¿›è¡Œæ¢å¤çš„å·¥ä½œæœºåˆ¶ç§°ä¸ºæŒä¹…åŒ–ã€‚</p><p>ä¸ºä»€ä¹ˆè¦è¿›è¡ŒæŒä¹…åŒ–?<br>é˜²æ­¢æ•°æ®çš„æ„å¤–ä¸¢å¤±ï¼Œç¡®ä¿æ•°æ®å®‰å…¨æ€§ã€‚</p><pre><code class="hljs angelscript">æŒä¹…åŒ–è¿‡ç¨‹:<span class="hljs-number">1.</span>å°†å½“å‰æ•°æ®çŠ¶æ€è¿›è¡Œä¿å­˜ï¼Œå¿«ç…§å½¢å¼ï¼Œå­˜å‚¨æ•°æ®ç»“æœï¼Œå­˜å‚¨æ ¼å¼ç®€å•ï¼Œå…³æ³¨ç‚¹åœ¨æ•°æ®<span class="hljs-number">2.</span>å°†æ•°æ®çš„æ“ä½œè¿‡ç¨‹è¿›è¡Œä¿å­˜ï¼Œæ—¥å¿—å½¢å¼ï¼Œå­˜å‚¨æ“ä½œè¿‡ç¨‹ï¼Œå­˜å‚¨æ ¼å¼å¤æ‚ï¼Œå…³æ³¨ç‚¹åœ¨æ•°æ®çš„æ“ä½œè¿‡ç¨‹</code></pre><p><img src="/images/redis/image-20200528230621178.png"></p><h4 id="RDBæŒä¹…åŒ–"><a href="#RDBæŒä¹…åŒ–" class="headerlink" title="RDBæŒä¹…åŒ–"></a>RDBæŒä¹…åŒ–</h4><pre><code class="hljs plain">Redisä¼šå®šæœŸä¿å­˜æ•°æ®å¿«ç…§è‡³ä¸€ä¸ªrbdæ–‡ä»¶ä¸­ï¼Œå¹¶åœ¨å¯åŠ¨æ—¶è‡ªåŠ¨åŠ è½½rdbæ–‡ä»¶ï¼Œæ¢å¤ä¹‹å‰ä¿å­˜çš„æ•°æ®ã€‚</code></pre><h5 id="RDBçš„å¯åŠ¨æ–¹å¼"><a href="#RDBçš„å¯åŠ¨æ–¹å¼" class="headerlink" title="RDBçš„å¯åŠ¨æ–¹å¼"></a>RDBçš„å¯åŠ¨æ–¹å¼</h5><h6 id="save"><a href="#save" class="headerlink" title="save"></a>save</h6><pre><code class="hljs shell">save<span class="hljs-meta">#</span><span class="bash">æ‰‹åŠ¨æ‰§è¡Œä¸€æ¬¡ä¿å­˜æ“ä½œ</span>dbfilename dump-ç«¯å£å·.rdbè¯´æ˜ï¼šè®¾ç½®æœ¬åœ°æ•°æ®åº“æ–‡ä»¶åï¼Œé»˜è®¤å€¼ä¸ºdump.rdbç»éªŒï¼šé€šå¸¸è®¾ç½®ä¸ºdump-ç«¯å£å·.rdbdirè¯´æ˜ï¼šè®¾ç½®å­˜å‚¨.rdbæ–‡ä»¶çš„è·¯å¾„ç»éªŒï¼šé€šå¸¸è®¾ç½®æˆå­˜å‚¨ç©ºé—´è¾ƒå¤§çš„ç›®å½•ä¸­,ç›®å½•åç§°data.rdbcompression yesè¯´æ˜ï¼šè®¾ç½®å­˜å‚¨è‡³æœ¬åœ°æ•°æ®åº“æ—¶æ˜¯å¦å‹ç¼©æ•°æ®ï¼Œé»˜è®¤ä¸ºyesï¼Œé‡‡ç”¨LZF å‹ç¼©ç»éªŒï¼šé€šå¸¸é»˜è®¤ä¸ºå¼€å¯çŠ¶æ€ï¼Œå¦‚æœè®¾ç½®ä¸ºnoï¼Œå¯ä»¥èŠ‚çœCPU è¿è¡Œæ—¶é—´ï¼Œä½†ä¼šä½¿å­˜å‚¨çš„æ–‡ä»¶å˜å¤§ï¼ˆå·¨å¤§ï¼‰rdbchecksum  yesè¯´æ˜ï¼šè®¾ç½®æ˜¯å¦è¿›è¡ŒRDBæ–‡ä»¶æ ¼å¼æ ¡éªŒï¼Œè¯¥æ ¡éªŒè¿‡ç¨‹åœ¨å†™æ–‡ä»¶å’Œè¯»æ–‡ä»¶è¿‡ç¨‹å‡è¿›è¡Œç»éªŒï¼šé€šå¸¸é»˜è®¤ä¸ºå¼€å¯çŠ¶æ€ï¼Œå¦‚æœè®¾ç½®ä¸ºnoï¼Œå¯ä»¥èŠ‚çº¦è¯»å†™æ€§è¿‡ç¨‹çº¦10%æ—¶é—´æ¶ˆè€—ï¼Œä½†æ˜¯å­˜åœ¨ä¸€å®šçš„æ•°æ®æŸåé£é™©<span class="hljs-meta">#</span><span class="bash">æ³¨æ„:</span>saveæŒ‡ä»¤çš„æ‰§è¡Œä¼šé˜»å¡å½“å‰RedisæœåŠ¡å™¨ï¼Œç›´åˆ°å½“å‰RDBè¿‡ç¨‹å®Œæˆä¸ºæ­¢ï¼Œæœ‰å¯èƒ½ä¼šé€ æˆé•¿æ—¶é—´é˜»å¡ï¼Œçº¿ä¸Šç¯å¢ƒä¸å»ºè®®ä½¿ç”¨</code></pre><p>saveçš„å·¥ä½œåŸç†</p><p><img src="/images/redis/image-20200529114206278.png"></p><h6 id="bgsave"><a href="#bgsave" class="headerlink" title="bgsave"></a>bgsave</h6><pre><code class="hljs shell">bgsave<span class="hljs-meta">#</span><span class="bash">æ‰‹åŠ¨å¯åŠ¨åå°ä¿å­˜æ“ä½œï¼Œä½†ä¸æ˜¯ç«‹å³æ‰§è¡Œ</span>dbfilename dump-ç«¯å£å·.rdbdirrdbcompression yesrdbchecksum yesstop-writes-on-bgsave-error yesè¯´æ˜ï¼šåå°å­˜å‚¨è¿‡ç¨‹ä¸­å¦‚æœå‡ºç°é”™è¯¯ç°è±¡ï¼Œæ˜¯å¦åœæ­¢ä¿å­˜æ“ä½œç»éªŒï¼šé€šå¸¸é»˜è®¤ä¸ºå¼€å¯çŠ¶æ€</code></pre><p><img src="/images/redis/image-20200528232539204.png"></p><pre><code class="hljs shell">å¯ä»¥åœ¨é…ç½®æ–‡ä»¶ä¸­é…ç½®Redisè¿›è¡Œå¿«ç…§ä¿å­˜çš„æ—¶æœºï¼š<span class="hljs-meta">#</span><span class="bash">save [seconds] [changes]</span><span class="hljs-meta">#</span><span class="bash">secondï¼šç›‘æ§æ—¶é—´èŒƒå›´</span><span class="hljs-meta">#</span><span class="bash">changesï¼šç›‘æ§keyçš„å˜åŒ–é‡</span><span class="hljs-meta">#</span><span class="bash">æ„ä¸ºåœ¨[seconds]ç§’å†…å¦‚æœå‘ç”Ÿäº†[changes]æ¬¡æ•°æ®ä¿®æ”¹ï¼Œåˆ™è¿›è¡Œä¸€æ¬¡RDBå¿«ç…§ä¿å­˜</span></code></pre><p><img src="/images/redis/save&bgsave.png"></p><h6 id="saveè‡ªåŠ¨ä¿å­˜é…ç½®"><a href="#saveè‡ªåŠ¨ä¿å­˜é…ç½®" class="headerlink" title="saveè‡ªåŠ¨ä¿å­˜é…ç½®"></a>saveè‡ªåŠ¨ä¿å­˜é…ç½®</h6><p>ä¿®æ”¹redisçš„é…ç½®æ–‡ä»¶</p><pre><code class="hljs shell">cd /weitrue/install/redis-6.0.1/cat clusters/redis.confsave 900 1save 300 10save 60 10000<span class="hljs-meta">#</span><span class="bash">save 5 1</span>dbfilename &quot;dump.rdb&quot; dir &quot;/weitrue/install/redis-6.0.1/rdbstro&quot;</code></pre><pre><code class="hljs lsl">å‰ä¸‰ä¸ªé€‰é¡¹æ˜¯redisçš„é…ç½®æ–‡ä»¶é»˜è®¤è‡ªå¸¦çš„å­˜å‚¨æœºåˆ¶ã€‚è¡¨ç¤ºæ¯éš”å¤šå°‘ç§’ï¼Œæœ‰å¤šå°‘ä¸ª<span class="hljs-type">key</span>å‘ç”Ÿå˜åŒ–å°±ç”Ÿæˆä¸€ä»½dump.rdbæ–‡ä»¶ï¼Œä½œä¸ºredisçš„å¿«ç…§æ–‡ä»¶ã€‚ä¾‹å¦‚ï¼šsave  <span class="hljs-number">60</span>  <span class="hljs-number">10000</span> è¡¨ç¤ºåœ¨<span class="hljs-number">60</span>ç§’å†…ï¼Œæœ‰<span class="hljs-number">10000</span>ä¸ª<span class="hljs-type">key</span>å‘ç”Ÿå˜åŒ–ï¼Œå°±ä¼šç”Ÿæˆä¸€ä»½redisçš„å¿«ç…§ç¬¬å››è¡Œè¡¨ç¤ºï¼šæ¯éš”äº”ç§’é’Ÿï¼Œæœ‰ä¸€æ¡æ•°æ®å‘ç”Ÿå˜åŒ–éƒ½éœ€è¦é‡æ–°ç”Ÿæˆredisçš„å¿«ç…§ï¼Œéœ€è¦è‡ªå·±æ ¹æ®å®é™…æƒ…å†µæŒ‡å®šã€‚ç¬¬äº”è¡ŒdbfilenameæŒ‡å®šäº†æŠŠå†…å­˜é‡Œçš„æ•°æ®åº“å†™å…¥æœ¬åœ°æ–‡ä»¶çš„åç§°ï¼Œè¯¥æ–‡ä»¶æ˜¯è¿›è¡Œå‹ç¼©åçš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼›ç¬¬å…­è¡ŒdiræŒ‡å®šäº†RDBäºŒè¿›åˆ¶æ–‡ä»¶å­˜æ”¾ç›®å½• ï¼›</code></pre><p><img src="/images/redis/1589191932950.png"></p><p> ä¿®æ”¹RDBé…ç½®</p><pre><code class="hljs zsh"><span class="hljs-comment"># åœ¨å‘½ä»¤è¡Œé‡Œè¿›è¡Œé…ç½®,æœåŠ¡å™¨é‡å¯æ‰ä¼šç”Ÿæ•ˆ:</span>node01:6379&gt; CONFIG GET save 1) <span class="hljs-string">&quot;save&quot;</span>2) <span class="hljs-string">&quot;900 1 300 10 60 10000&quot;</span>node01:6379&gt; CONFIG SET save <span class="hljs-string">&quot;21600 1000&quot;</span>OK</code></pre><p>æ³¨æ„ï¼š</p><pre><code class="hljs css">é‡æ–°å¯åŠ¨<span class="hljs-selector-tag">redis</span>æœåŠ¡æ¯æ¬¡ç”Ÿæˆæ–°çš„<span class="hljs-selector-tag">dump</span><span class="hljs-selector-class">.rdb</span>éƒ½ä¼šè¦†ç›–æ‰ä¹‹å‰çš„è€çš„å¿«ç…§</code></pre><p>saveé…ç½®åŸç†</p><p><img src="/images/redis/image-20200528234120923.png"></p><pre><code class="hljs shell">saveé…ç½®è¦æ ¹æ®å®é™…ä¸šåŠ¡æƒ…å†µè¿›è¡Œè®¾ç½®ï¼Œé¢‘åº¦è¿‡é«˜æˆ–è¿‡ä½éƒ½ä¼šå‡ºç°æ€§èƒ½é—®é¢˜ï¼Œç»“æœå¯èƒ½æ˜¯ç¾éš¾æ€§çš„saveé…ç½®ä¸­å¯¹äºsecondä¸changesè®¾ç½®é€šå¸¸å…·æœ‰äº’è¡¥å¯¹åº”å…³ç³»ï¼Œå°½é‡ä¸è¦è®¾ç½®æˆåŒ…å«æ€§å…³ç³»saveé…ç½®å¯åŠ¨åæ‰§è¡Œçš„æ˜¯bgsaveæ“ä½œ<span class="hljs-meta">#</span><span class="bash">saveé…ç½®:</span>1.dbfilename dump-ç«¯å£.rdb2.dir3.rdbcompression yes4.rdbchecksum yes</code></pre><h5 id="rdbç‰¹æ®Šå¯åŠ¨å½¢å¼"><a href="#rdbç‰¹æ®Šå¯åŠ¨å½¢å¼" class="headerlink" title="rdbç‰¹æ®Šå¯åŠ¨å½¢å¼"></a>rdbç‰¹æ®Šå¯åŠ¨å½¢å¼</h5><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">å…¨é‡å¤åˆ¶</span>  åœ¨ä¸»ä»å¤åˆ¶ä¸­è¯¦ç»†è®²è§£<span class="hljs-meta">#</span><span class="bash">æœåŠ¡å™¨è¿è¡Œè¿‡ç¨‹ä¸­é‡å¯</span>  debug reload<span class="hljs-meta">#</span><span class="bash">å…³é—­æœåŠ¡å™¨æ—¶æŒ‡å®šä¿å­˜æ•°æ®</span>  shutdown saveé»˜è®¤æƒ…å†µä¸‹æ‰§è¡Œshutdownå‘½ä»¤æ—¶ï¼Œè‡ªåŠ¨æ‰§è¡Œbgsave(å¦‚æœæ²¡æœ‰å¼€å¯AOFæŒä¹…åŒ–åŠŸèƒ½)</code></pre><h5 id="RDBä¼˜ç¼ºç‚¹"><a href="#RDBä¼˜ç¼ºç‚¹" class="headerlink" title="RDBä¼˜ç¼ºç‚¹"></a>RDBä¼˜ç¼ºç‚¹</h5><pre><code class="hljs angelscript">ä¼˜:<span class="hljs-number">1.</span>RDBæ˜¯ä¸€ä¸ªç´§å‡‘å‹ç¼©çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå­˜å‚¨æ•ˆç‡è¾ƒé«˜<span class="hljs-number">2.</span>RDBå†…éƒ¨å­˜å‚¨çš„æ˜¯redisåœ¨æŸä¸ªæ—¶é—´ç‚¹çš„æ•°æ®å¿«ç…§ï¼Œéå¸¸é€‚åˆç”¨äºæ•°æ®å¤‡ä»½ï¼Œå…¨é‡å¤åˆ¶ç­‰åœºæ™¯<span class="hljs-number">3.</span>RDBæ¢å¤æ•°æ®çš„é€Ÿåº¦è¦æ¯”AOFå¿«å¾ˆå¤š<span class="hljs-number">4.</span>åº”ç”¨ï¼šæœåŠ¡å™¨ä¸­æ¯Xå°æ—¶æ‰§è¡Œbgsaveå¤‡ä»½ï¼Œå¹¶å°†RDBæ–‡ä»¶æ‹·è´åˆ°è¿œç¨‹æœºå™¨ä¸­ï¼Œç”¨äºç¾éš¾æ¢å¤ã€‚ç¼º:<span class="hljs-number">1.</span>RDBæ–¹å¼æ— è®ºæ˜¯æ‰§è¡ŒæŒ‡ä»¤è¿˜æ˜¯åˆ©ç”¨é…ç½®ï¼Œæ— æ³•åšåˆ°å®æ—¶æŒä¹…åŒ–ï¼Œå…·æœ‰è¾ƒå¤§çš„å¯èƒ½æ€§ä¸¢å¤±æ•°æ®<span class="hljs-number">2.</span>bgsaveæŒ‡ä»¤æ¯æ¬¡è¿è¡Œè¦æ‰§è¡Œforkæ“ä½œåˆ›å»ºå­è¿›ç¨‹ï¼Œè¦ç‰ºç‰²æ‰ä¸€äº›æ€§èƒ½<span class="hljs-number">3.</span>Redisçš„ä¼—å¤šç‰ˆæœ¬ä¸­æœªè¿›è¡ŒRDBæ–‡ä»¶æ ¼å¼çš„ç‰ˆæœ¬ç»Ÿä¸€ï¼Œæœ‰å¯èƒ½å‡ºç°å„ç‰ˆæœ¬æœåŠ¡ä¹‹é—´æ•°æ®æ ¼å¼æ— æ³•å…¼å®¹ç°è±¡</code></pre><h4 id="AOFæŒä¹…åŒ–"><a href="#AOFæŒä¹…åŒ–" class="headerlink" title="AOFæŒä¹…åŒ–"></a>AOFæŒä¹…åŒ–</h4><pre><code class="hljs erlang">   ä»¥ç‹¬ç«‹æ—¥å¿—çš„æ–¹å¼è®°å½•æ¯æ¬¡å†™å‘½ä»¤ï¼Œé‡å¯æ—¶å†é‡æ–°æ‰§è¡ŒAOFæ–‡ä»¶ä¸­å‘½ä»¤è¾¾åˆ°æ¢å¤æ•°æ®çš„ç›®çš„ã€‚ä¸RDBç›¸æ¯”å¯ä»¥ç®€å•æè¿°ä¸ºæ”¹è®°å½•æ•°æ®ä¸ºè®°å½•æ•°æ®äº§ç”Ÿçš„è¿‡ç¨‹.AOFçš„ä¸»è¦ä½œç”¨æ˜¯è§£å†³äº†æ•°æ®æŒä¹…åŒ–çš„å®æ—¶æ€§ï¼Œç›®å‰å·²ç»æ˜¯RedisæŒä¹…åŒ–çš„ä¸»æµæ–¹å¼</code></pre><h5 id="AOFçš„è¯»å†™åŸç†"><a href="#AOFçš„è¯»å†™åŸç†" class="headerlink" title="AOFçš„è¯»å†™åŸç†"></a>AOFçš„è¯»å†™åŸç†</h5><p><img src="/images/redis/image-20200530231955448.png"></p><h5 id="AOFå†™æ•°æ®ä¸‰ç§ç­–ç•¥"><a href="#AOFå†™æ•°æ®ä¸‰ç§ç­–ç•¥" class="headerlink" title="AOFå†™æ•°æ®ä¸‰ç§ç­–ç•¥"></a>AOFå†™æ•°æ®ä¸‰ç§ç­–ç•¥</h5><pre><code class="hljs vala"><span class="hljs-meta"># always(æ¯æ¬¡ï¼‰</span>  æ¯æ¬¡å†™å…¥æ“ä½œå‡åŒæ­¥åˆ°AOFæ–‡ä»¶ä¸­ï¼Œæ•°æ®é›¶è¯¯å·®ï¼Œæ€§èƒ½è¾ƒä½,ä¸å»ºè®®ä½¿ç”¨<span class="hljs-meta"># everysecï¼ˆæ¯ç§’ï¼‰</span>  æ¯ç§’å°†ç¼“å†²åŒºä¸­çš„æŒ‡ä»¤åŒæ­¥åˆ°AOFæ–‡ä»¶ä¸­ï¼Œæ•°æ®å‡†ç¡®æ€§è¾ƒé«˜ï¼Œæ€§èƒ½è¾ƒé«˜,å»ºè®®ä½¿ç”¨ï¼Œä¹Ÿæ˜¯é»˜è®¤é…ç½®   åœ¨ç³»ç»Ÿçªç„¶å®•æœºçš„æƒ…å†µä¸‹ä¸¢å¤±<span class="hljs-number">1</span>ç§’å†…çš„æ•°æ®<span class="hljs-meta"># noï¼ˆç³»ç»Ÿæ§åˆ¶ï¼‰</span>    ç”±æ“ä½œç³»ç»Ÿæ§åˆ¶æ¯æ¬¡åŒæ­¥åˆ°AOFæ–‡ä»¶çš„å‘¨æœŸï¼Œæ•´ä½“è¿‡ç¨‹ä¸å¯æ§</code></pre><h5 id="AOFåŠŸèƒ½å¼€å¯"><a href="#AOFåŠŸèƒ½å¼€å¯" class="headerlink" title="AOFåŠŸèƒ½å¼€å¯"></a>AOFåŠŸèƒ½å¼€å¯</h5><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">é…ç½®</span>appendonly yes|no                # æ˜¯å¦å¼€å¯AOFæŒä¹…åŒ–åŠŸèƒ½ï¼Œé»˜è®¤ä¸ºä¸å¼€å¯çŠ¶æ€appendfsync  always|everysec|no  # AOFå†™æ•°æ®ç­–ç•¥</code></pre><h5 id="AOFç›¸å…³é…ç½®"><a href="#AOFç›¸å…³é…ç½®" class="headerlink" title="AOFç›¸å…³é…ç½®"></a>AOFç›¸å…³é…ç½®</h5><pre><code class="hljs shell">cd /weitrue/install/redis-6.0.1vim redis.confappendonly yesappendfsync everysec    # appendfsync always / appendfsync noappendfilename filename # AOFæŒä¹…åŒ–æ–‡ä»¶åï¼Œé»˜è®¤æ–‡ä»¶åæœªappendonly.aofï¼Œå»ºè®®é…ç½®ä¸ºappendonly-ç«¯å£å·.aofdir                     # AOFæŒä¹…åŒ–æ–‡ä»¶ä¿å­˜è·¯å¾„ï¼Œä¸RDBæŒä¹…åŒ–æ–‡ä»¶ä¿æŒä¸€è‡´å³å¯</code></pre><h5 id="AOFé‡å†™"><a href="#AOFé‡å†™" class="headerlink" title="AOFé‡å†™"></a>AOFé‡å†™</h5><pre><code class="hljs shell">éšç€å‘½ä»¤ä¸æ–­å†™å…¥AOFï¼Œæ–‡ä»¶ä¼šè¶Šæ¥è¶Šå¤§ï¼Œä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒRediså¼•å…¥äº†AOFé‡å†™æœºåˆ¶å‹ç¼©æ–‡ä»¶ä½“ç§¯ã€‚AOFæ–‡ä»¶é‡å†™æ˜¯å°†Redisè¿›ç¨‹å†…çš„æ•°æ®è½¬åŒ–ä¸ºå†™å‘½ä»¤åŒæ­¥åˆ°æ–°AOFæ–‡ä»¶çš„è¿‡ç¨‹ã€‚ç®€å•è¯´å°±æ˜¯å°†å¯¹åŒä¸€ä¸ªæ•°æ®çš„è‹¥å¹²æ¡å‘½ä»¤æ‰§è¡Œç»“æœè½¬åŒ–æˆæœ€ç»ˆç»“æœæ•°æ®å¯¹åº”çš„æŒ‡ä»¤è¿›è¡Œè®°å½•ã€‚<span class="hljs-meta">#</span><span class="bash">AOFé‡å†™ä½œç”¨</span>é™ä½ç£ç›˜å ç”¨é‡ï¼Œæé«˜ç£ç›˜åˆ©ç”¨ç‡æé«˜æŒä¹…åŒ–æ•ˆç‡ï¼Œé™ä½æŒä¹…åŒ–å†™æ—¶é—´ï¼Œæé«˜IOæ€§èƒ½é™ä½æ•°æ®æ¢å¤ç”¨æ—¶é—´ï¼Œæé«˜æ•°æ®æ¢å¤æ•ˆç‡ã€‚<span class="hljs-meta">#</span><span class="bash">AOFé‡å†™è§„åˆ™</span>  1.è¿›ç¨‹å†…å·²è¶…æ—¶çš„æ•°æ®ä¸å†å†™å…¥æ–‡ä»¶  2.å¿½ç•¥æ— æ•ˆæŒ‡ä»¤ï¼Œé‡å†™æ—¶ä½¿ç”¨è¿›ç¨‹å†…æ•°æ®ç›´æ¥ç”Ÿæˆï¼Œè¿™æ ·æ–°çš„AOFæ–‡ä»¶åªä¿ç•™æœ€ç»ˆæ•°æ®çš„å†™å…¥å‘½ä»¤     å¦‚del key1ã€hdelkey2ã€sremkey3ã€set key4 111ã€set key4 222ç­‰  3.å¯¹åŒä¸€æ•°æ®çš„å¤šæ¡å†™å‘½ä»¤åˆå¹¶ä¸ºä¸€æ¡å‘½ä»¤    å¦‚lpushlist1 aã€lpushlist1 bã€lpushlist1 c å¯ä»¥è½¬åŒ–ä¸ºï¼šlpushlist1 a b cã€‚    ä¸ºé˜²æ­¢æ•°æ®é‡è¿‡å¤§é€ æˆå®¢æˆ·ç«¯ç¼“å†²åŒºæº¢å‡ºï¼Œå¯¹listã€setã€hashã€zsetç­‰ç±»å‹ï¼Œæ¯æ¡æŒ‡ä»¤æœ€å¤šå†™å…¥64ä¸ªå…ƒç´ </code></pre><h6 id="AOFé‡å†™æ–¹å¼"><a href="#AOFé‡å†™æ–¹å¼" class="headerlink" title="AOFé‡å†™æ–¹å¼"></a>AOFé‡å†™æ–¹å¼</h6><ul><li>æ‰‹åŠ¨é‡å†™</li></ul><pre><code class="hljs shell">bgrewriteaof</code></pre><ul><li>è‡ªåŠ¨é‡å†™</li></ul><pre><code class="hljs shell">auto-aof-rewrite-min-size sizeauto-aof-rewrite-percentage percentage</code></pre><h6 id="AOFè‡ªåŠ¨é‡å†™æ–¹å¼"><a href="#AOFè‡ªåŠ¨é‡å†™æ–¹å¼" class="headerlink" title="AOFè‡ªåŠ¨é‡å†™æ–¹å¼"></a>AOFè‡ªåŠ¨é‡å†™æ–¹å¼</h6><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> è‡ªåŠ¨é‡å†™è§¦å‘æ¡ä»¶è®¾ç½®</span>auto-aof-rewrite-min-size ï¼ˆè¾¾åˆ°æŸä¸€å†…å­˜å¼€å§‹é‡å†™ï¼‰sizeauto-aof-rewrite-percentage percent   ï¼ˆè¾¾åˆ°æŸä¸€%ï¼‰<span class="hljs-meta">#</span><span class="bash"> è‡ªåŠ¨é‡å†™è§¦å‘æ¯”å¯¹å‚æ•°ï¼ˆè¿è¡ŒæŒ‡ä»¤info Persistenceè·å–å…·ä½“ä¿¡æ¯) </span>aof_current_size  ï¼ˆè®¾ç½®å†…å­˜ï¼‰aof_base_size      ï¼ˆåŸºç¡€å°ºå¯¸ï¼‰</code></pre><h5 id="AOFå·¥ä½œæµç¨‹"><a href="#AOFå·¥ä½œæµç¨‹" class="headerlink" title="AOFå·¥ä½œæµç¨‹"></a>AOFå·¥ä½œæµç¨‹</h5><p><img src="/images/redis/image-20200531004807324.png"></p><h5 id="AOFé‡å†™æµç¨‹"><a href="#AOFé‡å†™æµç¨‹" class="headerlink" title="AOFé‡å†™æµç¨‹"></a>AOFé‡å†™æµç¨‹</h5><p><img src="/images/redis/image-20200531004404062.png"></p><h5 id="AOFä¼˜ç‚¹ï¼š"><a href="#AOFä¼˜ç‚¹ï¼š" class="headerlink" title="AOFä¼˜ç‚¹ï¼š"></a>AOFä¼˜ç‚¹ï¼š</h5><pre><code class="hljs angelscript"><span class="hljs-number">1</span>ã€ æœ€å®‰å…¨ï¼Œåœ¨å¯ç”¨appendfsync alwaysæ—¶ï¼Œä»»ä½•å·²å†™å…¥çš„æ•°æ®éƒ½ä¸ä¼šä¸¢å¤±ï¼Œä½¿ç”¨åœ¨å¯ç”¨appendfsync everysecä¹Ÿè‡³å¤šåªä¼šä¸¢å¤±<span class="hljs-number">1</span>ç§’çš„æ•°æ®<span class="hljs-number">2</span>ã€ AOFæ–‡ä»¶åœ¨å‘ç”Ÿæ–­ç”µç­‰é—®é¢˜æ—¶ä¹Ÿä¸ä¼šæŸåï¼Œå³ä½¿å‡ºç°äº†æŸæ¡æ—¥å¿—åªå†™å…¥äº†ä¸€åŠçš„æƒ…å†µï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨redis-check-aofå·¥å…·è½»æ¾ä¿®å¤ã€‚<span class="hljs-number">3</span>ã€ AOFæ–‡ä»¶æ˜“è¯»ï¼Œå¯ä¿®æ”¹ï¼Œåœ¨è¿›è¡Œäº†æŸäº›é”™è¯¯çš„æ•°æ®æ¸…é™¤æ“ä½œåï¼Œåªè¦AOFæ–‡ä»¶æ²¡æœ‰rewriteï¼Œå°±å¯ä»¥æŠŠAOFæ–‡ä»¶å¤‡ä»½å‡ºæ¥ï¼ŒæŠŠé”™è¯¯çš„å‘½ä»¤åˆ é™¤ï¼Œç„¶åæ¢å¤æ•°æ®ã€‚</code></pre><h5 id="AOFçš„ç¼ºç‚¹ï¼š"><a href="#AOFçš„ç¼ºç‚¹ï¼š" class="headerlink" title="AOFçš„ç¼ºç‚¹ï¼š"></a>AOFçš„ç¼ºç‚¹ï¼š</h5><pre><code class="hljs angelscript"><span class="hljs-number">1</span>ã€ AOFæ–‡ä»¶é€šå¸¸æ¯”RDBæ–‡ä»¶æ›´å¤§<span class="hljs-number">2</span>ã€ æ€§èƒ½æ¶ˆè€—æ¯”RDBé«˜<span class="hljs-number">3</span>ã€ æ•°æ®æ¢å¤é€Ÿåº¦æ¯”RDBæ…¢Redisçš„æ•°æ®æŒä¹…åŒ–å·¥ä½œæœ¬èº«å°±ä¼šå¸¦æ¥å»¶è¿Ÿï¼Œéœ€è¦æ ¹æ®æ•°æ®çš„å®‰å…¨çº§åˆ«å’Œæ€§èƒ½è¦æ±‚åˆ¶å®šåˆç†çš„æŒä¹…åŒ–ç­–ç•¥ï¼šAOF + fsync alwaysçš„è®¾ç½®è™½ç„¶èƒ½å¤Ÿç»å¯¹ç¡®ä¿æ•°æ®å®‰å…¨ï¼Œä½†æ¯ä¸ªæ“ä½œéƒ½ä¼šè§¦å‘ä¸€æ¬¡fsyncï¼Œä¼šå¯¹Redisçš„æ€§èƒ½æœ‰æ¯”è¾ƒæ˜æ˜¾çš„å½±å“AOF + fsync every secondæ˜¯æ¯”è¾ƒå¥½çš„æŠ˜ä¸­æ–¹æ¡ˆï¼Œæ¯ç§’fsyncä¸€æ¬¡AOF + fsync neverä¼šæä¾›AOFæŒä¹…åŒ–æ–¹æ¡ˆä¸‹çš„æœ€ä¼˜æ€§èƒ½ä½¿ç”¨RDBæŒä¹…åŒ–é€šå¸¸ä¼šæä¾›æ¯”ä½¿ç”¨AOFæ›´é«˜çš„æ€§èƒ½ï¼Œä½†éœ€è¦æ³¨æ„RDBçš„ç­–ç•¥é…ç½®æ¯ä¸€æ¬¡RDBå¿«ç…§å’ŒAOF Rewriteéƒ½éœ€è¦Redisä¸»è¿›ç¨‹è¿›è¡Œforkæ“ä½œã€‚forkæ“ä½œæœ¬èº«å¯èƒ½ä¼šäº§ç”Ÿè¾ƒé«˜çš„è€—æ—¶ï¼Œä¸CPUå’ŒRediså ç”¨çš„å†…å­˜å¤§å°æœ‰å…³ã€‚æ ¹æ®å…·ä½“çš„æƒ…å†µåˆç†é…ç½®RDBå¿«ç…§å’ŒAOF Rewriteæ—¶æœºï¼Œé¿å…è¿‡äºé¢‘ç¹çš„forkå¸¦æ¥çš„å»¶è¿ŸRedisåœ¨forkå­è¿›ç¨‹æ—¶éœ€è¦å°†å†…å­˜åˆ†é¡µè¡¨æ‹·è´è‡³å­è¿›ç¨‹ï¼Œä»¥å ç”¨äº†<span class="hljs-number">24</span>GBå†…å­˜çš„Rediså®ä¾‹ä¸ºä¾‹ï¼Œå…±éœ€è¦æ‹·è´<span class="hljs-number">24</span>GB / <span class="hljs-number">4</span>kB * <span class="hljs-number">8</span> = <span class="hljs-number">48</span>MBçš„æ•°æ®ã€‚åœ¨ä½¿ç”¨å•Xeon <span class="hljs-number">2.27</span>Ghzçš„ç‰©ç†æœºä¸Šï¼Œè¿™ä¸€forkæ“ä½œè€—æ—¶<span class="hljs-number">216</span>msã€‚</code></pre><h4 id="RDBä¸AOF"><a href="#RDBä¸AOF" class="headerlink" title="RDBä¸AOF"></a>RDBä¸AOF</h4><p><img src="/images/redis/rdb&aof.png"></p><h4 id="fork"><a href="#fork" class="headerlink" title="fork"></a>fork</h4><ul><li><p>åŒæ­¥æ“ä½œ</p></li><li><p>è™½ç„¶forkåŒæ­¥æ“ä½œæ˜¯éå¸¸å¿«çš„ï¼Œä½†æ˜¯å¦‚æœéœ€è¦åŒæ­¥çš„æ•°æ®é‡è¿‡å¤§(æ¯”å¦‚è¶…è¿‡20G)ï¼Œforkå°±ä¼šé˜»å¡redisä¸»è¿›ç¨‹ã€‚</p></li><li><p>ä¸å†…å­˜é‡æ¯æ¯ç›¸å…³</p></li><li><p>å†…å­˜è¶Šå¤§ï¼ŒforkåŒæ­¥æ•°æ®è€—æ—¶è¶Šé•¿ï¼Œå½“ç„¶ä¹Ÿè·ŸæœåŠ¡å™¨æœ‰å…³ï¼ŒæœåŠ¡å™¨æœ‰ç‰©ç†æœºï¼Œä¹Ÿæœ‰è™šæ‹Ÿæœºã€‚</p></li><li><p>info:latest_fork_usec</p><ul><li>ä½¿ç”¨æ­¤å‘½ä»¤å¯ä»¥æŸ¥çœ‹æŒä¹…åŒ–èŠ±è´¹çš„æ—¶é—´ï¼Œå¦‚æœæŒä¹…åŒ–æ—¶é—´è¿‡é•¿ï¼Œå°±ä¼šé€ æˆå¡é¡¿ã€‚</li><li>ä¾‹å¦‚ï¼šå¦‚æœredisæ­¤æ—¶QPSä¸Šä¸‡ï¼Œæ­¤æ—¶redisæ­£åœ¨æŒä¹…åŒ–ï¼Œè€Œä¸”æŒä¹…åŒ–æ—¶é—´æ¯”è¾ƒé•¿ï¼ˆ1sæˆ–è€…10å‡ ç§’ï¼‰ï¼Œæ­¤æ—¶å°±ä¼šä¸¥é‡é˜»å¡redisã€‚</li></ul><pre><code class="hljs shell">node02:0&gt;info Stats&quot;# Statstotal_connections_received:5total_commands_processed:13instantaneous_ops_per_sec:0total_net_input_bytes:346total_net_output_bytes:7191instantaneous_input_kbps:0.00instantaneous_output_kbps:0.00rejected_connections:0sync_full:0sync_partial_ok:0sync_partial_err:0expired_keys:0evicted_keys:0keyspace_hits:0keyspace_misses:0pubsub_channels:0pubsub_patterns:0latest_fork_usec:0   # &lt;-------migrate_cached_sockets:0&quot;node02:0&gt;info&quot;# Serverredis_version:3.2.8redis_git_sha1:00000000redis_git_dirty:0redis_build_id:3a7af52404e97f38redis_mode:standaloneos:Linux 3.10.0-957.el7.x86_64 x86_64arch_bits:64multiplexing_api:epollgcc_version:4.8.5process_id:26189run_id:2cf1aa7e1893ae1b5427ae9e1963e30e10716673tcp_port:6379uptime_in_seconds:122uptime_in_days:0hz:10lru_clock:6488420executable:/weitrue/install/redis-6.0.1/src/redis-serverconfig_file:/weitrue/install/redis-6.0.1/redis.conf<span class="hljs-meta">#</span><span class="bash"> Clients</span>connected_clients:2client_longest_output_list:0client_biggest_input_buf:0blocked_clients:0<span class="hljs-meta">#</span><span class="bash"> Memory</span>used_memory:2168928used_memory_human:2.07Mused_memory_rss:4009984used_memory_rss_human:3.82Mused_memory_peak:2201664used_memory_peak_human:2.10Mtotal_system_memory:1907941376total_system_memory_human:1.78Gused_memory_lua:37888used_memory_lua_human:37.00Kmaxmemory:0maxmemory_human:0Bmaxmemory_policy:noevictionmem_fragmentation_ratio:1.85mem_allocator:libc<span class="hljs-meta">#</span><span class="bash"> Persistence</span>loading:0rdb_changes_since_last_save:0rdb_bgsave_in_progress:0rdb_last_save_time:1617101034rdb_last_bgsave_status:okrdb_last_bgsave_time_sec:-1rdb_current_bgsave_time_sec:-1aof_enabled:0aof_rewrite_in_progress:0aof_rewrite_scheduled:0aof_last_rewrite_time_sec:-1aof_current_rewrite_time_sec:-1aof_last_bgrewrite_status:okaof_last_write_status:ok<span class="hljs-meta">#</span><span class="bash"> Stats</span>total_connections_received:5total_commands_processed:11instantaneous_ops_per_sec:0total_net_input_bytes:298total_net_output_bytes:4947instantaneous_input_kbps:0.00instantaneous_output_kbps:0.00rejected_connections:0sync_full:0sync_partial_ok:0sync_partial_err:0expired_keys:0evicted_keys:0keyspace_hits:0keyspace_misses:0pubsub_channels:0pubsub_patterns:0latest_fork_usec:0migrate_cached_sockets:0<span class="hljs-meta">#</span><span class="bash"> Replication</span>role:masterconnected_slaves:0master_repl_offset:0repl_backlog_active:0repl_backlog_size:1048576repl_backlog_first_byte_offset:0repl_backlog_histlen:0<span class="hljs-meta">#</span><span class="bash"> CPU</span>used_cpu_sys:0.18used_cpu_user:0.11used_cpu_sys_children:0.00used_cpu_user_children:0.00<span class="hljs-meta">#</span><span class="bash"> Cluster</span>cluster_enabled:0<span class="hljs-meta">#</span><span class="bash"> Keyspace</span>db0:keys=79,expires=0,avg_ttl=0db15:keys=12,expires=0,avg_ttl=0&quot;</code></pre></li></ul><h5 id="æ”¹å–„fork"><a href="#æ”¹å–„fork" class="headerlink" title="æ”¹å–„fork"></a>æ”¹å–„fork</h5><p><img src="/images/redis/improve-fork.png"></p><h3 id="Redis-å‘å¸ƒè®¢é˜…"><a href="#Redis-å‘å¸ƒè®¢é˜…" class="headerlink" title="Redis å‘å¸ƒè®¢é˜…"></a>Redis å‘å¸ƒè®¢é˜…</h3><p><img src="/images/redis/pub-sub.png"></p><pre><code class="hljs angelscript">Redis çš„å‘å¸ƒä¸è®¢é˜…åŠŸèƒ½å¯ä»¥è®©ç”¨æˆ·å°†æ¶ˆæ¯åŒæ—¶å‘é€ç»™å¤šä¸ªå®¢æˆ·ç«¯ã€‚ è¿™ä¸ªåŠŸèƒ½ç”±å‡ ä¸ªä¸åŒçš„è§’è‰² åä½œç»„æˆï¼š <span class="hljs-number">1.</span>å‘å¸ƒè€…ï¼ˆpublisherï¼‰ï¼šå‘å¸ƒæ¶ˆæ¯çš„å®¢æˆ·ç«¯ã€‚ <span class="hljs-number">2.</span>é¢‘é“ï¼ˆchannelï¼‰ï¼šæ„å»ºåœ¨æœåŠ¡å™¨å†…éƒ¨ï¼Œè´Ÿè´£æ¥æ”¶å‘å¸ƒè€…å‘é€çš„æ¶ˆæ¯ï¼Œå¹¶å°†æ¶ˆæ¯è½¬å‘ç»™é¢‘é“çš„è®¢é˜…è€…ã€‚ <span class="hljs-number">3.</span>æ¨¡å¼ï¼ˆpatternï¼‰ï¼šæ„å»ºåœ¨æœåŠ¡å™¨å†…éƒ¨ï¼Œè´Ÿè´£å¯¹é¢‘é“è¿›è¡ŒåŒ¹é…ï¼Œå½“è¢«åŒ¹é…çš„é¢‘é“æ¥åˆ°æ¶ˆæ¯æ—¶ï¼Œæ¨¡å¼ä¹Ÿä¼š å°†æ¶ˆæ¯è½¬å‘ç»™æ¨¡å¼çš„è®¢é˜…è€…ã€‚ <span class="hljs-number">4.</span>è®¢é˜…è€…ï¼ˆsubscriberï¼‰ï¼šé€šè¿‡è®¢é˜…é¢‘é“æˆ–è€…æ¨¡å¼æ¥è·å–æ¶ˆæ¯çš„å®¢æˆ·ç«¯ã€‚æ¯ä¸ªé¢‘é“æˆ–è€…æ¨¡å¼éƒ½å¯ä»¥æœ‰ä»» æ„å¤šä¸ªè®¢é˜…è€…(ä»…èƒ½è·å¾—å¼€å§‹è®¢é˜…ä»¥åçš„æ¶ˆæ¯ï¼Œè®¢é˜…å‰çš„æ¶ˆæ¯æ— æ³•è·å¾—)ã€‚</code></pre><h5 id="è®¢é˜…å‘½ä»¤"><a href="#è®¢é˜…å‘½ä»¤" class="headerlink" title="è®¢é˜…å‘½ä»¤"></a>è®¢é˜…å‘½ä»¤</h5> <pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">è®¢é˜…é¢‘é“</span>SUBSCRIBE channel [channel ...]è®¢é˜…ç»™å®šçš„ä¸€ä¸ªæˆ–å¤šä¸ªé¢‘é“ã€‚node02:15&gt;SUBSCRIBE woSwitch to Pub/Sub mode. Close console tab to stop listen for messages. 1)  &quot;subscribe&quot; 2)  &quot;wo&quot; 3)  &quot;1&quot; 1)  &quot;message&quot; 2)  &quot;wo&quot; 3)  &quot;hello&quot; 1)  &quot;message&quot; 2)  &quot;wo&quot; 3)  &quot;test&quot;</code></pre><h6 id="æ¶ˆæ¯å‘å¸ƒ"><a href="#æ¶ˆæ¯å‘å¸ƒ" class="headerlink" title="æ¶ˆæ¯å‘å¸ƒ"></a>æ¶ˆæ¯å‘å¸ƒ</h6><pre><code class="hljs shell">node02:15&gt;PUBLISH wo hello&quot;1&quot;</code></pre><h6 id="è®¢é˜…å¤šä¸ª"><a href="#è®¢é˜…å¤šä¸ª" class="headerlink" title="è®¢é˜…å¤šä¸ª"></a>è®¢é˜…å¤šä¸ª</h6><pre><code class="hljs shell">é€šé…ç¬¦*<span class="hljs-meta">redis&gt;</span><span class="bash"> PSUBSCRIBE new*</span></code></pre><h6 id="æ¶ˆæ¯å‘å¸ƒ-1"><a href="#æ¶ˆæ¯å‘å¸ƒ-1" class="headerlink" title="æ¶ˆæ¯å‘å¸ƒ"></a>æ¶ˆæ¯å‘å¸ƒ</h6><pre><code class="hljs shell"><span class="hljs-meta">redis&gt;</span><span class="bash">PUBLISH new1 hello</span></code></pre><h6 id="åˆ—å‡ºæŒ‡å®šé¢‘é“è®¢é˜…ç€æ•°é‡"><a href="#åˆ—å‡ºæŒ‡å®šé¢‘é“è®¢é˜…ç€æ•°é‡" class="headerlink" title="åˆ—å‡ºæŒ‡å®šé¢‘é“è®¢é˜…ç€æ•°é‡"></a>åˆ—å‡ºæŒ‡å®šé¢‘é“è®¢é˜…ç€æ•°é‡</h6><pre><code class="hljs shell"><span class="hljs-meta">redis&gt;</span><span class="bash"> PUBSUB numsub [channel...]</span></code></pre><h3 id="Redis-äº‹åŠ¡"><a href="#Redis-äº‹åŠ¡" class="headerlink" title="Redis äº‹åŠ¡"></a>Redis äº‹åŠ¡</h3><pre><code class="hljs nginx"><span class="hljs-attribute">Redis</span> çš„äº‹åŠ¡åŠŸèƒ½å…è®¸ç”¨æˆ·å°†å¤šä¸ªå‘½ä»¤åŒ…è£¹èµ·æ¥ï¼Œç„¶åä¸€æ¬¡æ€§åœ°ã€æŒ‰ é¡ºåºåœ°æ‰§è¡Œè¢«åŒ…è£¹çš„æ‰€æœ‰å‘½ä»¤ã€‚åœ¨äº‹åŠ¡æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ï¼ŒæœåŠ¡å™¨ä¸ä¼šä¸­æ–­äº‹åŠ¡è€Œæ”¹å»æ‰§è¡Œå…¶ä»–å‘½ä»¤è¯·æ±‚ï¼Œåªæœ‰åœ¨äº‹åŠ¡åŒ…è£¹çš„æ‰€æœ‰å‘½ä»¤éƒ½è¢«æ‰§è¡Œå®Œæ¯•ä¹‹åï¼ŒæœåŠ¡å™¨æ‰ä¼šå»å¤„ç†å…¶ä»–å‘½ä»¤è¯·æ±‚ã€‚</code></pre><h4 id="äº‹åŠ¡å‘½ä»¤"><a href="#äº‹åŠ¡å‘½ä»¤" class="headerlink" title="äº‹åŠ¡å‘½ä»¤"></a>äº‹åŠ¡å‘½ä»¤</h4><pre><code class="hljs plain">ä¸ºäº†é¿å…é‡ä¸Šä»¥ä¸Šæ‰€è¯´çš„æƒ…å†µï¼Œ æˆ‘ä»¬éœ€è¦ç”¨åˆ° Redis çš„äº‹åŠ¡åŠŸèƒ½ï¼Œ é€šè¿‡äº‹åŠ¡ï¼Œ æˆ‘ä»¬å¯ä»¥è®© Redis ä¸€æ¬¡æ€§åœ°æ‰§è¡Œå¤šä¸ªå‘½ä»¤ï¼Œ å¹¶ä¸”ç¡®ä¿äº‹åŠ¡ä¸­çš„å‘½ä»¤è¦ä¹ˆå°±å…¨éƒ¨éƒ½ æ‰§è¡Œï¼Œè¦ä¹ˆå°±ä¸€ä¸ªéƒ½ä¸æ‰§è¡Œã€‚</code></pre><p><strong>äº‹åŠ¡å‘½ä»¤</strong>ï¼š                                                     ä½œç”¨ï¼š </p><p>MULTI                                                             å¼€å§‹ä¸€ä¸ªæ–°çš„äº‹åŠ¡ã€‚    </p><p>DISCARD                                                         æ”¾å¼ƒäº‹åŠ¡ã€‚</p><p>EXEC                                                                 æ‰§è¡Œäº‹åŠ¡ä¸­çš„æ‰€æœ‰å‘½ä»¤ã€‚</p><p><strong>å¼€å§‹äº‹åŠ¡</strong></p><pre><code class="hljs shell">MULTIå¼€å§‹ä¸€ä¸ªäº‹åŠ¡ã€‚ åœ¨è¿™ä¸ªå‘½ä»¤æ‰§è¡Œä¹‹åï¼Œå®¢æˆ·ç«¯å‘é€çš„æ‰€æœ‰é’ˆå¯¹æ•°æ®åº“æˆ–è€…æ•°æ®åº“é”®çš„å‘½ä»¤éƒ½ä¸ä¼šè¢«ç«‹å³æ‰§è¡Œï¼Œè€Œæ˜¯è¢«æ”¾å…¥åˆ°ä¸€ä¸ªäº‹åŠ¡é˜Ÿåˆ—é‡Œé¢ï¼Œå¹¶è¿”å› QUEUED è¡¨ç¤ºå‘½ä»¤å·²å…¥é˜Ÿã€‚<span class="hljs-meta">redis&gt;</span><span class="bash"> MULTI <span class="hljs-comment"># å¼€å§‹ä¸€ä¸ªäº‹åŠ¡</span></span>OK<span class="hljs-meta">redis&gt;</span><span class="bash"> SET msg <span class="hljs-string">&quot;hello world&quot;</span> <span class="hljs-comment"># å°†è¿™ä¸ª SET å‘½ä»¤æ”¾å…¥äº‹åŠ¡é˜Ÿåˆ—</span></span>QUEUED</code></pre><p><strong>æ”¾å¼ƒäº‹åŠ¡ï¼š</strong></p><pre><code class="hljs shell">DISCARDå–æ¶ˆäº‹åŠ¡ï¼Œæ”¾å¼ƒæ‰§è¡Œäº‹åŠ¡é˜Ÿåˆ—ä¸­çš„æ‰€æœ‰å‘½ä»¤ã€‚<span class="hljs-meta"> redis&gt;</span><span class="bash"> MULTI</span> OK<span class="hljs-meta"> redis&gt;</span><span class="bash"> SET msg <span class="hljs-string">&quot;hello world&quot;</span></span> QUEUED<span class="hljs-meta"> redis&gt;</span><span class="bash"> DISCARD <span class="hljs-comment"># äº‹åŠ¡å·²è¢«å–æ¶ˆ</span></span> OK</code></pre><p><strong>æ‰§è¡Œäº‹åŠ¡</strong></p><pre><code class="hljs shell">EXECæŒ‰ç…§å‘½ä»¤è¢«å…¥é˜Ÿåˆ°äº‹åŠ¡é˜Ÿåˆ—ä¸­çš„é¡ºåºï¼Œæ‰§è¡Œäº‹åŠ¡é˜Ÿåˆ—ä¸­çš„æ‰€æœ‰å‘½ä»¤ã€‚<span class="hljs-meta">redis&gt;</span><span class="bash"> MULTI </span>OK<span class="hljs-meta">redis&gt;</span><span class="bash"> SET msg <span class="hljs-string">&quot;hello world&quot;</span></span>QUEUED<span class="hljs-meta">redis&gt;</span><span class="bash"> SET msg <span class="hljs-string">&quot;hello world&quot;</span></span>QUEUED<span class="hljs-meta">redis&gt;</span><span class="bash"> EXEC</span></code></pre><h3 id="Redis-å®‰å…¨"><a href="#Redis-å®‰å…¨" class="headerlink" title="Redis å®‰å…¨"></a>Redis å®‰å…¨</h3><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ redis çš„é…ç½®æ–‡ä»¶è®¾ç½®å¯†ç å‚æ•°ï¼Œè¿™æ ·å®¢æˆ·ç«¯è¿æ¥åˆ° redis æœåŠ¡å°±éœ€è¦å¯†ç éªŒè¯ï¼Œè¿™æ ·å¯ä»¥è®©ä½ çš„ redis æœåŠ¡æ›´å®‰å…¨ã€‚ </p><pre><code class="hljs shell">å®ä¾‹æˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹æ˜¯å¦è®¾ç½®äº†å¯†ç éªŒè¯ï¼š127.0.0.1:6379&gt; CONFIG get requirepass1) &quot;requirepass&quot;2) &quot;&quot;é»˜è®¤æƒ…å†µä¸‹ requirepass å‚æ•°æ˜¯ç©ºçš„ï¼Œè¿™å°±æ„å‘³ç€ä½ æ— éœ€é€šè¿‡å¯†ç éªŒè¯å°±å¯ä»¥è¿æ¥åˆ° redis æœåŠ¡ã€‚ä½ å¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤æ¥ä¿®æ”¹è¯¥å‚æ•°ï¼š127.0.0.1:6379&gt; CONFIG set requirepass &quot;weitrue&quot;OK127.0.0.1:6379&gt; CONFIG get requirepass1) &quot;requirepass&quot;2) &quot;weitrue&quot;</code></pre><p>è®¾ç½®å¯†ç åï¼Œå®¢æˆ·ç«¯è¿æ¥ redis æœåŠ¡å°±éœ€è¦å¯†ç éªŒè¯ï¼Œå¦åˆ™æ— æ³•æ‰§è¡Œå‘½ä»¤ã€‚</p><pre><code class="hljs shell">è¯­æ³•AUTH å‘½ä»¤åŸºæœ¬è¯­æ³•æ ¼å¼å¦‚ä¸‹ï¼š127.0.0.1:6379&gt; AUTH passwordå®ä¾‹127.0.0.1:6379&gt; AUTH &quot;weitrue&quot;OK</code></pre><p>å–æ¶ˆå¯†ç  â€”é‡å¯æœåŠ¡</p><pre><code class="hljs plain">AUTHå‘½ä»¤è·Ÿå…¶ä»–rediså‘½ä»¤ä¸€æ ·ï¼Œæ˜¯æ²¡æœ‰åŠ å¯†çš„ï¼›é˜»æ­¢ä¸äº†æ”»å‡»è€…åœ¨ç½‘ç»œä¸Šçªƒå–ä½ çš„å¯†ç ï¼›</code></pre><h3 id="Redis-æ€§èƒ½æµ‹è¯•"><a href="#Redis-æ€§èƒ½æµ‹è¯•" class="headerlink" title="Redis æ€§èƒ½æµ‹è¯•"></a>Redis æ€§èƒ½æµ‹è¯•</h3><p>Redis æ€§èƒ½æµ‹è¯•æ˜¯é€šè¿‡åŒæ—¶æ‰§è¡Œå¤šä¸ªå‘½ä»¤å®ç°çš„ã€‚</p><pre><code class="hljs shell">è¯­æ³•redis æ€§èƒ½æµ‹è¯•çš„åŸºæœ¬å‘½ä»¤å¦‚ä¸‹ï¼šredis-benchmark [option] [option value]æ³¨æ„ï¼šè¯¥å‘½ä»¤æ˜¯åœ¨ redis çš„ç›®å½•ä¸‹æ‰§è¡Œçš„ï¼Œè€Œä¸æ˜¯ redis å®¢æˆ·ç«¯çš„å†…éƒ¨æŒ‡ä»¤ã€‚å®ä¾‹ä»¥ä¸‹å®ä¾‹åŒæ—¶æ‰§è¡Œ 10000 ä¸ªè¯·æ±‚æ¥æ£€æµ‹æ€§èƒ½ï¼š[hadoop@node02 redis-6.0.1]$ src/redis-benchmark  -h node02 -p 6379  -n 10000 -qPING_INLINE: 72992.70 requests per secondPING_BULK: 70921.98 requests per secondSET: 66666.66 requests per secondGET: 73529.41 requests per secondINCR: 75187.97 requests per secondLPUSH: 68493.15 requests per secondRPUSH: 76923.08 requests per secondLPOP: 74626.87 requests per secondRPOP: 75757.58 requests per secondSADD: 76335.88 requests per secondSPOP: 76923.08 requests per secondLPUSH (needed to benchmark LRANGE): 75757.58 requests per secondLRANGE_100 (first 100 elements): 40983.61 requests per secondLRANGE_300 (first 300 elements): 19120.46 requests per secondLRANGE_500 (first 450 elements): 13605.44 requests per secondLRANGE_600 (first 600 elements): 10672.36 requests per secondMSET (10 keys): 59880.24 requests per second</code></pre><pre><code class="hljs lsl">redis æ€§èƒ½æµ‹è¯•å·¥å…·å¯é€‰å‚æ•°å¦‚ä¸‹æ‰€ç¤ºï¼šåºå·é€‰é¡¹æè¿°                                 é»˜è®¤å€¼<span class="hljs-number">1</span>-hæŒ‡å®šæœåŠ¡å™¨ä¸»æœºå                     <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span><span class="hljs-number">2</span>-pæŒ‡å®šæœåŠ¡å™¨ç«¯å£                            <span class="hljs-number">6379</span><span class="hljs-number">3</span>-sæŒ‡å®šæœåŠ¡å™¨ socket<span class="hljs-number">4</span>-cæŒ‡å®šå¹¶å‘è¿æ¥æ•°                             <span class="hljs-number">50</span><span class="hljs-number">5</span>-næŒ‡å®šè¯·æ±‚æ•°                             <span class="hljs-number">10000</span><span class="hljs-number">6</span>-dä»¥å­—èŠ‚çš„å½¢å¼æŒ‡å®š SET/GET å€¼çš„æ•°æ®å¤§å°         <span class="hljs-number">2</span><span class="hljs-number">7</span>-k<span class="hljs-number">1</span>=keep alive <span class="hljs-number">0</span>=reconnect              <span class="hljs-number">1</span><span class="hljs-number">8</span>-rSET/GET/INCR ä½¿ç”¨éšæœº <span class="hljs-type">key</span>, SADD ä½¿ç”¨éšæœºå€¼<span class="hljs-number">9</span>-Pé€šè¿‡ç®¡é“ä¼ è¾“ &lt;numreq&gt; è¯·æ±‚                 <span class="hljs-number">1</span><span class="hljs-number">10</span>-qå¼ºåˆ¶é€€å‡º redisã€‚ä»…æ˜¾ç¤º query/sec å€¼<span class="hljs-number">11</span>--csvä»¥ CSV æ ¼å¼è¾“å‡º<span class="hljs-number">12</span>-lç”Ÿæˆå¾ªç¯ï¼Œæ°¸ä¹…æ‰§è¡Œæµ‹è¯•<span class="hljs-number">13</span>-tä»…è¿è¡Œä»¥é€—å·åˆ†éš”çš„æµ‹è¯•å‘½ä»¤åˆ—è¡¨ã€‚<span class="hljs-number">14</span>-IIdle æ¨¡å¼ã€‚ä»…æ‰“å¼€ N ä¸ª idle è¿æ¥å¹¶ç­‰å¾…ã€‚</code></pre><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">ä»¥ä¸‹å®ä¾‹ä½¿ç”¨äº†å¤šä¸ªå‚æ•°æ¥æµ‹è¯• redis æ€§èƒ½ï¼š</span>[hadoop@node02 redis-6.0.1]$ src/redis-benchmark -h node02 -p 6379 -t set,lpush -n 10000 -qSET: 68493.15 requests per secondLPUSH: 67114.09 requests per secondä»¥ä¸Šå®ä¾‹ä¸­ä¸»æœºä¸º node01ï¼Œç«¯å£å·ä¸º 6379ï¼Œæ‰§è¡Œçš„å‘½ä»¤ä¸º set,lpushï¼Œè¯·æ±‚æ•°ä¸º 10000ï¼Œé€šè¿‡ -q å‚æ•°è®©ç»“æœåªæ˜¾ç¤ºæ¯ç§’æ‰§è¡Œçš„è¯·æ±‚æ•°ã€‚</code></pre><h3 id="redisçš„ä¸‰ç§é›†ç¾¤æ–¹å¼ï¼š"><a href="#redisçš„ä¸‰ç§é›†ç¾¤æ–¹å¼ï¼š" class="headerlink" title="redisçš„ä¸‰ç§é›†ç¾¤æ–¹å¼ï¼š"></a>redisçš„ä¸‰ç§é›†ç¾¤æ–¹å¼ï¼š</h3><h4 id="ä¸»ä»å¤åˆ¶æ¶æ„"><a href="#ä¸»ä»å¤åˆ¶æ¶æ„" class="headerlink" title="ä¸»ä»å¤åˆ¶æ¶æ„"></a>ä¸»ä»å¤åˆ¶æ¶æ„</h4><p>åœ¨Redisä¸­ï¼Œ<br><code>SLAVEOF  å‘½ä»¤æˆ–è€…è®¾ç½®</code>slaveof é€‰é¡¹ï¼Œè®©ä¸€ä¸ªæœåŠ¡å™¨å»å¤åˆ¶ï¼ˆreplicateï¼‰å¦ä¸€ä¸ªæœåŠ¡å™¨ï¼Œè¢«å¤åˆ¶çš„æœåŠ¡å™¨ä¸ºä¸»æœåŠ¡å™¨ï¼ˆmasterï¼‰ï¼Œè€Œå¯¹ä¸»æœåŠ¡å™¨è¿›è¡Œå¤åˆ¶çš„æœåŠ¡å™¨åˆ™è¢«ç§°ä¸ºä»æœåŠ¡å™¨ï¼ˆslaveï¼‰ã€‚<br><code>SLAVEOF no one</code>å‘½ä»¤å–æ¶ˆæˆä¸ºä»èŠ‚ç‚¹ã€‚</p><p><img src="/images/redis/image-20200526181040434.png"></p><p><img src="/images/redis/image-20200526181105914.png"></p><p><img src="/images/redis/image-20200527001642571.png"></p><h5 id="ä½œç”¨"><a href="#ä½œç”¨" class="headerlink" title="ä½œç”¨"></a>ä½œç”¨</h5><ul><li>è¯»å†™åˆ†ç¦»:masterå†™,slaveè¯»ã€‚</li><li>è´Ÿè½½å‡è¡¡:ç”±slaveåˆ†æ‹…masterè´Ÿè½½,å¹¶æ ¹æ®éœ€æ±‚,æ”¹å˜slaveçš„æ•°é‡,é€šè¿‡å¤šä¸ªä»èŠ‚ç‚¹è¯»å–è´Ÿè½½ã€‚</li><li>æ•…éšœæ¢å¤:å½“masterå‡ºç°é—®é¢˜çš„æ—¶å€™,ç”±slaveæä¾›æœåŠ¡,å®ç°å¿«é€Ÿæ¢å¤ã€‚</li><li>æ•°æ®å†—ä½™:å®æ—¶å¤‡ä»½ã€‚</li></ul><h5 id="å·¥ä½œåŸç†"><a href="#å·¥ä½œåŸç†" class="headerlink" title="å·¥ä½œåŸç†"></a>å·¥ä½œåŸç†</h5><pre><code class="hljs angelscript">ä¸‰é˜¶æ®µ: <span class="hljs-number">1.</span>å»ºç«‹è¿æ¥ <span class="hljs-number">2.</span>æ•°æ®åŒæ­¥ <span class="hljs-number">3.</span>å‘½ä»¤ä¼ æ’­é˜¶æ®µ</code></pre><p><img src="/images/redis/image-20200526191458864.png"></p><p><img src="/images/redis/image-20200527001702103.png"></p><h5 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h5><p>ä½¿ç”¨ä¸»ä»å¤åˆ¶è¿™ç§æ¨¡å¼ï¼Œå®ç°node01ä½œä¸ºä¸»èŠ‚ç‚¹ï¼Œnode02ä¸node03ä½œä¸ºä»èŠ‚ç‚¹ï¼Œå¹¶ä¸”å°†node01æ‰€æœ‰çš„æ•°æ®å…¨éƒ¨éƒ½åŒæ­¥åˆ°node02ä¸node03æœåŠ¡å™¨</p><p>ç¬¬ä¸€æ­¥: å°†node01ä¸Šçš„redisæ‹·è´åˆ°node02å’Œnode03ä¸Š</p><pre><code class="hljs shell">scp -r /weitrue/install/redis-6.0.1/ node02:/weitrue/install/scp -r /weitrue/install/redis-6.0.1/ node03:/weitrue/instal/</code></pre><p>ç¬¬äºŒæ­¥ï¼šnode02ä¸node03æœåŠ¡å™¨å®‰è£…redis</p><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> node02ä¸node03æœåŠ¡å™¨ä¿®æ”¹redisé…ç½®æ–‡ä»¶</span><span class="hljs-meta">#</span><span class="bash"> node02æœåŠ¡å™¨ä¿®æ”¹é…ç½®æ–‡ä»¶å‘½ä»¤å¦‚ä¸‹</span><span class="hljs-meta">#</span><span class="bash">æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ä¿®æ”¹redisé…ç½®æ–‡ä»¶</span>cd /weitrue/install/redis-6.0.1/mkdir -p /weitrue/install/redis-6.0.1/logsmkdir -p /weitrue/install/redis-6.0.1/redisdatavim redis.confbind node02daemonize yespidfile /weitrue/install/redis-6.0.1/redis_6379.pidlogfile &quot;/weitrue/install/redis-6.0.1/logs/redis.log&quot;dir /weitrue/install/redis-6.0.1/redisdataslaveof node01 6379<span class="hljs-meta">#</span><span class="bash"> node03æœåŠ¡å™¨ä¿®æ”¹é…ç½®æ–‡ä»¶å‘½ä»¤å¦‚ä¸‹</span><span class="hljs-meta">#</span><span class="bash">æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ä¿®æ”¹redisé…ç½®æ–‡ä»¶</span>cd /weitrue/install/redis-6.0.1/mkdir -p /weitrue/install/redis-6.0.1/logsmkdir -p /weitrue/install/redis-6.0.1/redisdatavim redis.confbind node03daemonize yespidfile /var/run/redis_6379.pidlogfile &quot;/weitrue/install/redis-6.0.1/logs/redis.log&quot;dir /weitrue/install/redis-6.0.1/redisdataslaveof node01 6379</code></pre><p>ç¬¬ä¸‰æ­¥ã€å¯åŠ¨node02ä¸node03æœºå™¨çš„redisæœåŠ¡</p><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">node02æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å¯åŠ¨redisæœåŠ¡</span>cd  /weitrue/install/redis-6.0.1/src/redis-server  redis.conf<span class="hljs-meta">#</span><span class="bash">ode03æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å¯åŠ¨redisæœ</span>cd  /weitrue/install/redis-6.0.1/src/redis-server  redis.conf</code></pre><p>å¯åŠ¨æˆåŠŸä¾¿å¯ä»¥å®ç°redisçš„ä¸»ä»å¤åˆ¶ï¼Œnode01å¯ä»¥è¯»å†™æ“ä½œï¼Œnode02ä¸node03åªæ”¯æŒè¯»å–æ“ä½œã€‚</p><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">æ³¨æ„:åŠ¡å¿…å…³æ‰é˜²ç«å¢™</span><span class="hljs-meta">#</span><span class="bash">è¿æ¥node01</span>src/redis-cli -h node01set weitrue 1234<span class="hljs-meta">#</span><span class="bash">è¿æ¥node02</span>src/redis-cli -h node02get weitrue<span class="hljs-meta">#</span><span class="bash">æŸ¥çœ‹é›†ç¾¤ä¿¡æ¯</span>info<span class="hljs-meta">#</span><span class="bash">ä¸»ä»æ–­å¼€è¿æ¥</span>slaveof no one</code></pre><h4 id="rediså½“ä¸­çš„Sentinelæ¶æ„"><a href="#rediså½“ä¸­çš„Sentinelæ¶æ„" class="headerlink" title="rediså½“ä¸­çš„Sentinelæ¶æ„"></a>rediså½“ä¸­çš„Sentinelæ¶æ„</h4><pre><code class="hljs plain">Sentinelï¼ˆå“¨å…µï¼‰æ˜¯Redis çš„é«˜å¯ç”¨æ€§è§£å†³æ–¹æ¡ˆï¼šç”±ä¸€ä¸ªæˆ–å¤šä¸ªSentinel å®ä¾‹ ç»„æˆçš„Sentinel ç³»ç»Ÿå¯ä»¥ç›‘è§†ä»»æ„å¤šä¸ªä¸»æœåŠ¡å™¨ï¼Œä»¥åŠè¿™äº›ä¸»æœåŠ¡å™¨å±ä¸‹çš„æ‰€æœ‰ä»æœåŠ¡å™¨ï¼Œå¹¶åœ¨è¢«ç›‘è§†çš„ä¸»æœåŠ¡å™¨è¿›å…¥ä¸‹çº¿çŠ¶æ€æ—¶ï¼Œè‡ªåŠ¨å°†ä¸‹çº¿ä¸»æœåŠ¡å™¨å±ä¸‹çš„æŸä¸ªä»æœåŠ¡å™¨å‡çº§ä¸ºæ–°çš„ä¸»æœåŠ¡å™¨ã€‚</code></pre><p><img src="/images/redis/image-20200527141509519.png"></p><p><img src="/images/redis/image-20200527141538252.png"></p><p>ä½œç”¨:</p><pre><code class="hljs crmsh"> ç›‘æ§:ä¸æ–­çš„æ£€æŸ¥<span class="hljs-literal">master</span>å’Œ<span class="hljs-literal">slave</span>æ˜¯å¦æ­£å¸¸è¿è¡Œ.<span class="hljs-literal">master</span>å­˜æ´»æ£€æµ‹,<span class="hljs-literal">master</span>ä¸<span class="hljs-literal">slave</span>è¿è¡Œæƒ…å†µæ£€æµ‹. é€šçŸ¥:å½“è¢«ç›‘æ§çš„æœåŠ¡å™¨å‡ºç°é—®é¢˜æ—¶,å‘å…¶ä»–çš„(å“¨å…µé—´æˆ–è€…å®¢æˆ·ç«¯)å‘é€é€šçŸ¥.è‡ªåŠ¨æ•…éšœè½¬ç§»:æ–­å¼€<span class="hljs-literal">master</span>ä¸<span class="hljs-literal">slave</span>è¿æ¥,é€‰å–ä¸€ä¸ª<span class="hljs-literal">slave</span>ä½œä¸º<span class="hljs-literal">master</span>,å°†å…¶ä»–çš„<span class="hljs-literal">slave</span>è¿æ¥åˆ°æ–°çš„<span class="hljs-literal">master</span>,å¹¶å‘ŠçŸ¥å®¢æˆ·ç«¯æ–°çš„æœåŠ¡å™¨åœ°å€.æ³¨æ„:å“¨å…µé€šå¸¸ä¹Ÿæ˜¯ä¸€å°æœåŠ¡å™¨,ä½†ä¸æä¾›æœåŠ¡,é€šå¸¸çš„å“¨å…µé…ç½®ä¸ºç§¯æ•°.</code></pre><p>é…ç½®:</p><p>ç¬¬ä¸€æ­¥ï¼šä¸‰å°æœºå™¨ä¿®æ”¹å“¨å…µé…ç½®æ–‡ä»¶</p><pre><code class="hljs angelscript">#ä¸‰å°æœºå™¨æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ä¿®æ”¹redisçš„å“¨å…µé…ç½®æ–‡ä»¶cd /weitrue/install/redis<span class="hljs-number">-6.0</span><span class="hljs-number">.1</span>vim sentinel.conf# é…ç½®ç›‘å¬çš„ä¸»æœåŠ¡å™¨ï¼Œè¿™é‡Œsentinel monitorä»£è¡¨ç›‘æ§ï¼Œmymasterä»£è¡¨æœåŠ¡å™¨çš„åç§°ï¼Œå¯ä»¥è‡ªå®šä¹‰ï¼Œ<span class="hljs-number">192.168</span><span class="hljs-number">.11</span><span class="hljs-number">.128</span>ä»£è¡¨ç›‘æ§çš„ä¸»æœåŠ¡å™¨ï¼Œ<span class="hljs-number">6379</span>ä»£è¡¨ç«¯å£ï¼Œ<span class="hljs-number">2</span>ä»£è¡¨åªæœ‰ä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šçš„å“¨å…µè®¤ä¸ºä¸»æœåŠ¡å™¨ä¸å¯ç”¨çš„æ—¶å€™ï¼Œæ‰ä¼šè¿›è¡Œfailoveræ“ä½œã€‚#ä¿®æ”¹bindé…ç½®ï¼Œæ¯å°æœºå™¨ä¿®æ”¹ä¸ºè‡ªå·±å¯¹åº”çš„ä¸»æœºåbind node01  #é…ç½®sentinelæœåŠ¡åå°è¿è¡Œdaemonize yes#ä¿®æ”¹ä¸‰å°æœºå™¨ç›‘æ§çš„ä¸»èŠ‚ç‚¹ï¼Œç°åœ¨ä¸»èŠ‚ç‚¹æ˜¯node01æœåŠ¡å™¨sentinel monitor mymaster <span class="hljs-number">192.168</span><span class="hljs-number">.8</span><span class="hljs-number">.100</span> <span class="hljs-number">6379</span> <span class="hljs-number">2</span># sentinel monitorä»£è¡¨ç›‘æ§ï¼Œmymasteræ˜¯æœåŠ¡åç§°,å¯ä»¥è‡ªå®šä¹‰;node01 ä»£è¡¨ç›‘æ§çš„ä¸»æœåŠ¡å™¨;<span class="hljs-number">6379</span>ä»£è¡¨ç«¯å£,<span class="hljs-number">2</span>ä»£è¡¨åªæœ‰ä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šçš„å“¨å…µè®¤ä¸ºä¸»æœåŠ¡å™¨ä¸å¯ç”¨çš„æ—¶å€™ï¼Œæ‰ä¼šè¿›è¡Œfailoveræ“ä½œã€‚</code></pre><p>ç¬¬äºŒæ­¥ï¼šä¸‰å°æœºå™¨å¯åŠ¨å“¨å…µæœåŠ¡</p><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">ä¸‰å°æœºå™¨æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å¯åŠ¨å“¨å…µæœåŠ¡</span>cd /weitrue/install/redis-6.0.1/src/redis-sentinel sentinel.conf</code></pre><p>ç¬¬ä¸‰æ­¥ï¼šnode01æœåŠ¡å™¨æ€æ­»redisæœåŠ¡è¿›ç¨‹</p><pre><code class="hljs gcode">ä½¿ç”¨kill  <span class="hljs-number">-9</span>å‘½ä»¤æ€æ­»redisæœåŠ¡è¿›ç¨‹ï¼Œæ¨¡æ‹Ÿredisæ•…éšœå®•æœºæƒ…å†µè¿‡ä¸€æ®µæ—¶é—´ä¹‹åï¼Œå°±ä¼šåœ¨<span class="hljs-symbol">node02</span>ä¸<span class="hljs-symbol">node03</span>æœåŠ¡å™¨é€‰æ‹©ä¸€å°æœåŠ¡å™¨æ¥åˆ‡æ¢ä¸ºä¸»èŠ‚ç‚¹</code></pre><p>åŸç†:</p><p><img src="/images/redis/image-20200527175422937.png"></p><p><img src="/images/redis/image-20200527181408612.png"></p><p><img src="/images/redis/image-20200527182135500.png"></p><p><img src="/images/redis/image-20200527184045802.png"></p><h4 id="redisé›†ç¾¤"><a href="#redisé›†ç¾¤" class="headerlink" title="redisé›†ç¾¤"></a>redisé›†ç¾¤</h4><pre><code class="hljs angelscript">Redis é›†ç¾¤æ˜¯ä¸€ä¸ªæä¾›åœ¨å¤šä¸ªRedisèŠ‚ç‚¹ä¹‹é—´å…±äº«æ•°æ®çš„ç¨‹åºé›†ã€‚Redis é›†ç¾¤å¹¶ä¸æ”¯æŒåŒæ—¶å¤„ç†å¤šä¸ªé”®çš„ Redis å‘½ä»¤ï¼Œå› ä¸ºè¿™éœ€è¦åœ¨å¤šä¸ªèŠ‚ç‚¹é—´ç§»åŠ¨æ•°æ®ï¼Œè¿™æ ·ä¼šé™ä½redisé›†ç¾¤çš„æ€§èƒ½ï¼Œåœ¨é«˜è´Ÿè½½çš„æƒ…å†µä¸‹å¯èƒ½ä¼šå¯¼è‡´ä¸å¯é¢„æ–™çš„é”™è¯¯ã€‚Redis é›†ç¾¤é€šè¿‡åˆ†åŒºæ¥æä¾›ä¸€å®šç¨‹åº¦çš„å¯ç”¨æ€§ï¼Œå³ä½¿é›†ç¾¤ä¸­æœ‰ä¸€éƒ¨åˆ†èŠ‚ç‚¹å¤±æ•ˆæˆ–è€…æ— æ³•è¿›è¡Œé€šè®¯ï¼Œ é›†ç¾¤ä¹Ÿå¯ä»¥ç»§ç»­å¤„ç†å‘½ä»¤è¯·æ±‚ã€‚ Redis é›†ç¾¤çš„ä¼˜åŠ¿:<span class="hljs-number">1.</span>ç¼“å­˜æ°¸ä¸å®•æœºï¼šå¯åŠ¨é›†ç¾¤ï¼Œæ°¸è¿œè®©é›†ç¾¤çš„ä¸€éƒ¨åˆ†èµ·ä½œç”¨ã€‚ä¸»èŠ‚ç‚¹å¤±æ•ˆäº†å­èŠ‚ç‚¹èƒ½è¿…é€Ÿæ”¹å˜è§’è‰²æˆä¸ºä¸»èŠ‚ç‚¹ï¼Œæ•´ä¸ªé›†ç¾¤çš„éƒ¨åˆ†èŠ‚ç‚¹å¤±è´¥æˆ–è€…ä¸å¯è¾¾çš„æƒ…å†µä¸‹èƒ½å¤Ÿç»§ç»­å¤„ç†å‘½ä»¤ï¼›<span class="hljs-number">2.</span>è¿…é€Ÿæ¢å¤æ•°æ®ï¼šæŒä¹…åŒ–æ•°æ®ï¼Œèƒ½åœ¨å®•æœºåè¿…é€Ÿè§£å†³æ•°æ®ä¸¢å¤±çš„é—®é¢˜ï¼›<span class="hljs-number">3.</span>Rediså¯ä»¥ä½¿ç”¨æ‰€æœ‰æœºå™¨çš„å†…å­˜ï¼Œå˜ç›¸æ‰©å±•æ€§èƒ½ï¼›<span class="hljs-number">4.</span>ä½¿Redisçš„è®¡ç®—èƒ½åŠ›é€šè¿‡ç®€å•åœ°å¢åŠ æœåŠ¡å™¨å¾—åˆ°æˆå€æå‡,Redisçš„ç½‘ç»œå¸¦å®½ä¹Ÿä¼šéšç€è®¡ç®—æœºå’Œç½‘å¡çš„å¢åŠ è€Œæˆå€å¢é•¿ï¼›<span class="hljs-number">5.</span>Redisé›†ç¾¤æ²¡æœ‰ä¸­å¿ƒèŠ‚ç‚¹ï¼Œä¸ä¼šå› ä¸ºæŸä¸ªèŠ‚ç‚¹æˆä¸ºæ•´ä¸ªé›†ç¾¤çš„æ€§èƒ½ç“¶é¢ˆ;<span class="hljs-number">6.</span>å¼‚æ­¥å¤„ç†æ•°æ®ï¼Œå®ç°å¿«é€Ÿè¯»å†™ã€‚</code></pre><p><img src="/images/redis/image-20200524161751571.png"></p><h5 id="é›†ç¾¤æ•°æ®å­˜å‚¨è®¾è®¡åŠé€šä¿¡åŸç†"><a href="#é›†ç¾¤æ•°æ®å­˜å‚¨è®¾è®¡åŠé€šä¿¡åŸç†" class="headerlink" title="é›†ç¾¤æ•°æ®å­˜å‚¨è®¾è®¡åŠé€šä¿¡åŸç†"></a>é›†ç¾¤æ•°æ®å­˜å‚¨è®¾è®¡åŠé€šä¿¡åŸç†</h5><pre><code class="hljs plain">redisé›†ç¾¤æ•°æ®å­˜å‚¨è®¾è®¡</code></pre><p><img src="/images/redis/image-20200524162113663.png"></p><pre><code class="hljs plain">redisé›†ç¾¤é€šä¿¡åŸç†</code></pre><p><img src="/images/redis/1590146339566.png"></p><h5 id="redisé›†ç¾¤ç¯å¢ƒæ­å»º"><a href="#redisé›†ç¾¤ç¯å¢ƒæ­å»º" class="headerlink" title="redisé›†ç¾¤ç¯å¢ƒæ­å»º"></a>redisé›†ç¾¤ç¯å¢ƒæ­å»º</h5><pre><code class="hljs angelscript">ç”±äºredisé›†ç¾¤å½“ä¸­æœ€å°‘éœ€è¦ä¸‰ä¸ªä¸»èŠ‚ç‚¹ï¼Œæ¯ä¸ªä¸»èŠ‚ç‚¹ï¼Œæœ€å°‘éœ€è¦ä¸€ä¸ªå¯¹åº”çš„ä»èŠ‚ç‚¹ï¼Œæ‰€ä»¥æ­å»ºredisé›†ç¾¤æœ€å°‘éœ€è¦ä¸‰ä¸»ä¸‰ä»çš„é…ç½®ï¼Œå› æ­¤redisé›†ç¾¤æœ€å°‘éœ€è¦<span class="hljs-number">6</span>å°redisçš„å®ä¾‹ã€‚æˆ‘ä»¬è¿™é‡Œç”¨node01é€šè¿‡é…ç½®<span class="hljs-number">6</span>ä¸ªç«¯å£ï¼Œå®ç°redisé›†ç¾¤çš„ç¯å¢ƒæ­å»º</code></pre><h6 id="node01æœåŠ¡å™¨è§£å‹rediså‹ç¼©åŒ…"><a href="#node01æœåŠ¡å™¨è§£å‹rediså‹ç¼©åŒ…" class="headerlink" title="node01æœåŠ¡å™¨è§£å‹rediså‹ç¼©åŒ…"></a>node01æœåŠ¡å™¨è§£å‹rediså‹ç¼©åŒ…</h6><pre><code class="hljs awk"><span class="hljs-comment">#node01æ‰§è¡Œä»¥ä¸‹å‘½ä»¤é‡æ–°è§£å‹rediså‹ç¼©åŒ…åˆ°/weitrueè·¯å¾„ä¸‹</span>cd <span class="hljs-regexp">/weitrue/</span>soft/tar -zxvf redis-<span class="hljs-number">6.0</span>.<span class="hljs-number">1</span>.tar.gz -C ..<span class="hljs-regexp">/instal/</span></code></pre><h6 id="å®‰è£…rediså¿…é¡»ä¾èµ–ç¯å¢ƒå¹¶è¿›è¡Œç¼–è¯‘"><a href="#å®‰è£…rediså¿…é¡»ä¾èµ–ç¯å¢ƒå¹¶è¿›è¡Œç¼–è¯‘" class="headerlink" title="å®‰è£…rediså¿…é¡»ä¾èµ–ç¯å¢ƒå¹¶è¿›è¡Œç¼–è¯‘"></a>å®‰è£…rediså¿…é¡»ä¾èµ–ç¯å¢ƒå¹¶è¿›è¡Œç¼–è¯‘</h6><pre><code class="hljs routeros"><span class="hljs-comment">#node01æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å®‰è£…redisçš„ä¾èµ–ç¯å¢ƒ</span>su rootyum -y install gcc-c++ tcl<span class="hljs-comment"># æŸ¥çœ‹gccç‰ˆæœ¬æ˜¯å¦åœ¨5.3ä»¥ä¸Šï¼Œcentos7.6é»˜è®¤å®‰è£…4.8.5</span>gcc -v<span class="hljs-comment"># å‡çº§gccåˆ°5.3åŠä»¥ä¸Š,å¦‚ä¸‹ï¼š</span>å‡çº§åˆ°gcc 9.3ï¼šyum -y install centos-release-sclyum -y install devtoolset-9-gcc devtoolset-9-gcc-c++ devtoolset-9-binutilsscl <span class="hljs-builtin-name">enable</span> devtoolset-9 bashéœ€è¦æ³¨æ„çš„æ˜¯sclå‘½ä»¤å¯ç”¨åªæ˜¯ä¸´æ—¶çš„ï¼Œé€€å‡ºshellæˆ–é‡å¯å°±ä¼šæ¢å¤åŸç³»ç»Ÿgccç‰ˆæœ¬ã€‚å¦‚æœè¦é•¿æœŸä½¿ç”¨gcc 9.3çš„è¯ï¼šecho <span class="hljs-string">&quot;source /opt/rh/devtoolset-9/enable&quot;</span> &gt;&gt;/etc/profile<span class="hljs-comment">#è¿™æ ·é€€å‡ºshellé‡æ–°æ‰“å¼€å°±æ˜¯æ–°ç‰ˆçš„gccäº†</span><span class="hljs-comment">#å¯¹redisè¿›è¡Œç¼–è¯‘</span>cd /weitrue/redis-6.0.1make &amp;&amp; make install</code></pre><h6 id="åˆ›å»ºredisä¸åŒå®ä¾‹çš„é…ç½®æ–‡ä»¶å¤¹"><a href="#åˆ›å»ºredisä¸åŒå®ä¾‹çš„é…ç½®æ–‡ä»¶å¤¹" class="headerlink" title="åˆ›å»ºredisä¸åŒå®ä¾‹çš„é…ç½®æ–‡ä»¶å¤¹"></a>åˆ›å»ºredisä¸åŒå®ä¾‹çš„é…ç½®æ–‡ä»¶å¤¹</h6><p>åˆ›å»ºæ–‡ä»¶å¤¹ï¼Œå¹¶å°†redisçš„é…ç½®æ–‡ä»¶æ‹·è´åˆ°ä»¥ä¸‹è¿™äº›ç›®å½•</p><pre><code class="hljs apache"><span class="hljs-comment">#node01:</span><span class="hljs-attribute">cd</span> /weitrue/install/redis-<span class="hljs-number">6</span>.<span class="hljs-number">0</span>.<span class="hljs-number">1</span><span class="hljs-attribute">mkdir</span> -p /weitrue/install/redis-<span class="hljs-number">6</span>.<span class="hljs-number">0</span>.<span class="hljs-number">1</span>/clusters/<span class="hljs-number">7001</span><span class="hljs-attribute">mkdir</span> -p /weitrue/install/redis-<span class="hljs-number">6</span>.<span class="hljs-number">0</span>.<span class="hljs-number">1</span>/clusters/<span class="hljs-number">7002</span><span class="hljs-attribute">mkdir</span> -p /weitrue/install/redis-<span class="hljs-number">6</span>.<span class="hljs-number">0</span>.<span class="hljs-number">1</span>/clusters/<span class="hljs-number">7003</span><span class="hljs-attribute">mkdir</span> -p /weitrue/install/redis-<span class="hljs-number">6</span>.<span class="hljs-number">0</span>.<span class="hljs-number">1</span>/clusters/<span class="hljs-number">7004</span><span class="hljs-attribute">mkdir</span> -p /weitrue/install/redis-<span class="hljs-number">6</span>.<span class="hljs-number">0</span>.<span class="hljs-number">1</span>/clusters/<span class="hljs-number">7005</span><span class="hljs-attribute">mkdir</span> -p /weitrue/install/redis-<span class="hljs-number">6</span>.<span class="hljs-number">0</span>.<span class="hljs-number">1</span>/clusters/<span class="hljs-number">7006</span></code></pre><h6 id="ä¿®æ”¹redisçš„å…­ä¸ªé…ç½®æ–‡ä»¶"><a href="#ä¿®æ”¹redisçš„å…­ä¸ªé…ç½®æ–‡ä»¶" class="headerlink" title="ä¿®æ”¹redisçš„å…­ä¸ªé…ç½®æ–‡ä»¶"></a>ä¿®æ”¹redisçš„å…­ä¸ªé…ç½®æ–‡ä»¶</h6><pre><code class="hljs awk"><span class="hljs-comment">#node01æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ä¿®æ”¹redisçš„é…ç½®æ–‡ä»¶</span>mkdir -p <span class="hljs-regexp">/weitrue/i</span>nstall<span class="hljs-regexp">/redis-6.0.1/</span>logsmkdir -p <span class="hljs-regexp">/weitrue/i</span>nstall<span class="hljs-regexp">/redis-6.0.1/</span>redisdata/<span class="hljs-number">7001</span>mkdir -p <span class="hljs-regexp">/weitrue/i</span>nstall<span class="hljs-regexp">/redis-6.0.1/</span>redisdata/<span class="hljs-number">7002</span>mkdir -p <span class="hljs-regexp">/weitrue/i</span>nstall<span class="hljs-regexp">/redis-6.0.1/</span>redisdata/<span class="hljs-number">7003</span>mkdir -p <span class="hljs-regexp">/weitrue/i</span>nstall<span class="hljs-regexp">/redis-6.0.1/</span>redisdata/<span class="hljs-number">7004</span>mkdir -p <span class="hljs-regexp">/weitrue/i</span>nstall<span class="hljs-regexp">/redis-6.0.1/</span>redisdata/<span class="hljs-number">7005</span>mkdir -p <span class="hljs-regexp">/weitrue/i</span>nstall<span class="hljs-regexp">/redis-6.0.1/</span>redisdata/<span class="hljs-number">7006</span></code></pre><p>åˆ†åˆ«ä¿®æ”¹6ä¸ªé…ç½®æ–‡ä»¶</p><pre><code class="hljs java">vim  /weitrue/install/redis-<span class="hljs-number">6.0</span>.<span class="hljs-number">1</span>/redis.confbind node01port <span class="hljs-number">7001</span>                                 <span class="hljs-comment">//é»˜è®¤ipä¸º127.0.0.1 éœ€è¦æ”¹ä¸ºå…¶ä»–èŠ‚ç‚¹æœºå™¨å¯è®¿é—®çš„ip </span>cluster-enabled yes                       <span class="hljs-comment">//å¼€å¯é›†ç¾¤æŠŠæ³¨é‡Š#å»æ‰</span>cluster-config-file nodes-<span class="hljs-number">7001.</span>conf      <span class="hljs-comment">//é›†ç¾¤çš„é…ç½®  é…ç½®æ–‡ä»¶é¦–æ¬¡å¯åŠ¨è‡ªåŠ¨ç”Ÿæˆ 7001,7002,7003</span>cluster-node-timeout <span class="hljs-number">5000</span>                 <span class="hljs-comment">//è¯·æ±‚è¶…æ—¶  é»˜è®¤15ç§’ï¼Œå¯è‡ªè¡Œè®¾ç½®</span>appendonly yes                           <span class="hljs-comment">//aofæ—¥å¿—å¼€å¯  æœ‰éœ€è¦å°±å¼€å¯ï¼Œå®ƒä¼šæ¯æ¬¡å†™æ“ä½œéƒ½è®°å½•ä¸€æ¡æ—¥å¿—</span>daemonize yespidfile /<span class="hljs-keyword">var</span>/run/redis_7001.pidlogfile <span class="hljs-string">&quot;/weitrue/install/redis-6.0.1/logs/7001.log&quot;</span>dir /weitrue/install/redis-<span class="hljs-number">6.0</span>.<span class="hljs-number">1</span>/redisdata/<span class="hljs-number">7001</span></code></pre><pre><code class="hljs angelscript">æ³¨æ„ï¼športï¼šå¯¹åº”çš„æ¯å°æœºå™¨çš„ç«¯å£å·ï¼Œ    ç¬¬ä¸€å°æ˜¯ï¼šport <span class="hljs-number">7001</span>    ç¬¬äºŒå°ï¼šport  <span class="hljs-number">7002</span>    ....    ç¬¬å…­å°ï¼šport <span class="hljs-number">7006</span>        ç¬¬ä¸€å°ï¼š cluster-config-file nodes<span class="hljs-number">-7001.</span>conf    ....      ç¬¬å…­å°ï¼šcluster-config-file nodes<span class="hljs-number">-7006.</span>conf        ç¬¬ä¸€å°ï¼š dir /weitrue/install/redis<span class="hljs-number">-6.0</span><span class="hljs-number">.1</span>/redisdata/<span class="hljs-number">7001</span>    ....     ç¬¬å…­å°ï¼šdir /weitrue/install/redis<span class="hljs-number">-6.0</span><span class="hljs-number">.1</span>/redisdata/<span class="hljs-number">7006</span></code></pre><h6 id="å¯åŠ¨redisè¿›ç¨‹"><a href="#å¯åŠ¨redisè¿›ç¨‹" class="headerlink" title="å¯åŠ¨redisè¿›ç¨‹"></a>å¯åŠ¨redisè¿›ç¨‹</h6><p>node01æ‰§è¡Œä»¥ä¸‹å‘½ä»¤æ¥å¯åŠ¨redisé›†ç¾¤</p><pre><code class="hljs awk">cd <span class="hljs-regexp">/weitrue/</span>redis-<span class="hljs-number">6.0</span>.<span class="hljs-number">1</span>src<span class="hljs-regexp">/redis-server clusters/</span><span class="hljs-number">7001</span>/redis.confsrc<span class="hljs-regexp">/redis-server clusters/</span><span class="hljs-number">7002</span>/redis.confsrc<span class="hljs-regexp">/redis-server clusters/</span><span class="hljs-number">7003</span>/redis.confsrc<span class="hljs-regexp">/redis-server clusters/</span><span class="hljs-number">7004</span>/redis.confsrc<span class="hljs-regexp">/redis-server clusters/</span><span class="hljs-number">7005</span>/redis.confsrc<span class="hljs-regexp">/redis-server clusters/</span><span class="hljs-number">7006</span>/redis.conf</code></pre><h6 id="åˆ›å»ºredisé›†ç¾¤"><a href="#åˆ›å»ºredisé›†ç¾¤" class="headerlink" title="åˆ›å»ºredisé›†ç¾¤"></a>åˆ›å»ºredisé›†ç¾¤</h6><p>node01æ‰§è¡Œä»¥ä¸‹å‘½ä»¤åˆ›å»ºredisé›†ç¾¤</p><pre><code class="hljs angelscript">cd /weitrue/install/redis<span class="hljs-number">-6.0</span><span class="hljs-number">.1</span>src/redis-cli --cluster create <span class="hljs-number">192.168</span><span class="hljs-number">.8</span><span class="hljs-number">.100</span>:<span class="hljs-number">7001</span> <span class="hljs-number">192.168</span><span class="hljs-number">.8</span><span class="hljs-number">.100</span>:<span class="hljs-number">7002</span> <span class="hljs-number">192.168</span><span class="hljs-number">.8</span><span class="hljs-number">.100</span>:<span class="hljs-number">7003</span> <span class="hljs-number">192.168</span><span class="hljs-number">.8</span><span class="hljs-number">.100</span>:<span class="hljs-number">7004</span> <span class="hljs-number">192.168</span><span class="hljs-number">.8</span><span class="hljs-number">.100</span>:<span class="hljs-number">7005</span> <span class="hljs-number">192.168</span><span class="hljs-number">.8</span><span class="hljs-number">.100</span>:<span class="hljs-number">7006</span> --cluster-replicas <span class="hljs-number">1</span></code></pre><p>æ³¨æ„ï¼šå¦‚æœåˆ›å»ºclusteré›†ç¾¤å‡ºç°ä»¥ä¸‹è¿™ä¸ªé”™è¯¯</p><p><img src="/images/redis/2.png"></p><p>é‚£ä¹ˆæˆ‘ä»¬éœ€è¦æ¸…ç©ºæ‰€æœ‰redisèŠ‚ç‚¹çš„æ‰€æœ‰æ•°æ®</p><p>æ‰§è¡Œä»¥ä¸‹å‘½ä»¤è¿æ¥åˆ°å„ä¸ªredisèŠ‚ç‚¹ï¼Œç„¶åæ¸…ç©ºæ•°æ®</p><pre><code class="hljs angelscript">ç¤ºä¾‹ï¼š<span class="hljs-string">[root@node01 redis-6.0.1]</span># src/redis-cli  -h node01 -c -p <span class="hljs-number">7001</span>node01:<span class="hljs-number">7001</span>&gt; flushall OKnode01:<span class="hljs-number">7001</span>&gt; cluster resetOKnode01:<span class="hljs-number">7001</span>&gt; quit#ä¾æ¬¡æ‰§è¡Œ<span class="hljs-number">6</span>å°æœºå™¨</code></pre><p>é‡æ–°åˆ›å»ºredisé›†ç¾¤</p><pre><code class="hljs angelscript">src/redis-cli --cluster create <span class="hljs-number">192.168</span><span class="hljs-number">.8</span><span class="hljs-number">.100</span>:<span class="hljs-number">7001</span> <span class="hljs-number">192.168</span><span class="hljs-number">.8</span><span class="hljs-number">.100</span>:<span class="hljs-number">7002</span> <span class="hljs-number">192.168</span><span class="hljs-number">.8</span><span class="hljs-number">.100</span>:<span class="hljs-number">7003</span> <span class="hljs-number">192.168</span><span class="hljs-number">.8</span><span class="hljs-number">.100</span>:<span class="hljs-number">7004</span> <span class="hljs-number">192.168</span><span class="hljs-number">.8</span><span class="hljs-number">.100</span>:<span class="hljs-number">7005</span> <span class="hljs-number">192.168</span><span class="hljs-number">.8</span><span class="hljs-number">.100</span>:<span class="hljs-number">7006</span> --cluster-replicas <span class="hljs-number">1</span></code></pre><h6 id="è¿æ¥rediså®¢æˆ·ç«¯-1"><a href="#è¿æ¥rediså®¢æˆ·ç«¯-1" class="headerlink" title="è¿æ¥rediså®¢æˆ·ç«¯"></a>è¿æ¥rediså®¢æˆ·ç«¯</h6><p>node01æ‰§è¡Œä»¥ä¸‹å‘½ä»¤è¿æ¥rediså®¢æˆ·ç«¯</p><pre><code class="hljs apache"><span class="hljs-attribute">cd</span> /weitrue/redis-<span class="hljs-number">6</span>.<span class="hljs-number">0</span>.<span class="hljs-number">1</span><span class="hljs-attribute">src</span>/redis-cli  -h node<span class="hljs-number">01</span> -c -p <span class="hljs-number">7001</span></code></pre><h5 id="redisé›†ç¾¤ç®¡ç†"><a href="#redisé›†ç¾¤ç®¡ç†" class="headerlink" title="redisé›†ç¾¤ç®¡ç†"></a>redisé›†ç¾¤ç®¡ç†</h5><p>æ·»åŠ ä¸€ä¸ªæ–°èŠ‚ç‚¹ä½œä¸ºä¸»èŠ‚ç‚¹</p><p>å¯åŠ¨æ–°èŠ‚ç‚¹çš„redisæœåŠ¡ï¼Œç„¶åæ·»åŠ åˆ°é›†ç¾¤å½“ä¸­å»</p><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">1.åˆ›å»ºæ–‡ä»¶å¤¹</span>mkdir -p /weitrue/install/redis-6.0.1/redisdata/7007mkdir -p /weitrue/install/redis-6.0.1/redisdata/7008mkdir -p /weitrue/install/redis-6.0.1/clusters/7007mkdir -p /weitrue/install/redis-6.0.1/clusters/7008<span class="hljs-meta">#</span><span class="bash">2.ä¿®æ”¹redis.conf</span>vim /weitrue/install/redis-6.0.1/clusters/7007/redis.confvim /weitrue/install/redis-6.0.1/clusters/7008/redis.conf</code></pre><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">å¯åŠ¨æœåŠ¡</span>src/redis-server clusters/7007/redis.conf<span class="hljs-meta">#</span><span class="bash">æ·»åŠ æœåŠ¡</span>src/redis-cli --cluster add-node 192.168.8.100:7007 192.168.8.100:7001<span class="hljs-meta">#</span><span class="bash">è§£é‡Š:</span>192.168.8.100:7007 #æœåŠ¡å™¨ip:ç«¯å£;192.168.8.100:7001 #é›†ç¾¤ä¸­ä»»æ„ä¸€å°ip:ç«¯å£</code></pre><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">æŸ¥çœ‹ä¿¡æ¯</span>src/redis-cli --cluster info 192.168.8.100:7001</code></pre><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">æ£€æµ‹é›†ç¾¤</span>src/redis-cli --cluster check 192.168.8.100:7007</code></pre><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">é‡æ–°åˆ†ç‰‡</span><span class="hljs-meta">#</span><span class="bash">å‘½ä»¤æ ¼å¼</span>src/redis-cli --cluster reshard --from &lt;node-id&gt; --to &lt;node-id&gt; --slots &lt;number of slots&gt; --yes &lt;host&gt;:&lt;port&gt;<span class="hljs-meta">#</span><span class="bash">å®ä¾‹:</span>src/redis-cli --cluster reshard 192.168.8.100:7001<span class="hljs-meta">#</span><span class="bash">è§£é‡Š:</span>192.168.8.100:7001 #é›†ç¾¤ä¸­ä»»åŠ¡ä¸€ä¸ªèŠ‚ç‚¹<span class="hljs-meta">#</span><span class="bash">ä¸‹é¢ä»£è¡¨éœ€è¦è¾“å…¥å‚æ•°çš„æç¤º</span>1.How many slots do you want to move (from 1 to 16384)?4096ã€€ã€€ã€€ã€€ <span class="hljs-meta">#</span><span class="bash">æ‹¿å‡º4096ä¸ª<span class="hljs-built_in">hash</span> æ§½</span>2.What is the receiving node ID? c5e0da48f335c46a2ec199faa99b830f537dd8a0 <span class="hljs-meta">#</span><span class="bash">7007æœåŠ¡æ‰€åœ¨çš„èŠ‚ç‚¹çš„idå€¼</span>3.Source node #1: all <span class="hljs-meta">#</span><span class="bash">ä»å½“å‰æ‰€æœ‰masteræœåŠ¡å™¨è·å–<span class="hljs-built_in">hash</span>æ§½</span>4.Do you want to proceed with the proposed reshard plan (yes/no)?yesã€€<span class="hljs-meta">#</span><span class="bash"> åŒæ„ä»¥ä¸Šé…ç½®</span></code></pre><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">æŸ¥çœ‹é›†ç¾¤ä¿¡æ¯</span>src/redis-cli --cluster info 192.168.8.100:7001</code></pre><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">æ·»åŠ slaveè§’è‰²åˆ°é›†ç¾¤é‡Œ</span><span class="hljs-meta">#</span><span class="bash">å¯åŠ¨7008æœåŠ¡</span>src/redis-server clusters/7008/redis.conf<span class="hljs-meta">#</span><span class="bash">æ·»åŠ å‰¯æœ¬</span>src/redis-cli --cluster add-node  --cluster-slave 192.168.8.100:7008 192.168.8.100:7001<span class="hljs-meta">#</span><span class="bash">è§£é‡Š</span>192.168.8.100:7008 #ä»æœåŠ¡å™¨ip:ç«¯å£;192.168.8.100:7001 #é›†ç¾¤ä¸­ä»»æ„ä¸€å°ip:ç«¯å£</code></pre><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">åˆ é™¤æŸä¸€èŠ‚ç‚¹redisæœåŠ¡</span>src/redis-cli --cluster del-node 192.168.8.100:7008 4bf2fc80931392c248a7ae359bd1bf540872c688</code></pre><h3 id="Rediså‡»ç©¿ã€ç©¿é€ã€é›ªå´©ã€é¢„çƒ­"><a href="#Rediså‡»ç©¿ã€ç©¿é€ã€é›ªå´©ã€é¢„çƒ­" class="headerlink" title="Rediså‡»ç©¿ã€ç©¿é€ã€é›ªå´©ã€é¢„çƒ­"></a>Rediså‡»ç©¿ã€ç©¿é€ã€é›ªå´©ã€é¢„çƒ­</h3><h4 id="ç¼“å­˜ç©¿é€"><a href="#ç¼“å­˜ç©¿é€" class="headerlink" title="ç¼“å­˜ç©¿é€"></a>ç¼“å­˜ç©¿é€</h4><pre><code class="hljs makefile"><span class="hljs-section">é—®é¢˜:</span>RedisæœåŠ¡å™¨å‘½ä¸­ç‡éšæ—¶é—´é€æ­¥é™ä½</code></pre><pre><code class="hljs gauss">ç¼“å­˜ç©¿é€çš„æ¦‚å¿µå¾ˆç®€å•ï¼Œç”¨æˆ·æƒ³è¦æŸ¥è¯¢ä¸€ä¸ªæ•°æ®ï¼Œå‘ç°rediså†…å­˜æ•°æ®åº“æ²¡æœ‰ï¼Œä¹Ÿå°±æ˜¯ç¼“å­˜æ²¡æœ‰å‘½ä¸­ï¼Œäºæ˜¯å‘æŒä¹…å±‚æ•°æ®åº“æŸ¥è¯¢ã€‚å‘ç°ä¹Ÿæ²¡æœ‰ï¼Œäºæ˜¯æœ¬æ¬¡æŸ¥è¯¢å¤±è´¥ã€‚å½“ç”¨æˆ·å¾ˆå¤šçš„æ—¶å€™ï¼Œç¼“å­˜éƒ½æ²¡æœ‰å‘½ä¸­ï¼Œäºæ˜¯éƒ½å»è¯·æ±‚äº†æŒä¹…å±‚æ•°æ®åº“ã€‚è¿™ä¼šç»™æŒä¹…å±‚æ•°æ®åº“é€ æˆå¾ˆå¤§çš„å‹åŠ›ï¼Œè¿™æ—¶å€™å°±ç›¸å½“äºå‡ºç°äº†ç¼“å­˜ç©¿é€ã€‚è¿™é‡Œéœ€è¦æ³¨æ„å’Œç¼“å­˜å‡»ç©¿çš„åŒºåˆ«ï¼Œç¼“å­˜å‡»ç©¿ï¼Œæ˜¯æŒ‡ä¸€ä¸ª<span class="hljs-built_in">key</span>éå¸¸çƒ­ç‚¹ï¼Œåœ¨ä¸åœçš„æ‰›ç€å¤§å¹¶å‘ï¼Œå¤§å¹¶å‘é›†ä¸­å¯¹è¿™ä¸€ä¸ªç‚¹è¿›è¡Œè®¿é—®ï¼Œå½“è¿™ä¸ª<span class="hljs-built_in">key</span>åœ¨å¤±æ•ˆçš„ç¬é—´ï¼ŒæŒç»­çš„å¤§å¹¶å‘å°±ç©¿ç ´ç¼“å­˜ï¼Œç›´æ¥è¯·æ±‚æ•°æ®åº“ï¼Œå°±åƒåœ¨ä¸€ä¸ªå±éšœä¸Šå‡¿å¼€äº†ä¸€ä¸ªæ´ã€‚ä¸ºäº†é¿å…ç¼“å­˜ç©¿é€å…¶å®æœ‰å¾ˆå¤šç§è§£å†³æ–¹æ¡ˆã€‚ä¸‹é¢ä»‹ç»å‡ ç§ã€‚<span class="hljs-number">1.1</span> ç™½åå•ç­–ç•¥:</code></pre><pre><code class="hljs angelscript"><span class="hljs-number">1.1</span><span class="hljs-number">.1</span>  å°†idæ”¾åœ¨bitmapsä¸­,idä½œä¸ºbitmapsçš„offset<span class="hljs-number">1.1</span><span class="hljs-number">.2</span> å¸ƒéš†è¿‡æ»¤å™¨:é‚£è¿™ä¸ªå¸ƒéš†è¿‡æ»¤å™¨æ˜¯å¦‚ä½•è§£å†³redisä¸­çš„ç¼“å­˜ç©¿é€å‘¢ï¼Ÿå¾ˆç®€å•é¦–å…ˆä¹Ÿæ˜¯å¯¹æ‰€æœ‰å¯èƒ½æŸ¥è¯¢çš„å‚æ•°ä»¥hashå½¢å¼å­˜å‚¨ï¼Œå½“ç”¨æˆ·æƒ³è¦æŸ¥è¯¢çš„æ—¶å€™ï¼Œä½¿ç”¨å¸ƒéš†è¿‡æ»¤å™¨å‘ç°ä¸åœ¨é›†åˆä¸­ï¼Œå°±ç›´æ¥ä¸¢å¼ƒï¼Œä¸å†å¯¹æŒä¹…å±‚æŸ¥è¯¢ã€‚</code></pre><p>1.2 ç¼“å­˜ç©ºå¯¹è±¡</p><pre><code class="hljs erlang">å½“å­˜å‚¨å±‚ä¸å‘½ä¸­åï¼Œå³ä½¿è¿”å›çš„ç©ºå¯¹è±¡ä¹Ÿå°†å…¶ç¼“å­˜èµ·æ¥ï¼ŒåŒæ—¶ä¼šè®¾ç½®ä¸€ä¸ªè¿‡æœŸæ—¶é—´ï¼Œä¹‹åå†è®¿é—®è¿™ä¸ªæ•°æ®å°†ä¼šä»ç¼“å­˜ä¸­è·å–ï¼Œä¿æŠ¤äº†åç«¯æ•°æ®æºï¼›æ³¨æ„è®¾ç½®keyçš„è¿‡æœŸæ—¶é—´.</code></pre><p><img src="/images/redis/1589366209279.png"></p><pre><code class="hljs plain">ä½†æ˜¯è¿™ç§æ–¹æ³•ä¼šå­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼šå³ä½¿å¯¹ç©ºå€¼è®¾ç½®äº†è¿‡æœŸæ—¶é—´ï¼Œè¿˜æ˜¯ä¼šå­˜åœ¨ç¼“å­˜å±‚å’Œå­˜å‚¨å±‚çš„æ•°æ®ä¼šæœ‰ä¸€æ®µæ—¶é—´çª—å£çš„ä¸ä¸€è‡´ï¼Œè¿™å¯¹äºéœ€è¦ä¿æŒä¸€è‡´æ€§çš„ä¸šåŠ¡ä¼šæœ‰å½±å“ã€‚</code></pre><p>1.3 å®æ–½ç›‘æ§</p><pre><code class="hljs erlang">ç›‘æ§å‘½ä¸­ç‡(ä¸šåŠ¡æ­£å¸¸èŒƒå›´æ—¶,é€šå¸¸ä¼šæœ‰ä¸€ä¸ªæ³¢åŠ¨å€¼),æ ¹æ®ä¸åŒçš„æƒ…å†µ,è®¾ç½®é»‘åå•.</code></pre><h4 id="ç¼“å­˜é›ªå´©"><a href="#ç¼“å­˜é›ªå´©" class="headerlink" title="ç¼“å­˜é›ªå´©"></a>ç¼“å­˜é›ªå´©</h4><pre><code class="hljs angelscript">ç¼“å­˜é›ªå´©æ˜¯æŒ‡ï¼Œç¼“å­˜å±‚å‡ºç°äº†é”™è¯¯ï¼Œä¸èƒ½æ­£å¸¸å·¥ä½œäº†ã€‚äºæ˜¯æ‰€æœ‰çš„è¯·æ±‚éƒ½ä¼šè¾¾åˆ°å­˜å‚¨å±‚ï¼Œå­˜å‚¨å±‚çš„è°ƒç”¨é‡ä¼šæš´å¢ï¼Œé€ æˆå­˜å‚¨å±‚ä¹Ÿä¼šæŒ‚æ‰çš„æƒ…å†µã€‚ç»å¸¸å‡ºç°çš„æƒ…å†µæ˜¯<span class="hljs-number">408</span>,<span class="hljs-number">500</span>çš„é”™è¯¯é¡µé¢.</code></pre><p><img src="/images/redis/1589366273686.png"></p><pre><code class="hljs lsl"><span class="hljs-number">2</span>ã€è§£å†³æ–¹æ¡ˆï¼ˆ<span class="hljs-number">1</span>ï¼‰redisé«˜å¯ç”¨è¿™ä¸ªæ€æƒ³çš„å«ä¹‰æ˜¯ï¼Œæ—¢ç„¶redisæœ‰å¯èƒ½æŒ‚æ‰ï¼Œé‚£æˆ‘å¤šå¢è®¾å‡ å°redisï¼Œè¿™æ ·ä¸€å°æŒ‚æ‰ä¹‹åå…¶ä»–çš„è¿˜å¯ä»¥ç»§ç»­å·¥ä½œï¼Œå…¶å®å°±æ˜¯æ­å»ºçš„é›†ç¾¤ã€‚ï¼ˆ<span class="hljs-number">2</span>ï¼‰é™æµé™çº§è¿™ä¸ªè§£å†³æ–¹æ¡ˆçš„æ€æƒ³æ˜¯ï¼Œåœ¨ç¼“å­˜å¤±æ•ˆåï¼Œé€šè¿‡åŠ é”æˆ–è€…é˜Ÿåˆ—æ¥æ§åˆ¶è¯»æ•°æ®åº“å†™ç¼“å­˜çš„çº¿ç¨‹æ•°é‡ã€‚æ¯”å¦‚å¯¹æŸä¸ª<span class="hljs-type">key</span>åªå…è®¸ä¸€ä¸ªçº¿ç¨‹æŸ¥è¯¢æ•°æ®å’Œå†™ç¼“å­˜ï¼Œå…¶ä»–çº¿ç¨‹ç­‰å¾…ã€‚ï¼ˆ<span class="hljs-number">3</span>ï¼‰æ•°æ®é¢„çƒ­ åœ¨å³å°†å‘ç”Ÿå¤§å¹¶å‘è®¿é—®å‰æ‰‹åŠ¨è§¦å‘åŠ è½½ç¼“å­˜ä¸åŒçš„<span class="hljs-type">key</span>ï¼Œè®¾ç½®ä¸åŒçš„è¿‡æœŸæ—¶é—´ï¼Œè®©ç¼“å­˜å¤±æ•ˆçš„æ—¶é—´ç‚¹å°½é‡å‡åŒ€ã€‚</code></pre><h4 id="ç¼“å­˜å‡»ç©¿"><a href="#ç¼“å­˜å‡»ç©¿" class="headerlink" title="ç¼“å­˜å‡»ç©¿"></a>ç¼“å­˜å‡»ç©¿</h4><pre><code class="hljs angelscript">  ç¼“å­˜å‡»ç©¿æ˜¯åœ¨é«˜å¹¶å‘çš„æ¡ä»¶ä¸‹è¯»å–ç¼“å­˜æ•°æ®ï¼Œå¤šç”¨æˆ·åŒæ—¶è¯·æ±‚åŒä¸€ä¸ªç¼“å­˜æ•°æ®ï¼Œå¦‚æœç¼“å­˜ä¸­æ²¡æœ‰è¿™æ¡æ•°æ®ï¼Œé‚£ä¹ˆè¿™äº›ç”¨æˆ·åˆä¼šåŒæ—¶å»æ•°æ®åº“ä¸­æŸ¥è¯¢è¿™æ¡æ•°æ®ï¼Œæµªè´¹äº†ç³»ç»Ÿèµ„æºï¼Œæœ‰æ‚–äºç¼“å­˜æ•°æ®çš„åˆè¡·ï¼Œä¸¥é‡çš„è¯å¯èƒ½ä¼šé€ æˆæœåŠ¡å™¨å®•æœºçš„é£é™©ã€‚  è§£å†³æ–¹æ¡ˆï¼š   <span class="hljs-number">1</span>ï¼‰.ä½¿ç”¨åŒæ­¥é” synchronized å…³é”®å­—ï¼Œä¿®é¥°åœ¨è·å–ç¼“å­˜çš„æ–¹æ³•é‡Œé¢ï¼Œä¿è¯åœ¨å¤šç”¨æˆ·åŒæ—¶è¯·æ±‚æ¡ä»¶ä¸‹ï¼Œåªæœ‰ç¬¬ä¸€ä¸ªè¿›å…¥çš„çº¿ç¨‹å»åˆ¤æ–­æ˜¯å¦è¦æŸ¥è¯¢æ•°æ®åº“å¹¶å­˜å…¥ç¼“å­˜ï¼Œå…¶ä»–çº¿ç¨‹åªéœ€åœ¨ç¬¬ä¸€ä¸ªçº¿ç¨‹ç»“æŸåï¼Œä»ç¼“å­˜ä¸­è¯»å–æ•°æ®å³å¯ï¼Œæ— éœ€å†æŸ¥è¯¢æ•°æ®åº“ã€‚ä¸Šé¢æ˜¯å¯¹ç¼“å­˜ç©¿é€çš„å†æ¬¡ä¼˜åŒ–ï¼ŒåŠ å…¥çº¿ç¨‹åŒæ­¥é”Â ä»¥åŠ åŒé‡æ£€æŸ¥é”.åŒé‡æ£€æŸ¥é”ï¼š<span class="hljs-number">1.</span>é¿å…å½“ç¼“å­˜æ•°æ®æ²¡æœ‰å¤±æ•ˆæ—¶ï¼Œå…¶ä»–çº¿ç¨‹æ’é˜Ÿç­‰å¾…ã€‚Â         Â <span class="hljs-number">2.</span>å½“ç¬¬ä¸€ä¸ªçº¿ç¨‹ä»æ•°æ®åº“ä¸­è·å–åˆ°æ•°æ®å¹¶å­˜å…¥ç¼“å­˜ä¸­æ—¶ï¼Œå…¶ä»–çº¿ç¨‹ç›´æ¥ä»ç¼“å­˜è·å–æ•°æ®å³å¯ã€‚<span class="hljs-number">2</span>)ä¸è®¾ç½®ç¼“å­˜æ—¶é—´ï¼Œç”±åå°åˆ›å»ºå®šæ—¶ä»»åŠ¡å»ç»´æŠ¤è¿™éƒ¨åˆ†ç¼“å­˜æ•°æ®ã€‚è¿™ç§æ–¹æ³•è¯·æ±‚æ—¶ç›´æ¥ä»ç¼“å­˜ä¸­è·å–æ•°æ®ï¼Œæ— éœ€å†åˆ¤æ–­æ˜¯å¦ä»æ•°æ®åº“ä¸­è·å–ï¼Œå®šæ—¶ä»»åŠ¡ä¹Ÿå¯åœ¨è¯·æ±‚è¾ƒå°‘çš„æ—¶é—´æ®µåˆ†æ‰¹æ›´æ–°ç¼“å­˜æ•°æ®ã€‚Â Â Â Â å½“ç„¶ä»£ç é‡ã€ä»£ç å¤æ‚åº¦å¢å¤§ï¼Œåˆ†æ‰¹æ›´æ–°ä»£è¡¨éœ€è¦å¤šä¸ªå®šæ—¶ä»»åŠ¡å»ç»´æŠ¤ç¼“å­˜æ•°æ®ï¼ŒåŒæ—¶æ›´æ–°æœ‰å¯èƒ½ä¼šé€ æˆç¼“å­˜é›ªå´©çš„æƒ…å†µã€‚</code></pre><h4 id="æ•°æ®é¢„çƒ­"><a href="#æ•°æ®é¢„çƒ­" class="headerlink" title="æ•°æ®é¢„çƒ­"></a>æ•°æ®é¢„çƒ­</h4><pre><code>ç¼“å­˜é¢„çƒ­:  æå‰å°†ç›¸å…³çš„ç¼“å­˜æ•°æ®ç›´æ¥åŠ è½½åˆ°ç¼“å­˜ç³»ç»Ÿ,é¿å…ç”¨æˆ·åœ¨è¯·æ±‚çš„æ—¶å€™,å…ˆæŸ¥è¯¢æ•°æ®åº“,ç„¶åå†å°†æ•°æ®ç¼“å­˜çš„é—®é¢˜.é—®é¢˜: 1.ä¸»ä»ä¹‹é—´æ•°æ®ååé‡å¤§ 2.æ•°æ®åŒæ­¥æ“ä½œé¢‘åº¦é«˜æ–¹æ¡ˆ: 1.ç»Ÿè®¡è®¿é—®é¢‘åº¦è¾ƒé«˜çš„çƒ­ç‚¹æ•°æ®,æ¯”å¦‚ç›´æ¥å†™ä¸ªç¼“å­˜åˆ·æ–°é¡µé¢ï¼Œä¸Šçº¿æ—¶æ‰‹å·¥æ“ä½œä¸‹ 2.æ•°æ®é‡ä¸å¤§ï¼Œå¯ä»¥åœ¨é¡¹ç›®å¯åŠ¨çš„æ—¶å€™è‡ªåŠ¨è¿›è¡ŒåŠ è½½ 3.å®šæ—¶åˆ·æ–°ç¼“å­˜</code></pre>]]></content>
    
    
    <categories>
      
      <category>Datebase</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Datebase</tag>
      
      <tag>Redis</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€MySQLã€‘å­¦ä¹ ç¬”è®°</title>
    <link href="/2021/03/21/mysql/"/>
    <url>/2021/03/21/mysql/</url>
    
    <content type="html"><![CDATA[<blockquote><p>æœ€æµè¡Œçš„<a href="https://baike.baidu.com/item/%E5%85%B3%E7%B3%BB%E5%9E%8B%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/696511">å…³ç³»å‹æ•°æ®åº“ç®¡ç†ç³»ç»Ÿ</a>ä¹‹ä¸€ã€‚åœ¨ WEB åº”ç”¨æ–¹é¢ï¼Œæ˜¯æœ€å¥½çš„ <a href="https://baike.baidu.com/item/RDBMS/1048260">RDBMS</a>ã€‚<a id="more"></a></p></blockquote><p><img src="/images/mysql/top.jpg"></p><h3 id="ç£ç›˜æ–‡ä»¶"><a href="#ç£ç›˜æ–‡ä»¶" class="headerlink" title="ç£ç›˜æ–‡ä»¶"></a><strong>ç£ç›˜æ–‡ä»¶</strong></h3><p><img src="/images/mysql/logfile.png"></p><p>MySQLçš„æ–‡ä»¶ä¸»è¦åˆ†ä¸ºä¸¤å¤§ç±»ï¼ŒMySQlæœåŠ¡çš„æ–‡ä»¶å’Œå­˜å‚¨å¼•æ“çš„æ–‡ä»¶ï¼Œä¸»è¦åˆ†ä¸ºä¸‰ç±»ï¼š</p><ul><li>æ—¥å¿—æ–‡ä»¶ï¼šMySQLå®ä¾‹å†™å…¥çš„å„ç§æ—¥å¿—æ–‡ä»¶ã€‚</li><li>è¡¨ç»“æ„æ–‡ä»¶ï¼šå­˜æ”¾è¡¨ç»“æ„å®šä¹‰çš„æ–‡ä»¶ï¼Œ.frmåç¼€æ–‡ä»¶ï¼Œä¸å­˜å‚¨å¼•æ“æ— å…³ã€‚</li><li>å­˜å‚¨å¼•æ“æ•°æ®æ–‡ä»¶ï¼šå­˜å‚¨å¼•æ“è´Ÿè´£å¯¹è¡¨ä¸­çš„æ•°æ®è¿›è¡Œè¯»å–å’Œå†™å…¥ï¼Œæ¯ä¸ªå­˜å‚¨å¼•æ“ä»¥è‡ªå·±çš„æ–¹å¼æ¥ä¿å­˜è¡¨ä¸­çš„æ•°æ®ï¼Œåœ¨ä¸åŒçš„å­˜å‚¨å¼•æ“ä¸­æ•°æ®å­˜æ”¾çš„æ–¹å¼ä¸€èˆ¬ä¸åŒã€‚ </li></ul><h4 id="æ—¥å¿—æ–‡ä»¶"><a href="#æ—¥å¿—æ–‡ä»¶" class="headerlink" title="æ—¥å¿—æ–‡ä»¶"></a>æ—¥å¿—æ–‡ä»¶</h4><p>è®°å½•æ•°æ®åº“æ“ä½œä¿¡æ¯å’Œé”™è¯¯ä¿¡æ¯ï¼Œä¸»è¦åŒ…æ‹¬<em>é”™è¯¯æ—¥å¿—</em>ï¼Œ<em>äºŒè¿›åˆ¶æ—¥å¿—</em>ï¼Œ <em>æŸ¥è¯¢æ—¥å¿—</em>ï¼Œ <em>æ…¢æŸ¥è¯¢æ—¥å¿—</em>ï¼Œ <em>ä¸­ç»§æ—¥å¿—</em>ç­‰ã€‚</p><p>InnoBDç›¸å…³çš„æ—¥å¿—æœ‰ï¼šäº‹åŠ¡é‡åšæ—¥å¿—ï¼ˆredo logï¼‰å’Œå›æ»šæ—¥å¿—ï¼ˆundo logï¼‰</p><p>æŸ¥çœ‹å‘½ä»¤ï¼š</p><pre><code class="hljs mysql">show variables like &#39;log_%&#39;;</code></pre><h4 id="é”™è¯¯æ—¥å¿—ï¼ˆerrorlogï¼‰"><a href="#é”™è¯¯æ—¥å¿—ï¼ˆerrorlogï¼‰" class="headerlink" title="é”™è¯¯æ—¥å¿—ï¼ˆerrorlogï¼‰"></a>é”™è¯¯æ—¥å¿—ï¼ˆerrorlogï¼‰</h4><p>â€‹        ç”¨æ¥è®°å½• MySQL æœåŠ¡å™¨è¿è¡Œè¿‡ç¨‹ä¸­é‡åˆ°çš„æ‰€æœ‰ä¸¥é‡é”™è¯¯ä¿¡æ¯ä»¥åŠMySQLæ¯æ¬¡å¯åŠ¨å’Œå…³é—­çš„è¯¦ç»†ä¿¡æ¯ã€‚æ¯”å¦‚ï¼Œæ— æ³•åŠ è½½ MySQL æ•°æ®åº“çš„æ•°æ®æ–‡ä»¶ï¼Œæˆ–æƒé™ä¸æ­£ç¡®ç­‰éƒ½ä¼šè¢«è®°å½•åœ¨æ­¤ï¼Œè¿˜æœ‰å¤åˆ¶ç¯å¢ƒä¸‹ï¼Œä»æœåŠ¡å™¨è¿›ç¨‹çš„ä¿¡æ¯ä¹Ÿä¼šè¢«è®°å½•è¿›é”™è¯¯æ—¥å¿—ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œé”™è¯¯æ—¥å¿—æ˜¯å¼€å¯çš„ï¼Œä»5.5.7å¼€å§‹æ— æ³•å…³é—­é”™è¯¯æ—¥å¿—ã€‚</p><p>â€‹      é”™è¯¯æ—¥å¿—æ˜¯å­˜å‚¨åœ¨æ•°æ®åº“çš„æ•°æ®æ–‡ä»¶ç›®å½•ä¸­ï¼Œåç§°ä¸º hostname.errï¼Œå…¶ä¸­ hostname ä¸ºæœåŠ¡å™¨ä¸»æœºåã€‚åœ¨ MySQL 5.5.7 ä¹‹å‰ï¼Œæ•°æ®åº“ç®¡ç†å‘˜å¯ä»¥åˆ é™¤å¾ˆé•¿æ—¶é—´ä¹‹å‰çš„é”™è¯¯æ—¥å¿—ï¼Œä»¥èŠ‚çœæœåŠ¡å™¨ä¸Šçš„ç¡¬ç›˜ç©ºé—´ï¼Œ MySQL 5.5.7 ä¹‹åï¼ŒæœåŠ¡å™¨å°†å…³é—­æ­¤é¡¹åŠŸèƒ½ï¼Œåªèƒ½ä½¿ç”¨é‡å‘½ååŸæ¥çš„é”™è¯¯æ—¥å¿—æ–‡ä»¶ï¼Œæ‰‹åŠ¨å†²æ´—æ—¥å¿—åˆ›å»ºä¸€ä¸ªæ–°çš„ï¼Œå‘½ä»¤ä¸ºï¼š</p><p><code>mv hostname.err  hostname.err.old mysqladmin flush-logs</code></p><p>é»˜è®¤çš„é”™è¯¯æ—¥å¿—åç§°ä¸º hostname.errï¼Œå…¶ä¸­ hostname ä¸ºæœåŠ¡å™¨ä¸»æœºåã€‚</p><p>é”™è¯¯æ—¥å¿—æ‰€è®°å½•çš„ä¿¡æ¯æ˜¯å¯ä»¥é€šè¿‡log-errorå’Œlog-warningsæ¥å®šä¹‰çš„ï¼Œå…¶ä¸­log-erroræ˜¯å®šä¹‰æ˜¯å¦å¯ç”¨é”™è¯¯æ—¥å¿—åŠŸèƒ½å’Œé”™è¯¯æ—¥å¿—çš„å­˜å‚¨ä½ç½®ï¼Œlog-warningsæ˜¯å®šä¹‰æ˜¯å¦å°†è­¦å‘Šä¿¡æ¯ä¹Ÿå®šä¹‰è‡³é”™è¯¯æ—¥å¿—ä¸­ã€‚</p><pre><code class="hljs zsh"><span class="hljs-comment"># å¯ä»¥ç›´æ¥å®šä¹‰ä¸ºæ–‡ä»¶è·¯å¾„ä¹Ÿå¯ä»¥ä¸ºON|OFF</span>log_error=/var/<span class="hljs-built_in">log</span>/mysqld.log<span class="hljs-comment"># å®šä¹‰è­¦å‘Šä¿¡æ¯ï¼Œé»˜è®¤ä¸ºå¼€å¯çŠ¶æ€ï¼Œé»˜è®¤2ï¼Œ å…³é—­è®¾ç½®ä¸º0</span>log_warnings=2</code></pre><p><code>log_warnings=0</code>,ä¸è®°å½•è­¦å‘Šä¿¡æ¯ï¼Œåªè®°å½•é”™è¯¯ä¿¡æ¯</p><p><code>log_warnings=1</code>,è®°å½•è­¦å‘Šä¿¡æ¯ï¼Œé”™è¯¯æ—¥å¿—åŒ…å«é”™è¯¯ä¿¡æ¯å’Œè­¦å‘Šä¿¡æ¯</p><p><code>log_warnings&gt;1</code>,è®°å½•è­¦å‘Šä¿¡æ¯ï¼Œè®¿é—®æ—¶æŠ¥é”™å’Œè®¿é—®æ‹’æ¥çš„è¿æ¥é”™è¯¯ä¿¡æ¯ä¹Ÿä¼šè¢«è®°å½•åˆ°é”™è¯¯æ—¥å¿—ä¸­</p><p>MySQL 5.7.2ä¹‹å‰é»˜è®¤ä¸º1ï¼Œ 5.7.2èµ·é»˜è®¤å€¼ä¸º2ã€‚</p><h4 id="æŸ¥è¯¢æ—¥å¿—"><a href="#æŸ¥è¯¢æ—¥å¿—" class="headerlink" title="æŸ¥è¯¢æ—¥å¿—"></a>æŸ¥è¯¢æ—¥å¿—</h4><p>æŸ¥è¯¢æ—¥å¿—åœ¨ MySQL ä¸­è¢«ç§°ä¸º general log(é€šç”¨æ—¥å¿—)ï¼ŒæŸ¥è¯¢æ—¥å¿—é‡Œé¢è®°å½•äº†<strong>æ•°æ®åº“æ‰§è¡Œçš„æ‰€æœ‰å‘½ä»¤</strong>ã€‚ä¸ç®¡è¯­å¥æ˜¯å¦æ­£ç¡®ï¼Œéƒ½ä¼šè¢«è®°å½•ï¼Œå…·ä½“åŸå› å¦‚ä¸‹:</p><ul><li><p>insert æŸ¥è¯¢ä¸ºäº†é¿å…æ•°æ®å†²çªï¼Œå¦‚æœæ­¤å‰æ’å…¥è¿‡æ•°æ®ï¼Œå½“å‰æ’å…¥çš„æ•°æ®å¦‚æœè·Ÿä¸»é”®æˆ–å”¯ä¸€é”®çš„æ•°æ®é‡å¤è‚¯å®šä¼šæŠ¥é”™ï¼›</p></li><li><p>update æ—¶ä¹Ÿä¼šæŸ¥è¯¢å› ä¸ºæ›´æ–°çš„æ—¶å€™å¾ˆå¯èƒ½ä¼šæ›´æ–°æŸä¸€å—æ•°æ®ï¼›</p></li><li><p>delete æŸ¥è¯¢ï¼Œåªåˆ é™¤ç¬¦åˆæ¡ä»¶çš„æ•°æ®ï¼›</p></li></ul><p>å› æ­¤éƒ½ä¼šäº§ç”Ÿæ—¥å¿—ï¼Œåœ¨å¹¶å‘æ“ä½œéå¸¸å¤šçš„åœºæ™¯ä¸‹ï¼ŒæŸ¥è¯¢ä¿¡æ¯ä¼šéå¸¸å¤šï¼Œé‚£ä¹ˆå¦‚æœéƒ½è®°å½•ä¸‹æ¥ä¼šå¯¼è‡´ IO éå¸¸å¤§ï¼Œå½±å“ MySQL æ€§èƒ½ã€‚å› æ­¤å¦‚æœä¸æ˜¯åœ¨è°ƒè¯•ç¯å¢ƒä¸‹ï¼Œæ˜¯ä¸å»ºè®®å¼€å¯æŸ¥è¯¢æ—¥å¿—åŠŸèƒ½çš„ã€‚</p><p>æŸ¥è¯¢æ—¥å¿—çš„å¼€å¯æœ‰åŠ©äºå¸®åŠ©æˆ‘ä»¬åˆ†æå“ªäº›è¯­å¥æ‰§è¡Œå¯†é›†ï¼Œæ‰§è¡Œå¯†é›†çš„ select è¯­å¥å¯¹åº”çš„æ•°æ®æ˜¯å¦èƒ½å¤Ÿè¢«ç¼“å­˜ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥å¸®åŠ©æˆ‘ä»¬åˆ†æé—®é¢˜ã€‚æ‰€ä»¥ï¼Œå¯ä»¥æ ¹æ®å®é™…æƒ…å†µæ¥å†³å®šæ˜¯å¦å¼€å¯æŸ¥è¯¢æ—¥å¿—ã€‚</p><p>æŸ¥è¯¢æ—¥å¿—æ¨¡å¼æ˜¯å…³é—­çš„ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤å¼€å¯æŸ¥è¯¢æ—¥å¿—ï¼š</p><p><code>set global generallog=1 set global logoutput=&#39;table&#39;;</code></p><p><code>general_log=1</code> ä¸ºå¼€å¯æŸ¥è¯¢æ—¥å¿—ï¼Œ0 ä¸ºå…³é—­æŸ¥è¯¢æ—¥å¿—ï¼Œè¿™ä¸ªè®¾ç½®å‘½ä»¤å³æ—¶ç”Ÿæ•ˆï¼Œä¸ç”¨é‡å¯ MySQL æœåŠ¡å™¨ã€‚</p><h4 id="æ…¢æŸ¥è¯¢æ—¥å¿—"><a href="#æ…¢æŸ¥è¯¢æ—¥å¿—" class="headerlink" title="æ…¢æŸ¥è¯¢æ—¥å¿—"></a>æ…¢æŸ¥è¯¢æ—¥å¿—</h4><p>æ…¢æŸ¥è¯¢ä¼šå¯¼è‡´ CPUã€IOPSã€å†…å­˜æ¶ˆè€—è¿‡é«˜ï¼Œå½“æ•°æ®åº“é‡åˆ°æ€§èƒ½ç“¶é¢ˆæ—¶ï¼Œå¤§éƒ¨åˆ†æ—¶é—´éƒ½æ˜¯ç”±äºæ…¢æŸ¥è¯¢å¯¼è‡´çš„ã€‚å¼€å¯æ…¢æŸ¥è¯¢æ—¥å¿—ï¼Œå¯ä»¥è®© MySQL è®°å½•ä¸‹æŸ¥è¯¢è¶…è¿‡æŒ‡å®šæ—¶é—´çš„è¯­å¥ï¼Œä¹‹åè¿ç»´äººå‘˜é€šè¿‡å®šä½åˆ†æï¼Œèƒ½å¤Ÿå¾ˆå¥½çš„ä¼˜åŒ–æ•°æ®åº“æ€§èƒ½ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæ…¢æŸ¥è¯¢æ—¥å¿—æ˜¯ä¸å¼€å¯çš„ï¼Œåªæœ‰æ‰‹åŠ¨å¼€å¯äº†ï¼Œæ…¢æŸ¥è¯¢æ‰ä¼šè¢«è®°å½•åˆ°æ…¢æŸ¥è¯¢æ—¥å¿—ä¸­ã€‚ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤è®°å½•å½“å‰æ•°æ®åº“çš„æ…¢æŸ¥è¯¢è¯­å¥ï¼š</p><pre><code class="hljs zsh"><span class="hljs-comment"># å¼€å¯æ…¢æŸ¥è¯¢æ—¥å¿—</span>slowquerylog=ON<span class="hljs-comment"># æ…¢æŸ¥è¯¢é˜ˆå€¼ï¼Œå•ä½ç§’</span>long_query_time=10<span class="hljs-comment"># æ…¢æŸ¥è¯¢æ—¥å¿—æ–‡ä»¶å</span><span class="hljs-comment"># æ²¡æœ‰æŒ‡å®šï¼Œé»˜è®¤åä¸º hostname-slow.log hostnameä¸ºä¸»æœºå</span><span class="hljs-comment"># éœ€è¦æŒ‡å®šï¼Œä¸æ˜¯ç»å¯¹è·¯å¾„</span>slow_query_files=file_name</code></pre><p>ä½¿ç”¨å‘½ä»¤ <code>set global slowquerylog=&#39;ON&#39;</code> å¼€å¯æ…¢æŸ¥è¯¢æ—¥å¿—ï¼Œåªæ˜¯å¯¹å½“å‰æ•°æ®åº“æœ‰æ•ˆï¼Œå¦‚æœ MySQL æ•°æ®åº“é‡å¯åå°±ä¼šå¤±æ•ˆã€‚æ‰€ä»¥å¦‚æœè¦æ°¸ä¹…ç”Ÿæ•ˆï¼Œå°±è¦ä¿®æ”¹é…ç½®æ–‡ä»¶<code> my.cnf</code>ï¼Œè®¾ç½®<code> slowquerylog=ON</code> å¹¶é‡å¯ MySQL æœåŠ¡å™¨ã€‚</p><h4 id="äºŒè¿›åˆ¶æ—¥å¿—ï¼ˆbin-logï¼‰"><a href="#äºŒè¿›åˆ¶æ—¥å¿—ï¼ˆbin-logï¼‰" class="headerlink" title="äºŒè¿›åˆ¶æ—¥å¿—ï¼ˆbin logï¼‰"></a>äºŒè¿›åˆ¶æ—¥å¿—ï¼ˆbin logï¼‰</h4><p>é€šè¿‡ä»¥ä¸‹å‘½ä»¤æ¥æŸ¥è¯¢ binlog æ˜¯å¦å¼€å¯ï¼š</p><p><code>show variables like &#39;log_%&#39;;</code></p><p><img src="/images/mysql/binlog.png"> </p><p>é»˜è®¤æ˜¯å…³é—­çš„ã€‚</p><pre><code class="hljs zsh">log-bin=OFF</code></pre><p>éœ€è¦é€šè¿‡é…ç½®è¿›è¡Œå¼€å¯</p><pre><code class="hljs zsh">log-bin=mysql-bin</code></pre><p>å…¶ä¸­<code>mysql-bin</code>æ˜¯<code>bin log</code>æ—¥å¿—æ–‡ä»¶çš„æ–‡ä»¶åå‰ç¼€ï¼Œ<code>bin log</code>æ—¥å¿—æ–‡ä»¶çš„å®Œæ•´åç§°ï¼š<code>mysql-bin-000001.log</code></p><p><code>bin log</code>æ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œä¸»è¦è®°å½•æ•°æ®åº“æ‰€æœ‰çš„<code>DDL</code>è¯­å¥å’Œ<code>DML</code>è¯­å¥ï¼Œä½†ä¸åŒ…å«<code>SELECTã€SHOW</code>è¯­å¥å†…å®¹ã€‚<code>DDL</code>è¯­å¥ç›´æ¥è®°å½•åˆ°<code>bin log</code>æ—¥å¿—ä¸­ï¼Œ<code>DML</code>è¯­å¥å¿…é¡»é€šè¿‡äº‹åŠ¡æäº¤æ‰èƒ½è®°å½•åˆ°<code>bin log</code>æ—¥å¿—ä¸­ã€‚<code>bin log</code> ä¸­è®°å½•äº†å¯¹ MySQL æ•°æ®åº“æ‰§è¡Œæ›´æ”¹çš„æ‰€æœ‰æ“ä½œï¼Œå¹¶ä¸”è®°å½•äº†è¯­å¥å‘ç”Ÿæ—¶é—´ã€æ‰§è¡Œæ—¶é•¿ã€æ“ä½œæ•°æ®ç­‰å…¶å®ƒé¢å¤–ä¿¡æ¯ã€‚</p><p><code>bin log</code>ä¸»è¦ç”¨äºå®ç°mysql<strong>ä¸»ä»å¤åˆ¶ã€æ•°æ®å¤‡ä»½ã€æ•°æ®æ¢å¤</strong>ã€‚</p><ul><li><p>æ¢å¤ï¼ˆ<code>recovery</code>ï¼‰ï¼šæŸäº›æ•°æ®çš„æ¢å¤éœ€è¦äºŒè¿›åˆ¶æ—¥å¿—ã€‚æ¯”å¦‚ï¼Œåœ¨ä¸€ä¸ªæ•°æ®åº“å…¨å¤‡æ–‡ä»¶æ¢å¤åï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡äºŒè¿›åˆ¶æ—¥å¿—è¿›è¡Œ <code>point-in-time</code> çš„æ¢å¤ï¼›</p></li><li><p>å¤åˆ¶ï¼ˆ<code>replication</code>ï¼‰ï¼šå…¶åŸç†ä¸æ¢å¤ç±»ä¼¼ï¼Œé€šè¿‡å¤åˆ¶å’Œæ‰§è¡ŒäºŒè¿›åˆ¶æ—¥å¿—ä½¿ä¸€å°è¿œç¨‹çš„MySQLæ•°æ®åº“ï¼ˆä¸€èˆ¬ç§°ä¸º <code>slave</code> æˆ–è€… <code>standby</code>ï¼‰ä¸ä¸€å° MySQL æ•°æ®åº“ï¼ˆä¸€èˆ¬ç§°ä¸º <code>master</code> æˆ–è€… <code>primary</code>ï¼‰è¿›è¡Œå®æ—¶åŒæ­¥ï¼›</p></li><li><p>å®¡è®¡ï¼ˆ<code>audit</code>ï¼‰ï¼šç”¨æˆ·å¯ä»¥é€šè¿‡äºŒè¿›åˆ¶æ—¥å¿—ä¸­çš„ä¿¡æ¯æ¥è¿›è¡Œå®¡è®¡ï¼Œåˆ¤æ–­æ˜¯å¦æœ‰å¯¹æ•°æ®åº“è¿›è¡Œæ³¨å…¥æ”»å‡»ã€‚</p></li></ul><p>é™¤äº†ä¸Šé¢ä»‹ç»çš„å‡ ä¸ªä½œç”¨å¤–ï¼Œ<code>binlog</code> å¯¹äºäº‹åŠ¡å­˜å‚¨å¼•æ“çš„å´©æºƒæ¢å¤ä¹Ÿæœ‰éå¸¸é‡è¦çš„ä½œç”¨ï¼Œåœ¨å¼€å¯ <code>binlog</code> çš„æƒ…å†µä¸‹ï¼Œä¸ºäº†ä¿è¯ <code>binlog</code> ä¸ <code>redo</code> çš„ä¸€è‡´æ€§ï¼ŒMySQL å°†é‡‡ç”¨äº‹åŠ¡çš„ä¸¤é˜¶æ®µæäº¤åè®®ã€‚å½“ MySQL ç³»ç»Ÿå‘ç”Ÿå´©æºƒæ—¶ï¼Œäº‹åŠ¡åœ¨å­˜å‚¨å¼•æ“å†…éƒ¨çš„çŠ¶æ€å¯èƒ½ä¸º <code>prepared</code>ï¼ˆå‡†å¤‡çŠ¶æ€ï¼‰å’Œ <code>commit</code>ï¼ˆæäº¤çŠ¶æ€ï¼‰ä¸¤ç§ï¼Œå¯¹äº <code>prepared</code> çŠ¶æ€çš„äº‹åŠ¡ï¼Œæ˜¯è¿›è¡Œæäº¤æ“ä½œè¿˜æ˜¯è¿›è¡Œå›æ»šæ“ä½œï¼Œè¿™æ—¶éœ€è¦å‚è€ƒ<code> binlog</code>ï¼Œå¦‚æœäº‹åŠ¡åœ¨ <code>binlog</code> ä¸­å­˜åœ¨ï¼Œé‚£ä¹ˆå°†å…¶æäº¤ï¼›å¦‚æœä¸åœ¨ <code>binlog</code> ä¸­å­˜åœ¨ï¼Œé‚£ä¹ˆå°†å…¶å›æ»šï¼Œè¿™æ ·å°±ä¿è¯äº†æ•°æ®åœ¨ä¸»åº“å’Œä»åº“ä¹‹é—´çš„ä¸€è‡´æ€§ã€‚</p><p>binlog æ ¼å¼åˆ†ä¸º: STATEMENTã€ROW å’Œ MIXED ä¸‰ç§ï¼š</p><ul><li><p>STATEMENT æ ¼å¼çš„ binlog è®°å½•çš„æ˜¯æ•°æ®åº“ä¸Šæ‰§è¡Œçš„åŸç”Ÿ SQL è¯­å¥ã€‚è¿™ç§æ ¼å¼çš„ä¼˜ç‚¹æ˜¯ç®€å•ï¼Œç®€å•åœ°è®°å½•å’Œæ‰§è¡Œè¿™äº›è¯­å¥ï¼Œèƒ½å¤Ÿè®©ä¸»å¤‡ä¿æŒåŒæ­¥ï¼Œåœ¨ä¸»æœåŠ¡å™¨ä¸Šæ‰§è¡Œçš„ SQL è¯­å¥ï¼Œåœ¨ä»æœåŠ¡å™¨ä¸Šæ‰§è¡ŒåŒæ ·çš„è¯­å¥ã€‚å¦ä¸€ä¸ªå¥½å¤„æ˜¯äºŒè¿›åˆ¶æ—¥å¿—é‡Œçš„æ—¶é—´æ›´åŠ ç´§å‡‘ï¼Œæ‰€ä»¥ç›¸å¯¹è€Œè¨€ï¼ŒåŸºäºè¯­å¥çš„å¤åˆ¶æ¨¡å¼ä¸ä¼šä½¿ç”¨å¤ªå¤šå¸¦å®½ï¼ŒåŒæ—¶ä¹ŸèŠ‚çº¦ç£ç›˜ç©ºé—´ã€‚å¹¶ä¸”é€šè¿‡ mysqlbinlog å·¥å…·å®¹æ˜“è¯»æ‡‚å…¶ä¸­çš„å†…å®¹ã€‚ç¼ºç‚¹å°±æ˜¯åŒä¸€æ¡ SQL åœ¨ä¸»åº“å’Œä»åº“ä¸Šæ‰§è¡Œçš„æ—¶é—´å¯èƒ½ç¨å¾®æˆ–å¾ˆå¤§ä¸ç›¸åŒï¼Œå› æ­¤åœ¨ä¼ è¾“çš„äºŒè¿›åˆ¶æ—¥å¿—ä¸­ï¼Œé™¤äº†æŸ¥è¯¢è¯­å¥ï¼Œè¿˜åŒ…æ‹¬äº†ä¸€äº›å…ƒæ•°æ®ä¿¡æ¯ï¼Œå¦‚å½“å‰çš„æ—¶é—´æˆ³ã€‚å³ä¾¿å¦‚æ­¤ï¼Œè¿˜å­˜åœ¨ç€ä¸€äº›æ— æ³•è¢«æ­£ç¡®å¤åˆ¶çš„ SQLã€‚æ¯”å¦‚ï¼Œä½¿ç”¨ <code>INSERT INTO TB1 VALUE(CUURENT_DATE()) </code>è¿™ä¸€æ¡ä½¿ç”¨å‡½æ•°çš„è¯­å¥æ’å…¥çš„æ•°æ®å¤åˆ¶åˆ°å½“å‰ä»æœåŠ¡å™¨ä¸Šæ¥å°±ä¼šå‘ç”Ÿå˜åŒ–ï¼Œå­˜å‚¨è¿‡ç¨‹å’Œè§¦å‘å™¨åœ¨ä½¿ç”¨åŸºäºè¯­å¥çš„å¤åˆ¶æ¨¡å¼æ—¶ä¹Ÿå¯èƒ½å­˜åœ¨é—®é¢˜ï¼›å¦å¤–ä¸€ä¸ªé—®é¢˜å°±æ˜¯åŸºäºè¯­å¥çš„å¤åˆ¶å¿…é¡»æ˜¯ä¸²è¡ŒåŒ–çš„ï¼Œæ¯”å¦‚ï¼šInnoDB çš„ next-key é”ç­‰ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„å­˜å‚¨å¼•æ“éƒ½æ”¯æŒåŸºäºè¯­å¥çš„å¤åˆ¶ï¼›</p></li><li><p>ROW æ ¼å¼æ˜¯ä» MySQL 5.1 å¼€å§‹æ”¯æŒåŸºäºè¡Œçš„å¤åˆ¶ï¼Œä¹Ÿå°±æ˜¯åŸºäºæ•°æ®çš„å¤åˆ¶ï¼ŒåŸºäºè¡Œçš„æ›´æ”¹ã€‚è¿™ç§æ–¹å¼ä¼šå°†å®é™…æ•°æ®è®°å½•åœ¨äºŒè¿›åˆ¶æ—¥å¿—ä¸­ï¼Œå®ƒæœ‰å…¶è‡ªèº«çš„ä¸€äº›ä¼˜ç‚¹å’Œç¼ºç‚¹ï¼Œæœ€å¤§çš„å¥½å¤„æ˜¯å¯ä»¥æ­£ç¡®åœ°å¤åˆ¶æ¯ä¸€è¡Œæ•°æ®ï¼Œä¸€äº›è¯­å¥å¯ä»¥è¢«æ›´åŠ æœ‰æ•ˆåœ°å¤åˆ¶ï¼Œå¦å¤–å°±æ˜¯å‡ ä¹æ²¡æœ‰åŸºäºè¡Œçš„å¤åˆ¶æ¨¡å¼æ— æ³•å¤„ç†çš„åœºæ™¯ï¼Œå¯¹äºæ‰€æœ‰çš„ SQL æ„é€ ã€è§¦å‘å™¨ã€å­˜å‚¨è¿‡ç¨‹ç­‰éƒ½èƒ½æ­£ç¡®æ‰§è¡Œï¼›å®ƒçš„ç¼ºç‚¹å°±æ˜¯äºŒè¿›åˆ¶æ—¥å¿—å¯èƒ½ä¼šå¾ˆå¤§ï¼Œè€Œä¸”ä¸ç›´è§‚ï¼Œæ‰€ä»¥ï¼Œä½ ä¸èƒ½ä½¿ç”¨ mysqlbinlog æ¥æŸ¥çœ‹äºŒè¿›åˆ¶æ—¥å¿—ï¼Œä¹Ÿæ— æ³•é€šè¿‡çœ‹äºŒè¿›åˆ¶æ—¥å¿—åˆ¤æ–­å½“å‰æ‰§è¡Œåˆ°é‚£ä¸€æ¡ SQL è¯­å¥ã€‚ç°åœ¨å¯¹äº ROW æ ¼å¼çš„äºŒè¿›åˆ¶æ—¥å¿—åŸºæœ¬æ˜¯æ ‡é…äº†ï¼Œä¸»è¦æ˜¯å› ä¸ºå®ƒçš„ä¼˜åŠ¿è¿œè¿œå¤§äºç¼ºç‚¹ï¼Œå¹¶ä¸”ç”±äº ROW æ ¼å¼è®°å½•è¡Œæ•°æ®ï¼Œæ‰€ä»¥å¯ä»¥åŸºäºè¿™ç§æ¨¡å¼åšä¸€äº› DBA å·¥å…·ï¼Œæ¯”å¦‚æ•°æ®æ¢å¤ï¼Œä¸åŒæ•°æ®åº“ä¹‹é—´æ•°æ®åŒæ­¥ç­‰ï¼›</p></li><li><p>MIXED ä¹Ÿæ˜¯ MySQL é»˜è®¤ä½¿ç”¨çš„äºŒè¿›åˆ¶æ—¥å¿—è®°å½•æ–¹å¼ï¼Œä½† MIXED æ ¼å¼é»˜è®¤é‡‡ç”¨åŸºäºè¯­å¥çš„å¤åˆ¶ï¼Œä¸€æ—¦å‘ç°åŸºäºè¯­å¥çš„æ— æ³•ç²¾ç¡®çš„å¤åˆ¶æ—¶ï¼Œå°±ä¼šé‡‡ç”¨åŸºäºè¡Œçš„å¤åˆ¶ã€‚æ¯”å¦‚ç”¨åˆ° UUID()ã€USER()ã€CURRENTUSER()ã€ROWCOUNT() ç­‰æ— æ³•ç¡®å®šçš„å‡½æ•°ã€‚</p></li></ul><h4 id="å›æ»šæ—¥å¿—-undo-log"><a href="#å›æ»šæ—¥å¿—-undo-log" class="headerlink" title="å›æ»šæ—¥å¿—(undo log)"></a><strong>å›æ»šæ—¥å¿—(<code>undo log</code>)</strong></h4><p>ç”¨äºå­˜å‚¨æ—¥å¿—è¢«ä¿®æ”¹å‰çš„å€¼ï¼Œä»è€Œä¿è¯å¦‚æœä¿®æ”¹å‡ºç°å¼‚å¸¸ï¼Œå¯ä»¥ä½¿ç”¨ <code>undo log </code>æ—¥å¿—æ¥å®ç°å›æ»šæ“ä½œã€‚<code>undo log </code>å’Œ<code> redo log</code> è®°å½•ç‰©ç†æ—¥å¿—ä¸ä¸€æ ·ï¼Œå®ƒæ˜¯é€»è¾‘æ—¥å¿—ï¼Œå¯ä»¥è®¤ä¸ºå½“ <code>delete</code> ä¸€æ¡è®°å½•æ—¶ï¼Œ<code>undo log</code> ä¸­ä¼šè®°å½•ä¸€æ¡å¯¹åº”çš„<code> insert</code> è®°å½•ï¼Œåä¹‹äº¦ç„¶ï¼Œå½“ <code>update</code> ä¸€æ¡è®°å½•æ—¶ï¼Œå®ƒè®°å½•ä¸€æ¡å¯¹åº”ç›¸åçš„ <code>update</code> è®°å½•ï¼Œå½“æ‰§è¡Œ rollback æ—¶ï¼Œå°±å¯ä»¥ä» <code>undo log</code> ä¸­çš„é€»è¾‘è®°å½•è¯»å–åˆ°ç›¸åº”çš„å†…å®¹å¹¶è¿›è¡Œå›æ»šã€‚<code>undo log </code>é»˜è®¤å­˜æ”¾åœ¨å…±äº«è¡¨ç©ºé—´ä¸­ï¼Œåœ¨ <code>mySQL 5.6</code> ä¸­ï¼Œ<code>undo log</code> çš„å­˜æ”¾ä½ç½®è¿˜å¯ä»¥é€šè¿‡å˜é‡<code>innodbundodirectory</code>æ¥è‡ªå®šä¹‰å­˜æ”¾ç›®å½•ï¼Œé»˜è®¤å€¼ä¸ºâ€œ.â€è¡¨ç¤º <code>datadir </code>ç›®å½•ã€‚</p><p>ä½œç”¨ï¼š</p><pre><code class="hljs plain">ä¿å­˜äº‹åŠ¡å‘ç”Ÿå‰æ•°æ®çš„ä¸€ä¸ªç‰ˆæœ¬ï¼Œå¯ä»¥ç”¨äºå›æ»šï¼ŒåŒæ—¶å¯ä»¥æä¾›å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ä¸‹çš„è¯»ï¼ˆMVCCï¼‰ï¼Œå³éé”å®šè¯»</code></pre><p>å†…å®¹ï¼š</p><pre><code class="hljs mel">é€»è¾‘æ ¼å¼çš„ä½“åˆ¶ã€‚åœ¨æ‰§è¡Œ<span class="hljs-keyword">undo</span>çš„æ—¶å€™ï¼Œä»…ä»…æ˜¯å°†æ•°æ®ä»é€»è¾‘ä¸Šæ¢å¤ä¹‹äº‹åŠ¡ä¹‹å‰çš„çŠ¶æ€ï¼Œè€Œä¸æ˜¯ä»ç‰©ç†é¡µé¢ä¸Šæ“ä½œå®ç°çš„ï¼Œè¿™ä¸€ç‚¹æ˜¯ä¸åŒäº<span class="hljs-keyword">redo</span> <span class="hljs-keyword">log</span></code></pre><p>ä»€ä¹ˆæ—¶å€™äº§ç”Ÿ</p><pre><code class="hljs mel">äº‹åŠ¡å¼€å§‹å‰ï¼Œå°†å½“å‰çš„ç‰ˆæœ¬ç”Ÿæˆ<span class="hljs-keyword">undo</span> <span class="hljs-keyword">log</span>. <span class="hljs-keyword">undo</span>ä¹Ÿä¼šäº§ç”Ÿ<span class="hljs-keyword">redo</span>æ¥ä¿è¯<span class="hljs-keyword">undo</span> <span class="hljs-keyword">log</span>çš„å¯é æ€§</code></pre><p>ä»€ä¹ˆæ—¶å€™é‡Šæ”¾</p><pre><code class="hljs mel">å½“äº‹åŠ¡æäº¤ä¹‹åï¼Œ<span class="hljs-keyword">undo</span> <span class="hljs-keyword">log</span>ä¸èƒ½ç«‹é©¬è¢«åˆ æ‰ï¼Œè€Œæ˜¯æ”¾å…¥å¾…æ¸…ç†çš„é“¾è¡¨ï¼Œç”±purgeçº¿ç¨‹åˆ¤æ–­æ˜¯å¦æœ‰å…¶ä»–äº‹åŠ¡åœ¨ä½¿ç”¨<span class="hljs-keyword">undo</span>æ®µä¸­è¡¨çš„ä¸Šä¸€ä¸ªäº‹åŠ¡ä¹‹å‰çš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œå†³å®šæ˜¯å¦å¯ä»¥æ¸…ç†<span class="hljs-keyword">undo</span> <span class="hljs-keyword">log</span>çš„æ—¥å¿—ç©ºé—´</code></pre><p>å¯¹åº”ç‰©ç†æ–‡ä»¶ï¼š</p><pre><code class="hljs mel">mysql5<span class="hljs-number">.6</span>ä¹‹å‰ï¼Œ<span class="hljs-keyword">undo</span>è¡¨ç©ºé—´ä½äºå…±äº«è¡¨ç©ºé—´çš„å›æ»šæ®µä¸­ï¼Œå…±äº«è¡¨ç©ºé—´é»˜è®¤çš„åç§°ä¸ºibdata,ä½äºæ•°æ®æ–‡ä»¶ç›®å½•ä¸­ã€‚mysql5<span class="hljs-number">.6</span>ä¹‹åï¼Œå¯ä»¥é…ç½®ç‹¬ç«‹æ–‡ä»¶ï¼Œå®Œæˆæ•°æ®åº“åˆå§‹åŒ–åç”Ÿæ•ˆä¸”ä¸èƒ½æ”¹å˜<span class="hljs-keyword">undo</span> <span class="hljs-keyword">log</span>æ–‡ä»¶çš„ä¸ªæ•°ï¼Œå¦‚æœåˆå§‹åŒ–æ•°æ®åº“ä¹‹å‰æ²¡æœ‰è¿›è¡Œç›¸å…³çš„é…ç½®ï¼Œå°±æ— æ³•é…ç½®ç‹¬ç«‹çš„è¡¨ç©ºé—´ã€‚</code></pre><h4 id="é‡åšæ—¥å¿—-redo-log"><a href="#é‡åšæ—¥å¿—-redo-log" class="headerlink" title="é‡åšæ—¥å¿—(redo log)"></a><strong>é‡åšæ—¥å¿—(<code>redo log</code>)</strong></h4><p>ä¸ºäº†æœ€å¤§ç¨‹åº¦çš„é¿å…æ•°æ®å†™å…¥æ—¶ï¼Œå› ä¸º IO ç“¶é¢ˆé€ æˆçš„æ€§èƒ½é—®é¢˜ï¼ŒMySQL é‡‡ç”¨äº†è¿™æ ·ä¸€ç§ç¼“å­˜æœºåˆ¶ï¼Œå…ˆå°†æ•°æ®å†™å…¥å†…å­˜ä¸­ï¼Œå†æ‰¹é‡æŠŠå†…å­˜ä¸­çš„æ•°æ®ç»Ÿä¸€åˆ·å›ç£ç›˜ã€‚ä¸ºäº†é¿å…å°†æ•°æ®åˆ·å›ç£ç›˜è¿‡ç¨‹ä¸­ï¼Œå› ä¸ºæ‰ç”µæˆ–ç³»ç»Ÿæ•…éšœå¸¦æ¥çš„æ•°æ®ä¸¢å¤±é—®é¢˜ï¼ŒInnoDB é‡‡ç”¨ <code>redo log</code> æ¥è§£å†³æ­¤é—®é¢˜ã€‚</p><p>ä½œç”¨ï¼š</p><pre><code class="hljs mel">ç¡®ä¿äº‹åŠ¡çš„æŒä¹…æ€§ã€‚é˜²æ­¢å‘ç”Ÿæ•…éšœçš„æ—¶é—´ï¼Œå°šæœ‰è„é¡µä¸ºå†™å…¥ç£ç›˜ã€‚åœ¨é‡å¯mysqlæœåŠ¡æ˜¯ï¼Œæ ¹æ®<span class="hljs-keyword">redo</span> <span class="hljs-keyword">log</span>è¿›è¡Œé‡åšï¼Œä»è€Œè¾¾åˆ°äº‹åŠ¡çš„æŒä¹…æ€§ã€‚</code></pre><p>å†…å®¹ï¼š</p><pre><code class="hljs mel">ç‰©ç†æ ¼å¼çš„æ—¥å¿—ï¼Œæ¿€åŠ±ç‰©ç†æ•°æ®é¡µé¢çš„ä¿®æ”¹ä¿¡æ¯ï¼Œå…¶<span class="hljs-keyword">redo</span> <span class="hljs-keyword">log</span>æ˜¯é¡ºåºå†™å…¥<span class="hljs-keyword">redo</span> <span class="hljs-keyword">log</span> <span class="hljs-keyword">file</span>çš„ç‰©ç†æ–‡ä»¶ä¸­å»çš„ã€‚</code></pre><p>ä»€ä¹ˆæ—¶å€™äº§ç”Ÿ</p><pre><code class="hljs mel">äº‹åŠ¡å¼€å§‹ä¹‹åå°±äº§ç”Ÿ<span class="hljs-keyword">redo</span> <span class="hljs-keyword">log</span>. <span class="hljs-keyword">redo</span> <span class="hljs-keyword">log</span>çš„è½ç›˜å¹¶ä¸æ˜¯éšç€äº‹åŠ¡çš„æäº¤æ‰å†™å…¥çš„ï¼Œè€Œæ˜¯åœ¨äº‹åŠ¡çš„æ‰§è¡Œè¿‡ç¨‹ä¸­ä¾¿å¼€å§‹å†™å…¥<span class="hljs-keyword">redo</span> <span class="hljs-keyword">log</span>æ–‡ä»¶ä¸­çš„ã€‚</code></pre><p>ä»€ä¹ˆæ—¶å€™é‡Šæ”¾</p><pre><code class="hljs mel">å½“å¯¹åº”äº‹åŠ¡çš„è„é¡µå†™å…¥åˆ°ç£ç›˜ä¹‹åï¼Œ<span class="hljs-keyword">redo</span> <span class="hljs-keyword">log</span> çš„ä½¿å‘½ä¹Ÿå°±å®Œæˆäº†ï¼Œé‡åšæ—¥å¿—å ç”¨çš„ç©ºé—´å°±å¯ä»¥å†²ç”¨ï¼ˆè¢«è¦†ç›–ï¼‰ã€‚</code></pre><h4 id="SQLè¯­å¥çš„äº¤äº’æµç¨‹"><a href="#SQLè¯­å¥çš„äº¤äº’æµç¨‹" class="headerlink" title="SQLè¯­å¥çš„äº¤äº’æµç¨‹"></a>SQLè¯­å¥çš„äº¤äº’æµç¨‹</h4><blockquote><p>è¯´ä¸€ä¸‹SQLè¯­å¥çš„äº¤äº’æµç¨‹ï¼ŒåŒ…æ‹¬å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯ä¹‹é—´çš„äº¤äº’ä»¥åŠæœåŠ¡å†…éƒ¨çš„æ•´ä½“æµç¨‹</p></blockquote><pre><code class="hljs MySQL">-- idæ˜¯ä¸»é”®BEGINUPDATE user SET name&#x3D;&#39;aa&#39; WHERE id &#x3D; 1 FOR UPDATE;COMMIT;</code></pre><p><img src="/images/mysql/sqlquery.png"></p><p><img src="/images/mysql/querylogic.png"></p><h5 id="è¿æ¥å™¨"><a href="#è¿æ¥å™¨" class="headerlink" title="è¿æ¥å™¨"></a>è¿æ¥å™¨</h5><p>å½“å®¢æˆ·ç«¯ç™»é™†MySQLçš„æ—¶å€™ï¼Œå¯¹èº«ä»½è®¤è¯å’Œæƒé™åˆ¤æ–­ã€‚</p><h5 id="æŸ¥è¯¢ç¼“å­˜"><a href="#æŸ¥è¯¢ç¼“å­˜" class="headerlink" title="æŸ¥è¯¢ç¼“å­˜"></a>æŸ¥è¯¢ç¼“å­˜</h5><p>æ‰§è¡ŒæŸ¥è¯¢è¯­å¥çš„æ—¶å€™ï¼Œä¼šå…ˆæŸ¥è¯¢ç¼“å­˜(MySQL 8.0 ç‰ˆæœ¬åç§»é™¤)ã€‚</p><h5 id="åˆ†æå™¨"><a href="#åˆ†æå™¨" class="headerlink" title="åˆ†æå™¨"></a>åˆ†æå™¨</h5><p>å‡è®¾åœ¨æ²¡æœ‰å‘½ä¸­æŸ¥è¯¢ç¼“å­˜çš„æƒ…å†µä¸‹ï¼ŒSQLè¯·æ±‚å°±ä¼šæ¥åˆ°åˆ†æå™¨ã€‚åˆ†æå™¨è´Ÿè´£æ˜ç¡®SQLè¦å®Œæˆçš„åŠŸèƒ½ï¼Œä»¥åŠæ£€æŸ¥SQLçš„è¯­æ³•æ˜¯å¦æ­£ç¡®ã€‚</p><h5 id="æŸ¥è¯¢ä¼˜åŒ–å™¨"><a href="#æŸ¥è¯¢ä¼˜åŒ–å™¨" class="headerlink" title="æŸ¥è¯¢ä¼˜åŒ–å™¨"></a>æŸ¥è¯¢ä¼˜åŒ–å™¨</h5><p>ä¼˜åŒ–å™¨ä¼šè®¡ç®—ã€ŒIO æˆæœ¬ + CPUã€æˆæœ¬æœ€å°çš„é‚£ä¸ªç´¢å¼•æ¥æ‰§è¡Œã€‚ä¼˜åŒ–å™¨æ‰§è¡Œé€‰å‡ºæœ€ä¼˜ç´¢å¼•ç”Ÿæˆæ‰§è¡Œè®¡åˆ’åï¼Œè°ƒç”¨å­˜å‚¨å¼•æ“æ¥å£è¢«ä¼˜åŒ–è¿‡çš„SQLè¯­å¥ã€‚</p><h5 id="å­˜å‚¨å¼•æ“"><a href="#å­˜å‚¨å¼•æ“" class="headerlink" title="å­˜å‚¨å¼•æ“"></a>å­˜å‚¨å¼•æ“</h5><p>æ‰§è¡Œ SQL çš„åŠ¨ä½œæ˜¯åœ¨å­˜å‚¨å¼•æ“ä¸­å®Œæˆçš„ï¼Œæ•°æ®æ˜¯è¢«å­˜æ”¾åœ¨å†…å­˜æˆ–è€…æ˜¯ç£ç›˜ä¸­çš„ã€‚</p><h5 id="æ‰§è¡Œå™¨"><a href="#æ‰§è¡Œå™¨" class="headerlink" title="æ‰§è¡Œå™¨"></a>æ‰§è¡Œå™¨</h5><p>æ‰§è¡Œå™¨ä»å‡†å¤‡æ›´æ–°ä¸€æ¡æ•°æ®åˆ°äº‹åŠ¡çš„æäº¤çš„æµç¨‹</p><ol><li>é¦–å…ˆæ‰§è¡Œå™¨æ ¹æ® MySQL çš„æ‰§è¡Œè®¡åˆ’æ¥æŸ¥è¯¢æ•°æ®ï¼Œå…ˆæ˜¯ä»ç¼“å­˜æ± ä¸­æŸ¥è¯¢æ•°æ®ï¼Œå¦‚æœæ²¡æœ‰å°±ä¼šå»æ•°æ®åº“ä¸­æŸ¥è¯¢ï¼Œå¦‚æœæŸ¥è¯¢åˆ°äº†å°±å°†å…¶æ”¾åˆ°ç¼“å­˜æ± ä¸­ã€‚</li><li>åœ¨æ•°æ®è¢«ç¼“å­˜åˆ°ç¼“å­˜æ± çš„åŒæ—¶ï¼Œä¼šå†™å…¥ undo log æ—¥å¿—æ–‡ä»¶ã€‚</li><li>æ›´æ–°çš„åŠ¨ä½œæ˜¯åœ¨ BufferPool ä¸­å®Œæˆçš„ï¼ŒåŒæ—¶ä¼šå°†æ›´æ–°åçš„æ•°æ®æ·»åŠ åˆ° redo log buffer ä¸­ã€‚</li><li>å®Œæˆä»¥åå°±å¯ä»¥æäº¤äº‹åŠ¡ï¼Œåœ¨æäº¤çš„åŒæ—¶ä¼šåšä»¥ä¸‹ä¸‰ä»¶äº‹ã€‚</li><li>ï¼ˆç¬¬ä¸€ä»¶äº‹ï¼‰å°†redo log bufferä¸­çš„æ•°æ®åˆ·å…¥åˆ° redo log æ–‡ä»¶ä¸­ã€‚</li><li>ï¼ˆç¬¬äºŒä»¶äº‹ï¼‰å°†æœ¬æ¬¡æ“ä½œè®°å½•å†™å…¥åˆ° bin logæ–‡ä»¶ä¸­ã€‚</li><li>ï¼ˆç¬¬ä¸‰ä»¶äº‹ï¼‰å°† bin log æ–‡ä»¶åå­—å’Œæ›´æ–°å†…å®¹åœ¨ bin log ä¸­çš„ä½ç½®è®°å½•åˆ°redo logä¸­ï¼ŒåŒæ—¶åœ¨ redo log æœ€åæ·»åŠ  commit æ ‡è®°ã€‚</li></ol><p><img src="/images/mysql/sqllog.png"></p><h3 id="MySQLç´¢å¼•åŸç†åŠä¼˜åŒ–"><a href="#MySQLç´¢å¼•åŸç†åŠä¼˜åŒ–" class="headerlink" title="MySQLç´¢å¼•åŸç†åŠä¼˜åŒ–"></a><strong>MySQLç´¢å¼•åŸç†åŠä¼˜åŒ–</strong></h3><h4 id="ç´¢å¼•ä»‹ç»"><a href="#ç´¢å¼•ä»‹ç»" class="headerlink" title="ç´¢å¼•ä»‹ç»"></a>ç´¢å¼•ä»‹ç»</h4><h5 id="ä»€ä¹ˆæ˜¯ç´¢å¼•"><a href="#ä»€ä¹ˆæ˜¯ç´¢å¼•" class="headerlink" title="ä»€ä¹ˆæ˜¯ç´¢å¼•"></a>ä»€ä¹ˆæ˜¯ç´¢å¼•</h5><p>ç´¢å¼•æ˜¯ä¸€ç§èƒ½å¸®åŠ© MySQL æé«˜æŸ¥è¯¢æ•ˆç‡çš„æ•°æ®ç»“æ„ã€‚</p><h5 id="ç´¢å¼•ä¼˜ç‚¹å’Œç¼ºç‚¹"><a href="#ç´¢å¼•ä¼˜ç‚¹å’Œç¼ºç‚¹" class="headerlink" title="ç´¢å¼•ä¼˜ç‚¹å’Œç¼ºç‚¹"></a>ç´¢å¼•ä¼˜ç‚¹å’Œç¼ºç‚¹</h5><p>ç´¢å¼•çš„ä¼˜ç‚¹å¦‚ä¸‹ï¼š</p><ul><li><p>å¿«é€Ÿè®¿é—®æ•°æ®è¡¨ä¸­çš„ç‰¹å®šä¿¡æ¯ï¼Œæé«˜æ£€ç´¢é€Ÿåº¦ã€‚</p></li><li><p>åˆ›å»ºå”¯ä¸€æ€§ç´¢å¼•ï¼Œä¿è¯æ•°æ®è¡¨ä¸­æ¯ä¸€è¡Œæ•°æ®çš„å”¯ä¸€æ€§ã€‚</p></li><li><p>åŠ é€Ÿè¡¨ä¸è¡¨ä¹‹é—´çš„è¿æ¥ã€‚</p></li><li><p>ä½¿ç”¨åˆ†ç»„å’Œæ’åºè¿›è¡Œæ•°æ®æ£€ç´¢æ—¶ï¼Œå¯ä»¥æ˜¾è‘—å‡å°‘æŸ¥è¯¢ä¸­åˆ†ç»„å’Œæ’åºçš„æ—¶é—´ã€‚</p></li></ul><p>ç´¢å¼•çš„ç¼ºç‚¹ï¼š</p><ul><li><p>è™½ç„¶æé«˜äº†çš„æŸ¥è¯¢é€Ÿåº¦ï¼Œä½†å´é™ä½äº†æ›´æ–°è¡¨çš„é€Ÿåº¦ï¼Œæ¯”å¦‚ updateã€insertï¼Œå› ä¸ºæ›´æ–°æ•°æ®æ—¶ï¼ŒMySQL ä¸ä»…è¦æ›´æ–°æ•°æ®ï¼Œè¿˜è¦æ›´æ–°ç´¢å¼•æ–‡ä»¶ï¼›</p></li><li><p>å»ºç«‹ç´¢å¼•ä¼šå ç”¨ç£ç›˜æ–‡ä»¶çš„ç´¢å¼•æ–‡ä»¶ã€‚</p></li></ul><p>ä½¿ç”¨ç´¢å¼•æ³¨æ„äº‹é¡¹ï¼š</p><ul><li><p>ä½¿ç”¨çŸ­ç´¢å¼•ï¼ŒçŸ­ç´¢å¼•ä¸ä»…å¯ä»¥æé«˜æŸ¥è¯¢é€Ÿåº¦ï¼Œæ›´èƒ½èŠ‚çœç£ç›˜ç©ºé—´å’Œ I/O æ“ä½œï¼›</p></li><li><p>ç´¢å¼•åˆ—æ’åºï¼ŒMySQL æŸ¥è¯¢åªä½¿ç”¨ä¸€ä¸ªç´¢å¼•ï¼Œå› æ­¤å¦‚æœ where å­å¥ä¸­å·²ç»ä½¿ç”¨äº†ç´¢å¼•çš„è¯ï¼Œé‚£ä¹ˆ order by ä¸­çš„åˆ—æ˜¯ä¸ä¼šä½¿ç”¨ç´¢å¼•çš„ï¼Œå› æ­¤æ•°æ®åº“é»˜è®¤æ’åºå¯ä»¥ç¬¦åˆè¦æ±‚çš„æƒ…å†µä¸‹ï¼Œä¸è¦è¿›è¡Œæ’åºæ“ä½œï¼›å°½é‡ä¸è¦åŒ…å«å¤šä¸ªåˆ—çš„æ’åºï¼Œå¦‚æœéœ€è¦æœ€å¥½ç»™è¿™äº›åˆ—åˆ›å»ºå¤åˆç´¢å¼•ï¼›</p></li><li><p>like è¯­å¥æ“ä½œï¼Œä¸€èˆ¬æƒ…å†µä¸‹ä¸é¼“åŠ±ä½¿ç”¨ like æ“ä½œï¼Œå¦‚æœéä½¿ç”¨ä¸å¯ï¼Œ æ³¨æ„ like â€œ%aaa%â€ ä¸ä¼šä½¿ç”¨ç´¢å¼•ï¼Œè€Œlike â€œaaa%â€å¯ä»¥ä½¿ç”¨ç´¢å¼•ï¼›</p></li><li><p>ä¸è¦åœ¨åˆ—ä¸Šè¿›è¡Œè¿ç®—ï¼›</p></li><li><p>ä¸é€‚ç”¨ NOT IN å’Œ &lt;&gt; æ“ä½œã€‚</p></li></ul><h4 id="ç´¢å¼•åˆ†ç±»"><a href="#ç´¢å¼•åˆ†ç±»" class="headerlink" title="ç´¢å¼•åˆ†ç±»"></a>ç´¢å¼•åˆ†ç±»</h4><p>MySQL çš„ç´¢å¼•æœ‰ä¸¤ç§åˆ†ç±»æ–¹å¼ï¼šé€»è¾‘åˆ†ç±»å’Œç‰©ç†åˆ†ç±»ã€‚ æŒ‰ç…§é€»è¾‘åˆ†ç±»ï¼Œç´¢å¼•å¯åˆ†ä¸ºï¼š</p><h6 id="å•åˆ—ç´¢å¼•"><a href="#å•åˆ—ç´¢å¼•" class="headerlink" title="å•åˆ—ç´¢å¼•"></a>å•åˆ—ç´¢å¼•</h6><ul><li><p>ä¸»é”®ç´¢å¼•ï¼šä¸€å¼ è¡¨åªèƒ½æœ‰ä¸€ä¸ªä¸»é”®ç´¢å¼•ï¼Œä¸å…è®¸é‡å¤ã€ä¸å…è®¸ä¸º NULLï¼›</p></li><li><p>å”¯ä¸€ç´¢å¼•ï¼šæ•°æ®åˆ—ä¸å…è®¸é‡å¤ï¼Œå…è®¸ä¸º NULL å€¼ï¼Œä¸€å¼ è¡¨å¯æœ‰å¤šä¸ªå”¯ä¸€ç´¢å¼•ï¼Œä½†æ˜¯ä¸€ä¸ªå”¯ä¸€ç´¢å¼•åªèƒ½åŒ…å«ä¸€åˆ—ï¼Œæ¯”å¦‚èº«ä»½è¯å·ç ã€å¡å·ç­‰éƒ½å¯ä»¥ä½œä¸ºå”¯ä¸€ç´¢å¼•ï¼›</p></li><li><p>æ™®é€šç´¢å¼•ï¼šä¸€å¼ è¡¨å¯ä»¥åˆ›å»ºå¤šä¸ªæ™®é€šç´¢å¼•ï¼Œä¸€ä¸ªæ™®é€šç´¢å¼•å¯ä»¥åŒ…å«å¤šä¸ªå­—æ®µï¼Œå…è®¸æ•°æ®é‡å¤ï¼Œå…è®¸ NULL å€¼æ’å…¥ï¼›</p></li></ul><h6 id="ç»„åˆç´¢å¼•"><a href="#ç»„åˆç´¢å¼•" class="headerlink" title="ç»„åˆç´¢å¼•"></a>ç»„åˆç´¢å¼•</h6><ul><li>åœ¨è¡¨ä¸­å¤šä¸ªå­—æ®µç»„åˆä¸Šåˆ›å»ºçš„ç´¢å¼•</li><li>ç»„åˆç´¢å¼•çš„ä½¿ç”¨éœ€è¦éµå¾ª<strong>æœ€å·¦å‰ç¼€åŸåˆ™</strong></li><li>ä¸€èˆ¬æƒ…å†µå»ºè®®ç»„åˆç´¢å¼•ä»£æ›¿å•åˆ—ç´¢å¼•</li></ul><h6 id="å…¨æ–‡ç´¢å¼•"><a href="#å…¨æ–‡ç´¢å¼•" class="headerlink" title="å…¨æ–‡ç´¢å¼•"></a>å…¨æ–‡ç´¢å¼•</h6><ul><li>è®©æœç´¢å…³é”®è¯æ›´é«˜æ•ˆçš„ä¸€ç§ç´¢å¼•ï¼Œåªæœ‰åœ¨MyISAMå¼•æ“ã€InnoDBï¼ˆ5.6ä»¥åï¼‰æ‰èƒ½ä½¿ç”¨ï¼Œè€Œä¸”åªèƒ½åœ¨CHAR, VARCHAR, TEXTç±»å‹æ‰èƒ½ä½¿ç”¨ã€‚</li><li>ä¼˜å…ˆçº§æœ€é«˜ å…ˆæ‰§è¡Œ ä¸ä¼šæ‰§è¡Œå…¶ä»–ç´¢å¼•</li><li>å­˜å‚¨å¼•æ“å†³å®šåªæ‰§è¡Œä¸€ä¸ªç´¢å¼•</li></ul><h6 id="ç©ºé—´ç´¢å¼•"><a href="#ç©ºé—´ç´¢å¼•" class="headerlink" title="ç©ºé—´ç´¢å¼•"></a>ç©ºé—´ç´¢å¼•</h6><p>æŒ‰ç…§ç‰©ç†åˆ†ç±»ï¼Œç´¢å¼•å¯åˆ†ä¸ºï¼š</p><ul><li><p>èšé›†ç´¢å¼•</p></li><li><p>éèšé›†ç´¢å¼•</p></li></ul><h4 id="ç´¢å¼•ä½¿ç”¨"><a href="#ç´¢å¼•ä½¿ç”¨" class="headerlink" title="ç´¢å¼•ä½¿ç”¨"></a>ç´¢å¼•ä½¿ç”¨</h4><h5 id="åˆ›å»ºç´¢å¼•"><a href="#åˆ›å»ºç´¢å¼•" class="headerlink" title="åˆ›å»ºç´¢å¼•"></a>åˆ›å»ºç´¢å¼•</h5><p>å„ç§ç´¢å¼•çš„åˆ›å»ºè„šæœ¬å¦‚ä¸‹ï¼š</p><pre><code class="hljs mysql">-- åˆ›å»ºä¸»é”®ç´¢å¼• alter table t add primary key add (&#96;id&#96;); -- åˆ›å»ºå”¯ä¸€ç´¢å¼• alter table t add unique (&#96;username&#96;); -- åˆ›å»ºæ™®é€šç´¢å¼• alter table t add index index_name (&#96;username&#96;); -- åˆ›å»ºç»„åˆç´¢å¼• alter table t add index index_name (&#96;username&#96;, &#96;age&#96;); -- åˆ›å»ºå…¨æ–‡ç´¢å¼• alter table t add fulltext (&#96;username&#96;);</code></pre><h5 id="åˆ é™¤ç´¢å¼•"><a href="#åˆ é™¤ç´¢å¼•" class="headerlink" title="åˆ é™¤ç´¢å¼•"></a>åˆ é™¤ç´¢å¼•</h5><pre><code class="hljs mysql">DROP INDEX index_name ON table;</code></pre><h5 id="æŸ¥çœ‹ç´¢å¼•"><a href="#æŸ¥çœ‹ç´¢å¼•" class="headerlink" title="æŸ¥çœ‹ç´¢å¼•"></a>æŸ¥çœ‹ç´¢å¼•</h5><pre><code class="hljs mysql">SHOW INDEX FROM tablename</code></pre><h4 id="ç´¢å¼•å­˜å‚¨ç»“æ„"><a href="#ç´¢å¼•å­˜å‚¨ç»“æ„" class="headerlink" title="ç´¢å¼•å­˜å‚¨ç»“æ„"></a>ç´¢å¼•å­˜å‚¨ç»“æ„</h4><h5 id="InnoDBå­˜å‚¨å¼•æ“é€»è¾‘ç»“æ„"><a href="#InnoDBå­˜å‚¨å¼•æ“é€»è¾‘ç»“æ„" class="headerlink" title="InnoDBå­˜å‚¨å¼•æ“é€»è¾‘ç»“æ„"></a>InnoDBå­˜å‚¨å¼•æ“é€»è¾‘ç»“æ„</h5><p><img src="/images/mysql/tablespace.png"></p><p>InnoDBå­˜å‚¨å¼•æ“é€»è¾‘å­˜å‚¨ç»“æ„å¯åˆ†ä¸ºäº”çº§ï¼šè¡¨ç©ºé—´ã€æ®µã€åŒºã€é¡µã€è¡Œã€‚</p><h5 id="ç´¢å¼•å­˜å‚¨ç»“æ„-1"><a href="#ç´¢å¼•å­˜å‚¨ç»“æ„-1" class="headerlink" title="ç´¢å¼•å­˜å‚¨ç»“æ„"></a>ç´¢å¼•å­˜å‚¨ç»“æ„</h5><p>ç´¢å¼•åœ¨å­˜å‚¨å¼•æ“ä¸­å®ç°ï¼Œä¸åŒçš„å­˜å‚¨å¼•æ“ä½¿ç”¨ä¸åŒçš„ç´¢å¼•</p><p><strong>MyISAMå’ŒInnoDB</strong>å­˜å‚¨å¼•æ“åªæ”¯æŒ<strong>B+TREE</strong>ç´¢å¼•ï¼Œå³é»˜è®¤ä½¿ç”¨B+TREE,ä¸èƒ½æ›´æ¢</p><p>MEMORYå’ŒHEAPå­˜å‚¨å¼•æ“ï¼šæ‰§è¡ŒHASHå’ŒBTREE</p><h5 id="Bæ ‘ä¸B-æ ‘"><a href="#Bæ ‘ä¸B-æ ‘" class="headerlink" title="Bæ ‘ä¸B+æ ‘"></a>Bæ ‘ä¸B+æ ‘</h5><h6 id="Bæ ‘ä¸B-æ ‘çš„åŒºåˆ«"><a href="#Bæ ‘ä¸B-æ ‘çš„åŒºåˆ«" class="headerlink" title="Bæ ‘ä¸B+æ ‘çš„åŒºåˆ«"></a>Bæ ‘ä¸B+æ ‘çš„åŒºåˆ«</h6><p>éå¶å­ç»“ç‚¹æ˜¯å¦å­˜å‚¨æ•°æ®</p><pre><code class="hljs mipsasm"><span class="hljs-keyword">Bæ ‘å¶å­ç»“ç‚¹å’Œéå¶å­ç»“ç‚¹éƒ½ä¼šå­˜å‚¨æ•°æ®</span><span class="hljs-keyword">B+æ ‘åªæœ‰å¶å­ç»“ç‚¹æ‰ä¼šå­˜å‚¨æ•°æ®ï¼Œè€Œä¸”å­˜å‚¨çš„æ•°æ®éƒ½åœ¨ä¸€è¡Œä¸Šï¼Œè¿™äº›æ•°æ®æ˜¯ç”±æŒ‡é’ˆæŒ‡å‘çš„ï¼Œé¡ºåºçš„</span></code></pre><h5 id="éèšé›†ç´¢å¼•ï¼ˆMyISAMï¼‰"><a href="#éèšé›†ç´¢å¼•ï¼ˆMyISAMï¼‰" class="headerlink" title="éèšé›†ç´¢å¼•ï¼ˆMyISAMï¼‰"></a>éèšé›†ç´¢å¼•ï¼ˆMyISAMï¼‰</h5><ul><li><p>B+æ ‘å¶å­ç»“ç‚¹åªå­˜å‚¨æ•°æ®è¡Œçš„æŒ‡é’ˆã€‚ç®€å•çš„è¯´ï¼Œ<strong>æ•°æ®è·Ÿç´¢å¼•ä¸åœ¨ä¸€èµ·</strong>ã€‚</p></li><li><p><strong>éèšé›†ç´¢å¼•åŒ…å«çš„ä¸»é”®ç´¢å¼•å’Œè¾…åŠ©ç´¢å¼•éƒ½ä¼šå­˜å‚¨æŒ‡é’ˆçš„å€¼</strong></p></li></ul><h6 id="ä¸»é”®ç´¢å¼•"><a href="#ä¸»é”®ç´¢å¼•" class="headerlink" title="ä¸»é”®ç´¢å¼•"></a>ä¸»é”®ç´¢å¼•</h6><p><img src="/images/mysql/prindex.png"></p><h6 id="è¾…åŠ©ç´¢å¼•ï¼ˆæ¬¡è¦ç´¢å¼•ï¼‰"><a href="#è¾…åŠ©ç´¢å¼•ï¼ˆæ¬¡è¦ç´¢å¼•ï¼‰" class="headerlink" title="è¾…åŠ©ç´¢å¼•ï¼ˆæ¬¡è¦ç´¢å¼•ï¼‰"></a>è¾…åŠ©ç´¢å¼•ï¼ˆæ¬¡è¦ç´¢å¼•ï¼‰</h6><p>åœ¨MyISAMä¸­ä¸»é”®ç´¢å¼•ä¸è¾…åŠ©ç´¢å¼•åœ¨ç»“æ„ä¸Šæ²¡æœ‰åŒºåˆ«ï¼Œåªæ˜¯ä¸»é”®ç´¢å¼•è¦æ±‚keyæ˜¯å”¯ä¸€çš„ï¼Œè¾…åŠ©ç´¢å¼•çš„keyæ˜¯å¯ä»¥é‡å¤çš„ã€‚</p><p><img src="/images/mysql/secondkey.png"></p><h5 id="èšé›†ç´¢å¼•ï¼ˆInnoDBï¼‰"><a href="#èšé›†ç´¢å¼•ï¼ˆInnoDBï¼‰" class="headerlink" title="èšé›†ç´¢å¼•ï¼ˆInnoDBï¼‰"></a>èšé›†ç´¢å¼•ï¼ˆInnoDBï¼‰</h5><ul><li>ä¸»é”®ç´¢å¼•çš„å¶å­ç»“ç‚¹éƒ½ä¼šå­˜å‚¨æ•°æ®ï¼Œå³<strong>æ•°æ®å’Œç´¢å¼•åœ¨ä¸€èµ·</strong></li><li>è¾…åŠ©ç´¢å¼•åªå­˜å‚¨ä¸»é”®å€¼</li><li>å¦‚æœæ²¡æœ‰ä¸»é”®ç´¢å¼•ï¼Œåˆ™ä½¿ç”¨å”¯ä¸€ç´¢å¼•å»ºç«‹èšé›†ç´¢å¼•ï¼›å¦‚æœæ²¡æœ‰å”¯ä¸€ç´¢å¼•ï¼ŒMySQLä¼šæŒ‰ç…§ä¸€å®šè§„åˆ™åˆ›å»ºèšé›†ç´¢å¼•ã€‚</li></ul><h6 id="ä¸»é”®ç´¢å¼•-1"><a href="#ä¸»é”®ç´¢å¼•-1" class="headerlink" title="ä¸»é”®ç´¢å¼•"></a>ä¸»é”®ç´¢å¼•</h6><p>InnoDBè¦æ±‚<strong>å¿…é¡»æœ‰ä¸»é”®</strong>ï¼ˆMyISAMå¯ä»¥æ²¡æœ‰ï¼‰ã€‚å¦‚æœæ²¡æœ‰ï¼ŒMySQLä¼šè‡ªåŠ¨é€‰æ‹©ä¸€ä¸ªå¯ä»¥å”¯ä¸€æ ‡è¯†æ•°æ®è®°å½•çš„åˆ—ä½œä¸ºä¸»é”®ï¼›å¦‚æœæ²¡æœ‰ï¼ŒMySQLä¼šè‡ªåŠ¨ä¸ºInnoDBç”Ÿæˆä¸€ä¸ªéšå«å­—æ®µä½œä¸ºä¸»é”®ï¼Œç±»å‹ä¸ºé•¿æ•´å‹ã€‚</p><p><img src="/images/mysql/pkey.png"></p><h6 id="è¾…åŠ©ç´¢å¼•"><a href="#è¾…åŠ©ç´¢å¼•" class="headerlink" title="è¾…åŠ©ç´¢å¼•"></a>è¾…åŠ©ç´¢å¼•</h6><p>èšé›†ç´¢å¼•è¿™ç§å®ç°æ–¹å¼æŒ‰ç…§ä¸»é”®æœç´¢éå¸¸é«˜æ•ˆï¼Œä½†æ˜¯è¾…åŠ©ç´¢å¼•éœ€è¦æŸ¥è¯¢ä¸¤éï¼šè¾…åŠ©ç´¢å¼•è·å¾—ä¸»é”®ï¼Œç„¶åä¸»é”®åˆ°ç´¢å¼•ä¸­æ£€ç´¢è·å–è®°å½•ã€‚è¿™ä¹Ÿå°±æ˜¯<strong>å›è¡¨æŸ¥è¯¢</strong>ã€‚</p><pre><code class="hljs mysql">select * from user where name&#x3D;&#39;Alice&#39;;  å›è¡¨æŸ¥è¯¢ï¼Œæ£€ç´¢ä¸¤æ¬¡ è¾…åŠ©ç´¢å¼•â€”â€”&gt;ä¸»é”®ç´¢å¼•â€”â€”&gt;æ•°æ®select id, name from user where name&#x3D;&#39;Alice&#39;; ä¸éœ€è¦å›è¡¨ï¼Œè¾…åŠ©ç´¢å¼•æ ‘ä¸Šä¾¿å¯æŸ¥åˆ°  è¦†ç›–ç´¢å¼•ï¼ˆå¤šç”¨ç»„åˆç´¢å¼•ï¼‰</code></pre><p><img src="/images/mysql/spk.png"></p><h4 id="ç»„åˆç´¢å¼•-1"><a href="#ç»„åˆç´¢å¼•-1" class="headerlink" title="ç»„åˆç´¢å¼•"></a>ç»„åˆç´¢å¼•</h4><h5 id="å“ªäº›æƒ…å†µè¦åˆ›å»ºç´¢å¼•"><a href="#å“ªäº›æƒ…å†µè¦åˆ›å»ºç´¢å¼•" class="headerlink" title="å“ªäº›æƒ…å†µè¦åˆ›å»ºç´¢å¼•"></a>å“ªäº›æƒ…å†µè¦åˆ›å»ºç´¢å¼•</h5><ol><li>ä¸»é”®è‡ªåŠ¨åˆ›å»ºç´¢å¼•</li><li>é¢‘ç¹ä½œä¸ºæŸ¥è¯¢æ¡ä»¶éœ€è¦åˆ›å»ºç´¢å¼•</li><li>å¤šè¡¨å…³è”æŸ¥è¯¢ä¸­ï¼Œå…³è”å­—æ®µåº”è¯¥åˆ›å»ºç´¢å¼• on ä¸¤è¾¹éƒ½éœ€è¦åˆ›å»ºç´¢å¼•</li><li>æŸ¥è¯¢ä¸­æ’åºå­—æ®µï¼Œéœ€è¦åˆ›å»ºç´¢å¼•</li><li>é¢‘ç¹æŸ¥æ‰¾å­—çŸ­ è¦†ç›–ç´¢å¼•</li><li>æŸ¥è¯¢ä¸­ç»Ÿè®¡æˆ–è€…åˆ†ç»„å­—æ®µ éœ€è¦åˆ›å»ºç´¢å¼•</li></ol><h5 id="å“ªäº›æƒ…å†µä¸éœ€è¦åˆ›å»ºç´¢å¼•"><a href="#å“ªäº›æƒ…å†µä¸éœ€è¦åˆ›å»ºç´¢å¼•" class="headerlink" title="å“ªäº›æƒ…å†µä¸éœ€è¦åˆ›å»ºç´¢å¼•"></a>å“ªäº›æƒ…å†µä¸éœ€è¦åˆ›å»ºç´¢å¼•</h5><ol><li>è¡¨è®°å½•å¤ªå°‘</li><li>ç»å¸¸è¿›è¡Œå¢åˆ æ”¹æŸ¥çš„è¡¨</li><li>é¢‘ç¹æ›´æ–°çš„å­—æ®µ</li><li>whereæ¡ä»¶é‡Œä½¿ç”¨é¢‘ç‡ä¸é«˜çš„å­—æ®µ</li></ol><h5 id="ä¸ºä»€ä¹ˆä½¿ç”¨ç»„åˆç´¢å¼•"><a href="#ä¸ºä»€ä¹ˆä½¿ç”¨ç»„åˆç´¢å¼•" class="headerlink" title="ä¸ºä»€ä¹ˆä½¿ç”¨ç»„åˆç´¢å¼•"></a>ä¸ºä»€ä¹ˆä½¿ç”¨ç»„åˆç´¢å¼•</h5><p>ç»„åˆç´¢å¼•æ ¹æ®<strong>æœ€å·¦åŸåˆ™</strong>è¿›è¡Œæ’åºï¼Œä¸ºäº†èŠ‚çœç´¢å¼•ç©ºé—´å’Œæå‡æœç´¢æ€§èƒ½ï¼Œå¯ä»¥ä½¿ç”¨ç»„åˆç´¢å¼•ã€‚</p><p>æŸ¥è¯¢éµå¾ªæœ€å·¦å‰ç¼€åŸåˆ™</p><ol><li><p>å‰ç¼€ç´¢å¼• where like a%  å¯ä»¥ä½¿ç”¨ç´¢å¼•</p><p>â€‹                where like %a  ä¸èƒ½ä½¿ç”¨ç´¢å¼•</p></li><li><p>ä»å·¦å‘å³åŒ¹é… ç›´åˆ°é‡åˆ°èŒƒå›´æŸ¥è¯¢ &gt; &lt; between like</p></li></ol><p>å»ºç«‹ç´¢å¼•ï¼ˆa, b, c, dï¼‰</p><p>â€‹    where a=1 and b=3 and c&gt;4 and d=2     åˆ°äº†c&gt;4æ—¶å¬äº†ï¼Œd=2ç”¨ä¸åˆ°ç´¢å¼•</p><p>â€‹    å¯ä»¥é€šè¿‡é”®ç´¢å¼•æ„å»ºä¸ºï¼ˆa, b, d, cï¼‰è¿›è¡Œä¼˜åŒ–</p><h4 id="ç´¢å¼•å¤±æ•ˆä¸åˆ†æ"><a href="#ç´¢å¼•å¤±æ•ˆä¸åˆ†æ" class="headerlink" title="ç´¢å¼•å¤±æ•ˆä¸åˆ†æ"></a>ç´¢å¼•å¤±æ•ˆä¸åˆ†æ</h4><h5 id="æ‰§è¡Œè®¡åˆ’"><a href="#æ‰§è¡Œè®¡åˆ’" class="headerlink" title="æ‰§è¡Œè®¡åˆ’"></a>æ‰§è¡Œè®¡åˆ’</h5><p><code>EXPALIN</code>å‘½ä»¤, å¯ä»¥å¯¹selectè¯­å¥çš„æ‰§è¡Œè®¡åˆ’è¿›è¡Œåˆ†æ</p><h5 id="å‚æ•°è¯´æ˜"><a href="#å‚æ•°è¯´æ˜" class="headerlink" title="å‚æ•°è¯´æ˜"></a>å‚æ•°è¯´æ˜</h5><pre><code class="hljs pgsql">id, select_type, <span class="hljs-keyword">table</span>, <span class="hljs-keyword">type</span>, possible_keys, key, key_len, <span class="hljs-keyword">ref</span>, <span class="hljs-keyword">rows</span>, Extra</code></pre><h6 id="id"><a href="#id" class="headerlink" title="id"></a>id</h6><ul><li>æ¯ä¸ªselectè¯­å¥éƒ½ä¼šè‡ªåŠ¨åˆ†é…ä¸€ä¸ªå”¯ä¸€æ ‡è¯†</li><li>è¡¨ç¤ºæŸ¥è¯¢ä¸­æ“ä½œè¡¨çš„é¡ºåº<ul><li>idç›¸åŒï¼šæ‰§è¡Œé¡ºåºç”±ä¸Šè€Œä¸‹</li><li>idä¸åŒï¼šå¦‚æœæ˜¯å­æŸ¥è¯¢ï¼Œidä¼šè‡ªå¢ï¼›idè¶Šå¤§ï¼Œä¼˜å…ˆçº§è¶Šé«˜</li><li>idç›¸åŒçš„ä¸åŒçš„åŒæ—¶å­˜åœ¨</li></ul></li><li>idåˆ—å°¾NULLè¡¨ç¤ºè¿™æ˜¯ä¸ªç»“æœé›†ï¼Œä¸éœ€è¦ç”¨æ¥è¿›è¡ŒæŸ¥è¯¢</li></ul><h6 id="select-typeï¼ˆé‡è¦ï¼‰"><a href="#select-typeï¼ˆé‡è¦ï¼‰" class="headerlink" title="select_typeï¼ˆé‡è¦ï¼‰"></a>select_typeï¼ˆé‡è¦ï¼‰</h6><p>æŸ¥è¯¢ç±»å‹ï¼Œä¸»è¦ç”¨äºåŒºåˆ†æ™®é€šæŸ¥è¯¢ã€è”åˆæŸ¥è¯¢ï¼ˆunion,union allï¼‰ã€å­æŸ¥è¯¢ã€‚</p><ul><li>simple:ä¸éœ€è¦ä½¿ç”¨unionæ“ä½œæˆ–è€…åŒ…å«å­æŸ¥è¯¢çš„ç®€å•selectæŸ¥è¯¢ã€‚æœ‰è¿æ¥æŸ¥è¯¢æ—¶ï¼Œå¤–å±‚çš„æŸ¥è¯¢ä¹Ÿæ˜¯simpleï¼Œæœ‰ä¸”åªæœ‰ä¸€ä¸ªã€‚</li></ul><ul><li>primary:éœ€è¦unionæ’åº§æˆ–è€…å«æœ‰å­æŸ¥è¯¢ï¼Œä½äºæœ€å¤–å±‚çš„å•ä½æŸ¥è¯¢çš„select_typeæ˜¯primary</li></ul><pre><code class="hljs mysql">mysql&gt; explain select (select name from user where name&#x3D;&#39;xxxx&#39;) from user;+----+-------------+-------+------------+-------+---------------+-----------+---------+-------+------+----------+-------------+| id | select_type | table | partitions | type  | possible_keys | key       | key_len | ref   | rows | filtered | Extra       |+----+-------------+-------+------------+-------+---------------+-----------+---------+-------+------+----------+-------------+|  1 | PRIMARY     | user  | NULL       | index | NULL          | index_com | 198     | NULL  |    9 |   100.00 | Using index ||  2 | SUBQUERY    | user  | NULL       | ref   | index_com     | index_com | 99      | const |    1 |   100.00 | Using index |+----+-------------+-------+------------+-------+---------------+-----------+---------+-------+------+----------+-------------+2 rows in set (0.00 sec)</code></pre><ul><li>subqueryï¼šé™¤äº†fromå­å¥ä¸­åŒ…å«çš„å­æŸ¥è¯¢å¤–ï¼Œå…¶ä»–åœ°æ–¹å‡ºç°çš„å­æŸ¥è¯¢éƒ½å¯èƒ½æ˜¯subquery</li></ul><pre><code class="hljs mysql">mysql&gt; explain select * from user where id&#x3D;(select max(id) from user);+----+-------------+-------+------------+-------+---------------+---------+---------+-------+------+----------+------------------------------+| id | select_type | table | partitions | type  | possible_keys | key     | key_len | ref   | rows | filtered | Extra                        |+----+-------------+-------+------------+-------+---------------+---------+---------+-------+------+----------+------------------------------+|  1 | PRIMARY     | user  | NULL       | const | PRIMARY       | PRIMARY | 4       | const |    1 |   100.00 | NULL                         ||  2 | SUBQUERY    | NULL  | NULL       | NULL  | NULL          | NULL    | NULL    | NULL  | NULL |     NULL | Select tables optimized away |+----+-------------+-------+------------+-------+---------------+---------+---------+-------+------+----------+------------------------------+2 rows in set (0.00 sec)</code></pre><ul><li>dependent subquery:ä¸dependent unionç±»ä¼¼ï¼Œè¡¨ç¤ºè¿™ä¸ªsubqueryçš„æŸ¥è¯¢å—å¤–éƒ¨æŸ¥è¯¢çš„å½±å“</li></ul><pre><code class="hljs mysql">mysql&gt; explain select id, name,(select name from dep d where d.dep&#x3D;u.id) from user u;+----+--------------------+-------+------------+-------+---------------+-----------+---------+------+------+----------+-------------+| id | select_type        | table | partitions | type  | possible_keys | key       | key_len | ref  | rows | filtered | Extra       |+----+--------------------+-------+------------+-------+---------------+-----------+---------+------+------+----------+-------------+|  1 | PRIMARY            | u     | NULL       | index | NULL          | index_com | 198     | NULL |    9 |   100.00 | Using index ||  2 | DEPENDENT SUBQUERY | d     | NULL       | ALL   | NULL          | NULL      | NULL    | NULL |    2 |    50.00 | Using where |+----+--------------------+-------+------------+-------+---------------+-----------+---------+------+------+----------+-------------+2 rows in set (0.00 sec)</code></pre><ul><li>union:unionè¿æ¥çš„ä¸¤ä¸ªæŸ¥è¯¢ï¼Œç¬¬ä¸€ä¸ªæ˜¯primaryï¼Œé™¤ç¬¬ä¸€ä¸ªå¤–çš„ï¼Œéƒ½æ˜¯union</li></ul><pre><code class="hljs mysql">mysql&gt; explain select * from user where name&#x3D;&#39;xxxx&#39; union select * from user where name&#x3D;&#39;zhangsan&#39;;+----+--------------+------------+------------+------+---------------+-----------+---------+-------+------+----------+-----------------+| id | select_type  | table      | partitions | type | possible_keys | key       | key_len | ref   | rows | filtered | Extra           |+----+--------------+------------+------------+------+---------------+-----------+---------+-------+------+----------+-----------------+|  1 | PRIMARY      | user       | NULL       | ref  | index_com     | index_com | 99      | const |    1 |   100.00 | Using index     ||  2 | UNION        | user       | NULL       | ref  | index_com     | index_com | 99      | const |    1 |   100.00 | Using index     || NULL | UNION RESULT | &lt;union1,2&gt; | NULL       | ALL  | NULL          | NULL      | NULL    | NULL  | NULL |     NULL | Using temporary |+----+--------------+------------+------------+------+---------------+-----------+---------+-------+------+----------+-----------------+3 rows in set (0.00 sec)</code></pre><ul><li><p>dependent union:ä¸unionä¸€æ ·ï¼Œå‡ºç°unionæˆ–è€…union allè¯­å¥ä¸­ï¼Œè¡¨ç¤ºæŸ¥è¯¢å—å¤–éƒ¨è¡¨æŸ¥è¯¢çš„å½±å“</p></li><li><p>union result:åŒ…å«unionçš„ç»“æœé›†ï¼Œidä¸ºNULL</p></li><li><p>Derived:fromå­å¥ä¸­å‡ºç°çš„å­æŸ¥è¯¢ï¼Œä¹Ÿå«åšæ´¾ç”Ÿè¡¨</p></li></ul><h6 id="table"><a href="#table" class="headerlink" title="table"></a>table</h6><p>è¡¨å ï¼ŒæŸ¥è¯¢ä¸­ä½¿ç”¨äº†åˆ«åï¼Œè¿™é‡Œå°±æ˜¾ç¤ºåˆ«å</p><h6 id="typeï¼ˆé‡è¦ï¼‰"><a href="#typeï¼ˆé‡è¦ï¼‰" class="headerlink" title="typeï¼ˆé‡è¦ï¼‰"></a>typeï¼ˆé‡è¦ï¼‰</h6><p>ä¾æ¬¡ç”±å¥½åˆ°å·®</p><pre><code class="hljs pgsql"><span class="hljs-keyword">system</span>, const, eq_ref, <span class="hljs-keyword">ref</span>, fulltext, ref_or_null, unique_subquery, index_subquery, range, index_merge, <span class="hljs-keyword">index</span>, <span class="hljs-keyword">ALL</span></code></pre><p>é™¤äº†ALLï¼Œå…¶ä»–ç±»å‹éƒ½å¯ä»¥ç”¨åˆ°ç´¢å¼•ï¼›</p><p>é™¤äº†index_mergeï¼Œå…¶ä»–typeå€¼å¯ä»¥ç”¨åˆ°ä¸€ä¸ªç´¢å¼•</p><ul><li>systemï¼šè¡¨ä¸­åªæœ‰ä¸€è¡Œæˆ–è€…æ˜¯ç©ºè¡¨</li><li>constï¼ˆé‡è¦ï¼‰ï¼šä½¿ç”¨å”¯ä¸€ç´¢å¼•æˆ–è€…ä¸»é”®ç´¢å¼•</li></ul><pre><code class="hljs mysql">mysql&gt; explain select * from user where id&#x3D;1;+----+-------------+-------+------------+-------+---------------+---------+---------+-------+------+----------+-------+| id | select_type | table | partitions | type  | possible_keys | key     | key_len | ref   | rows | filtered | Extra |+----+-------------+-------+------------+-------+---------------+---------+---------+-------+------+----------+-------+|  1 | SIMPLE      | user  | NULL       | const | PRIMARY       | PRIMARY | 4       | const |    1 |   100.00 | NULL  |+----+-------------+-------+------------+-------+---------------+---------+---------+-------+------+----------+-------+</code></pre><ul><li>eq_refï¼ˆé‡è¦ï¼‰ï¼š è¿æ¥å­—æ®µä¸»é”®æˆ–è€…å”¯ä¸€ç´¢å¼•</li></ul><p>é€šå¸¸å‡ºç°åœ¨å¤šè¡¨çš„joinæŸ¥è¯¢ï¼Œè¡¨ç¤ºå¯¹äºå‰è¡¨çš„æ¯ä¸€ä¸ªç»“æœï¼Œéƒ½<strong>åªèƒ½åŒ¹é…åˆ°åè¡¨çš„ä¸€è¡Œç»“æœ</strong>ï¼Œå¹¶ä¸”æŸ¥è¯¢åˆ°é¢æ¯”è¾ƒæ“ä½œé€šå¸¸æ˜¯â€œ=â€ï¼Œæ•ˆç‡æ›´é«˜</p><pre><code class="hljs mysql">mysql&gt; explain select a.id from user a left join dep b on a.dep&#x3D;b.id;+----+-------------+-------+------------+--------+---------------+---------+---------+------------+------+----------+-------------+| id | select_type | table | partitions | type   | possible_keys | key     | key_len | ref        | rows | filtered | Extra       |+----+-------------+-------+------------+--------+---------------+---------+---------+------------+------+----------+-------------+|  1 | SIMPLE      | a     | NULL       | ALL    | NULL          | NULL    | NULL    | NULL       |    9 |   100.00 | NULL        ||  1 | SIMPLE      | b     | NULL       | eq_ref | PRIMARY       | PRIMARY | 4       | test.a.dep |    1 |   100.00 | Using index |+----+-------------+-------+------------+--------+---------------+---------+---------+------------+------+----------+-------------+</code></pre><ul><li>refï¼ˆé‡è¦ï¼‰ï¼šé’ˆå¯¹éå”¯ä¸€ç´¢å¼•ï¼Œä½¿ç”¨ç­‰å€¼ï¼ˆ=ï¼‰æŸ¥è¯¢éä¸»é”®ï¼Œæˆ–è€…ä½¿ç”¨äº†æœ€å·¦å‰ç¼€åŸåˆ™ç´¢å¼•çš„æŸ¥è¯¢</li></ul><pre><code class="hljs mysql">mysql&gt; explain select * from user where name&#x3D;&#39;xxx&#39;;+----+-------------+-------+------------+------+---------------+-----------+---------+-------+------+----------+-------+| id | select_type | table | partitions | type | possible_keys | key       | key_len | ref   | rows | filtered | Extra |+----+-------------+-------+------------+------+---------------+-----------+---------+-------+------+----------+-------+|  1 | SIMPLE      | user  | NULL       | ref  | index_com     | index_com | 99      | const |    2 |   100.00 | NULL  |+----+-------------+-------+------------+------+---------------+-----------+---------+-------+------+----------+-------+1 row in set (0.00 sec)mysql&gt; explain select * from user where name&#x3D;&#39;xxx&#39; and age&#x3D;2;+----+-------------+-------+------------+------+---------------+-----------+---------+-------+------+----------+-----------------------+| id | select_type | table | partitions | type | possible_keys | key       | key_len | ref   | rows | filtered | Extra                 |+----+-------------+-------+------------+------+---------------+-----------+---------+-------+------+----------+-----------------------+|  1 | SIMPLE      | user  | NULL       | ref  | index_com     | index_com | 99      | const |    2 |    11.11 | Using index condition |+----+-------------+-------+------------+------+---------------+-----------+---------+-------+------+----------+-----------------------+1 row in set (0.01 sec)</code></pre><ul><li>fulltextï¼šå…¨æ–‡ç´¢å¼•æ£€ç´¢</li><li>ref_or_nullï¼šä¸refç±»ä¼¼ï¼Œåªæ˜¯å¢åŠ äº†nullå€¼çš„æ¯”è¾ƒï¼Œå®é™…ä¸Šç”¨çš„ä¸å¤š</li><li>unique_subqueryï¼šç”¨äºwhereä¸­çš„inå½¢å¼å­æŸ¥è¯¢ï¼Œå­æŸ¥è¯¢è¿”å›ä¸é‡å¤å”¯ä¸€å€¼</li><li>index_subqueryï¼šç”¨äºinå½¢å¼å­æŸ¥è¯¢ä½¿ç”¨åˆ°è¾…åŠ©ç´¢å¼•æˆ–è€…inå¸¸æ•°åˆ—è¡¨ï¼Œå­æŸ¥è¯¢å¯èƒ½è¿”å›é‡å¤å€¼ï¼Œå¯ä»¥ä½¿ç”¨ç´¢å¼•å°†å­æŸ¥è¯¢å»é‡</li><li>rangeï¼ˆé‡è¦ï¼‰ï¼š<strong>ç´¢å¼•èŒƒå›´æ‰«æ</strong>ï¼Œå¸¸è§äº&gt;, &lt;, is null, between, in, likeç­‰è¿ç®—ç¬¦çš„æŸ¥è¯¢</li></ul><pre><code class="hljs mysql">mysql&gt; explain select * from user where name&#x3D;&#39;xxx&#39; and age&gt;3;+----+-------------+-------+------------+-------+---------------+-----------+---------+------+------+----------+-----------------------+| id | select_type | table | partitions | type  | possible_keys | key       | key_len | ref  | rows | filtered | Extra                 |+----+-------------+-------+------------+-------+---------------+-----------+---------+------+------+----------+-----------------------+|  1 | SIMPLE      | user  | NULL       | range | index_com     | index_com | 104     | NULL |    1 |   100.00 | Using index condition |+----+-------------+-------+------------+-------+---------------+-----------+---------+------+------+----------+-----------------------+1 row in set (0.00 sec)</code></pre><ul><li>index_mergeï¼šè¡¨ç¤ºä½¿ç”¨ä¸¤ä¸ªä»¥ä¸Šçš„ç´¢å¼•ï¼Œæœ€åå»äº¤é›†æˆ–è€…å¹¶é›†ã€‚å¸¸è§and, orçš„æ¡ä»¶ä½¿ç”¨ä¸åŒçš„ç´¢å¼•ã€‚å®˜æ–¹æ’åºè¿™ä¸ªåœ¨ref_or_nullä¹‹åï¼Œä½†å®é™…ä¸Šç”±äºè¦è¯»å–æ‰€æœ‰ç´¢å¼•ï¼Œæ€§èƒ½å¤§éƒ¨åˆ†æ—¶é—´ä¸å¦‚range</li><li>indexï¼ˆé‡è¦ï¼‰ï¼š<strong>å…³é”®å­—ï¼šæ¡ä»¶æ˜¯å‡ºç°åœ¨ç´¢å¼•æ ‘ä¸­çš„èŠ‚ç‚¹ã€‚å¯èƒ½æ²¡æœ‰å®Œå…¨åŒ¹é…ç´¢å¼•</strong></li></ul><p><strong>ç´¢å¼•å…¨è¡¨æ‰«æ</strong>ï¼ŒæŠŠç´¢å¼•ä»å¤´åˆ°å°¾æ‰«ä¸€éï¼Œå¸¸è§äºä½¿ç”¨ç´¢å¼•åˆ—å°±å¯ä»¥å¤„ç†ï¼Œä¸éœ€è¦è¯»å–æ–‡ä»¶æŸ¥è¯¢ï¼Œå¯ä»¥ä½¿ç”¨ç´¢å¼•æ’åºæˆ–è€…åˆ†ç»„çš„æŸ¥è¯¢ã€‚</p><pre><code class="hljs mysql">mysql&gt; explain select * from user order by id;+----+-------------+-------+------------+-------+---------------+---------+---------+------+------+----------+-------+| id | select_type | table | partitions | type  | possible_keys | key     | key_len | ref  | rows | filtered | Extra |+----+-------------+-------+------------+-------+---------------+---------+---------+------+------+----------+-------+|  1 | SIMPLE      | user  | NULL       | index | NULL          | PRIMARY | 4       | NULL |    9 |   100.00 | NULL  |+----+-------------+-------+------------+-------+---------------+---------+---------+------+------+----------+-------+1 row in set (0.00 sec)</code></pre><ul><li>ALLï¼šå…¨è¡¨æ‰«æ</li></ul><h6 id="possible-keys"><a href="#possible-keys" class="headerlink" title="possible_keys"></a>possible_keys</h6><p>æ­¤æ¬¡æŸ¥è¯¢ä¸­å¯èƒ½é€‰ç”¨çš„ç´¢å¼•ï¼Œä¸€ä¸ªæˆ–å¤šä¸ª</p><h6 id="key"><a href="#key" class="headerlink" title="key"></a>key</h6><p>æŸ¥è¯¢çœŸæ­£ä½¿ç”¨åˆ°çš„ç´¢å¼•ã€‚select_typeä¸ºindex_mergeæ—¶ï¼Œè¿™é‡Œå¯èƒ½ä¼šå‡ºç°ä¸¤ä¸ªä»¥ä¸Šç´¢å¼•ï¼›å…¶ä»–æƒ…å†µï¼Œselect_typeåªä¼šå‡ºç°ä¸€ä¸ª</p><h6 id="key-len"><a href="#key-len" class="headerlink" title="key_len"></a>key_len</h6><ul><li>ç”¨äºå¤„ç†æŸ¥è¯¢çš„ç´¢å¼•é•¿åº¦ã€‚å¦‚æœæ˜¯å•åˆ—ç´¢å¼•ï¼Œé‚£å°±æ•´ä¸ªç´¢å¼•ç®—è¿›å»ï¼›å¦‚æœæ˜¯å¤šåˆ—ç´¢å¼•ï¼Œé‚£ä¹ˆæŸ¥è¯¢ä¸ä¸€å®šæ˜¯æ‰€æœ‰çš„åˆ—ã€‚</li><li>å¦å¤–ï¼Œ<em>key_len</em>æŒ‡æç«¯<em>where</em>æ¡ä»¶ä¸­ç”¨åˆ°çš„ç´¢å¼•é•¿åº¦ï¼Œè€Œæ’åºå’Œåˆ†ç»„è‹¦çŸ­ç”¨åˆ°äº†ç´¢å¼•ï¼Œä¹Ÿä¸ä¼šè®¡ç®—åˆ°<em>key_len</em>ä¸­ã€‚</li><li>ä¸æ˜¯å‡†ç¡®å€¼</li></ul><pre><code class="hljs mysql">mysql&gt; explain select * from user where id&#x3D;1;+----+-------------+-------+------------+-------+---------------+---------+---------+-------+------+----------+-------+| id | select_type | table | partitions | type  | possible_keys | key     | key_len | ref   | rows | filtered | Extra |+----+-------------+-------+------------+-------+---------------+---------+---------+-------+------+----------+-------+|  1 | SIMPLE      | user  | NULL       | const | PRIMARY       | PRIMARY | 4       | const |    1 |   100.00 | NULL  |+----+-------------+-------+------------+-------+---------------+---------+---------+-------+------+----------+-------+1 row in set (0.01 sec)intä¸º4</code></pre><h6 id="ref"><a href="#ref" class="headerlink" title="ref"></a>ref</h6><ul><li>å¦‚æœä½¿ç”¨çš„æ˜¯å¸¸æ•°ç­‰å€¼ï¼Œè¿™é‡Œå›ç°å®const</li><li>å¦‚æœæ˜¯é“¾æ¥æŸ¥è¯¢ï¼Œè¢«é©±åŠ¨è¡¨çš„æ‰§è¡Œè®¡åˆ’è¿™é‡Œä¼šæ˜¾ç¤ºé©±åŠ¨è¡¨çš„å…³è”å­—æ®µ</li><li>å¦‚æœæ˜¯æ¡ä»¶ä½¿ç”¨è¡¨è¾¾å¼æˆ–è€…å‡½æ•°ï¼Œæˆ–è€…æ¡ä»¶åˆ—å‘ç”Ÿå†…éƒ¨éšå¼è½¬æ¢ï¼Œè¿™é‡Œå¯èƒ½ä¼šæ˜¾ç¤ºfunc</li></ul><h6 id="rows"><a href="#rows" class="headerlink" title="rows"></a>rows</h6><p>è¿™é‡Œæ˜¯æ‰§è¡Œè®¡åˆ’ä¸­ä¼°ç®—çš„æ‰«æè¡Œæ•°ï¼Œä¸æ˜¯ç²¾ç¡®å€¼ï¼ˆInnoDBä¸æ˜¯ç²¾ç¡®å€¼ï¼ŒMyISAMæ˜¯ç²¾ç¡®å€¼ï¼Œä¸»è¦åŸå› æ˜¯InnoDBé‡Œé¢ä½¿ç”¨äº†MVCCå¹¶å‘æœºåˆ¶ï¼‰</p><h6 id="Extraï¼ˆé‡è¦ï¼‰"><a href="#Extraï¼ˆé‡è¦ï¼‰" class="headerlink" title="Extraï¼ˆé‡è¦ï¼‰"></a>Extraï¼ˆé‡è¦ï¼‰</h6><p>è¿™ä¸€åˆ—åŒ…å«ä¸é€‚åˆå…¶ä»–åˆ—æ˜¾ç¤ºä½†éå¸¸é‡è¦çš„é¢å¤–ä¿¡æ¯ã€‚</p><p><strong>using temporary</strong></p><ul><li>è¡¨ç¤ºä½¿ç”¨äº†ä¸´æ—¶è¡¨</li><li>MySQLåœ¨å¯¹æ¯”æŸ¥è¯¢ç»“æœ<em>order by</em> å’Œ<em>group by</em></li><li>ä¸´æ—¶è¡¨å¯ä»¥æ˜¯å†…å­˜ä¸´æ—¶è¡¨å’Œç£ç›˜ä¸´æ—¶è¡¨ï¼Œæ‰§è¡Œè®¡åˆ’ä¸­çœ‹ä¸å‡ºæ¥ï¼Œéœ€è¦æŸ¥çœ‹statuså˜é‡ï¼ˆused_tmp_table, used_tmp_disk_tableï¼‰æ‰èƒ½çœ‹å‡ºæ¥</li></ul><pre><code class="hljs mysql">mysql&gt; explain select distinct a.id from user a,dep b where a.dep&#x3D;b.id;+----+-------------+-------+------------+-------+-------------------+---------+---------+------+------+----------+----------------------------------------------------+| id | select_type | table | partitions | type  | possible_keys     | key     | key_len | ref  | rows | filtered | Extra                                              |+----+-------------+-------+------------+-------+-------------------+---------+---------+------+------+----------+----------------------------------------------------+|  1 | SIMPLE      | b     | NULL       | index | PRIMARY           | PRIMARY | 4       | NULL |    2 |   100.00 | Using index; Using temporary                       ||  1 | SIMPLE      | a     | NULL       | ALL   | PRIMARY,index_com | NULL    | NULL    | NULL |    9 |    11.11 | Using where; Using join buffer (Block Nested Loop) |+----+-------------+-------+------------+-------+-------------------+---------+---------+------+------+----------+----------------------------------------------------+2 rows in set (0.03 sec)</code></pre><p><strong>no tables used</strong></p><p>ä¸å¸¦fromå­å¥çš„æŸ¥è¯¢æˆ–è€…From dualæŸ¥è¯¢ï¼ˆoracleæ“ä½œï¼‰</p><p><em>ä½¿ç”¨not in()å½¢å¼å­æŸ¥è¯¢æˆ–è€…not existsè¿ç®—ç¬¦çš„è¿æ¥æŸ¥è¯¢ï¼ˆåè¿æ¥ï¼‰</em></p><p>å³ï¼Œä¸€èˆ¬é“¾æ¥æŸ¥è¯¢æ˜¯å…ˆæŸ¥è¯¢å“ªè¡¨ï¼Œå†æŸ¥è¯¢å¤–è¡¨ï¼›åè¿æ¥æ˜¯å…ˆæŸ¥è¯¢å¤–è¡¨ï¼Œå†æŸ¥è¯¢å†…è¡¨ã€‚</p><pre><code class="hljs mysql">mysql&gt; explain select now();+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+----------------+| id | select_type | table | partitions | type | possible_keys | key  | key_len | ref  | rows | filtered | Extra          |+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+----------------+|  1 | SIMPLE      | NULL  | NULL       | NULL | NULL          | NULL | NULL    | NULL | NULL |     NULL | No tables used |+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+----------------+1 row in set (0.00 sec)</code></pre><p><strong>using filesort(é‡è¦)</strong></p><ul><li>æ’åºæ—¶æ— æ³•ä½¿ç”¨åˆ°ç´¢å¼•ä¼šå‡ºç°è¿™ä¸ªï¼Œå¸¸è§äºorder by å’Œgroup byè¯­å¥ä¸­</li><li>è¯´æ˜MySQLä¼šä½¿ç”¨ä¸€ä¸ªå¤–éƒ¨çš„ç´¢å¼•æ’åºï¼Œè€Œä¸æ˜¯æŒ‰ç…§ç´¢å¼•é¡ºåºè¿›è¡Œè¯»å–</li><li>MySQLä¸­æ— æ³•åˆ©ç”¨ç´¢å¼•å®Œæˆçš„æ’åºæ“ä½œç§°ä¸ºâ€œæ–‡ä»¶æ’åºâ€</li></ul><pre><code class="hljs mysql">mysql&gt; explain select * from user order by dep;+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+----------------+| id | select_type | table | partitions | type | possible_keys | key  | key_len | ref  | rows | filtered | Extra          |+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+----------------+|  1 | SIMPLE      | user  | NULL       | ALL  | NULL          | NULL | NULL    | NULL |    9 |   100.00 | Using filesort |+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+----------------+1 row in set (0.00 sec)</code></pre><p><strong>using index(é‡è¦)</strong></p><p>æŸ¥è¯¢æ—¶<em>ä¸éœ€è¦å›è¡¨æŸ¥è¯¢</em>,ç›´æ¥é€šè¿‡ç´¢å¼•å°±å¯ä»¥è·å–æŸ¥è¯¢çš„æ•°æ®</p><ul><li>è¡¨ç¤ºæƒ³é†’çš„selectæŸ¥è¯¢ä¸­ä½¿ç”¨åˆ°äº†è¦†ç›–ç´¢å¼•ï¼Œé¿å…è®¿é—®è¡¨çš„æ•°æ®è¡Œï¼Œæ•ˆç‡ä¸é”™</li><li>å¦‚æœåŒæ—¶ä½¿ç”¨Using whereï¼Œè¯´æ˜ç´¢å¼•è¢«ç”¨æ¥æŸ¥æ‰¾ç´¢å¼•é”®å€¼</li><li>å¦‚æœæ²¡æœ‰åŒæ—¶å‡ºç°Using whereï¼Œè¡¨æ˜ç´¢å¼•ç”¨æ¥è¯»å–æ•°æ®è€Œéæ‰§è¡ŒæŸ¥æ‰¾åŠ¨ä½œ</li></ul><pre><code class="hljs mysql">mysql&gt; explain select name, age from user where name&#x3D;&#39;xxx&#39;;+----+-------------+-------+------------+------+---------------+-----------+---------+-------+------+----------+-------------+| id | select_type | table | partitions | type | possible_keys | key       | key_len | ref   | rows | filtered | Extra       |+----+-------------+-------+------------+------+---------------+-----------+---------+-------+------+----------+-------------+|  1 | SIMPLE      | user  | NULL       | ref  | index_com     | index_com | 99      | const |    2 |   100.00 | Using index |+----+-------------+-------+------------+------+---------------+-----------+---------+-------+------+----------+-------------+1 row in set, (0.01 sec)</code></pre><p><strong>using where(é‡è¦)</strong></p><p>è¡¨ç¤ºå­˜å‚¨å¼•æ“è¿”å›çš„è®°å½•å¹¶ä¸æ˜¯æ‰€æœ‰éƒ½æ»¡è¶³æŸ¥è¯¢æ¡ä»¶ï¼Œéœ€è¦serverå±‚è¿›è¡Œè¿‡æ»¤ã€‚æ•ˆç‡æ¯”è¾ƒä½</p><pre><code class="hljs mysql">mysql&gt; explain select * from user where age&#x3D;23;+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+-------------+| id | select_type | table | partitions | type | possible_keys | key  | key_len | ref  | rows | filtered | Extra       |+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+-------------+|  1 | SIMPLE      | user  | NULL       | ALL  | NULL          | NULL | NULL    | NULL |    9 |    11.11 | Using where |+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+-------------+1 row in set (0.00 sec)mysql&gt; explain select name, age from user where name&#x3D;&#39;xxx&#39; order by id;+----+-------------+-------+------------+------+---------------+-----------+---------+-------+------+----------+------------------------------------------+| id | select_type | table | partitions | type | possible_keys | key       | key_len | ref   | rows | filtered | Extra                                    |+----+-------------+-------+------------+------+---------------+-----------+---------+-------+------+----------+------------------------------------------+|  1 | SIMPLE      | user  | NULL       | ref  | index_com     | index_com | 99      | const |    2 |   100.00 | Using where; Using index; Using filesort |+----+-------------+-------+------------+------+---------------+-----------+---------+-------+------+----------+------------------------------------------+1 row in set (0.00 sec)</code></pre><p>æŸ¥è¯¢æ¡ä»¶ä¸­æ°›å›´é™åˆ¶æ¡ä»¶å’Œæ£€æŸ¥æ¡ä»¶ã€‚5.6ä¹‹å‰ï¼Œå­˜å‚¨å¼•æ“åªèƒ½ä½¿ç”¨é™å®šæ¡ä»¶æ‰«ææ•°æ®å¹¶è¿”å›ï¼Œç„¶åserverå±‚æ ¹æ®æ£€æŸ¥æ¡ä»¶è¿›è¡Œè¿‡æ»¤è¿”å›çœŸæ­£ç¬¦åˆæŸ¥è¯¢çš„æ•°æ®ã€‚5.6.xä¹‹åæ”¯æŒ<em>ICP</em>ç‰¹æ€§ï¼Œå¯ä»¥æŠŠæ£€æŸ¥æ¡ä»¶é¡µä¸‹æ¨å€’å­˜å‚¨å¼•æ“å±‚ï¼Œä¸ç¬¦åˆæ£€æŸ¥æ¡ä»¶å’Œé™åˆ¶æ¡ä»¶çš„æ•°æ®ï¼Œç›´æ¥ä¸è¯»å–ï¼Œè¿™æ ·å°±å¤§å¤§å‡å°‘äº†å­˜å‚¨å¼•æ“å±‚æ‰«æçš„è®°å½•æ•°é‡ã€‚Extraåˆ—æ˜¾ç¤ºusing index conditionã€‚</p><pre><code class="hljs mysql">mysql&gt; explain select * from user where name&#x3D;&#39;xxx&#39; and age&gt;3;+----+-------------+-------+------------+-------+---------------+-----------+---------+------+------+----------+-----------------------+| id | select_type | table | partitions | type  | possible_keys | key       | key_len | ref  | rows | filtered | Extra                 |+----+-------------+-------+------------+-------+---------------+-----------+---------+------+------+----------+-----------------------+|  1 | SIMPLE      | user  | NULL       | range | index_com     | index_com | 104     | NULL |    1 |   100.00 | Using index condition |+----+-------------+-------+------------+-------+---------------+-----------+---------+------+------+----------+-----------------------+1 row in set (0.00 sec)mysql&gt; explain select * from user where name like &#39;xx%&#39;;+----+-------------+-------+------------+-------+---------------+-----------+---------+------+------+----------+-----------------------+| id | select_type | table | partitions | type  | possible_keys | key       | key_len | ref  | rows | filtered | Extra                 |+----+-------------+-------+------------+-------+---------------+-----------+---------+------+------+----------+-----------------------+|  1 | SIMPLE      | user  | NULL       | range | index_com     | index_com | 99      | NULL |    3 |   100.00 | Using index condition |+----+-------------+-------+------------+-------+---------------+-----------+---------+------+------+----------+-----------------------+1 row in set (0.00 sec)</code></pre><p><strong>firstmatch(tb_name)</strong></p><p>5.6.xå¼€å§‹å¼•å…¥çš„ä¼˜åŒ–å­æŸ¥è¯¢çš„æ–°ç‰¹æ€§ä¹‹ä¸€ï¼Œå¸¸è§äºwhereå­å¥å«æœ‰in()ç±»å‹çš„å­æŸ¥è¯¢ã€‚å¦‚æœå†…è¡¨çš„æ•°æ®é‡æ¯”è¾ƒå¤§ï¼Œå°±å¯èƒ½å‡ºç°è¿™ä¸ªã€‚</p><p><strong>loosescan(m..n)</strong></p><p>5.6.xä¹‹åå¼•å…¥çš„ä¼˜åŒ–å­æŸ¥è¯¢çš„æ–°ç‰¹æ€§ä¹‹ä¸€ï¼Œåœ¨in()ç±»å‹çš„å­æŸ¥è¯¢ä¸­ï¼Œå­æŸ¥è¯¢è¿”å›çš„å¯èƒ½æœ‰é‡å¤è®°å½•æ—¶ï¼Œå°±å¯èƒ½å‡ºç°è¿™ä¸ª.</p><p>é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰å¾ˆå¤šæŸ¥è¯¢æ•°æ®å­—å…¸åº“ï¼Œæ‰§è¡Œè®¡åˆ’è¿‡ç¨‹ä¸­å‘ç°ä¸å¯èƒ½å­˜åœ¨ç»“æœçš„ä¸€äº›æç¤ºä¿¡æ¯</p><h6 id="filtered"><a href="#filtered" class="headerlink" title="filtered"></a>filtered</h6><p>ä½¿ç”¨explain extendedæ—¶ä¼šå‡ºç°è¿™ä¸ªã€‚5.7ä¹‹åçš„ç‰ˆæœ¬é»˜è®¤ä¼šæœ‰è¿™ä¸ªå­—æ®µï¼ˆä¸éœ€è¦ä½¿ç”¨explain extendedï¼‰ã€‚è¿™ä¸ªå­—æ®µè¡¨ç¤ºå­˜å‚¨å¼•æ“è¿”å›çš„æ•°æ®åœ¨serverå±‚è¿‡æ»¤åï¼Œå‰©ä¸‹å¤šå°‘æ»¡è¶³æŸ¥è¯¢çš„è®°å½•æ¯”ä¾‹ï¼ˆ100%ä¸æ˜¯å…·ä½“è®°å½•æ•°ï¼‰ã€‚</p><h4 id="ç›¸å…³é¢è¯•é¢˜"><a href="#ç›¸å…³é¢è¯•é¢˜" class="headerlink" title="ç›¸å…³é¢è¯•é¢˜"></a>ç›¸å…³é¢è¯•é¢˜</h4><h5 id="ä»€ä¹ˆæ˜¯ç´¢å¼•ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯ç´¢å¼•ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯ç´¢å¼•ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯ç´¢å¼•ï¼Ÿ</h5><p>ç´¢å¼•æ˜¯ä¸€ç§èƒ½å¸®åŠ© MySQL æé«˜æŸ¥è¯¢æ•ˆç‡çš„æ•°æ®ç»“æ„ã€‚</p><h5 id="ç´¢å¼•åˆ†åˆ«æœ‰å“ªäº›ä¼˜ç‚¹å’Œç¼ºç‚¹ï¼Ÿ"><a href="#ç´¢å¼•åˆ†åˆ«æœ‰å“ªäº›ä¼˜ç‚¹å’Œç¼ºç‚¹ï¼Ÿ" class="headerlink" title="ç´¢å¼•åˆ†åˆ«æœ‰å“ªäº›ä¼˜ç‚¹å’Œç¼ºç‚¹ï¼Ÿ"></a>ç´¢å¼•åˆ†åˆ«æœ‰å“ªäº›ä¼˜ç‚¹å’Œç¼ºç‚¹ï¼Ÿ</h5><p>ç´¢å¼•çš„ä¼˜ç‚¹å¦‚ä¸‹ï¼š</p><ul><li><p>å¿«é€Ÿè®¿é—®æ•°æ®è¡¨ä¸­çš„ç‰¹å®šä¿¡æ¯ï¼Œæé«˜æ£€ç´¢é€Ÿåº¦ã€‚</p></li><li><p>åˆ›å»ºå”¯ä¸€æ€§ç´¢å¼•ï¼Œä¿è¯æ•°æ®è¡¨ä¸­æ¯ä¸€è¡Œæ•°æ®çš„å”¯ä¸€æ€§ã€‚</p></li><li><p>åŠ é€Ÿè¡¨ä¸è¡¨ä¹‹é—´çš„è¿æ¥ã€‚</p></li><li><p>ä½¿ç”¨åˆ†ç»„å’Œæ’åºè¿›è¡Œæ•°æ®æ£€ç´¢æ—¶ï¼Œå¯ä»¥æ˜¾è‘—å‡å°‘æŸ¥è¯¢ä¸­åˆ†ç»„å’Œæ’åºçš„æ—¶é—´ã€‚</p></li></ul><p>ç´¢å¼•çš„ç¼ºç‚¹ï¼š</p><ul><li><p>è™½ç„¶æé«˜äº†çš„æŸ¥è¯¢é€Ÿåº¦ï¼Œä½†å´é™ä½äº†æ›´æ–°è¡¨çš„é€Ÿåº¦ï¼Œæ¯”å¦‚ updateã€insertï¼Œå› ä¸ºæ›´æ–°æ•°æ®æ—¶ï¼ŒMySQL ä¸ä»…è¦æ›´æ–°æ•°æ®ï¼Œè¿˜è¦æ›´æ–°ç´¢å¼•æ–‡ä»¶ï¼›</p></li><li><p>å»ºç«‹ç´¢å¼•ä¼šå ç”¨ç£ç›˜æ–‡ä»¶çš„ç´¢å¼•æ–‡ä»¶ã€‚</p></li></ul><p>ä½¿ç”¨ç´¢å¼•æ³¨æ„äº‹é¡¹ï¼š</p><ul><li><p>ä½¿ç”¨çŸ­ç´¢å¼•ï¼ŒçŸ­ç´¢å¼•ä¸ä»…å¯ä»¥æé«˜æŸ¥è¯¢é€Ÿåº¦ï¼Œæ›´èƒ½èŠ‚çœç£ç›˜ç©ºé—´å’Œ I/O æ“ä½œï¼›</p></li><li><p>ç´¢å¼•åˆ—æ’åºï¼ŒMySQL æŸ¥è¯¢åªä½¿ç”¨ä¸€ä¸ªç´¢å¼•ï¼Œå› æ­¤å¦‚æœ where å­å¥ä¸­å·²ç»ä½¿ç”¨äº†ç´¢å¼•çš„è¯ï¼Œé‚£ä¹ˆ order by ä¸­çš„åˆ—æ˜¯ä¸ä¼šä½¿ç”¨ç´¢å¼•çš„ï¼Œå› æ­¤æ•°æ®åº“é»˜è®¤æ’åºå¯ä»¥ç¬¦åˆè¦æ±‚çš„æƒ…å†µä¸‹ï¼Œä¸è¦è¿›è¡Œæ’åºæ“ä½œï¼›å°½é‡ä¸è¦åŒ…å«å¤šä¸ªåˆ—çš„æ’åºï¼Œå¦‚æœéœ€è¦æœ€å¥½ç»™è¿™äº›åˆ—åˆ›å»ºå¤åˆç´¢å¼•ï¼›</p></li><li><p>like è¯­å¥æ“ä½œï¼Œä¸€èˆ¬æƒ…å†µä¸‹ä¸é¼“åŠ±ä½¿ç”¨ like æ“ä½œï¼Œå¦‚æœéä½¿ç”¨ä¸å¯ï¼Œ æ³¨æ„ like â€œ%aaa%â€ ä¸ä¼šä½¿ç”¨ç´¢å¼•ï¼Œè€Œlike â€œaaa%â€å¯ä»¥ä½¿ç”¨ç´¢å¼•ï¼›</p></li><li><p>ä¸è¦åœ¨åˆ—ä¸Šè¿›è¡Œè¿ç®—ï¼›</p></li><li><p>ä¸é€‚ç”¨ NOT IN å’Œ &lt;&gt; æ“ä½œã€‚</p></li></ul><h5 id="ç´¢å¼•æœ‰å‡ ç§ç±»å‹ï¼Ÿåˆ†åˆ«å¦‚ä½•åˆ›å»ºï¼Ÿ"><a href="#ç´¢å¼•æœ‰å‡ ç§ç±»å‹ï¼Ÿåˆ†åˆ«å¦‚ä½•åˆ›å»ºï¼Ÿ" class="headerlink" title="ç´¢å¼•æœ‰å‡ ç§ç±»å‹ï¼Ÿåˆ†åˆ«å¦‚ä½•åˆ›å»ºï¼Ÿ"></a>ç´¢å¼•æœ‰å‡ ç§ç±»å‹ï¼Ÿåˆ†åˆ«å¦‚ä½•åˆ›å»ºï¼Ÿ</h5><p>MySQL çš„ç´¢å¼•æœ‰ä¸¤ç§åˆ†ç±»æ–¹å¼ï¼šé€»è¾‘åˆ†ç±»å’Œç‰©ç†åˆ†ç±»ã€‚ æŒ‰ç…§é€»è¾‘åˆ†ç±»ï¼Œç´¢å¼•å¯åˆ†ä¸ºï¼š</p><ul><li><p>ä¸»é”®ç´¢å¼•ï¼šä¸€å¼ è¡¨åªèƒ½æœ‰ä¸€ä¸ªä¸»é”®ç´¢å¼•ï¼Œä¸å…è®¸é‡å¤ã€ä¸å…è®¸ä¸º NULLï¼›</p></li><li><p>å”¯ä¸€ç´¢å¼•ï¼šæ•°æ®åˆ—ä¸å…è®¸é‡å¤ï¼Œå…è®¸ä¸º NULL å€¼ï¼Œä¸€å¼ è¡¨å¯æœ‰å¤šä¸ªå”¯ä¸€ç´¢å¼•ï¼Œä½†æ˜¯ä¸€ä¸ªå”¯ä¸€ç´¢å¼•åªèƒ½åŒ…å«ä¸€åˆ—ï¼Œæ¯”å¦‚èº«ä»½è¯å·ç ã€å¡å·ç­‰éƒ½å¯ä»¥ä½œä¸ºå”¯ä¸€ç´¢å¼•ï¼›</p></li><li><p>æ™®é€šç´¢å¼•ï¼šä¸€å¼ è¡¨å¯ä»¥åˆ›å»ºå¤šä¸ªæ™®é€šç´¢å¼•ï¼Œä¸€ä¸ªæ™®é€šç´¢å¼•å¯ä»¥åŒ…å«å¤šä¸ªå­—æ®µï¼Œå…è®¸æ•°æ®é‡å¤ï¼Œå…è®¸ NULL å€¼æ’å…¥ï¼›</p></li><li><p>å…¨æ–‡ç´¢å¼•ï¼šè®©æœç´¢å…³é”®è¯æ›´é«˜æ•ˆçš„ä¸€ç§ç´¢å¼•ã€‚</p></li></ul><p>æŒ‰ç…§ç‰©ç†åˆ†ç±»ï¼Œç´¢å¼•å¯åˆ†ä¸ºï¼š</p><ul><li><p>èšé›†ç´¢å¼•ï¼šä¸€èˆ¬æ˜¯è¡¨ä¸­çš„ä¸»é”®ç´¢å¼•ï¼Œå¦‚æœè¡¨ä¸­æ²¡æœ‰æ˜¾ç¤ºæŒ‡å®šä¸»é”®ï¼Œåˆ™ä¼šé€‰æ‹©è¡¨ä¸­çš„ç¬¬ä¸€ä¸ªä¸å…è®¸ä¸º NULL çš„å”¯ä¸€ç´¢å¼•ï¼Œå¦‚æœè¿˜æ˜¯æ²¡æœ‰çš„è¯ï¼Œå°±é‡‡ç”¨ Innodb å­˜å‚¨å¼•æ“ä¸ºæ¯è¡Œæ•°æ®å†…ç½®çš„ 6 å­—èŠ‚ ROWID ä½œä¸ºèšé›†ç´¢å¼•ã€‚æ¯å¼ è¡¨åªæœ‰ä¸€ä¸ªèšé›†ç´¢å¼•ï¼Œå› ä¸ºèšé›†ç´¢å¼•çš„é”®å€¼çš„é€»è¾‘é¡ºåºå†³å®šäº†è¡¨ä¸­ç›¸åº”è¡Œçš„ç‰©ç†é¡ºåºã€‚èšé›†ç´¢å¼•åœ¨ç²¾ç¡®æŸ¥æ‰¾å’ŒèŒƒå›´æŸ¥æ‰¾æ–¹é¢æœ‰è‰¯å¥½çš„æ€§èƒ½è¡¨ç°ï¼ˆç›¸æ¯”äºæ™®é€šç´¢å¼•å’Œå…¨è¡¨æ‰«æï¼‰ï¼Œèšé›†ç´¢å¼•å°±æ˜¾å¾—å¼¥è¶³çè´µï¼Œèšé›†ç´¢å¼•é€‰æ‹©è¿˜æ˜¯è¦æ…é‡çš„ï¼ˆä¸€èˆ¬ä¸ä¼šè®©æ²¡æœ‰è¯­ä¹‰çš„è‡ªå¢ id å……å½“èšé›†ç´¢å¼•ï¼‰ï¼›</p></li><li><p>éèšé›†ç´¢å¼•ï¼šè¯¥ç´¢å¼•ä¸­ç´¢å¼•çš„é€»è¾‘é¡ºåºä¸ç£ç›˜ä¸Šè¡Œçš„ç‰©ç†å­˜å‚¨é¡ºåºä¸åŒï¼ˆéä¸»é”®çš„é‚£ä¸€åˆ—ï¼‰ï¼Œä¸€ä¸ªè¡¨ä¸­å¯ä»¥æ‹¥æœ‰å¤šä¸ªéèšé›†ç´¢å¼•ã€‚</p></li></ul><p>å„ç§ç´¢å¼•çš„åˆ›å»ºè„šæœ¬å¦‚ä¸‹ï¼š</p><pre><code class="hljs mysql">-- åˆ›å»ºä¸»é”®ç´¢å¼• alter table t add primary key add (&#96;id&#96;); -- åˆ›å»ºå”¯ä¸€ç´¢å¼• alter table t add unique (&#96;username&#96;); -- åˆ›å»ºæ™®é€šç´¢å¼• alter table t add index index_name (&#96;username&#96;); -- åˆ›å»ºå…¨æ–‡ç´¢å¼• alter table t add fulltext (&#96;username&#96;);</code></pre><h5 id="èƒ½å¦ç»™æ‰‹æœºå·çš„å‰-6-ä½åˆ›å»ºç´¢å¼•ï¼Ÿå¦‚ä½•åˆ›å»ºï¼Ÿ"><a href="#èƒ½å¦ç»™æ‰‹æœºå·çš„å‰-6-ä½åˆ›å»ºç´¢å¼•ï¼Ÿå¦‚ä½•åˆ›å»ºï¼Ÿ" class="headerlink" title="èƒ½å¦ç»™æ‰‹æœºå·çš„å‰ 6 ä½åˆ›å»ºç´¢å¼•ï¼Ÿå¦‚ä½•åˆ›å»ºï¼Ÿ"></a>èƒ½å¦ç»™æ‰‹æœºå·çš„å‰ 6 ä½åˆ›å»ºç´¢å¼•ï¼Ÿå¦‚ä½•åˆ›å»ºï¼Ÿ</h5><p>å¯ä»¥ï¼Œåˆ›å»ºæ–¹å¼æœ‰ä¸¤ç§ï¼š</p><ul><li><p><code>alter table t add index index_phone(phone(6));</code></p></li><li><p><code>create index index_phone on t(phone(6));</code></p></li></ul><h5 id="å¦‚ä½•æŸ¥è¯¢ä¸€å¼ è¡¨çš„æ‰€æœ‰ç´¢å¼•ï¼Ÿ"><a href="#å¦‚ä½•æŸ¥è¯¢ä¸€å¼ è¡¨çš„æ‰€æœ‰ç´¢å¼•ï¼Ÿ" class="headerlink" title="å¦‚ä½•æŸ¥è¯¢ä¸€å¼ è¡¨çš„æ‰€æœ‰ç´¢å¼•ï¼Ÿ"></a>å¦‚ä½•æŸ¥è¯¢ä¸€å¼ è¡¨çš„æ‰€æœ‰ç´¢å¼•ï¼Ÿ</h5><p><code>SHOW INDEX FROM T</code> æŸ¥è¯¢è¡¨ T æ‰€æœ‰ç´¢å¼•ã€‚</p><h5 id="ä¸»ç´¢å¼•å’Œå”¯ä¸€ç´¢å¼•æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"><a href="#ä¸»ç´¢å¼•å’Œå”¯ä¸€ç´¢å¼•æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ" class="headerlink" title="ä¸»ç´¢å¼•å’Œå”¯ä¸€ç´¢å¼•æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"></a>ä¸»ç´¢å¼•å’Œå”¯ä¸€ç´¢å¼•æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h5><ul><li><p>ä¸»ç´¢å¼•ä¸èƒ½é‡å¤ä¸”ä¸èƒ½ä¸ºç©ºï¼Œå”¯ä¸€ç´¢å¼•ä¸èƒ½é‡å¤ï¼Œä½†å¯ä»¥ä¸ºç©ºï¼›</p></li><li><p>ä¸€å¼ è¡¨åªèƒ½æœ‰ä¸€ä¸ªä¸»ç´¢å¼•ï¼Œä½†å¯ä»¥æœ‰å¤šä¸ªå”¯ä¸€ç´¢å¼•ï¼›</p></li><li><p>ä¸»ç´¢å¼•çš„æŸ¥è¯¢æ€§èƒ½è¦é«˜äºå”¯ä¸€ç´¢å¼•ã€‚</p></li></ul><h5 id="ä¸»ç´¢å¼•å’Œéä¸»ç´¢å¼•æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"><a href="#ä¸»ç´¢å¼•å’Œéä¸»ç´¢å¼•æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ" class="headerlink" title="ä¸»ç´¢å¼•å’Œéä¸»ç´¢å¼•æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"></a>ä¸»ç´¢å¼•å’Œéä¸»ç´¢å¼•æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h5><p>å­˜å‚¨ç»“æ„ä¸Š</p><p>â€‹    ä¸»é”®ç´¢å¼•ï¼šå¶å­èŠ‚ç‚¹å­˜å‚¨æ•´è¡Œæ•°æ®</p><p>â€‹    éä¸»é”®ç´¢å¼•ï¼šå¶å­èŠ‚ç‚¹å­˜å‚¨ä¸»é”®å€¼</p><p>æ£€ç´¢ä¸Š</p><p>â€‹    ä¸»é”®ç´¢å¼•ï¼šç›´æ¥é€šè¿‡ç´¢å¼•è·å–æ•°æ®</p><p>â€‹    éä¸»é”®ç´¢å¼•ï¼šå¯èƒ½ä¼šæœ‰å›è¡¨æŸ¥è¯¢</p><p>åˆ›å»ºæ–¹å¼ä¸Š</p><p>â€‹    ä¸»é”®ç´¢å¼•ï¼šè¡¨ä¸­ä¸»é”®è‡ªåŠ¨åˆ›å»ºï¼›è‹¥æ— ä¸»é”®ï¼Œå”¯ä¸€ç´¢å¼•+NotNullä¸»é”®ï¼›è‹¥æ²¡æœ‰ï¼Œè‡ªé‡åˆ›å»ºéšå£«åˆ—rowidåšä¸»é”®</p><p>â€‹    éä¸»é”®ç´¢å¼•ï¼šä¸»åŠ¨åˆ›å»º</p><h5 id="è¾…åŠ©ç´¢å¼•ä¸ºä»€ä¹ˆåªå­˜ä¸»é”®ï¼Ÿ"><a href="#è¾…åŠ©ç´¢å¼•ä¸ºä»€ä¹ˆåªå­˜ä¸»é”®ï¼Ÿ" class="headerlink" title="è¾…åŠ©ç´¢å¼•ä¸ºä»€ä¹ˆåªå­˜ä¸»é”®ï¼Ÿ"></a>è¾…åŠ©ç´¢å¼•ä¸ºä»€ä¹ˆåªå­˜ä¸»é”®ï¼Ÿ</h5><p>ç©ºé—´ä¸Šï¼šæˆæœ¬é«˜</p><p>æ—¶é—´ä¸Šï¼šæŸ¥è¯¢æˆæœ¬å°‘äº†ï¼Œæ’å…¥æˆæœ¬ä¸å˜ï¼Œæ›´æ–°æˆæœ¬é«˜</p><h5 id="åœ¨-InnDB-ä¸­ä¸»é”®ç´¢å¼•ä¸ºä»€ä¹ˆæ¯”æ™®é€šç´¢å¼•çš„æŸ¥è¯¢æ€§èƒ½é«˜ï¼Ÿ"><a href="#åœ¨-InnDB-ä¸­ä¸»é”®ç´¢å¼•ä¸ºä»€ä¹ˆæ¯”æ™®é€šç´¢å¼•çš„æŸ¥è¯¢æ€§èƒ½é«˜ï¼Ÿ" class="headerlink" title="åœ¨ InnDB ä¸­ä¸»é”®ç´¢å¼•ä¸ºä»€ä¹ˆæ¯”æ™®é€šç´¢å¼•çš„æŸ¥è¯¢æ€§èƒ½é«˜ï¼Ÿ"></a>åœ¨ InnDB ä¸­ä¸»é”®ç´¢å¼•ä¸ºä»€ä¹ˆæ¯”æ™®é€šç´¢å¼•çš„æŸ¥è¯¢æ€§èƒ½é«˜ï¼Ÿ</h5><p>å› ä¸ºæ™®é€šç´¢å¼•çš„æŸ¥è¯¢ä¼šå¤šæ‰§è¡Œä¸€æ¬¡æ£€ç´¢æ“ä½œã€‚</p><p>æ¯”å¦‚ä¸»é”®æŸ¥è¯¢ select * from t where id=10 åªéœ€è¦æœç´¢ id çš„è¿™æ£µ B+ æ ‘ã€‚</p><p>æ™®é€šç´¢å¼•æŸ¥è¯¢ select * from t where f=3 ä¼šå…ˆæŸ¥è¯¢ f ç´¢å¼•æ ‘ï¼Œå¾—åˆ° id çš„å€¼ä¹‹åå†å»æœç´¢ id çš„ B+ æ ‘ï¼Œå› ä¸ºå¤šæ‰§è¡Œäº†ä¸€æ¬¡æ£€ç´¢ï¼Œæ‰€ä»¥æ‰§è¡Œæ•ˆç‡å°±æ¯”ä¸»é”®ç´¢å¼•è¦ä½ã€‚</p><h5 id="å”¯ä¸€ç´¢å¼•å’Œæ™®é€šç´¢å¼•å“ªä¸ªæ€§èƒ½æ›´å¥½ï¼Ÿ"><a href="#å”¯ä¸€ç´¢å¼•å’Œæ™®é€šç´¢å¼•å“ªä¸ªæ€§èƒ½æ›´å¥½ï¼Ÿ" class="headerlink" title="å”¯ä¸€ç´¢å¼•å’Œæ™®é€šç´¢å¼•å“ªä¸ªæ€§èƒ½æ›´å¥½ï¼Ÿ"></a>å”¯ä¸€ç´¢å¼•å’Œæ™®é€šç´¢å¼•å“ªä¸ªæ€§èƒ½æ›´å¥½ï¼Ÿ</h5><ul><li><p>å¯¹äºæŸ¥è¯¢æ“ä½œæ¥è¯´ï¼šæ™®é€šç´¢å¼•å’Œå”¯ä¸€ç´¢å¼•çš„æ€§èƒ½ç›¸è¿‘ï¼Œéƒ½æ˜¯ä»ç´¢å¼•æ ‘ä¸­è¿›è¡ŒæŸ¥è¯¢ï¼›</p></li><li><p>å¯¹äºæ›´æ–°æ“ä½œæ¥è¯´ï¼šå”¯ä¸€ç´¢å¼•è¦æ¯”æ™®é€šç´¢å¼•æ‰§è¡Œçš„æ…¢ï¼Œå› ä¸ºå”¯ä¸€ç´¢å¼•éœ€è¦å…ˆå°†æ•°æ®è¯»å–åˆ°å†…å­˜ä¸­ï¼Œå†åœ¨å†…å­˜ä¸­è¿›è¡Œæ•°æ®çš„å”¯ä¸€æ•ˆéªŒï¼Œæ‰€ä»¥æ‰§è¡Œèµ·æ¥è¦æ¯”æ™®é€šç´¢å¼•æ›´æ…¢ã€‚</p></li></ul><h5 id="ä»€ä¹ˆå«å›è¡¨æŸ¥è¯¢ï¼Ÿ"><a href="#ä»€ä¹ˆå«å›è¡¨æŸ¥è¯¢ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆå«å›è¡¨æŸ¥è¯¢ï¼Ÿ"></a>ä»€ä¹ˆå«å›è¡¨æŸ¥è¯¢ï¼Ÿ</h5><p>æ™®é€šç´¢å¼•æŸ¥è¯¢åˆ°ä¸»é”®ç´¢å¼•åï¼Œå›åˆ°ä¸»é”®ç´¢å¼•æ ‘æœç´¢çš„è¿‡ç¨‹ï¼Œæˆ‘ä»¬ç§°ä¸ºå›è¡¨æŸ¥è¯¢ã€‚</p><p>å‚è€ƒSQLï¼š</p><pre><code class="hljs mysql">mysql&gt; create table T( id int primary key, k int not null, name varchar(16), index (k))engine&#x3D;InnoDB;</code></pre><p>å¦‚æœè¯­å¥æ˜¯ select * from T where ID=500ï¼Œå³ä¸»é”®æŸ¥è¯¢æ–¹å¼ï¼Œåˆ™åªéœ€è¦æ£€ç´¢ä¸»é”® ID å­—æ®µã€‚</p><pre><code class="hljs mysql">mysql&gt; select * from T where ID&#x3D;500; +-----+---+-------+ | id | k | name | +-----+---+-------+ | 500 | 5 | name5 | +-----+---+-------+</code></pre><p>å¦‚æœè¯­å¥æ˜¯ select * from T where k=5ï¼Œå³æ™®é€šç´¢å¼•æŸ¥è¯¢æ–¹å¼ï¼Œåˆ™éœ€è¦å…ˆæœç´¢ k ç´¢å¼•æ ‘ï¼Œå¾—åˆ° ID çš„å€¼ä¸º 500ï¼Œå†åˆ° ID ç´¢å¼•æ ‘æœç´¢ä¸€æ¬¡ï¼Œè¿™ä¸ªè¿‡ç¨‹ç§°ä¸ºå›è¡¨æŸ¥è¯¢ã€‚</p><pre><code class="hljs mysql">mysql&gt; select * from T where k&#x3D;5; +-----+---+-------+ | id | k | name | +-----+---+-------+ | 500 | 5 | name5 | +-----+---+-------+</code></pre><p>ä¹Ÿå°±æ˜¯è¯´ï¼ŒåŸºäºéä¸»é”®ç´¢å¼•çš„æŸ¥è¯¢éœ€è¦å¤šæ‰«æä¸€æ£µç´¢å¼•æ ‘ã€‚å› æ­¤ï¼Œæˆ‘ä»¬åœ¨åº”ç”¨ä¸­åº”è¯¥å°½é‡ä½¿ç”¨ä¸»é”®æŸ¥è¯¢ã€‚</p><h5 id="ä»¥ä¸‹-SQL-æœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿè¯¥å¦‚ä½•ä¼˜åŒ–ï¼Ÿ"><a href="#ä»¥ä¸‹-SQL-æœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿè¯¥å¦‚ä½•ä¼˜åŒ–ï¼Ÿ" class="headerlink" title="ä»¥ä¸‹ SQL æœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿè¯¥å¦‚ä½•ä¼˜åŒ–ï¼Ÿ"></a>ä»¥ä¸‹ SQL æœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿè¯¥å¦‚ä½•ä¼˜åŒ–ï¼Ÿ</h5><pre><code class="hljs mysql">select * from t where f&#x2F;2&#x3D;100;</code></pre><p>è¯¥ SQL ä¼šå¯¼è‡´å¼•æ“æ”¾å¼ƒç´¢å¼•è€Œå…¨è¡¨æ‰«æï¼Œå°½é‡é¿å…åœ¨ç´¢å¼•åˆ—ä¸Šè®¡ç®—ã€‚å¯æ”¹ä¸ºï¼š</p><pre><code class="hljs mysql">select * from t where f&#x3D;100*2;</code></pre><h5 id="ä¸ºä»€ä¹ˆ-MySQL-å®˜æ–¹å»ºè®®ä½¿ç”¨è‡ªå¢ä¸»é”®ä½œä¸ºè¡¨çš„ä¸»é”®ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆ-MySQL-å®˜æ–¹å»ºè®®ä½¿ç”¨è‡ªå¢ä¸»é”®ä½œä¸ºè¡¨çš„ä¸»é”®ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆ MySQL å®˜æ–¹å»ºè®®ä½¿ç”¨è‡ªå¢ä¸»é”®ä½œä¸ºè¡¨çš„ä¸»é”®ï¼Ÿ"></a>ä¸ºä»€ä¹ˆ MySQL å®˜æ–¹å»ºè®®ä½¿ç”¨è‡ªå¢ä¸»é”®ä½œä¸ºè¡¨çš„ä¸»é”®ï¼Ÿ</h5><p>å› ä¸ºè‡ªå¢ä¸»é”®æ˜¯è¿ç»­çš„ï¼Œåœ¨æ’å…¥è¿‡ç¨‹ä¸­å°½é‡å‡å°‘é¡µåˆ†è£‚ï¼Œå³ä½¿è¦è¿›è¡Œé¡µåˆ†è£‚ï¼Œä¹Ÿåªä¼šåˆ†è£‚å¾ˆå°‘ä¸€éƒ¨åˆ†ï¼›å¹¶ä¸”è‡ªå¢ä¸»é”®ä¹Ÿèƒ½å‡å°‘æ•°æ®çš„ç§»åŠ¨ï¼Œæ¯æ¬¡æ’å…¥éƒ½æ˜¯æ’å…¥åˆ°æœ€åï¼Œæ‰€ä»¥è‡ªå¢ä¸»é”®ä½œä¸ºè¡¨çš„ä¸»é”®ï¼Œå¯¹äºè¡¨çš„æ“ä½œæ¥è¯´æ€§èƒ½æ˜¯æœ€é«˜çš„ã€‚</p><p>InnoDBå­˜å‚¨å¼•æ“é€»è¾‘å­˜å‚¨ç»“æ„å¯åˆ†ä¸ºäº”çº§ï¼šè¡¨ç©ºé—´ã€æ®µï¼ˆç´¢å¼•æ®µ+æ•°æ®æ®µï¼‰ã€åŒºï¼ˆ1M=64ä¸ªé¡µï¼‰ã€é¡µ(é»˜è®¤16K)ã€è¡Œã€‚</p><p><img src="/images/mysql/tablespace.png"></p><p>å‡è®¾ä¸€é¡µæœ‰4æ¡æ•°æ®</p><p>éè‡ªå¢æƒ…å†µ</p><p><img src="/images/mysql/page1.png"></p><p><img src="/images/mysql/page2.png"></p><p><img src="/images/mysql/page3.png"></p><p>è‡ªå¢æƒ…å†µ</p><p><img src="/images/mysql/page4.png"></p><h5 id="è‡ªå¢ä¸»é”®æœ‰å“ªäº›ä¼˜ç¼ºç‚¹"><a href="#è‡ªå¢ä¸»é”®æœ‰å“ªäº›ä¼˜ç¼ºç‚¹" class="headerlink" title="è‡ªå¢ä¸»é”®æœ‰å“ªäº›ä¼˜ç¼ºç‚¹?"></a>è‡ªå¢ä¸»é”®æœ‰å“ªäº›ä¼˜ç¼ºç‚¹?</h5><p>ä¼˜ç‚¹ï¼š</p><ul><li><p>æ•°æ®å­˜å‚¨ç©ºé—´å¾ˆå°ï¼›</p></li><li><p>æ€§èƒ½æœ€å¥½ï¼›</p></li><li><p>å‡å°‘é¡µåˆ†è£‚ã€‚</p></li></ul><p>ç¼ºç‚¹ï¼š</p><ul><li><p>æ•°æ®é‡è¿‡å¤§ï¼Œå¯èƒ½ä¼šè¶…å‡ºè‡ªå¢é•¿å–å€¼èŒƒå›´ï¼›</p></li><li><p>æ— æ³•æ»¡è¶³åˆ†å¸ƒå¼å­˜å‚¨ï¼Œåˆ†åº“åˆ†è¡¨çš„æƒ…å†µä¸‹æ— æ³•åˆå¹¶è¡¨ï¼›</p></li><li><p>ä¸»é”®æœ‰è‡ªå¢è§„å¾‹ï¼Œå®¹æ˜“è¢«ç ´è§£ï¼›</p></li></ul><p>ç»¼ä¸Šæ‰€è¿°ï¼šæ˜¯å¦éœ€è¦ä½¿ç”¨è‡ªå¢ä¸»é”®ï¼Œéœ€è¦æ ¹æ®è‡ªå·±çš„ä¸šåŠ¡åœºæ™¯æ¥è®¾è®¡ã€‚å¦‚æœæ˜¯å•è¡¨å•åº“ï¼Œåˆ™ä¼˜å…ˆè€ƒè™‘è‡ªå¢ä¸»é”®ï¼Œå¦‚æœæ˜¯åˆ†å¸ƒå¼å­˜å‚¨ï¼Œåˆ†åº“åˆ†è¡¨ï¼Œåˆ™éœ€è¦è€ƒè™‘æ•°æ®åˆå¹¶çš„ä¸šåŠ¡åœºæ™¯æ¥åšæ•°æ®åº“è®¾è®¡æ–¹æ¡ˆã€‚</p><h5 id="MySQL-æœ€å¤šå¯ä»¥åˆ›å»ºå¤šå°‘ä¸ªç´¢å¼•åˆ—ï¼Ÿ"><a href="#MySQL-æœ€å¤šå¯ä»¥åˆ›å»ºå¤šå°‘ä¸ªç´¢å¼•åˆ—ï¼Ÿ" class="headerlink" title="MySQL æœ€å¤šå¯ä»¥åˆ›å»ºå¤šå°‘ä¸ªç´¢å¼•åˆ—ï¼Ÿ"></a>MySQL æœ€å¤šå¯ä»¥åˆ›å»ºå¤šå°‘ä¸ªç´¢å¼•åˆ—ï¼Ÿ</h5><p>MySQL ä¸­æœ€å¤šå¯ä»¥åˆ›å»º 16 ä¸ªç´¢å¼•åˆ—ã€‚</p><h5 id="ä»¥ä¸‹-like-æŸ¥è¯¢ä¼šä½¿ç”¨ç´¢å¼•çš„æ˜¯å“ªä¸€ä¸ªé€‰é¡¹ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ"><a href="#ä»¥ä¸‹-like-æŸ¥è¯¢ä¼šä½¿ç”¨ç´¢å¼•çš„æ˜¯å“ªä¸€ä¸ªé€‰é¡¹ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ" class="headerlink" title="ä»¥ä¸‹ like æŸ¥è¯¢ä¼šä½¿ç”¨ç´¢å¼•çš„æ˜¯å“ªä¸€ä¸ªé€‰é¡¹ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ"></a>ä»¥ä¸‹ like æŸ¥è¯¢ä¼šä½¿ç”¨ç´¢å¼•çš„æ˜¯å“ªä¸€ä¸ªé€‰é¡¹ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</h5><p>A.like â€˜%A%â€™  B.like â€˜%Aâ€™  C.like â€˜A%â€™  D.ä»¥ä¸Šéƒ½ä¸æ˜¯ </p><p>ç­”ï¼šC é¢˜ç›®è§£æï¼šlike æŸ¥è¯¢è¦èµ°ç´¢å¼•ï¼ŒæŸ¥è¯¢å­—ç¬¦ä¸èƒ½ä»¥é€šé…ç¬¦ï¼ˆ%ï¼‰å¼€å§‹ã€‚</p><h5 id="å¦‚ä½•è®©-like-abc-èµ°ç´¢å¼•æŸ¥è¯¢ï¼Ÿ"><a href="#å¦‚ä½•è®©-like-abc-èµ°ç´¢å¼•æŸ¥è¯¢ï¼Ÿ" class="headerlink" title="å¦‚ä½•è®© like %abc èµ°ç´¢å¼•æŸ¥è¯¢ï¼Ÿ"></a>å¦‚ä½•è®© like %abc èµ°ç´¢å¼•æŸ¥è¯¢ï¼Ÿ</h5><p>æˆ‘ä»¬çŸ¥é“å¦‚æœè¦è®© like æŸ¥è¯¢è¦èµ°ç´¢å¼•ï¼ŒæŸ¥è¯¢å­—ç¬¦ä¸èƒ½ä»¥é€šé…ç¬¦ï¼ˆ%ï¼‰å¼€å§‹ï¼Œå¦‚æœè¦è®© like %abc ä¹Ÿèµ°ç´¢å¼•ï¼Œå¯ä»¥ä½¿ç”¨ REVERSE() å‡½æ•°æ¥åˆ›å»ºä¸€ä¸ªå‡½æ•°ç´¢å¼•ï¼ŒæŸ¥è¯¢è„šæœ¬å¦‚ä¸‹ï¼š</p><pre><code class="hljs mysql">select * from t where reverse(f) like reverse(&#39;%abc&#39;);</code></pre><h5 id="åˆ—å€¼ä¸º-NULL-æ—¶ï¼ŒæŸ¥è¯¢ä¼šä½¿ç”¨åˆ°ç´¢å¼•å—ï¼Ÿ"><a href="#åˆ—å€¼ä¸º-NULL-æ—¶ï¼ŒæŸ¥è¯¢ä¼šä½¿ç”¨åˆ°ç´¢å¼•å—ï¼Ÿ" class="headerlink" title="åˆ—å€¼ä¸º NULL æ—¶ï¼ŒæŸ¥è¯¢ä¼šä½¿ç”¨åˆ°ç´¢å¼•å—ï¼Ÿ"></a>åˆ—å€¼ä¸º NULL æ—¶ï¼ŒæŸ¥è¯¢ä¼šä½¿ç”¨åˆ°ç´¢å¼•å—ï¼Ÿ</h5><p>åœ¨ MySQL 5.6 ä»¥ä¸Šçš„ InnoDB å­˜å‚¨å¼•æ“ä¼šæ­£å¸¸è§¦å‘ç´¢å¼•ã€‚ä½†ä¸ºäº†å…¼å®¹ä½ç‰ˆæœ¬çš„ MySQL å’Œå…¼å®¹å…¶ä»–æ•°æ®åº“å­˜å‚¨å¼•æ“ï¼Œä¸å»ºè®®ä½¿ç”¨ NULL å€¼æ¥å­˜å‚¨å’ŒæŸ¥è¯¢æ•°æ®ï¼Œå»ºè®®è®¾ç½®åˆ—ä¸º NOT NULLï¼Œå¹¶è®¾ç½®ä¸€ä¸ªé»˜è®¤å€¼ï¼Œæ¯”å¦‚ 0 å’Œç©ºå­—ç¬¦ä¸²ç­‰ï¼Œå¦‚æœæ˜¯ datetime ç±»å‹ï¼Œå¯ä»¥è®¾ç½®æˆ 1970-01-01 00:00:00 è¿™æ ·çš„ç‰¹æ®Šå€¼ã€‚</p><h5 id="ä»¥ä¸‹è¯­å¥ä¼šèµ°ç´¢å¼•ä¹ˆï¼Ÿ"><a href="#ä»¥ä¸‹è¯­å¥ä¼šèµ°ç´¢å¼•ä¹ˆï¼Ÿ" class="headerlink" title="ä»¥ä¸‹è¯­å¥ä¼šèµ°ç´¢å¼•ä¹ˆï¼Ÿ"></a>ä»¥ä¸‹è¯­å¥ä¼šèµ°ç´¢å¼•ä¹ˆï¼Ÿ</h5><p><code>select * from t where year(date)&gt;2018;</code></p><p>ä¸ä¼šï¼Œå› ä¸ºåœ¨ç´¢å¼•åˆ—ä¸Šæ¶‰åŠåˆ°äº†è¿ç®—ã€‚</p><h5 id="MySQL-è”åˆç´¢å¼•åº”è¯¥æ³¨æ„ä»€ä¹ˆï¼Ÿ"><a href="#MySQL-è”åˆç´¢å¼•åº”è¯¥æ³¨æ„ä»€ä¹ˆï¼Ÿ" class="headerlink" title="MySQL è”åˆç´¢å¼•åº”è¯¥æ³¨æ„ä»€ä¹ˆï¼Ÿ"></a>MySQL è”åˆç´¢å¼•åº”è¯¥æ³¨æ„ä»€ä¹ˆï¼Ÿ</h5><p>è”åˆç´¢å¼•åˆå«å¤åˆç´¢å¼•ï¼ŒMySQL ä¸­çš„è”åˆç´¢å¼•ï¼Œéµå¾ªæœ€å·¦åŒ¹é…åŸåˆ™ï¼Œæ¯”å¦‚ï¼Œè”åˆç´¢å¼•ä¸º key(a,b,c)ï¼Œåˆ™èƒ½è§¦å‘ç´¢å¼•çš„æœç´¢ç»„åˆæ˜¯ a|ab|abc è¿™ä¸‰ç§æŸ¥è¯¢ã€‚</p><h5 id="è”åˆç´¢å¼•çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#è”åˆç´¢å¼•çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="è”åˆç´¢å¼•çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ"></a>è”åˆç´¢å¼•çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ</h5><p>è”åˆç´¢å¼•çš„ä½œç”¨å¦‚ä¸‹ï¼š</p><ul><li><p>ç”¨äºå¤šå­—æ®µæŸ¥è¯¢ï¼Œæ¯”å¦‚ï¼Œå»ºäº†ä¸€ä¸ª key(a,b,c) çš„è”åˆç´¢å¼•ï¼Œé‚£ä¹ˆå®é™…ç­‰äºå»ºäº† key(a)ã€key(a,b)ã€key(a,b,c) ç­‰ä¸‰ä¸ªç´¢å¼•ï¼Œæˆ‘ä»¬çŸ¥é“ï¼Œæ¯å¤šä¸€ä¸ªç´¢å¼•ï¼Œå°±ä¼šå¤šä¸€äº›å†™æ“ä½œå’Œå ç”¨ç£ç›˜ç©ºé—´çš„å¼€é”€ï¼Œå°¤å…¶æ˜¯å¯¹å¤§æ•°æ®é‡çš„è¡¨æ¥è¯´ï¼Œè¿™å¯ä»¥å‡å°‘ä¸€éƒ¨åˆ†ä¸å¿…è¦çš„å¼€é”€ï¼›</p></li><li><p>è¦†ç›–ç´¢å¼•ï¼Œæ¯”å¦‚ï¼Œå¯¹äºè”åˆç´¢å¼• key(a,b,c) æ¥è¯´ï¼Œå¦‚æœä½¿ç”¨ SQLï¼šselect a,b,c from table where a=1 and b = 1 ï¼Œå°±å¯ä»¥ç›´æ¥é€šè¿‡éå†ç´¢å¼•å–å¾—æ•°æ®ï¼Œè€Œæ— éœ€å›è¡¨æŸ¥è¯¢ï¼Œè¿™å°±å‡å°‘äº†éšæœºçš„ IO æ“ä½œï¼Œå‡å°‘éšæœºçš„ IO æ“ä½œï¼Œå¯ä»¥æœ‰æ•ˆçš„æå‡æ•°æ®åº“æŸ¥è¯¢çš„æ€§èƒ½ï¼Œæ˜¯éå¸¸é‡è¦çš„æ•°æ®åº“ä¼˜åŒ–æ‰‹æ®µä¹‹ä¸€ï¼›</p></li><li><p>ç´¢å¼•åˆ—è¶Šå¤šï¼Œé€šè¿‡ç´¢å¼•ç­›é€‰å‡ºçš„æ•°æ®è¶Šå°‘ã€‚</p></li></ul><h5 id="ä»€ä¹ˆæ˜¯æœ€å·¦åŒ¹é…åŸåˆ™ï¼Ÿå®ƒçš„ç”Ÿæ•ˆåŸåˆ™æœ‰å“ªäº›ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯æœ€å·¦åŒ¹é…åŸåˆ™ï¼Ÿå®ƒçš„ç”Ÿæ•ˆåŸåˆ™æœ‰å“ªäº›ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯æœ€å·¦åŒ¹é…åŸåˆ™ï¼Ÿå®ƒçš„ç”Ÿæ•ˆåŸåˆ™æœ‰å“ªäº›ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯æœ€å·¦åŒ¹é…åŸåˆ™ï¼Ÿå®ƒçš„ç”Ÿæ•ˆåŸåˆ™æœ‰å“ªäº›ï¼Ÿ</h5><p>æœ€å·¦åŒ¹é…åŸåˆ™ä¹Ÿå«æœ€å·¦å‰ç¼€åŸåˆ™ï¼Œæ˜¯ MySQL ä¸­çš„ä¸€ä¸ªé‡è¦åŸåˆ™ï¼Œè¯´çš„æ˜¯ç´¢å¼•ä»¥æœ€å·¦è¾¹çš„ä¸ºèµ·ç‚¹ä»»ä½•è¿ç»­çš„ç´¢å¼•éƒ½èƒ½åŒ¹é…ä¸Šï¼Œå½“é‡åˆ°èŒƒå›´æŸ¥è¯¢ï¼ˆ&gt;ã€&lt;ã€betweenã€likeï¼‰å°±ä¼šåœæ­¢åŒ¹é…ã€‚ ç”Ÿæ•ˆåŸåˆ™æ¥çœ‹ä»¥ä¸‹ç¤ºä¾‹ï¼Œæ¯”å¦‚è¡¨ä¸­æœ‰ä¸€ä¸ªè”åˆç´¢å¼•å­—æ®µ index(a,b,c)ï¼š</p><ul><li>where a=1 åªä½¿ç”¨äº†ç´¢å¼• aï¼›</li><li>where a=1 and b=2 åªä½¿ç”¨äº†ç´¢å¼• a,bï¼›</li><li>where a=1 and b=2 and c=3 ä½¿ç”¨a,b,cï¼›</li><li>where b=1 or where c=1 ä¸ä½¿ç”¨ç´¢å¼•ï¼›</li><li>where a=1 and c=3 åªä½¿ç”¨äº†ç´¢å¼• aï¼›</li><li>where a=3 and b like â€˜xx%â€™ and c=3 åªä½¿ç”¨äº†ç´¢å¼• a,bã€‚</li></ul><h5 id="ä»€ä¹ˆæ˜¯å‰ç¼€ç´¢å¼•ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯å‰ç¼€ç´¢å¼•ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯å‰ç¼€ç´¢å¼•ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯å‰ç¼€ç´¢å¼•ï¼Ÿ</h5><p>å‰ç¼€ç´¢å¼•ä¹Ÿå«å±€éƒ¨ç´¢å¼•ï¼Œæ¯”å¦‚ç»™èº«ä»½è¯çš„å‰ 10 ä½æ·»åŠ ç´¢å¼•ï¼Œç±»ä¼¼è¿™ç§ç»™æŸåˆ—éƒ¨åˆ†ä¿¡æ¯æ·»åŠ ç´¢å¼•çš„æ–¹å¼å«åšå‰ç¼€ç´¢å¼•ã€‚</p><h5 id="ä¸ºä»€ä¹ˆè¦ç”¨å‰ç¼€ç´¢å¼•ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆè¦ç”¨å‰ç¼€ç´¢å¼•ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆè¦ç”¨å‰ç¼€ç´¢å¼•ï¼Ÿ"></a>ä¸ºä»€ä¹ˆè¦ç”¨å‰ç¼€ç´¢å¼•ï¼Ÿ</h5><p>å‰ç¼€ç´¢å¼•èƒ½æœ‰æ•ˆå‡å°ç´¢å¼•æ–‡ä»¶çš„å¤§å°ï¼Œè®©æ¯ä¸ªç´¢å¼•é¡µå¯ä»¥ä¿å­˜æ›´å¤šçš„ç´¢å¼•å€¼ï¼Œä»è€Œæé«˜äº†ç´¢å¼•æŸ¥è¯¢çš„é€Ÿåº¦ã€‚ä½†å‰ç¼€ç´¢å¼•ä¹Ÿæœ‰å®ƒçš„ç¼ºç‚¹ï¼Œä¸èƒ½åœ¨ order by æˆ–è€… group by ä¸­è§¦å‘å‰ç¼€ç´¢å¼•ï¼Œä¹Ÿä¸èƒ½æŠŠå®ƒä»¬ç”¨äºè¦†ç›–ç´¢å¼•ã€‚</p><h5 id="ä»€ä¹ˆæƒ…å†µä¸‹é€‚åˆä½¿ç”¨å‰ç¼€ç´¢å¼•ï¼Ÿ"><a href="#ä»€ä¹ˆæƒ…å†µä¸‹é€‚åˆä½¿ç”¨å‰ç¼€ç´¢å¼•ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæƒ…å†µä¸‹é€‚åˆä½¿ç”¨å‰ç¼€ç´¢å¼•ï¼Ÿ"></a>ä»€ä¹ˆæƒ…å†µä¸‹é€‚åˆä½¿ç”¨å‰ç¼€ç´¢å¼•ï¼Ÿ</h5><p>å½“å­—ç¬¦ä¸²æœ¬èº«å¯èƒ½æ¯”è¾ƒé•¿ï¼Œè€Œä¸”å‰å‡ ä¸ªå­—ç¬¦å°±å¼€å§‹ä¸ç›¸åŒï¼Œé€‚åˆä½¿ç”¨å‰ç¼€ç´¢å¼•ï¼›ç›¸åæƒ…å†µä¸‹ä¸é€‚åˆä½¿ç”¨å‰ç¼€ç´¢å¼•ï¼Œæ¯”å¦‚ï¼Œæ•´ä¸ªå­—æ®µçš„é•¿åº¦ä¸º 20ï¼Œç´¢å¼•é€‰æ‹©æ€§ä¸º 0.9ï¼Œè€Œæˆ‘ä»¬å¯¹å‰ 10 ä¸ªå­—ç¬¦å»ºç«‹å‰ç¼€ç´¢å¼•å…¶é€‰æ‹©æ€§ä¹Ÿåªæœ‰ 0.5ï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦ç»§ç»­åŠ å¤§å‰ç¼€å­—ç¬¦çš„é•¿åº¦ï¼Œä½†æ˜¯è¿™ä¸ªæ—¶å€™å‰ç¼€ç´¢å¼•çš„ä¼˜åŠ¿å·²ç»ä¸æ˜æ˜¾ï¼Œå°±æ²¡æœ‰åˆ›å»ºå‰ç¼€ç´¢å¼•çš„å¿…è¦äº†ã€‚</p><h5 id="ä»€ä¹ˆæ˜¯è¦†ç›–ç´¢å¼•ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯è¦†ç›–ç´¢å¼•ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯è¦†ç›–ç´¢å¼•ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯è¦†ç›–ç´¢å¼•ï¼Ÿ</h5><p>è¦†ç›–ç´¢å¼•æ˜¯æŒ‡ï¼Œç´¢å¼•ä¸Šçš„ä¿¡æ¯è¶³å¤Ÿæ»¡è¶³æŸ¥è¯¢è¯·æ±‚ï¼Œä¸éœ€è¦å†å›åˆ°ä¸»é”®ä¸Šå»å–æ•°æ®ã€‚</p><h5 id="ä»€ä¹ˆæ˜¯é¡µï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯é¡µï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯é¡µï¼Ÿ"></a>ä»€ä¹ˆæ˜¯é¡µï¼Ÿ</h5><p>é¡µæ˜¯è®¡ç®—æœºç®¡ç†å­˜å‚¨å™¨çš„é€»è¾‘å—ï¼Œç¡¬ä»¶åŠæ“ä½œç³»ç»Ÿå¾€å¾€å°†ä¸»å­˜å’Œç£ç›˜å­˜å‚¨åŒºåˆ†å‰²ä¸ºè¿ç»­çš„å¤§å°ç›¸ç­‰çš„å—ï¼Œæ¯ä¸ªå­˜å‚¨å—ç§°ä¸ºä¸€é¡µã€‚ä¸»å­˜å’Œç£ç›˜ä»¥é¡µä¸ºå•ä½äº¤æ¢æ•°æ®ã€‚æ•°æ®åº“ç³»ç»Ÿçš„è®¾è®¡è€…å·§å¦™åˆ©ç”¨äº†ç£ç›˜é¢„è¯»åŸç†ï¼Œå°†ä¸€ä¸ªèŠ‚ç‚¹çš„å¤§å°è®¾ä¸ºç­‰äºä¸€ä¸ªé¡µï¼Œè¿™æ ·æ¯ä¸ªèŠ‚ç‚¹åªéœ€è¦ä¸€æ¬¡ç£ç›˜ IO å°±å¯ä»¥å®Œå…¨è½½å…¥ã€‚</p><h5 id="ç´¢å¼•çš„å¸¸è§å­˜å‚¨ç®—æ³•æœ‰å“ªäº›ï¼Ÿ"><a href="#ç´¢å¼•çš„å¸¸è§å­˜å‚¨ç®—æ³•æœ‰å“ªäº›ï¼Ÿ" class="headerlink" title="ç´¢å¼•çš„å¸¸è§å­˜å‚¨ç®—æ³•æœ‰å“ªäº›ï¼Ÿ"></a>ç´¢å¼•çš„å¸¸è§å­˜å‚¨ç®—æ³•æœ‰å“ªäº›ï¼Ÿ</h5><ul><li><p>å“ˆå¸Œå­˜å‚¨æ³•ï¼šä»¥ keyã€value æ–¹å¼å­˜å‚¨ï¼ŒæŠŠå€¼å­˜å…¥æ•°ç»„ä¸­ä½¿ç”¨å“ˆå¸Œå€¼ç¡®è®¤æ•°æ®çš„ä½ç½®ï¼Œå¦‚æœå‘ç”Ÿå“ˆå¸Œå†²çªï¼Œä½¿ç”¨é“¾è¡¨å­˜å‚¨æ•°æ®ï¼›</p></li><li><p>æœ‰åºæ•°ç»„å­˜å‚¨æ³•ï¼šæŒ‰é¡ºåºå­˜å‚¨ï¼Œä¼˜ç‚¹æ˜¯å¯ä»¥ä½¿ç”¨äºŒåˆ†æ³•å¿«é€Ÿæ‰¾åˆ°æ•°æ®ï¼Œç¼ºç‚¹æ˜¯æ›´æ–°æ•ˆç‡ï¼Œé€‚åˆé™æ€æ•°æ®å­˜å‚¨ï¼›</p></li><li><p>æœç´¢æ ‘ï¼šä»¥æ ‘çš„æ–¹å¼è¿›è¡Œå­˜å‚¨ï¼ŒæŸ¥è¯¢æ€§èƒ½å¥½ï¼Œæ›´æ–°é€Ÿåº¦å¿«ã€‚</p></li></ul><h5 id="InnoDB-ä¸ºä»€ä¹ˆè¦ä½¿ç”¨-B-æ ‘ï¼Œè€Œä¸æ˜¯-B-æ ‘ã€Hashã€çº¢é»‘æ ‘æˆ–äºŒå‰æ ‘ï¼Ÿ"><a href="#InnoDB-ä¸ºä»€ä¹ˆè¦ä½¿ç”¨-B-æ ‘ï¼Œè€Œä¸æ˜¯-B-æ ‘ã€Hashã€çº¢é»‘æ ‘æˆ–äºŒå‰æ ‘ï¼Ÿ" class="headerlink" title="InnoDB ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ B+ æ ‘ï¼Œè€Œä¸æ˜¯ B æ ‘ã€Hashã€çº¢é»‘æ ‘æˆ–äºŒå‰æ ‘ï¼Ÿ"></a>InnoDB ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ B+ æ ‘ï¼Œè€Œä¸æ˜¯ B æ ‘ã€Hashã€çº¢é»‘æ ‘æˆ–äºŒå‰æ ‘ï¼Ÿ</h5><p>å› ä¸º B æ ‘ã€Hashã€çº¢é»‘æ ‘æˆ–äºŒå‰æ ‘å­˜åœ¨ä»¥ä¸‹é—®é¢˜ï¼š</p><ul><li><p>B æ ‘ï¼šä¸ç®¡å¶å­èŠ‚ç‚¹è¿˜æ˜¯éå¶å­èŠ‚ç‚¹ï¼Œéƒ½ä¼šä¿å­˜æ•°æ®ï¼Œè¿™æ ·å¯¼è‡´åœ¨éå¶å­èŠ‚ç‚¹ä¸­èƒ½ä¿å­˜çš„æŒ‡é’ˆæ•°é‡å˜å°‘ï¼ˆæœ‰äº›èµ„æ–™ä¹Ÿç§°ä¸ºæ‰‡å‡ºï¼‰ï¼ŒæŒ‡é’ˆå°‘çš„æƒ…å†µä¸‹è¦ä¿å­˜å¤§é‡æ•°æ®ï¼Œåªèƒ½å¢åŠ æ ‘çš„é«˜åº¦ï¼Œå¯¼è‡´IOæ“ä½œå˜å¤šï¼ŒæŸ¥è¯¢æ€§èƒ½å˜ä½ï¼›</p></li><li><p>Hashï¼šè™½ç„¶å¯ä»¥å¿«é€Ÿå®šä½ï¼Œä½†æ˜¯æ²¡æœ‰é¡ºåºï¼ŒIO å¤æ‚åº¦é«˜ï¼›</p></li><li><p>äºŒå‰æ ‘ï¼šæ ‘çš„é«˜åº¦ä¸å‡åŒ€ï¼Œä¸èƒ½è‡ªå¹³è¡¡ï¼ŒæŸ¥æ‰¾æ•ˆç‡è·Ÿæ•°æ®æœ‰å…³ï¼ˆæ ‘çš„é«˜åº¦ï¼‰ï¼Œå¹¶ä¸” IO ä»£ä»·é«˜ï¼›</p></li><li><p>çº¢é»‘æ ‘ï¼šæ ‘çš„é«˜åº¦éšç€æ•°æ®é‡å¢åŠ è€Œå¢åŠ ï¼ŒIO ä»£ä»·é«˜ã€‚</p></li></ul><h5 id="ä¸ºä»€ä¹ˆ-InnoDB-è¦ä½¿ç”¨-B-æ ‘æ¥å­˜å‚¨ç´¢å¼•ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆ-InnoDB-è¦ä½¿ç”¨-B-æ ‘æ¥å­˜å‚¨ç´¢å¼•ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆ InnoDB è¦ä½¿ç”¨ B+ æ ‘æ¥å­˜å‚¨ç´¢å¼•ï¼Ÿ"></a>ä¸ºä»€ä¹ˆ InnoDB è¦ä½¿ç”¨ B+ æ ‘æ¥å­˜å‚¨ç´¢å¼•ï¼Ÿ</h5><p>B+Tree ä¸­çš„ B æ˜¯ Balanceï¼Œæ˜¯å¹³è¡¡çš„æ„æ€ï¼Œå®ƒåœ¨ç»å…¸ B Tree çš„åŸºç¡€ä¸Šè¿›è¡Œäº†ä¼˜åŒ–ï¼Œå¢åŠ äº†é¡ºåºè®¿é—®æŒ‡é’ˆï¼Œåœ¨B+Tree çš„æ¯ä¸ªå¶å­èŠ‚ç‚¹å¢åŠ ä¸€ä¸ªæŒ‡å‘ç›¸é‚»å¶å­èŠ‚ç‚¹çš„æŒ‡é’ˆï¼Œå°±å½¢æˆäº†å¸¦æœ‰é¡ºåºè®¿é—®æŒ‡é’ˆçš„ B+Treeï¼Œè¿™æ ·å°±æé«˜äº†åŒºé—´è®¿é—®æ€§èƒ½ï¼šå¦‚æœè¦æŸ¥è¯¢ key ä¸ºä» 18 åˆ° 49 çš„æ‰€æœ‰æ•°æ®è®°å½•ï¼Œå½“æ‰¾åˆ° 18 åï¼Œåªéœ€é¡ºç€èŠ‚ç‚¹å’ŒæŒ‡é’ˆé¡ºåºéå†å°±å¯ä»¥ä¸€æ¬¡æ€§è®¿é—®åˆ°æ‰€æœ‰æ•°æ®èŠ‚ç‚¹ï¼Œæå¤§æåˆ°äº†åŒºé—´æŸ¥è¯¢æ•ˆç‡ï¼ˆæ— éœ€è¿”å›ä¸Šå±‚çˆ¶èŠ‚ç‚¹é‡å¤éå†æŸ¥æ‰¾å‡å°‘ IO æ“ä½œï¼‰ã€‚</p><p>ç´¢å¼•æœ¬èº«ä¹Ÿå¾ˆå¤§ï¼Œä¸å¯èƒ½å…¨éƒ¨å­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œå› æ­¤ç´¢å¼•å¾€å¾€ä»¥ç´¢å¼•æ–‡ä»¶çš„å½¢å¼å­˜å‚¨çš„ç£ç›˜ä¸Šï¼Œè¿™æ ·çš„è¯ï¼Œç´¢å¼•æŸ¥æ‰¾è¿‡ç¨‹ä¸­å°±è¦äº§ç”Ÿç£ç›˜ IO æ¶ˆè€—ï¼Œç›¸å¯¹äºå†…å­˜å­˜å–ï¼ŒIO å­˜å–çš„æ¶ˆè€—è¦é«˜å‡ ä¸ªæ•°é‡çº§ï¼Œæ‰€ä»¥ç´¢å¼•çš„ç»“æ„ç»„ç»‡è¦å°½é‡å‡å°‘æŸ¥æ‰¾è¿‡ç¨‹ä¸­ç£ç›˜ IO çš„å­˜å–æ¬¡æ•°ï¼Œä»è€Œæå‡ç´¢å¼•æ•ˆç‡ã€‚ ç»¼åˆæ‰€è¿°ï¼ŒInnDB åªæœ‰é‡‡å– B+ æ ‘çš„æ•°æ®ç»“æ„å­˜å‚¨ç´¢å¼•ï¼Œæ‰èƒ½æä¾›æ•°æ®åº“æ•´ä½“çš„æ“ä½œæ€§èƒ½ã€‚</p><h5 id="ä¼˜åŒ–å™¨é€‰æ‹©æŸ¥è¯¢ç´¢å¼•çš„å½±å“å› ç´ æœ‰å“ªäº›ï¼Ÿ"><a href="#ä¼˜åŒ–å™¨é€‰æ‹©æŸ¥è¯¢ç´¢å¼•çš„å½±å“å› ç´ æœ‰å“ªäº›ï¼Ÿ" class="headerlink" title="ä¼˜åŒ–å™¨é€‰æ‹©æŸ¥è¯¢ç´¢å¼•çš„å½±å“å› ç´ æœ‰å“ªäº›ï¼Ÿ"></a>ä¼˜åŒ–å™¨é€‰æ‹©æŸ¥è¯¢ç´¢å¼•çš„å½±å“å› ç´ æœ‰å“ªäº›ï¼Ÿ</h5><p>ä¼˜åŒ–å™¨çš„ç›®çš„æ˜¯ä½¿ç”¨æœ€å°çš„ä»£ä»·é€‰æ‹©æœ€ä¼˜çš„æ‰§è¡Œæ–¹æ¡ˆï¼Œå½±å“ä¼˜åŒ–å™¨é€‰æ‹©ç´¢å¼•çš„å› ç´ å¦‚ä¸‹ï¼š</p><ul><li><p>æ‰«æè¡Œæ•°ï¼Œæ‰«æçš„è¡Œæ•°è¶Šå°‘ï¼Œæ‰§è¡Œä»£ä»·å°±è¶Šå°‘ï¼Œæ‰§è¡Œæ•ˆç‡å°±ä¼šè¶Šé«˜ï¼›</p></li><li><p>æ˜¯å¦ä½¿ç”¨äº†ä¸´æ—¶è¡¨ï¼›</p></li><li><p>æ˜¯å¦æ’åºã€‚</p></li></ul><h5 id="MySQL-æ˜¯å¦‚ä½•åˆ¤æ–­ç´¢å¼•æ‰«æè¡Œæ•°çš„å¤šå°‘ï¼Ÿ"><a href="#MySQL-æ˜¯å¦‚ä½•åˆ¤æ–­ç´¢å¼•æ‰«æè¡Œæ•°çš„å¤šå°‘ï¼Ÿ" class="headerlink" title="MySQL æ˜¯å¦‚ä½•åˆ¤æ–­ç´¢å¼•æ‰«æè¡Œæ•°çš„å¤šå°‘ï¼Ÿ"></a>MySQL æ˜¯å¦‚ä½•åˆ¤æ–­ç´¢å¼•æ‰«æè¡Œæ•°çš„å¤šå°‘ï¼Ÿ</h5><p>MySQL çš„æ‰«æè¡Œæ•°æ˜¯é€šè¿‡ç´¢å¼•ç»Ÿè®¡åˆ—ï¼ˆcardinalityï¼‰å¤§è‡´å¾—åˆ°å¹¶ä¸”åˆ¤æ–­çš„ï¼Œè€Œç´¢å¼•ç»Ÿè®¡åˆ—ï¼ˆcardinalityï¼‰å¯ä»¥é€šè¿‡æŸ¥è¯¢å‘½ä»¤ show index å¾—åˆ°ï¼Œç´¢å¼•æ‰«æè¡Œæ•°çš„å¤šå°‘å°±æ˜¯é€šè¿‡è¿™ä¸ªå€¼è¿›è¡Œåˆ¤æ–­çš„ã€‚</p><h5 id="MySQL-æ˜¯å¦‚ä½•å¾—åˆ°ç´¢å¼•åŸºæ•°çš„ï¼Ÿå®ƒå‡†ç¡®å—ï¼Ÿ"><a href="#MySQL-æ˜¯å¦‚ä½•å¾—åˆ°ç´¢å¼•åŸºæ•°çš„ï¼Ÿå®ƒå‡†ç¡®å—ï¼Ÿ" class="headerlink" title="MySQL æ˜¯å¦‚ä½•å¾—åˆ°ç´¢å¼•åŸºæ•°çš„ï¼Ÿå®ƒå‡†ç¡®å—ï¼Ÿ"></a>MySQL æ˜¯å¦‚ä½•å¾—åˆ°ç´¢å¼•åŸºæ•°çš„ï¼Ÿå®ƒå‡†ç¡®å—ï¼Ÿ</h5><p>MySQL çš„ç´¢å¼•åŸºæ•°å¹¶ä¸å‡†ç¡®ï¼Œå› ä¸º MySQL çš„ç´¢å¼•åŸºæ•°æ˜¯é€šè¿‡é‡‡æ ·ç»Ÿè®¡å¾—åˆ°çš„ï¼Œæ¯”å¦‚ InnoDb é»˜è®¤ä¼šæœ‰ N ä¸ªæ•°æ®é¡µï¼Œé‡‡æ ·ç»Ÿè®¡ä¼šç»Ÿè®¡è¿™äº›é¡µé¢ä¸Šçš„ä¸åŒå€¼å¾—åˆ°ä¸€ä¸ªå¹³å‡å€¼ï¼Œç„¶åé™¤ä»¥è¿™ä¸ªç´¢å¼•çš„é¡µé¢æ•°å°±å¾—åˆ°äº†è¿™ä¸ªç´¢å¼•åŸºæ•°ã€‚</p><h5 id="MySQL-å¦‚ä½•æŒ‡å®šæŸ¥è¯¢çš„ç´¢å¼•ï¼Ÿ"><a href="#MySQL-å¦‚ä½•æŒ‡å®šæŸ¥è¯¢çš„ç´¢å¼•ï¼Ÿ" class="headerlink" title="MySQL å¦‚ä½•æŒ‡å®šæŸ¥è¯¢çš„ç´¢å¼•ï¼Ÿ"></a>MySQL å¦‚ä½•æŒ‡å®šæŸ¥è¯¢çš„ç´¢å¼•ï¼Ÿ</h5><p>åœ¨ MySQL ä¸­å¯ä»¥ä½¿ç”¨ force index å¼ºè¡Œé€‰æ‹©ä¸€ä¸ªç´¢å¼•ï¼Œå…·ä½“æŸ¥è¯¢è¯­å¥å¦‚ä¸‹ï¼š</p><pre><code class="hljs mysql">select * from t force index(index_t);</code></pre><h5 id="åœ¨-MySQL-ä¸­æŒ‡å®šäº†æŸ¥è¯¢ç´¢å¼•ï¼Œä¸ºä»€ä¹ˆæ²¡æœ‰ç”Ÿæ•ˆï¼Ÿ"><a href="#åœ¨-MySQL-ä¸­æŒ‡å®šäº†æŸ¥è¯¢ç´¢å¼•ï¼Œä¸ºä»€ä¹ˆæ²¡æœ‰ç”Ÿæ•ˆï¼Ÿ" class="headerlink" title="åœ¨ MySQL ä¸­æŒ‡å®šäº†æŸ¥è¯¢ç´¢å¼•ï¼Œä¸ºä»€ä¹ˆæ²¡æœ‰ç”Ÿæ•ˆï¼Ÿ"></a>åœ¨ MySQL ä¸­æŒ‡å®šäº†æŸ¥è¯¢ç´¢å¼•ï¼Œä¸ºä»€ä¹ˆæ²¡æœ‰ç”Ÿæ•ˆï¼Ÿ</h5><p>æˆ‘ä»¬çŸ¥é“åœ¨ MySQL ä¸­ä½¿ç”¨ force index å¯ä»¥æŒ‡å®šæŸ¥è¯¢çš„ç´¢å¼•ï¼Œä½†å¹¶ä¸æ˜¯ä¸€å®šä¼šç”Ÿæ•ˆï¼ŒåŸå› æ˜¯ MySQL ä¼šæ ¹æ®ä¼˜åŒ–å™¨è‡ªå·±é€‰æ‹©ç´¢å¼•ï¼Œå¦‚æœ force index æŒ‡å®šçš„ç´¢å¼•å‡ºç°åœ¨å€™é€‰ç´¢å¼•ä¸Šï¼Œè¿™ä¸ªæ—¶å€™ MySQL ä¸ä¼šåœ¨åˆ¤æ–­æ‰«æçš„è¡Œæ•°çš„å¤šå°‘ç›´æ¥ä½¿ç”¨æŒ‡å®šçš„ç´¢å¼•ï¼Œå¦‚æœæ²¡åœ¨å€™é€‰ç´¢å¼•ä¸­ï¼Œå³ä½¿ force index æŒ‡å®šäº†ç´¢å¼•ä¹Ÿæ˜¯ä¸ä¼šç”Ÿæ•ˆçš„ã€‚</p><h5 id="ä»¥ä¸‹-or-æŸ¥è¯¢æœ‰ä»€ä¹ˆé—®é¢˜å—ï¼Ÿè¯¥å¦‚ä½•ä¼˜åŒ–ï¼Ÿ"><a href="#ä»¥ä¸‹-or-æŸ¥è¯¢æœ‰ä»€ä¹ˆé—®é¢˜å—ï¼Ÿè¯¥å¦‚ä½•ä¼˜åŒ–ï¼Ÿ" class="headerlink" title="ä»¥ä¸‹ or æŸ¥è¯¢æœ‰ä»€ä¹ˆé—®é¢˜å—ï¼Ÿè¯¥å¦‚ä½•ä¼˜åŒ–ï¼Ÿ"></a>ä»¥ä¸‹ or æŸ¥è¯¢æœ‰ä»€ä¹ˆé—®é¢˜å—ï¼Ÿè¯¥å¦‚ä½•ä¼˜åŒ–ï¼Ÿ</h5><p><code>select * from t where num=10 or num=20;</code></p><p>ç­”ï¼šå¦‚æœä½¿ç”¨ or æŸ¥è¯¢ä¼šä½¿ MySQL æ”¾å¼ƒç´¢å¼•è€Œå…¨è¡¨æ‰«æï¼Œå¯ä»¥æ”¹ä¸ºï¼š</p><pre><code class="hljs mysql">select * from t where num&#x3D;10 union select * from t where num&#x3D;20;</code></pre><h5 id="ä»¥ä¸‹æŸ¥è¯¢è¦å¦‚ä½•ä¼˜åŒ–ï¼Ÿ"><a href="#ä»¥ä¸‹æŸ¥è¯¢è¦å¦‚ä½•ä¼˜åŒ–ï¼Ÿ" class="headerlink" title="ä»¥ä¸‹æŸ¥è¯¢è¦å¦‚ä½•ä¼˜åŒ–ï¼Ÿ"></a>ä»¥ä¸‹æŸ¥è¯¢è¦å¦‚ä½•ä¼˜åŒ–ï¼Ÿ</h5><p>è¡¨ä¸­åŒ…å«ç´¢å¼•ï¼š</p><ul><li><p>KEY mid (mid)</p></li><li><p>KEY begintime (begintime)</p></li><li><p>KEY dg (day,group)</p></li></ul><p>ä½¿ç”¨ä»¥ä¸‹ SQL è¿›è¡ŒæŸ¥è¯¢ï¼š</p><p><code>select f from t where day=&#39;2010-12-31&#39; and group=18 and begintime&lt;&#39;2019-12-31 12:14:28&#39; order by begintime limit 1;</code></p><p>ç­”ï¼šæ­¤æŸ¥è¯¢ç†è®ºä¸Šæ˜¯ä½¿ç”¨ dg ç´¢å¼•æ•ˆç‡æ›´é«˜ï¼Œé€šè¿‡ explain å¯ä»¥å¯¹æ¯”æŸ¥è¯¢æ‰«ææ¬¡æ•°ã€‚ç”±äºä½¿ç”¨äº† order by begintime åˆ™ä½¿æŸ¥è¯¢æ”¾å¼ƒäº† dg ç´¢å¼•ï¼Œè€Œä½¿ç”¨ begintime ç´¢å¼•ï¼Œä»ä¾§é¢å°è¯ order by å…³é”®å­—ä¼šå½±å“æŸ¥è¯¢ä½¿ç”¨ç´¢å¼•ï¼Œè¿™æ—¶å¯ä»¥ä½¿æŸ¥è¯¢å¼ºåˆ¶ä½¿ç”¨ç´¢å¼•ï¼Œæ”¹ä¸ºä»¥ä¸‹SQLï¼š</p><pre><code class="hljs mysql">select f from t use index(dg) where day&#x3D;&#39;2010-12-31&#39; and group&#x3D;18 and begintime&lt; &#39;2019-12-31 12:14:28&#39; order by begintime limit 1;</code></pre><h5 id="MySQL-ä¼šé”™é€‰ç´¢å¼•å—ï¼Ÿ"><a href="#MySQL-ä¼šé”™é€‰ç´¢å¼•å—ï¼Ÿ" class="headerlink" title="MySQL ä¼šé”™é€‰ç´¢å¼•å—ï¼Ÿ"></a>MySQL ä¼šé”™é€‰ç´¢å¼•å—ï¼Ÿ</h5><p>MySQL ä¼šé”™é€‰ç´¢å¼•ï¼Œæ¯”å¦‚ k ç´¢å¼•çš„é€Ÿåº¦æ›´å¿«ï¼Œä½†æ˜¯ MySQL å¹¶æ²¡æœ‰ä½¿ç”¨è€Œæ˜¯é‡‡ç”¨äº† v ç´¢å¼•ï¼Œè¿™ç§å°±å«é”™é€‰ç´¢å¼•ï¼Œå› ä¸ºç´¢å¼•é€‰æ‹©æ˜¯ MySQL çš„æœåŠ¡å±‚çš„ä¼˜åŒ–å™¨æ¥è‡ªåŠ¨é€‰æ‹©çš„ï¼Œä½†å®ƒåœ¨å¤æ‚æƒ…å†µä¸‹ä¹Ÿå’Œäººå†™ç¨‹åºä¸€æ ·å‡ºç°ç¼ºé™·ã€‚</p><h5 id="å¦‚ä½•è§£å†³-MySQL-é”™é€‰ç´¢å¼•çš„é—®é¢˜ï¼Ÿ"><a href="#å¦‚ä½•è§£å†³-MySQL-é”™é€‰ç´¢å¼•çš„é—®é¢˜ï¼Ÿ" class="headerlink" title="å¦‚ä½•è§£å†³ MySQL é”™é€‰ç´¢å¼•çš„é—®é¢˜ï¼Ÿ"></a>å¦‚ä½•è§£å†³ MySQL é”™é€‰ç´¢å¼•çš„é—®é¢˜ï¼Ÿ</h5><ul><li><p>åˆ é™¤é”™é€‰çš„ç´¢å¼•ï¼Œåªç•™ä¸‹å¯¹çš„ç´¢å¼•ï¼›</p></li><li><p>ä½¿ç”¨ force index æŒ‡å®šç´¢å¼•ï¼›</p></li><li><p>ä¿®æ”¹ SQL æŸ¥è¯¢è¯­å¥å¼•å¯¼ MySQL ä½¿ç”¨æˆ‘ä»¬æœŸæœ›çš„ç´¢å¼•ï¼Œæ¯”å¦‚æŠŠ order by b limit 1 æ”¹ä¸º order by b,a limit 1 è¯­ä¹‰æ˜¯ç›¸åŒçš„ï¼Œä½† MySQL æŸ¥è¯¢çš„æ—¶å€™ä¼šè€ƒè™‘ä½¿ç”¨ a é”®ä¸Šçš„ç´¢å¼•ã€‚</p></li></ul><h5 id="å¦‚ä½•ä¼˜åŒ–èº«ä»½è¯çš„ç´¢å¼•ï¼Ÿ"><a href="#å¦‚ä½•ä¼˜åŒ–èº«ä»½è¯çš„ç´¢å¼•ï¼Ÿ" class="headerlink" title="å¦‚ä½•ä¼˜åŒ–èº«ä»½è¯çš„ç´¢å¼•ï¼Ÿ"></a>å¦‚ä½•ä¼˜åŒ–èº«ä»½è¯çš„ç´¢å¼•ï¼Ÿ</h5><p>åœ¨ä¸­å›½å› ä¸ºå‰ 6 ä½ä»£è¡¨çš„æ˜¯åœ°åŒºï¼Œæ‰€ä»¥å¾ˆå¤šäººçš„å‰å…­ä½éƒ½æ˜¯ç›¸åŒçš„ï¼Œå¦‚æœæˆ‘ä»¬ä½¿ç”¨å‰ç¼€ç´¢å¼•ä¸º 6 ä½çš„è¯ï¼Œæ€§èƒ½æå‡ä¹Ÿå¹¶ä¸æ˜¯å¾ˆæ˜æ˜¾ï¼Œä½†å¦‚æœè®¾ç½®çš„ä½æ•°è¿‡é•¿ï¼Œé‚£ä¹ˆå ç”¨çš„ç£ç›˜ç©ºé—´ä¹Ÿè¶Šå¤§ï¼Œæ•°æ®é¡µèƒ½æ”¾ä¸‹çš„ç´¢å¼•å€¼å°±è¶Šå°‘ï¼Œæœç´¢æ•ˆç‡ä¹Ÿè¶Šä½ã€‚é’ˆå¯¹è¿™ç§æƒ…å†µä¼˜åŒ–æ–¹æ¡ˆæœ‰ä»¥ä¸‹ä¸¤ç§ï¼š</p><ul><li><p>ä½¿ç”¨èº«ä»½è¯å€’åºå­˜å‚¨ï¼Œè¿™æ ·è®¾ç½®å‰å…­ä½çš„æ„ä¹‰å°±å¾ˆå¤§äº†ï¼›</p></li><li><p>ä½¿ç”¨ hash å€¼ï¼Œæ–°åˆ›å»ºä¸€ä¸ªå­—æ®µç”¨äºå­˜å‚¨èº«ä»½è¯çš„ hash å€¼ã€‚</p></li></ul><h3 id="MySQLé”åŸç†åŠæ¡ˆ"><a href="#MySQLé”åŸç†åŠæ¡ˆ" class="headerlink" title="MySQLé”åŸç†åŠæ¡ˆ"></a><strong>MySQLé”åŸç†åŠæ¡ˆ</strong></h3><h4 id="é”åŸºç¡€"><a href="#é”åŸºç¡€" class="headerlink" title="é”åŸºç¡€"></a>é”åŸºç¡€</h4><p>æŒ‰ç…§æ‰€é‡Œçš„ç²’åº¦åˆ†ç±»ï¼ŒMySQLä¸»è¦åŒ…å«ä¸‰ç§ç±»å‹ï¼ˆçº§åˆ«ï¼‰çš„é”å®šæœºåˆ¶ï¼š</p><ul><li>å…¨å±€é”ï¼šé”çš„æ˜¯æ•´ä¸ªdatebaseï¼Œç”±MySQLçš„SQL layerå±‚å®ç°</li><li>è¡¨çº§é”ï¼šé”çš„æ˜¯æŸä¸ªtableï¼Œç”±MySQLçš„SQL layerå±‚å®ç°</li><li>è¡Œçº§é”ï¼šé”çš„æ˜¯æŸè¡Œæ•°æ®ï¼Œä¹Ÿå¯èƒ½æ˜¯è¡Œä¹‹é—´çš„é—´éš™ï¼Œç”±æŸäº›å­˜å‚¨å¼•æ“å®ç°ï¼Œæ¯”å¦‚InnoDB</li></ul><p>æŒ‰ç…§é”çš„åŠŸèƒ½å¯ä»¥åˆ†ä¸ºï¼šå…±äº«è¯»é”å’Œæ’å®ƒå†™é”</p><p>æŒ‰ç…§é”çš„å®ç°æ–¹å¼åˆ†ä¸ºï¼šæ‚²è§‚é”å’Œä¹è§‚é”</p><p>è¡¨çº§é”ä¸è¡Œçº§é”åŒºåˆ«</p><ul><li>è¡¨çº§é”ï¼šå¼€é”€å°ï¼ŒåŠ é”å—ï¼›ä¸ä¼šå‡ºç°æ­»é”ï¼›é”ç²’åº¦å¤§ï¼Œå‘ç”Ÿå†²çªçš„æ¦‚ç‡é«˜ï¼Œå¹¶å‘åº¦ä½</li><li>è¡Œçº§é”ï¼šå¼€é”€å¤§ï¼ŒåŠ é”æ…¢ï¼›ä¼šå‡ºç°æ­»é”ï¼›é”ç²’åº¦å°ï¼Œå‘ç”Ÿé”å†²çªçš„æ¦‚ç‡ä½ï¼Œå¹¶å‘åº¦é«˜</li></ul><p><img src="/images/mysql/lock.png"></p><h4 id="è¡¨çº§é”"><a href="#è¡¨çº§é”" class="headerlink" title="è¡¨çº§é”"></a>è¡¨çº§é”</h4><p>è¡¨çº§é”æœ‰ä¸¤ç§ï¼š</p><ul><li>è¡¨é”</li><li>ä¸æ•°æ®é”ï¼ˆmeta data lock, MDLï¼‰</li></ul><p>æŸ¥çœ‹é”çŠ¶æ€</p><pre><code class="hljs mysql">mysql&gt;  +----------------------------+-------+| Variable_name              | Value |+----------------------------+-------+| Table_locks_immediate      | 172   || Table_locks_waited         | 0     || Table_open_cache_hits      | 61    || Table_open_cache_misses    | 10    || Table_open_cache_overflows | 0     |+----------------------------+-------+5 rows in set (0.05 sec)</code></pre><p>è¡¨ç°å½¢å¼ï¼š</p><ul><li>è¡¨å…±äº«è¯»é”ï¼ˆTable Read Lockï¼‰</li><li>è¡¨ç‹¬å å†™é”ï¼ˆTable Write Lockï¼‰</li></ul><p>æ‰‹åŠ¨åŠ é”</p><pre><code class="hljs mysql">lock table è¡¨åç§° read(write), è¡¨åç§°2 read(write), å…¶ä»–ï¼›</code></pre><p>æŸ¥çœ‹è¡¨é”æƒ…å†µ</p><pre><code class="hljs mysql">show open tables;</code></pre><p>åˆ é™¤è¡¨é”</p><pre><code class="hljs mysql">unlock tables;</code></pre><h5 id="æ“ä½œæ¼”ç¤º"><a href="#æ“ä½œæ¼”ç¤º" class="headerlink" title="æ“ä½œæ¼”ç¤º"></a>æ“ä½œæ¼”ç¤º</h5><pre><code class="hljs mysql">-- æ–°å»ºè¡¨ CREATE TABLE mylock (id INT(11) NOT NULL AUTO_INCREMENT,name VARCHAR(20) DEFAULT NULL,PRIMARY KEY (id));INSERT INTO mylock VALUES(1, &#39;a&#39;);INSERT INTO mylock VALUES(2, &#39;b&#39;);INSERT INTO mylock VALUES(3, &#39;c&#39;);INSERT INTO mylock VALUES(4, &#39;d&#39;);INSERT INTO mylock VALUES(5, &#39;e&#39;);</code></pre><p><img src="/images/mysql/tlock.png"></p><pre><code class="hljs mysql">-- session1mysql&gt; lock table mylock read;Query OK, 0 rows affected (0.00 sec)mysql&gt; select * from mylock;+----+------+| id | name |+----+------+|  1 | a    ||  2 | b    ||  3 | c    ||  4 | d    ||  5 | e    |+----+------+5 rows in set (0.00 sec)mysql&gt; select * from dept;ERROR 1100 (HY000): Table &#39;dept&#39; was not locked with LOCK TABLES-- session2mysql&gt; select * from mylock;+----+------+| id | name |+----+------+|  1 | a    ||  2 | b    ||  3 | c    ||  4 | d    ||  5 | e    |+----+------+5 rows in set (0.00 sec)mysql&gt; update mylock set name&#x3D;&#39;bb&#39; where id&#x3D;2;  -- ä¿®æ”¹é˜»å¡ï¼Œè‡ªåŠ¨åŠ ä¸Šè¡Œå†™é”-- session1mysql&gt; unlock tables;Query OK, 0 rows affected (0.00 sec)-- session2Query OK, 1 row affected (1 min 35.08 sec)Rows matched: 1  Changed: 1  Warnings: 0        -- session1è§£é”åç«‹åˆ»æ‰§è¡Œmysql&gt; update mylock set name&#x3D;&#39;b&#39; where id&#x3D;2;    Query OK, 1 row affected (0.01 sec)Rows matched: 1  Changed: 1  Warnings: 0-- session1mysql&gt; select * from dept;                      -- session1å¯ä»¥è®¿é—®å…¶ä»–è¡¨+----+------+| id | name |+----+------+|  1 | a    ||  2 | b    ||  3 | c    ||  4 | d    ||  5 | e    |+----+------+5 rows in set (0.00 sec)</code></pre><p><img src="/images/mysql/twlock.png"></p><pre><code class="hljs mysql">-- session1mysql&gt; lock table mylock read;Query OK, 0 rows affected (0.00 sec)mysql&gt; select * from mylock;+----+------+| id | name |+----+------+|  1 | a    ||  2 | b    ||  3 | c    ||  4 | d    ||  5 | e    |+----+------+5 rows in set (0.00 sec)mysql&gt; select * from dept;ERROR 1100 (HY000): Table &#39;dept&#39; was not locked with LOCK TABLESmysql&gt; update mylock set name&#x3D;&#39;b&#39; where id&#x3D;2;   -- sessionå¯ä»¥ä¿®æ”¹Query OK, 1 row affected (0.01 sec)Rows matched: 1  Changed: 1  Warnings: 0-- session2mysql&gt; select * from mylock;                    -- æŸ¥è¯¢é˜»å¡-- session1mysql&gt; unlock tables;Query OK, 0 rows affected (0.00 sec)-- session2+----+------+| id | name |+----+------+|  1 | a    ||  2 | b    ||  3 | c    ||  4 | d    ||  5 | e    |+----+------+5 rows in set (0.00 sec)</code></pre><h4 id="å…ƒæ•°æ®é”-MDL"><a href="#å…ƒæ•°æ®é”-MDL" class="headerlink" title="å…ƒæ•°æ®é”(MDL)"></a>å…ƒæ•°æ®é”(MDL)</h4><p><strong>MDLä¸éœ€è¦æ˜¾ç¤ºä½¿ç”¨ï¼Œåœ¨è®¿é—®ä¸€ä¸ªè¡¨çš„æ—¶å€™ä¼šè‡ªåŠ¨åŠ ä¸Š</strong>ã€‚**MDLçš„é”ä½œç”¨æ˜¯ä¿è¯å†™çš„æ­£ç¡®æ€§ï¼Œå¯ä»¥æƒ³åƒä¸€ä¸‹ï¼šå¦‚æœä¸€ä¸ªæŸ¥è¯¢æ­£åœ¨éå†è¡¨ä¸­çš„æ•°æ®ï¼Œè€Œæ‰§è¡ŒæœŸé—´å¦ä¸€ä¸ªçº¿ç¨‹å¯¹è¿™ä¸ªè¡¨ç»“æ„åšå˜æ›´åˆ é™¤ä¸€è¡Œï¼Œé‚£ä¹ˆæŸ¥è¯¢å¿åŸæ‹¿åˆ°çš„ç»“æœä¾¿å¯èƒ½è·Ÿå½“å‰çš„è¡¨ç»“æ„å¯¹åº”ä¸ä¸Šã€‚</p><p>å› æ­¤ï¼Œåœ¨MySQ L5.5ç‰ˆæœ¬ä¸­å¼•å…¥MDLï¼Œ<strong>å½“å¯¹ä¸€ä¸ªè¡¨ä¸­åšå¢åˆ æ”¹æŸ¥æ“ä½œæ—¶ï¼ŒåŠ MDLè¯»é”ï¼›å½“è¦å¯¹è¡¨ç»“æ„å˜æ›´æ“ä½œæ—¶ï¼ŒåŠ MDLå†™é”</strong>ã€‚</p><ul><li>è¯»é”ä¹‹é—´ä¸äº’æ–¥ï¼Œå› æ­¤å¯ä»¥æœ‰å¤šä¸ªçº¿ç¨‹å¯¹ä¸€è¡Œè¡¨å¢åˆ æ”¹æŸ¥</li><li>è¯»å†™é”ä¹‹é—´ã€å†™é”ä¹‹é—´æ˜¯äº’æ–¥çš„ï¼Œç”¨æ¥ä¿è¯å˜æ›´è¡¨ç»“æ„æ“ä½œçš„å®‰å…¨æ€§ã€‚å› æ­¤ï¼Œå¦‚æœæœ‰ä¸¤ä¸ªçº¿ç¨‹åŒæ—¶è¦ç»™ä¸€ä¸ªè¡¨åŠ å­—æ®µï¼Œå…¶ä¸­ä¸€ä¸ªè¦ç­‰å¦ä¸€ä¸ªæ‰§è¡Œå®Œæ‰èƒ½æ‰§è¡Œã€‚</li></ul><p><img src="/images/mysql/tmlock.png"></p><pre><code class="hljs mysql">-- session1mysql&gt; begin;Query OK, 0 rows affected (0.00 sec)mysql&gt; select * from mylock;+----+------+| id | name |+----+------+|  1 | a    ||  2 | b    ||  3 | c    ||  4 | d    ||  5 | e    |+----+------+5 rows in set (0.00 sec)-- session2mysql&gt; alter table mylock add dep int;        -- é˜»å¡-- session1mysql&gt; commit;                                -- é‡Šæ”¾é”Query OK, 0 rows affected (0.00 sec)-- session2Query OK, 0 rows affected (12.80 sec)         -- å®Œæˆä¿®æ”¹Records: 0  Duplicates: 0  Warnings: 0mysql&gt; desc mylock;+-------+-------------+------+-----+---------+----------------+| Field | Type        | Null | Key | Default | Extra          |+-------+-------------+------+-----+---------+----------------+| id    | int(11)     | NO   | PRI | NULL    | auto_increment || name  | varchar(20) | YES  |     | NULL    |                || dep   | int(11)     | YES  |     | NULL    |                |+-------+-------------+------+-----+---------+----------------+3 rows in set (0.00 sec)</code></pre><h4 id="MySQLè¡Œçº§é”"><a href="#MySQLè¡Œçº§é”" class="headerlink" title="MySQLè¡Œçº§é”"></a>MySQLè¡Œçº§é”</h4><h5 id="åŸºç¡€æ¦‚å¿µ"><a href="#åŸºç¡€æ¦‚å¿µ" class="headerlink" title="åŸºç¡€æ¦‚å¿µ"></a>åŸºç¡€æ¦‚å¿µ</h5><p>ç”±å­˜å‚¨å¼•æ“å®ç°ï¼Œåˆ©ç”¨å­˜å‚¨å¼•æ“é”ä½ç´¢å¼•é¡¹æ¥å®ç°ã€‚</p><p>InnoDBçš„è¡Œçº§é”ï¼ŒæŒ‰ç…§é”å®šèŒƒå›´æ¥è¯´ï¼Œåˆ†ä¸ºä¸‰ç§ï¼š</p><pre><code class="hljs mysql">- è®°å½•é”ï¼ˆRecord locksï¼‰:é”å®šç´¢å¼•ä¸­ä¸€æ¡è®°å½•- é—´éš™é”ï¼ˆGap Locksï¼‰:è¦ä¹ˆé”ç´¢å¼•ä¸­é—´çš„å€¼ï¼Œè¦ä¹ˆé”ä½ç¬¬ä¸€ä¸ªç´¢å¼•è®°å½•å‰é¢çš„å€¼æˆ–è€…æœ€åä¸€ä¸ªç´¢å¼•åé¢çš„å€¼ã€‚- Next-key Locks:æ˜¯ç´¢å¼•è®°å½•ä¸Šçš„è®°å½•é”åœ¨ç´¢å¼•è®°å½•ä¹‹å‰çš„é—´éš™é”çš„ç»„åˆ</code></pre><p>InnoDBçš„è¡Œçº§é”ï¼ŒæŒ‰ç…§åŠŸèƒ½åˆ†ä¸ºä¸¤ç§ï¼š</p><pre><code class="hljs mysql">- å…±äº«é”ï¼ˆSï¼‰:å…è®¸ä¸€ä¸ªäº‹åŠ¡å»è¯»ä¸€è¡Œï¼Œé˜»æ­¢å…¶ä»–äº‹åŠ¡è·å¾—ç›¸åŒæ•°æ®é›†çš„æ’å®ƒé”- æ’å®ƒé”ï¼ˆSï¼‰:å…è®¸è·å¾—æ’å®ƒé”çš„äº‹åŠ¡æ›´æ–°æ•°æ®ï¼Œé˜»æ­¢å…¶ä»–äº‹åŠ¡è·å¾—ç›¸åŒæ•°æ®é›†çš„å…±äº«è¯»é”(ä¸æ˜¯è¯»)å’Œæ’å®ƒé”</code></pre><p>å¯¹äºUPDATEã€DELETEã€INSERTè¯­å¥ï¼ŒInnoDBä¼šè‡ªåŠ¨ç»™è®¾è®¡æ•°æ®é›†åŠ æ’å®ƒé”ï¼ˆXï¼‰;</p><p>å¯¹äºæ™®é€šSELECTè¯­å¥ï¼ŒInnoDBä¸å›å®¶ä»»ä½•é”ï¼Œäº‹åŠ¡å¯ä»¥é€šè¿‡ä»¥ä¸‹è¯­å¥æ˜¾ç¤ºç»™è®°å½•é›†åŠ å…±äº«é”å’Œæ’å®ƒé”ã€‚</p><p><strong>æ‰‹åŠ¨æ·»åŠ å…±äº«é”(S)</strong></p><pre><code class="hljs mysql">select * from table_name where ... lock in share mode;</code></pre><p><strong>æ‰‹åŠ¨æ·»åŠ æ’å®ƒé”(X)</strong></p><pre><code class="hljs mysql">select * from table_name where ... for update;</code></pre><p>InnoDBä¹Ÿå®ç°äº†è¡¨çº§é”ï¼Œä¹Ÿå°±æ˜¯æ„å‘é”ã€‚æ„å‘é”æ˜¯mysqlå†…éƒ¨ä½¿ç”¨çš„ï¼Œä¸éœ€è¦ç”¨æˆ·å¹²é¢„ã€‚</p><pre><code class="hljs mysql">- æ„å‘å…±äº«é”ï¼ˆISï¼‰:äº‹åŠ¡æ‰“ç®—ç»™æ•°æ®è¡ŒåŠ è¡Œå…±äº«é”ï¼Œäº‹åŠ¡ç»™ä¸€ä¸ªæ•°æ®è¡ŒåŠ è¡Œå…±äº«é”å¿…é¡»å…ˆå»çš„è¯¥è¡¨çš„ISé”ã€‚- æ„å‘æ’å®ƒé”ï¼ˆIXï¼‰:äº‹åŠ¡æ‰“ç®—ç»™æ•°æ®è¡ŒåŠ è¡Œæ’å®ƒé”ï¼Œäº‹åŠ¡ç»™ä¸€ä¸ªæ•°æ®è¡ŒåŠ è¡Œæ’å®ƒé”å¿…é¡»å…ˆå»çš„è¯¥è¡¨çš„IXé”ã€‚</code></pre><p>æ„å‘é”å’Œè¡Œé”å¯ä»¥å…±å­˜ï¼Œæ„å‘é”çš„ä¸»è¦ä½œç”¨æ˜¯ä¸ºäº†ã€å…¨è¡¨æ›´æ–°æ•°æ®ã€‘æ˜¯çš„æ€§èƒ½æå‡ã€‚å¦åˆ™åœ¨å…¨è¡¨æ›´æ–°æ•°æ®æ—¶ï¼Œéœ€è¦å…ˆæ£€ç´¢è¯¥è¡¨æ˜¯å¦æœ‰æŸç³»è®°å½•ä¸Šé¢æœ‰è¡Œé”ã€‚</p><table><thead><tr><th></th><th>å…±äº«é”(S)</th><th>æ’å®ƒé”(X)</th><th>æ„å‘å…±äº«é”ï¼ˆISï¼‰</th><th>æ„å‘æ’å®ƒé”ï¼ˆIXï¼‰</th></tr></thead><tbody><tr><td>å…±äº«é”(S)</td><td>å…¼å®¹</td><td>å†²çª</td><td>å…¼å®¹</td><td>å†²çª</td></tr><tr><td>æ’å®ƒé”(X)</td><td>å†²çª</td><td>å†²çª</td><td>å†²çª</td><td>å†²çª</td></tr><tr><td>æ„å‘å…±äº«é”ï¼ˆISï¼‰</td><td>å…¼å®¹</td><td>å†²çª</td><td>å…¼å®¹</td><td>å…¼å®¹</td></tr><tr><td>æ„å‘æ’å®ƒé”ï¼ˆIXï¼‰</td><td>å†²çª</td><td>å†²çª</td><td>å…¼å®¹</td><td>å…¼å®¹</td></tr></tbody></table><p><strong>InnoDBè¡Œé”</strong>æ˜¯é€šè¿‡ç»™ç´¢å¼•ä¸Šçš„<strong>ç´¢å¼•é¡¹åŠ é”æ¥å®ç°</strong>çš„ï¼Œå› æ­¤InnoDBè¿™ç§è¡Œé”çš„å®ç°ç‰¹ç‚¹æ„å‘³ç€ï¼šåªæœ‰é€šè¿‡<strong>ç´¢å¼•æ¡ä»¶æ£€ç´¢çš„æ•°æ®</strong>ï¼ŒInnoDBæ‰ä½¿ç”¨<strong>è¡Œçº§é”</strong>ï¼›å¦åˆ™ï¼ŒInnoDBå°†ä½¿ç”¨<strong>è¡¨çº§é”</strong></p><p>InnoDBé”ä½¿ç”¨<strong>è¡Œçº§é”</strong>äº‰ç”¨çŠ¶æ€æŸ¥çœ‹å‘½ä»¤</p><pre><code class="hljs mysql">mysql&gt; show status like &#39;innodb_row_lock%&#39;;+-------------------------------+-------+| Variable_name                 | Value |+-------------------------------+-------+| Innodb_row_lock_current_waits | 0     |  -- å½“å‰æ­£åœ¨ç­‰å¾…é”å®šçš„æ•°é‡| Innodb_row_lock_time          | 0     |  -- +ä»ç³»ç»Ÿå¯åŠ¨åˆ°ç°åœ¨é”å®šæ€»æ—¶é—´é•¿åº¦| Innodb_row_lock_time_avg      | 0     |  -- +æ¯æ¬¡ç­‰å¾…é”è¯å¹³å‡æ—¶é—´| Innodb_row_lock_time_max      | 0     |  -- ä»ç³»ç»Ÿå¯åŠ¨åˆ°ç°åœ¨ç­‰å¾…æœ€é•¿é‚£æ¬¡æ—¶é—´| Innodb_row_lock_waits         | 0     |  -- +ä»ç³»ç»Ÿå¯åŠ¨åˆ°ç°åœ¨æ€»å…±ç­‰å¾…çš„æ¬¡æ•°+-------------------------------+-------+5 rows in set (0.00 sec)</code></pre><h5 id="ä¸¤é˜¶æ®µé”"><a href="#ä¸¤é˜¶æ®µé”" class="headerlink" title="ä¸¤é˜¶æ®µé”"></a>ä¸¤é˜¶æ®µé”</h5><p>ä¼ ç»Ÿçš„RDMSåŠ é”åŸåˆ™å°±æ˜¯2PLï¼ˆTwo-Phase Locking,ä¸¤é˜¶æ®µé”ï¼‰ã€‚ç›¸å¯¹è€Œè¨€ï¼Œ2PLæ¯”è¾ƒå®¹æ˜“ç†è§£ï¼šåŠ é”é˜¶æ®µä¸è§£é”é˜¶æ®µï¼Œå¹¶ä¸”ä¿è¯åŠ é”é˜¶æ®µä¸è§£é”é˜¶æ®µä¸ç›¸äº¤ã€‚</p><p><img src="/images/mysql/2pll.png"></p><pre><code class="hljs plain">åŠ é”é˜¶æ®µï¼šåªåŠ é”ï¼Œä¸æ”¾é”è§£é”é˜¶æ®µï¼šåªæ”¾é”ï¼Œä¸åŠ é”</code></pre><h5 id="è¡Œè¯»é”"><a href="#è¡Œè¯»é”" class="headerlink" title="è¡Œè¯»é”"></a>è¡Œè¯»é”</h5><pre><code class="hljs mysql">-- session1mysql&gt; begin;Query OK, 0 rows affected (0.00 sec)mysql&gt; select * from mylock where id&#x3D;1 lock in share mode; -- æ‰‹åŠ¨id&#x3D;1åŠ è¡Œè¯»é”+----+------+------+| id | name | dep  |+----+------+------+|  1 | a    | NULL |+----+------+------+1 row in set (0.00 sec)-- session2mysql&gt; update mylock set name&#x3D;&#39;bb&#39; where id&#x3D;2;  -- æœªé”å®šå¯ä»¥ä¿®æ”¹mysql&gt; update mylock set name&#x3D;&#39;aa&#39; where id&#x3D;1;  -- é”å®šä¸å¯ä¿®æ”¹ERROR 1205 (HY000): Lock wait timeout exceeded; try restarting transaction   -- é”å®šè¶…æ—¶Query OK, 1 row affected (0.01 sec) Rows matched: 1  Changed: 1  Warnings: 0-- session1mysql&gt; commit;  -- æäº¤äº‹åŠ¡&#x2F;rollbacké‡Šæ”¾é”Query OK, 0 rows affected (0.00 sec)-- session2Query OK, 1 row affected (12.06 sec)Rows matched: 1  Changed: 1  Warnings: 0</code></pre><h5 id="è¡Œè¯»é”å‡çº§ä¸ºè¡¨é”"><a href="#è¡Œè¯»é”å‡çº§ä¸ºè¡¨é”" class="headerlink" title="è¡Œè¯»é”å‡çº§ä¸ºè¡¨é”"></a>è¡Œè¯»é”å‡çº§ä¸ºè¡¨é”</h5><pre><code class="hljs mysql">-- session1mysql&gt; begin;Query OK, 0 rows affected (0.00 sec)mysql&gt; select * from mylock where name&#x3D;&#39;a&#39; lock in share mode; -- æ‰‹åŠ¨name&#x3D;&#39;a&#39;éç´¢å¼• è¡Œè¯»é”å‡çº§è¡¨é”+----+------+------+| id | name | dep  |+----+------+------+|  1 | a    | NULL |+----+------+------+1 row in set (0.00 sec)-- session2mysql&gt; update mylock set name&#x3D;&#39;b&#39; where id&#x3D;2;  -- é˜»å¡ ä¸å¯ä¿®æ”¹ERROR 1205 (HY000): Lock wait timeout exceeded; try restarting transactionmysql&gt; update mylock set name&#x3D;&#39;a&#39; where id&#x3D;1;   -- é˜»å¡ ä¸å¯ä¿®æ”¹ERROR 1205 (HY000): Lock wait timeout exceeded; try restarting transaction-- session1mysql&gt; commit;  -- æäº¤äº‹åŠ¡&#x2F;rollbacké‡Šæ”¾é”Query OK, 0 rows affected (0.00 sec)-- session2mysql&gt; update mylock set name&#x3D;&#39;b&#39; where id&#x3D;2;Query OK, 1 row affected (0.00 sec)Rows matched: 1  Changed: 1  Warnings: 0mysql&gt; update mylock set name&#x3D;&#39;a&#39; where id&#x3D;1;Query OK, 0 rows affected (0.00 sec)Rows matched: 1  Changed: 0  Warnings: 0</code></pre><h5 id="è¡Œå†™é”"><a href="#è¡Œå†™é”" class="headerlink" title="è¡Œå†™é”"></a>è¡Œå†™é”</h5><pre><code class="hljs mysql">-- session1mysql&gt; begin;Query OK, 0 rows affected (0.00 sec)mysql&gt; select * from mylock where id&#x3D;1 for update;-- session2mysql&gt; update mylock set name&#x3D;&#39;bb&#39; where id&#x3D;2;  -- æœªé”å®šå¯ä»¥ä¿®æ”¹Query OK, 1 row affected (0.01 sec) Rows matched: 1  Changed: 1  Warnings: 0mysql&gt; select * from mylock where id&#x3D;1;  -- selectæœ¬èº«ä¸åŠ é” å¯ä»¥è®¿é—®+----+------+------+| id | name | dep  |+----+------+------+|  1 | a    | NULL |+----+------+------+1 row in set (0.00 sec)mysql&gt; select * from mylock where id&#x3D;1 lock in share mode; -- å…±äº«è¯»é”ä¸å¯è·å¾—ERROR 1205 (HY000): Lock wait timeout exceeded; try restarting transaction mysql&gt; update mylock set name&#x3D;&#39;aa&#39; where id&#x3D;1;  -- é”å®šä¸å¯ä¿®æ”¹ERROR 1205 (HY000): Lock wait timeout exceeded; try restarting transaction -- session1mysql&gt; commit;  -- æäº¤äº‹åŠ¡&#x2F;rollbacké‡Šæ”¾é”Query OK, 0 rows affected (0.00 sec)-- session2Query OK, 1 row affected (12.06 sec)Rows matched: 1  Changed: 1  Warnings: 0</code></pre><h5 id="è¡Œå†™é”å‡çº§ä¸ºè¡¨é”"><a href="#è¡Œå†™é”å‡çº§ä¸ºè¡¨é”" class="headerlink" title="è¡Œå†™é”å‡çº§ä¸ºè¡¨é”"></a>è¡Œå†™é”å‡çº§ä¸ºè¡¨é”</h5><pre><code class="hljs mysql">-- session1mysql&gt; begin;Query OK, 0 rows affected (0.00 sec)mysql&gt; select * from mylock where name&#x3D;&#39;a&#39; for update; -- æ‰‹åŠ¨name&#x3D;&#39;a&#39;éç´¢å¼• è¡Œè¯»é”å‡çº§è¡¨é”+----+------+------+| id | name | dep  |+----+------+------+|  1 | a    | NULL |+----+------+------+1 row in set (0.00 sec)-- session2mysql&gt; select * from mylock;+----+------+------+| id | name | dep  |+----+------+------+|  1 | a    | NULL ||  2 | b    | NULL ||  3 | c    | NULL ||  4 | d    | NULL ||  5 | e    | NULL |+----+------+------+5 rows in set (0.00 sec)mysql&gt; select * from mylock where id&#x3D;1;+----+------+------+| id | name | dep  |+----+------+------+|  1 | a    | NULL |+----+------+------+1 row in set (0.00 sec)mysql&gt; select * from mylock where id&#x3D;1 lock in share mode; -- é˜»å¡ ä¸å¯è·å¾—é”ERROR 1205 (HY000): Lock wait timeout exceeded; try restarting transactionmysql&gt; update mylock set name&#x3D;&#39;b&#39; where id&#x3D;2;  -- é˜»å¡ ä¸å¯ä¿®æ”¹ERROR 1205 (HY000): Lock wait timeout exceeded; try restarting transactionmysql&gt; update mylock set name&#x3D;&#39;a&#39; where id&#x3D;1;   -- é˜»å¡ ä¸å¯ä¿®æ”¹ERROR 1205 (HY000): Lock wait timeout exceeded; try restarting transaction-- session1mysql&gt; commit;  -- æäº¤äº‹åŠ¡&#x2F;rollbacké‡Šæ”¾é”Query OK, 0 rows affected (0.00 sec)-- session2mysql&gt; update mylock set name&#x3D;&#39;b&#39; where id&#x3D;2;Query OK, 1 row affected (0.00 sec)Rows matched: 1  Changed: 1  Warnings: 0mysql&gt; update mylock set name&#x3D;&#39;a&#39; where id&#x3D;1;Query OK, 0 rows affected (0.00 sec)Rows matched: 1  Changed: 0  Warnings: 0</code></pre><h5 id="é—´éš™é”"><a href="#é—´éš™é”" class="headerlink" title="é—´éš™é”"></a>é—´éš™é”</h5><pre><code class="hljs mysql">create table news(id int, number int, primary key(id), index idx_num(number));insert into news values(1,2);insert into news values(3,4);insert into news values(6,5);insert into news values(8,5);insert into news values(10,5);insert into news values(13,11);mysql&gt; select * from news;+----+--------+| id | number |  # idä¸»é”® ç´¢å¼• number+----+--------+|  1 |      2 ||  3 |      4 ||  6 |      5 ||  8 |      5 || 10 |      5 || 13 |     11 |+----+--------+6 rows in set (0.01 sec)-- session1mysql&gt; start transaction;Query OK, 0 rows affected (0.00 sec)mysql&gt; select * from news where number&#x3D;4 for update;-- idåœ¨2ã€5ä¹‹é—´å’Œ3-5ä¹‹é—´ä¸”number2-6åœ¨å‡è¢«é”ä½+----+--------+| id | number |+----+--------+|  3 |      4 |+----+--------+1 row in set (0.01 sec)-- session2mysql&gt; start transaction;mysql&gt; insert into news values(2,4);  -- é˜»å¡ERROR 1205 (HY000): Lock wait timeout exceeded; try restarting transactionmysql&gt; insert into news values(2,2);  -- é˜»å¡ERROR 1205 (HY000): Lock wait timeout exceeded; try restarting transactionmysql&gt; insert into news values(4,4);  -- é˜»å¡ERROR 1205 (HY000): Lock wait timeout exceeded; try restarting transactionmysql&gt; insert into news values(4,5);  -- é˜»å¡ERROR 1205 (HY000): Lock wait timeout exceeded; try restarting transactionmysql&gt; insert into news values(5,7);Query OK, 1 row affected (0.00 sec)mysql&gt; insert into news values(7,5);Query OK, 1 row affected (0.01 sec)mysql&gt; insert into news values(9,5);Query OK, 1 row affected (0.01 sec)mysql&gt; insert into news values(11,5);Query OK, 1 row affected (0.01 sec)insert into news values(13,11);mysql&gt; select * from news;mysql&gt; select * from news;+----+--------+| id | number |+----+--------+|  1 |      2 ||  3 |      4 ||  6 |      5 ||  8 |      5 || 10 |      5 || 13 |     11 |+----+--------+6 rows in set (0.01 sec)-- session1mysql&gt; start transaction;Query OK, 0 rows affected (0.00 sec)mysql&gt; select * from news where number&#x3D;13 for update;      ï¼ˆselect * from news where id&gt;1 and id&lt;4 for update;ï¼‰mysql&gt; start transaction;mysql&gt; insert into news values(11,5);Query OK, 1 row affected (0.00 sec)mysql&gt; insert into news values(12,11);Query OK, 1 row affected (0.00 sec)mysql&gt; insert into news values(14,11);ERROR 1205 (HY000): Lock wait timeout exceeded; try restarting transactionmysql&gt; insert into news values(15,12);ERROR 1205 (HY000): Lock wait timeout exceeded; try restarting transactionæ£€ç´¢æ¡ä»¶number&#x3D;13ï¼Œæƒ³åšå–å¾—æœ€é è¿‘çš„å€¼11ä½œä¸ºä½œåŒºé—´ï¼Œå‘å³ç”±äºæ²¡æœ‰è®°å½•å› æ­¤å–å¾—æ— ç©·å¤§ä½œä¸ºå³åŒºé—´ï¼Œå³session1é—´éš™é”åŒºé—´ï¼ˆ11ï¼Œæ— ç©·å¤§ï¼‰</code></pre><h5 id="æ­»é”"><a href="#æ­»é”" class="headerlink" title="æ­»é”"></a>æ­»é”</h5><p>ä¸¤ä¸ªsessionäº’ç›¸ç­‰å¾…å¯¹æ–¹çš„é‡Šæ”¾èµ„æºä¹‹åï¼Œæ‰èƒ½é‡Šæ”¾è‡ªå·±çš„èµ„æº</p><pre><code class="hljs mysql">-- session1mysql&gt;begin;Query OK, 0 rows affected (0.00 sec)mysql&gt;update mylock set name&#x3D;&#39;m&#39; where id&#x3D;1;  -- æ‰‹åŠ¨åŠ è¡Œå†™é” id&#x3D;1,ä½¿ç”¨ç´¢å¼•Query OK, 1 row affected (0.00 sec)Rows matched: 1  Changed: 1  Warnings: 0-- session2mysql&gt;begin;Query OK, 0 rows affected (0.00 sec)mysql&gt;update mylock set name&#x3D;&#39;m&#39; where id&#x3D;2;  -- æ‰‹åŠ¨åŠ è¡Œå†™é” id&#x3D;2,ä½¿ç”¨ç´¢å¼•Query OK, 1 row affected (0.00 sec)Rows matched: 1  Changed: 1  Warnings: 0-- session1mysql&gt;update mylock set name&#x3D;&#39;nn&#39; where id&#x3D;2; -- åŠ å†™é”è¢«é˜»å¡-- session2mysql&gt;update mylock set name&#x3D;&#39;nn&#39; where id&#x3D;1; -- åŠ å†™é”ä¼šæ­»é” ä¸å…è®¸æ“ä½œERROR 1213 (40001): Deadlock found when trying to get lock; try restarting transaction</code></pre><h4 id="ç›¸å…³é¢è¯•é¢˜-1"><a href="#ç›¸å…³é¢è¯•é¢˜-1" class="headerlink" title="ç›¸å…³é¢è¯•é¢˜"></a>ç›¸å…³é¢è¯•é¢˜</h4><h5 id="ä»€ä¹ˆæ˜¯é”ï¼ŸMySQL-ä¸­æä¾›äº†å‡ ç±»é”ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯é”ï¼ŸMySQL-ä¸­æä¾›äº†å‡ ç±»é”ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯é”ï¼ŸMySQL ä¸­æä¾›äº†å‡ ç±»é”ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯é”ï¼ŸMySQL ä¸­æä¾›äº†å‡ ç±»é”ï¼Ÿ</h5><p>é”æ˜¯å®ç°æ•°æ®åº“å¹¶å‘æ§åˆ¶çš„é‡è¦æ‰‹æ®µï¼Œå¯ä»¥ä¿è¯æ•°æ®åº“åœ¨å¤šäººåŒæ—¶æ“ä½œæ—¶èƒ½å¤Ÿæ­£å¸¸è¿è¡Œã€‚MySQL æä¾›äº†å…¨å±€é”ã€è¡Œçº§é”ã€è¡¨çº§é”ã€‚å…¶ä¸­ InnoDB æ”¯æŒè¡¨çº§é”å’Œè¡Œçº§é”ï¼ŒMyISAM åªæ”¯æŒè¡¨çº§é”ã€‚</p><h5 id="ä»€ä¹ˆæ˜¯å…¨å±€é”ï¼Ÿå®ƒçš„åº”ç”¨åœºæ™¯æœ‰å“ªäº›ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯å…¨å±€é”ï¼Ÿå®ƒçš„åº”ç”¨åœºæ™¯æœ‰å“ªäº›ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯å…¨å±€é”ï¼Ÿå®ƒçš„åº”ç”¨åœºæ™¯æœ‰å“ªäº›ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯å…¨å±€é”ï¼Ÿå®ƒçš„åº”ç”¨åœºæ™¯æœ‰å“ªäº›ï¼Ÿ</h5><p>å…¨å±€é”å°±æ˜¯å¯¹æ•´ä¸ªæ•°æ®åº“å®ä¾‹åŠ é”ï¼Œå®ƒçš„å…¸å‹ä½¿ç”¨åœºæ™¯å°±æ˜¯åšå…¨åº“é€»è¾‘å¤‡ä»½ã€‚ è¿™ä¸ªå‘½ä»¤å¯ä»¥ä½¿æ•´ä¸ªåº“å¤„äºåªè¯»çŠ¶æ€ã€‚ä½¿ç”¨è¯¥å‘½ä»¤ä¹‹åï¼Œæ•°æ®æ›´æ–°è¯­å¥ã€æ•°æ®å®šä¹‰è¯­å¥ã€æ›´æ–°ç±»äº‹åŠ¡çš„æäº¤è¯­å¥ç­‰æ“ä½œéƒ½ä¼šè¢«é˜»å¡ã€‚</p><h5 id="ä»€ä¹ˆæ˜¯å…±äº«é”ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯å…±äº«é”ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯å…±äº«é”ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯å…±äº«é”ï¼Ÿ</h5><p>å…±äº«é”åˆç§°è¯»é” (read lock)ï¼Œæ˜¯è¯»å–æ“ä½œåˆ›å»ºçš„é”ã€‚å…¶ä»–ç”¨æˆ·å¯ä»¥å¹¶å‘è¯»å–æ•°æ®ï¼Œä½†ä»»ä½•äº‹åŠ¡éƒ½ä¸èƒ½å¯¹æ•°æ®è¿›è¡Œä¿®æ”¹ï¼ˆè·å–æ•°æ®ä¸Šçš„æ’ä»–é”ï¼‰ï¼Œç›´åˆ°å·²é‡Šæ”¾æ‰€æœ‰å…±äº«é”ã€‚å½“å¦‚æœäº‹åŠ¡å¯¹è¯»é”è¿›è¡Œä¿®æ”¹æ“ä½œï¼Œå¾ˆå¯èƒ½ä¼šé€ æˆæ­»é”ã€‚</p><h5 id="ä»€ä¹ˆæ˜¯æ’å®ƒé”ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯æ’å®ƒé”ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯æ’å®ƒé”ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯æ’å®ƒé”ï¼Ÿ</h5><p>æ’ä»–é” exclusive lockï¼ˆä¹Ÿå« writer lockï¼‰åˆç§°å†™é”ã€‚</p><p>è‹¥æŸä¸ªäº‹ç‰©å¯¹æŸä¸€è¡ŒåŠ ä¸Šäº†æ’ä»–é”ï¼Œåªèƒ½è¿™ä¸ªäº‹åŠ¡å¯¹å…¶è¿›è¡Œè¯»å†™ï¼Œåœ¨æ­¤äº‹åŠ¡ç»“æŸä¹‹å‰ï¼Œå…¶ä»–äº‹åŠ¡ä¸èƒ½å¯¹å…¶è¿›è¡ŒåŠ ä»»ä½•é”ï¼Œå…¶ä»–è¿›ç¨‹å¯ä»¥è¯»å–,ä¸èƒ½è¿›è¡Œå†™æ“ä½œï¼Œéœ€ç­‰å¾…å…¶é‡Šæ”¾ã€‚</p><p>æ’å®ƒé”æ˜¯æ‚²è§‚é”çš„ä¸€ç§å®ç°ï¼Œåœ¨ä¸Šé¢æ‚²è§‚é”ä¹Ÿä»‹ç»è¿‡ã€‚</p><p>è‹¥äº‹åŠ¡ 1 å¯¹æ•°æ®å¯¹è±¡ A åŠ ä¸Š X é”ï¼Œäº‹åŠ¡ 1 å¯ä»¥è¯» A ä¹Ÿå¯ä»¥ä¿®æ”¹ Aï¼Œå…¶ä»–äº‹åŠ¡ä¸èƒ½å†å¯¹ A åŠ ä»»ä½•é”ï¼Œç›´åˆ°äº‹ç‰© 1 é‡Šæ”¾ A ä¸Šçš„é”ã€‚è¿™ä¿è¯äº†å…¶ä»–äº‹åŠ¡åœ¨äº‹ç‰© 1 é‡Šæ”¾ A ä¸Šçš„é”ä¹‹å‰ä¸èƒ½å†è¯»å–å’Œä¿®æ”¹ Aã€‚æ’å®ƒé”ä¼šé˜»å¡æ‰€æœ‰çš„æ’å®ƒé”å’Œå…±äº«é”ã€‚</p><h5 id="InnoDB-å­˜å‚¨å¼•æ“æœ‰å‡ ç§é”ç®—æ³•ï¼Ÿ"><a href="#InnoDB-å­˜å‚¨å¼•æ“æœ‰å‡ ç§é”ç®—æ³•ï¼Ÿ" class="headerlink" title="InnoDB å­˜å‚¨å¼•æ“æœ‰å‡ ç§é”ç®—æ³•ï¼Ÿ"></a>InnoDB å­˜å‚¨å¼•æ“æœ‰å‡ ç§é”ç®—æ³•ï¼Ÿ</h5><ul><li><p>Record Lock â€” å•ä¸ªè¡Œè®°å½•ä¸Šçš„é”ï¼›</p></li><li><p> Gap Lock â€” é—´éš™é”ï¼Œé”å®šä¸€ä¸ªèŒƒå›´ï¼Œä¸åŒ…æ‹¬è®°å½•æœ¬èº«ï¼›</p></li><li><p>Next-Key Lock â€” é”å®šä¸€ä¸ªèŒƒå›´ï¼ŒåŒ…æ‹¬è®°å½•æœ¬èº«ã€‚</p></li></ul><h5 id="ä½¿ç”¨å…¨å±€é”ä¼šå¯¼è‡´ä»€ä¹ˆé—®é¢˜ï¼Ÿ"><a href="#ä½¿ç”¨å…¨å±€é”ä¼šå¯¼è‡´ä»€ä¹ˆé—®é¢˜ï¼Ÿ" class="headerlink" title="ä½¿ç”¨å…¨å±€é”ä¼šå¯¼è‡´ä»€ä¹ˆé—®é¢˜ï¼Ÿ"></a>ä½¿ç”¨å…¨å±€é”ä¼šå¯¼è‡´ä»€ä¹ˆé—®é¢˜ï¼Ÿ</h5><p>å¦‚æœåœ¨ä¸»åº“å¤‡ä»½ï¼Œåœ¨å¤‡ä»½æœŸé—´ä¸èƒ½æ›´æ–°ï¼Œä¸šåŠ¡åœæ‘†ï¼Œæ‰€ä»¥æ›´æ–°ä¸šåŠ¡ä¼šå¤„äºç­‰å¾…çŠ¶æ€ã€‚</p><p>å¦‚æœåœ¨ä»åº“å¤‡ä»½ï¼Œåœ¨å¤‡ä»½æœŸé—´ä¸èƒ½æ‰§è¡Œä¸»åº“åŒæ­¥çš„ binlogï¼Œå¯¼è‡´ä¸»ä»å»¶è¿Ÿã€‚</p><h5 id="å¦‚ä½•å¤„ç†é€»è¾‘å¤‡ä»½æ—¶ï¼Œæ•´ä¸ªæ•°æ®åº“ä¸èƒ½æ’å…¥çš„æƒ…å†µï¼Ÿ"><a href="#å¦‚ä½•å¤„ç†é€»è¾‘å¤‡ä»½æ—¶ï¼Œæ•´ä¸ªæ•°æ®åº“ä¸èƒ½æ’å…¥çš„æƒ…å†µï¼Ÿ" class="headerlink" title="å¦‚ä½•å¤„ç†é€»è¾‘å¤‡ä»½æ—¶ï¼Œæ•´ä¸ªæ•°æ®åº“ä¸èƒ½æ’å…¥çš„æƒ…å†µï¼Ÿ"></a>å¦‚ä½•å¤„ç†é€»è¾‘å¤‡ä»½æ—¶ï¼Œæ•´ä¸ªæ•°æ®åº“ä¸èƒ½æ’å…¥çš„æƒ…å†µï¼Ÿ</h5><p>å¦‚æœä½¿ç”¨å…¨å±€é”è¿›è¡Œé€»è¾‘å¤‡ä»½å°±ä¼šè®©æ•´ä¸ªåº“æˆä¸ºåªè¯»çŠ¶æ€ï¼Œå¹¸å¥½å®˜æ–¹æ¨å‡ºäº†ä¸€ä¸ªé€»è¾‘å¤‡ä»½å·¥å…· MySQLdump æ¥è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼Œåªéœ€è¦åœ¨ä½¿ç”¨ MySQLdump æ—¶ï¼Œä½¿ç”¨å‚æ•° -single-transaction å°±ä¼šåœ¨å¯¼å…¥æ•°æ®ä¹‹å‰å¯åŠ¨ä¸€ä¸ªäº‹åŠ¡æ¥ä¿è¯æ•°æ®çš„ä¸€è‡´æ€§ï¼Œå¹¶ä¸”è¿™ä¸ªè¿‡ç¨‹æ˜¯æ”¯æŒæ•°æ®æ›´æ–°æ“ä½œçš„ã€‚</p><h5 id="å¦‚ä½•è®¾ç½®æ•°æ®åº“ä¸ºå…¨å±€åªè¯»é”ï¼Ÿ"><a href="#å¦‚ä½•è®¾ç½®æ•°æ®åº“ä¸ºå…¨å±€åªè¯»é”ï¼Ÿ" class="headerlink" title="å¦‚ä½•è®¾ç½®æ•°æ®åº“ä¸ºå…¨å±€åªè¯»é”ï¼Ÿ"></a>å¦‚ä½•è®¾ç½®æ•°æ®åº“ä¸ºå…¨å±€åªè¯»é”ï¼Ÿ</h5><p>ä½¿ç”¨å‘½ä»¤ <code>flush tables with read lock</code>ï¼ˆç®€ç§° FTWRLï¼‰å°±å¯ä»¥å®ç°è®¾ç½®æ•°æ®åº“ä¸ºå…¨å±€åªè¯»é”ã€‚</p><h5 id="é™¤äº†-FTWRL-å¯ä»¥è®¾ç½®æ•°æ®åº“åªè¯»å¤–ï¼Œè¿˜æœ‰ä»€ä¹ˆåˆ«çš„æ–¹æ³•ï¼Ÿ"><a href="#é™¤äº†-FTWRL-å¯ä»¥è®¾ç½®æ•°æ®åº“åªè¯»å¤–ï¼Œè¿˜æœ‰ä»€ä¹ˆåˆ«çš„æ–¹æ³•ï¼Ÿ" class="headerlink" title="é™¤äº† FTWRL å¯ä»¥è®¾ç½®æ•°æ®åº“åªè¯»å¤–ï¼Œè¿˜æœ‰ä»€ä¹ˆåˆ«çš„æ–¹æ³•ï¼Ÿ"></a>é™¤äº† FTWRL å¯ä»¥è®¾ç½®æ•°æ®åº“åªè¯»å¤–ï¼Œè¿˜æœ‰ä»€ä¹ˆåˆ«çš„æ–¹æ³•ï¼Ÿ</h5><p>é™¤äº†ä½¿ç”¨ FTWRL å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨å‘½ä»¤ <code>set global readonly=true</code> è®¾ç½®æ•°æ®åº“ä¸ºåªè¯»ã€‚</p><h5 id="FTWRL-å’Œ-set-global-readonly-true-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"><a href="#FTWRL-å’Œ-set-global-readonly-true-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ" class="headerlink" title="FTWRL å’Œ set global readonly=true æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"></a>FTWRL å’Œ set global readonly=true æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h5><p>FTWRL å’Œ set global readonly=true éƒ½æ˜¯è®¾ç½®æ•´ä¸ªæ•°æ®åº“ä¸ºåªè¯»çŠ¶æ€ï¼Œä½†ä»–ä»¬æœ€å¤§çš„åŒºåˆ«å°±æ˜¯ï¼Œå½“æ‰§è¡Œ FTWRL çš„å®¢æˆ·ç«¯æ–­å¼€ä¹‹åï¼Œæ•´ä¸ªæ•°æ®åº“ä¼šå–æ¶ˆåªè¯»ï¼Œè€Œ set global readonly=true ä¼šä¸€ç›´è®©æ•°æ®å¤„äºåªè¯»çŠ¶æ€ã€‚</p><h5 id="å¦‚ä½•å®ç°è¡¨é”ï¼Ÿ"><a href="#å¦‚ä½•å®ç°è¡¨é”ï¼Ÿ" class="headerlink" title="å¦‚ä½•å®ç°è¡¨é”ï¼Ÿ"></a>å¦‚ä½•å®ç°è¡¨é”ï¼Ÿ</h5><p>MySQL é‡Œæ ‡è®°é”æœ‰ä¸¤ç§ï¼šè¡¨çº§é”ã€å…ƒæ•°æ®é”ï¼ˆmeta data lockï¼‰ç®€ç§° MDLã€‚è¡¨é”çš„è¯­æ³•æ˜¯ lock tables t read/writeã€‚</p><p>å¯ä»¥ç”¨ unlock tables ä¸»åŠ¨é‡Šæ”¾é”ï¼Œä¹Ÿå¯ä»¥åœ¨å®¢æˆ·ç«¯æ–­å¼€çš„æ—¶å€™è‡ªåŠ¨é‡Šæ”¾ã€‚lock tables è¯­æ³•é™¤äº†ä¼šé™åˆ¶åˆ«çš„çº¿ç¨‹çš„è¯»å†™å¤–ï¼Œä¹Ÿé™å®šäº†æœ¬çº¿ç¨‹æ¥ä¸‹æ¥çš„æ“ä½œå¯¹è±¡ã€‚</p><p>å¯¹äº InnoDB è¿™ç§æ”¯æŒè¡Œé”çš„å¼•æ“ï¼Œä¸€èˆ¬ä¸ä½¿ç”¨ lock tables å‘½ä»¤æ¥æ§åˆ¶å¹¶å‘ï¼Œæ¯•ç«Ÿé”ä½æ•´ä¸ªè¡¨çš„å½±å“é¢è¿˜æ˜¯å¤ªå¤§ã€‚</p><p>MDLï¼šä¸éœ€è¦æ˜¾å¼ä½¿ç”¨ï¼Œåœ¨è®¿é—®ä¸€ä¸ªè¡¨çš„æ—¶å€™ä¼šè¢«è‡ªåŠ¨åŠ ä¸Šã€‚</p><p>MDL çš„ä½œç”¨ï¼šä¿è¯è¯»å†™çš„æ­£ç¡®æ€§ã€‚</p><p>åœ¨å¯¹ä¸€ä¸ªè¡¨åšå¢åˆ æ”¹æŸ¥æ“ä½œçš„æ—¶å€™ï¼ŒåŠ  MDL è¯»é”ï¼›å½“è¦å¯¹è¡¨åšç»“æ„å˜æ›´æ“ä½œçš„æ—¶å€™ï¼ŒåŠ  MDL å†™é”ã€‚</p><p>è¯»é”ä¹‹é—´ä¸äº’æ–¥ï¼Œè¯»å†™é”ä¹‹é—´ï¼Œå†™é”ä¹‹é—´æ˜¯äº’æ–¥çš„ï¼Œç”¨æ¥ä¿è¯å˜æ›´è¡¨ç»“æ„æ“ä½œçš„å®‰å…¨æ€§ã€‚</p><p>MDL ä¼šç›´åˆ°äº‹åŠ¡æäº¤æ‰ä¼šé‡Šæ”¾ï¼Œåœ¨åšè¡¨ç»“æ„å˜æ›´çš„æ—¶å€™ï¼Œä¸€å®šè¦å°å¿ƒä¸è¦å¯¼è‡´é”ä½çº¿ä¸ŠæŸ¥è¯¢å’Œæ›´æ–°ã€‚</p><h5 id="InnoDB-å¦‚ä½•å®ç°è¡Œé”ï¼Ÿ"><a href="#InnoDB-å¦‚ä½•å®ç°è¡Œé”ï¼Ÿ" class="headerlink" title="InnoDB å¦‚ä½•å®ç°è¡Œé”ï¼Ÿ"></a>InnoDB å¦‚ä½•å®ç°è¡Œé”ï¼Ÿ</h5><p>è¡Œçº§é”æ˜¯ MySQL ä¸­ç²’åº¦æœ€å°çš„ä¸€ç§é”ï¼Œä»–èƒ½å¤§å¤§å‡å°‘æ•°æ®åº“æ“ä½œçš„å†²çªã€‚</p><p>INNODB çš„è¡Œçº§é”æœ‰å…±äº«é”ï¼ˆS LOCKï¼‰å’Œæ’ä»–é”ï¼ˆX LOCKï¼‰ä¸¤ç§ã€‚å…±äº«é”å…è®¸äº‹ç‰©è¯»ä¸€è¡Œè®°å½•ï¼Œä¸å…è®¸ä»»ä½•çº¿ç¨‹å¯¹è¯¥è¡Œè®°å½•è¿›è¡Œä¿®æ”¹ã€‚æ’ä»–é”å…è®¸å½“å‰äº‹ç‰©åˆ é™¤æˆ–æ›´æ–°ä¸€è¡Œè®°å½•ï¼Œå…¶ä»–çº¿ç¨‹ä¸èƒ½æ“ä½œè¯¥è®°å½•ã€‚</p><p>å…±äº«é”ï¼šSELECT â€¦ LOCK IN SHARE MODEï¼ŒMySQL ä¼šå¯¹æŸ¥è¯¢ç»“æœé›†ä¸­æ¯è¡Œéƒ½æ·»åŠ å…±äº«é”ï¼Œå‰ææ˜¯å½“å‰çº¿ç¨‹æ²¡æœ‰å¯¹è¯¥ç»“æœé›†ä¸­çš„ä»»ä½•è¡Œä½¿ç”¨æ’ä»–é”ï¼Œå¦åˆ™ç”³è¯·ä¼šé˜»å¡ã€‚</p><p>æ’ä»–é”ï¼šselect * from t where id=1 for updateï¼Œå…¶ä¸­ id å­—æ®µå¿…é¡»æœ‰ç´¢å¼•ï¼ŒMySQL ä¼šå¯¹æŸ¥è¯¢ç»“æœé›†ä¸­æ¯è¡Œéƒ½æ·»åŠ æ’ä»–é”ï¼Œåœ¨äº‹ç‰©æ“ä½œä¸­ï¼Œä»»ä½•å¯¹è®°å½•çš„æ›´æ–°ä¸åˆ é™¤æ“ä½œä¼šè‡ªåŠ¨åŠ ä¸Šæ’ä»–é”ã€‚å‰ææ˜¯å½“å‰æ²¡æœ‰çº¿ç¨‹å¯¹è¯¥ç»“æœé›†ä¸­çš„ä»»ä½•è¡Œä½¿ç”¨æ’ä»–é”æˆ–å…±äº«é”ï¼Œå¦åˆ™ç”³è¯·ä¼šé˜»å¡ã€‚</p><h5 id="æ‚²è§‚é”å’Œä¹è§‚é”æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"><a href="#æ‚²è§‚é”å’Œä¹è§‚é”æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ" class="headerlink" title="æ‚²è§‚é”å’Œä¹è§‚é”æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"></a>æ‚²è§‚é”å’Œä¹è§‚é”æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h5><p>é¡¾åæ€ä¹‰ï¼Œå°±æ˜¯å¾ˆæ‚²è§‚ï¼Œæ¯æ¬¡å»æ‹¿æ•°æ®çš„æ—¶å€™éƒ½è®¤ä¸ºåˆ«äººä¼šä¿®æ”¹ï¼Œæ‰€ä»¥æ¯æ¬¡åœ¨æ‹¿æ•°æ®çš„æ—¶å€™éƒ½ä¼šä¸Šé”ï¼Œè¿™æ ·åˆ«äººæƒ³æ‹¿è¿™ä¸ªæ•°æ®å°±ä¼š block ç›´åˆ°å®ƒæ‹¿åˆ°é”ã€‚æ­£å› ä¸ºå¦‚æ­¤ï¼Œæ‚²è§‚é”éœ€è¦è€—è´¹è¾ƒå¤šçš„æ—¶é—´ï¼Œå¦å¤–ä¸ä¹è§‚é”ç›¸å¯¹åº”çš„ï¼Œæ‚²è§‚é”æ˜¯ç”±æ•°æ®åº“è‡ªå·±å®ç°äº†çš„ï¼Œè¦ç”¨çš„æ—¶å€™ï¼Œæˆ‘ä»¬ç›´æ¥è°ƒç”¨æ•°æ®åº“çš„ç›¸å…³è¯­å¥å°±å¯ä»¥äº†ã€‚</p><p>è¯´åˆ°è¿™é‡Œï¼Œç”±æ‚²è§‚é”æ¶‰åŠåˆ°çš„å¦å¤–ä¸¤ä¸ªé”æ¦‚å¿µå°±å‡ºæ¥äº†ï¼Œå®ƒä»¬å°±æ˜¯å…±äº«é”ä¸æ’å®ƒé”ã€‚å…±äº«é”å’Œæ’å®ƒé”æ˜¯æ‚²è§‚é”çš„ä¸åŒçš„å®ç°ï¼Œå®ƒä¿©éƒ½å±äºæ‚²è§‚é”çš„èŒƒç•´ã€‚</p><p>ä¹è§‚é”æ˜¯ç”¨æ•°æ®ç‰ˆæœ¬ï¼ˆVersionï¼‰è®°å½•æœºåˆ¶å®ç°ï¼Œè¿™æ˜¯ä¹è§‚é”æœ€å¸¸ç”¨çš„ä¸€ç§å®ç°æ–¹å¼ã€‚ä½•è°“æ•°æ®ç‰ˆæœ¬ï¼Ÿå³ä¸ºæ•°æ®å¢åŠ ä¸€ä¸ªç‰ˆæœ¬æ ‡è¯†ï¼Œä¸€èˆ¬æ˜¯é€šè¿‡ä¸ºæ•°æ®åº“è¡¨å¢åŠ ä¸€ä¸ªæ•°å­—ç±»å‹çš„ version å­—æ®µæ¥å®ç°ã€‚å½“è¯»å–æ•°æ®æ—¶ï¼Œå°† version å­—æ®µçš„å€¼ä¸€åŒè¯»å‡ºï¼Œæ•°æ®æ¯æ›´æ–°ä¸€æ¬¡ï¼Œå¯¹æ­¤ version å€¼åŠ  1ã€‚å½“æˆ‘ä»¬æäº¤æ›´æ–°çš„æ—¶å€™ï¼Œåˆ¤æ–­æ•°æ®åº“è¡¨å¯¹åº”è®°å½•çš„å½“å‰ç‰ˆæœ¬ä¿¡æ¯ä¸ç¬¬ä¸€æ¬¡å–å‡ºæ¥çš„versionå€¼è¿›è¡Œæ¯”å¯¹ï¼Œå¦‚æœæ•°æ®åº“è¡¨å½“å‰ç‰ˆæœ¬å·ä¸ç¬¬ä¸€æ¬¡å–å‡ºæ¥çš„ version å€¼ç›¸ç­‰ï¼Œåˆ™äºˆä»¥æ›´æ–°ï¼Œå¦åˆ™è®¤ä¸ºæ˜¯è¿‡æœŸæ•°æ®ã€‚</p><p>æ¯”å¦‚ï¼š</p><p>1ã€æ•°æ®åº“è¡¨ä¸‰ä¸ªå­—æ®µï¼Œåˆ†åˆ«æ˜¯<code>idã€valueã€version</code> <code>select id,value,version from t where id=#&#123;id&#125; </code></p><p>2ã€æ¯æ¬¡æ›´æ–°è¡¨ä¸­çš„valueå­—æ®µæ—¶ï¼Œä¸ºäº†é˜²æ­¢å‘ç”Ÿå†²çªï¼Œéœ€è¦è¿™æ ·æ“ä½œ</p><p><code>update t set value=2,version=version+1 where id=#&#123;id&#125; and version=#&#123;version&#125;</code></p><h5 id="ä¹è§‚é”æœ‰ä»€ä¹ˆä¼˜ç‚¹å’Œç¼ºç‚¹ï¼Ÿ"><a href="#ä¹è§‚é”æœ‰ä»€ä¹ˆä¼˜ç‚¹å’Œç¼ºç‚¹ï¼Ÿ" class="headerlink" title="ä¹è§‚é”æœ‰ä»€ä¹ˆä¼˜ç‚¹å’Œç¼ºç‚¹ï¼Ÿ"></a>ä¹è§‚é”æœ‰ä»€ä¹ˆä¼˜ç‚¹å’Œç¼ºç‚¹ï¼Ÿ</h5><p>å› ä¸ºæ²¡æœ‰åŠ é”æ‰€ä»¥ä¹è§‚é”çš„ä¼˜ç‚¹å°±æ˜¯æ‰§è¡Œæ€§èƒ½é«˜ã€‚å®ƒçš„ç¼ºç‚¹å°±æ˜¯æœ‰å¯èƒ½äº§ç”Ÿ ABA çš„é—®é¢˜ï¼ŒABA é—®é¢˜æŒ‡çš„æ˜¯æœ‰ä¸€ä¸ªå˜é‡ V åˆæ¬¡è¯»å–çš„æ—¶å€™æ˜¯ A å€¼ï¼Œå¹¶ä¸”åœ¨å‡†å¤‡èµ‹å€¼çš„æ—¶å€™æ£€æŸ¥åˆ°å®ƒä»ç„¶æ˜¯ A å€¼ï¼Œä¼šè¯¯ä»¥ä¸ºæ²¡æœ‰è¢«ä¿®æ”¹ä¼šæ­£å¸¸çš„æ‰§è¡Œä¿®æ”¹æ“ä½œï¼Œå®é™…ä¸Šè¿™æ®µæ—¶é—´å®ƒçš„å€¼å¯èƒ½è¢«æ”¹äº†å…¶ä»–å€¼ï¼Œä¹‹ååˆæ”¹å›ä¸º A å€¼ï¼Œè¿™ä¸ªé—®é¢˜è¢«ç§°ä¸º ABA é—®é¢˜ã€‚</p><h5 id="ä¼˜åŒ–é”æ–¹é¢ä½ æœ‰ä»€ä¹ˆå»ºè®®ï¼Ÿ"><a href="#ä¼˜åŒ–é”æ–¹é¢ä½ æœ‰ä»€ä¹ˆå»ºè®®ï¼Ÿ" class="headerlink" title="ä¼˜åŒ–é”æ–¹é¢ä½ æœ‰ä»€ä¹ˆå»ºè®®ï¼Ÿ"></a>ä¼˜åŒ–é”æ–¹é¢ä½ æœ‰ä»€ä¹ˆå»ºè®®ï¼Ÿ</h5><ul><li><p>å°½é‡ä½¿ç”¨è¾ƒä½çš„éš”ç¦»çº§åˆ«ã€‚</p></li><li><p>ç²¾å¿ƒè®¾è®¡ç´¢å¼•ï¼Œ å¹¶å°½é‡ä½¿ç”¨ç´¢å¼•è®¿é—®æ•°æ®ï¼Œ ä½¿åŠ é”æ›´ç²¾ç¡®ï¼Œ ä»è€Œå‡å°‘é”å†²çªçš„æœºä¼šã€‚</p></li><li><p>é€‰æ‹©åˆç†çš„äº‹åŠ¡å¤§å°ï¼Œå°äº‹åŠ¡å‘ç”Ÿé”å†²çªçš„å‡ ç‡ä¹Ÿæ›´å°ã€‚</p></li><li><p>ç»™è®°å½•é›†æ˜¾ç¤ºåŠ é”æ—¶ï¼Œæœ€å¥½ä¸€æ¬¡æ€§è¯·æ±‚è¶³å¤Ÿçº§åˆ«çš„é”ã€‚æ¯”å¦‚è¦ä¿®æ”¹æ•°æ®çš„è¯ï¼Œæœ€å¥½ç›´æ¥ç”³è¯·æ’ä»–é”ï¼Œè€Œä¸æ˜¯å…ˆç”³è¯·å…±äº«é”ï¼Œä¿®æ”¹æ—¶å†è¯·æ±‚æ’ä»–é”ï¼Œè¿™æ ·å®¹æ˜“äº§ç”Ÿæ­»é”ã€‚</p></li><li><p>ä¸åŒçš„ç¨‹åºè®¿é—®ä¸€ç»„è¡¨æ—¶ï¼Œåº”å°½é‡çº¦å®šä»¥ç›¸åŒçš„é¡ºåºè®¿é—®å„è¡¨ï¼Œå¯¹ä¸€ä¸ªè¡¨è€Œè¨€ï¼Œå°½å¯èƒ½ä»¥å›ºå®šçš„é¡ºåºå­˜å–è¡¨ä¸­çš„è¡Œã€‚è¿™æ ·å¯ä»¥å¤§å¤§å‡å°‘æ­»é”çš„æœºä¼šã€‚</p></li><li><p>å°½é‡ç”¨ç›¸ç­‰æ¡ä»¶è®¿é—®æ•°æ®ï¼Œè¿™æ ·å¯ä»¥é¿å…é—´éš™é”å¯¹å¹¶å‘æ’å…¥çš„å½±å“ã€‚</p></li><li><p>ä¸è¦ç”³è¯·è¶…è¿‡å®é™…éœ€è¦çš„é”çº§åˆ«ã€‚</p></li><li><p>é™¤éå¿…é¡»ï¼ŒæŸ¥è¯¢æ—¶ä¸è¦æ˜¾ç¤ºåŠ é”ã€‚ MySQL çš„ MVCC å¯ä»¥å®ç°äº‹åŠ¡ä¸­çš„æŸ¥è¯¢ä¸ç”¨åŠ é”ï¼Œä¼˜åŒ–äº‹åŠ¡æ€§èƒ½ï¼›MVCC åªåœ¨ COMMITTED READï¼ˆè¯»æäº¤ï¼‰å’Œ REPEATABLE READï¼ˆå¯é‡å¤è¯»ï¼‰ä¸¤ç§éš”ç¦»çº§åˆ«ä¸‹å·¥ä½œã€‚</p></li><li><p>å¯¹äºä¸€äº›ç‰¹å®šçš„äº‹åŠ¡ï¼Œå¯ä»¥ä½¿ç”¨è¡¨é”æ¥æé«˜å¤„ç†é€Ÿåº¦æˆ–å‡å°‘æ­»é”çš„å¯èƒ½ã€‚</p></li></ul><h5 id="ä»€ä¹ˆæ˜¯æ­»é”ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯æ­»é”ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯æ­»é”ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯æ­»é”ï¼Ÿ</h5><p>æ˜¯æŒ‡ä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šçš„è¿›ç¨‹åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå› äº‰å¤ºèµ„æºè€Œé€ æˆçš„ä¸€ç§äº’ç›¸ç­‰å¾…çš„ç°è±¡,è‹¥æ— å¤–åŠ›ä½œç”¨,å®ƒä»¬éƒ½å°†æ— æ³•æ¨è¿›ä¸‹å»ã€‚æ­¤æ—¶ç§°ç³»ç»Ÿå¤„äºæ­»é”çŠ¶æ€æˆ–ç³»ç»Ÿäº§ç”Ÿäº†æ­»é”ï¼Œè¿™äº›æ°¸è¿œåœ¨äº’ç›¸ç­‰å¾…çš„è¿‡ç¨‹ç§°ä¸ºæ­»é”ã€‚</p><p>æ­»é”æ˜¯æŒ‡ä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šçš„è¿›ç¨‹åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå› äº‰å¤ºèµ„æºè€Œé€ æˆçš„ä¸€ç§äº’ç›¸ç­‰å¾…çš„ç°è±¡,è‹¥æ— å¤–åŠ›ä½œç”¨,å®ƒä»¬éƒ½å°†æ— æ³•æ¨è¿›ä¸‹å»ã€‚æ­¤æ—¶ç§°ç³»ç»Ÿå¤„äºæ­»é”çŠ¶æ€æˆ–ç³»ç»Ÿäº§ç”Ÿäº†æ­»é”ï¼Œè¿™äº›æ°¸è¿œåœ¨äº’ç›¸ç­‰å¾…çš„è¿‡ç¨‹ç§°ä¸ºæ­»é”ã€‚</p><h5 id="å¸¸è§çš„æ­»é”æ¡ˆä¾‹æœ‰å“ªäº›ï¼Ÿ"><a href="#å¸¸è§çš„æ­»é”æ¡ˆä¾‹æœ‰å“ªäº›ï¼Ÿ" class="headerlink" title="å¸¸è§çš„æ­»é”æ¡ˆä¾‹æœ‰å“ªäº›ï¼Ÿ"></a>å¸¸è§çš„æ­»é”æ¡ˆä¾‹æœ‰å“ªäº›ï¼Ÿ</h5><ul><li><p>å°†æŠ•èµ„çš„é’±æ‹†å°å‡ ä»½å€Ÿç»™å€Ÿæ¬¾äººï¼Œè¿™æ—¶å¤„ç†ä¸šåŠ¡é€»è¾‘å°±è¦æŠŠè‹¥å¹²ä¸ªå€Ÿæ¬¾äººä¸€èµ·é”ä½<code> select * from xxx where id in (xx,xx,xx) for update</code>ã€‚</p></li><li><p>æ‰¹é‡å…¥åº“ï¼Œå­˜åœ¨åˆ™æ›´æ–°ï¼Œä¸å­˜åœ¨åˆ™æ’å…¥ã€‚è§£å†³æ–¹æ³•<code> insert into tab(xx,xx) on duplicate key update xx=&#39;xx&#39;</code>ã€‚</p></li></ul><h5 id="å¦‚ä½•å¤„ç†æ­»é”ï¼Ÿ"><a href="#å¦‚ä½•å¤„ç†æ­»é”ï¼Ÿ" class="headerlink" title="å¦‚ä½•å¤„ç†æ­»é”ï¼Ÿ"></a>å¦‚ä½•å¤„ç†æ­»é”ï¼Ÿ</h5><p>å¯¹å¾…æ­»é”å¸¸è§çš„ä¸¤ç§ç­–ç•¥ï¼š</p><ul><li><p>é€šè¿‡<code> innodblockwait_timeout</code> æ¥è®¾ç½®è¶…æ—¶æ—¶é—´ï¼Œä¸€ç›´ç­‰å¾…ç›´åˆ°è¶…æ—¶ï¼›</p></li><li><p>å‘èµ·æ­»é”æ£€æµ‹ï¼Œå‘ç°æ­»é”ä¹‹åï¼Œä¸»åŠ¨å›æ»šæ­»é”ä¸­çš„æŸä¸€ä¸ªäº‹åŠ¡ï¼Œè®©å…¶å®ƒäº‹åŠ¡ç»§ç»­æ‰§è¡Œã€‚</p></li></ul><h5 id="å¦‚ä½•æŸ¥çœ‹æ­»é”ï¼Ÿ"><a href="#å¦‚ä½•æŸ¥çœ‹æ­»é”ï¼Ÿ" class="headerlink" title="å¦‚ä½•æŸ¥çœ‹æ­»é”ï¼Ÿ"></a>å¦‚ä½•æŸ¥çœ‹æ­»é”ï¼Ÿ</h5><ul><li><p>ä½¿ç”¨å‘½ä»¤ show engine innodb status æŸ¥çœ‹æœ€è¿‘çš„ä¸€æ¬¡æ­»é”ã€‚</p></li><li><p>InnoDB Lock Monitor æ‰“å¼€é”ç›‘æ§ï¼Œæ¯ 15s è¾“å‡ºä¸€æ¬¡æ—¥å¿—ã€‚ä½¿ç”¨å®Œæ¯•åå»ºè®®å…³é—­ï¼Œå¦åˆ™ä¼šå½±å“æ•°æ®åº“æ€§èƒ½ã€‚</p></li></ul><h5 id="å¦‚ä½•é¿å…æ­»é”ï¼Ÿ"><a href="#å¦‚ä½•é¿å…æ­»é”ï¼Ÿ" class="headerlink" title="å¦‚ä½•é¿å…æ­»é”ï¼Ÿ"></a>å¦‚ä½•é¿å…æ­»é”ï¼Ÿ</h5><ul><li><p>ä¸ºäº†åœ¨å•ä¸ª InnoDB è¡¨ä¸Šæ‰§è¡Œå¤šä¸ªå¹¶å‘å†™å…¥æ“ä½œæ—¶é¿å…æ­»é”ï¼Œå¯ä»¥åœ¨äº‹åŠ¡å¼€å§‹æ—¶é€šè¿‡ä¸ºé¢„æœŸè¦ä¿®æ”¹çš„æ¯ä¸ªå…ƒç¥–ï¼ˆè¡Œï¼‰ä½¿ç”¨ SELECT â€¦ FOR UPDATE è¯­å¥æ¥è·å–å¿…è¦çš„é”ï¼Œå³ä½¿è¿™äº›è¡Œçš„æ›´æ”¹è¯­å¥æ˜¯åœ¨ä¹‹åæ‰æ‰§è¡Œçš„ã€‚</p></li><li><p>åœ¨äº‹åŠ¡ä¸­ï¼Œå¦‚æœè¦æ›´æ–°è®°å½•ï¼Œåº”è¯¥ç›´æ¥ç”³è¯·è¶³å¤Ÿçº§åˆ«çš„é”ï¼Œå³æ’ä»–é”ï¼Œè€Œä¸åº”å…ˆç”³è¯·å…±äº«é”ã€æ›´æ–°æ—¶å†ç”³è¯·æ’ä»–é”ï¼Œå› ä¸ºè¿™æ—¶å€™å½“ç”¨æˆ·å†ç”³è¯·æ’ä»–é”æ—¶ï¼Œå…¶ä»–äº‹åŠ¡å¯èƒ½åˆå·²ç»è·å¾—äº†ç›¸åŒè®°å½•çš„å…±äº«é”ï¼Œä»è€Œé€ æˆé”å†²çªï¼Œç”šè‡³æ­»é”</p></li><li><p>å¦‚æœäº‹åŠ¡éœ€è¦ä¿®æ”¹æˆ–é”å®šå¤šä¸ªè¡¨ï¼Œåˆ™åº”åœ¨æ¯ä¸ªäº‹åŠ¡ä¸­ä»¥ç›¸åŒçš„é¡ºåºä½¿ç”¨åŠ é”è¯­å¥ã€‚åœ¨åº”ç”¨ä¸­ï¼Œå¦‚æœä¸åŒçš„ç¨‹åºä¼šå¹¶å‘å­˜å–å¤šä¸ªè¡¨ï¼Œåº”å°½é‡çº¦å®šä»¥ç›¸åŒçš„é¡ºåºæ¥è®¿é—®è¡¨ï¼Œè¿™æ ·å¯ä»¥å¤§å¤§é™ä½äº§ç”Ÿæ­»é”çš„æœºä¼š</p></li><li><p>é€šè¿‡ <code>SELECT â€¦ LOCK IN SHARE MODE </code>è·å–è¡Œçš„è¯»é”åï¼Œå¦‚æœå½“å‰äº‹åŠ¡å†éœ€è¦å¯¹è¯¥è®°å½•è¿›è¡Œæ›´æ–°æ“ä½œï¼Œåˆ™å¾ˆæœ‰å¯èƒ½é€ æˆæ­»é”ã€‚</p></li><li><p>æ”¹å˜äº‹åŠ¡éš”ç¦»çº§åˆ«ã€‚</p></li></ul><h5 id="InnoDB-é»˜è®¤æ˜¯å¦‚ä½•å¯¹å¾…æ­»é”çš„ï¼Ÿ"><a href="#InnoDB-é»˜è®¤æ˜¯å¦‚ä½•å¯¹å¾…æ­»é”çš„ï¼Ÿ" class="headerlink" title="InnoDB é»˜è®¤æ˜¯å¦‚ä½•å¯¹å¾…æ­»é”çš„ï¼Ÿ"></a>InnoDB é»˜è®¤æ˜¯å¦‚ä½•å¯¹å¾…æ­»é”çš„ï¼Ÿ</h5><p>InnoDB é»˜è®¤æ˜¯ä½¿ç”¨è®¾ç½®æ­»é”æ—¶é—´æ¥è®©æ­»é”è¶…æ—¶çš„ç­–ç•¥ï¼Œé»˜è®¤ innodblockwait_timeout è®¾ç½®çš„æ—¶é•¿æ˜¯ 50sã€‚</p><h5 id="å¦‚ä½•å¼€å¯æ­»é”æ£€æµ‹ï¼Ÿ"><a href="#å¦‚ä½•å¼€å¯æ­»é”æ£€æµ‹ï¼Ÿ" class="headerlink" title="å¦‚ä½•å¼€å¯æ­»é”æ£€æµ‹ï¼Ÿ"></a>å¦‚ä½•å¼€å¯æ­»é”æ£€æµ‹ï¼Ÿ</h5><p>è®¾ç½® <code>innodbdeadlockdetect </code>è®¾ç½®ä¸º on å¯ä»¥ä¸»åŠ¨æ£€æµ‹æ­»é”ï¼Œåœ¨ Innodb ä¸­è¿™ä¸ªå€¼é»˜è®¤å°±æ˜¯ on å¼€å¯çš„çŠ¶æ€ã€‚</p><h3 id="MySQLåˆ†åº“åˆ†è¡¨åŸç†åŠå®è·µ"><a href="#MySQLåˆ†åº“åˆ†è¡¨åŸç†åŠå®è·µ" class="headerlink" title="MySQLåˆ†åº“åˆ†è¡¨åŸç†åŠå®è·µ"></a>MySQLåˆ†åº“åˆ†è¡¨åŸç†åŠå®è·µ</h3><h4 id="MyCat"><a href="#MyCat" class="headerlink" title="MyCat"></a>MyCat</h4><p><img src="/images/mysql/mycat.png"></p><h5 id="æ ¸å¿ƒæ¦‚å¿µ"><a href="#æ ¸å¿ƒæ¦‚å¿µ" class="headerlink" title="æ ¸å¿ƒæ¦‚å¿µ"></a>æ ¸å¿ƒæ¦‚å¿µ</h5><ul><li>Schemaï¼šç”±å®ƒæŒ‡å®šé€»è¾‘æ•°æ®åº“ï¼ˆç›¸å½“äºMySQLçš„datebaseæ•°æ®åº“ï¼‰</li><li>Tableï¼šé€»è¾‘è¡¨ï¼ˆç›¸å½“äºMySQLçš„tableè¡¨ï¼‰</li><li>DataNodeï¼šçœŸæ­£å­˜å‚¨æ•°æ®çš„ç‰©ç†èŠ‚ç‚¹</li><li>DateHostï¼šå­˜å‚¨èŠ‚ç‚¹æ‰€åœ¨çš„æ•°æ®åº“ä¸»æœºï¼ˆæŒ‡å®šMySQLæ•°æ®åº“çš„è¿æ¥ä¿¡æ¯ï¼‰</li><li>Userï¼šMyCatç”¨æˆ·ï¼ˆç±»ä¼¼äºMySQLçš„ç”¨æˆ·ï¼Œæ”¯æŒå¤šç”¨æˆ·ï¼‰</li></ul><h5 id="ä¸»è¦è§£å†³é—®é¢˜"><a href="#ä¸»è¦è§£å†³é—®é¢˜" class="headerlink" title="ä¸»è¦è§£å†³é—®é¢˜"></a>ä¸»è¦è§£å†³é—®é¢˜</h5><ul><li>æµ·é‡æ•°æ®å­˜å‚¨</li><li>æŸ¥è¯¢ä¼˜åŒ–</li></ul><h5 id="æ”¯æŒæ•°æ®åº“"><a href="#æ”¯æŒæ•°æ®åº“" class="headerlink" title="æ”¯æŒæ•°æ®åº“"></a>æ”¯æŒæ•°æ®åº“</h5><p><img src="/images/mysql/catdb.png"></p><h5 id="åˆ†ç‰‡ç­–ç•¥"><a href="#åˆ†ç‰‡ç­–ç•¥" class="headerlink" title="åˆ†ç‰‡ç­–ç•¥"></a>åˆ†ç‰‡ç­–ç•¥</h5><p>MyCATæ”¯æŒæ°´å¹³åˆ†ç‰‡è¯­å‚ç›´åˆ†ç‰‡ï¼š</p><ul><li>æ°´å¹³åˆ†ç‰‡ï¼šä¸€ä¸ªè¡¨æ ¼çš„æ•°æ®åˆ†å‰²åˆ°å¤šä¸ªèŠ‚ç‚¹ä¸Šï¼ŒæŒ‰ç…§è¡Œåˆ†å‰²ã€‚</li><li>å‚ç›´åˆ†ç‰‡ï¼šä¸€ä¸ªæ•°æ®åº“ä¸­å¤šä¸ªè¡¨A,B,Cï¼ŒAå­˜å‚¨åˆ°èŠ‚ç‚¹1ï¼ŒBå­˜å‚¨åˆ°èŠ‚ç‚¹2ï¼ŒCå­˜å‚¨åˆ°èŠ‚ç‚¹3ã€‚</li></ul><p><img src="/images/mysql/catdate.png"></p><p><img src="/images/mysql/catdate2.png"></p><p>MyCATé€šè¿‡å®šä¹‰è¡¨çš„åˆ†ç‰‡è§„åˆ™æ¥å®ç°åˆ†ç‰‡ï¼Œæ²¡ä¸ªè¡¨æ ¼å¯ä»¥æ†ç»‘ä¸€ä¸ªåˆ†ç‰‡è§„åˆ™ï¼Œæ¯ä¸ªåˆ†ç‰‡è§„åˆ™åˆ¶å®šä¸€ä¸ªåˆ†ç‰‡å­—æ®µå¹¶ç»‘å®šä¸€ä¸ªå‡½æ•°ï¼Œæ¥å®ç°åŠ¨æ€åˆ†ç‰‡ç®—æ³•ã€‚</p><ul><li>Schemaï¼šé€»è¾‘åº“ï¼Œä¸MySQLçš„datebaseæ•°æ®å¯¹åº”ï¼Œä¸€ä¸ªé€»è¾‘åº“ä¸­å®šä¹‰äº†æ‰€æœ‰åŒ…æ‹¬çš„Tableã€‚</li><li>Tableï¼šè¡¨ï¼Œå³ç‰©ç†æ•°æ®åº“ä¸­å­˜å‚¨çš„æŸå¼ è¡¨ï¼Œä¸ä¼ ç»Ÿæ•°æ®åº“ä¸åŒï¼Œè¿™é‡Œçš„è¡¨æ ¼éœ€è¦å£°æ˜å…¶æ‰€å­˜å‚¨çš„é€»è¾‘æ•°æ®èŠ‚ç‚¹DataNodeã€‚<strong>å¯ä»¥æŒ‡å®šè¡¨çš„åˆ†ç‰‡è§„åˆ™</strong></li><li>DataNodeï¼šMyCATçš„é€»è¾‘æ•°æ®èŠ‚ç‚¹ï¼Œæ˜¯å­˜æ”¾Tableçš„å…·ä½“ç‰©ç†èŠ‚ç‚¹ï¼Œä¹Ÿç§°ä¹‹ä¸ºåˆ†ç‰‡èŠ‚ç‚¹ï¼Œé€šè¿‡DateHostæ¥å…³è”åˆ°åæ®µæŸä¸ªå…·ä½“æ•°æ®åº“ä¸Šã€‚</li><li>DateHostï¼šå®šä¹‰æŸä¸ªç‰©ç†åº“çš„è®¿é—®åœ°å€ï¼Œç”¨äºæ†ç»‘åˆ°DataNodeä¸Šã€‚</li></ul><h5 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h5><pre><code class="hljs zsh"><span class="hljs-comment"># ä¸‹è½½</span>wget http://dl.mycat.org.cn/1.6.7.4/Mycat-server-1.6.7.4-release/Mycat-server-1.6.7.4-release-20200105164103-linux.tar.gz<span class="hljs-comment"># è§£å‹</span>tar -zxvf Mycat-server-1.6.7.4-release-20200105164103-linux.tar.gz /weitrue/install<span class="hljs-comment"># è¿›å…¥mycatç›®å½•</span><span class="hljs-built_in">cd</span> /weitrue/install/mycat<span class="hljs-comment"># å¯åŠ¨/å…³é—­  è¿›å…¥mycat/binä¸‹</span>./mycat start     <span class="hljs-comment"># å¯åŠ¨</span>./mycat stop      <span class="hljs-comment"># å…³é—­</span>./mycat restart   <span class="hljs-comment"># é‡å¯</span>./mycat status    <span class="hljs-comment"># çŠ¶æ€</span><span class="hljs-comment"># ä½¿ç”¨mysqlå®¢æˆ·ç«¯ç›´æ¥è¿æ¥mycatæœåŠ¡,é»˜è®¤ç«¯å£ã€8066ã€‘</span>mysql -uroot -p123456 -h127.0.0.1 -P8066</code></pre><h5 id="åˆ†ç‰‡è®¾ç½®"><a href="#åˆ†ç‰‡è®¾ç½®" class="headerlink" title="åˆ†ç‰‡è®¾ç½®"></a>åˆ†ç‰‡è®¾ç½®</h5><h6 id="é…ç½®schema-xmlæ–‡ä»¶"><a href="#é…ç½®schema-xmlæ–‡ä»¶" class="headerlink" title="é…ç½®schema.xmlæ–‡ä»¶"></a>é…ç½®schema.xmlæ–‡ä»¶</h6><p><code>schema.xml</code>æ˜¯Mycatä¸­é‡è¦çš„é…ç½®æ–‡ä»¶ä¹‹ä¸€ï¼Œä¸»è¦ç®¡ç†ç€MyCATçš„é€»è¾‘åº“ã€è¡¨ã€åˆ†ç‰‡è§„åˆ™ã€DataNodeä»¥åŠDateHostä¹‹é—´çš„æ˜ å°„å…³ç³»ã€‚</p><ul><li><code>&lt;schema&gt;</code>å®šä¹‰Mycatå®ä¾‹ä¸­çš„é€»è¾‘åº“ã€‚<ul><li><code>&lt;table&gt;</code>å®šä¹‰Mycatä¸­çš„é€»è¾‘è¡¨ã€‚</li></ul></li><li><code>&lt;dataNode&gt;</code>å®šä¹‰äº†Mycatçš„æ•°æ®èŠ‚ç‚¹ï¼Œå³æ•°æ®åˆ†ç‰‡ã€‚</li><li><code>&lt;dataHost&gt;</code>å®šä¹‰äº†å…·ä½“çš„æ•°æ®åº“å®ä¾‹ã€è¯»å†™åˆ†ç¦»é…ç½®å’Œå¿ƒè·³è¯­å¥ã€‚</li></ul><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot;?&gt;</span><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">mycat</span>:schema <span class="hljs-meta-keyword">SYSTEM</span> <span class="hljs-meta-string">&quot;schema.dtd&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">mycat:schema</span> <span class="hljs-attr">xmlns:mycat</span>=<span class="hljs-string">&quot;http://io.mycat/&quot;</span>&gt;</span><span class="hljs-comment">&lt;!-- </span><span class="hljs-comment">schema:é€»è¾‘åº“ nameï¼šé€»è¾‘åº“å sqlMaxLimit ä¸€æ¬¡å»å¤šå°‘æ¡æ•°æ®ï¼Œå¦‚æœè¶…è¿‡limit</span><span class="hljs-comment">              table é€»è¾‘è¡¨</span><span class="hljs-comment">                dataNode æ•°æ®èŠ‚ç‚¹ å¯¹åº” dataNodeæ ‡ç­¾å</span><span class="hljs-comment">                rule åˆ†ç‰‡è§„åˆ™ å¯¹åº”rule.xml</span><span class="hljs-comment">                subTableså­—è¡¨</span><span class="hljs-comment">                primaryKey åˆ†ç‰‡ä¸»é”® å¯ç¼“å­˜</span><span class="hljs-comment"> --&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">schema</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;TESTDB&quot;</span> <span class="hljs-attr">checkSQLschema</span>=<span class="hljs-string">&quot;false&quot;</span> <span class="hljs-attr">sqlMaxLimit</span>=<span class="hljs-string">&quot;100&quot;</span> <span class="hljs-attr">randomDataNode</span>=<span class="hljs-string">&quot;dn1&quot;</span>&gt;</span>                <span class="hljs-comment">&lt;!-- auto sharding by id (long) --&gt;</span>                <span class="hljs-comment">&lt;!--splitTableNames å¯ç”¨&lt;table name å±æ€§ä½¿ç”¨é€—å·åˆ†å‰²é…ç½®å¤šä¸ªè¡¨,å³å¤šä¸ªè¡¨ä½¿ç”¨è¿™ä¸ªé…ç½®--&gt;</span>                <span class="hljs-tag">&lt;<span class="hljs-name">table</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;item&quot;</span> <span class="hljs-attr">dataNode</span>=<span class="hljs-string">&quot;dn1,dn2,dn3&quot;</span> <span class="hljs-attr">rule</span>=<span class="hljs-string">&quot;mod-long&quot;</span> <span class="hljs-attr">primaryKey</span>=<span class="hljs-string">&quot;ID&quot;</span>/&gt;</span>                       <span class="hljs-tag">&lt;/<span class="hljs-name">schema</span>&gt;</span>          <span class="hljs-comment">&lt;!-- &lt;dataNode name=&quot;dn1$0-743&quot; dataHost=&quot;localhost1&quot; database=&quot;db$0-743&quot;/&gt; --&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">dataNode</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;dn1&quot;</span> <span class="hljs-attr">dataHost</span>=<span class="hljs-string">&quot;localhost1&quot;</span> <span class="hljs-attr">database</span>=<span class="hljs-string">&quot;db1&quot;</span> /&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">dataNode</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;dn2&quot;</span> <span class="hljs-attr">dataHost</span>=<span class="hljs-string">&quot;localhost1&quot;</span> <span class="hljs-attr">database</span>=<span class="hljs-string">&quot;db2&quot;</span> /&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">dataNode</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;dn3&quot;</span> <span class="hljs-attr">dataHost</span>=<span class="hljs-string">&quot;localhost1&quot;</span> <span class="hljs-attr">database</span>=<span class="hljs-string">&quot;db3&quot;</span> /&gt;</span><span class="hljs-comment">&lt;!-- </span><span class="hljs-comment">dataHost:æ•°æ®ä¸»æœº</span><span class="hljs-comment">            balance 1:è¯»å†™åˆ†ç¦» 0:è¯»å†™ä¸åˆ†ç¦»</span><span class="hljs-comment">            writeType 0:ç¬¬ä¸€ä¸ªwritrHostå†™ 1:éšæœºwritrHostå†™</span><span class="hljs-comment">            dbDriver æ•°æ®é©±åŠ¨ native: MySQL JDBC:Oracle SQLServer</span><span class="hljs-comment">            switchTypeæ˜¯å¦ä¸»åŠ¨è¯» 1:ä¸»ä»è‡ªåŠ¨åˆ‡æ¢ -1:ä¸åˆ‡æ¢ 2:å½“ä»æœºå»¶æ—¶è¶…è¿‡slaveThreshold(æ¯«ç§’çº§)å€¼æ—¶åˆ‡æ¢ä¸ºä¸»è¯»</span><span class="hljs-comment"> --&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">dataHost</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;localhost1&quot;</span> <span class="hljs-attr">maxCon</span>=<span class="hljs-string">&quot;1000&quot;</span> <span class="hljs-attr">minCon</span>=<span class="hljs-string">&quot;10&quot;</span> <span class="hljs-attr">balance</span>=<span class="hljs-string">&quot;0&quot;</span></span><span class="hljs-tag">                          <span class="hljs-attr">writeType</span>=<span class="hljs-string">&quot;0&quot;</span> <span class="hljs-attr">dbType</span>=<span class="hljs-string">&quot;mysql&quot;</span> <span class="hljs-attr">dbDriver</span>=<span class="hljs-string">&quot;native&quot;</span> <span class="hljs-attr">switchType</span>=<span class="hljs-string">&quot;1&quot;</span>  <span class="hljs-attr">slaveThreshold</span>=<span class="hljs-string">&quot;100&quot;</span>&gt;</span>                <span class="hljs-tag">&lt;<span class="hljs-name">heartbeat</span>&gt;</span>select user()<span class="hljs-tag">&lt;/<span class="hljs-name">heartbeat</span>&gt;</span>                <span class="hljs-comment">&lt;!-- can have multi write hosts --&gt;</span>                <span class="hljs-tag">&lt;<span class="hljs-name">writeHost</span> <span class="hljs-attr">host</span>=<span class="hljs-string">&quot;hostM1&quot;</span> <span class="hljs-attr">url</span>=<span class="hljs-string">&quot;localhost:3306&quot;</span> <span class="hljs-attr">user</span>=<span class="hljs-string">&quot;root&quot;</span> <span class="hljs-attr">password</span>=<span class="hljs-string">&quot;123456&quot;</span>&gt;</span>                <span class="hljs-tag">&lt;/<span class="hljs-name">writeHost</span>&gt;</span>        <span class="hljs-tag">&lt;/<span class="hljs-name">dataHost</span>&gt;</span></code></pre><h6 id="rule-xml"><a href="#rule-xml" class="headerlink" title="rule.xml"></a><code>rule.xml</code></h6><p><code>rule.xml</code>å®šä¹‰æˆ‘ä»¬å¯¹è¡¨æ‹†åˆ†æ¶‰åŠåˆ°çš„è§„åˆ™å®šä¹‰ã€‚</p><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">mycat</span>:rule <span class="hljs-meta-keyword">SYSTEM</span> <span class="hljs-meta-string">&quot;rule.dtd&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">mycat:rule</span> <span class="hljs-attr">xmlns:mycat</span>=<span class="hljs-string">&quot;http://io.mycat/&quot;</span>&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">tableRule</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;mod-long&quot;</span>&gt;</span>                <span class="hljs-tag">&lt;<span class="hljs-name">rule</span>&gt;</span>                        <span class="hljs-tag">&lt;<span class="hljs-name">columns</span>&gt;</span>id<span class="hljs-tag">&lt;/<span class="hljs-name">columns</span>&gt;</span>                        <span class="hljs-tag">&lt;<span class="hljs-name">algorithm</span>&gt;</span>mod-long<span class="hljs-tag">&lt;/<span class="hljs-name">algorithm</span>&gt;</span>                <span class="hljs-tag">&lt;/<span class="hljs-name">rule</span>&gt;</span>        <span class="hljs-tag">&lt;/<span class="hljs-name">tableRule</span>&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">function</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;mod-long&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;io.mycat.route.function.PartitionByMod&quot;</span>&gt;</span>                <span class="hljs-comment">&lt;!-- how many data nodes --&gt;</span>                <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;count&quot;</span>&gt;</span>3<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>        <span class="hljs-tag">&lt;/<span class="hljs-name">function</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">mycat:rule</span>&gt;</span></code></pre><h6 id="server-xml"><a href="#server-xml" class="headerlink" title="server.xml"></a><code>server.xml</code></h6><pre><code class="hljs xml"></code></pre><h6 id="åå¤§åˆ†ç‰‡è§„åˆ™"><a href="#åå¤§åˆ†ç‰‡è§„åˆ™" class="headerlink" title="åå¤§åˆ†ç‰‡è§„åˆ™"></a>åå¤§åˆ†ç‰‡è§„åˆ™</h6><p><strong>è¿ç»­åˆ†ç‰‡</strong></p><ul><li>æ—¥æœŸåˆ†ç‰‡<ul><li>æŒ‰æœˆ</li><li>æŒ‰æ—¥</li><li>æŒ‰å°æ—¶</li></ul></li><li>èŒƒå›´çº¦å®šï¼šé…ç½®ç®€å•ï¼Œå³é¢„å…ˆåˆ¶å®šå¯èƒ½çš„idèŒƒå›´å¯¹åº”æŸä¸ªåˆ†ç‰‡<ul><li>ä¼˜åŠ¿ï¼šæ‰©å®¹æ— éœ€è¿ç§»æ•°æ®</li><li>ç¼ºç‚¹ï¼šçƒ­ç‚¹æ•°æ®ï¼Œå¹¶å‘å—é™</li></ul></li></ul><p><strong>ç¦»æ•£åˆ†ç‰‡</strong></p><ul><li>æšä¸¾æ³•</li><li>æ±‚æ¨¡æ³•</li><li>å­—ç¬¦ä¸²æ‹†åˆ†hashæ³•</li><li>å›ºå®šåˆ†ç‰‡hashæ³•</li><li>ä¸€è‡´æ€§å“ˆå¸Œï¼ˆè§£å†³æ‰©å®¹é—®é¢˜ï¼‰</li><li>ç¼–ç¨‹æŒ‡å®š</li></ul><p><strong>ç»¼åˆåˆ†ç‰‡</strong></p><ul><li>é€šé…å–æ¨¡</li><li>ASCiiç æ±‚æ¨¡é€šé…</li></ul><h5 id="è¯»å†™åˆ†ç¦»"><a href="#è¯»å†™åˆ†ç¦»" class="headerlink" title="è¯»å†™åˆ†ç¦»"></a>è¯»å†™åˆ†ç¦»</h5><p>å»ºç«‹åœ¨MySQLä¸»ä»å¤åˆ¶çš„åŸºç¡€ä¸Šå®ç°ï¼Œå¿…é¡»æ­å»ºMySQLçš„ä¸»ä»å¤åˆ¶ã€‚</p><p><img src="/images/mysql/mycatrw.png"></p><pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- &lt;dataNode name=&quot;dn1$0-743&quot; dataHost=&quot;localhost1&quot; database=&quot;db$0-743&quot;/&gt; --&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">dataNode</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;dn1&quot;</span> <span class="hljs-attr">dataHost</span>=<span class="hljs-string">&quot;localhost1&quot;</span> <span class="hljs-attr">database</span>=<span class="hljs-string">&quot;db1&quot;</span> /&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">dataNode</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;dn2&quot;</span> <span class="hljs-attr">dataHost</span>=<span class="hljs-string">&quot;localhost1&quot;</span> <span class="hljs-attr">database</span>=<span class="hljs-string">&quot;db2&quot;</span> /&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">dataNode</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;dn3&quot;</span> <span class="hljs-attr">dataHost</span>=<span class="hljs-string">&quot;localhost1&quot;</span> <span class="hljs-attr">database</span>=<span class="hljs-string">&quot;db3&quot;</span> /&gt;</span><span class="hljs-comment">&lt;!-- </span><span class="hljs-comment">dataHost:æ•°æ®ä¸»æœº</span><span class="hljs-comment">        balance 1:è¯»å†™åˆ†ç¦» 0:è¯»å†™ä¸åˆ†ç¦»</span><span class="hljs-comment">        writeType 0:ç¬¬ä¸€ä¸ªwritrHostå†™ 1:éšæœºwritrHostå†™</span><span class="hljs-comment">        dbDriver æ•°æ®é©±åŠ¨ native: MySQL JDBC:Oracle SQLServer</span><span class="hljs-comment">        switchTypeæ˜¯å¦ä¸»åŠ¨è¯» 1:ä¸»ä»è‡ªåŠ¨åˆ‡æ¢ -1:ä¸åˆ‡æ¢ 2:å½“ä»æœºå»¶æ—¶è¶…è¿‡slaveThreshold(æ¯«ç§’çº§)å€¼æ—¶åˆ‡æ¢ä¸ºä¸»è¯»</span><span class="hljs-comment">--&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">dataHost</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;localhost1&quot;</span> <span class="hljs-attr">maxCon</span>=<span class="hljs-string">&quot;1000&quot;</span> <span class="hljs-attr">minCon</span>=<span class="hljs-string">&quot;10&quot;</span> <span class="hljs-attr">balance</span>=<span class="hljs-string">&quot;1&quot;</span></span><span class="hljs-tag">                      <span class="hljs-attr">writeType</span>=<span class="hljs-string">&quot;0&quot;</span> <span class="hljs-attr">dbType</span>=<span class="hljs-string">&quot;mysql&quot;</span> <span class="hljs-attr">dbDriver</span>=<span class="hljs-string">&quot;native&quot;</span> <span class="hljs-attr">switchType</span>=<span class="hljs-string">&quot;2&quot;</span>  <span class="hljs-attr">slaveThreshold</span>=<span class="hljs-string">&quot;100&quot;</span>&gt;</span>            <span class="hljs-tag">&lt;<span class="hljs-name">heartbeat</span>&gt;</span>show slave status<span class="hljs-tag">&lt;/<span class="hljs-name">heartbeat</span>&gt;</span>            <span class="hljs-comment">&lt;!-- can have multi write hosts --&gt;</span>            <span class="hljs-tag">&lt;<span class="hljs-name">writeHost</span> <span class="hljs-attr">host</span>=<span class="hljs-string">&quot;hostM1&quot;</span> <span class="hljs-attr">url</span>=<span class="hljs-string">&quot;localhost:3306&quot;</span> <span class="hljs-attr">user</span>=<span class="hljs-string">&quot;root&quot;</span> <span class="hljs-attr">password</span>=<span class="hljs-string">&quot;123456&quot;</span>&gt;</span>            <span class="hljs-tag">&lt;/<span class="hljs-name">writeHost</span>&gt;</span>    <span class="hljs-tag">&lt;/<span class="hljs-name">dataHost</span>&gt;</span></code></pre><p><code>switchType=&quot;2&quot;</code>å’Œ<code>slaveThreshold=&quot;100&quot;</code>æ„å‘³ç€å¼€å¯MySQLä¸»ä»å¤åˆ¶çŠ¶æ€ç»‘å®šçš„è¯»å†™åˆ†ç¦»è¯­åˆ‡æ¢æœºåˆ¶ã€‚Mycatå¿ƒè·³æœºåˆ¶é€šè¿‡æ£€æµ‹<code>show slave status</code>ä¸­<code>&quot;Seconds_Behind_Master&quot; &quot;Slave_IO_Running&quot; &quot;Slave_SQL_Running&quot;</code>ä¸‰ä¸ªå­—æ®µæ¥ç¡®å®šå½“å‰ä¸»ä»çš„çŠ¶æ€ä»¥åŠ<code>Seconds_Behind_Master</code>ä¸»ä»å¤åˆ¶å»¶æ—¶ã€‚</p><h4 id="MySQLåˆ†åº“åˆ†è¡¨"><a href="#MySQLåˆ†åº“åˆ†è¡¨" class="headerlink" title="MySQLåˆ†åº“åˆ†è¡¨"></a>MySQLåˆ†åº“åˆ†è¡¨</h4><h5 id="æ•°æ®åˆ‡åˆ†æ–¹æ¡ˆ"><a href="#æ•°æ®åˆ‡åˆ†æ–¹æ¡ˆ" class="headerlink" title="æ•°æ®åˆ‡åˆ†æ–¹æ¡ˆ"></a>æ•°æ®åˆ‡åˆ†æ–¹æ¡ˆ</h5><ul><li>å‚ç›´åˆ‡åˆ†ï¼šæ ¹æ®ä¸šåŠ¡æ¨¡å—è¿›è¡Œåˆ‡åˆ†ï¼Œä¸åŒæ¨¡å—çš„è¡¨åˆ†åˆ°ä¸åŒçš„åº“ä¸­ã€‚</li><li>æ°´å¹³åˆ‡åˆ†ï¼šå°†ä¸€å¼ å¤§è¡¨æŒ‰ç…§ä¸€å®šåˆ‡åˆ†è§„åˆ™ï¼ŒæŒ‰ç…§<strong>è¡Œ</strong>åˆ‡åˆ†åˆ°ä¸åŒè¡¨æˆ–è€…ä¸åŒåº“ä¸­ã€‚</li></ul><h6 id="æ°´å¹³åˆ‡åˆ†åŸåˆ™"><a href="#æ°´å¹³åˆ‡åˆ†åŸåˆ™" class="headerlink" title="æ°´å¹³åˆ‡åˆ†åŸåˆ™"></a>æ°´å¹³åˆ‡åˆ†åŸåˆ™</h6><p>å¸¸ç”¨çš„ä¸»è¦åˆ†ä¸ºï¼š</p><ul><li>æŒ‰ç…§IDå–æ¨¡ï¼šå¯¹IDå–æ¨¡ï¼Œä½™æ•°å†³å®šæ”¹è¡Œæ•°æ®æ”¾åˆ°å“ªå¼ è¡¨æˆ–è€…å“ªä¸ªåº“ä¸­ã€‚</li><li>æŒ‰ç…§æ—¥æœŸï¼šæŒ‰ç…§å¹´æœˆæ—¥ï¼Œå°†æ•°æ®åˆ‡åˆ†åˆ°ä¸åŒçš„è¡¨æˆ–è€…åº“ä¸­ã€‚</li><li>æŒ‰ç…§èŒƒå›´ï¼šå¯ä»¥å¯¹æŸä¸€åˆ—æŒ‰ç…§èŒƒå›´è¿›è¡Œåˆ‡åˆ†ä¸åŒçš„èŒƒå›´åˆ‡åˆ†åˆ°ä¸åŒçš„è¡¨æˆ–è€…åº“ä¸­ã€‚</li></ul><h6 id="åˆ‡åˆ†åŸåˆ™"><a href="#åˆ‡åˆ†åŸåˆ™" class="headerlink" title="åˆ‡åˆ†åŸåˆ™"></a>åˆ‡åˆ†åŸåˆ™</h6><ul><li>ç¬¬ä¸€åŸåˆ™ï¼šèƒ½ä¸åˆ‡åˆ†å°½é‡ä¸è¦åˆ‡åˆ†</li><li>ç¬¬äºŒåŸåˆ™ï¼šå¦‚æœè¦åˆ‡åˆ†ä¸€å®šè¦é€‰æ‹©åˆé€‚çš„è§„åˆ™ï¼Œæå‰è§„åˆ’å¥½</li><li>ç¬¬ä¸‰åŸåˆ™ï¼šæ•°æ®åˆ‡åˆ†å°½é‡é€šè¿‡æ•°æ®å†—ä½™æˆ–è€…è¡¨åˆ†ç»„æ¥<strong>é™ä½è·¨åº“join</strong>çš„å¯èƒ½</li><li>ç¬¬å››åŸåˆ™ï¼šç”±äºæ•°æ®åº“ä¸­é—´ä»¶å¯¹æ•°æ®joinå®ç°çš„ä¼˜åŠ£éš¾ä»¥æŠŠæ¡ï¼Œè€Œä¸”å®ç°é«˜æ€§èƒ½éš¾åº¦æå¤§ï¼Œä¸šåŠ¡è¯»å–å°½é‡å°‘ä½¿ç”¨å¤šè¡¨join</li></ul><h5 id="åˆ†åº“åˆ†è¡¨éœ€è¦è§£å†³é—®é¢˜"><a href="#åˆ†åº“åˆ†è¡¨éœ€è¦è§£å†³é—®é¢˜" class="headerlink" title="åˆ†åº“åˆ†è¡¨éœ€è¦è§£å†³é—®é¢˜"></a>åˆ†åº“åˆ†è¡¨éœ€è¦è§£å†³é—®é¢˜</h5><h6 id="åˆ†å¸ƒå¼äº‹åŠ¡é—®é¢˜"><a href="#åˆ†å¸ƒå¼äº‹åŠ¡é—®é¢˜" class="headerlink" title="åˆ†å¸ƒå¼äº‹åŠ¡é—®é¢˜"></a>åˆ†å¸ƒå¼äº‹åŠ¡é—®é¢˜</h6><h6 id="åˆ†å¸ƒå¼ä¸»é”®IDé—®é¢˜"><a href="#åˆ†å¸ƒå¼ä¸»é”®IDé—®é¢˜" class="headerlink" title="åˆ†å¸ƒå¼ä¸»é”®IDé—®é¢˜"></a>åˆ†å¸ƒå¼ä¸»é”®IDé—®é¢˜</h6><h6 id="è·¨åº“joiné—®é¢˜"><a href="#è·¨åº“joiné—®é¢˜" class="headerlink" title="è·¨åº“joiné—®é¢˜"></a>è·¨åº“joiné—®é¢˜</h6><h6 id="è·¨åº“countã€groupã€orderbyé—®é¢˜"><a href="#è·¨åº“countã€groupã€orderbyé—®é¢˜" class="headerlink" title="è·¨åº“countã€groupã€orderbyé—®é¢˜"></a>è·¨åº“countã€groupã€orderbyé—®é¢˜</h6><h3 id="é¢è¯•é¢˜"><a href="#é¢è¯•é¢˜" class="headerlink" title="é¢è¯•é¢˜"></a>é¢è¯•é¢˜</h3><h4 id="åŸºç¡€æ¨¡å—"><a href="#åŸºç¡€æ¨¡å—" class="headerlink" title="åŸºç¡€æ¨¡å—"></a>åŸºç¡€æ¨¡å—</h4><h5 id="è¯´ä¸€ä¸‹-MySQL-æ‰§è¡Œä¸€æ¡æŸ¥è¯¢è¯­å¥çš„å†…éƒ¨æ‰§è¡Œè¿‡ç¨‹ï¼Ÿ"><a href="#è¯´ä¸€ä¸‹-MySQL-æ‰§è¡Œä¸€æ¡æŸ¥è¯¢è¯­å¥çš„å†…éƒ¨æ‰§è¡Œè¿‡ç¨‹ï¼Ÿ" class="headerlink" title="è¯´ä¸€ä¸‹ MySQL æ‰§è¡Œä¸€æ¡æŸ¥è¯¢è¯­å¥çš„å†…éƒ¨æ‰§è¡Œè¿‡ç¨‹ï¼Ÿ"></a>è¯´ä¸€ä¸‹ MySQL æ‰§è¡Œä¸€æ¡æŸ¥è¯¢è¯­å¥çš„å†…éƒ¨æ‰§è¡Œè¿‡ç¨‹ï¼Ÿ</h5><ul><li><p>å®¢æˆ·ç«¯å…ˆé€šè¿‡è¿æ¥å™¨è¿æ¥åˆ° MySQL æœåŠ¡å™¨ã€‚</p></li><li><p>è¿æ¥å™¨æƒé™éªŒè¯é€šè¿‡ä¹‹åï¼Œå…ˆæŸ¥è¯¢æ˜¯å¦æœ‰æŸ¥è¯¢ç¼“å­˜ï¼Œå¦‚æœæœ‰ç¼“å­˜ï¼ˆä¹‹å‰æ‰§è¡Œè¿‡æ­¤è¯­å¥ï¼‰åˆ™ç›´æ¥è¿”å›ç¼“å­˜æ•°æ®ï¼Œå¦‚æœæ²¡æœ‰ç¼“å­˜åˆ™è¿›å…¥åˆ†æå™¨ã€‚</p></li><li><p>åˆ†æå™¨ä¼šå¯¹æŸ¥è¯¢è¯­å¥è¿›è¡Œè¯­æ³•åˆ†æå’Œè¯æ³•åˆ†æï¼Œåˆ¤æ–­ SQL è¯­æ³•æ˜¯å¦æ­£ç¡®ï¼Œå¦‚æœæŸ¥è¯¢è¯­æ³•é”™è¯¯ä¼šç›´æ¥è¿”å›ç»™å®¢æˆ·ç«¯é”™è¯¯ä¿¡æ¯ï¼Œå¦‚æœè¯­æ³•æ­£ç¡®åˆ™è¿›å…¥ä¼˜åŒ–å™¨ã€‚</p></li><li><p>ä¼˜åŒ–å™¨æ˜¯å¯¹æŸ¥è¯¢è¯­å¥è¿›è¡Œä¼˜åŒ–å¤„ç†ï¼Œä¾‹å¦‚ä¸€ä¸ªè¡¨é‡Œé¢æœ‰å¤šä¸ªç´¢å¼•ï¼Œä¼˜åŒ–å™¨ä¼šåˆ¤åˆ«å“ªä¸ªç´¢å¼•æ€§èƒ½æ›´å¥½ã€‚</p></li><li><p>ä¼˜åŒ–å™¨æ‰§è¡Œå®Œå°±è¿›å…¥æ‰§è¡Œå™¨ï¼Œæ‰§è¡Œå™¨å°±å¼€å§‹æ‰§è¡Œè¯­å¥è¿›è¡ŒæŸ¥è¯¢æ¯”å¯¹äº†ï¼Œç›´åˆ°æŸ¥è¯¢åˆ°æ»¡è¶³æ¡ä»¶çš„æ‰€æœ‰æ•°æ®ï¼Œç„¶åè¿›è¡Œè¿”å›ã€‚</p></li></ul><h5 id="MySQL-æç¤ºâ€œä¸å­˜åœ¨æ­¤åˆ—â€æ˜¯æ‰§è¡Œåˆ°å“ªä¸ªèŠ‚ç‚¹æŠ¥å‡ºçš„ï¼Ÿ"><a href="#MySQL-æç¤ºâ€œä¸å­˜åœ¨æ­¤åˆ—â€æ˜¯æ‰§è¡Œåˆ°å“ªä¸ªèŠ‚ç‚¹æŠ¥å‡ºçš„ï¼Ÿ" class="headerlink" title="MySQL æç¤ºâ€œä¸å­˜åœ¨æ­¤åˆ—â€æ˜¯æ‰§è¡Œåˆ°å“ªä¸ªèŠ‚ç‚¹æŠ¥å‡ºçš„ï¼Ÿ"></a>MySQL æç¤ºâ€œä¸å­˜åœ¨æ­¤åˆ—â€æ˜¯æ‰§è¡Œåˆ°å“ªä¸ªèŠ‚ç‚¹æŠ¥å‡ºçš„ï¼Ÿ</h5><p>æ­¤é”™è¯¯æ˜¯æ‰§è¡Œåˆ°åˆ†æå™¨é˜¶æ®µæŠ¥å‡ºçš„ï¼Œå› ä¸º MySQL ä¼šåœ¨åˆ†æå™¨é˜¶æ®µæ£€æŸ¥ SQL è¯­å¥çš„æ­£ç¡®æ€§ã€‚</p><h5 id="MySQL-æŸ¥è¯¢ç¼“å­˜çš„åŠŸèƒ½æœ‰ä½•ä¼˜ç¼ºç‚¹ï¼Ÿ"><a href="#MySQL-æŸ¥è¯¢ç¼“å­˜çš„åŠŸèƒ½æœ‰ä½•ä¼˜ç¼ºç‚¹ï¼Ÿ" class="headerlink" title="MySQL æŸ¥è¯¢ç¼“å­˜çš„åŠŸèƒ½æœ‰ä½•ä¼˜ç¼ºç‚¹ï¼Ÿ"></a>MySQL æŸ¥è¯¢ç¼“å­˜çš„åŠŸèƒ½æœ‰ä½•ä¼˜ç¼ºç‚¹ï¼Ÿ</h5><p>MySQL æŸ¥è¯¢ç¼“å­˜åŠŸèƒ½æ˜¯åœ¨è¿æ¥å™¨ä¹‹åå‘ç”Ÿçš„ï¼Œå®ƒçš„ä¼˜ç‚¹æ˜¯æ•ˆç‡é«˜ï¼Œå¦‚æœå·²ç»æœ‰ç¼“å­˜åˆ™ä¼šç›´æ¥è¿”å›ç»“æœã€‚ æŸ¥è¯¢ç¼“å­˜çš„ç¼ºç‚¹æ˜¯å¤±æ•ˆå¤ªé¢‘ç¹å¯¼è‡´ç¼“å­˜å‘½ä¸­ç‡æ¯”è¾ƒä½ï¼Œä»»ä½•æ›´æ–°è¡¨æ“ä½œéƒ½ä¼šæ¸…ç©ºæŸ¥è¯¢ç¼“å­˜ï¼Œå› æ­¤å¯¼è‡´æŸ¥è¯¢ç¼“å­˜éå¸¸å®¹æ˜“å¤±æ•ˆã€‚</p><h5 id="å¦‚ä½•å…³é—­-MySQL-çš„æŸ¥è¯¢ç¼“å­˜åŠŸèƒ½ï¼Ÿ"><a href="#å¦‚ä½•å…³é—­-MySQL-çš„æŸ¥è¯¢ç¼“å­˜åŠŸèƒ½ï¼Ÿ" class="headerlink" title="å¦‚ä½•å…³é—­ MySQL çš„æŸ¥è¯¢ç¼“å­˜åŠŸèƒ½ï¼Ÿ"></a>å¦‚ä½•å…³é—­ MySQL çš„æŸ¥è¯¢ç¼“å­˜åŠŸèƒ½ï¼Ÿ</h5><p>MySQL æŸ¥è¯¢ç¼“å­˜é»˜è®¤æ˜¯å¼€å¯çš„ï¼Œé…ç½® querycachetype å‚æ•°ä¸º DEMANDï¼ˆæŒ‰éœ€ä½¿ç”¨ï¼‰å…³é—­æŸ¥è¯¢ç¼“å­˜ï¼ŒMySQL 8.0 ä¹‹åç›´æ¥åˆ é™¤äº†æŸ¥è¯¢ç¼“å­˜çš„åŠŸèƒ½ã€‚</p><h5 id="MySQL-çš„å¸¸ç”¨å¼•æ“éƒ½æœ‰å“ªäº›ï¼Ÿ"><a href="#MySQL-çš„å¸¸ç”¨å¼•æ“éƒ½æœ‰å“ªäº›ï¼Ÿ" class="headerlink" title="MySQL çš„å¸¸ç”¨å¼•æ“éƒ½æœ‰å“ªäº›ï¼Ÿ"></a>MySQL çš„å¸¸ç”¨å¼•æ“éƒ½æœ‰å“ªäº›ï¼Ÿ</h5><p>MySQL çš„å¸¸ç”¨å¼•æ“æœ‰ InnoDBã€MyISAMã€Memory ç­‰ï¼Œä» MySQL 5.5.5 ç‰ˆæœ¬å¼€å§‹ InnoDB å°±æˆä¸ºäº†é»˜è®¤çš„å­˜å‚¨å¼•æ“ã€‚</p><h5 id="MySQL-å¯ä»¥é’ˆå¯¹è¡¨çº§åˆ«è®¾ç½®æ•°æ®åº“å¼•æ“å—ï¼Ÿæ€ä¹ˆè®¾ç½®ï¼Ÿ"><a href="#MySQL-å¯ä»¥é’ˆå¯¹è¡¨çº§åˆ«è®¾ç½®æ•°æ®åº“å¼•æ“å—ï¼Ÿæ€ä¹ˆè®¾ç½®ï¼Ÿ" class="headerlink" title="MySQL å¯ä»¥é’ˆå¯¹è¡¨çº§åˆ«è®¾ç½®æ•°æ®åº“å¼•æ“å—ï¼Ÿæ€ä¹ˆè®¾ç½®ï¼Ÿ"></a>MySQL å¯ä»¥é’ˆå¯¹è¡¨çº§åˆ«è®¾ç½®æ•°æ®åº“å¼•æ“å—ï¼Ÿæ€ä¹ˆè®¾ç½®ï¼Ÿ</h5><p>å¯ä»¥é’ˆå¯¹ä¸åŒçš„è¡¨è®¾ç½®ä¸åŒçš„å¼•æ“ã€‚åœ¨ create table è¯­å¥ä¸­ä½¿ç”¨ engine=å¼•æ“åï¼ˆæ¯”å¦‚Memoryï¼‰æ¥è®¾ç½®æ­¤è¡¨çš„å­˜å‚¨å¼•æ“ã€‚å®Œæ•´ä»£ç å¦‚ä¸‹ï¼š</p><pre><code class="hljs mysql">create table student(    id int primary key auto_increment,    username varchar(120),    age int ) ENGINE&#x3D;Memory</code></pre><h5 id="å¸¸ç”¨çš„å­˜å‚¨å¼•æ“-InnoDB-å’Œ-MyISAM-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"><a href="#å¸¸ç”¨çš„å­˜å‚¨å¼•æ“-InnoDB-å’Œ-MyISAM-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ" class="headerlink" title="å¸¸ç”¨çš„å­˜å‚¨å¼•æ“ InnoDB å’Œ MyISAM æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"></a>å¸¸ç”¨çš„å­˜å‚¨å¼•æ“ InnoDB å’Œ MyISAM æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h5><p>InnoDB å’Œ MyISAM æœ€å¤§çš„åŒºåˆ«æ˜¯ InnoDB æ”¯æŒäº‹åŠ¡ï¼Œè€Œ MyISAM ä¸æ”¯æŒäº‹åŠ¡ï¼Œå®ƒä»¬ä¸»è¦åŒºåˆ«å¦‚ä¸‹ï¼š</p><ul><li><p>InnoDB æ”¯æŒå´©æºƒåå®‰å…¨æ¢å¤ï¼ŒMyISAM ä¸æ”¯æŒå´©æºƒåå®‰å…¨æ¢å¤ï¼›</p></li><li><p>InnoDB æ”¯æŒè¡Œçº§é”ï¼ŒMyISAM ä¸æ”¯æŒè¡Œçº§é”ï¼Œåªæ”¯æŒåˆ°è¡¨é”ï¼›</p></li><li><p>InnoDB æ”¯æŒå¤–é”®ï¼ŒMyISAM ä¸æ”¯æŒå¤–é”®ï¼›</p></li><li><p>MyISAM æ€§èƒ½æ¯” InnoDB é«˜ï¼›</p></li><li><p>MyISAM æ”¯æŒ FULLTEXT ç±»å‹çš„å…¨æ–‡ç´¢å¼•ï¼ŒInnoDB ä¸æ”¯æŒ FULLTEXT ç±»å‹çš„å…¨æ–‡ç´¢å¼•ï¼Œä½†æ˜¯ InnoDB å¯ä»¥ä½¿ç”¨ sphinx æ’ä»¶æ”¯æŒå…¨æ–‡ç´¢å¼•ï¼Œå¹¶ä¸”æ•ˆæœæ›´å¥½ï¼›</p></li><li><p>InnoDB ä¸»é”®æŸ¥è¯¢æ€§èƒ½é«˜äº MyISAMã€‚</p></li></ul><h5 id="InnoDB-æœ‰å“ªäº›ç‰¹æ€§ï¼Ÿ"><a href="#InnoDB-æœ‰å“ªäº›ç‰¹æ€§ï¼Ÿ" class="headerlink" title="InnoDB æœ‰å“ªäº›ç‰¹æ€§ï¼Ÿ"></a>InnoDB æœ‰å“ªäº›ç‰¹æ€§ï¼Ÿ</h5><p>1ï¼‰æ’å…¥ç¼“å†²(insert buffer)ï¼šå¯¹äºéèšé›†ç´¢å¼•çš„æ’å…¥å’Œæ›´æ–°ï¼Œä¸æ˜¯æ¯ä¸€æ¬¡ç›´æ¥æ’å…¥ç´¢å¼•é¡µä¸­ï¼Œè€Œæ˜¯é¦–å…ˆåˆ¤æ–­æ’å…¥çš„éèšé›†ç´¢å¼•é¡µæ˜¯å¦åœ¨ç¼“å†²æ± ä¸­ï¼Œå¦‚æœåœ¨ï¼Œåˆ™ç›´æ¥æ’å…¥ï¼Œå¦åˆ™ï¼Œå…ˆæ”¾å…¥ä¸€ä¸ªæ’å…¥ç¼“å†²åŒºä¸­ã€‚å¥½ä¼¼æ¬ºéª—æ•°æ®åº“è¿™ä¸ªéèšé›†çš„ç´¢å¼•å·²ç»æ’å…¥åˆ°å¶å­èŠ‚ç‚¹äº†ï¼Œç„¶åå†ä»¥ä¸€å®šçš„é¢‘ç‡æ‰§è¡Œæ’å…¥ç¼“å†²å’Œéèšé›†ç´¢å¼•é¡µå­èŠ‚ç‚¹çš„åˆå¹¶æ“ä½œï¼Œè¿™æ—¶é€šå¸¸èƒ½å°†å¤šä¸ªæ’å…¥åˆå¹¶åˆ°ä¸€ä¸ªæ“ä½œä¸­ï¼Œè¿™å°±å¤§å¤§æé«˜äº†å¯¹éèšé›†ç´¢å¼•æ‰§è¡Œæ’å…¥å’Œä¿®æ”¹æ“ä½œçš„æ€§èƒ½ã€‚</p><p>2ï¼‰ä¸¤æ¬¡å†™(double write)ï¼šä¸¤æ¬¡å†™ç»™ InnoDB å¸¦æ¥çš„æ˜¯å¯é æ€§ï¼Œä¸»è¦ç”¨æ¥è§£å†³éƒ¨åˆ†å†™å¤±è´¥(partial page write)ã€‚doublewrite æœ‰ä¸¤éƒ¨åˆ†ç»„æˆï¼Œä¸€éƒ¨åˆ†æ˜¯å†…å­˜ä¸­çš„ doublewrite buffer ï¼Œå¤§å°ä¸º 2Mï¼Œå¦å¤–ä¸€éƒ¨åˆ†å°±æ˜¯ç‰©ç†ç£ç›˜ä¸Šçš„å…±äº«è¡¨ç©ºé—´ä¸­è¿ç»­çš„ 128 ä¸ªé¡µï¼Œå³ä¸¤ä¸ªåŒºï¼Œå¤§å°åŒæ ·ä¸º 2Mã€‚å½“ç¼“å†²æ± çš„ä½œä¸šåˆ·æ–°æ—¶ï¼Œå¹¶ä¸ç›´æ¥å†™ç¡¬ç›˜ï¼Œè€Œæ˜¯é€šè¿‡ memcpy å‡½æ•°å°†è„é¡µå…ˆæ‹·è´åˆ°å†…å­˜ä¸­çš„ doublewrite bufferï¼Œä¹‹åé€šè¿‡ doublewrite buffer å†åˆ†ä¸¤æ¬¡å†™ï¼Œæ¯æ¬¡å†™å…¥ 1M åˆ°å…±äº«è¡¨ç©ºé—´çš„ç‰©ç†ç£ç›˜ä¸Šï¼Œç„¶åé©¬ä¸Šè°ƒç”¨ fsync å‡½æ•°ï¼ŒåŒæ­¥ç£ç›˜ã€‚å¦‚ä¸‹å›¾æ‰€ç¤º</p><p> <img src="/images/mysql/innodb.png"></p><p>3ï¼‰è‡ªé€‚åº”å“ˆå¸Œç´¢å¼•(adaptive hash index)ï¼šç”±äº InnoDB ä¸æ”¯æŒ hash ç´¢å¼•ï¼Œä½†åœ¨æŸäº›æƒ…å†µä¸‹ hash ç´¢å¼•çš„æ•ˆç‡å¾ˆé«˜ï¼Œäºæ˜¯å‡ºç°äº† adaptive hash index åŠŸèƒ½ï¼Œ InnoDB å­˜å‚¨å¼•æ“ä¼šç›‘æ§å¯¹è¡¨ä¸Šç´¢å¼•çš„æŸ¥æ‰¾ï¼Œå¦‚æœè§‚å¯Ÿåˆ°å»ºç«‹ hash ç´¢å¼•å¯ä»¥æé«˜æ€§èƒ½çš„æ—¶å€™ï¼Œåˆ™è‡ªåŠ¨å»ºç«‹ hash ç´¢å¼•ã€‚</p><h5 id="ä¸€å¼ è‡ªå¢è¡¨ä¸­æœ‰ä¸‰æ¡æ•°æ®ï¼Œåˆ é™¤äº†ä¸¤æ¡æ•°æ®ä¹‹åé‡å¯æ•°æ®åº“ï¼Œå†æ–°å¢ä¸€æ¡æ•°æ®ï¼Œæ­¤æ—¶è¿™æ¡æ•°æ®çš„-ID-æ˜¯å‡ ï¼Ÿ"><a href="#ä¸€å¼ è‡ªå¢è¡¨ä¸­æœ‰ä¸‰æ¡æ•°æ®ï¼Œåˆ é™¤äº†ä¸¤æ¡æ•°æ®ä¹‹åé‡å¯æ•°æ®åº“ï¼Œå†æ–°å¢ä¸€æ¡æ•°æ®ï¼Œæ­¤æ—¶è¿™æ¡æ•°æ®çš„-ID-æ˜¯å‡ ï¼Ÿ" class="headerlink" title="ä¸€å¼ è‡ªå¢è¡¨ä¸­æœ‰ä¸‰æ¡æ•°æ®ï¼Œåˆ é™¤äº†ä¸¤æ¡æ•°æ®ä¹‹åé‡å¯æ•°æ®åº“ï¼Œå†æ–°å¢ä¸€æ¡æ•°æ®ï¼Œæ­¤æ—¶è¿™æ¡æ•°æ®çš„ ID æ˜¯å‡ ï¼Ÿ"></a>ä¸€å¼ è‡ªå¢è¡¨ä¸­æœ‰ä¸‰æ¡æ•°æ®ï¼Œåˆ é™¤äº†ä¸¤æ¡æ•°æ®ä¹‹åé‡å¯æ•°æ®åº“ï¼Œå†æ–°å¢ä¸€æ¡æ•°æ®ï¼Œæ­¤æ—¶è¿™æ¡æ•°æ®çš„ ID æ˜¯å‡ ï¼Ÿ</h5><p>å¦‚æœè¿™å¼ è¡¨çš„å¼•æ“æ˜¯ MyISAMï¼Œé‚£ä¹ˆ ID=4ï¼Œå¦‚æœæ˜¯ InnoDB é‚£ä¹ˆ ID=2ï¼ˆMySQL 8 ä¹‹å‰çš„ç‰ˆæœ¬ï¼‰ã€‚</p><h5 id="MySQL-ä¸­ä»€ä¹ˆæƒ…å†µä¼šå¯¼è‡´è‡ªå¢ä¸»é”®ä¸èƒ½è¿ç»­ï¼Ÿ"><a href="#MySQL-ä¸­ä»€ä¹ˆæƒ…å†µä¼šå¯¼è‡´è‡ªå¢ä¸»é”®ä¸èƒ½è¿ç»­ï¼Ÿ" class="headerlink" title="MySQL ä¸­ä»€ä¹ˆæƒ…å†µä¼šå¯¼è‡´è‡ªå¢ä¸»é”®ä¸èƒ½è¿ç»­ï¼Ÿ"></a>MySQL ä¸­ä»€ä¹ˆæƒ…å†µä¼šå¯¼è‡´è‡ªå¢ä¸»é”®ä¸èƒ½è¿ç»­ï¼Ÿ</h5><p>ä»¥ä¸‹æƒ…å†µä¼šå¯¼è‡´ MySQL è‡ªå¢ä¸»é”®ä¸èƒ½è¿ç»­ï¼š</p><ul><li><p>å”¯ä¸€ä¸»é”®å†²çªä¼šå¯¼è‡´è‡ªå¢ä¸»é”®ä¸è¿ç»­ï¼›</p></li><li><p>äº‹åŠ¡å›æ»šä¹Ÿä¼šå¯¼è‡´è‡ªå¢ä¸»é”®ä¸è¿ç»­ã€‚</p></li></ul><h5 id="InnoDB-ä¸­è‡ªå¢ä¸»é”®èƒ½ä¸èƒ½è¢«æŒä¹…åŒ–ï¼Ÿ"><a href="#InnoDB-ä¸­è‡ªå¢ä¸»é”®èƒ½ä¸èƒ½è¢«æŒä¹…åŒ–ï¼Ÿ" class="headerlink" title="InnoDB ä¸­è‡ªå¢ä¸»é”®èƒ½ä¸èƒ½è¢«æŒä¹…åŒ–ï¼Ÿ"></a>InnoDB ä¸­è‡ªå¢ä¸»é”®èƒ½ä¸èƒ½è¢«æŒä¹…åŒ–ï¼Ÿ</h5><p>è‡ªå¢ä¸»é”®èƒ½ä¸èƒ½è¢«æŒä¹…åŒ–ï¼Œè¯´çš„æ˜¯ MySQL é‡å¯ä¹‹å InnoDB èƒ½ä¸èƒ½æ¢å¤é‡å¯ä¹‹å‰çš„è‡ªå¢åˆ—ï¼ŒInnoDB åœ¨ 8.0 ä¹‹å‰æ˜¯æ²¡æœ‰æŒä¹…åŒ–èƒ½åŠ›çš„ï¼Œä½† MySQL 8.0 ä¹‹åå°±æŠŠè‡ªå¢ä¸»é”®ä¿å­˜åˆ° redo logï¼ˆä¸€ç§æ—¥å¿—ç±»å‹ï¼Œä¸‹æ–‡ä¼šè¯¦ç»†è®²ï¼‰ä¸­ï¼Œå½“ MySQL é‡å¯ä¹‹åå°±ä¼šä» redo log æ—¥å¿—ä¸­æ¢å¤ã€‚</p><h5 id="ä»€ä¹ˆæ˜¯ç‹¬ç«‹è¡¨ç©ºé—´å’Œå…±äº«è¡¨ç©ºé—´ï¼Ÿå®ƒä»¬çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯ç‹¬ç«‹è¡¨ç©ºé—´å’Œå…±äº«è¡¨ç©ºé—´ï¼Ÿå®ƒä»¬çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯ç‹¬ç«‹è¡¨ç©ºé—´å’Œå…±äº«è¡¨ç©ºé—´ï¼Ÿå®ƒä»¬çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ"></a>ä»€ä¹ˆæ˜¯ç‹¬ç«‹è¡¨ç©ºé—´å’Œå…±äº«è¡¨ç©ºé—´ï¼Ÿå®ƒä»¬çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</h5><p>å…±äº«è¡¨ç©ºé—´ï¼šæŒ‡çš„æ˜¯æ•°æ®åº“çš„æ‰€æœ‰çš„è¡¨æ•°æ®ï¼Œç´¢å¼•æ–‡ä»¶å…¨éƒ¨æ”¾åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œé»˜è®¤è¿™ä¸ªå…±äº«è¡¨ç©ºé—´çš„æ–‡ä»¶è·¯å¾„åœ¨ data ç›®å½•ä¸‹ã€‚ ç‹¬ç«‹è¡¨ç©ºé—´ï¼šæ¯ä¸€ä¸ªè¡¨éƒ½å°†ä¼šç”Ÿæˆä»¥ç‹¬ç«‹çš„æ–‡ä»¶æ–¹å¼æ¥è¿›è¡Œå­˜å‚¨ã€‚ å…±äº«è¡¨ç©ºé—´å’Œç‹¬ç«‹è¡¨ç©ºé—´æœ€å¤§çš„åŒºåˆ«æ˜¯å¦‚æœæŠŠè¡¨æ”¾å†å…±äº«è¡¨ç©ºé—´ï¼Œå³ä½¿è¡¨åˆ é™¤äº†ç©ºé—´ä¹Ÿä¸ä¼šåˆ é™¤ï¼Œæ‰€ä»¥è¡¨ä¾ç„¶å¾ˆå¤§ï¼Œè€Œç‹¬ç«‹è¡¨ç©ºé—´å¦‚æœåˆ é™¤è¡¨å°±ä¼šæ¸…é™¤ç©ºé—´ã€‚</p><h5 id="å¦‚ä½•è®¾ç½®ç‹¬ç«‹è¡¨ç©ºé—´ï¼Ÿ"><a href="#å¦‚ä½•è®¾ç½®ç‹¬ç«‹è¡¨ç©ºé—´ï¼Ÿ" class="headerlink" title="å¦‚ä½•è®¾ç½®ç‹¬ç«‹è¡¨ç©ºé—´ï¼Ÿ"></a>å¦‚ä½•è®¾ç½®ç‹¬ç«‹è¡¨ç©ºé—´ï¼Ÿ</h5><p>ç‹¬ç«‹è¡¨ç©ºé—´æ˜¯ç”±å‚æ•° innodbfileper_table æ§åˆ¶çš„ï¼ŒæŠŠå®ƒè®¾ç½®æˆ ON å°±æ˜¯ç‹¬ç«‹è¡¨ç©ºé—´äº†ï¼Œä» MySQL 5.6.6 ç‰ˆæœ¬ä¹‹åï¼Œè¿™ä¸ªå€¼å°±é»˜è®¤æ˜¯ ON äº†ã€‚</p><p>å¦‚ä½•è¿›è¡Œè¡¨ç©ºé—´æ”¶ç¼©ï¼Ÿ</p><p>ä½¿ç”¨é‡å»ºè¡¨çš„æ–¹å¼å¯ä»¥æ”¶ç¼©è¡¨ç©ºé—´ï¼Œé‡å»ºè¡¨æœ‰ä»¥ä¸‹ä¸‰ç§æ–¹å¼ï¼š</p><ul><li><p><code>alter table t engine=InnoDB</code></p></li><li><p><code>optmize table t</code></p></li><li><p><code>truncate table t</code></p></li></ul><h5 id="è¯´ä¸€ä¸‹é‡å»ºè¡¨çš„æ‰§è¡Œæµç¨‹ï¼Ÿ"><a href="#è¯´ä¸€ä¸‹é‡å»ºè¡¨çš„æ‰§è¡Œæµç¨‹ï¼Ÿ" class="headerlink" title="è¯´ä¸€ä¸‹é‡å»ºè¡¨çš„æ‰§è¡Œæµç¨‹ï¼Ÿ"></a>è¯´ä¸€ä¸‹é‡å»ºè¡¨çš„æ‰§è¡Œæµç¨‹ï¼Ÿ</h5><ul><li><p>å»ºç«‹ä¸€ä¸ªä¸´æ—¶æ–‡ä»¶ï¼Œæ‰«æè¡¨ t ä¸»é”®çš„æ‰€æœ‰æ•°æ®é¡µï¼›</p></li><li><p>ç”¨æ•°æ®é¡µä¸­è¡¨ t çš„è®°å½•ç”Ÿæˆ B+ æ ‘ï¼Œå­˜å‚¨åˆ°ä¸´æ—¶æ–‡ä»¶ä¸­ï¼›</p></li><li><p>ç”Ÿæˆä¸´æ—¶æ–‡ä»¶çš„è¿‡ç¨‹ä¸­ï¼Œå°†æ‰€æœ‰å¯¹ t çš„æ“ä½œè®°å½•åœ¨ä¸€ä¸ªæ—¥å¿—æ–‡ä»¶ï¼ˆrow logï¼‰ä¸­ï¼›</p></li><li><p>ä¸´æ—¶æ–‡ä»¶ç”Ÿæˆåï¼Œå°†æ—¥å¿—æ–‡ä»¶ä¸­çš„æ“ä½œåº”ç”¨åˆ°ä¸´æ—¶æ–‡ä»¶ï¼Œå¾—åˆ°ä¸€ä¸ªé€»è¾‘æ•°æ®ä¸Šä¸è¡¨ tç›¸åŒçš„æ•°æ®æ–‡ä»¶ï¼›</p></li><li><p>ç”¨ä¸´æ—¶æ–‡ä»¶æ›¿æ¢è¡¨ t çš„æ•°æ®æ–‡ä»¶ã€‚</p></li></ul><h5 id="è¡¨çš„ç»“æ„ä¿¡æ¯å­˜åœ¨å“ªé‡Œï¼Ÿ"><a href="#è¡¨çš„ç»“æ„ä¿¡æ¯å­˜åœ¨å“ªé‡Œï¼Ÿ" class="headerlink" title="è¡¨çš„ç»“æ„ä¿¡æ¯å­˜åœ¨å“ªé‡Œï¼Ÿ"></a>è¡¨çš„ç»“æ„ä¿¡æ¯å­˜åœ¨å“ªé‡Œï¼Ÿ</h5><p>è¡¨ç»“æ„å®šä¹‰å æœ‰çš„å­˜å‚¨ç©ºé—´æ¯”è¾ƒå°ï¼Œåœ¨ MySQL 8 ä¹‹å‰ï¼Œè¡¨ç»“æ„çš„å®šä¹‰ä¿¡æ¯å­˜åœ¨ä»¥ .frm ä¸ºåç¼€çš„æ–‡ä»¶é‡Œï¼Œåœ¨ MySQL 8 ä¹‹åï¼Œåˆ™å…è®¸æŠŠè¡¨ç»“æ„çš„å®šä¹‰ä¿¡æ¯å­˜åœ¨ç³»ç»Ÿæ•°æ®è¡¨ä¹‹ä¸­ã€‚</p><h5 id="å¦‚æœæŠŠä¸€ä¸ª-InnoDB-è¡¨çš„ä¸»é”®åˆ æ‰ï¼Œæ˜¯ä¸æ˜¯å°±æ²¡æœ‰ä¸»é”®ï¼Œå°±æ²¡åŠæ³•è¿›è¡Œå›è¡¨æŸ¥è¯¢äº†ï¼Ÿ"><a href="#å¦‚æœæŠŠä¸€ä¸ª-InnoDB-è¡¨çš„ä¸»é”®åˆ æ‰ï¼Œæ˜¯ä¸æ˜¯å°±æ²¡æœ‰ä¸»é”®ï¼Œå°±æ²¡åŠæ³•è¿›è¡Œå›è¡¨æŸ¥è¯¢äº†ï¼Ÿ" class="headerlink" title="å¦‚æœæŠŠä¸€ä¸ª InnoDB è¡¨çš„ä¸»é”®åˆ æ‰ï¼Œæ˜¯ä¸æ˜¯å°±æ²¡æœ‰ä¸»é”®ï¼Œå°±æ²¡åŠæ³•è¿›è¡Œå›è¡¨æŸ¥è¯¢äº†ï¼Ÿ"></a>å¦‚æœæŠŠä¸€ä¸ª InnoDB è¡¨çš„ä¸»é”®åˆ æ‰ï¼Œæ˜¯ä¸æ˜¯å°±æ²¡æœ‰ä¸»é”®ï¼Œå°±æ²¡åŠæ³•è¿›è¡Œå›è¡¨æŸ¥è¯¢äº†ï¼Ÿ</h5><p>å¯ä»¥å›è¡¨æŸ¥è¯¢ï¼Œå¦‚æœæŠŠä¸»é”®åˆ æ‰äº†ï¼Œé‚£ä¹ˆ InnoDB ä¼šè‡ªå·±ç”Ÿæˆä¸€ä¸ªé•¿åº¦ä¸º 6 å­—èŠ‚çš„ rowid ä½œä¸ºä¸»é”®ã€‚</p><h5 id="æ‰§è¡Œä¸€ä¸ª-update-è¯­å¥ä»¥åï¼Œæˆ‘å†å»æ‰§è¡Œ-hexdump-å‘½ä»¤ç›´æ¥æŸ¥çœ‹-ibd-æ–‡ä»¶å†…å®¹ï¼Œä¸ºä»€ä¹ˆæ²¡æœ‰çœ‹åˆ°æ•°æ®æœ‰æ”¹å˜å‘¢ï¼Ÿ"><a href="#æ‰§è¡Œä¸€ä¸ª-update-è¯­å¥ä»¥åï¼Œæˆ‘å†å»æ‰§è¡Œ-hexdump-å‘½ä»¤ç›´æ¥æŸ¥çœ‹-ibd-æ–‡ä»¶å†…å®¹ï¼Œä¸ºä»€ä¹ˆæ²¡æœ‰çœ‹åˆ°æ•°æ®æœ‰æ”¹å˜å‘¢ï¼Ÿ" class="headerlink" title="æ‰§è¡Œä¸€ä¸ª update è¯­å¥ä»¥åï¼Œæˆ‘å†å»æ‰§è¡Œ hexdump å‘½ä»¤ç›´æ¥æŸ¥çœ‹ ibd æ–‡ä»¶å†…å®¹ï¼Œä¸ºä»€ä¹ˆæ²¡æœ‰çœ‹åˆ°æ•°æ®æœ‰æ”¹å˜å‘¢ï¼Ÿ"></a>æ‰§è¡Œä¸€ä¸ª update è¯­å¥ä»¥åï¼Œæˆ‘å†å»æ‰§è¡Œ hexdump å‘½ä»¤ç›´æ¥æŸ¥çœ‹ ibd æ–‡ä»¶å†…å®¹ï¼Œä¸ºä»€ä¹ˆæ²¡æœ‰çœ‹åˆ°æ•°æ®æœ‰æ”¹å˜å‘¢ï¼Ÿ</h5><p>å¯èƒ½æ˜¯å› ä¸º update è¯­å¥æ‰§è¡Œå®Œæˆåï¼ŒInnoDB åªä¿è¯å†™å®Œäº† redo logã€å†…å­˜ï¼Œå¯èƒ½è¿˜æ²¡æ¥å¾—åŠå°†æ•°æ®å†™åˆ°ç£ç›˜ã€‚</p><h5 id="å†…å­˜è¡¨å’Œä¸´æ—¶è¡¨æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"><a href="#å†…å­˜è¡¨å’Œä¸´æ—¶è¡¨æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ" class="headerlink" title="å†…å­˜è¡¨å’Œä¸´æ—¶è¡¨æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"></a>å†…å­˜è¡¨å’Œä¸´æ—¶è¡¨æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h5><ul><li><p>å†…å­˜è¡¨ï¼ŒæŒ‡çš„æ˜¯ä½¿ç”¨ Memory å¼•æ“çš„è¡¨ï¼Œå»ºè¡¨è¯­æ³•æ˜¯ create table â€¦ engine=memoryã€‚è¿™ç§è¡¨çš„æ•°æ®éƒ½ä¿å­˜åœ¨å†…å­˜é‡Œï¼Œç³»ç»Ÿé‡å¯çš„æ—¶å€™ä¼šè¢«æ¸…ç©ºï¼Œä½†æ˜¯è¡¨ç»“æ„è¿˜åœ¨ã€‚é™¤äº†è¿™ä¸¤ä¸ªç‰¹æ€§çœ‹ä¸Šå»æ¯”è¾ƒâ€œå¥‡æ€ªâ€å¤–ï¼Œä»å…¶ä»–çš„ç‰¹å¾ä¸Šçœ‹ï¼Œå®ƒå°±æ˜¯ä¸€ä¸ªæ­£å¸¸çš„è¡¨ã€‚</p></li><li><p>è€Œä¸´æ—¶è¡¨ï¼Œå¯ä»¥ä½¿ç”¨å„ç§å¼•æ“ç±»å‹ ã€‚å¦‚æœæ˜¯ä½¿ç”¨ InnoDB å¼•æ“æˆ–è€… MyISAM å¼•æ“çš„ä¸´æ—¶è¡¨ï¼Œå†™æ•°æ®çš„æ—¶å€™æ˜¯å†™åˆ°ç£ç›˜ä¸Šçš„ã€‚</p></li></ul><h5 id="å¹¶å‘äº‹åŠ¡ä¼šå¸¦æ¥å“ªäº›é—®é¢˜ï¼Ÿ"><a href="#å¹¶å‘äº‹åŠ¡ä¼šå¸¦æ¥å“ªäº›é—®é¢˜ï¼Ÿ" class="headerlink" title="å¹¶å‘äº‹åŠ¡ä¼šå¸¦æ¥å“ªäº›é—®é¢˜ï¼Ÿ"></a>å¹¶å‘äº‹åŠ¡ä¼šå¸¦æ¥å“ªäº›é—®é¢˜ï¼Ÿ</h5><ul><li><p>è„è¯»</p></li><li><p>ä¿®æ”¹ä¸¢å¤±</p></li><li><p>ä¸å¯é‡å¤è¯»</p></li><li><p>å¹»è¯»</p></li></ul><h5 id="ä»€ä¹ˆæ˜¯è„è¯»å’Œå¹»è¯»ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯è„è¯»å’Œå¹»è¯»ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯è„è¯»å’Œå¹»è¯»ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯è„è¯»å’Œå¹»è¯»ï¼Ÿ</h5><p>è„è¯»æ˜¯ä¸€ä¸ªäº‹åŠ¡åœ¨å¤„ç†è¿‡ç¨‹ä¸­è¯»å–äº†å¦å¤–ä¸€ä¸ªäº‹åŠ¡æœªæäº¤çš„æ•°æ®ï¼›å¹»è¯»æ˜¯æŒ‡åŒä¸€ä¸ªäº‹åŠ¡å†…å¤šæ¬¡æŸ¥è¯¢è¿”å›çš„ç»“æœé›†ä¸ä¸€æ ·ï¼ˆæ¯”å¦‚å¢åŠ äº†æˆ–è€…å‡å°‘äº†è¡Œè®°å½•ï¼‰ã€‚</p><h5 id="ä¸ºä»€ä¹ˆä¼šå‡ºç°å¹»è¯»ï¼Ÿå¹»è¯»ä¼šå¸¦æ¥ä»€ä¹ˆé—®é¢˜ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆä¼šå‡ºç°å¹»è¯»ï¼Ÿå¹»è¯»ä¼šå¸¦æ¥ä»€ä¹ˆé—®é¢˜ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆä¼šå‡ºç°å¹»è¯»ï¼Ÿå¹»è¯»ä¼šå¸¦æ¥ä»€ä¹ˆé—®é¢˜ï¼Ÿ"></a>ä¸ºä»€ä¹ˆä¼šå‡ºç°å¹»è¯»ï¼Ÿå¹»è¯»ä¼šå¸¦æ¥ä»€ä¹ˆé—®é¢˜ï¼Ÿ</h5><p>å› ä¸ºè¡Œé”åªèƒ½é”å®šå­˜åœ¨çš„è¡Œï¼Œé’ˆå¯¹æ–°æ’å…¥çš„æ“ä½œæ²¡æœ‰é™å®šï¼Œæ‰€ä»¥å°±æœ‰å¯èƒ½äº§ç”Ÿå¹»è¯»ã€‚ å¹»è¯»å¸¦æ¥çš„é—®é¢˜å¦‚ä¸‹ï¼š</p><ul><li><p>å¯¹è¡Œé”è¯­ä¹‰çš„ç ´åï¼›</p></li><li><p>ç ´åäº†æ•°æ®ä¸€è‡´æ€§ã€‚</p></li></ul><h5 id="å¦‚ä½•é¿å…å¹»è¯»ï¼Ÿ"><a href="#å¦‚ä½•é¿å…å¹»è¯»ï¼Ÿ" class="headerlink" title="å¦‚ä½•é¿å…å¹»è¯»ï¼Ÿ"></a>å¦‚ä½•é¿å…å¹»è¯»ï¼Ÿ</h5><p>ä½¿ç”¨é—´éš™é”çš„æ–¹å¼æ¥é¿å…å‡ºç°å¹»è¯»ã€‚é—´éš™é”ï¼Œæ˜¯ä¸“é—¨ç”¨äºè§£å†³å¹»è¯»è¿™ç§é—®é¢˜çš„é”ï¼Œå®ƒé”çš„äº†è¡Œä¸è¡Œä¹‹é—´çš„é—´éš™ï¼Œèƒ½å¤Ÿé˜»å¡æ–°æ’å…¥çš„æ“ä½œ é—´éš™é”çš„å¼•å…¥ä¹Ÿå¸¦æ¥äº†ä¸€äº›æ–°çš„é—®é¢˜ï¼Œæ¯”å¦‚ï¼šé™ä½å¹¶å‘åº¦ï¼Œå¯èƒ½å¯¼è‡´æ­»é”ã€‚</p><h5 id="å¦‚ä½•æŸ¥çœ‹-MySQL-çš„ç©ºé—²è¿æ¥ï¼Ÿ"><a href="#å¦‚ä½•æŸ¥çœ‹-MySQL-çš„ç©ºé—²è¿æ¥ï¼Ÿ" class="headerlink" title="å¦‚ä½•æŸ¥çœ‹ MySQL çš„ç©ºé—²è¿æ¥ï¼Ÿ"></a>å¦‚ä½•æŸ¥çœ‹ MySQL çš„ç©ºé—²è¿æ¥ï¼Ÿ</h5><p>åœ¨ MySQL çš„å‘½ä»¤è¡Œä¸­ä½¿ç”¨ show processlist; æŸ¥çœ‹æ‰€æœ‰è¿æ¥ï¼Œå…¶ä¸­ Command åˆ—æ˜¾ç¤ºä¸º Sleep çš„è¡¨ç¤ºç©ºé—²è¿æ¥ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="/images/mysql/processlist.png"></p><h5 id="MySQL-ä¸­çš„å­—ç¬¦ä¸²ç±»å‹éƒ½æœ‰å“ªäº›ï¼Ÿ"><a href="#MySQL-ä¸­çš„å­—ç¬¦ä¸²ç±»å‹éƒ½æœ‰å“ªäº›ï¼Ÿ" class="headerlink" title="MySQL ä¸­çš„å­—ç¬¦ä¸²ç±»å‹éƒ½æœ‰å“ªäº›ï¼Ÿ"></a>MySQL ä¸­çš„å­—ç¬¦ä¸²ç±»å‹éƒ½æœ‰å“ªäº›ï¼Ÿ</h5><p>MySQL çš„å­—ç¬¦ä¸²ç±»å‹å’Œå–å€¼å¦‚ä¸‹ï¼š</p><table><thead><tr><th><strong>ç±»å‹</strong></th><th><strong>å–å€¼èŒƒå›´</strong></th></tr></thead><tbody><tr><td>CHAR(N)</td><td>0~255</td></tr><tr><td>VARCHAR(N)</td><td>0~65536</td></tr><tr><td>TINYBLOB</td><td>0~255</td></tr><tr><td>BLOB</td><td>0~65535</td></tr><tr><td>MEDUIMBLOB</td><td>0~167772150</td></tr><tr><td>LONGBLOB</td><td>0~4294967295</td></tr><tr><td>TINYTEXT</td><td>0~255</td></tr><tr><td>TEXT</td><td>0~65535</td></tr><tr><td>MEDIUMTEXT</td><td>0~167772150</td></tr><tr><td>LONGTEXT</td><td>0~4294967295</td></tr><tr><td>VARBINARY(N)</td><td>0~Nä¸ªå­—èŠ‚çš„å˜é•¿å­—èŠ‚å­—ç¬¦é›†</td></tr><tr><td>BINARY(N)</td><td>0~Nä¸ªå­—èŠ‚çš„å®šé•¿å­—èŠ‚å­—ç¬¦é›†</td></tr></tbody></table><h5 id="VARCHAR-å’Œ-CHAR-çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿåˆ†åˆ«é€‚ç”¨çš„åœºæ™¯æœ‰å“ªäº›ï¼Ÿ"><a href="#VARCHAR-å’Œ-CHAR-çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿåˆ†åˆ«é€‚ç”¨çš„åœºæ™¯æœ‰å“ªäº›ï¼Ÿ" class="headerlink" title="VARCHAR å’Œ CHAR çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿåˆ†åˆ«é€‚ç”¨çš„åœºæ™¯æœ‰å“ªäº›ï¼Ÿ"></a>VARCHAR å’Œ CHAR çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿåˆ†åˆ«é€‚ç”¨çš„åœºæ™¯æœ‰å“ªäº›ï¼Ÿ</h5><p>VARCHAR å’Œ CHAR æœ€å¤§åŒºåˆ«å°±æ˜¯ï¼ŒVARCHAR çš„é•¿åº¦æ˜¯å¯å˜çš„ï¼Œè€Œ CHAR æ˜¯å›ºå®šé•¿åº¦ï¼ŒCHAR çš„å–å€¼èŒƒå›´ä¸º1-255ï¼Œå› æ­¤ VARCHAR å¯èƒ½ä¼šé€ æˆå­˜å‚¨ç¢ç‰‡ã€‚ç”±äºå®ƒä»¬çš„ç‰¹æ€§å†³å®šäº† CHAR æ¯”è¾ƒé€‚åˆé•¿åº¦è¾ƒçŸ­çš„å­—æ®µå’Œå›ºå®šé•¿åº¦çš„å­—æ®µï¼Œå¦‚èº«ä»½è¯å·ã€æ‰‹æœºå·ç­‰ï¼Œåä¹‹åˆ™é€‚åˆä½¿ç”¨ VARCHARã€‚</p><h5 id="MySQL-å­˜å‚¨é‡‘é¢åº”è¯¥ä½¿ç”¨å“ªç§æ•°æ®ç±»å‹ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ"><a href="#MySQL-å­˜å‚¨é‡‘é¢åº”è¯¥ä½¿ç”¨å“ªç§æ•°æ®ç±»å‹ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ" class="headerlink" title="MySQL å­˜å‚¨é‡‘é¢åº”è¯¥ä½¿ç”¨å“ªç§æ•°æ®ç±»å‹ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ"></a>MySQL å­˜å‚¨é‡‘é¢åº”è¯¥ä½¿ç”¨å“ªç§æ•°æ®ç±»å‹ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</h5><p>MySQL å­˜å‚¨é‡‘é¢åº”è¯¥ä½¿ç”¨ decimal ï¼Œå› ä¸ºå¦‚æœå­˜å‚¨å…¶ä»–æ•°æ®ç±»å‹ï¼Œæ¯”å¦‚ float æœ‰å¯¼è‡´å°æ•°ç‚¹åæ•°æ®ä¸¢å¤±çš„é£é™©ã€‚</p><h5 id="limit-3-2-çš„å«ä¹‰æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#limit-3-2-çš„å«ä¹‰æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="limit 3,2 çš„å«ä¹‰æ˜¯ä»€ä¹ˆï¼Ÿ"></a>limit 3,2 çš„å«ä¹‰æ˜¯ä»€ä¹ˆï¼Ÿ</h5><p>å»é™¤å‰ä¸‰æ¡æ•°æ®ä¹‹åæŸ¥è¯¢ä¸¤æ¡ä¿¡æ¯ã€‚</p><h5 id="now-å’Œ-current-date-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"><a href="#now-å’Œ-current-date-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ" class="headerlink" title="now() å’Œ current_date() æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"></a>now() å’Œ current_date() æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h5><p>now() è¿”å›å½“å‰æ—¶é—´åŒ…å«æ—¥æœŸå’Œæ—¶åˆ†ç§’ï¼Œcurrent_date() åªè¿”å›å½“å‰æ—¶é—´ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p> <img src="/images/mysql/cur.png"></p><h5 id="å¦‚ä½•å»é‡è®¡ç®—æ€»æ¡æ•°ï¼Ÿ"><a href="#å¦‚ä½•å»é‡è®¡ç®—æ€»æ¡æ•°ï¼Ÿ" class="headerlink" title="å¦‚ä½•å»é‡è®¡ç®—æ€»æ¡æ•°ï¼Ÿ"></a>å¦‚ä½•å»é‡è®¡ç®—æ€»æ¡æ•°ï¼Ÿ</h5><p>ä½¿ç”¨ distinct å»é‡ï¼Œä½¿ç”¨ count ç»Ÿè®¡æ€»æ¡æ•°ï¼Œå…·ä½“å®ç°è„šæœ¬å¦‚ä¸‹ï¼š</p><pre><code class="hljs mysql">select count(distinct f) from t;</code></pre><h5 id="lastinsertid-å‡½æ•°åŠŸèƒ½æ˜¯ä»€ä¹ˆï¼Ÿæœ‰ä»€ä¹ˆç‰¹ç‚¹ï¼Ÿ"><a href="#lastinsertid-å‡½æ•°åŠŸèƒ½æ˜¯ä»€ä¹ˆï¼Ÿæœ‰ä»€ä¹ˆç‰¹ç‚¹ï¼Ÿ" class="headerlink" title="lastinsertid() å‡½æ•°åŠŸèƒ½æ˜¯ä»€ä¹ˆï¼Ÿæœ‰ä»€ä¹ˆç‰¹ç‚¹ï¼Ÿ"></a>lastinsertid() å‡½æ•°åŠŸèƒ½æ˜¯ä»€ä¹ˆï¼Ÿæœ‰ä»€ä¹ˆç‰¹ç‚¹ï¼Ÿ</h5><p>lastinsertid() ç”¨äºæŸ¥è¯¢æœ€åä¸€æ¬¡è‡ªå¢è¡¨çš„ç¼–å·ï¼Œå®ƒçš„ç‰¹ç‚¹æ˜¯æŸ¥è¯¢æ—¶ä¸éœ€è¦ä¸éœ€è¦æŒ‡å®šè¡¨åï¼Œä½¿ç”¨ select last_insert_id() å³å¯æŸ¥è¯¢ï¼Œå› ä¸ºä¸éœ€è¦æŒ‡å®šè¡¨åæ‰€ä»¥å®ƒå§‹ç»ˆä»¥æœ€åä¸€æ¡è‡ªå¢ç¼–å·ä¸ºä¸»ï¼Œå¯ä»¥è¢«å…¶å®ƒè¡¨çš„è‡ªå¢ç¼–å·è¦†ç›–ã€‚æ¯”å¦‚ A è¡¨çš„æœ€å¤§ç¼–å·æ˜¯ 10ï¼Œlastinsertid() æŸ¥è¯¢å‡ºæ¥çš„å€¼ä¸º 10ï¼Œè¿™æ—¶ B è¡¨æ’å…¥äº†ä¸€æ¡æ•°æ®ï¼Œå®ƒçš„æœ€å¤§ç¼–å·ä¸º 3ï¼Œè¿™ä¸ªæ—¶å€™ä½¿ç”¨ lastinsertid() æŸ¥è¯¢çš„å€¼å°±æ˜¯ 3ã€‚</p><h5 id="åˆ é™¤è¡¨çš„æ•°æ®æœ‰å‡ ç§æ–¹å¼ï¼Ÿå®ƒä»¬æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"><a href="#åˆ é™¤è¡¨çš„æ•°æ®æœ‰å‡ ç§æ–¹å¼ï¼Ÿå®ƒä»¬æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ" class="headerlink" title="åˆ é™¤è¡¨çš„æ•°æ®æœ‰å‡ ç§æ–¹å¼ï¼Ÿå®ƒä»¬æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"></a>åˆ é™¤è¡¨çš„æ•°æ®æœ‰å‡ ç§æ–¹å¼ï¼Ÿå®ƒä»¬æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h5><p>åˆ é™¤æ•°æ®æœ‰ä¸¤ç§æ–¹å¼ï¼šdelete å’Œ truncateï¼Œå®ƒä»¬çš„åŒºåˆ«å¦‚ä¸‹ï¼š</p><ul><li><p>delete å¯ä»¥æ·»åŠ  where æ¡ä»¶åˆ é™¤éƒ¨åˆ†æ•°æ®ï¼Œtruncate ä¸èƒ½æ·»åŠ  where æ¡ä»¶åªèƒ½åˆ é™¤æ•´å¼ è¡¨ï¼›</p></li><li><p>delete çš„åˆ é™¤ä¿¡æ¯ä¼šåœ¨ MySQL çš„æ—¥å¿—ä¸­è®°å½•ï¼Œè€Œ truncate çš„åˆ é™¤ä¿¡æ¯ä¸è¢«è®°å½•åœ¨ MySQL çš„æ—¥å¿—ä¸­ï¼Œå› æ­¤ detele çš„ä¿¡æ¯å¯ä»¥è¢«æ‰¾å›è€Œ truncate çš„ä¿¡æ¯æ— æ³•è¢«æ‰¾å›ï¼›</p></li><li><p>truncate å› ä¸ºä¸è®°å½•æ—¥å¿—æ‰€ä»¥æ‰§è¡Œæ•ˆç‡æ¯” delete å¿«ã€‚</p></li></ul><p>delete å’Œ truncate çš„ä½¿ç”¨è„šæœ¬å¦‚ä¸‹ï¼š</p><pre><code class="hljs mysql">delete from t where username&#x3D;&#39;redis&#39;; truncate table t;</code></pre><h5 id="MySQL-ä¸­æ”¯æŒå‡ ç§æ¨¡ç³ŠæŸ¥è¯¢ï¼Ÿå®ƒä»¬æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"><a href="#MySQL-ä¸­æ”¯æŒå‡ ç§æ¨¡ç³ŠæŸ¥è¯¢ï¼Ÿå®ƒä»¬æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ" class="headerlink" title="MySQL ä¸­æ”¯æŒå‡ ç§æ¨¡ç³ŠæŸ¥è¯¢ï¼Ÿå®ƒä»¬æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"></a>MySQL ä¸­æ”¯æŒå‡ ç§æ¨¡ç³ŠæŸ¥è¯¢ï¼Ÿå®ƒä»¬æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h5><p>MySQL ä¸­æ”¯æŒä¸¤ç§æ¨¡ç³ŠæŸ¥è¯¢ï¼šregexp å’Œ likeï¼Œlike æ˜¯å¯¹ä»»æ„å¤šå­—ç¬¦åŒ¹é…æˆ–ä»»æ„å•å­—ç¬¦è¿›è¡Œæ¨¡ç³ŠåŒ¹é…ï¼Œè€Œ regexp åˆ™æ”¯æŒæ­£åˆ™è¡¨è¾¾å¼çš„åŒ¹é…æ–¹å¼ï¼Œæä¾›æ¯” like æ›´å¤šçš„åŒ¹é…æ–¹å¼ã€‚</p><p>regexp å’Œ like çš„ä½¿ç”¨ç¤ºä¾‹å¦‚ä¸‹ï¼š </p><pre><code class="hljs mysql">select * from person where uname like &#39;%SQL%&#39;; select  from person where uname regexp &#39;.SQL*.&#39;;</code></pre><h5 id="MySQL-æ”¯æŒæšä¸¾å—ï¼Ÿå¦‚ä½•å®ç°ï¼Ÿå®ƒçš„ç”¨é€”æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#MySQL-æ”¯æŒæšä¸¾å—ï¼Ÿå¦‚ä½•å®ç°ï¼Ÿå®ƒçš„ç”¨é€”æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="MySQL æ”¯æŒæšä¸¾å—ï¼Ÿå¦‚ä½•å®ç°ï¼Ÿå®ƒçš„ç”¨é€”æ˜¯ä»€ä¹ˆï¼Ÿ"></a>MySQL æ”¯æŒæšä¸¾å—ï¼Ÿå¦‚ä½•å®ç°ï¼Ÿå®ƒçš„ç”¨é€”æ˜¯ä»€ä¹ˆï¼Ÿ</h5><p>MySQL æ”¯æŒæšä¸¾ï¼Œå®ƒçš„å®ç°æ–¹å¼å¦‚ä¸‹ï¼š</p><pre><code class="hljs mysql">create table t(     sex enum(&#39;boy&#39;,&#39;grid&#39;) default &#39;unknown&#39; );</code></pre><p>æšä¸¾çš„ä½œç”¨æ˜¯é¢„å®šä¹‰ç»“æœå€¼ï¼Œå½“æ’å…¥æ•°æ®ä¸åœ¨æšä¸¾å€¼èŒƒå›´å†…ï¼Œåˆ™æ’å…¥å¤±è´¥ï¼Œæç¤ºé”™è¯¯ Data truncated for column â€˜xxxâ€™ at row n ã€‚</p><h5 id="count-column-å’Œ-count-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"><a href="#count-column-å’Œ-count-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ" class="headerlink" title="count(column) å’Œ count(*) æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"></a>count(column) å’Œ count(*) æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h5><p>count(column) å’Œ count() æœ€å¤§åŒºåˆ«æ˜¯ç»Ÿè®¡ç»“æœå¯èƒ½ä¸ä¸€è‡´ï¼Œcount(column) ç»Ÿè®¡ä¸ä¼šç»Ÿè®¡åˆ—å€¼ä¸º null çš„æ•°æ®ï¼Œè€Œ count() åˆ™ä¼šç»Ÿè®¡æ‰€æœ‰ä¿¡æ¯ï¼Œæ‰€ä»¥æœ€ç»ˆçš„ç»Ÿè®¡ç»“æœå¯èƒ½ä¼šä¸åŒã€‚</p><h5 id="ä»¥ä¸‹å…³äº-count-è¯´æ³•æ­£ç¡®çš„æ˜¯ï¼Ÿ"><a href="#ä»¥ä¸‹å…³äº-count-è¯´æ³•æ­£ç¡®çš„æ˜¯ï¼Ÿ" class="headerlink" title="ä»¥ä¸‹å…³äº count è¯´æ³•æ­£ç¡®çš„æ˜¯ï¼Ÿ"></a>ä»¥ä¸‹å…³äº count è¯´æ³•æ­£ç¡®çš„æ˜¯ï¼Ÿ</h5><p>A. count çš„æŸ¥è¯¢æ€§èƒ½åœ¨å„ç§å­˜å‚¨å¼•æ“ä¸‹çš„æ€§èƒ½éƒ½æ˜¯ä¸€æ ·çš„ã€‚</p><p>B. count åœ¨ MyISAM æ¯” InnoDB çš„æ€§èƒ½è¦ä½ã€‚ </p><p>C. count åœ¨ InnoDB ä¸­æ˜¯ä¸€è¡Œä¸€è¡Œè¯»å–ï¼Œç„¶åç´¯è®¡è®¡æ•°çš„ã€‚ </p><p>D. count åœ¨ InnoDB ä¸­å­˜å‚¨äº†æ€»æ¡æ•°ï¼ŒæŸ¥è¯¢çš„æ—¶å€™ç›´æ¥å–å‡ºã€‚</p><p>ç­”ï¼šC</p><h5 id="ä¸ºä»€ä¹ˆ-InnoDB-ä¸æŠŠæ€»æ¡æ•°è®°å½•ä¸‹æ¥ï¼ŒæŸ¥è¯¢çš„æ—¶å€™ç›´æ¥è¿”å›å‘¢ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆ-InnoDB-ä¸æŠŠæ€»æ¡æ•°è®°å½•ä¸‹æ¥ï¼ŒæŸ¥è¯¢çš„æ—¶å€™ç›´æ¥è¿”å›å‘¢ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆ InnoDB ä¸æŠŠæ€»æ¡æ•°è®°å½•ä¸‹æ¥ï¼ŒæŸ¥è¯¢çš„æ—¶å€™ç›´æ¥è¿”å›å‘¢ï¼Ÿ"></a>ä¸ºä»€ä¹ˆ InnoDB ä¸æŠŠæ€»æ¡æ•°è®°å½•ä¸‹æ¥ï¼ŒæŸ¥è¯¢çš„æ—¶å€™ç›´æ¥è¿”å›å‘¢ï¼Ÿ</h5><p>å› ä¸º InnoDB ä½¿ç”¨äº†äº‹åŠ¡å®ç°ï¼Œè€Œäº‹åŠ¡çš„è®¾è®¡ä½¿ç”¨äº†å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼Œå³ä½¿æ˜¯åœ¨åŒä¸€æ—¶é—´è¿›è¡ŒæŸ¥è¯¢ï¼Œå¾—åˆ°çš„ç»“æœä¹Ÿå¯èƒ½ä¸ç›¸åŒï¼Œæ‰€ä»¥ InnoDB ä¸èƒ½æŠŠç»“æœç›´æ¥ä¿å­˜ä¸‹æ¥ï¼Œå› ä¸ºè¿™æ ·æ˜¯ä¸å‡†ç¡®çš„ã€‚</p><h5 id="èƒ½å¦ä½¿ç”¨-show-table-status-ä¸­çš„è¡¨è¡Œæ•°ä½œä¸ºè¡¨çš„æ€»è¡Œæ•°ç›´æ¥ä½¿ç”¨ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ"><a href="#èƒ½å¦ä½¿ç”¨-show-table-status-ä¸­çš„è¡¨è¡Œæ•°ä½œä¸ºè¡¨çš„æ€»è¡Œæ•°ç›´æ¥ä½¿ç”¨ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ" class="headerlink" title="èƒ½å¦ä½¿ç”¨ show table status ä¸­çš„è¡¨è¡Œæ•°ä½œä¸ºè¡¨çš„æ€»è¡Œæ•°ç›´æ¥ä½¿ç”¨ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ"></a>èƒ½å¦ä½¿ç”¨ show table status ä¸­çš„è¡¨è¡Œæ•°ä½œä¸ºè¡¨çš„æ€»è¡Œæ•°ç›´æ¥ä½¿ç”¨ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</h5><p>ä¸èƒ½ï¼Œå› ä¸º show table status æ˜¯é€šè¿‡é‡‡æ ·ç»Ÿè®¡ä¼°ç®—å‡ºæ¥çš„ï¼Œå®˜æ–¹æ–‡æ¡£è¯´è¯¯å·®å¯èƒ½åœ¨ 40% å·¦å³ï¼Œæ‰€ä»¥ show table status ä¸­çš„è¡¨è¡Œæ•°ä¸èƒ½ç›´æ¥ä½¿ç”¨ã€‚</p><h5 id="ä»¥ä¸‹å“ªä¸ª-SQL-çš„æŸ¥è¯¢æ€§èƒ½æœ€é«˜ï¼Ÿ"><a href="#ä»¥ä¸‹å“ªä¸ª-SQL-çš„æŸ¥è¯¢æ€§èƒ½æœ€é«˜ï¼Ÿ" class="headerlink" title="ä»¥ä¸‹å“ªä¸ª SQL çš„æŸ¥è¯¢æ€§èƒ½æœ€é«˜ï¼Ÿ"></a>ä»¥ä¸‹å“ªä¸ª SQL çš„æŸ¥è¯¢æ€§èƒ½æœ€é«˜ï¼Ÿ</h5><p>A. select count(*) from t where time&gt;1000 and time&lt;4500 </p><p>B. show table status where name=â€™tâ€™ </p><p>C. select count(id) from t where time&gt;1000 and time&lt;4500 </p><p>D. select count(name) from t where time&gt;1000 and time&lt;4500</p><p>ç­”ï¼šB é¢˜ç›®è§£æï¼šå› ä¸º show table status çš„è¡¨è¡Œæ•°æ˜¯ä¼°ç®—å‡ºæ¥ï¼Œè€Œå…¶ä»–çš„æŸ¥è¯¢å› ä¸ºæ·»åŠ äº† where æ¡ä»¶ï¼Œå³ä½¿æ˜¯ MyISAM å¼•æ“ä¹Ÿä¸èƒ½ç›´æ¥ä½¿ç”¨å·²ç»å­˜å‚¨çš„æ€»æ¡æ•°ï¼Œæ‰€ä»¥ show table status çš„æŸ¥è¯¢æ€§èƒ½æœ€é«˜ã€‚</p><h5 id="InnoDB-å’Œ-MyISAM-æ‰§è¡Œ-select-count-from-tï¼Œå“ªä¸ªæ•ˆç‡æ›´é«˜ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ"><a href="#InnoDB-å’Œ-MyISAM-æ‰§è¡Œ-select-count-from-tï¼Œå“ªä¸ªæ•ˆç‡æ›´é«˜ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ" class="headerlink" title="InnoDB å’Œ MyISAM æ‰§è¡Œ select count(*) from tï¼Œå“ªä¸ªæ•ˆç‡æ›´é«˜ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ"></a>InnoDB å’Œ MyISAM æ‰§è¡Œ select count(*) from tï¼Œå“ªä¸ªæ•ˆç‡æ›´é«˜ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</h5><p>MyISAM æ•ˆç‡æœ€é«˜ï¼Œå› ä¸º MyISAM å†…éƒ¨ç»´æŠ¤äº†ä¸€ä¸ªè®¡æ•°å™¨ï¼Œç›´æ¥è¿”å›æ€»æ¡æ•°ï¼Œè€Œ InnoDB è¦é€è¡Œç»Ÿè®¡ã€‚</p><h5 id="åœ¨-MySQL-ä¸­æœ‰å¯¹-count-åšä¼˜åŒ–å—ï¼Ÿåšäº†å“ªäº›ä¼˜åŒ–ï¼Ÿ"><a href="#åœ¨-MySQL-ä¸­æœ‰å¯¹-count-åšä¼˜åŒ–å—ï¼Ÿåšäº†å“ªäº›ä¼˜åŒ–ï¼Ÿ" class="headerlink" title="åœ¨ MySQL ä¸­æœ‰å¯¹ count(*) åšä¼˜åŒ–å—ï¼Ÿåšäº†å“ªäº›ä¼˜åŒ–ï¼Ÿ"></a>åœ¨ MySQL ä¸­æœ‰å¯¹ count(*) åšä¼˜åŒ–å—ï¼Ÿåšäº†å“ªäº›ä¼˜åŒ–ï¼Ÿ</h5><p>count(*) åœ¨ä¸åŒçš„ MySQL å¼•æ“ä¸­çš„å®ç°æ–¹å¼æ˜¯ä¸ç›¸åŒçš„ï¼Œåœ¨æ²¡æœ‰ where æ¡ä»¶çš„æƒ…å†µä¸‹ï¼š</p><ul><li><p>MyISAM å¼•æ“ä¼šæŠŠè¡¨çš„æ€»è¡Œæ•°å­˜å‚¨åœ¨ç£ç›˜ä¸Šï¼Œå› æ­¤åœ¨æ‰§è¡Œ count(*) çš„æ—¶å€™ä¼šç›´æ¥è¿”å›è¿™ä¸ªè¿™ä¸ªè¡Œæ•°ï¼Œæ‰§è¡Œæ•ˆç‡å¾ˆé«˜ï¼›</p></li><li><p>InnoDB å¼•æ“ä¸­ count(*) å°±æ¯”è¾ƒéº»çƒ¦äº†ï¼Œéœ€è¦æŠŠæ•°æ®ä¸€è¡Œä¸€è¡Œçš„ä»å¼•æ“ä¸­è¯»å‡ºæ¥ï¼Œç„¶åç´¯è®¡åŸºæ•°ã€‚</p></li></ul><p>ä½†å³ä½¿è¿™æ ·ï¼Œåœ¨ InnoDB ä¸­ï¼ŒMySQL è¿˜æ˜¯åšäº†ä¼˜åŒ–çš„ï¼Œæˆ‘ä»¬çŸ¥é“å¯¹äº count() è¿™æ ·çš„æ“ä½œï¼Œéå†ä»»æ„ç´¢å¼•æ ‘å¾—åˆ°çš„ç»“æœï¼Œåœ¨é€»è¾‘ä¸Šéƒ½æ˜¯ä¸€æ ·çš„ï¼Œå› æ­¤ï¼ŒMySQL ä¼˜åŒ–å™¨ä¼šæ‰¾åˆ°æœ€å°çš„é‚£é¢—ç´¢å¼•æ ‘æ¥éå†ï¼Œè¿™æ ·å°±èƒ½åœ¨ä¿è¯é€»è¾‘æ­£ç¡®çš„å‰æä¸‹ï¼Œå°½é‡å°‘æ‰«ææ•°æ®é‡ï¼Œä»è€Œä¼˜åŒ–äº† count() çš„æ‰§è¡Œæ•ˆç‡ã€‚</p><h5 id="åœ¨-InnoDB-å¼•æ“ä¸­-count-ã€count-1-ã€count-ä¸»é”®-ã€count-å­—æ®µ-å“ªä¸ªæ€§èƒ½æœ€é«˜ï¼Ÿ"><a href="#åœ¨-InnoDB-å¼•æ“ä¸­-count-ã€count-1-ã€count-ä¸»é”®-ã€count-å­—æ®µ-å“ªä¸ªæ€§èƒ½æœ€é«˜ï¼Ÿ" class="headerlink" title="åœ¨ InnoDB å¼•æ“ä¸­ count(*)ã€count(1)ã€count(ä¸»é”®)ã€count(å­—æ®µ) å“ªä¸ªæ€§èƒ½æœ€é«˜ï¼Ÿ"></a>åœ¨ InnoDB å¼•æ“ä¸­ count(*)ã€count(1)ã€count(ä¸»é”®)ã€count(å­—æ®µ) å“ªä¸ªæ€§èƒ½æœ€é«˜ï¼Ÿ</h5><p>count(å­—æ®µ)&lt;count(ä¸»é”® id)&lt;count(1)â‰ˆcount(*) é¢˜ç›®è§£æï¼š</p><ul><li><p>å¯¹äº count(ä¸»é”® id) æ¥è¯´ï¼ŒInnoDB å¼•æ“ä¼šéå†æ•´å¼ è¡¨ï¼ŒæŠŠæ¯ä¸€è¡Œçš„ id å€¼éƒ½å–å‡ºæ¥ï¼Œè¿”å›ç»™ server å±‚ã€‚server å±‚æ‹¿åˆ° id åï¼Œåˆ¤æ–­æ˜¯ä¸å¯èƒ½ä¸ºç©ºçš„ï¼Œå°±æŒ‰è¡Œç´¯åŠ ã€‚</p></li><li><p>å¯¹äº count(1) æ¥è¯´ï¼ŒInnoDB å¼•æ“éå†æ•´å¼ è¡¨ï¼Œä½†ä¸å–å€¼ã€‚server å±‚å¯¹äºè¿”å›çš„æ¯ä¸€è¡Œï¼Œæ”¾ä¸€ä¸ªæ•°å­—â€œ1â€è¿›å»ï¼Œåˆ¤æ–­æ˜¯ä¸å¯èƒ½ä¸ºç©ºçš„ï¼ŒæŒ‰è¡Œç´¯åŠ ã€‚</p></li><li><p>å¯¹äº count(å­—æ®µ) æ¥è¯´ï¼Œå¦‚æœè¿™ä¸ªâ€œå­—æ®µâ€æ˜¯å®šä¹‰ä¸º not null çš„è¯ï¼Œä¸€è¡Œè¡Œåœ°ä»è®°å½•é‡Œé¢è¯»å‡ºè¿™ä¸ªå­—æ®µï¼Œåˆ¤æ–­ä¸èƒ½ä¸º nullï¼ŒæŒ‰è¡Œç´¯åŠ ï¼›å¦‚æœè¿™ä¸ªâ€œå­—æ®µâ€å®šä¹‰å…è®¸ä¸º nullï¼Œé‚£ä¹ˆæ‰§è¡Œçš„æ—¶å€™ï¼Œåˆ¤æ–­åˆ°æœ‰å¯èƒ½æ˜¯ nullï¼Œè¿˜è¦æŠŠå€¼å–å‡ºæ¥å†åˆ¤æ–­ä¸€ä¸‹ï¼Œä¸æ˜¯ null æ‰ç´¯åŠ ã€‚</p></li><li><p>å¯¹äº count(*) æ¥è¯´ï¼Œå¹¶ä¸ä¼šæŠŠå…¨éƒ¨å­—æ®µå–å‡ºæ¥ï¼Œè€Œæ˜¯ä¸“é—¨åšäº†ä¼˜åŒ–ï¼Œä¸å–å€¼ï¼Œç›´æ¥æŒ‰è¡Œç´¯åŠ ã€‚</p></li></ul><p>æ‰€ä»¥æœ€åå¾—å‡ºçš„ç»“æœæ˜¯ï¼šcount(å­—æ®µ)&lt;count(ä¸»é”® id)&lt;count(1)â‰ˆcount(*)ã€‚</p><h5 id="MySQL-ä¸­å†…è¿æ¥ã€å·¦è¿æ¥ã€å³è¿æ¥æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"><a href="#MySQL-ä¸­å†…è¿æ¥ã€å·¦è¿æ¥ã€å³è¿æ¥æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ" class="headerlink" title="MySQL ä¸­å†…è¿æ¥ã€å·¦è¿æ¥ã€å³è¿æ¥æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"></a>MySQL ä¸­å†…è¿æ¥ã€å·¦è¿æ¥ã€å³è¿æ¥æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h5><ul><li><p>å†…è¿ï¼ˆinner joinï¼‰â€” æŠŠåŒ¹é…çš„å…³è”æ•°æ®æ˜¾ç¤ºå‡ºæ¥ï¼›</p></li><li><p>å·¦è¿æ¥ï¼ˆleft joinï¼‰â€” æŠŠå·¦è¾¹çš„è¡¨å…¨éƒ¨æ˜¾ç¤ºå‡ºæ¥ï¼Œå³è¾¹çš„è¡¨æ˜¾ç¤ºå‡ºç¬¦åˆæ¡ä»¶çš„æ•°æ®ï¼›</p></li><li><p>å³è¿æ¥ï¼ˆright joinï¼‰â€” æŠŠå³è¾¹çš„è¡¨å…¨éƒ¨æ˜¾ç¤ºå‡ºæ¥ï¼Œå·¦è¾¹çš„è¡¨æ˜¾ç¤ºå‡ºç¬¦åˆæ¡ä»¶çš„æ•°æ®ï¼›</p></li></ul><h5 id="ä»€ä¹ˆæ˜¯è§†å›¾ï¼Ÿå¦‚ä½•åˆ›å»ºè§†å›¾ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯è§†å›¾ï¼Ÿå¦‚ä½•åˆ›å»ºè§†å›¾ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯è§†å›¾ï¼Ÿå¦‚ä½•åˆ›å»ºè§†å›¾ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯è§†å›¾ï¼Ÿå¦‚ä½•åˆ›å»ºè§†å›¾ï¼Ÿ</h5><p>è§†å›¾æ˜¯ä¸€ç§è™šæ‹Ÿçš„è¡¨ï¼Œå…·æœ‰å’Œç‰©ç†è¡¨ç›¸åŒçš„åŠŸèƒ½ï¼Œå¯ä»¥å¯¹è§†å›¾è¿›è¡Œå¢ã€æ”¹ã€æŸ¥æ“ä½œã€‚è§†å›¾é€šå¸¸æ˜¯ä¸€ä¸ªè¡¨æˆ–è€…å¤šä¸ªè¡¨çš„è¡Œæˆ–åˆ—çš„å­é›†ã€‚ è§†å›¾åˆ›å»ºè„šæœ¬å¦‚ä¸‹ï¼š</p><pre><code class="hljs mysql">create view vname as select column_names from table_name where condition;</code></pre><h5 id="è§†å›¾æœ‰å“ªäº›ä¼˜ç‚¹ï¼Ÿ"><a href="#è§†å›¾æœ‰å“ªäº›ä¼˜ç‚¹ï¼Ÿ" class="headerlink" title="è§†å›¾æœ‰å“ªäº›ä¼˜ç‚¹ï¼Ÿ"></a>è§†å›¾æœ‰å“ªäº›ä¼˜ç‚¹ï¼Ÿ</h5><ul><li><p>è·å–æ•°æ®æ›´å®¹æ˜“ï¼Œç›¸å¯¹äºå¤šè¡¨æŸ¥è¯¢æ¥è¯´ï¼›</p></li><li><p>è§†å›¾èƒ½å¤Ÿå¯¹æœºå¯†æ•°æ®æä¾›å®‰å…¨ä¿æŠ¤ï¼›</p></li><li><p>è§†å›¾çš„ä¿®æ”¹ä¸ä¼šå½±å“åŸºæœ¬è¡¨ï¼Œæä¾›äº†ç‹¬ç«‹çš„æ“ä½œå•å…ƒï¼Œæ¯”è¾ƒè½»é‡ã€‚</p></li></ul><h5 id="MySQL-ä¸­â€œè§†å›¾â€çš„æ¦‚å¿µæœ‰å‡ ä¸ªï¼Ÿåˆ†åˆ«ä»£è¡¨ä»€ä¹ˆå«ä¹‰ï¼Ÿ"><a href="#MySQL-ä¸­â€œè§†å›¾â€çš„æ¦‚å¿µæœ‰å‡ ä¸ªï¼Ÿåˆ†åˆ«ä»£è¡¨ä»€ä¹ˆå«ä¹‰ï¼Ÿ" class="headerlink" title="MySQL ä¸­â€œè§†å›¾â€çš„æ¦‚å¿µæœ‰å‡ ä¸ªï¼Ÿåˆ†åˆ«ä»£è¡¨ä»€ä¹ˆå«ä¹‰ï¼Ÿ"></a>MySQL ä¸­â€œè§†å›¾â€çš„æ¦‚å¿µæœ‰å‡ ä¸ªï¼Ÿåˆ†åˆ«ä»£è¡¨ä»€ä¹ˆå«ä¹‰ï¼Ÿ</h5><p>MySQL ä¸­çš„â€œè§†å›¾â€æ¦‚å¿µæœ‰ä¸¤ä¸ªï¼Œå®ƒä»¬åˆ†åˆ«æ˜¯ï¼š</p><ul><li><p>MySQL ä¸­çš„æ™®é€šè§†å›¾ä¹Ÿæ˜¯æˆ‘ä»¬æœ€å¸¸ç”¨çš„ viewï¼Œåˆ›å»ºè¯­æ³•æ˜¯ create view â€¦,å®ƒçš„æŸ¥è¯¢å’Œæ™®é€šè¡¨ä¸€æ ·ï¼›</p></li><li><p>InnoDB å®ç° MVCCï¼ˆMulti-Version Concurrency Controlï¼‰å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶æ—¶ç”¨åˆ°çš„ä¸€è‡´æ€§è¯»è§†å›¾ï¼Œå®ƒæ²¡æœ‰ç‰©ç†ç»“æ„ï¼Œä½œç”¨æ˜¯äº‹åŠ¡æ‰§è¡ŒæœŸé—´å®šäºå¯ä»¥çœ‹åˆ°çš„æ•°æ®ã€‚</p></li></ul><h5 id="ä½¿ç”¨-delete-è¯¯åˆ æ•°æ®æ€ä¹ˆæ‰¾å›ï¼Ÿ"><a href="#ä½¿ç”¨-delete-è¯¯åˆ æ•°æ®æ€ä¹ˆæ‰¾å›ï¼Ÿ" class="headerlink" title="ä½¿ç”¨ delete è¯¯åˆ æ•°æ®æ€ä¹ˆæ‰¾å›ï¼Ÿ"></a>ä½¿ç”¨ delete è¯¯åˆ æ•°æ®æ€ä¹ˆæ‰¾å›ï¼Ÿ</h5><p>å¯ä»¥ç”¨ Flashback å·¥å…·é€šè¿‡é—ªå›æŠŠæ•°æ®æ¢å¤å›æ¥ã€‚</p><h5 id="Flashback-æ¢å¤æ•°æ®çš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#Flashback-æ¢å¤æ•°æ®çš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="Flashback æ¢å¤æ•°æ®çš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ"></a>Flashback æ¢å¤æ•°æ®çš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ</h5><p>Flashback æ¢å¤æ•°æ®çš„åŸç†æ˜¯æ˜¯ä¿®æ”¹ binlog çš„å†…å®¹ï¼Œæ‹¿å›åŸåº“é‡æ”¾ï¼Œä»è€Œå®ç°æ•°æ®æ‰¾å›ã€‚</p><h4 id="MySQL-äº‹åŠ¡"><a href="#MySQL-äº‹åŠ¡" class="headerlink" title="MySQL äº‹åŠ¡"></a>MySQL äº‹åŠ¡</h4><h5 id="äº‹åŠ¡æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#äº‹åŠ¡æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="äº‹åŠ¡æ˜¯ä»€ä¹ˆï¼Ÿ"></a>äº‹åŠ¡æ˜¯ä»€ä¹ˆï¼Ÿ</h5><p>äº‹åŠ¡æ˜¯ä¸€ç³»åˆ—çš„æ•°æ®åº“æ“ä½œï¼Œæ˜¯æ•°æ®åº“åº”ç”¨çš„åŸºæœ¬å•ä½ã€‚MySQL äº‹åŠ¡ä¸»è¦ç”¨äºå¤„ç†æ“ä½œé‡å¤§ï¼Œå¤æ‚åº¦é«˜çš„æ•°æ®ã€‚</p><h5 id="äº‹åŠ¡æœ‰å“ªäº›ç‰¹æ€§ï¼Ÿ"><a href="#äº‹åŠ¡æœ‰å“ªäº›ç‰¹æ€§ï¼Ÿ" class="headerlink" title="äº‹åŠ¡æœ‰å“ªäº›ç‰¹æ€§ï¼Ÿ"></a>äº‹åŠ¡æœ‰å“ªäº›ç‰¹æ€§ï¼Ÿ</h5><p>åœ¨ MySQL ä¸­åªæœ‰ InnDB å¼•æ“æ”¯æŒäº‹åŠ¡ï¼Œå®ƒçš„å››ä¸ªç‰¹æ€§å¦‚ä¸‹ï¼š</p><ul><li><p>åŸå­æ€§ï¼ˆAtomicï¼‰ï¼šè¦ä¹ˆå…¨éƒ¨æ‰§è¡Œï¼Œè¦ä¹ˆå…¨éƒ¨ä¸æ‰§è¡Œï¼›</p></li><li><p>ä¸€è‡´æ€§ï¼ˆConsistencyï¼‰ï¼šäº‹åŠ¡çš„æ‰§è¡Œä½¿å¾—æ•°æ®åº“ä»ä¸€ç§æ­£ç¡®çŠ¶æ€è½¬åŒ–ä¸ºå¦ä¸€ç§æ­£ç¡®çŠ¶æ€ï¼›</p></li><li><p>éš”ç¦»æ€§ï¼ˆIsolationï¼‰ï¼šåœ¨äº‹åŠ¡æ­£ç¡®æäº¤ä¹‹å‰ï¼Œä¸å…è®¸æŠŠè¯¥äº‹åŠ¡å¯¹æ•°æ®çš„ä»»ä½•æ”¹å˜æä¾›ç»™å…¶ä»–äº‹åŠ¡ï¼›</p></li><li><p>æŒä¹…æ€§ï¼ˆDurabilityï¼‰ï¼šäº‹åŠ¡æäº¤åï¼Œå…¶ç»“æœæ°¸ä¹…ä¿å­˜åœ¨æ•°æ®åº“ä¸­ã€‚</p></li></ul><h5 id="MySQL-ä¸­æœ‰å‡ ç§äº‹åŠ¡éš”ç¦»çº§åˆ«ï¼Ÿåˆ†åˆ«æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#MySQL-ä¸­æœ‰å‡ ç§äº‹åŠ¡éš”ç¦»çº§åˆ«ï¼Ÿåˆ†åˆ«æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="MySQL ä¸­æœ‰å‡ ç§äº‹åŠ¡éš”ç¦»çº§åˆ«ï¼Ÿåˆ†åˆ«æ˜¯ä»€ä¹ˆï¼Ÿ"></a>MySQL ä¸­æœ‰å‡ ç§äº‹åŠ¡éš”ç¦»çº§åˆ«ï¼Ÿåˆ†åˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</h5><p>MySQL ä¸­æœ‰å››ç§äº‹åŠ¡éš”ç¦»çº§åˆ«ï¼Œå®ƒä»¬åˆ†åˆ«æ˜¯ï¼š</p><ul><li><p>read uncommitedï¼šæœªæäº¤è¯»ï¼Œè¯»åˆ°æœªæäº¤æ•°æ®ï¼›</p></li><li><p>read committedï¼šè¯»å·²æäº¤ï¼Œä¹Ÿå«ä¸å¯é‡å¤è¯»ï¼Œä¸¤æ¬¡è¯»å–åˆ°çš„æ•°æ®ä¸ä¸€è‡´ï¼›</p></li><li><p>repetable readï¼šå¯é‡å¤è¯»ï¼›</p></li><li><p>serializableï¼šä¸²è¡ŒåŒ–ï¼Œè¯»å†™æ•°æ®éƒ½ä¼šé”ä½æ•´å¼ è¡¨ï¼Œæ•°æ®æ“ä½œä¸ä¼šå‡ºé”™ï¼Œä½†å¹¶å‘æ€§èƒ½æä½ï¼Œå¼€å‘ä¸­å¾ˆå°‘ç”¨åˆ°ã€‚</p></li></ul><p>MySQL é»˜è®¤ä½¿ç”¨ REPEATABLE-READ çš„äº‹åŠ¡éš”ç¦»çº§åˆ«ã€‚</p><h5 id="å¹»è¯»å’Œä¸å¯é‡å¤è¯»çš„åŒºåˆ«ï¼Ÿ"><a href="#å¹»è¯»å’Œä¸å¯é‡å¤è¯»çš„åŒºåˆ«ï¼Ÿ" class="headerlink" title="å¹»è¯»å’Œä¸å¯é‡å¤è¯»çš„åŒºåˆ«ï¼Ÿ"></a>å¹»è¯»å’Œä¸å¯é‡å¤è¯»çš„åŒºåˆ«ï¼Ÿ</h5><ul><li><p>ä¸å¯é‡å¤è¯»çš„é‡ç‚¹æ˜¯ä¿®æ”¹ï¼šåœ¨åŒä¸€äº‹åŠ¡ä¸­ï¼ŒåŒæ ·çš„æ¡ä»¶ï¼Œç¬¬ä¸€æ¬¡è¯»çš„æ•°æ®å’Œç¬¬äºŒæ¬¡è¯»çš„æ•°æ®ä¸ä¸€æ ·ã€‚ï¼ˆå› ä¸ºä¸­é—´æœ‰å…¶ä»–äº‹åŠ¡æäº¤äº†ä¿®æ”¹ï¼‰ã€‚</p></li><li><p>å¹»è¯»çš„é‡ç‚¹åœ¨äºæ–°å¢æˆ–è€…åˆ é™¤ï¼šåœ¨åŒä¸€äº‹åŠ¡ä¸­ï¼ŒåŒæ ·çš„æ¡ä»¶,ï¼Œç¬¬ä¸€æ¬¡å’Œç¬¬äºŒæ¬¡è¯»å‡ºæ¥çš„è®°å½•æ•°ä¸ä¸€æ ·ã€‚ï¼ˆå› ä¸ºä¸­é—´æœ‰å…¶ä»–äº‹åŠ¡æäº¤äº†æ’å…¥/åˆ é™¤ï¼‰ã€‚</p></li></ul><h5 id="å¹¶å‘äº‹åŠ¡ä¸€èˆ¬æœ‰å“ªäº›é—®é¢˜ï¼Ÿ"><a href="#å¹¶å‘äº‹åŠ¡ä¸€èˆ¬æœ‰å“ªäº›é—®é¢˜ï¼Ÿ" class="headerlink" title="å¹¶å‘äº‹åŠ¡ä¸€èˆ¬æœ‰å“ªäº›é—®é¢˜ï¼Ÿ"></a>å¹¶å‘äº‹åŠ¡ä¸€èˆ¬æœ‰å“ªäº›é—®é¢˜ï¼Ÿ</h5><ul><li><p>æ›´æ–°ä¸¢å¤±ï¼ˆLost Updateï¼‰ï¼šå½“ä¸¤ä¸ªæˆ–å¤šä¸ªäº‹åŠ¡é€‰æ‹©åŒä¸€è¡Œï¼Œç„¶ååŸºäºæœ€åˆé€‰å®šçš„å€¼æ›´æ–°è¯¥è¡Œæ—¶ï¼Œç”±äºæ¯ä¸ªäº‹åŠ¡éƒ½ä¸çŸ¥é“å…¶ä»–äº‹åŠ¡çš„å­˜åœ¨ï¼Œå°±ä¼šå‘ç”Ÿä¸¢å¤±æ›´æ–°é—®é¢˜ï¼Œæœ€åçš„æ›´æ–°è¦†ç›–äº†ç”±å…¶ä»–äº‹åŠ¡æ‰€åšçš„æ›´æ–°ã€‚ä¾‹å¦‚ï¼Œä¸¤ä¸ªç¼–è¾‘äººå‘˜åˆ¶ä½œäº†åŒä¸€æ–‡æ¡£çš„ç”µå­å‰¯æœ¬ï¼Œæ¯ä¸ªç¼–è¾‘äººå‘˜ç‹¬ç«‹åœ°æ›´æ”¹å…¶å‰¯æœ¬ï¼Œç„¶åä¿å­˜æ›´æ”¹åçš„å‰¯æœ¬ï¼Œè¿™æ ·å°±è¦†ç›–äº†åŸå§‹æ–‡æ¡£ã€‚ æœ€åä¿å­˜å…¶æ›´æ”¹å‰¯æœ¬çš„ç¼–è¾‘äººå‘˜è¦†ç›–å¦ä¸€ä¸ªç¼–è¾‘äººå‘˜æ‰€åšçš„æ›´æ”¹ï¼Œå¦‚æœåœ¨å‰ä¸€ä¸ªç¼–è¾‘äººå‘˜å®Œæˆå¹¶æäº¤äº‹åŠ¡ä¹‹å‰ï¼Œå¦ä¸€ä¸ªç¼–è¾‘äººå‘˜ä¸èƒ½è®¿é—®åŒä¸€æ–‡ä»¶ï¼Œåˆ™å¯é¿å…æ­¤é—®é¢˜ã€‚</p></li><li><p>è„è¯»ï¼ˆDirty Readsï¼‰ï¼šä¸€ä¸ªäº‹åŠ¡æ­£åœ¨å¯¹ä¸€æ¡è®°å½•åšä¿®æ”¹ï¼Œåœ¨è¿™ä¸ªäº‹åŠ¡å®Œæˆå¹¶æäº¤å‰ï¼Œ è¿™æ¡è®°å½•çš„æ•°æ®å°±å¤„äºä¸ä¸€è‡´çŠ¶æ€ï¼› è¿™æ—¶ï¼Œ å¦ä¸€ä¸ªäº‹åŠ¡ä¹Ÿæ¥è¯»å–åŒä¸€æ¡è®°å½•ï¼Œå¦‚æœä¸åŠ æ§åˆ¶ï¼Œç¬¬äºŒä¸ªäº‹åŠ¡è¯»å–äº†è¿™äº›è„æ•°æ®ï¼Œå¹¶æ®æ­¤åšè¿›ä¸€æ­¥çš„å¤„ç†ï¼Œå°±ä¼šäº§ç”Ÿæœªæäº¤çš„æ•°æ®ä¾èµ–å…³ç³»ï¼Œè¿™ç§ç°è±¡è¢«å½¢è±¡åœ°å«åšè„è¯»ã€‚</p></li><li><p>ä¸å¯é‡å¤è¯»ï¼ˆNon-Repeatable Readsï¼‰ï¼šä¸€ä¸ªäº‹åŠ¡åœ¨è¯»å–æŸäº›æ•°æ®åçš„æŸä¸ªæ—¶é—´ï¼Œå†æ¬¡è¯»å–ä»¥å‰è¯»è¿‡çš„æ•°æ®ï¼Œå´å‘ç°å…¶è¯»å‡ºçš„æ•°æ®å·²ç»å‘ç”Ÿäº†æ”¹å˜ã€æˆ–æŸäº›è®°å½•å·²ç»è¢«åˆ é™¤äº†ï¼è¿™ç§ç°è±¡å°±å«åšâ€œä¸å¯é‡å¤è¯»â€ ã€‚</p></li><li><p>å¹»è¯»ï¼ˆPhantom Readsï¼‰ï¼š ä¸€ä¸ªäº‹åŠ¡æŒ‰ç›¸åŒçš„æŸ¥è¯¢æ¡ä»¶é‡æ–°è¯»å–ä»¥å‰æ£€ç´¢è¿‡çš„æ•°æ®ï¼Œå´å‘ç°å…¶ä»–äº‹åŠ¡æ’å…¥äº†æ»¡è¶³å…¶æŸ¥è¯¢æ¡ä»¶çš„æ–°æ•°æ®ï¼Œè¿™ç§ç°è±¡å°±ç§°ä¸ºâ€œå¹»è¯»â€ ã€‚</p></li></ul><h5 id="å¹¶å‘äº‹åŠ¡ä¼šæœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿåº”è¯¥å¦‚ä½•è§£å†³ï¼Ÿ"><a href="#å¹¶å‘äº‹åŠ¡ä¼šæœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿåº”è¯¥å¦‚ä½•è§£å†³ï¼Ÿ" class="headerlink" title="å¹¶å‘äº‹åŠ¡ä¼šæœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿåº”è¯¥å¦‚ä½•è§£å†³ï¼Ÿ"></a>å¹¶å‘äº‹åŠ¡ä¼šæœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿåº”è¯¥å¦‚ä½•è§£å†³ï¼Ÿ</h5><p>å¹¶å‘äº‹åŠ¡å¯èƒ½é€ æˆï¼šè„è¯»ã€ä¸å¯é‡å¤è¯»å’Œå¹»è¯»ç­‰é—®é¢˜ ï¼Œè¿™äº›é—®é¢˜å…¶å®éƒ½æ˜¯æ•°æ®åº“è¯»ä¸€è‡´æ€§é—®é¢˜ï¼Œå¿…é¡»ç”±æ•°æ®åº“æä¾›ä¸€å®šçš„äº‹åŠ¡éš”ç¦»æœºåˆ¶æ¥è§£å†³ï¼Œè§£å†³æ–¹æ¡ˆå¦‚ä¸‹ï¼š</p><ul><li><p>åŠ é”ï¼šåœ¨è¯»å–æ•°æ®å‰ï¼Œå¯¹å…¶åŠ é”ï¼Œé˜»æ­¢å…¶ä»–äº‹åŠ¡å¯¹æ•°æ®è¿›è¡Œä¿®æ”¹ã€‚</p></li><li><p>æä¾›æ•°æ®å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼ˆMultiVersion Concurrency Controlï¼Œç®€ç§° MVCC æˆ– MCCï¼‰ï¼Œä¹Ÿç§°ä¸ºå¤šç‰ˆæœ¬æ•°æ®åº“ï¼šä¸ç”¨åŠ ä»»ä½•é”ï¼Œ é€šè¿‡ä¸€å®šæœºåˆ¶ç”Ÿæˆä¸€ä¸ªæ•°æ®è¯·æ±‚æ—¶é—´ç‚¹çš„ä¸€è‡´æ€§æ•°æ®å¿«ç…§ï¼ˆSnapshot)ï¼Œ å¹¶ç”¨è¿™ä¸ªå¿«ç…§æ¥æä¾›ä¸€å®šçº§åˆ« ï¼ˆè¯­å¥çº§æˆ–äº‹åŠ¡çº§ï¼‰ çš„ä¸€è‡´æ€§è¯»å–ï¼Œä»ç”¨æˆ·çš„è§’åº¦æ¥çœ‹ï¼Œå¥½è±¡æ˜¯æ•°æ®åº“å¯ä»¥æä¾›åŒä¸€æ•°æ®çš„å¤šä¸ªç‰ˆæœ¬ã€‚</p></li></ul><h5 id="ä»€ä¹ˆæ˜¯-MVCCï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯-MVCCï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯ MVCCï¼Ÿ"></a>ä»€ä¹ˆæ˜¯ MVCCï¼Ÿ</h5><p>MVCC å…¨ç§°æ˜¯å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ç³»ç»Ÿï¼ŒInnoDB å’Œ Falcon å­˜å‚¨å¼•æ“é€šè¿‡å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼ˆMVCCï¼ŒMultiversion Concurrency Controlï¼‰æœºåˆ¶è§£å†³å¹»è¯»é—®é¢˜ã€‚</p><h5 id="MVCC-æ˜¯æ€ä¹ˆå·¥ä½œçš„ï¼Ÿ"><a href="#MVCC-æ˜¯æ€ä¹ˆå·¥ä½œçš„ï¼Ÿ" class="headerlink" title="MVCC æ˜¯æ€ä¹ˆå·¥ä½œçš„ï¼Ÿ"></a>MVCC æ˜¯æ€ä¹ˆå·¥ä½œçš„ï¼Ÿ</h5><p>InnoDB çš„ MVCC æ˜¯é€šè¿‡åœ¨æ¯è¡Œè®°å½•åé¢ä¿å­˜ä¸¤ä¸ªéšè—çš„åˆ—æ¥å®ç°ï¼Œè¿™ä¸¤ä¸ªåˆ—ä¸€ä¸ªä¿å­˜äº†è¡Œçš„åˆ›å»ºæ—¶é—´ï¼Œä¸€ä¸ªä¿å­˜è¡Œçš„è¿‡æœŸæ—¶é—´ï¼ˆåˆ é™¤æ—¶é—´ï¼‰ã€‚å½“ç„¶å­˜å‚¨çš„å¹¶ä¸æ˜¯çœŸå®çš„æ—¶é—´è€Œæ˜¯ç³»ç»Ÿç‰ˆæœ¬å·ï¼ˆsystem version numberï¼‰ã€‚æ¯å¼€å§‹ä¸€ä¸ªæ–°çš„äº‹åŠ¡ï¼Œç³»ç»Ÿç‰ˆæœ¬å·éƒ½ä¼šè‡ªåŠ¨æ–°å¢ï¼Œäº‹åŠ¡å¼€å§‹æ—¶åˆ»çš„ç³»ç»Ÿç‰ˆæœ¬å·ä¼šä½œä¸ºäº‹åŠ¡çš„ç‰ˆæœ¬å·ï¼Œç”¨æ¥æŸ¥è¯¢åˆ°æ¯è¡Œè®°å½•çš„ç‰ˆæœ¬å·è¿›è¡Œæ¯”è¾ƒã€‚</p><h5 id="REPEATABLE-READï¼ˆå¯é‡è¯»ï¼‰éš”ç¦»çº§åˆ«ä¸‹-MVCC-å¦‚ä½•å·¥ä½œï¼Ÿ"><a href="#REPEATABLE-READï¼ˆå¯é‡è¯»ï¼‰éš”ç¦»çº§åˆ«ä¸‹-MVCC-å¦‚ä½•å·¥ä½œï¼Ÿ" class="headerlink" title="REPEATABLE READï¼ˆå¯é‡è¯»ï¼‰éš”ç¦»çº§åˆ«ä¸‹ MVCC å¦‚ä½•å·¥ä½œï¼Ÿ"></a>REPEATABLE READï¼ˆå¯é‡è¯»ï¼‰éš”ç¦»çº§åˆ«ä¸‹ MVCC å¦‚ä½•å·¥ä½œï¼Ÿ</h5><ul><li><p>SELECTï¼šInnoDB ä¼šæ ¹æ®ä»¥ä¸‹æ¡ä»¶æ£€æŸ¥æ¯ä¸€è¡Œè®°å½•ï¼šç¬¬ä¸€ï¼ŒInnoDB åªæŸ¥æ‰¾ç‰ˆæœ¬æ—©äºå½“å‰äº‹åŠ¡ç‰ˆæœ¬çš„æ•°æ®è¡Œï¼Œè¿™æ ·å¯ä»¥ç¡®ä¿äº‹åŠ¡è¯»å–çš„è¡Œè¦ä¹ˆæ˜¯åœ¨å¼€å§‹äº‹åŠ¡ä¹‹å‰å·²ç»å­˜åœ¨è¦ä¹ˆæ˜¯äº‹åŠ¡è‡ªèº«æ’å…¥æˆ–è€…ä¿®æ”¹è¿‡çš„ã€‚ç¬¬äºŒï¼Œè¡Œçš„åˆ é™¤ç‰ˆæœ¬å·è¦ä¹ˆæœªå®šä¹‰ï¼Œè¦ä¹ˆå¤§äºå½“å‰äº‹åŠ¡ç‰ˆæœ¬å·ï¼Œè¿™æ ·å¯ä»¥ç¡®ä¿äº‹åŠ¡è¯»å–åˆ°çš„è¡Œåœ¨äº‹åŠ¡å¼€å§‹ä¹‹å‰æœªè¢«åˆ é™¤ã€‚</p></li><li><p>INSERTï¼šInnoDB ä¸ºæ–°æ’å…¥çš„æ¯ä¸€è¡Œä¿å­˜å½“å‰ç³»ç»Ÿç‰ˆæœ¬å·ä½œä¸ºè¡Œç‰ˆæœ¬å·ã€‚</p></li><li><p>DELETEï¼šInnoDB ä¸ºåˆ é™¤çš„æ¯ä¸€è¡Œä¿å­˜å½“å‰ç³»ç»Ÿç‰ˆæœ¬å·ä½œä¸ºè¡Œåˆ é™¤æ ‡è¯†ã€‚</p></li><li><p>UPDATEï¼šInnoDB ä¸ºæ’å…¥çš„ä¸€è¡Œæ–°çºªå½•ä¿å­˜å½“å‰ç³»ç»Ÿç‰ˆæœ¬å·ä½œä¸ºè¡Œç‰ˆæœ¬å·ï¼ŒåŒæ—¶ä¿å­˜å½“å‰ç³»ç»Ÿç‰ˆæœ¬å·åˆ°åŸæ¥çš„è¡Œä½œä¸ºåˆ é™¤æ ‡è¯†ä¿å­˜è¿™ä¸¤ä¸ªç‰ˆæœ¬å·ï¼Œä½¿å¤§å¤šæ•°æ“ä½œéƒ½ä¸ç”¨åŠ é”ã€‚å®ƒä¸è¶³ä¹‹å¤„æ˜¯æ¯è¡Œè®°å½•éƒ½éœ€è¦é¢å¤–çš„å­˜å‚¨ç©ºé—´ï¼Œéœ€è¦åšæ›´å¤šçš„è¡Œæ£€æŸ¥å·¥ä½œå’Œä¸€äº›é¢å¤–çš„ç»´æŠ¤å·¥ä½œã€‚</p></li></ul><h5 id="MySQL-äº‹åŠ¡å®ç°åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#MySQL-äº‹åŠ¡å®ç°åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="MySQL äº‹åŠ¡å®ç°åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ"></a>MySQL äº‹åŠ¡å®ç°åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ</h5><p>äº‹åŠ¡çš„å®ç°æ˜¯åŸºäºæ•°æ®åº“çš„å­˜å‚¨å¼•æ“ï¼Œä¸åŒçš„å­˜å‚¨å¼•æ“å¯¹äº‹åŠ¡çš„æ”¯æŒç¨‹åº¦ä¸ä¸€æ ·ã€‚MySQL ä¸­æ”¯æŒäº‹åŠ¡çš„å­˜å‚¨å¼•æ“æœ‰InnoDB å’Œ NDBã€‚ InnoDB æ˜¯é«˜ç‰ˆæœ¬ MySQL çš„é»˜è®¤çš„å­˜å‚¨å¼•æ“ï¼Œå› æ­¤å°±ä»¥ InnoDB çš„äº‹åŠ¡å®ç°ä¸ºä¾‹ï¼ŒInnoDB æ˜¯é€šè¿‡å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼ˆMVCCï¼ŒMultiversion Concurrency Control ï¼‰è§£å†³ä¸å¯é‡å¤è¯»é—®é¢˜ï¼ŒåŠ ä¸Šé—´éš™é”ï¼ˆä¹Ÿå°±æ˜¯å¹¶å‘æ§åˆ¶ï¼‰è§£å†³å¹»è¯»é—®é¢˜ã€‚å› æ­¤ InnoDB çš„ RR éš”ç¦»çº§åˆ«å…¶å®å®ç°äº†ä¸²è¡ŒåŒ–çº§åˆ«çš„æ•ˆæœï¼Œè€Œä¸”ä¿ç•™äº†æ¯”è¾ƒå¥½çš„å¹¶å‘æ€§èƒ½ã€‚äº‹åŠ¡çš„éš”ç¦»æ€§æ˜¯é€šè¿‡é”å®ç°ï¼Œè€Œäº‹åŠ¡çš„åŸå­æ€§ã€ä¸€è‡´æ€§å’ŒæŒä¹…æ€§åˆ™æ˜¯é€šè¿‡äº‹åŠ¡æ—¥å¿—å®ç°ã€‚ </p><h5 id="å¦‚ä½•è®¾ç½®-MySQL-çš„äº‹åŠ¡éš”ç¦»çº§åˆ«ï¼Ÿ"><a href="#å¦‚ä½•è®¾ç½®-MySQL-çš„äº‹åŠ¡éš”ç¦»çº§åˆ«ï¼Ÿ" class="headerlink" title="å¦‚ä½•è®¾ç½® MySQL çš„äº‹åŠ¡éš”ç¦»çº§åˆ«ï¼Ÿ"></a>å¦‚ä½•è®¾ç½® MySQL çš„äº‹åŠ¡éš”ç¦»çº§åˆ«ï¼Ÿ</h5><p>MySQL äº‹åŠ¡éš”ç¦»çº§åˆ« MySQL.cnf æ–‡ä»¶é‡Œè®¾ç½®çš„ï¼ˆé»˜è®¤ç›®å½• /etc/my.cnfï¼‰ï¼Œåœ¨æ–‡ä»¶çš„æ–‡æœ«æ·»åŠ é…ç½®ï¼š</p><p><code>transaction-isolation = REPEATABLE-READ</code></p><p>å¯ç”¨çš„é…ç½®å€¼ï¼š<code>READ-UNCOMMITTEDã€READ-COMMITTEDã€REPEATABLE-READã€SERIALIZABLE</code>ã€‚</p><h5 id="InnoDB-é»˜è®¤çš„äº‹åŠ¡éš”ç¦»çº§åˆ«æ˜¯ä»€ä¹ˆï¼Ÿå¦‚ä½•ä¿®æ”¹ï¼Ÿ"><a href="#InnoDB-é»˜è®¤çš„äº‹åŠ¡éš”ç¦»çº§åˆ«æ˜¯ä»€ä¹ˆï¼Ÿå¦‚ä½•ä¿®æ”¹ï¼Ÿ" class="headerlink" title="InnoDB é»˜è®¤çš„äº‹åŠ¡éš”ç¦»çº§åˆ«æ˜¯ä»€ä¹ˆï¼Ÿå¦‚ä½•ä¿®æ”¹ï¼Ÿ"></a>InnoDB é»˜è®¤çš„äº‹åŠ¡éš”ç¦»çº§åˆ«æ˜¯ä»€ä¹ˆï¼Ÿå¦‚ä½•ä¿®æ”¹ï¼Ÿ</h5><p><code>InnoDB </code>é»˜è®¤çš„äº‹åŠ¡éš”ç¦»æ˜¯ <code>repetable read</code>ï¼ˆå¯é‡å¤è¯»ï¼‰ï¼›å¯ä»¥é€šè¿‡<code> set</code> ä½œç”¨åŸŸ <code>transaction isolation level </code>äº‹åŠ¡éš”ç¦»çº§åˆ« æ¥ä¿®æ”¹äº‹åŠ¡çš„éš”ç¦»çº§åˆ«</p><p>å¦‚ï¼š</p><pre><code class="hljs mysql">MySQL&gt; set global transaction isolation level read committed;  &#x2F;&#x2F; è®¾ç½®å…¨å±€äº‹åŠ¡éš”ç¦»çº§åˆ«ä¸º read committed   MySQL&gt; set session transaction isolation level read committed; &#x2F;&#x2F; è®¾ç½®å½“å‰ä¼šè¯äº‹åŠ¡éš”ç¦»çº§åˆ«ä¸º read committed</code></pre><h5 id="InnoDB-å¦‚ä½•å¼€å¯æ‰‹åŠ¨æäº¤äº‹åŠ¡ï¼Ÿ"><a href="#InnoDB-å¦‚ä½•å¼€å¯æ‰‹åŠ¨æäº¤äº‹åŠ¡ï¼Ÿ" class="headerlink" title="InnoDB å¦‚ä½•å¼€å¯æ‰‹åŠ¨æäº¤äº‹åŠ¡ï¼Ÿ"></a>InnoDB å¦‚ä½•å¼€å¯æ‰‹åŠ¨æäº¤äº‹åŠ¡ï¼Ÿ</h5><p><code>InnoDB</code> é»˜è®¤æ˜¯è‡ªåŠ¨æäº¤äº‹åŠ¡çš„ï¼Œæ¯ä¸€æ¬¡<code> SQL</code> æ“ä½œï¼ˆé<code>select</code>æ“ä½œï¼‰éƒ½ä¼šè‡ªåŠ¨æäº¤ä¸€ä¸ªäº‹åŠ¡ï¼Œå¦‚æœè¦æ‰‹åŠ¨å¼€å¯äº‹åŠ¡éœ€è¦è®¾ç½® <code>set autocommit=0 </code>ç¦æ­¢è‡ªåŠ¨æäº¤äº‹åŠ¡ï¼Œç›¸å½“äºå¼€å¯æ‰‹åŠ¨æäº¤äº‹åŠ¡ã€‚</p><h5 id="åœ¨-InnoDB-ä¸­è®¾ç½®äº†-autocommit-0ï¼Œæ·»åŠ ä¸€æ¡ä¿¡æ¯ä¹‹åæ²¡æœ‰æ‰‹åŠ¨æ‰§è¡Œæäº¤æ“ä½œï¼Œè¯·é—®è¿™æ¡ä¿¡æ¯å¯ä»¥è¢«æŸ¥åˆ°å—ï¼Ÿ"><a href="#åœ¨-InnoDB-ä¸­è®¾ç½®äº†-autocommit-0ï¼Œæ·»åŠ ä¸€æ¡ä¿¡æ¯ä¹‹åæ²¡æœ‰æ‰‹åŠ¨æ‰§è¡Œæäº¤æ“ä½œï¼Œè¯·é—®è¿™æ¡ä¿¡æ¯å¯ä»¥è¢«æŸ¥åˆ°å—ï¼Ÿ" class="headerlink" title="åœ¨ InnoDB ä¸­è®¾ç½®äº† autocommit=0ï¼Œæ·»åŠ ä¸€æ¡ä¿¡æ¯ä¹‹åæ²¡æœ‰æ‰‹åŠ¨æ‰§è¡Œæäº¤æ“ä½œï¼Œè¯·é—®è¿™æ¡ä¿¡æ¯å¯ä»¥è¢«æŸ¥åˆ°å—ï¼Ÿ"></a>åœ¨ InnoDB ä¸­è®¾ç½®äº† autocommit=0ï¼Œæ·»åŠ ä¸€æ¡ä¿¡æ¯ä¹‹åæ²¡æœ‰æ‰‹åŠ¨æ‰§è¡Œæäº¤æ“ä½œï¼Œè¯·é—®è¿™æ¡ä¿¡æ¯å¯ä»¥è¢«æŸ¥åˆ°å—ï¼Ÿ</h5><p><code>autocommit=0</code> è¡¨ç¤ºç¦æ­¢è‡ªåŠ¨äº‹åŠ¡æäº¤ï¼Œåœ¨æ·»åŠ æ“ä½œä¹‹åæ²¡æœ‰è¿›è¡Œæ‰‹åŠ¨æäº¤ï¼Œé»˜è®¤æƒ…å†µä¸‹å…¶ä»–è¿æ¥å®¢æˆ·ç«¯æ˜¯æŸ¥è¯¢ä¸åˆ°æ­¤æ¡æ–°å¢æ•°æ®çš„ã€‚</p><h5 id="å¦‚ä½•æ‰‹åŠ¨æ“ä½œäº‹åŠ¡ï¼Ÿ"><a href="#å¦‚ä½•æ‰‹åŠ¨æ“ä½œäº‹åŠ¡ï¼Ÿ" class="headerlink" title="å¦‚ä½•æ‰‹åŠ¨æ“ä½œäº‹åŠ¡ï¼Ÿ"></a>å¦‚ä½•æ‰‹åŠ¨æ“ä½œäº‹åŠ¡ï¼Ÿ</h5><p>ä½¿ç”¨ begin å¼€å¯äº‹åŠ¡ï¼›rollback å›æ»šäº‹åŠ¡ï¼›commit æäº¤äº‹åŠ¡ã€‚å…·ä½“ä½¿ç”¨ç¤ºä¾‹å¦‚ä¸‹ï¼š</p><pre><code class="hljs mysql">begin; insert person(name,age) values(&#39;laowang&#39;,18); rollback; commit;</code></pre><h4 id="MySQL-æ—¥å¿—"><a href="#MySQL-æ—¥å¿—" class="headerlink" title="MySQL æ—¥å¿—"></a>MySQL æ—¥å¿—</h4><h5 id="MySQL-æœ‰å“ªäº›é‡è¦çš„æ—¥å¿—æ–‡ä»¶ï¼Ÿ"><a href="#MySQL-æœ‰å“ªäº›é‡è¦çš„æ—¥å¿—æ–‡ä»¶ï¼Ÿ" class="headerlink" title="MySQL æœ‰å“ªäº›é‡è¦çš„æ—¥å¿—æ–‡ä»¶ï¼Ÿ"></a>MySQL æœ‰å“ªäº›é‡è¦çš„æ—¥å¿—æ–‡ä»¶ï¼Ÿ</h5><p><img src="/images/mysql/logfile.png"></p><p>MySQL ä¸­çš„é‡è¦æ—¥å¿—åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªï¼š</p><p> â‘  é”™è¯¯æ—¥å¿—ï¼šç”¨æ¥è®°å½• MySQL æœåŠ¡å™¨è¿è¡Œè¿‡ç¨‹ä¸­çš„é”™è¯¯ä¿¡æ¯ï¼Œæ¯”å¦‚ï¼Œæ— æ³•åŠ è½½ MySQL æ•°æ®åº“çš„æ•°æ®æ–‡ä»¶ï¼Œæˆ–æƒé™ä¸æ­£ç¡®ç­‰éƒ½ä¼šè¢«è®°å½•åœ¨æ­¤ï¼Œè¿˜æœ‰å¤åˆ¶ç¯å¢ƒä¸‹ï¼Œä»æœåŠ¡å™¨è¿›ç¨‹çš„ä¿¡æ¯ä¹Ÿä¼šè¢«è®°å½•è¿›é”™è¯¯æ—¥å¿—ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œé”™è¯¯æ—¥å¿—æ˜¯å¼€å¯çš„ï¼Œä¸”æ— æ³•è¢«ç¦æ­¢ã€‚</p><p>â€‹      é”™è¯¯æ—¥å¿—æ˜¯å­˜å‚¨åœ¨æ•°æ®åº“çš„æ•°æ®æ–‡ä»¶ç›®å½•ä¸­ï¼Œåç§°ä¸º hostname.errï¼Œå…¶ä¸­ hostname ä¸ºæœåŠ¡å™¨ä¸»æœºåã€‚åœ¨ MySQL 5.5.7 ä¹‹å‰ï¼Œæ•°æ®åº“ç®¡ç†å‘˜å¯ä»¥åˆ é™¤å¾ˆé•¿æ—¶é—´ä¹‹å‰çš„é”™è¯¯æ—¥å¿—ï¼Œä»¥èŠ‚çœæœåŠ¡å™¨ä¸Šçš„ç¡¬ç›˜ç©ºé—´ï¼Œ MySQL 5.5.7 ä¹‹åï¼ŒæœåŠ¡å™¨å°†å…³é—­æ­¤é¡¹åŠŸèƒ½ï¼Œåªèƒ½ä½¿ç”¨é‡å‘½ååŸæ¥çš„é”™è¯¯æ—¥å¿—æ–‡ä»¶ï¼Œæ‰‹åŠ¨å†²æ´—æ—¥å¿—åˆ›å»ºä¸€ä¸ªæ–°çš„ï¼Œå‘½ä»¤ä¸ºï¼š</p><p><code>mv hostname.err  hostname.err.old mysqladmin flush-logs</code></p><p>â‘¡ æŸ¥è¯¢æ—¥å¿—ï¼šæŸ¥è¯¢æ—¥å¿—åœ¨ MySQL ä¸­è¢«ç§°ä¸º general log(é€šç”¨æ—¥å¿—)ï¼ŒæŸ¥è¯¢æ—¥å¿—é‡Œçš„å†…å®¹ä¸è¦è¢«â€œæŸ¥è¯¢æ—¥å¿—â€è¯¯å¯¼ï¼Œè®¤ä¸ºé‡Œé¢åªå­˜å‚¨ select è¯­å¥ï¼Œå…¶å®ä¸ç„¶ï¼ŒæŸ¥è¯¢æ—¥å¿—é‡Œé¢è®°å½•äº†æ•°æ®åº“æ‰§è¡Œçš„æ‰€æœ‰å‘½ä»¤ï¼Œä¸ç®¡è¯­å¥æ˜¯å¦æ­£ç¡®ï¼Œéƒ½ä¼šè¢«è®°å½•ï¼Œå…·ä½“åŸå› å¦‚ä¸‹:</p><ul><li><p>insert æŸ¥è¯¢ä¸ºäº†é¿å…æ•°æ®å†²çªï¼Œå¦‚æœæ­¤å‰æ’å…¥è¿‡æ•°æ®ï¼Œå½“å‰æ’å…¥çš„æ•°æ®å¦‚æœè·Ÿä¸»é”®æˆ–å”¯ä¸€é”®çš„æ•°æ®é‡å¤é‚£è‚¯å®šä¼šæŠ¥é”™ï¼›</p></li><li><p>update æ—¶ä¹Ÿä¼šæŸ¥è¯¢å› ä¸ºæ›´æ–°çš„æ—¶å€™å¾ˆå¯èƒ½ä¼šæ›´æ–°æŸä¸€å—æ•°æ®ï¼›</p></li><li><p>delete æŸ¥è¯¢ï¼Œåªåˆ é™¤ç¬¦åˆæ¡ä»¶çš„æ•°æ®ï¼›</p></li></ul><p>å› æ­¤éƒ½ä¼šäº§ç”Ÿæ—¥å¿—ï¼Œåœ¨å¹¶å‘æ“ä½œéå¸¸å¤šçš„åœºæ™¯ä¸‹ï¼ŒæŸ¥è¯¢ä¿¡æ¯ä¼šéå¸¸å¤šï¼Œé‚£ä¹ˆå¦‚æœéƒ½è®°å½•ä¸‹æ¥ä¼šå¯¼è‡´ IO éå¸¸å¤§ï¼Œå½±å“ MySQL æ€§èƒ½ï¼Œå› æ­¤å¦‚æœä¸æ˜¯åœ¨è°ƒè¯•ç¯å¢ƒä¸‹ï¼Œæ˜¯ä¸å»ºè®®å¼€å¯æŸ¥è¯¢æ—¥å¿—åŠŸèƒ½çš„ã€‚</p><p>æŸ¥è¯¢æ—¥å¿—çš„å¼€å¯æœ‰åŠ©äºå¸®åŠ©æˆ‘ä»¬åˆ†æå“ªäº›è¯­å¥æ‰§è¡Œå¯†é›†ï¼Œæ‰§è¡Œå¯†é›†çš„ select è¯­å¥å¯¹åº”çš„æ•°æ®æ˜¯å¦èƒ½å¤Ÿè¢«ç¼“å­˜ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥å¸®åŠ©æˆ‘ä»¬åˆ†æé—®é¢˜ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®è‡ªå·±çš„å®é™…æƒ…å†µæ¥å†³å®šæ˜¯å¦å¼€å¯æŸ¥è¯¢æ—¥å¿—ã€‚</p><p>æŸ¥è¯¢æ—¥å¿—æ¨¡å¼æ˜¯å…³é—­çš„ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤å¼€å¯æŸ¥è¯¢æ—¥å¿—ï¼š</p><p><code>set global generallog=1 set global logoutput=&#39;table&#39;;</code></p><p><code>general_log=1</code> ä¸ºå¼€å¯æŸ¥è¯¢æ—¥å¿—ï¼Œ0 ä¸ºå…³é—­æŸ¥è¯¢æ—¥å¿—ï¼Œè¿™ä¸ªè®¾ç½®å‘½ä»¤å³æ—¶ç”Ÿæ•ˆï¼Œä¸ç”¨é‡å¯ MySQL æœåŠ¡å™¨ã€‚</p><p>â‘¢ æ…¢æ—¥å¿—ï¼šæ…¢æŸ¥è¯¢ä¼šå¯¼è‡´ CPUã€IOPSã€å†…å­˜æ¶ˆè€—è¿‡é«˜ï¼Œå½“æ•°æ®åº“é‡åˆ°æ€§èƒ½ç“¶é¢ˆæ—¶ï¼Œå¤§éƒ¨åˆ†æ—¶é—´éƒ½æ˜¯ç”±äºæ…¢æŸ¥è¯¢å¯¼è‡´çš„ã€‚å¼€å¯æ…¢æŸ¥è¯¢æ—¥å¿—ï¼Œå¯ä»¥è®© MySQL è®°å½•ä¸‹æŸ¥è¯¢è¶…è¿‡æŒ‡å®šæ—¶é—´çš„è¯­å¥ï¼Œä¹‹åè¿ç»´äººå‘˜é€šè¿‡å®šä½åˆ†æï¼Œèƒ½å¤Ÿå¾ˆå¥½çš„ä¼˜åŒ–æ•°æ®åº“æ€§èƒ½ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæ…¢æŸ¥è¯¢æ—¥å¿—æ˜¯ä¸å¼€å¯çš„ï¼Œåªæœ‰æ‰‹åŠ¨å¼€å¯äº†ï¼Œæ…¢æŸ¥è¯¢æ‰ä¼šè¢«è®°å½•åˆ°æ…¢æŸ¥è¯¢æ—¥å¿—ä¸­ã€‚ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤è®°å½•å½“å‰æ•°æ®åº“çš„æ…¢æŸ¥è¯¢è¯­å¥ï¼š</p><p><code>set global slowquerylog=&#39;ON&#39;;</code></p><p>ä½¿ç”¨ <code>set global slowquerylog=&#39;ON&#39;</code> å¼€å¯æ…¢æŸ¥è¯¢æ—¥å¿—ï¼Œåªæ˜¯å¯¹å½“å‰æ•°æ®åº“æœ‰æ•ˆï¼Œå¦‚æœ MySQL æ•°æ®åº“é‡å¯åå°±ä¼šå¤±æ•ˆã€‚æ‰€ä»¥å¦‚æœè¦æ°¸ä¹…ç”Ÿæ•ˆï¼Œå°±è¦ä¿®æ”¹é…ç½®æ–‡ä»¶<code> my.cnf</code>ï¼Œè®¾ç½®<code> slowquerylog=1</code> å¹¶é‡å¯ MySQL æœåŠ¡å™¨ã€‚</p><p>â‘£ <code>redo log</code>ï¼ˆé‡åšæ—¥å¿—ï¼‰ï¼šä¸ºäº†æœ€å¤§ç¨‹åº¦çš„é¿å…æ•°æ®å†™å…¥æ—¶ï¼Œå› ä¸º IO ç“¶é¢ˆé€ æˆçš„æ€§èƒ½é—®é¢˜ï¼ŒMySQL é‡‡ç”¨äº†è¿™æ ·ä¸€ç§ç¼“å­˜æœºåˆ¶ï¼Œå…ˆå°†æ•°æ®å†™å…¥å†…å­˜ä¸­ï¼Œå†æ‰¹é‡æŠŠå†…å­˜ä¸­çš„æ•°æ®ç»Ÿä¸€åˆ·å›ç£ç›˜ã€‚ä¸ºäº†é¿å…å°†æ•°æ®åˆ·å›ç£ç›˜è¿‡ç¨‹ä¸­ï¼Œå› ä¸ºæ‰ç”µæˆ–ç³»ç»Ÿæ•…éšœå¸¦æ¥çš„æ•°æ®ä¸¢å¤±é—®é¢˜ï¼ŒInnoDB é‡‡ç”¨ <code>redo log</code> æ¥è§£å†³æ­¤é—®é¢˜ã€‚</p><p>â‘¤ <code>undo log</code>ï¼ˆå›æ»šæ—¥å¿—ï¼‰ï¼šç”¨äºå­˜å‚¨æ—¥å¿—è¢«ä¿®æ”¹å‰çš„å€¼ï¼Œä»è€Œä¿è¯å¦‚æœä¿®æ”¹å‡ºç°å¼‚å¸¸ï¼Œå¯ä»¥ä½¿ç”¨ <code>undo log </code>æ—¥å¿—æ¥å®ç°å›æ»šæ“ä½œã€‚<code>undo log </code>å’Œ<code> redo log</code> è®°å½•ç‰©ç†æ—¥å¿—ä¸ä¸€æ ·ï¼Œå®ƒæ˜¯é€»è¾‘æ—¥å¿—ï¼Œå¯ä»¥è®¤ä¸ºå½“ <code>delete</code> ä¸€æ¡è®°å½•æ—¶ï¼Œ<code>undo log</code> ä¸­ä¼šè®°å½•ä¸€æ¡å¯¹åº”çš„<code> insert</code> è®°å½•ï¼Œåä¹‹äº¦ç„¶ï¼Œå½“ <code>update</code> ä¸€æ¡è®°å½•æ—¶ï¼Œå®ƒè®°å½•ä¸€æ¡å¯¹åº”ç›¸åçš„ <code>update</code> è®°å½•ï¼Œå½“æ‰§è¡Œ rollback æ—¶ï¼Œå°±å¯ä»¥ä» <code>undo log</code> ä¸­çš„é€»è¾‘è®°å½•è¯»å–åˆ°ç›¸åº”çš„å†…å®¹å¹¶è¿›è¡Œå›æ»šã€‚<code>undo log </code>é»˜è®¤å­˜æ”¾åœ¨å…±äº«è¡¨ç©ºé—´ä¸­ï¼Œåœ¨ <code>mySQL 5.6</code> ä¸­ï¼Œ<code>undo log</code> çš„å­˜æ”¾ä½ç½®è¿˜å¯ä»¥é€šè¿‡å˜é‡<code>innodbundodirectory</code>æ¥è‡ªå®šä¹‰å­˜æ”¾ç›®å½•ï¼Œé»˜è®¤å€¼ä¸ºâ€œ.â€è¡¨ç¤º <code>datadir </code>ç›®å½•ã€‚</p><p>â‘¥ <code>bin log</code>ï¼ˆäºŒè¿›åˆ¶æ—¥å¿—ï¼‰ï¼šæ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œä¸»è¦è®°å½•æ‰€æœ‰æ•°æ®åº“è¡¨ç»“æ„å˜æ›´ï¼Œæ¯”å¦‚ï¼Œ<code>CREATEã€ALTER TABLE</code> ç­‰ï¼Œä»¥åŠè¡¨æ•°æ®ä¿®æ”¹ï¼Œæ¯”å¦‚ï¼Œ<code>INSERTã€UPDATEã€DELETE</code> çš„æ‰€æœ‰æ“ä½œï¼Œ<code>bin log</code> ä¸­è®°å½•äº†å¯¹ MySQL æ•°æ®åº“æ‰§è¡Œæ›´æ”¹çš„æ‰€æœ‰æ“ä½œï¼Œå¹¶ä¸”è®°å½•äº†è¯­å¥å‘ç”Ÿæ—¶é—´ã€æ‰§è¡Œæ—¶é•¿ã€æ“ä½œæ•°æ®ç­‰å…¶å®ƒé¢å¤–ä¿¡æ¯ï¼Œä½†æ˜¯å®ƒä¸è®°å½•<code>SELECTã€SHOW</code>ç­‰é‚£äº›ä¸ä¿®æ”¹æ•°æ®çš„ SQL è¯­å¥ã€‚</p><p>binlog çš„ä½œç”¨å¦‚ä¸‹ï¼š</p><ul><li><p>æ¢å¤ï¼ˆrecoveryï¼‰ï¼šæŸäº›æ•°æ®çš„æ¢å¤éœ€è¦äºŒè¿›åˆ¶æ—¥å¿—ã€‚æ¯”å¦‚ï¼Œåœ¨ä¸€ä¸ªæ•°æ®åº“å…¨å¤‡æ–‡ä»¶æ¢å¤åï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡äºŒè¿›åˆ¶æ—¥å¿—è¿›è¡Œ point-in-time çš„æ¢å¤ï¼›</p></li><li><p>å¤åˆ¶ï¼ˆreplicationï¼‰ï¼šå…¶åŸç†ä¸æ¢å¤ç±»ä¼¼ï¼Œé€šè¿‡å¤åˆ¶å’Œæ‰§è¡ŒäºŒè¿›åˆ¶æ—¥å¿—ä½¿ä¸€å°è¿œç¨‹çš„MySQLæ•°æ®åº“ï¼ˆä¸€èˆ¬ç§°ä¸º slave æˆ–è€… standbyï¼‰ä¸ä¸€å° MySQL æ•°æ®åº“ï¼ˆä¸€èˆ¬ç§°ä¸º master æˆ–è€… primaryï¼‰è¿›è¡Œå®æ—¶åŒæ­¥ï¼›</p></li><li><p>å®¡è®¡ï¼ˆauditï¼‰ï¼šç”¨æˆ·å¯ä»¥é€šè¿‡äºŒè¿›åˆ¶æ—¥å¿—ä¸­çš„ä¿¡æ¯æ¥è¿›è¡Œå®¡è®¡ï¼Œåˆ¤æ–­æ˜¯å¦æœ‰å¯¹æ•°æ®åº“è¿›è¡Œæ³¨å…¥æ”»å‡»ã€‚</p></li></ul><p>é™¤äº†ä¸Šé¢ä»‹ç»çš„å‡ ä¸ªä½œç”¨å¤–ï¼Œbinlog å¯¹äºäº‹åŠ¡å­˜å‚¨å¼•æ“çš„å´©æºƒæ¢å¤ä¹Ÿæœ‰éå¸¸é‡è¦çš„ä½œç”¨ï¼Œåœ¨å¼€å¯ binlog çš„æƒ…å†µä¸‹ï¼Œä¸ºäº†ä¿è¯ binlog ä¸ redo çš„ä¸€è‡´æ€§ï¼ŒMySQL å°†é‡‡ç”¨äº‹åŠ¡çš„ä¸¤é˜¶æ®µæäº¤åè®®ã€‚å½“ MySQL ç³»ç»Ÿå‘ç”Ÿå´©æºƒæ—¶ï¼Œäº‹åŠ¡åœ¨å­˜å‚¨å¼•æ“å†…éƒ¨çš„çŠ¶æ€å¯èƒ½ä¸º preparedï¼ˆå‡†å¤‡çŠ¶æ€ï¼‰å’Œ commitï¼ˆæäº¤çŠ¶æ€ï¼‰ä¸¤ç§ï¼Œå¯¹äº prepared çŠ¶æ€çš„äº‹åŠ¡ï¼Œæ˜¯è¿›è¡Œæäº¤æ“ä½œè¿˜æ˜¯è¿›è¡Œå›æ»šæ“ä½œï¼Œè¿™æ—¶éœ€è¦å‚è€ƒ binlogï¼Œå¦‚æœäº‹åŠ¡åœ¨ binlog ä¸­å­˜åœ¨ï¼Œé‚£ä¹ˆå°†å…¶æäº¤ï¼›å¦‚æœä¸åœ¨ binlog ä¸­å­˜åœ¨ï¼Œé‚£ä¹ˆå°†å…¶å›æ»šï¼Œè¿™æ ·å°±ä¿è¯äº†æ•°æ®åœ¨ä¸»åº“å’Œä»åº“ä¹‹é—´çš„ä¸€è‡´æ€§ã€‚</p><p>binlog é»˜è®¤æ˜¯å…³é—­çŠ¶æ€ï¼Œå¯ä»¥åœ¨ MySQL é…ç½®æ–‡ä»¶ï¼ˆmy.cnfï¼‰ä¸­é€šè¿‡é…ç½®å‚æ•° <code>log-bin = [base-name]</code> å¼€å¯è®°å½• binlog æ—¥å¿—ï¼Œå¦‚æœä¸æŒ‡å®š <code>base-name</code>ï¼Œåˆ™é»˜è®¤äºŒè¿›åˆ¶æ—¥å¿—æ–‡ä»¶åä¸ºä¸»æœºåï¼Œå¹¶ä»¥è‡ªå¢çš„æ•°å­—ä½œä¸ºåç¼€ï¼Œæ¯”å¦‚ï¼š<code>mysql-bin.000001</code>ï¼Œæ‰€åœ¨ç›®å½•ä¸ºæ•°æ®åº“æ‰€åœ¨ç›®å½•ï¼ˆdatadirï¼‰ã€‚</p><p>é€šè¿‡ä»¥ä¸‹å‘½ä»¤æ¥æŸ¥è¯¢ binlog æ˜¯å¦å¼€å¯ï¼š</p><p><code>show variables like &#39;log_%&#39;;</code></p><p><img src="/images/mysql/binlog.png"> </p><p>binlog æ ¼å¼åˆ†ä¸º: STATEMENTã€ROW å’Œ MIXED ä¸‰ç§ï¼š</p><ul><li><p>STATEMENT æ ¼å¼çš„ binlog è®°å½•çš„æ˜¯æ•°æ®åº“ä¸Šæ‰§è¡Œçš„åŸç”Ÿ SQL è¯­å¥ã€‚è¿™ç§æ ¼å¼çš„ä¼˜ç‚¹æ˜¯ç®€å•ï¼Œç®€å•åœ°è®°å½•å’Œæ‰§è¡Œè¿™äº›è¯­å¥ï¼Œèƒ½å¤Ÿè®©ä¸»å¤‡ä¿æŒåŒæ­¥ï¼Œåœ¨ä¸»æœåŠ¡å™¨ä¸Šæ‰§è¡Œçš„ SQL è¯­å¥ï¼Œåœ¨ä»æœåŠ¡å™¨ä¸Šæ‰§è¡ŒåŒæ ·çš„è¯­å¥ã€‚å¦ä¸€ä¸ªå¥½å¤„æ˜¯äºŒè¿›åˆ¶æ—¥å¿—é‡Œçš„æ—¶é—´æ›´åŠ ç´§å‡‘ï¼Œæ‰€ä»¥ç›¸å¯¹è€Œè¨€ï¼ŒåŸºäºè¯­å¥çš„å¤åˆ¶æ¨¡å¼ä¸ä¼šä½¿ç”¨å¤ªå¤šå¸¦å®½ï¼ŒåŒæ—¶ä¹ŸèŠ‚çº¦ç£ç›˜ç©ºé—´ã€‚å¹¶ä¸”é€šè¿‡ mysqlbinlog å·¥å…·å®¹æ˜“è¯»æ‡‚å…¶ä¸­çš„å†…å®¹ã€‚ç¼ºç‚¹å°±æ˜¯åŒä¸€æ¡ SQL åœ¨ä¸»åº“å’Œä»åº“ä¸Šæ‰§è¡Œçš„æ—¶é—´å¯èƒ½ç¨å¾®æˆ–å¾ˆå¤§ä¸ç›¸åŒï¼Œå› æ­¤åœ¨ä¼ è¾“çš„äºŒè¿›åˆ¶æ—¥å¿—ä¸­ï¼Œé™¤äº†æŸ¥è¯¢è¯­å¥ï¼Œè¿˜åŒ…æ‹¬äº†ä¸€äº›å…ƒæ•°æ®ä¿¡æ¯ï¼Œå¦‚å½“å‰çš„æ—¶é—´æˆ³ã€‚å³ä¾¿å¦‚æ­¤ï¼Œè¿˜å­˜åœ¨ç€ä¸€äº›æ— æ³•è¢«æ­£ç¡®å¤åˆ¶çš„ SQLã€‚æ¯”å¦‚ï¼Œä½¿ç”¨ <code>INSERT INTO TB1 VALUE(CUURENT_DATE()) </code>è¿™ä¸€æ¡ä½¿ç”¨å‡½æ•°çš„è¯­å¥æ’å…¥çš„æ•°æ®å¤åˆ¶åˆ°å½“å‰ä»æœåŠ¡å™¨ä¸Šæ¥å°±ä¼šå‘ç”Ÿå˜åŒ–ï¼Œå­˜å‚¨è¿‡ç¨‹å’Œè§¦å‘å™¨åœ¨ä½¿ç”¨åŸºäºè¯­å¥çš„å¤åˆ¶æ¨¡å¼æ—¶ä¹Ÿå¯èƒ½å­˜åœ¨é—®é¢˜ï¼›å¦å¤–ä¸€ä¸ªé—®é¢˜å°±æ˜¯åŸºäºè¯­å¥çš„å¤åˆ¶å¿…é¡»æ˜¯ä¸²è¡ŒåŒ–çš„ï¼Œæ¯”å¦‚ï¼šInnoDB çš„ next-key é”ç­‰ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„å­˜å‚¨å¼•æ“éƒ½æ”¯æŒåŸºäºè¯­å¥çš„å¤åˆ¶ï¼›</p></li><li><p>ROW æ ¼å¼æ˜¯ä» MySQL 5.1 å¼€å§‹æ”¯æŒåŸºäºè¡Œçš„å¤åˆ¶ï¼Œä¹Ÿå°±æ˜¯åŸºäºæ•°æ®çš„å¤åˆ¶ï¼ŒåŸºäºè¡Œçš„æ›´æ”¹ã€‚è¿™ç§æ–¹å¼ä¼šå°†å®é™…æ•°æ®è®°å½•åœ¨äºŒè¿›åˆ¶æ—¥å¿—ä¸­ï¼Œå®ƒæœ‰å…¶è‡ªèº«çš„ä¸€äº›ä¼˜ç‚¹å’Œç¼ºç‚¹ï¼Œæœ€å¤§çš„å¥½å¤„æ˜¯å¯ä»¥æ­£ç¡®åœ°å¤åˆ¶æ¯ä¸€è¡Œæ•°æ®ï¼Œä¸€äº›è¯­å¥å¯ä»¥è¢«æ›´åŠ æœ‰æ•ˆåœ°å¤åˆ¶ï¼Œå¦å¤–å°±æ˜¯å‡ ä¹æ²¡æœ‰åŸºäºè¡Œçš„å¤åˆ¶æ¨¡å¼æ— æ³•å¤„ç†çš„åœºæ™¯ï¼Œå¯¹äºæ‰€æœ‰çš„ SQL æ„é€ ã€è§¦å‘å™¨ã€å­˜å‚¨è¿‡ç¨‹ç­‰éƒ½èƒ½æ­£ç¡®æ‰§è¡Œï¼›å®ƒçš„ç¼ºç‚¹å°±æ˜¯äºŒè¿›åˆ¶æ—¥å¿—å¯èƒ½ä¼šå¾ˆå¤§ï¼Œè€Œä¸”ä¸ç›´è§‚ï¼Œæ‰€ä»¥ï¼Œä½ ä¸èƒ½ä½¿ç”¨ mysqlbinlog æ¥æŸ¥çœ‹äºŒè¿›åˆ¶æ—¥å¿—ï¼Œä¹Ÿæ— æ³•é€šè¿‡çœ‹äºŒè¿›åˆ¶æ—¥å¿—åˆ¤æ–­å½“å‰æ‰§è¡Œåˆ°é‚£ä¸€æ¡ SQL è¯­å¥ã€‚ç°åœ¨å¯¹äº ROW æ ¼å¼çš„äºŒè¿›åˆ¶æ—¥å¿—åŸºæœ¬æ˜¯æ ‡é…äº†ï¼Œä¸»è¦æ˜¯å› ä¸ºå®ƒçš„ä¼˜åŠ¿è¿œè¿œå¤§äºç¼ºç‚¹ï¼Œå¹¶ä¸”ç”±äº ROW æ ¼å¼è®°å½•è¡Œæ•°æ®ï¼Œæ‰€ä»¥å¯ä»¥åŸºäºè¿™ç§æ¨¡å¼åšä¸€äº› DBA å·¥å…·ï¼Œæ¯”å¦‚æ•°æ®æ¢å¤ï¼Œä¸åŒæ•°æ®åº“ä¹‹é—´æ•°æ®åŒæ­¥ç­‰ï¼›</p></li><li><p>MIXED ä¹Ÿæ˜¯ MySQL é»˜è®¤ä½¿ç”¨çš„äºŒè¿›åˆ¶æ—¥å¿—è®°å½•æ–¹å¼ï¼Œä½† MIXED æ ¼å¼é»˜è®¤é‡‡ç”¨åŸºäºè¯­å¥çš„å¤åˆ¶ï¼Œä¸€æ—¦å‘ç°åŸºäºè¯­å¥çš„æ— æ³•ç²¾ç¡®çš„å¤åˆ¶æ—¶ï¼Œå°±ä¼šé‡‡ç”¨åŸºäºè¡Œçš„å¤åˆ¶ã€‚æ¯”å¦‚ç”¨åˆ° UUID()ã€USER()ã€CURRENTUSER()ã€ROWCOUNT() ç­‰æ— æ³•ç¡®å®šçš„å‡½æ•°ã€‚</p></li></ul><h5 id="redo-log-å’Œ-binlog-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"><a href="#redo-log-å’Œ-binlog-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ" class="headerlink" title="redo log å’Œ binlog æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"></a>redo log å’Œ binlog æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h5><p>redo logï¼ˆé‡åšæ—¥å¿—ï¼‰å’Œ binlogï¼ˆå½’æ¡£æ—¥å¿—ï¼‰éƒ½æ˜¯ MySQL çš„é‡è¦çš„æ—¥å¿—ï¼Œå®ƒä»¬çš„åŒºåˆ«å¦‚ä¸‹ï¼š</p><ul><li><p>redo log æ˜¯ç‰©ç†æ—¥å¿—ï¼Œè®°å½•çš„æ˜¯â€œåœ¨æŸä¸ªæ•°æ®é¡µä¸Šåšäº†ä»€ä¹ˆä¿®æ”¹â€ã€‚</p></li><li><p>binlog æ˜¯é€»è¾‘æ—¥å¿—ï¼Œè®°å½•çš„æ˜¯è¿™ä¸ªè¯­å¥çš„åŸå§‹é€»è¾‘ï¼Œæ¯”å¦‚â€œç»™ ID=2 è¿™ä¸€è¡Œçš„ c å­—æ®µåŠ  1 â€ã€‚</p></li><li><p>redo log æ˜¯ InnoDB å¼•æ“ç‰¹æœ‰çš„ï¼›binlog æ˜¯ MySQL çš„ Server å±‚å®ç°çš„ï¼Œæ‰€æœ‰å¼•æ“éƒ½å¯ä»¥ä½¿ç”¨ã€‚</p></li><li><p>redo log æ˜¯å¾ªç¯å†™çš„ï¼Œç©ºé—´å›ºå®šä¼šç”¨å®Œï¼›binlog æ˜¯å¯ä»¥è¿½åŠ å†™å…¥çš„ã€‚â€œè¿½åŠ å†™â€æ˜¯æŒ‡ binlog æ–‡ä»¶å†™åˆ°ä¸€å®šå¤§å°åä¼šåˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªï¼Œå¹¶ä¸ä¼šè¦†ç›–ä»¥å‰çš„æ—¥å¿—ã€‚</p></li></ul><p>æœ€å¼€å§‹ MySQL é‡Œå¹¶æ²¡æœ‰ InnoDB å¼•æ“ï¼ŒMySQL è‡ªå¸¦çš„å¼•æ“æ˜¯ MyISAMï¼Œä½†æ˜¯ MyISAM æ²¡æœ‰ crash-safe çš„èƒ½åŠ›ï¼Œbinlog æ—¥å¿—åªèƒ½ç”¨äºå½’æ¡£ã€‚è€Œ InnoDB æ˜¯å¦ä¸€ä¸ªå…¬å¸ä»¥æ’ä»¶å½¢å¼å¼•å…¥ MySQL çš„ï¼Œæ—¢ç„¶åªä¾é  binlog æ˜¯æ²¡æœ‰ crash-safe èƒ½åŠ›çš„ï¼Œæ‰€ä»¥ InnoDB ä½¿ç”¨å¦å¤–ä¸€å¥—æ—¥å¿—ç³»ç»Ÿï¼Œä¹Ÿå°±æ˜¯ redo log æ¥å®ç° crash-safe èƒ½åŠ›ã€‚</p><h5 id="ä»€ä¹ˆæ˜¯-crash-safeï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯-crash-safeï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯ crash-safeï¼Ÿ"></a>ä»€ä¹ˆæ˜¯ crash-safeï¼Ÿ</h5><p>crash-safe æ˜¯æŒ‡å‘ç”Ÿå®•æœºç­‰æ„å¤–æƒ…å†µä¸‹ï¼ŒæœåŠ¡å™¨é‡å¯åæ•°æ®ä¾ç„¶ä¸ä¼šä¸¢å¤±çš„æƒ…å†µã€‚</p><h5 id="ä»€ä¹ˆæ˜¯è„é¡µå’Œå¹²å‡€é¡µï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯è„é¡µå’Œå¹²å‡€é¡µï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯è„é¡µå’Œå¹²å‡€é¡µï¼Ÿ"></a>ä»€ä¹ˆæ˜¯è„é¡µå’Œå¹²å‡€é¡µï¼Ÿ</h5><p>MySQL ä¸ºäº†æ“ä½œçš„æ€§èƒ½ä¼˜åŒ–ï¼Œä¼šæŠŠæ•°æ®æ›´æ–°å…ˆæ”¾å…¥å†…å­˜ä¸­ï¼Œä¹‹åå†ç»Ÿä¸€æ›´æ–°åˆ°ç£ç›˜ã€‚å½“å†…å­˜æ•°æ®å’Œç£ç›˜æ•°æ®å†…å®¹ä¸ä¸€è‡´çš„æ—¶å€™ï¼Œæˆ‘ä»¬ç§°è¿™ä¸ªå†…å­˜é¡µä¸ºè„é¡µï¼›å†…å­˜æ•°æ®å†™åˆ°ç£ç›˜åï¼Œå†…å­˜çš„æ•°æ®å’Œç£ç›˜ä¸Šçš„å†…å®¹å°±ä¸€è‡´äº†ï¼Œæˆ‘ä»¬ç§°ä¸ºâ€œå¹²å‡€é¡µâ€ã€‚</p><h5 id="ä»€ä¹ˆæƒ…å†µä¸‹ä¼šå¼•å‘-MySQL-åˆ·è„é¡µï¼ˆflushï¼‰çš„æ“ä½œï¼Ÿ"><a href="#ä»€ä¹ˆæƒ…å†µä¸‹ä¼šå¼•å‘-MySQL-åˆ·è„é¡µï¼ˆflushï¼‰çš„æ“ä½œï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæƒ…å†µä¸‹ä¼šå¼•å‘ MySQL åˆ·è„é¡µï¼ˆflushï¼‰çš„æ“ä½œï¼Ÿ"></a>ä»€ä¹ˆæƒ…å†µä¸‹ä¼šå¼•å‘ MySQL åˆ·è„é¡µï¼ˆflushï¼‰çš„æ“ä½œï¼Ÿ</h5><ul><li><p>å†…å­˜å†™æ»¡äº†ï¼Œè¿™ä¸ªæ—¶å€™å°±ä¼šå¼•å‘ flush æ“ä½œï¼Œå¯¹åº”åˆ° InnoDB å°±æ˜¯ redo log å†™æ»¡äº†ï¼›</p></li><li><p>ç³»ç»Ÿçš„å†…å­˜ä¸è¶³äº†ï¼Œå½“éœ€è¦æ–°çš„å†…å­˜é¡µçš„æ—¶å€™ï¼Œå°±ä¼šæ·˜æ±°ä¸€äº›å†…å­˜é¡µï¼Œå¦‚æœæ·˜æ±°çš„æ˜¯è„é¡µè¿™ä¸ªæ—¶å€™å°±ä¼šè§¦å‘ flush æ“ä½œï¼›</p></li><li><p>ç³»ç»Ÿç©ºé—²çš„æ—¶å€™ï¼ŒMySQL ä¼šåŒæ­¥å†…å­˜ä¸­çš„æ•°æ®åˆ°ç£ç›˜ä¹Ÿä¼šè§¦å‘ flush æ“ä½œï¼›</p></li><li><p>MySQL æœåŠ¡å…³é—­çš„æ—¶å€™ä¹Ÿä¼šåˆ·è„é¡µï¼Œè§¦å‘ flush æ“ä½œã€‚</p></li></ul><h5 id="MySQL-åˆ·è„é¡µçš„é€Ÿåº¦å¾ˆæ…¢å¯èƒ½æ˜¯ä»€ä¹ˆåŸå› ï¼Ÿ"><a href="#MySQL-åˆ·è„é¡µçš„é€Ÿåº¦å¾ˆæ…¢å¯èƒ½æ˜¯ä»€ä¹ˆåŸå› ï¼Ÿ" class="headerlink" title="MySQL åˆ·è„é¡µçš„é€Ÿåº¦å¾ˆæ…¢å¯èƒ½æ˜¯ä»€ä¹ˆåŸå› ï¼Ÿ"></a>MySQL åˆ·è„é¡µçš„é€Ÿåº¦å¾ˆæ…¢å¯èƒ½æ˜¯ä»€ä¹ˆåŸå› ï¼Ÿ</h5><p>åœ¨ MySQL ä¸­å•ç‹¬åˆ·ä¸€ä¸ªè„é¡µçš„é€Ÿåº¦æ˜¯å¾ˆå¿«çš„ï¼Œå¦‚æœå‘ç°åˆ·è„é¡µçš„é€Ÿåº¦å¾ˆæ…¢ï¼Œè¯´æ˜è§¦å‘äº† MySQL åˆ·è„é¡µçš„â€œè¿åâ€æœºåˆ¶ï¼ŒMySQL çš„â€œè¿åâ€æœºåˆ¶æ˜¯æŒ‡å½“ MySQL åˆ·è„é¡µçš„æ—¶å€™å¦‚æœå‘ç°ç›¸é‚»çš„æ•°æ®é¡µä¹Ÿæ˜¯è„é¡µä¹Ÿä¼šä¸€èµ·åˆ·æ‰ï¼Œè€Œè¿™ä¸ªåŠ¨ä½œå¯ä»¥ä¸€ç›´è”“å»¶ä¸‹å»ï¼Œè¿™å°±æ˜¯å¯¼è‡´ MySQL åˆ·è„é¡µæ…¢çš„åŸå› äº†ã€‚</p><h5 id="å¦‚ä½•æ§åˆ¶-MySQL-åªåˆ·æ–°å½“å‰è„é¡µï¼Ÿ"><a href="#å¦‚ä½•æ§åˆ¶-MySQL-åªåˆ·æ–°å½“å‰è„é¡µï¼Ÿ" class="headerlink" title="å¦‚ä½•æ§åˆ¶ MySQL åªåˆ·æ–°å½“å‰è„é¡µï¼Ÿ"></a>å¦‚ä½•æ§åˆ¶ MySQL åªåˆ·æ–°å½“å‰è„é¡µï¼Ÿ</h5><p>åœ¨ InnoDB ä¸­è®¾ç½® innodbflushneighbors è¿™ä¸ªå‚æ•°çš„å€¼ä¸º 0ï¼Œæ¥è§„å®š MySQL åªåˆ·å½“å‰è„é¡µï¼ŒMySQL 8 è¿™ä¸ªå€¼é»˜è®¤æ˜¯ 0ã€‚</p><h5 id="MySQL-çš„-WAL-æŠ€æœ¯æ˜¯è§£å†³ä»€ä¹ˆé—®é¢˜çš„ï¼Ÿ"><a href="#MySQL-çš„-WAL-æŠ€æœ¯æ˜¯è§£å†³ä»€ä¹ˆé—®é¢˜çš„ï¼Ÿ" class="headerlink" title="MySQL çš„ WAL æŠ€æœ¯æ˜¯è§£å†³ä»€ä¹ˆé—®é¢˜çš„ï¼Ÿ"></a>MySQL çš„ WAL æŠ€æœ¯æ˜¯è§£å†³ä»€ä¹ˆé—®é¢˜çš„ï¼Ÿ</h5><p>A.é˜²æ­¢è¯¯åˆ é™¤ï¼Œæ‰¾å›æ•°æ®ç”¨çš„</p><p>B.å®¹ç¾æ¢å¤ï¼Œä¸ºäº†è¿˜åŸå¼‚å¸¸æ•°æ®ç”¨çš„</p><p>C.äº‹åŠ¡å¤„ç†ï¼Œä¸ºäº†æ•°æ®åº“çš„ç¨³å®šæ€§</p><p>D.ä¸ºäº†é™ä½ IO æˆæœ¬ </p><p>ç­”ï¼šD é¢˜ç›®è§£æï¼šWAL æŠ€æœ¯çš„å…¨ç§°æ˜¯ Write Ahead Loggingï¼ˆä¸­æ–‡ï¼šé¢„å†™å¼æ—¥å¿—ï¼‰ï¼Œæ˜¯å…ˆå†™æ—¥å¿—ï¼Œå†å†™ç£ç›˜çš„æ–¹å¼ï¼Œå› ä¸ºæ¯æ¬¡æ›´æ–°éƒ½å†™ç£ç›˜çš„è¯ IO æˆæœ¬å¾ˆé«˜ï¼Œæ‰€ä»¥æ‰æœ‰äº† WAL æŠ€æœ¯ã€‚</p><h5 id="ä¸ºä»€ä¹ˆæœ‰æ—¶å€™ä¼šæ„Ÿè§‰-MySQL-å¶å°”å¡ä¸€ä¸‹ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆæœ‰æ—¶å€™ä¼šæ„Ÿè§‰-MySQL-å¶å°”å¡ä¸€ä¸‹ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆæœ‰æ—¶å€™ä¼šæ„Ÿè§‰ MySQL å¶å°”å¡ä¸€ä¸‹ï¼Ÿ"></a>ä¸ºä»€ä¹ˆæœ‰æ—¶å€™ä¼šæ„Ÿè§‰ MySQL å¶å°”å¡ä¸€ä¸‹ï¼Ÿ</h5><p>å¦‚æœå¶å°”æ„Ÿè§‰ MySQL å¡ä¸€ä¸‹ï¼Œå¯èƒ½æ˜¯ MySQL æ­£åœ¨åˆ·è„é¡µï¼Œæ­£åœ¨æŠŠå†…å­˜ä¸­çš„æ›´æ–°æ“ä½œåˆ·åˆ°ç£ç›˜ä¸­ã€‚</p><h5 id="redo-log-å’Œ-binlog-æ˜¯æ€ä¹ˆå…³è”çš„"><a href="#redo-log-å’Œ-binlog-æ˜¯æ€ä¹ˆå…³è”çš„" class="headerlink" title="redo log å’Œ binlog æ˜¯æ€ä¹ˆå…³è”çš„?"></a>redo log å’Œ binlog æ˜¯æ€ä¹ˆå…³è”çš„?</h5><p>å®ƒä»¬æœ‰ä¸€ä¸ªå…±åŒçš„æ•°æ®å­—æ®µï¼Œå« XIDã€‚å´©æºƒæ¢å¤çš„æ—¶å€™ï¼Œä¼šæŒ‰é¡ºåºæ‰«æ redo logï¼š</p><ul><li><p>å¦‚æœç¢°åˆ°æ—¢æœ‰ prepareã€åˆæœ‰ commit çš„ redo logï¼Œå°±ç›´æ¥æäº¤ï¼›</p></li><li><p>å¦‚æœç¢°åˆ°åªæœ‰ parepareã€è€Œæ²¡æœ‰ commit çš„ redo logï¼Œå°±æ‹¿ç€ XID å» binlog æ‰¾å¯¹åº”çš„äº‹åŠ¡ã€‚</p></li></ul><h5 id="MySQL-æ€ä¹ˆçŸ¥é“-binlog-æ˜¯å®Œæ•´çš„"><a href="#MySQL-æ€ä¹ˆçŸ¥é“-binlog-æ˜¯å®Œæ•´çš„" class="headerlink" title="MySQL æ€ä¹ˆçŸ¥é“ binlog æ˜¯å®Œæ•´çš„?"></a>MySQL æ€ä¹ˆçŸ¥é“ binlog æ˜¯å®Œæ•´çš„?</h5><ul><li><p>statement æ ¼å¼çš„ binlogï¼Œå®Œæ•´çš„æ ‡è¯†æ˜¯æœ€åæœ‰ COMMIT å…³é”®å­—ã€‚</p></li><li><p>row æ ¼å¼çš„ binlogï¼Œå®Œæ•´çš„æ ‡è¯†æ˜¯æœ€åä¼šæœ‰ä¸€ä¸ª XID event å…³é”®å­—ã€‚</p></li></ul><h5 id="MySQL-ä¸­å¯ä¸å¯ä»¥åªè¦-binlogï¼Œä¸è¦-redo-logï¼Ÿ"><a href="#MySQL-ä¸­å¯ä¸å¯ä»¥åªè¦-binlogï¼Œä¸è¦-redo-logï¼Ÿ" class="headerlink" title="MySQL ä¸­å¯ä¸å¯ä»¥åªè¦ binlogï¼Œä¸è¦ redo logï¼Ÿ"></a>MySQL ä¸­å¯ä¸å¯ä»¥åªè¦ binlogï¼Œä¸è¦ redo logï¼Ÿ</h5><p>ä¸å¯ä»¥ï¼Œbinlog æ²¡æœ‰å´©æºƒæ¢å¤çš„èƒ½åŠ›ã€‚</p><h5 id="MySQL-ä¸­å¯ä¸å¯ä»¥åªè¦-redo-logï¼Œä¸è¦-binlogï¼Ÿ"><a href="#MySQL-ä¸­å¯ä¸å¯ä»¥åªè¦-redo-logï¼Œä¸è¦-binlogï¼Ÿ" class="headerlink" title="MySQL ä¸­å¯ä¸å¯ä»¥åªè¦ redo logï¼Œä¸è¦ binlogï¼Ÿ"></a>MySQL ä¸­å¯ä¸å¯ä»¥åªè¦ redo logï¼Œä¸è¦ binlogï¼Ÿ</h5><p>ä¸å¯ä»¥ï¼ŒåŸå› æœ‰ä»¥ä¸‹ä¸¤ä¸ªï¼š</p><ul><li><p>redo log æ˜¯å¾ªç¯å†™ä¸èƒ½ä¿è¯æ‰€æœ‰çš„å†å²æ•°æ®ï¼Œè¿™äº›å†å²æ•°æ®åªèƒ½åœ¨ binlog ä¸­æ‰¾åˆ°ï¼›</p></li><li><p>binlog æ˜¯é«˜å¯ç”¨çš„åŸºç¡€ï¼Œé«˜å¯ç”¨çš„å®ç°åŸç†å°±æ˜¯ binlog å¤åˆ¶ã€‚</p></li></ul><h5 id="ä¸ºä»€ä¹ˆ-binlog-cache-æ˜¯æ¯ä¸ªçº¿ç¨‹è‡ªå·±ç»´æŠ¤çš„ï¼Œè€Œ-redo-log-buffer-æ˜¯å…¨å±€å…±ç”¨çš„ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆ-binlog-cache-æ˜¯æ¯ä¸ªçº¿ç¨‹è‡ªå·±ç»´æŠ¤çš„ï¼Œè€Œ-redo-log-buffer-æ˜¯å…¨å±€å…±ç”¨çš„ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆ binlog cache æ˜¯æ¯ä¸ªçº¿ç¨‹è‡ªå·±ç»´æŠ¤çš„ï¼Œè€Œ redo log buffer æ˜¯å…¨å±€å…±ç”¨çš„ï¼Ÿ"></a>ä¸ºä»€ä¹ˆ binlog cache æ˜¯æ¯ä¸ªçº¿ç¨‹è‡ªå·±ç»´æŠ¤çš„ï¼Œè€Œ redo log buffer æ˜¯å…¨å±€å…±ç”¨çš„ï¼Ÿ</h5><p>å› ä¸º binlog æ˜¯ä¸èƒ½â€œè¢«æ‰“æ–­çš„â€ï¼Œä¸€ä¸ªäº‹åŠ¡çš„ binlog å¿…é¡»è¿ç»­å†™ï¼Œå› æ­¤è¦æ•´ä¸ªäº‹åŠ¡å®Œæˆåï¼Œå†ä¸€èµ·å†™åˆ°æ–‡ä»¶é‡Œã€‚è€Œ redo log å¹¶æ²¡æœ‰è¿™ä¸ªè¦æ±‚ï¼Œä¸­é—´æœ‰ç”Ÿæˆçš„æ—¥å¿—å¯ä»¥å†™åˆ° redo log buffer ä¸­ï¼Œredo log buffer ä¸­çš„å†…å®¹è¿˜èƒ½â€œæ­ä¾¿è½¦â€ï¼Œå…¶ä»–äº‹åŠ¡æäº¤çš„æ—¶å€™å¯ä»¥è¢«ä¸€èµ·å†™åˆ°ç£ç›˜ä¸­ã€‚</p><h5 id="äº‹åŠ¡æ‰§è¡ŒæœŸé—´ï¼Œè¿˜æœªæäº¤ï¼Œå¦‚æœå‘ç”Ÿ-crashï¼Œredo-log-ä¸¢å¤±ï¼Œä¼šå¯¼è‡´ä¸»å¤‡ä¸ä¸€è‡´å‘¢ï¼Ÿ"><a href="#äº‹åŠ¡æ‰§è¡ŒæœŸé—´ï¼Œè¿˜æœªæäº¤ï¼Œå¦‚æœå‘ç”Ÿ-crashï¼Œredo-log-ä¸¢å¤±ï¼Œä¼šå¯¼è‡´ä¸»å¤‡ä¸ä¸€è‡´å‘¢ï¼Ÿ" class="headerlink" title="äº‹åŠ¡æ‰§è¡ŒæœŸé—´ï¼Œè¿˜æœªæäº¤ï¼Œå¦‚æœå‘ç”Ÿ crashï¼Œredo log ä¸¢å¤±ï¼Œä¼šå¯¼è‡´ä¸»å¤‡ä¸ä¸€è‡´å‘¢ï¼Ÿ"></a>äº‹åŠ¡æ‰§è¡ŒæœŸé—´ï¼Œè¿˜æœªæäº¤ï¼Œå¦‚æœå‘ç”Ÿ crashï¼Œredo log ä¸¢å¤±ï¼Œä¼šå¯¼è‡´ä¸»å¤‡ä¸ä¸€è‡´å‘¢ï¼Ÿ</h5><p>ä¸ä¼šï¼Œå› ä¸ºè¿™æ—¶å€™ binlog ä¹Ÿè¿˜åœ¨ binlog cache é‡Œï¼Œæ²¡å‘ç»™å¤‡åº“ï¼Œcrash ä»¥å redo log å’Œ binlog éƒ½æ²¡æœ‰äº†ï¼Œä»ä¸šåŠ¡è§’åº¦çœ‹è¿™ä¸ªäº‹åŠ¡ä¹Ÿæ²¡æœ‰æäº¤ï¼Œæ‰€ä»¥æ•°æ®æ˜¯ä¸€è‡´çš„ã€‚</p><h5 id="åœ¨-MySQL-ä¸­ç”¨ä»€ä¹ˆæœºåˆ¶æ¥ä¼˜åŒ–éšæœºè¯»-å†™ç£ç›˜å¯¹-IO-çš„æ¶ˆè€—ï¼Ÿ"><a href="#åœ¨-MySQL-ä¸­ç”¨ä»€ä¹ˆæœºåˆ¶æ¥ä¼˜åŒ–éšæœºè¯»-å†™ç£ç›˜å¯¹-IO-çš„æ¶ˆè€—ï¼Ÿ" class="headerlink" title="åœ¨ MySQL ä¸­ç”¨ä»€ä¹ˆæœºåˆ¶æ¥ä¼˜åŒ–éšæœºè¯»/å†™ç£ç›˜å¯¹ IO çš„æ¶ˆè€—ï¼Ÿ"></a>åœ¨ MySQL ä¸­ç”¨ä»€ä¹ˆæœºåˆ¶æ¥ä¼˜åŒ–éšæœºè¯»/å†™ç£ç›˜å¯¹ IO çš„æ¶ˆè€—ï¼Ÿ</h5><p>redo log æ˜¯ç”¨æ¥èŠ‚çœéšæœºå†™ç£ç›˜çš„ IO æ¶ˆè€—ï¼Œè€Œ change buffer ä¸»è¦æ˜¯èŠ‚çœéšæœºè¯»ç£ç›˜çš„ IO æ¶ˆè€—ã€‚redo log ä¼šæŠŠ MySQL çš„æ›´æ–°æ“ä½œå…ˆè®°å½•åˆ°å†…å­˜ä¸­ï¼Œä¹‹åå†ç»Ÿä¸€æ›´æ–°åˆ°ç£ç›˜ï¼Œè€Œ change buffer ä¹Ÿæ˜¯æŠŠå…³é”®æŸ¥è¯¢æ•°æ®å…ˆåŠ è½½åˆ°å†…å­˜ä¸­ï¼Œä»¥ä¾¿ä¼˜åŒ– MySQL çš„æŸ¥è¯¢ã€‚</p><h5 id="ä»¥ä¸‹è¯´æ³•é”™è¯¯çš„æ˜¯ï¼Ÿ"><a href="#ä»¥ä¸‹è¯´æ³•é”™è¯¯çš„æ˜¯ï¼Ÿ" class="headerlink" title="ä»¥ä¸‹è¯´æ³•é”™è¯¯çš„æ˜¯ï¼Ÿ"></a>ä»¥ä¸‹è¯´æ³•é”™è¯¯çš„æ˜¯ï¼Ÿ</h5><p>A.redo log æ˜¯ InnoDB å¼•æ“ç‰¹æœ‰çš„ï¼Œå®ƒçš„å›ºå®šå¤§å°çš„ </p><p>B.redo log æ—¥å¿—æ˜¯ä¸å…¨çš„ï¼Œåªæœ‰æœ€æ–°çš„ä¸€äº›æ—¥å¿—ï¼Œè¿™å’Œå®ƒçš„å†…å­˜å¤§å°æœ‰å…³</p><p>C.redo log å¯ä»¥ä¿è¯æ•°æ®åº“å¼‚å¸¸é‡å¯ä¹‹åï¼Œæ•°æ®ä¸ä¸¢å¤±</p><p>D.binlog æ˜¯ MySQL è‡ªå¸¦çš„æ—¥å¿—ï¼Œå®ƒèƒ½ä¿è¯æ•°æ®åº“å¼‚å¸¸é‡å¯ä¹‹åï¼Œæ•°æ®ä¸ä¸¢å¤± </p><p>ç­”ï¼šD é¢˜ç›®è§£æï¼šbinlog æ˜¯ MySQL è‡ªå¸¦çš„æ—¥å¿—ï¼Œä½†å®ƒå¹¶ä¸èƒ½ä¿è¯æ•°æ®åº“å¼‚å¸¸é‡å¯ä¹‹åæ•°æ®ä¸ä¸¢å¤±ã€‚</p><h5 id="ä»¥ä¸‹è¯´æ³•æ­£ç¡®çš„æ˜¯ï¼Ÿ"><a href="#ä»¥ä¸‹è¯´æ³•æ­£ç¡®çš„æ˜¯ï¼Ÿ" class="headerlink" title="ä»¥ä¸‹è¯´æ³•æ­£ç¡®çš„æ˜¯ï¼Ÿ"></a>ä»¥ä¸‹è¯´æ³•æ­£ç¡®çš„æ˜¯ï¼Ÿ</h5><p>A.redo log æ—¥å¿—æ˜¯è¿½åŠ å†™çš„ï¼Œåé¢çš„æ—¥å¿—å¹¶ä¸ä¼šè¦†ç›–å‰é¢çš„æ—¥å¿—</p><p>B.binlog æ—¥å¿—æ˜¯è¿½åŠ å†™çš„ï¼Œåé¢çš„æ—¥å¿—å¹¶ä¸ä¼šè¦†ç›–å‰é¢çš„æ—¥å¿—</p><p>C.redo log å’Œ binlog æ—¥å¿—éƒ½æ˜¯è¿½åŠ å†™çš„ï¼Œåé¢çš„æ—¥å¿—å¹¶ä¸ä¼šè¦†ç›–å‰é¢çš„æ—¥å¿— </p><p>D.ä»¥ä¸Šè¯´æ³•éƒ½æ­£ç¡®</p><p>ç­”ï¼šB é¢˜ç›®è§£æï¼šbinlog æ—¥å¿—æ˜¯è¿½åŠ å†™çš„ï¼Œåé¢çš„æ—¥å¿—å¹¶ä¸ä¼šè¦†ç›–å‰é¢çš„æ—¥å¿—ï¼Œredo log æ—¥å¿—æ˜¯å›ºå®šå¤§å°çš„ï¼Œåé¢çš„æ—¥å¿—ä¼šè¦†ç›–å‰é¢çš„æ—¥å¿—ã€‚</p><h5 id="æœ‰æ²¡æœ‰åŠæ³•æŠŠ-MySQL-çš„æ•°æ®æ¢å¤åˆ°è¿‡å»æŸä¸ªæŒ‡å®šçš„æ—¶é—´èŠ‚ç‚¹ï¼Ÿæ€ä¹ˆæ¢å¤ï¼Ÿ"><a href="#æœ‰æ²¡æœ‰åŠæ³•æŠŠ-MySQL-çš„æ•°æ®æ¢å¤åˆ°è¿‡å»æŸä¸ªæŒ‡å®šçš„æ—¶é—´èŠ‚ç‚¹ï¼Ÿæ€ä¹ˆæ¢å¤ï¼Ÿ" class="headerlink" title="æœ‰æ²¡æœ‰åŠæ³•æŠŠ MySQL çš„æ•°æ®æ¢å¤åˆ°è¿‡å»æŸä¸ªæŒ‡å®šçš„æ—¶é—´èŠ‚ç‚¹ï¼Ÿæ€ä¹ˆæ¢å¤ï¼Ÿ"></a>æœ‰æ²¡æœ‰åŠæ³•æŠŠ MySQL çš„æ•°æ®æ¢å¤åˆ°è¿‡å»æŸä¸ªæŒ‡å®šçš„æ—¶é—´èŠ‚ç‚¹ï¼Ÿæ€ä¹ˆæ¢å¤ï¼Ÿ</h5><p>å¯ä»¥æ¢å¤ï¼Œåªè¦ä½ å¤‡ä»½äº†è¿™æ®µæ—¶é—´çš„æ‰€æœ‰ binlogï¼ŒåŒæ—¶åšäº†å…¨é‡æ•°æ®åº“çš„å®šæœŸå¤‡ä»½ï¼Œæ¯”å¦‚ï¼Œä¸€å¤©ä¸€å¤‡ï¼Œæˆ–è€…ä¸‰å¤©ä¸€å¤‡ï¼Œè¿™å–å†³äºä½ ä»¬çš„å¤‡ä»½ç­–ç•¥ï¼Œè¿™ä¸ªæ—¶å€™ä½ å°±å¯ä»¥æŠŠä¹‹å‰å¤‡ä»½çš„æ•°æ®åº“å…ˆè¿˜åŸåˆ°æµ‹è¯•åº“ï¼Œä»å¤‡ä»½çš„æ—¶é—´ç‚¹å¼€å§‹ï¼Œå°†å¤‡ä»½çš„ binlog ä¾æ¬¡å–å‡ºæ¥ï¼Œé‡æ”¾åˆ°ä½ è¦æ¢å¤æ•°æ®çš„é‚£ä¸ªæ—¶åˆ»ï¼Œè¿™ä¸ªæ—¶å€™å°±å®Œæˆäº†æ•°æ®åˆ°æŒ‡å®šèŠ‚ç‚¹çš„æ¢å¤ã€‚æ¯”å¦‚ï¼Œä»Šå¤©æ—©ä¸Š 9 ç‚¹çš„æ—¶å€™ï¼Œä½ æƒ³æŠŠæ•°æ®æ¢å¤æˆä»Šå¤©æ—©ä¸Š 6:00:00 çš„çŠ¶æ€ï¼Œè¿™ä¸ªæ—¶å€™ä½ å¯ä»¥å…ˆå–å‡ºä»Šå¤©å‡Œæ™¨ï¼ˆ00:01:59ï¼‰å¤‡ä»½çš„æ•°æ®åº“æ–‡ä»¶ï¼Œè¿˜åŸåˆ°æµ‹è¯•åº“ï¼Œå†ä» binlog æ–‡ä»¶ä¸­ä¾æ¬¡å–å‡º 00:01:59 ä¹‹åçš„æ“ä½œä¿¡æ¯ï¼Œé‡æ”¾åˆ° 6:00:00 è¿™ä¸ªæ—¶åˆ»ï¼Œè¿™å°±å®Œæˆäº†æ•°æ®åº“çš„è¿˜åŸã€‚</p><h4 id="MySQL-å‘½ä»¤å’Œå†…ç½®å‡½æ•°"><a href="#MySQL-å‘½ä»¤å’Œå†…ç½®å‡½æ•°" class="headerlink" title="MySQL å‘½ä»¤å’Œå†…ç½®å‡½æ•°"></a>MySQL å‘½ä»¤å’Œå†…ç½®å‡½æ•°</h4><h5 id="å¦‚ä½•ç”¨å‘½ä»¤è¡Œæ–¹å¼è¿æ¥-MySQL-æ•°æ®åº“ï¼Ÿ"><a href="#å¦‚ä½•ç”¨å‘½ä»¤è¡Œæ–¹å¼è¿æ¥-MySQL-æ•°æ®åº“ï¼Ÿ" class="headerlink" title="å¦‚ä½•ç”¨å‘½ä»¤è¡Œæ–¹å¼è¿æ¥ MySQL æ•°æ®åº“ï¼Ÿ"></a>å¦‚ä½•ç”¨å‘½ä»¤è¡Œæ–¹å¼è¿æ¥ MySQL æ•°æ®åº“ï¼Ÿ</h5><p>ä½¿ç”¨ mysql -uç”¨æˆ·å -på¯†ç ; è¾“å…¥ç”¨æˆ·åå’Œå¯†ç å°±å¯ä»¥æ­£å¸¸è¿›å…¥æ•°æ®åº“è¿æ¥äº†ï¼Œå®ä¾‹å¦‚ä¸‹ï¼š</p><p><code>mysql -uroot -p123456;</code></p><p>å…¶ä¸­ï¼Œç”¨æˆ·åä¸º rootï¼Œå¯†ç ä¸º 123456ã€‚</p><h5 id="å…³äºå‘½ä»¤-mysql-h-127-0-0-1-uroot-P-3307-p3307-ä»¥ä¸‹è¯´æ³•é”™è¯¯çš„æ˜¯ï¼Ÿ"><a href="#å…³äºå‘½ä»¤-mysql-h-127-0-0-1-uroot-P-3307-p3307-ä»¥ä¸‹è¯´æ³•é”™è¯¯çš„æ˜¯ï¼Ÿ" class="headerlink" title="å…³äºå‘½ä»¤ mysql -h 127.0.0.1 -uroot -P 3307 -p3307 ä»¥ä¸‹è¯´æ³•é”™è¯¯çš„æ˜¯ï¼Ÿ"></a>å…³äºå‘½ä»¤ mysql -h 127.0.0.1 -uroot -P 3307 -p3307 ä»¥ä¸‹è¯´æ³•é”™è¯¯çš„æ˜¯ï¼Ÿ</h5><p>A.-h å’Œ -P å¯ä»¥çœç•¥ </p><p>B.-u å’Œç”¨æˆ·åä¹‹é—´ä¸èƒ½æœ‰ç©ºæ ¼</p><p>C.-p å’Œå¯†ç ä¹‹é—´ä¸èƒ½ç”¨ç©ºæ ¼</p><p>D.å°å†™ -p å¯¹åº”çš„æ˜¯ç”¨æˆ·å¯†ç ï¼Œå¤§å†™ -P å¯¹åº”çš„æ˜¯ MySQL æœåŠ¡å™¨çš„ç«¯å£</p><p>ç­”ï¼šB é¢˜ç›®è§£æï¼š-p å’Œå¯†ç ä¹‹é—´ä¸èƒ½ç”¨ç©ºæ ¼ï¼Œå¦åˆ™ç©ºæ ¼ä¼šè¢«è¯†åˆ«ä¸ºå¯†ç çš„ä¸€éƒ¨åˆ†ï¼Œæç¤ºå¯†ç é”™è¯¯ã€‚-u å’Œç”¨æˆ·åä¹‹é—´å¯ä»¥æœ‰ç©ºæ ¼ã€‚</p><h5 id="å¦‚ä½•åˆ›å»ºç”¨æˆ·ï¼Ÿå¹¶ç»™ç”¨æˆ·æˆæƒï¼Ÿ"><a href="#å¦‚ä½•åˆ›å»ºç”¨æˆ·ï¼Ÿå¹¶ç»™ç”¨æˆ·æˆæƒï¼Ÿ" class="headerlink" title="å¦‚ä½•åˆ›å»ºç”¨æˆ·ï¼Ÿå¹¶ç»™ç”¨æˆ·æˆæƒï¼Ÿ"></a>å¦‚ä½•åˆ›å»ºç”¨æˆ·ï¼Ÿå¹¶ç»™ç”¨æˆ·æˆæƒï¼Ÿ</h5><p>åˆ›å»ºç”¨æˆ·ä½¿ç”¨å…³é”®å­—ï¼šCREATE USER ï¼Œæˆæƒä½¿ç”¨å…³é”®å­—ï¼š GRANT ï¼Œå…·ä½“å®ç°è„šæœ¬å¦‚ä¸‹ï¼š</p><pre><code class="hljs mysql">-- åˆ›å»ºç”¨æˆ·laowang create user &#39;laowang&#39;@&#39;localhost&#39; identified by &#39;123456&#39;; -- æˆæƒ test æ•°æ®åº“ç»™ laowang grant all on test.* to &#39;laowang&#39;@&#39;localhost&#39;</code></pre><h5 id="å¦‚ä½•ä¿®æ”¹-MySQL-å¯†ç ï¼Ÿ"><a href="#å¦‚ä½•ä¿®æ”¹-MySQL-å¯†ç ï¼Ÿ" class="headerlink" title="å¦‚ä½•ä¿®æ”¹ MySQL å¯†ç ï¼Ÿ"></a>å¦‚ä½•ä¿®æ”¹ MySQL å¯†ç ï¼Ÿ</h5><p>ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ï¼Œä¿®æ”¹å¯†ç ï¼š</p><p><code>mysqladmin -uç”¨æˆ·å -pæ—§å¯†ç  password æ–°å¯†ç ;</code></p><p>æ³¨æ„ï¼šåˆšå¼€å§‹ root æ²¡æœ‰å¯†ç ï¼Œæ‰€ä»¥ -p æ—§å¯†ç ä¸€é¡¹å°±å¯ä»¥çœç•¥äº†ã€‚</p><h5 id="å¦‚ä½•ä½¿ç”¨-SQL-åˆ›å»ºæ•°æ®åº“ï¼Œå¹¶è®¾ç½®æ•°æ®åº“çš„ç¼–ç æ ¼å¼ï¼Ÿ"><a href="#å¦‚ä½•ä½¿ç”¨-SQL-åˆ›å»ºæ•°æ®åº“ï¼Œå¹¶è®¾ç½®æ•°æ®åº“çš„ç¼–ç æ ¼å¼ï¼Ÿ" class="headerlink" title="å¦‚ä½•ä½¿ç”¨ SQL åˆ›å»ºæ•°æ®åº“ï¼Œå¹¶è®¾ç½®æ•°æ®åº“çš„ç¼–ç æ ¼å¼ï¼Ÿ"></a>å¦‚ä½•ä½¿ç”¨ SQL åˆ›å»ºæ•°æ®åº“ï¼Œå¹¶è®¾ç½®æ•°æ®åº“çš„ç¼–ç æ ¼å¼ï¼Ÿ</h5><p>åˆ›å»ºæ•°æ®åº“å¯ä½¿ç”¨å…³é”®å­—ï¼š CREATE DATABASE ï¼Œè®¾ç½®ç¼–ç æ ¼å¼ä½¿ç”¨å…³é”®å­—ï¼š CHARSET ï¼Œå…·ä½“ SQL å¦‚ä¸‹ï¼š</p><pre><code class="hljs mysql">create database learndb default charset utf8 collate utf8_general_ci;</code></pre><h5 id="å¦‚ä½•ä¿®æ”¹æ•°æ®åº“ã€è¡¨çš„ç¼–ç æ ¼å¼ï¼Ÿ"><a href="#å¦‚ä½•ä¿®æ”¹æ•°æ®åº“ã€è¡¨çš„ç¼–ç æ ¼å¼ï¼Ÿ" class="headerlink" title="å¦‚ä½•ä¿®æ”¹æ•°æ®åº“ã€è¡¨çš„ç¼–ç æ ¼å¼ï¼Ÿ"></a>å¦‚ä½•ä¿®æ”¹æ•°æ®åº“ã€è¡¨çš„ç¼–ç æ ¼å¼ï¼Ÿ</h5><p>ä½¿ç”¨ alter å…³é”®å­—è®¾ç½®åº“æˆ–è¡¨çš„ç¼–ç æ ¼å¼å³å¯ï¼Œå…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p><pre><code class="hljs mysql">mysql&gt; alter database dbname default character set utf8; mysql&gt; alter table t default character set utf8;</code></pre><h5 id="å¦‚ä½•ä½¿ç”¨-SQL-åˆ›å»ºè¡¨ï¼Ÿ"><a href="#å¦‚ä½•ä½¿ç”¨-SQL-åˆ›å»ºè¡¨ï¼Ÿ" class="headerlink" title="å¦‚ä½•ä½¿ç”¨ SQL åˆ›å»ºè¡¨ï¼Ÿ"></a>å¦‚ä½•ä½¿ç”¨ SQL åˆ›å»ºè¡¨ï¼Ÿ</h5><p>åˆ›å»ºè¡¨çš„ SQL å¦‚ä¸‹ï¼š</p><pre><code class="hljs mysql">create table t(     tid int not null autoincrement,     tname char(50) not null,     tage int null default 18,     primary key(t_id) )engine&#x3D;innodb;</code></pre><p>å…¶ä¸­ï¼š</p><ul><li><p>auto_incrementï¼šè¡¨ç¤ºè‡ªå¢ï¼›</p></li><li><p>primary keyï¼šç”¨äºæŒ‡å®šä¸»é”®ï¼›</p></li><li><p>engineï¼šç”¨äºæŒ‡å®šè¡¨çš„å¼•æ“ã€‚</p></li></ul><h5 id="åœ¨-MySQL-å‘½ä»¤è¡Œä¸­å¦‚ä½•æŸ¥çœ‹è¡¨ç»“æ„ä¿¡æ¯ï¼Ÿ"><a href="#åœ¨-MySQL-å‘½ä»¤è¡Œä¸­å¦‚ä½•æŸ¥çœ‹è¡¨ç»“æ„ä¿¡æ¯ï¼Ÿ" class="headerlink" title="åœ¨ MySQL å‘½ä»¤è¡Œä¸­å¦‚ä½•æŸ¥çœ‹è¡¨ç»“æ„ä¿¡æ¯ï¼Ÿ"></a>åœ¨ MySQL å‘½ä»¤è¡Œä¸­å¦‚ä½•æŸ¥çœ‹è¡¨ç»“æ„ä¿¡æ¯ï¼Ÿ</h5><p>ä½¿ç”¨ desc è¡¨å æŸ¥çœ‹è¡¨ç»“æ„ä¿¡æ¯ï¼Œç¤ºä¾‹ä¿¡æ¯å¦‚ä¸‹ï¼š</p><p> <img src="/images/mysql/desc.png"></p><p>ä½¿ç”¨ desc person; æŸ¥çœ‹è¡¨ person çš„ç»“æ„ä¿¡æ¯ã€‚</p><h5 id="å¦‚ä½•ä½¿ç”¨-SQL-æŸ¥çœ‹å·²çŸ¥è¡¨çš„å»ºè¡¨è„šæœ¬ï¼Ÿ"><a href="#å¦‚ä½•ä½¿ç”¨-SQL-æŸ¥çœ‹å·²çŸ¥è¡¨çš„å»ºè¡¨è„šæœ¬ï¼Ÿ" class="headerlink" title="å¦‚ä½•ä½¿ç”¨ SQL æŸ¥çœ‹å·²çŸ¥è¡¨çš„å»ºè¡¨è„šæœ¬ï¼Ÿ"></a>å¦‚ä½•ä½¿ç”¨ SQL æŸ¥çœ‹å·²çŸ¥è¡¨çš„å»ºè¡¨è„šæœ¬ï¼Ÿ</h5><p>æŸ¥çœ‹å·²çŸ¥è¡¨çš„å»ºè¡¨è„šæœ¬ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p><p>mysql&gt; show create table è¡¨å; </p><p>æ•ˆæœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="/images/mysql/create.png"></p><h5 id="å¦‚ä½•ä½¿ç”¨-SQL-è¯­å¥æ›´æ–°è¡¨ç»“æ„ï¼Ÿ"><a href="#å¦‚ä½•ä½¿ç”¨-SQL-è¯­å¥æ›´æ–°è¡¨ç»“æ„ï¼Ÿ" class="headerlink" title="å¦‚ä½•ä½¿ç”¨ SQL è¯­å¥æ›´æ–°è¡¨ç»“æ„ï¼Ÿ"></a>å¦‚ä½•ä½¿ç”¨ SQL è¯­å¥æ›´æ–°è¡¨ç»“æ„ï¼Ÿ</h5><p>æ›´æ–°è¡¨ç»“æ„ä¿¡æ¯å¯ä»¥ä½¿ç”¨ alter table å­å¥ï¼Œå¦‚ï¼Œä¸ºè¡¨å¢åŠ ä¸€åˆ—çš„è„šæœ¬å¦‚ä¸‹ï¼šalter</p><p><code>alter table t add name char(20)ï¼›</code></p><p>å¦‚æœè¦é‡å‘½åè¡¨åï¼Œä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ï¼š</p><p><code>rename table new_t to t;</code></p><h5 id="MySQL-æœ‰å“ªäº›åˆ é™¤æ–¹å¼ï¼Ÿæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"><a href="#MySQL-æœ‰å“ªäº›åˆ é™¤æ–¹å¼ï¼Ÿæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ" class="headerlink" title="MySQL æœ‰å“ªäº›åˆ é™¤æ–¹å¼ï¼Ÿæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"></a>MySQL æœ‰å“ªäº›åˆ é™¤æ–¹å¼ï¼Ÿæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h5><p>MySQL æœ‰ä¸‰ç§åˆ é™¤æ–¹å¼ï¼š 1ï¼‰åˆ é™¤è¡¨æ•°æ®ï¼š</p><p><code>delete from t;</code></p><p>2ï¼‰åˆ é™¤æ•°æ®ï¼Œä¿ç•™è¡¨ç»“æ„ï¼š</p><p><code>truncate table t;</code></p><p>3ï¼‰åˆ æ•°æ®å’Œè¡¨ç»“æ„ï¼š</p><p><code>drop table t;</code></p><p>å®ƒä»¬çš„åŒºåˆ«å¦‚ä¸‹ï¼š</p><ul><li><p>delete å¯ä»¥æœ‰æ¡ä»¶çš„åˆ é™¤ï¼Œä¹Ÿå¯ä»¥å›æ»šæ•°æ®ï¼Œåˆ é™¤æ•°æ®æ—¶è¿›è¡Œä¸¤ä¸ªåŠ¨ä½œï¼šåˆ é™¤ä¸å¤‡ä»½ï¼Œæ‰€ä»¥é€Ÿåº¦å¾ˆæ…¢ï¼›</p></li><li><p>truncate åˆ é™¤æ‰€æœ‰æ•°æ®ï¼Œæ— æ¡ä»¶é€‰æ‹©åˆ é™¤ï¼Œä¸å¯å›æ»šï¼Œä¿ç•™è¡¨ç»“æ„ï¼›</p></li><li><p>dropï¼šåˆ é™¤æ•°æ®å’Œè¡¨ç»“æ„ åˆ é™¤é€Ÿåº¦æœ€å¿«ã€‚</p></li></ul><p>æ‰§è¡Œé€Ÿåº¦ï¼Œä¸€èˆ¬æ¥è¯´ï¼šdrop&gt; truncate &gt; deleteã€‚</p><p>è¡¥å……ï¼šdelete è¯­å¥æ˜¯æ•°æ®åº“æ“ä½œè¯­è¨€ï¼ˆdmlï¼‰ï¼Œè¿™ä¸ªæ“ä½œä¼šæ”¾åˆ° rollback segement ä¸­ï¼Œäº‹åŠ¡æäº¤ä¹‹åæ‰ç”Ÿæ•ˆï¼›å¦‚æœæœ‰ç›¸åº”çš„ triggerï¼Œæ‰§è¡Œçš„æ—¶å€™å°†è¢«è§¦å‘ã€‚truncateã€drop æ˜¯æ•°æ®åº“å®šä¹‰è¯­è¨€ï¼ˆddlï¼‰ï¼Œæ“ä½œç«‹å³ç”Ÿæ•ˆï¼ŒåŸæ•°æ®ä¸æ”¾åˆ° rollback segment ä¸­ï¼Œä¸èƒ½å›æ»šï¼Œæ“ä½œä¸è§¦å‘ triggerã€‚</p><p>åº”ç”¨åœºæ™¯ï¼š</p><ul><li><p>å½“ä½ ä¸å†éœ€è¦è¯¥è¡¨æ—¶ï¼Œ ç”¨ drop</p></li><li><p>å½“ä½ ä»è¦ä¿ç•™è¯¥è¡¨ï¼Œä½†è¦åˆ é™¤æ‰€æœ‰è®°å½•æ—¶ï¼Œ ç”¨ truncate</p></li><li><p>å½“ä½ è¦åˆ é™¤éƒ¨åˆ†è®°å½•æ—¶ï¼ˆalways with a where clauseï¼‰ï¼Œç”¨ delete</p></li></ul><h5 id="å¦‚ä½•å¼€å¯å’Œå…³é—­-MySQL-æœåŠ¡ï¼Ÿ"><a href="#å¦‚ä½•å¼€å¯å’Œå…³é—­-MySQL-æœåŠ¡ï¼Ÿ" class="headerlink" title="å¦‚ä½•å¼€å¯å’Œå…³é—­ MySQL æœåŠ¡ï¼Ÿ"></a>å¦‚ä½•å¼€å¯å’Œå…³é—­ MySQL æœåŠ¡ï¼Ÿ</h5><p>ä½¿ç”¨ systemctl stop mysqld åœæ­¢ MySQL æœåŠ¡ï¼Œä½¿ç”¨ systemctl start mysqld å¯åŠ¨ MySQL æœåŠ¡ã€‚</p><h5 id="å¦‚ä½•æŸ¥è¯¢å½“å‰-MySQL-å®‰è£…çš„ç‰ˆæœ¬å·ï¼Ÿ"><a href="#å¦‚ä½•æŸ¥è¯¢å½“å‰-MySQL-å®‰è£…çš„ç‰ˆæœ¬å·ï¼Ÿ" class="headerlink" title="å¦‚ä½•æŸ¥è¯¢å½“å‰ MySQL å®‰è£…çš„ç‰ˆæœ¬å·ï¼Ÿ"></a>å¦‚ä½•æŸ¥è¯¢å½“å‰ MySQL å®‰è£…çš„ç‰ˆæœ¬å·ï¼Ÿ</h5><p>ä½¿ç”¨ SELECT VERSION(); </p><p>å¯ä»¥æŸ¥è¯¢å½“å‰è¿æ¥çš„ MySQL çš„ç‰ˆæœ¬å·ã€‚</p><h5 id="å¦‚ä½•æŸ¥çœ‹æŸå¼ è¡¨çš„å­˜å‚¨å¼•æ“ï¼Ÿ"><a href="#å¦‚ä½•æŸ¥çœ‹æŸå¼ è¡¨çš„å­˜å‚¨å¼•æ“ï¼Ÿ" class="headerlink" title="å¦‚ä½•æŸ¥çœ‹æŸå¼ è¡¨çš„å­˜å‚¨å¼•æ“ï¼Ÿ"></a>å¦‚ä½•æŸ¥çœ‹æŸå¼ è¡¨çš„å­˜å‚¨å¼•æ“ï¼Ÿ</h5><p>å¯ä½¿ç”¨ show table status from db where name=â€™tâ€™; æŸ¥è¯¢æ•°æ®åº“ db ä¸­è¡¨ t çš„æ‰€æœ‰ä¿¡æ¯ï¼Œå…¶ä¸­ Engine åˆ—è¡¨ç¤ºè¡¨ t ä½¿ç”¨çš„å­˜å‚¨å¼•æ“ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p> <img src="/images/mysql/engine.png"></p><h5 id="å¦‚ä½•æŸ¥çœ‹å½“å‰æ•°æ®åº“å¢åˆ æ”¹æŸ¥çš„æ‰§è¡Œæ¬¡æ•°ç»Ÿè®¡ï¼Ÿ"><a href="#å¦‚ä½•æŸ¥çœ‹å½“å‰æ•°æ®åº“å¢åˆ æ”¹æŸ¥çš„æ‰§è¡Œæ¬¡æ•°ç»Ÿè®¡ï¼Ÿ" class="headerlink" title="å¦‚ä½•æŸ¥çœ‹å½“å‰æ•°æ®åº“å¢åˆ æ”¹æŸ¥çš„æ‰§è¡Œæ¬¡æ•°ç»Ÿè®¡ï¼Ÿ"></a>å¦‚ä½•æŸ¥çœ‹å½“å‰æ•°æ®åº“å¢åˆ æ”¹æŸ¥çš„æ‰§è¡Œæ¬¡æ•°ç»Ÿè®¡ï¼Ÿ</h5><p>ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤è¡ŒæŸ¥çœ‹ï¼š</p><pre><code class="hljs mysql">mysql&gt; show global status where variablename in(&#39;comselect&#39;,&#39;cominsert&#39;,&#39;comdelete&#39;,&#39;comupdate&#39;); +---------------+-------+ | Variablename | Value | +---------------+-------+ | Comdelete   | 0   | | Cominsert   | 1   | | Comselect   | 40   | | Comupdate   | 0   | +---------------+-------+</code></pre><h5 id="å¦‚ä½•æŸ¥è¯¢çº¿ç¨‹è¿æ¥æ•°ï¼Ÿ"><a href="#å¦‚ä½•æŸ¥è¯¢çº¿ç¨‹è¿æ¥æ•°ï¼Ÿ" class="headerlink" title="å¦‚ä½•æŸ¥è¯¢çº¿ç¨‹è¿æ¥æ•°ï¼Ÿ"></a>å¦‚ä½•æŸ¥è¯¢çº¿ç¨‹è¿æ¥æ•°ï¼Ÿ</h5><p>ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ï¼š</p><p><code>mysql&gt; show global status like &#39;threads_%&#39;;</code></p><p>æ‰§è¡Œæ•ˆæœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p> <img src="/images/mysql/thread.png"></p><p>å…¶ä¸­ï¼š</p><ul><li><p>Threads_cachedï¼šä»£è¡¨å½“å‰æ­¤æ—¶æ­¤åˆ»çº¿ç¨‹ç¼“å­˜ä¸­æœ‰å¤šå°‘ç©ºé—²çº¿ç¨‹ï¼›</p></li><li><p>Threads_connectedï¼šä»£è¡¨å½“å‰å·²å»ºç«‹è¿æ¥çš„æ•°é‡ï¼Œå› ä¸ºä¸€ä¸ªè¿æ¥å°±éœ€è¦ä¸€ä¸ªçº¿ç¨‹ï¼Œæ‰€ä»¥ä¹Ÿå¯ä»¥çœ‹æˆå½“å‰è¢«ä½¿ç”¨çš„çº¿ç¨‹æ•°ï¼›</p></li><li><p>Threads_createdï¼šä»£è¡¨ä»æœ€è¿‘ä¸€æ¬¡æœåŠ¡å¯åŠ¨ï¼Œå·²åˆ›å»ºçº¿ç¨‹çš„æ•°é‡ï¼›</p></li><li><p>Threads_runningï¼šä»£è¡¨å½“å‰æ¿€æ´»çš„ï¼ˆéç¡çœ çŠ¶æ€ï¼‰çº¿ç¨‹æ•°ã€‚</p></li></ul><h5 id="å¦‚ä½•æŸ¥çœ‹-MySQL-çš„æœ€å¤§è¿æ¥æ•°ï¼Ÿèƒ½ä¸èƒ½ä¿®æ”¹ï¼Ÿæ€ä¹ˆä¿®æ”¹ï¼Ÿ"><a href="#å¦‚ä½•æŸ¥çœ‹-MySQL-çš„æœ€å¤§è¿æ¥æ•°ï¼Ÿèƒ½ä¸èƒ½ä¿®æ”¹ï¼Ÿæ€ä¹ˆä¿®æ”¹ï¼Ÿ" class="headerlink" title="å¦‚ä½•æŸ¥çœ‹ MySQL çš„æœ€å¤§è¿æ¥æ•°ï¼Ÿèƒ½ä¸èƒ½ä¿®æ”¹ï¼Ÿæ€ä¹ˆä¿®æ”¹ï¼Ÿ"></a>å¦‚ä½•æŸ¥çœ‹ MySQL çš„æœ€å¤§è¿æ¥æ•°ï¼Ÿèƒ½ä¸èƒ½ä¿®æ”¹ï¼Ÿæ€ä¹ˆä¿®æ”¹ï¼Ÿ</h5><p>æŸ¥è¯¢ MySQL æœ€å¤§è¿æ¥æ•°ï¼Œä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ï¼š</p><p><code>mysql&gt; show variables like &#39;max_connections%&#39;;</code></p><p>æ­¤å‘½ä»¤è¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š</p><p> <img src="/images/mysql/maxconn.png"></p><p>å¯ä»¥ä¿®æ”¹ MySQL çš„æœ€å¤§è¿æ¥æ•°ï¼Œå¯ä»¥åœ¨ MySQL çš„é…ç½®æ–‡ä»¶ my.cnf é‡Œä¿®æ”¹æœ€å¤§è¿æ¥æ•°ï¼Œé€šè¿‡ä¿®æ”¹ maxconnections çš„å€¼ï¼Œç„¶åé‡å¯ MySQL å°±ä¼šç”Ÿæ•ˆï¼Œå¦‚æœ my.ini æ–‡ä»¶ä¸­æ²¡æœ‰æ‰¾åˆ° maxconnectionsï¼Œå¯è‡ªè¡Œæ·»åŠ  max_connections çš„è®¾ç½®ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p><p><code>max_connections=200</code></p><h5 id="CHAR-LENGTH-å’Œ-LENGTH-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"><a href="#CHAR-LENGTH-å’Œ-LENGTH-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ" class="headerlink" title="CHAR_LENGTH å’Œ LENGTH æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"></a>CHAR_LENGTH å’Œ LENGTH æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h5><p>CHARLENGTH æ˜¯å­—ç¬¦æ•°ï¼Œè€Œ LENGTH æ˜¯å­—èŠ‚æ•°ã€‚å®ƒä»¬åœ¨ä¸åŒç¼–ç ä¸‹ï¼Œå€¼æ˜¯ä¸ç›¸åŒçš„ï¼Œæ¯”å¦‚å¯¹äº UTF-8 ç¼–ç æ¥è¯´ï¼Œä¸€ä¸ªä¸­æ–‡å­—çš„ LENGTH ä¸º 1ï¼Œè€Œ CHARLENGTH é€šå¸¸ç­‰äº 3ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p> <img src="/images/mysql/charlength.png"></p><h5 id="UNION-å’Œ-UNION-ALL-çš„ç”¨é€”æ˜¯ä»€ä¹ˆï¼Ÿæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"><a href="#UNION-å’Œ-UNION-ALL-çš„ç”¨é€”æ˜¯ä»€ä¹ˆï¼Ÿæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ" class="headerlink" title="UNION å’Œ UNION ALL çš„ç”¨é€”æ˜¯ä»€ä¹ˆï¼Ÿæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"></a>UNION å’Œ UNION ALL çš„ç”¨é€”æ˜¯ä»€ä¹ˆï¼Ÿæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h5><p>UNION å’Œ UNION ALL éƒ½æ˜¯ç”¨äºåˆå¹¶æ•°æ®é›†çš„ï¼Œå®ƒä»¬çš„åŒºåˆ«å¦‚ä¸‹ï¼š</p><ul><li><p>å»é‡ï¼šUNION ä¼šå¯¹ç»“æœè¿›è¡Œå»é‡ï¼ŒUNION ALL åˆ™ä¸ä¼šè¿›è¡Œå»é‡æ“ä½œï¼›</p></li><li><p>æ’åºï¼šUNION ä¼šå¯¹ç»“æœæ ¹æ®å­—æ®µè¿›è¡Œæ’åºï¼Œè€Œ UNION ALL åˆ™ä¸ä¼šè¿›è¡Œæ’åºï¼›</p></li><li><p>æ€§èƒ½ï¼šUNION ALL çš„æ€§èƒ½è¦é«˜äº UNIONã€‚</p></li></ul><h5 id="ä»¥ä¸‹å…³äº-WHERE-å’Œ-HAVING-è¯´æ³•æ­£ç¡®çš„æ˜¯ï¼Ÿ"><a href="#ä»¥ä¸‹å…³äº-WHERE-å’Œ-HAVING-è¯´æ³•æ­£ç¡®çš„æ˜¯ï¼Ÿ" class="headerlink" title="ä»¥ä¸‹å…³äº WHERE å’Œ HAVING è¯´æ³•æ­£ç¡®çš„æ˜¯ï¼Ÿ"></a>ä»¥ä¸‹å…³äº WHERE å’Œ HAVING è¯´æ³•æ­£ç¡®çš„æ˜¯ï¼Ÿ</h5><p>A.ä»»ä½•æƒ…å†µ WHERE å’Œ HAVING éƒ½å¯ä»¥ç›¸äº’æ›¿ä»£ </p><p>B.GROUP BY å‰åéƒ½å¯ä»¥ä½¿ç”¨ WHERE </p><p>C.ä½¿ç”¨ SELECT X FROM T HAVING Y&gt;20 æŸ¥è¯¢æŠ¥é”™ </p><p>D.ä½¿ç”¨ SELECT X FROM T WHERE Y&gt;20 æŸ¥è¯¢æŠ¥é”™ </p><p>ç­”ï¼šCï¼ŒHAVING éæŠ¥é”™ç”¨æ³•æ˜¯ SELECT X,Y FROM T HAVING Y&gt;20 ã€‚</p><h5 id="ç©ºå€¼å’Œ-NULL-çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#ç©ºå€¼å’Œ-NULL-çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="ç©ºå€¼å’Œ NULL çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ"></a>ç©ºå€¼å’Œ NULL çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</h5><p>ç©ºå€¼è¡¨ç¤ºå­—æ®µçš„å€¼ä¸ºç©ºï¼Œè€Œ NULL åˆ™è¡¨ç¤ºå­—æ®µæ²¡æœ‰å€¼ï¼Œå®ƒä»¬çš„åŒºåˆ«å¦‚ä¸‹ï¼š</p><ul><li><p>ç©ºå€¼ä¸å ç”¨ç©ºé—´ï¼ŒNULL å€¼æ˜¯æœªçŸ¥çš„å ç”¨ç©ºé—´ï¼›</p></li><li><p>ç©ºå€¼åˆ¤æ–­ä½¿ç”¨ =â€™â€™ æˆ– &lt;&gt;â€™â€™ æ¥åˆ¤æ–­ï¼ŒNULL å€¼ä½¿ç”¨ IS NULL æˆ– IS NOT NULL æ¥åˆ¤æ–­ï¼›</p></li><li><p>ä½¿ç”¨ COUNT ç»Ÿè®¡æŸå­—æ®µæ—¶ï¼Œå¦‚æœæ˜¯ NULL åˆ™ä¼šå¿½ç•¥ä¸ç»Ÿè®¡ï¼Œè€Œç©ºå€¼åˆ™ä¼šç®—å…¥ç»Ÿè®¡ä¹‹å†…ã€‚</p></li></ul><p>æ¯”å¦‚ï¼Œå…¶ä¸­å­—æ®µ name æœ‰ä¸€ä¸ª NULL å€¼å’Œä¸¤ä¸ªç©ºå€¼ï¼ŒæŸ¥è¯¢ç»“æœå¦‚å›¾ï¼š</p><p> <img src="/images/mysql/count.png"></p><h5 id="MySQL-çš„å¸¸ç”¨å‡½æ•°æœ‰å“ªäº›ï¼Ÿ"><a href="#MySQL-çš„å¸¸ç”¨å‡½æ•°æœ‰å“ªäº›ï¼Ÿ" class="headerlink" title="MySQL çš„å¸¸ç”¨å‡½æ•°æœ‰å“ªäº›ï¼Ÿ"></a>MySQL çš„å¸¸ç”¨å‡½æ•°æœ‰å“ªäº›ï¼Ÿ</h5><ul><li><p>sum(field) â€“ æ±‚æŸä¸ªå­—æ®µçš„å’Œå€¼ï¼›</p></li><li><p>count(*) â€“ æŸ¥è¯¢æ€»æ¡æ•°ï¼›</p></li><li><p>min(field) â€“ æŸåˆ—ä¸­æœ€å°çš„å€¼ï¼›</p></li><li><p>max(field) â€“ æŸåˆ—ä¸­æœ€å¤§çš„å€¼ï¼›</p></li><li><p>avg(field) â€“ æ±‚å¹³å‡æ•°ï¼›</p></li><li><p>current_date() â€“ è·å–å½“å‰æ—¥æœŸï¼›</p></li><li><p>now() â€“ è·å–å½“å‰æ—¥æœŸå’Œæ—¶é—´ï¼›</p></li><li><p>concat(a, b) â€“ è¿æ¥ä¸¤ä¸ªå­—ç¬¦ä¸²å€¼ä»¥åˆ›å»ºå•ä¸ªå­—ç¬¦ä¸²è¾“å‡ºï¼›</p></li><li><p>datediff(a, b) â€“ ç¡®å®šä¸¤ä¸ªæ—¥æœŸä¹‹é—´çš„å·®å¼‚ï¼Œé€šå¸¸ç”¨äºè®¡ç®—å¹´é¾„ã€‚</p></li></ul><h4 id="MySQL-æ€§èƒ½ä¼˜åŒ–-amp-åˆ†å¸ƒå¼"><a href="#MySQL-æ€§èƒ½ä¼˜åŒ–-amp-åˆ†å¸ƒå¼" class="headerlink" title="MySQL æ€§èƒ½ä¼˜åŒ– &amp; åˆ†å¸ƒå¼"></a>MySQL æ€§èƒ½ä¼˜åŒ– &amp; åˆ†å¸ƒå¼</h4><h5 id="MySQL-æ€§èƒ½æŒ‡æ ‡éƒ½æœ‰å“ªäº›ï¼Ÿå¦‚ä½•å¾—åˆ°è¿™äº›æŒ‡æ ‡ï¼Ÿ"><a href="#MySQL-æ€§èƒ½æŒ‡æ ‡éƒ½æœ‰å“ªäº›ï¼Ÿå¦‚ä½•å¾—åˆ°è¿™äº›æŒ‡æ ‡ï¼Ÿ" class="headerlink" title="MySQL æ€§èƒ½æŒ‡æ ‡éƒ½æœ‰å“ªäº›ï¼Ÿå¦‚ä½•å¾—åˆ°è¿™äº›æŒ‡æ ‡ï¼Ÿ"></a>MySQL æ€§èƒ½æŒ‡æ ‡éƒ½æœ‰å“ªäº›ï¼Ÿå¦‚ä½•å¾—åˆ°è¿™äº›æŒ‡æ ‡ï¼Ÿ</h5><p>MySQL çš„æ€§èƒ½æŒ‡æ ‡å¦‚ä¸‹ï¼š</p><p>â‘  TPSï¼ˆTransaction Per Secondï¼‰ æ¯ç§’äº‹åŠ¡æ•°ï¼Œå³æ•°æ®åº“æ¯ç§’æ‰§è¡Œçš„äº‹åŠ¡æ•°ã€‚</p><p>MySQL æœ¬èº«æ²¡æœ‰ç›´æ¥æä¾› TPS å‚æ•°å€¼ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦è·å¾— TPS çš„å€¼ï¼Œåªæœ‰æˆ‘ä»¬è‡ªå·±è®¡ç®—äº†ï¼Œå¯ä»¥æ ¹æ® MySQL æ•°æ®åº“æä¾›çš„çŠ¶æ€å˜é‡ï¼Œæ¥è®¡ç®— TPSã€‚</p><p>éœ€è¦ä½¿ç”¨çš„å‚æ•°ï¼š</p><ul><li><p>Com_commit ï¼šè¡¨ç¤ºæäº¤æ¬¡æ•°ï¼Œé€šè¿‡å‘½ä»¤ show global status like â€˜Com_commitâ€™; è·å–ï¼›</p></li><li><p>Com_rollbackï¼šè¡¨ç¤ºå›æ»šæ¬¡æ•°ï¼Œé€šè¿‡å‘½ä»¤ show global status like â€˜Com_rollbackâ€™; è·å–ã€‚</p></li></ul><p>æˆ‘ä»¬å®šä¹‰ç¬¬ä¸€æ¬¡è·å–çš„ Comcommit çš„å€¼ä¸ Comrollback å€¼çš„å’Œä¸º c_r1ï¼Œæ—¶é—´ä¸º t1ï¼›</p><p>ç¬¬äºŒæ¬¡è·å–çš„ Comcommit çš„å€¼ä¸ Comrollback å€¼çš„å’Œä¸º cr2ï¼Œæ—¶é—´ä¸º t2ï¼Œt1 ä¸ t2 å•ä½ä¸ºç§’ã€‚ é‚£ä¹ˆ TPS = ( cr2 - c_r1 ) / ( t2 - t1 ) ç®—å‡ºæ¥çš„å°±æ˜¯è¯¥ MySQL å®ä¾‹åœ¨ t1 ä¸ t2 ç”Ÿå‘½å‘¨æœŸä¹‹é—´çš„å¹³å‡ TPSã€‚</p><p>â‘¡ QPSï¼ˆQuery Per Secondï¼‰ æ¯ç§’è¯·æ±‚æ¬¡æ•°ï¼Œä¹Ÿå°±æ˜¯æ•°æ®åº“æ¯ç§’æ‰§è¡Œçš„ SQL æ•°é‡ï¼ŒåŒ…å« INSERTã€SELECTã€UPDATEã€DELETE ç­‰ã€‚ QPS = Queries / Seconds Queries æ˜¯ç³»ç»ŸçŠ¶æ€å€¼â€”æ€»æŸ¥è¯¢æ¬¡æ•°ï¼Œå¯ä»¥é€šè¿‡ show status like â€˜queriesâ€™; æŸ¥è¯¢å¾—å‡ºï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><p> <img src="/imaegs/queries.png"></p><p>Seconds æ˜¯ç›‘æ§çš„æ—¶é—´åŒºé—´ï¼Œå•ä½ä¸ºç§’ã€‚ æ¯”å¦‚ï¼Œé‡‡æ · 10 ç§’å†…çš„æŸ¥è¯¢æ¬¡æ•°ï¼Œé‚£ä¹ˆå…ˆæŸ¥è¯¢ä¸€æ¬¡ Queries å€¼ï¼ˆQ1ï¼‰ï¼Œç­‰å¾… 10 ç§’ï¼Œå†æŸ¥è¯¢ä¸€æ¬¡ Queries å€¼ï¼ˆQ2ï¼‰ï¼Œé‚£ä¹ˆ QPS å°±å¯ä»¥é€šè¿‡ï¼Œå¦‚ä¸‹å…¬å¼è·å¾—ï¼š</p><p>QPS = (Q2 - Q1) / 10</p><p>â‘¢ IOPSï¼ˆInput/Output Operations per Secondï¼‰ æ¯ç§’å¤„ç†çš„ I/O è¯·æ±‚æ¬¡æ•°ã€‚</p><p>IOPS æ˜¯åˆ¤æ–­ç£ç›˜ I/O èƒ½åŠ›çš„æŒ‡æ ‡ä¹‹ä¸€ï¼Œä¸€èˆ¬æ¥è®² IOPS æŒ‡æ ‡è¶Šé«˜ï¼Œé‚£ä¹ˆå•ä½æ—¶é—´å†…èƒ½å¤Ÿå“åº”çš„è¯·æ±‚è‡ªç„¶ä¹Ÿå°±è¶Šå¤šã€‚ç†è®ºä¸Šè®²ï¼Œåªè¦ç³»ç»Ÿå®é™…çš„è¯·æ±‚æ•°ä½äº IOPS çš„èƒ½åŠ›ï¼Œå°±ç›¸å½“äºæ¯ä¸€ä¸ªè¯·æ±‚éƒ½èƒ½å¾—åˆ°å³æ—¶å“åº”ï¼Œé‚£ä¹ˆ I/O å°±ä¸ä¼šæ˜¯ç“¶é¢ˆäº†ã€‚</p><p>æ³¨æ„ï¼šIOPS ä¸ç£ç›˜ååé‡ä¸ä¸€æ ·ï¼Œååé‡æ˜¯æŒ‡å•ä½æ—¶é—´å†…å¯ä»¥æˆåŠŸä¼ è¾“çš„æ•°æ®æ•°é‡ã€‚</p><p>å¯ä»¥ä½¿ç”¨ iostat å‘½ä»¤ï¼ŒæŸ¥çœ‹ç£ç›˜çš„ IOPSï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p><pre><code class="hljs zsh">yum install sysstat iostat  -dx 1 10</code></pre><p>æ‰§è¡Œæ•ˆæœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p> <img src="/images/mysql/iostat.png"></p><p>IOPS = r/s + w/s å…¶ä¸­ï¼š</p><p>l r/sï¼šä»£è¡¨æ¯ç§’è¯»äº†å¤šå°‘æ¬¡ï¼›</p><p>l w/sï¼šä»£è¡¨æ¯ç§’å†™äº†å¤šå°‘æ¬¡ã€‚</p><h5 id="ä»€ä¹ˆæ˜¯æ…¢æŸ¥è¯¢ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯æ…¢æŸ¥è¯¢ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯æ…¢æŸ¥è¯¢ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯æ…¢æŸ¥è¯¢ï¼Ÿ</h5><p>æ…¢æŸ¥è¯¢æ˜¯ MySQL ä¸­æä¾›çš„ä¸€ç§æ…¢æŸ¥è¯¢æ—¥å¿—ï¼Œå®ƒç”¨æ¥è®°å½•åœ¨ MySQL ä¸­å“åº”æ—¶é—´è¶…è¿‡é˜€å€¼çš„è¯­å¥ï¼Œå…·ä½“æŒ‡è¿è¡Œæ—¶é—´è¶…è¿‡ longquerytime å€¼çš„ SQLï¼Œåˆ™ä¼šè¢«è®°å½•åˆ°æ…¢æŸ¥è¯¢æ—¥å¿—ä¸­ã€‚longquerytime çš„é»˜è®¤å€¼ä¸º 10ï¼Œæ„æ€æ˜¯è¿è¡Œ 10S ä»¥ä¸Šçš„è¯­å¥ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒMySQL æ•°æ®åº“å¹¶ä¸å¯åŠ¨æ…¢æŸ¥è¯¢æ—¥å¿—ï¼Œéœ€è¦æˆ‘ä»¬æ‰‹åŠ¨æ¥è®¾ç½®è¿™ä¸ªå‚æ•°ï¼Œå¦‚æœä¸æ˜¯è°ƒä¼˜éœ€è¦çš„è¯ï¼Œä¸€èˆ¬ä¸å»ºè®®å¯åŠ¨è¯¥å‚æ•°ï¼Œå› ä¸ºå¼€å¯æ…¢æŸ¥è¯¢æ—¥å¿—ä¼šç»™ MySQL æœåŠ¡å™¨å¸¦æ¥ä¸€å®šçš„æ€§èƒ½å½±å“ã€‚æ…¢æŸ¥è¯¢æ—¥å¿—æ”¯æŒå°†æ—¥å¿—è®°å½•å†™å…¥æ–‡ä»¶ï¼Œä¹Ÿæ”¯æŒå°†æ—¥å¿—è®°å½•å†™å…¥æ•°æ®åº“è¡¨ã€‚</p><p>ä½¿ç”¨ <code>mysql&gt; show variables like &#39;%slow_query_log%&#39;; </code>æ¥æŸ¥è¯¢æ…¢æŸ¥è¯¢æ—¥å¿—æ˜¯å¦å¼€å¯ï¼Œæ‰§è¡Œæ•ˆæœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p> <img src="/images/mysql/slow.png"></p><p>slowquerylog çš„å€¼ä¸º OFF æ—¶ï¼Œè¡¨ç¤ºæœªå¼€å¯æ…¢æŸ¥è¯¢æ—¥å¿—ã€‚</p><h5 id="å¦‚ä½•å¼€å¯æ…¢æŸ¥è¯¢æ—¥å¿—ï¼Ÿ"><a href="#å¦‚ä½•å¼€å¯æ…¢æŸ¥è¯¢æ—¥å¿—ï¼Ÿ" class="headerlink" title="å¦‚ä½•å¼€å¯æ…¢æŸ¥è¯¢æ—¥å¿—ï¼Ÿ"></a>å¦‚ä½•å¼€å¯æ…¢æŸ¥è¯¢æ—¥å¿—ï¼Ÿ</h5><p>å¼€å¯æ…¢æŸ¥è¯¢æ—¥å¿—ï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹ MySQL å‘½ä»¤ï¼š</p><p><code>mysql&gt; set global slowquerylog=1</code></p><p>ä¸è¿‡è¿™ç§è®¾ç½®æ–¹å¼ï¼Œåªå¯¹å½“å‰æ•°æ®åº“ç”Ÿæ•ˆï¼Œå¦‚æœ MySQL é‡å¯ä¹Ÿä¼šå¤±æ•ˆï¼Œå¦‚æœè¦æ°¸ä¹…ç”Ÿæ•ˆï¼Œå°±å¿…é¡»ä¿®æ”¹ MySQL çš„é…ç½®æ–‡ä»¶ my.cnfï¼Œé…ç½®å¦‚ä¸‹ï¼š</p><p><code>slowquerylog =1 slowquerylogfile=/tmp/mysqlslow.log</code></p><h5 id="å¦‚ä½•å®šä½æ…¢æŸ¥è¯¢ï¼Ÿ"><a href="#å¦‚ä½•å®šä½æ…¢æŸ¥è¯¢ï¼Ÿ" class="headerlink" title="å¦‚ä½•å®šä½æ…¢æŸ¥è¯¢ï¼Ÿ"></a>å¦‚ä½•å®šä½æ…¢æŸ¥è¯¢ï¼Ÿ</h5><p>ä½¿ç”¨ MySQL ä¸­çš„ explain åˆ†ææ‰§è¡Œè¯­å¥ï¼Œæ¯”å¦‚ï¼š</p><p><code>explain select * from t where id=5;</code></p><p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="/images/mysql/explain.png"></p><p>å…¶ä¸­ï¼š</p><ul><li><p>id â€” é€‰æ‹©æ ‡è¯†ç¬¦ã€‚idè¶Šå¤§ä¼˜å…ˆçº§è¶Šé«˜ï¼Œè¶Šå…ˆè¢«æ‰§è¡Œã€‚</p></li><li><p>select_type â€” è¡¨ç¤ºæŸ¥è¯¢çš„ç±»å‹ã€‚</p></li><li><p>table â€” è¾“å‡ºç»“æœé›†çš„è¡¨</p></li><li><p>partitions â€” åŒ¹é…çš„åˆ†åŒº</p></li><li><p>type â€” è¡¨ç¤ºè¡¨çš„è¿æ¥ç±»å‹</p></li><li><p>possible_keys â€” è¡¨ç¤ºæŸ¥è¯¢æ—¶ï¼Œå¯èƒ½ä½¿ç”¨çš„ç´¢å¼•</p></li><li><p>key â€” è¡¨ç¤ºå®é™…ä½¿ç”¨çš„ç´¢å¼•</p></li><li><p>key_len â€” ç´¢å¼•å­—æ®µçš„é•¿åº¦</p></li><li><p>refâ€” åˆ—ä¸ç´¢å¼•çš„æ¯”è¾ƒ</p></li><li><p>rows â€” å¤§æ¦‚ä¼°ç®—çš„è¡Œæ•°</p></li><li><p>filtered â€” æŒ‰è¡¨æ¡ä»¶è¿‡æ»¤çš„è¡Œç™¾åˆ†æ¯”</p></li><li><p>Extra â€” æ‰§è¡Œæƒ…å†µçš„æè¿°å’Œè¯´æ˜</p></li></ul><p>å…¶ä¸­æœ€é‡è¦çš„å°±æ˜¯ type å­—æ®µï¼Œtype å€¼ç±»å‹å¦‚ä¸‹ï¼š</p><ul><li><p>all â€” æ‰«æå…¨è¡¨æ•°æ®</p></li><li><p>index â€” éå†ç´¢å¼•</p></li><li><p>range â€” ç´¢å¼•èŒƒå›´æŸ¥æ‰¾</p></li><li><p>index_subquery â€” åœ¨å­æŸ¥è¯¢ä¸­ä½¿ç”¨ ref</p></li><li><p>uniquesubquery â€” åœ¨å­æŸ¥è¯¢ä¸­ä½¿ç”¨ eqref</p></li><li><p>refornull â€” å¯¹ null è¿›è¡Œç´¢å¼•çš„ä¼˜åŒ–çš„ ref</p></li><li><p>fulltext â€” ä½¿ç”¨å…¨æ–‡ç´¢å¼•</p></li><li><p>ref â€” ä½¿ç”¨éå”¯ä¸€ç´¢å¼•æŸ¥æ‰¾æ•°æ®</p></li><li><p>eq_ref â€” åœ¨ join æŸ¥è¯¢ä¸­ä½¿ç”¨ä¸»é”®æˆ–å”¯ä¸€ç´¢å¼•å…³è”</p></li><li><p>const â€” å°†ä¸€ä¸ªä¸»é”®æ”¾ç½®åˆ° where åé¢ä½œä¸ºæ¡ä»¶æŸ¥è¯¢ï¼Œ MySQL ä¼˜åŒ–å™¨å°±èƒ½æŠŠè¿™æ¬¡æŸ¥è¯¢ä¼˜åŒ–è½¬åŒ–ä¸ºä¸€ä¸ªå¸¸é‡ï¼Œå¦‚ä½•è½¬åŒ–ä»¥åŠä½•æ—¶è½¬åŒ–ï¼Œè¿™ä¸ªå–å†³äºä¼˜åŒ–å™¨ï¼Œè¿™ä¸ªæ¯” eq_ref æ•ˆç‡é«˜ä¸€ç‚¹</p></li></ul><h5 id="MySQL-çš„ä¼˜åŒ–æ‰‹æ®µéƒ½æœ‰å“ªäº›ï¼Ÿ"><a href="#MySQL-çš„ä¼˜åŒ–æ‰‹æ®µéƒ½æœ‰å“ªäº›ï¼Ÿ" class="headerlink" title="MySQL çš„ä¼˜åŒ–æ‰‹æ®µéƒ½æœ‰å“ªäº›ï¼Ÿ"></a>MySQL çš„ä¼˜åŒ–æ‰‹æ®µéƒ½æœ‰å“ªäº›ï¼Ÿ</h5><p>MySQL çš„å¸¸è§çš„ä¼˜åŒ–æ‰‹æ®µæœ‰ä»¥ä¸‹äº”ç§ï¼š</p><p>â‘  æŸ¥è¯¢ä¼˜åŒ–</p><ul><li><p>é¿å… SELECT *ï¼ŒåªæŸ¥è¯¢éœ€è¦çš„å­—æ®µã€‚</p></li><li><p>å°è¡¨é©±åŠ¨å¤§è¡¨ï¼Œå³å°çš„æ•°æ®é›†é©±åŠ¨å¤§çš„æ•°æ®é›†ï¼Œæ¯”å¦‚ï¼Œå½“ B è¡¨çš„æ•°æ®é›†å°äº A è¡¨æ—¶ï¼Œç”¨ in ä¼˜åŒ– existï¼Œä¸¤è¡¨æ‰§è¡Œé¡ºåºæ˜¯å…ˆæŸ¥ B è¡¨ï¼Œå†æŸ¥ A è¡¨ï¼ŒæŸ¥è¯¢è¯­å¥ï¼šselect * from A where id in (select id from B) ã€‚</p></li><li><p>ä¸€äº›æƒ…å†µä¸‹ï¼Œå¯ä»¥ä½¿ç”¨è¿æ¥ä»£æ›¿å­æŸ¥è¯¢ï¼Œå› ä¸ºä½¿ç”¨ join æ—¶ï¼ŒMySQL ä¸ä¼šåœ¨å†…å­˜ä¸­åˆ›å»ºä¸´æ—¶è¡¨ã€‚</p></li></ul><p>â‘¡ ä¼˜åŒ–ç´¢å¼•çš„ä½¿ç”¨</p><ul><li><p>å°½é‡ä½¿ç”¨ä¸»é”®æŸ¥è¯¢ï¼Œè€Œéå…¶ä»–ç´¢å¼•ï¼Œå› ä¸ºä¸»é”®æŸ¥è¯¢ä¸ä¼šè§¦å‘å›è¡¨æŸ¥è¯¢ã€‚</p></li><li><p>ä¸åšåˆ—è¿ç®—ï¼ŒæŠŠè®¡ç®—éƒ½æ”¾å…¥å„ä¸ªä¸šåŠ¡ç³»ç»Ÿå®ç°</p></li><li><p>æŸ¥è¯¢è¯­å¥å°½å¯èƒ½ç®€å•ï¼Œå¤§è¯­å¥æ‹†å°è¯­å¥ï¼Œå‡å°‘é”æ—¶é—´</p></li><li><p>ä¸ä½¿ç”¨ select * æŸ¥è¯¢</p></li><li><p>or æŸ¥è¯¢æ”¹å†™æˆ in æŸ¥è¯¢</p></li><li><p>ä¸ç”¨å‡½æ•°å’Œè§¦å‘å™¨</p></li><li><p>é¿å… %xx æŸ¥è¯¢</p></li><li><p>å°‘ç”¨ join æŸ¥è¯¢</p></li><li><p>ä½¿ç”¨åŒç±»å‹æ¯”è¾ƒï¼Œæ¯”å¦‚ â€˜123â€™ å’Œ â€˜123â€™ã€123 å’Œ 123</p></li><li><p>å°½é‡é¿å…åœ¨ where å­å¥ä¸­ä½¿ç”¨ != æˆ–è€… &lt;&gt; æ“ä½œç¬¦ï¼ŒæŸ¥è¯¢å¼•ç”¨ä¼šæ”¾å¼ƒç´¢å¼•è€Œè¿›è¡Œå…¨è¡¨æ‰«æ</p></li><li><p>åˆ—è¡¨æ•°æ®ä½¿ç”¨åˆ†é¡µæŸ¥è¯¢ï¼Œæ¯é¡µæ•°æ®é‡ä¸è¦å¤ªå¤§</p></li><li><p>ç”¨ exists æ›¿ä»£ in æŸ¥è¯¢</p></li><li><p>é¿å…åœ¨ç´¢å¼•åˆ—ä¸Šä½¿ç”¨ is null å’Œ is not null</p></li><li><p>å°½é‡ä½¿ç”¨ä¸»é”®æŸ¥è¯¢</p></li><li><p>é¿å…åœ¨ where å­å¥ä¸­å¯¹å­—æ®µè¿›è¡Œè¡¨è¾¾å¼æ“ä½œ</p></li><li><p>å°½é‡ä½¿ç”¨æ•°å­—å‹å­—æ®µï¼Œè‹¥åªå«æ•°å€¼ä¿¡æ¯çš„å­—æ®µå°½é‡ä¸è¦è®¾è®¡ä¸ºå­—ç¬¦å‹</p></li></ul><p>â‘¢ è¡¨ç»“æ„è®¾è®¡ä¼˜åŒ–</p><ul><li><p>ä½¿ç”¨å¯ä»¥å­˜ä¸‹æ•°æ®æœ€å°çš„æ•°æ®ç±»å‹ã€‚</p></li><li><p>ä½¿ç”¨ç®€å•çš„æ•°æ®ç±»å‹ï¼Œint è¦æ¯” varchar ç±»å‹åœ¨ MySQL å¤„ç†ç®€å•ã€‚</p></li><li><p>å°½é‡ä½¿ç”¨ tinyintã€smallintã€mediumint ä½œä¸ºæ•´æ•°ç±»å‹è€Œé intã€‚</p></li><li><p>å°½å¯èƒ½ä½¿ç”¨ not null å®šä¹‰å­—æ®µï¼Œå› ä¸º null å ç”¨ 4 å­—èŠ‚ç©ºé—´ã€‚</p></li><li><p>å°½é‡å°‘ç”¨ text ç±»å‹ï¼Œéç”¨ä¸å¯æ—¶æœ€å¥½è€ƒè™‘åˆ†è¡¨ã€‚</p></li><li><p>å°½é‡ä½¿ç”¨ timestampï¼Œè€Œé datetimeã€‚</p></li><li><p>å•è¡¨ä¸è¦æœ‰å¤ªå¤šå­—æ®µï¼Œå»ºè®®åœ¨ 20 ä¸ªå­—æ®µä»¥å†…ã€‚</p></li></ul><p>â‘£ è¡¨æ‹†åˆ†</p><p>å½“æ•°æ®åº“ä¸­çš„æ•°æ®éå¸¸å¤§æ—¶ï¼ŒæŸ¥è¯¢ä¼˜åŒ–æ–¹æ¡ˆä¹Ÿä¸èƒ½è§£å†³æŸ¥è¯¢é€Ÿåº¦æ…¢çš„é—®é¢˜æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘æ‹†åˆ†è¡¨ï¼Œè®©æ¯å¼ è¡¨çš„æ•°æ®é‡å˜å°ï¼Œä»è€Œæé«˜æŸ¥è¯¢æ•ˆç‡ã€‚ </p><p>aï¼‰å‚ç›´æ‹†åˆ†ï¼šæ˜¯æŒ‡æ•°æ®è¡¨åˆ—çš„æ‹†åˆ†ï¼ŒæŠŠä¸€å¼ åˆ—æ¯”è¾ƒå¤šçš„è¡¨æ‹†åˆ†ä¸ºå¤šå¼ è¡¨ï¼Œæ¯”å¦‚ï¼Œç”¨æˆ·è¡¨ä¸­ä¸€äº›å­—æ®µç»å¸¸è¢«è®¿é—®ï¼Œå°†è¿™äº›å­—æ®µæ”¾åœ¨ä¸€å¼ è¡¨ä¸­ï¼Œå¦å¤–ä¸€äº›ä¸å¸¸ç”¨çš„å­—æ®µæ”¾åœ¨å¦ä¸€å¼ è¡¨ä¸­ï¼Œæ’å…¥æ•°æ®æ—¶ï¼Œä½¿ç”¨äº‹åŠ¡ç¡®ä¿ä¸¤å¼ è¡¨çš„æ•°æ®ä¸€è‡´æ€§ã€‚ å‚ç›´æ‹†åˆ†çš„åŸåˆ™ï¼š</p><ul><li><p>æŠŠä¸å¸¸ç”¨çš„å­—æ®µå•ç‹¬æ”¾åœ¨ä¸€å¼ è¡¨ï¼›</p></li><li><p>æŠŠ textï¼Œblob ç­‰å¤§å­—æ®µæ‹†åˆ†å‡ºæ¥æ”¾åœ¨é™„è¡¨ä¸­ï¼›</p></li><li><p>ç»å¸¸ç»„åˆæŸ¥è¯¢çš„åˆ—æ”¾åœ¨ä¸€å¼ è¡¨ä¸­ã€‚</p></li></ul><p>bï¼‰æ°´å¹³æ‹†åˆ†ï¼šæŒ‡æ•°æ®è¡¨è¡Œçš„æ‹†åˆ†ï¼Œè¡¨çš„è¡Œæ•°è¶…è¿‡200ä¸‡è¡Œæ—¶ï¼Œå°±ä¼šå˜æ…¢ï¼Œè¿™æ—¶å¯ä»¥æŠŠä¸€å¼ çš„è¡¨çš„æ•°æ®æ‹†æˆå¤šå¼ è¡¨æ¥å­˜æ”¾ã€‚</p><p>é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä½¿ç”¨å–æ¨¡çš„æ–¹å¼æ¥è¿›è¡Œè¡¨çš„æ‹†åˆ†ï¼Œæ¯”å¦‚ï¼Œä¸€å¼ æœ‰ 400W çš„ç”¨æˆ·è¡¨ usersï¼Œä¸ºæé«˜å…¶æŸ¥è¯¢æ•ˆç‡æˆ‘ä»¬æŠŠå…¶åˆ†æˆ 4 å¼ è¡¨ users1ï¼Œusers2ï¼Œusers3ï¼Œusers4ï¼Œç„¶åé€šè¿‡ç”¨æˆ· ID å–æ¨¡çš„æ–¹æ³•ï¼ŒåŒæ—¶æŸ¥è¯¢ã€æ›´æ–°ã€åˆ é™¤ä¹Ÿæ˜¯é€šè¿‡å–æ¨¡çš„æ–¹æ³•æ¥æ“ä½œã€‚</p><p>â‘¤ è¯»å†™åˆ†ç¦»</p><p>ä¸€èˆ¬æƒ…å†µä¸‹å¯¹æ•°æ®åº“è€Œè¨€éƒ½æ˜¯â€œè¯»å¤šå†™å°‘â€ï¼Œæ¢è¨€ä¹‹ï¼Œæ•°æ®åº“çš„å‹åŠ›å¤šæ•°æ˜¯å› ä¸ºå¤§é‡çš„è¯»å–æ•°æ®çš„æ“ä½œé€ æˆçš„ï¼Œæˆ‘ä»¬å¯ä»¥é‡‡ç”¨æ•°æ®åº“é›†ç¾¤çš„æ–¹æ¡ˆï¼Œä½¿ç”¨ä¸€ä¸ªåº“ä½œä¸ºä¸»åº“ï¼Œè´Ÿè´£å†™å…¥æ•°æ®ï¼›å…¶ä»–åº“ä¸ºä»åº“ï¼Œè´Ÿè´£è¯»å–æ•°æ®ã€‚è¿™æ ·å¯ä»¥ç¼“è§£å¯¹æ•°æ®åº“çš„è®¿é—®å‹åŠ›ã€‚</p><h5 id="MySQL-å¸¸è§è¯»å†™åˆ†ç¦»æ–¹æ¡ˆæœ‰å“ªäº›ï¼Ÿ"><a href="#MySQL-å¸¸è§è¯»å†™åˆ†ç¦»æ–¹æ¡ˆæœ‰å“ªäº›ï¼Ÿ" class="headerlink" title="MySQL å¸¸è§è¯»å†™åˆ†ç¦»æ–¹æ¡ˆæœ‰å“ªäº›ï¼Ÿ"></a>MySQL å¸¸è§è¯»å†™åˆ†ç¦»æ–¹æ¡ˆæœ‰å“ªäº›ï¼Ÿ</h5><p>MySQL å¸¸è§çš„è¯»å†™åˆ†ç¦»æ–¹æ¡ˆï¼Œå¦‚ä¸‹åˆ—è¡¨ï¼š</p><p>1ï¼‰åº”ç”¨å±‚è§£å†³æ–¹æ¡ˆ å¯ä»¥é€šè¿‡åº”ç”¨å±‚å¯¹æ•°æ®æºåšè·¯ç”±æ¥å®ç°è¯»å†™åˆ†ç¦»ï¼Œæ¯”å¦‚ï¼Œä½¿ç”¨ SpringMVC + MyBatisï¼Œå¯ä»¥å°† SQL è·¯ç”±äº¤ç»™ Springï¼Œé€šè¿‡ AOP æˆ–è€… Annotation ç”±ä»£ç æ˜¾ç¤ºçš„æ§åˆ¶æ•°æ®æºã€‚ ä¼˜ç‚¹ï¼šè·¯ç”±ç­–ç•¥çš„æ‰©å±•æ€§å’Œå¯æ§æ€§è¾ƒå¼ºã€‚ ç¼ºç‚¹ï¼šéœ€è¦åœ¨ Spring ä¸­æ·»åŠ è€¦åˆæ§åˆ¶ä»£ç ã€‚</p><p>2ï¼‰ä¸­é—´ä»¶è§£å†³æ–¹æ¡ˆ é€šè¿‡ MySQL çš„ä¸­é—´ä»¶åšä¸»ä»é›†ç¾¤ï¼Œæ¯”å¦‚ï¼šMysql Proxyã€Amoebaã€Atlas ç­‰ä¸­é—´ä»¶éƒ½èƒ½ç¬¦åˆéœ€æ±‚ã€‚ ä¼˜ç‚¹ï¼šä¸åº”ç”¨å±‚è§£è€¦ã€‚ ç¼ºç‚¹ï¼šå¢åŠ ä¸€ä¸ªæœåŠ¡ç»´æŠ¤çš„é£é™©ç‚¹ï¼Œæ€§èƒ½åŠç¨³å®šæ€§å¾…æµ‹è¯•ï¼Œéœ€è¦æ”¯æŒä»£ç å¼ºåˆ¶ä¸»ä»å’Œäº‹åŠ¡ã€‚</p><h5 id="ä»‹ç»ä¸€ä¸‹-Sharding-JDBC-çš„åŠŸèƒ½å’Œæ‰§è¡Œæµç¨‹ï¼Ÿ"><a href="#ä»‹ç»ä¸€ä¸‹-Sharding-JDBC-çš„åŠŸèƒ½å’Œæ‰§è¡Œæµç¨‹ï¼Ÿ" class="headerlink" title="ä»‹ç»ä¸€ä¸‹ Sharding-JDBC çš„åŠŸèƒ½å’Œæ‰§è¡Œæµç¨‹ï¼Ÿ"></a>ä»‹ç»ä¸€ä¸‹ Sharding-JDBC çš„åŠŸèƒ½å’Œæ‰§è¡Œæµç¨‹ï¼Ÿ</h5><p>Sharding-JDBC åœ¨å®¢æˆ·ç«¯å¯¹æ•°æ®åº“è¿›è¡Œæ°´å¹³åˆ†åŒºçš„å¸¸ç”¨è§£å†³æ–¹æ¡ˆï¼Œä¹Ÿå°±æ˜¯ä¿æŒè¡¨ç»“æ„ä¸å˜ï¼Œæ ¹æ®ç­–ç•¥å­˜å‚¨æ•°æ®åˆ†ç‰‡ï¼Œè¿™æ ·æ¯ä¸€ç‰‡æ•°æ®è¢«åˆ†æ•£åˆ°ä¸åŒçš„è¡¨æˆ–è€…åº“ä¸­ï¼Œ</p><p>Sharding-JDBC æä¾›ä»¥ä¸‹åŠŸèƒ½ï¼š</p><ul><li><p>åˆ†åº“åˆ†è¡¨</p></li><li><p>è¯»å†™åˆ†ç¦»</p></li><li><p>åˆ†å¸ƒå¼ä¸»é”®ç”Ÿæˆ</p></li></ul><p>Sharding-JDBC çš„æ‰§è¡Œæµç¨‹ï¼šå½“ä¸šåŠ¡ä»£ç è°ƒç”¨æ•°æ®åº“æ‰§è¡Œçš„æ—¶å€™ï¼Œå…ˆè§¦å‘ Sharding-JDBC çš„åˆ†é…è§„åˆ™å¯¹ SQL è¯­å¥è¿›è¡Œè§£æã€æ”¹å†™ä¹‹åï¼Œæ‰ä¼šå¯¹æ”¹å†™çš„ SQL è¿›è¡Œæ‰§</p><p>è¡Œå’Œç»“æœå½’å¹¶ï¼Œç„¶åè¿”å›ç»™è°ƒç”¨å±‚ã€‚</p><h5 id="ä»€ä¹ˆæ˜¯-MySQL-å¤šå®ä¾‹ï¼Ÿå¦‚ä½•é…ç½®-MySQL-å¤šå®ä¾‹ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯-MySQL-å¤šå®ä¾‹ï¼Ÿå¦‚ä½•é…ç½®-MySQL-å¤šå®ä¾‹ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯ MySQL å¤šå®ä¾‹ï¼Ÿå¦‚ä½•é…ç½® MySQL å¤šå®ä¾‹ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯ MySQL å¤šå®ä¾‹ï¼Ÿå¦‚ä½•é…ç½® MySQL å¤šå®ä¾‹ï¼Ÿ</h5><p>MySQL å¤šå®ä¾‹å°±æ˜¯åœ¨åŒä¸€å°æœåŠ¡å™¨ä¸Šå¯ç”¨å¤šä¸ª MySQL æœåŠ¡ï¼Œå®ƒä»¬ç›‘å¬ä¸åŒçš„ç«¯å£ï¼Œè¿è¡Œå¤šä¸ªæœåŠ¡è¿›ç¨‹ï¼Œå®ƒä»¬ç›¸äº’ç‹¬ç«‹ï¼Œäº’ä¸å½±å“çš„å¯¹å¤–æä¾›æœåŠ¡ï¼Œä¾¿äºèŠ‚çº¦æœåŠ¡å™¨</p><p>èµ„æºä¸åæœŸæ¶æ„æ‰©å±•ã€‚ å¤šå®ä¾‹çš„é…ç½®æ–¹æ³•æœ‰ä¸¤ç§ï¼š</p><ul><li><p>ä¸€ä¸ªå®ä¾‹ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œä¸åŒç«¯å£ï¼›</p></li><li><p>åŒä¸€é…ç½®æ–‡ä»¶(my.cnf)ä¸‹é…ç½®ä¸åŒå®ä¾‹ï¼ŒåŸºäº MySQL çš„ d_multi å·¥å…·ã€‚</p></li></ul><h5 id="æ€æ ·ä¿è¯ç¡®ä¿å¤‡åº“æ— å»¶è¿Ÿï¼Ÿ"><a href="#æ€æ ·ä¿è¯ç¡®ä¿å¤‡åº“æ— å»¶è¿Ÿï¼Ÿ" class="headerlink" title="æ€æ ·ä¿è¯ç¡®ä¿å¤‡åº“æ— å»¶è¿Ÿï¼Ÿ"></a>æ€æ ·ä¿è¯ç¡®ä¿å¤‡åº“æ— å»¶è¿Ÿï¼Ÿ</h5><p>é€šå¸¸ä¿è¯ä¸»å¤‡æ— å»¶è¿Ÿæœ‰ä»¥ä¸‹ä¸‰ç§æ–¹æ³•ï¼š</p><ul><li><p>æ¯æ¬¡ä»åº“æ‰§è¡ŒæŸ¥è¯¢è¯·æ±‚å‰ï¼Œå…ˆåˆ¤æ–­ secondsbehindmaster æ˜¯å¦å·²ç»ç­‰äº 0ã€‚å¦‚æœè¿˜ä¸ç­‰äº 0 ï¼Œé‚£å°±å¿…é¡»ç­‰åˆ°è¿™ä¸ªå‚æ•°å˜ä¸º 0 æ‰èƒ½æ‰§è¡ŒæŸ¥è¯¢è¯·æ±‚ï¼Œsecondsbehindmaster å‚æ•°æ˜¯ç”¨æ¥è¡¡é‡ä¸»å¤‡å»¶è¿Ÿæ—¶é—´çš„é•¿çŸ­ï¼›</p></li><li><p>å¯¹æ¯”ä½ç‚¹ç¡®ä¿ä¸»å¤‡æ— å»¶è¿Ÿã€‚MasterLogFile å’Œ ReadMasterLogPosï¼Œè¡¨ç¤ºçš„æ˜¯è¯»åˆ°çš„ä¸»åº“çš„æœ€æ–°ä½ç‚¹ï¼ŒRelayMasterLogFile å’Œ ExecMasterLog_Posï¼Œè¡¨ç¤ºçš„æ˜¯å¤‡åº“æ‰§è¡Œçš„æœ€æ–°ä½ç‚¹ï¼›</p></li><li><p>å¯¹æ¯” GTID é›†åˆç¡®ä¿ä¸»å¤‡æ— å»¶è¿Ÿã€‚AutoPosition=1 ï¼Œè¡¨ç¤ºè¿™å¯¹ä¸»å¤‡å…³ç³»ä½¿ç”¨äº† GTID åè®®ï¼›RetrievedGtidSetï¼Œæ˜¯å¤‡åº“æ”¶åˆ°çš„æ‰€æœ‰æ—¥å¿—çš„ GTID é›†åˆï¼›ExecutedGtid_Setï¼Œæ˜¯å¤‡åº“æ‰€æœ‰å·²ç»æ‰§è¡Œå®Œæˆçš„ GTID é›†åˆã€‚</p></li></ul><h4 id="MySQL-å¸¸è§çš„å¼€æ”¾æ€§é—®é¢˜"><a href="#MySQL-å¸¸è§çš„å¼€æ”¾æ€§é—®é¢˜" class="headerlink" title="MySQL å¸¸è§çš„å¼€æ”¾æ€§é—®é¢˜"></a>MySQL å¸¸è§çš„å¼€æ”¾æ€§é—®é¢˜</h4><h5 id="æœ‰ä¸€ä¸ªè¶…çº§å¤§è¡¨ï¼Œå¦‚ä½•ä¼˜åŒ–åˆ†é¡µæŸ¥è¯¢ï¼Ÿ"><a href="#æœ‰ä¸€ä¸ªè¶…çº§å¤§è¡¨ï¼Œå¦‚ä½•ä¼˜åŒ–åˆ†é¡µæŸ¥è¯¢ï¼Ÿ" class="headerlink" title="æœ‰ä¸€ä¸ªè¶…çº§å¤§è¡¨ï¼Œå¦‚ä½•ä¼˜åŒ–åˆ†é¡µæŸ¥è¯¢ï¼Ÿ"></a>æœ‰ä¸€ä¸ªè¶…çº§å¤§è¡¨ï¼Œå¦‚ä½•ä¼˜åŒ–åˆ†é¡µæŸ¥è¯¢ï¼Ÿ</h5><p>è¶…çº§å¤§è¡¨çš„åˆ†é¡µä¼˜åŒ–åˆ†æœ‰ä»¥ä¸‹ä¸¤ç§æ–¹å¼ï¼š</p><ul><li><p>æ•°æ®åº“å±‚é¢ä¼˜åŒ–ï¼šåˆ©ç”¨å­æŸ¥è¯¢ä¼˜åŒ–è¶…å¤šåˆ†é¡µåœºæ™¯ï¼Œæ¯”å¦‚ï¼šSELECT a.* FROM è¡¨ 1 a, (select id from è¡¨ 1 where æ¡ä»¶ LIMIT 100000,20 ) b where a.id=b.id ï¼Œå…ˆå¿«é€Ÿå®šä½éœ€è¦è·å–çš„ id æ®µï¼Œç„¶åå†å…³è”æŸ¥è¯¢ã€‚MySQL å¹¶ä¸æ˜¯è·³è¿‡ offset è¡Œï¼Œè€Œæ˜¯å– offset+N è¡Œï¼Œç„¶åè¿”å›æ”¾å¼ƒå‰ offset è¡Œï¼Œè¿”å› N è¡Œï¼Œé‚£å½“ offset ç‰¹åˆ«å¤§çš„æ—¶å€™ï¼Œæ•ˆç‡å°±éå¸¸çš„ä½ä¸‹ï¼Œè¦ä¹ˆæ§åˆ¶è¿”å›çš„æ€»é¡µæ•°ï¼Œè¦ä¹ˆå¯¹è¶…è¿‡ç‰¹å®šé˜ˆå€¼çš„é¡µæ•°è¿›è¡Œ SQL æ”¹å†™ï¼Œåˆ©ç”¨å­æŸ¥è¯¢å…ˆå¿«é€Ÿå®šä½éœ€è¦è·å–çš„ id æ®µï¼Œç„¶åå†å…³è”æŸ¥è¯¢ï¼Œå°±æ˜¯å¯¹åˆ†é¡µè¿›è¡Œ SQL æ”¹å†™çš„å…·ä½“å®ç°ï¼›</p></li><li><p>ç¨‹åºå±‚é¢ä¼˜åŒ–ï¼šå¯ä»¥åˆ©ç”¨ç¼“å­˜æŠŠæŸ¥è¯¢çš„ç»“æœç¼“å­˜èµ·æ¥ï¼Œè¿™æ ·å†ä¸‹ä¸€æ¬¡æŸ¥è¯¢çš„æ—¶å€™æ€§èƒ½å°±éå¸¸é«˜äº†ã€‚</p></li></ul><h5 id="çº¿ä¸Šä¿®æ”¹è¡¨ç»“æ„æœ‰å“ªäº›é£é™©ï¼Ÿ"><a href="#çº¿ä¸Šä¿®æ”¹è¡¨ç»“æ„æœ‰å“ªäº›é£é™©ï¼Ÿ" class="headerlink" title="çº¿ä¸Šä¿®æ”¹è¡¨ç»“æ„æœ‰å“ªäº›é£é™©ï¼Ÿ"></a>çº¿ä¸Šä¿®æ”¹è¡¨ç»“æ„æœ‰å“ªäº›é£é™©ï¼Ÿ</h5><p>çº¿ä¸Šä¿®æ”¹è¡¨ç»“æ„æœ‰å¯èƒ½ MySQL æœåŠ¡å™¨é˜»å¡ï¼Œå› ä¸ºåœ¨æ‰§è¡Œ DMLï¼ˆselectã€updateã€deleteã€insertï¼‰æ“ä½œæ—¶ï¼Œä¼šç»™è¡¨å¢åŠ ä¸€ä¸ªå…ƒæ•°æ®é”ï¼Œè¿™ä¸ªå…ƒæ•°æ®é”æ˜¯ä¸ºäº†ä¿è¯åœ¨æŸ¥è¯¢æœŸé—´è¡¨ç»“æ„ä¸ä¼šè¢«ä¿®æ”¹ï¼Œè€Œæ‰§è¡Œä¿®æ”¹è¡¨ç»“æ„æ—¶ï¼Œå¿…é¡»è¦ç­‰å¾…å…ƒæ•°æ®é”å®Œæˆä¹‹åæ‰èƒ½æ‰§è¡Œï¼Œè¿™å°±å¯èƒ½é€ æˆæ•°æ®åº“æœåŠ¡å™¨çš„é˜»å¡ã€‚</p><p>åœ¨ MySQL 5.6 å¼€å§‹æä¾›äº† online ddl åŠŸèƒ½ï¼Œå…è®¸ä¸€äº› DDLï¼ˆcreate table/view/index/syn/clusterï¼‰è¯­å¥å’Œ DML è¯­å¥å¹¶å‘ï¼Œåœ¨ 5.7 ç‰ˆæœ¬å¯¹ online ddl åˆæœ‰äº†å¢å¼ºï¼Œè¿™ä½¿å¾—å¤§éƒ¨åˆ† DDL æ“ä½œå¯ä»¥åœ¨çº¿è¿›è¡Œï¼Œè¯¦è§ï¼š<a href="https://dev.mysql.com/doc/refman/5.7/en/innodb-create-index-overview.html%EF%BC%8C%E8%BF%99%E4%BD%BF%E5%BE%97%E5%9C%A8%E7%BA%BF%E4%B8%8A%E4%BF%AE%E6%94%B9%E8%A1%A8%E7%BB%93%E6%9E%84%E7%9A%84%E9%A3%8E%E9%99%A9%E5%8F%98%E7%9A%84%E6%9B%B4%E5%A4%A7%EF%BC%8C%E5%A6%82%E6%9E%9C%E5%9C%A8%E4%B8%9A%E5%8A%A1%E5%BC%80%E5%8F%91%E8%BF%87%E7%A8%8B%E4%B8%AD%E5%BF%85%E9%A1%BB%E5%9C%A8%E7%BA%BF%E4%BF%AE%E6%94%B9%E8%A1%A8%E7%BB%93%E6%9E%84%EF%BC%8C%E5%8F%AF%E4%BB%A5%E5%8F%82%E8%80%83%E4%BB%A5%E4%B8%8B%E6%96%B9%E6%A1%88%EF%BC%9A">https://dev.mysql.com/doc/refman/5.7/en/innodb-create-index-overview.htmlï¼Œè¿™ä½¿å¾—åœ¨çº¿ä¸Šä¿®æ”¹è¡¨ç»“æ„çš„é£é™©å˜çš„æ›´å¤§ï¼Œå¦‚æœåœ¨ä¸šåŠ¡å¼€å‘è¿‡ç¨‹ä¸­å¿…é¡»åœ¨çº¿ä¿®æ”¹è¡¨ç»“æ„ï¼Œå¯ä»¥å‚è€ƒä»¥ä¸‹æ–¹æ¡ˆï¼š</a></p><ul><li><p>å°½é‡åœ¨ä¸šåŠ¡é‡å°çš„æ—¶é—´æ®µè¿›è¡Œï¼›</p></li><li><p>æŸ¥çœ‹å®˜æ–¹æ–‡æ¡£ï¼Œç¡®è®¤è¦åšçš„è¡¨ä¿®æ”¹å¯ä»¥å’Œ DML å¹¶å‘ï¼Œä¸ä¼šé˜»å¡çº¿ä¸Šä¸šåŠ¡ï¼›</p></li><li><p>æ¨èä½¿ç”¨ percona å…¬å¸çš„ pt-online-schema-change å·¥å…·ï¼Œè¯¥å·¥å…·è¢«å®˜æ–¹çš„ online ddl æ›´ä¸ºå¼ºå¤§ï¼Œå®ƒçš„åŸºæœ¬åŸç†æ˜¯ï¼šé€šè¿‡ insertâ€¦selectâ€¦ è¯­å¥è¿›è¡Œä¸€æ¬¡å…¨é‡æ‹·è´ï¼Œé€šè¿‡è§¦å‘å™¨è®°å½•è¡¨ç»“æ„å˜æ›´è¿‡ç¨‹ä¸­äº§ç”Ÿçš„å¢é‡ï¼Œä»è€Œè¾¾åˆ°è¡¨ç»“æ„å˜æ›´çš„ç›®çš„ã€‚æ¯”å¦‚ï¼Œè¦å¯¹ A è¡¨è¿›è¡Œå˜æ›´ï¼Œå®ƒçš„ä¸»è¦æµç¨‹ä¸ºï¼š</p></li></ul><p>1ï¼‰åˆ›å»ºç›®çš„è¡¨ç»“æ„çš„ç©ºè¡¨ A_newï¼›</p><p>2ï¼‰åœ¨Aè¡¨ä¸Šåˆ›å»ºè§¦å‘å™¨ï¼ŒåŒ…æ‹¬å¢ã€åˆ ã€æ”¹è§¦å‘å™¨ï¼›</p><p>3ï¼‰é€šè¿‡ insertâ€¦selectâ€¦limit N è¯­å¥åˆ†ç‰‡æ‹·è´æ•°æ®åˆ°ç›®çš„è¡¨ï¼›</p><p>4ï¼‰Copyå®Œæˆåï¼Œå°† A_new è¡¨ rename åˆ° A è¡¨ã€‚</p><h5 id="æŸ¥è¯¢é•¿æ—¶é—´ä¸è¿”å›å¯èƒ½æ˜¯ä»€ä¹ˆåŸå› ï¼Ÿåº”è¯¥å¦‚ä½•å¤„ç†ï¼Ÿ"><a href="#æŸ¥è¯¢é•¿æ—¶é—´ä¸è¿”å›å¯èƒ½æ˜¯ä»€ä¹ˆåŸå› ï¼Ÿåº”è¯¥å¦‚ä½•å¤„ç†ï¼Ÿ" class="headerlink" title="æŸ¥è¯¢é•¿æ—¶é—´ä¸è¿”å›å¯èƒ½æ˜¯ä»€ä¹ˆåŸå› ï¼Ÿåº”è¯¥å¦‚ä½•å¤„ç†ï¼Ÿ"></a>æŸ¥è¯¢é•¿æ—¶é—´ä¸è¿”å›å¯èƒ½æ˜¯ä»€ä¹ˆåŸå› ï¼Ÿåº”è¯¥å¦‚ä½•å¤„ç†ï¼Ÿ</h5><p>æŸ¥è¯¢é€Ÿåº¦æ…¢çš„åŸå› å¾ˆå¤šï¼Œå¸¸è§å¦‚ä¸‹å‡ ç§ï¼š</p><p> 1ï¼‰æŸ¥è¯¢å­—æ®µæ²¡æœ‰ç´¢å¼•æˆ–è€…æ²¡æœ‰è§¦å‘ç´¢å¼•æŸ¥è¯¢ï¼Œæ²¡æœ‰è§¦å‘ç´¢å¼•æŸ¥è¯¢çš„æƒ…å†µå¦‚ä¸‹ï¼š ä¸ä¼šä½¿ç”¨ç´¢å¼•çš„æƒ…å†µå¦‚ä¸‹ï¼š</p><ul><li><p>ä»¥ % å¼€å¤´çš„ like æŸ¥è¯¢ä¸ä¼šä½¿ç”¨ b-tree ç´¢å¼•ï¼›</p></li><li><p>æ•°æ®ç±»å‹å‡ºç°éšå¼è½¬æ¢æ—¶ä¸ä¼šä½¿ç”¨ç´¢å¼•ï¼Œæ¯”å¦‚ï¼ŒæŸåˆ—æ˜¯ varchar ç±»å‹ï¼Œå´ä½¿ç”¨äº†columnname=1 çš„æŸ¥è¯¢è¯­å¥ï¼Œè¿™æ˜¯ä¸ä¼šä½¿ç”¨ç´¢å¼•ï¼Œæ­£ç¡®è§¦å‘ç´¢å¼•çš„æŸ¥è¯¢è¯­å¥ä¸ºï¼šcolumnname=â€™1â€™ ï¼›</p></li><li><p>ä¸ç¬¦åˆæœ€å·¦å‰ç¼€åŸåˆ™ï¼›</p></li><li><p>å¦‚æœæŸ¥è¯¢æ¡ä»¶æœ‰ or åˆ†å‰²ï¼Œor å‰é¢çš„ä½¿ç”¨ç´¢å¼•ï¼Œor åé¢çš„æœªä½¿ç”¨ç´¢å¼•ï¼Œåˆ™ä¸ä¼šä½¿ç”¨ç´¢å¼•ï¼Œå› ä¸ºå³ä½¿ or ä¹‹å‰çš„ä½¿ç”¨äº†ç´¢å¼•ï¼Œä½†æ˜¯ or ä¹‹åçš„ä¹Ÿéœ€è¦å…¨è¡¨æŸ¥è¯¢ï¼Œç´¢å¼•å°±å¿½ç•¥ç´¢å¼•ï¼Œç›´æ¥å…¨è¡¨æŸ¥è¯¢ï¼›</p></li><li><p>å¦‚æœ MySQL è®¤ä¸ºä½¿ç”¨ç´¢å¼•ä¼šæ¯”å…¨è¡¨æŸ¥è¯¢æ›´æ…¢ï¼Œåˆ™ä¸ä¼šä½¿ç”¨ç´¢å¼•ã€‚</p></li></ul><p>2ï¼‰I/O å‹åŠ›å¤§ï¼Œè¯»å–ç£ç›˜é€Ÿåº¦å˜æ…¢ã€‚ </p><p>3ï¼‰å†…å­˜ä¸è¶³ </p><p>4ï¼‰ç½‘ç»œé€Ÿåº¦æ…¢ </p><p>5ï¼‰æŸ¥è¯¢å‡ºçš„æ•°æ®é‡è¿‡å¤§ï¼Œå¯ä»¥é‡‡ç”¨å¤šæ¬¡æŸ¥è¯¢æˆ–å…¶ä»–çš„æ–¹æ³•é™ä½æ•°æ®é‡ </p><p>6ï¼‰æ­»é”ï¼Œä¸€èˆ¬ç¢°åˆ°è¿™ç§æƒ…å†µçš„è¯ï¼Œå¤§æ¦‚ç‡æ˜¯è¡¨è¢«é”ä½äº†ï¼Œå¯ä»¥ä½¿ç”¨ show processlist; å‘½ä»¤ï¼Œçœ‹çœ‹ SQL è¯­å¥çš„çŠ¶æ€ï¼Œå†é’ˆå¯¹ä¸åŒçš„çŠ¶æ€åšç›¸åº”çš„å¤„ç†ã€‚</p><p> <img src="/images/mysql/deadlock.png"></p><p>å…¶ä¸­ï¼Œå½“ State åˆ—å€¼ä¸º Locked æ—¶ï¼Œè¡¨ç¤ºè¢«é”å®šã€‚ å…¶å®ƒå…³äºæŸ¥çœ‹æ­»é”çš„å‘½ä»¤ï¼š</p><p> aï¼‰æŸ¥çœ‹å½“å‰çš„äº‹åŠ¡ï¼š</p><p><code>select * from informationschema.innodbtrx;</code></p><p>bï¼‰æŸ¥çœ‹å½“å‰é”å®šçš„äº‹åŠ¡ï¼š</p><p><code>select * from informationschema.innodblocks;</code></p><p>cï¼‰æŸ¥çœ‹å½“å‰ç­‰é”çš„äº‹åŠ¡</p><p><code>select * from informationschema.innodblock_waits;</code></p><p>ä»¥ä¸Šé—®é¢˜çš„è§£å†³æ–¹æ¡ˆå¦‚ä¸‹ï¼š</p><p>1ï¼‰æ­£ç¡®åˆ›å»ºå’Œä½¿ç”¨ç´¢å¼•ã€‚ </p><p>2ï¼‰æŠŠæ•°æ®ã€æ—¥å¿—ã€ç´¢å¼•æ”¾åˆ°ä¸åŒçš„ IO è®¾å¤‡ä¸Šï¼Œå‡å°‘ä¸»æ•°æ®åº“çš„ IO æ“ä½œã€‚æ›´æ¢ MySQL çš„ç£ç›˜ä¸ºå›ºæ€ç¡¬ç›˜ï¼Œä»¥æé«˜ç£ç›˜çš„ IO æ€§èƒ½ã€‚ </p><p>3ï¼‰å‡çº§å†…å­˜ï¼Œæ›´æ¢æ›´å¤§çš„å†…å­˜ã€‚</p><p>4ï¼‰æå‡ç½‘é€Ÿï¼Œå‡çº§å¸¦å®½ã€‚ </p><p>5ï¼‰ç”¨ Profiler æ¥è·Ÿè¸ªæŸ¥è¯¢ï¼Œå¾—åˆ°æŸ¥è¯¢æ‰€éœ€çš„æ—¶é—´ï¼Œæ‰¾å‡ºæœ‰é—®é¢˜çš„ SQL è¯­å¥ï¼Œä¼˜åŒ– SQLã€‚ </p><p>6ï¼‰æŸ¥è¯¢æ—¶å€¼è¿”å›éœ€è¦çš„å­—æ®µã€‚ </p><p>7ï¼‰è®¾ç½®æ­»é”çš„è¶…æ—¶æ—¶é—´ï¼Œé™åˆ¶å’Œé¿å…æ­»é”æ¶ˆè€—è¿‡å¤šæœåŠ¡å™¨çš„èµ„æºã€‚ </p><p>8ï¼‰å°½é‡å°‘ç”¨è§†å›¾ï¼Œå®ƒçš„æ•ˆç‡ä½ï¼Œå¯¹è§†å›¾æ“ä½œæ¯”ç›´æ¥å¯¹è¡¨æ“ä½œæ…¢,å¯ä»¥ç”¨å­˜å‚¨è¿‡ç¨‹æ¥ä»£æ›¿è§†å›¾ã€‚ä¸è¦ç”¨è§†å›¾åµŒå¥—ï¼ŒåµŒå¥—è§†å›¾å¢åŠ äº†å¯»æ‰¾åŸå§‹æ•°æ®çš„éš¾åº¦ã€‚</p><h5 id="ä»€ä¹ˆæ˜¯-MySQL-ä¸»ä»ï¼Ÿä¸»ä»åŒæ­¥æœ‰ä»€ä¹ˆå¥½å¤„ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯-MySQL-ä¸»ä»ï¼Ÿä¸»ä»åŒæ­¥æœ‰ä»€ä¹ˆå¥½å¤„ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯ MySQL ä¸»ä»ï¼Ÿä¸»ä»åŒæ­¥æœ‰ä»€ä¹ˆå¥½å¤„ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯ MySQL ä¸»ä»ï¼Ÿä¸»ä»åŒæ­¥æœ‰ä»€ä¹ˆå¥½å¤„ï¼Ÿ</h5><p>MySQL ä¸»ä»åŒæ­¥ï¼šMySQL æœ‰å¤šä¸ªæœåŠ¡å™¨å»ï¼Œä¸€ä¸ªæœåŠ¡å™¨ä½œä¸ºä¸»æœåŠ¡å™¨ï¼Œå…¶å®ƒæœåŠ¡å™¨ä½œä¸ºä»æœåŠ¡å™¨ï¼Œé€šè¿‡é…ç½®æˆ‘ä»¬å¯ä»¥å°†ä¸»æœåŠ¡å™¨çš„æ‰€æœ‰æ•°æ®æˆ–è€…éƒ¨åˆ†æ•°æ®å¤åˆ¶åˆ°ä»æœåŠ¡å™¨ä¸Šã€‚å¤åˆ¶çš„è¿‡ç¨‹æ˜¯å¼‚æ­¥è¿›è¡Œçš„ã€‚</p><p>ä¸»ä»åŒæ­¥çš„å¥½å¤„ï¼šï¼ˆè¯»å†™åˆ†ç¦»ï¼Œæ•°æ®å¤‡ä»½ï¼Œè´Ÿè½½å‡è¡¡ï¼‰æˆ‘ä»¬å¯ä»¥è®¾ç½®ä¸»æœåŠ¡å™¨å†™å…¥æ•°æ®ï¼Œè¯»å–æ•°æ®ä½¿ç”¨ä»æœåŠ¡å™¨ã€‚ä¿è¯æ•°æ®åº“è´Ÿè½½å‡è¡¡ã€‚æ•°æ®éšæ—¶éƒ½åœ¨è¿›è¡ŒåŒæ­¥å¤‡ä»½ï¼Œä¿è¯äº†æ•°æ®çš„å®‰å…¨æ€§ã€‚</p><h5 id="MySQL-ä¸»ä»å»¶è¿Ÿçš„åŸå› æœ‰å“ªäº›ï¼Ÿ"><a href="#MySQL-ä¸»ä»å»¶è¿Ÿçš„åŸå› æœ‰å“ªäº›ï¼Ÿ" class="headerlink" title="MySQL ä¸»ä»å»¶è¿Ÿçš„åŸå› æœ‰å“ªäº›ï¼Ÿ"></a>MySQL ä¸»ä»å»¶è¿Ÿçš„åŸå› æœ‰å“ªäº›ï¼Ÿ</h5><p>ä¸»ä»å»¶è¿Ÿå¯ä»¥æ ¹æ® MySQL æä¾›çš„å‘½ä»¤åˆ¤æ–­ï¼Œæ¯”å¦‚ï¼Œåœ¨ä»æœåŠ¡å™¨ä½¿ç”¨å‘½ä»¤ï¼š show slave status;ï¼Œå…¶ä¸­ SecondsBehindMaster å¦‚æœä¸º 0 è¡¨ç¤ºä¸»ä»å¤åˆ¶çŠ¶æ€æ­£å¸¸ã€‚ å¯¼è‡´</p><p>ä¸»ä»å»¶è¿Ÿçš„åŸå› æœ‰ä»¥ä¸‹å‡ ä¸ªï¼š</p><ul><li><p>ä¸»åº“æœ‰å¤§äº‹åŠ¡å¤„ç†ï¼›</p></li><li><p>ä¸»åº“åšå¤§é‡çš„å¢ã€åˆ ã€æ”¹æ“ä½œï¼›</p></li><li><p>ä¸»åº“å¯¹å¤§è¡¨è¿›è¡Œå­—æ®µæ–°å¢ã€ä¿®æ”¹æˆ–æ·»åŠ ç´¢å¼•ç­‰æ“ä½œï¼›</p></li><li><p>ä¸»åº“çš„ä»åº“å¤ªå¤šï¼Œå¯¼è‡´å¤åˆ¶å»¶è¿Ÿã€‚ä»åº“æ•°é‡ä¸€èˆ¬ 3-5 ä¸ªä¸ºå®œï¼Œè¦å¤åˆ¶çš„èŠ‚ç‚¹è¿‡å¤šï¼Œå¯¼è‡´å¤åˆ¶å»¶è¿Ÿï¼›</p></li><li><p>ä»åº“ç¡¬ä»¶é…ç½®æ¯”ä¸»åº“å·®ï¼Œå¯¼è‡´å»¶è¿Ÿã€‚æŸ¥çœ‹ Master å’Œ Slave çš„é…ç½®ï¼Œå¯èƒ½å› ä¸ºä»åº“çš„é…ç½®è¿‡ä½ï¼Œæ‰§è¡Œæ—¶é—´é•¿ï¼Œç”±æ­¤å¯¼è‡´çš„å¤åˆ¶å»¶è¿Ÿæ—¶é—´é•¿ï¼›</p></li><li><p>ä¸»åº“è¯»å†™å‹åŠ›å¤§ï¼Œå¯¼è‡´å¤åˆ¶å»¶è¿Ÿï¼›</p></li><li><p>ä»åº“ä¹‹é—´çš„ç½‘ç»œå»¶è¿Ÿã€‚ä¸»ä»åº“ç½‘å¡ã€ç½‘çº¿ã€è¿æ¥çš„äº¤æ¢æœºç­‰ç½‘ç»œè®¾å¤‡éƒ½å¯èƒ½æˆä¸ºå¤åˆ¶çš„ç“¶é¢ˆï¼Œå¯¼è‡´å¤åˆ¶å»¶è¿Ÿï¼Œå¦å¤–è·¨å…¬ç½‘ä¸»ä»å¤åˆ¶å¾ˆå®¹æ˜“å¯¼è‡´ä¸»ä»å¤åˆ¶å»¶è¿Ÿã€‚</p></li></ul><h5 id="MySQL-ä¸»ä»ä¸-MongoDB-å‰¯æœ¬é›†æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"><a href="#MySQL-ä¸»ä»ä¸-MongoDB-å‰¯æœ¬é›†æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ" class="headerlink" title="MySQL ä¸»ä»ä¸ MongoDB å‰¯æœ¬é›†æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"></a>MySQL ä¸»ä»ä¸ MongoDB å‰¯æœ¬é›†æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h5><ul><li><p>MongoDB æ˜¯åœ¨åŒä¸€ä¸ªæœåŠ¡å™¨ï¼ˆä¸€å°æœºå™¨ï¼‰ï¼ŒåŒæ—¶å¤åˆ¶å¤‡ä»½å¤šä¸ªæ•°æ®åº“</p></li><li><p>MySQL å¤åˆ¶å¤‡ä»½æ•°æ®æ˜¯åœ¨å¤šä¸ªæœåŠ¡å™¨ï¼ˆå¤šå°æœºå™¨ï¼‰ï¼Œå¤åˆ¶å¤‡ä»½å¤šä¸ªæ•°æ®åº“</p></li><li><p>MongoDB å¤åˆ¶å¤‡ä»½æ˜¯åŒæ­¥çš„ï¼ŒMySQL å¤åˆ¶å¤‡ä»½å¯ä»¥æ˜¯å¼‚æ­¥çš„ï¼Œä¹Ÿå¯ä»¥ä¸»ä»åŒæ­¥</p></li><li><p>MongoDB è¯»å†™åœ¨æŒ‡å®šçš„æŸä¸€ä¸ªæ•°æ®åº“ä½œä¸ºä¸»æ•°æ®åº“</p></li><li><p>MySQL ä¸€èˆ¬ä¸»æœåŠ¡å™¨å†™ï¼Œä»æœåŠ¡å™¨è¯»ï¼Œè¯»å†™åˆ†ç¦»</p></li></ul><h5 id="å¦‚ä½•ä¿è¯æ•°æ®ä¸è¢«è¯¯åˆ ï¼Ÿ"><a href="#å¦‚ä½•ä¿è¯æ•°æ®ä¸è¢«è¯¯åˆ ï¼Ÿ" class="headerlink" title="å¦‚ä½•ä¿è¯æ•°æ®ä¸è¢«è¯¯åˆ ï¼Ÿ"></a>å¦‚ä½•ä¿è¯æ•°æ®ä¸è¢«è¯¯åˆ ï¼Ÿ</h5><p>ä¿è¯æ•°æ®ä¸è¢«è¯¯åˆ çš„æ–¹æ³•å¦‚ä¸‹åˆ—è¡¨ï¼š</p><ul><li><p>æƒé™æ§åˆ¶ä¸åˆ†é…ï¼ˆæ•°æ®åº“å’ŒæœåŠ¡å™¨æƒé™ï¼‰</p></li><li><p>é¿å…æ•°æ®åº“è´¦å·ä¿¡æ¯æ³„éœ²ï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œä¸šåŠ¡ä»£ç ä¸è¦ä½¿ç”¨æ˜æ–‡ä¿å­˜æ•°æ®åº“è¿æ¥ä¿¡æ¯ï¼›</p></li><li><p>é‡è¦çš„æ•°æ®åº“æ“ä½œï¼Œé€šè¿‡å¹³å°å‹å·¥å…·è‡ªåŠ¨å®æ–½ï¼Œå‡å°‘äººå·¥æ“ä½œï¼›</p></li><li><p>éƒ¨ç½²å»¶è¿Ÿå¤åˆ¶ä»åº“ï¼Œä¸‡ä¸€è¯¯åˆ é™¤æ—¶ç”¨äºæ•°æ®å›æ¡£ï¼Œä¸”ä»åº“è®¾ç½®ä¸º read-onlyï¼›</p></li><li><p>ç¡®è®¤å¤‡ä»½åˆ¶åº¦åŠæ—¶æœ‰æ•ˆï¼›</p></li><li><p>å¯ç”¨ SQL å®¡è®¡åŠŸèƒ½ï¼Œå…»æˆè‰¯å¥½ SQL ä¹ æƒ¯ï¼›</p></li><li><p>å¯ç”¨ sqlsafeupdates é€‰é¡¹ï¼Œä¸å…è®¸æ²¡ where æ¡ä»¶çš„æ›´æ–°/åˆ é™¤ï¼›</p></li><li><p>å°†ç³»ç»Ÿå±‚çš„ rm æ”¹ä¸º mvï¼›</p></li><li><p>çº¿ä¸Šä¸è¿›è¡Œç‰©ç†åˆ é™¤ï¼Œæ”¹ä¸ºé€»è¾‘åˆ é™¤ï¼ˆå°† row data æ ‡è®°ä¸ºä¸å¯ç”¨ï¼‰ï¼›</p></li><li><p>å¯ç”¨å ¡å’æœºï¼Œå±è”½é«˜å± SQLï¼›</p></li><li><p>é™ä½æ•°æ®åº“ä¸­æ™®é€šè´¦å·çš„æƒé™çº§åˆ«ï¼›</p></li><li><p>å¼€å¯ binlogï¼Œæ–¹ä¾¿è¿½æº¯æ•°æ®ã€‚</p></li></ul><h5 id="MySQL-æœåŠ¡å™¨-CPU-é£™å‡åº”è¯¥å¦‚ä½•å¤„ç†ï¼Ÿ"><a href="#MySQL-æœåŠ¡å™¨-CPU-é£™å‡åº”è¯¥å¦‚ä½•å¤„ç†ï¼Ÿ" class="headerlink" title="MySQL æœåŠ¡å™¨ CPU é£™å‡åº”è¯¥å¦‚ä½•å¤„ç†ï¼Ÿ"></a>MySQL æœåŠ¡å™¨ CPU é£™å‡åº”è¯¥å¦‚ä½•å¤„ç†ï¼Ÿ</h5><p>ä½¿ç”¨ show full processlist; æŸ¥å‡ºæ…¢æŸ¥è¯¢ï¼Œä¸ºäº†ç¼“è§£æ•°æ®åº“æœåŠ¡å™¨å‹åŠ›ï¼Œå…ˆä½¿ç”¨ kill å‘½ä»¤æ€æ‰æ…¢æŸ¥è¯¢çš„å®¢æˆ·ç«¯ï¼Œæ•ˆæœå¦‚ä¸‹ï¼š</p><p> <img src="/images/mysql/fullprocesslist.png"></p><p>ç„¶åå†å»é¡¹ç›®ä¸­æ‰¾åˆ°æ‰§è¡Œæ…¢çš„ SQL è¯­å¥è¿›è¡Œä¿®æ”¹å’Œä¼˜åŒ–ã€‚</p><h5 id="MySQL-æ¯«æ— è§„å¾‹çš„å¼‚å¸¸é‡å¯ï¼Œå¯èƒ½äº§ç”Ÿçš„åŸå› æ˜¯ä»€ä¹ˆï¼Ÿè¯¥å¦‚ä½•è§£å†³ï¼Ÿ"><a href="#MySQL-æ¯«æ— è§„å¾‹çš„å¼‚å¸¸é‡å¯ï¼Œå¯èƒ½äº§ç”Ÿçš„åŸå› æ˜¯ä»€ä¹ˆï¼Ÿè¯¥å¦‚ä½•è§£å†³ï¼Ÿ" class="headerlink" title="MySQL æ¯«æ— è§„å¾‹çš„å¼‚å¸¸é‡å¯ï¼Œå¯èƒ½äº§ç”Ÿçš„åŸå› æ˜¯ä»€ä¹ˆï¼Ÿè¯¥å¦‚ä½•è§£å†³ï¼Ÿ"></a>MySQL æ¯«æ— è§„å¾‹çš„å¼‚å¸¸é‡å¯ï¼Œå¯èƒ½äº§ç”Ÿçš„åŸå› æ˜¯ä»€ä¹ˆï¼Ÿè¯¥å¦‚ä½•è§£å†³ï¼Ÿ</h5><p>å¯èƒ½æ˜¯ç§¯ç´¯çš„é•¿è¿æ¥å¯¼è‡´å†…å­˜å ç”¨å¤ªå¤šï¼Œè¢«ç³»ç»Ÿå¼ºè¡Œæ€æ‰å¯¼è‡´çš„å¼‚å¸¸é‡å¯ï¼Œå› ä¸ºåœ¨ MySQL ä¸­é•¿è¿æ¥åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ä½¿ç”¨çš„ä¸´æ—¶å†…å­˜å¯¹è±¡ï¼Œåªæœ‰åœ¨è¿æ¥æ–­å¼€çš„æ—¶å€™æ‰ä¼š</p><p>é‡Šæ”¾ï¼Œè¿™å°±ä¼šå¯¼è‡´å†…å­˜ä¸æ–­é£™å‡ï¼Œè§£å†³æ–¹æ¡ˆå¦‚ä¸‹ï¼š</p><ul><li><p>å®šæœŸæ–­å¼€ç©ºé—²çš„é•¿è¿æ¥ï¼›</p></li><li><p>å¦‚æœæ˜¯ç”¨çš„æ˜¯ MySQL 5.7 ä»¥ä¸Šçš„ç‰ˆæœ¬ï¼Œå¯ä»¥å®šæœŸæ‰§è¡Œ <code>mysqlresetconnection</code> é‡æ–°åˆå§‹åŒ–è¿æ¥èµ„æºï¼Œè¿™ä¸ªè¿‡ç¨‹ä¼šé‡Šæ”¾ä¹‹å‰ä½¿ç”¨çš„å†…å­˜èµ„æºï¼Œæ¢å¤åˆ°è¿æ¥åˆšåˆå§‹åŒ–çš„çŠ¶æ€ã€‚</p></li></ul><h5 id="å¦‚ä½•å®ç°ä¸€ä¸ªé«˜å¹¶å‘çš„ç³»ç»Ÿï¼Ÿ"><a href="#å¦‚ä½•å®ç°ä¸€ä¸ªé«˜å¹¶å‘çš„ç³»ç»Ÿï¼Ÿ" class="headerlink" title="å¦‚ä½•å®ç°ä¸€ä¸ªé«˜å¹¶å‘çš„ç³»ç»Ÿï¼Ÿ"></a>å¦‚ä½•å®ç°ä¸€ä¸ªé«˜å¹¶å‘çš„ç³»ç»Ÿï¼Ÿ</h5><p>è¿™é“é¢è¯•é¢˜æ¶‰åŠçš„çŸ¥è¯†ç‚¹æ¯”è¾ƒå¤šï¼Œä¸»è¦è€ƒå¯Ÿçš„æ˜¯é¢è¯•è€…çš„ç»¼åˆæŠ€æœ¯èƒ½åŠ›ã€‚é«˜å¹¶å‘ç³»ç»Ÿçš„è®¾è®¡æ‰‹æ®µæœ‰å¾ˆå¤šï¼Œä¸»è¦ä½“ç°åœ¨ä»¥ä¸‹äº”ä¸ªæ–¹é¢ã€‚</p><p>1ï¼‰å‰ç«¯ä¼˜åŒ–</p><p>â‘  é™æ€èµ„æºç¼“å­˜ï¼šå°†æ´»åŠ¨é¡µé¢ä¸Šçš„æ‰€æœ‰å¯ä»¥é™æ€çš„å…ƒç´ å…¨éƒ¨é™æ€åŒ–ï¼Œå°½é‡å‡å°‘åŠ¨æ€å…ƒç´ ï¼›é€šè¿‡ CDNã€æµè§ˆå™¨ç¼“å­˜ï¼Œæ¥å‡å°‘å®¢æˆ·ç«¯å‘æœåŠ¡å™¨ç«¯çš„æ•°æ®è¯·æ±‚ã€‚</p><p>â‘¡ ç¦æ­¢é‡å¤æäº¤ï¼šç”¨æˆ·æäº¤ä¹‹åæŒ‰é’®ç½®ç°ï¼Œç¦æ­¢é‡å¤æäº¤ã€‚</p><p>â‘¢ ç”¨æˆ·é™æµï¼šåœ¨æŸä¸€æ—¶é—´æ®µå†…åªå…è®¸ç”¨æˆ·æäº¤ä¸€æ¬¡è¯·æ±‚ï¼Œæ¯”å¦‚ï¼Œé‡‡å– IP é™æµã€‚</p><p>2ï¼‰ä¸­é—´å±‚è´Ÿè½½åˆ†å‘</p><p>å¯åˆ©ç”¨è´Ÿè½½å‡è¡¡ï¼Œæ¯”å¦‚ nginx ç­‰å·¥å…·ï¼Œå¯ä»¥å°†å¹¶å‘è¯·æ±‚åˆ†é…åˆ°ä¸åŒçš„æœåŠ¡å™¨ï¼Œä»è€Œæé«˜äº†ç³»ç»Ÿå¤„ç†å¹¶å‘çš„èƒ½åŠ›ã€‚ nginx è´Ÿè½½åˆ†å‘çš„äº”ç§æ–¹å¼ï¼š</p><p>â‘  è½®è¯¢ï¼ˆé»˜è®¤ï¼‰ æ¯ä¸ªè¯·æ±‚æŒ‰æ—¶é—´é¡ºåºé€ä¸€åˆ†é…åˆ°ä¸åŒçš„åç«¯æœåŠ¡å™¨ï¼Œå¦‚æœåç«¯æœåŠ¡å™¨ä¸èƒ½æ­£å¸¸å“åº”ï¼Œnginx èƒ½è‡ªåŠ¨å‰”é™¤æ•…éšœæœåŠ¡å™¨ã€‚ </p><p>â‘¡ æŒ‰æƒé‡ï¼ˆweightï¼‰ ä½¿ç”¨ weight å‚æ•°ï¼ŒæŒ‡å®šè½®è¯¢å‡ ç‡ï¼Œweight å’Œè®¿é—®æ¯”ç‡æˆæ­£æ¯”ï¼Œç”¨äºåç«¯æœåŠ¡å™¨æ€§èƒ½ä¸å‡çš„æƒ…å†µï¼Œé…ç½®å¦‚ä¸‹ï¼š</p><p><code>upstream backend &#123;   server 192.168.0.14 weight=10;   server 192.168.0.15 weight=10; &#125;</code></p><p>â‘¢ IP å“ˆå¸Œå€¼ï¼ˆip_hashï¼‰ æ¯ä¸ªè¯·æ±‚æŒ‰è®¿é—® IP çš„å“ˆå¸Œå€¼åˆ†é…ï¼Œè¿™æ ·æ¯ä¸ªè®¿å®¢å›ºå®šè®¿é—®ä¸€ä¸ªåç«¯æœåŠ¡å™¨ï¼Œå¯ä»¥è§£å†³ session å…±äº«çš„é—®é¢˜ï¼Œé…ç½®å¦‚ä¸‹ï¼š</p><p><code>upstream backend &#123;   ip_hash;   server 192.168.0.14:88;   server 192.168.0.15:80; &#125;</code></p><p>â‘£ å“åº”æ—¶é—´ï¼ˆfairï¼‰ æŒ‰åç«¯æœåŠ¡å™¨çš„å“åº”æ—¶é—´æ¥åˆ†é…è¯·æ±‚ï¼Œå“åº”æ—¶é—´çŸ­çš„ä¼˜å…ˆåˆ†é…ï¼Œé…ç½®å¦‚ä¸‹ï¼š</p><p><code>upstream backend &#123;   fair;   server server1.com;   server server2.com; &#125;</code></p><p>â‘¤ URL å“ˆå¸Œå€¼ï¼ˆurl_hashï¼‰ æŒ‰è®¿é—® url çš„ hash ç»“æœæ¥åˆ†é…è¯·æ±‚ï¼Œå’Œ IP å“ˆå¸Œå€¼ç±»ä¼¼ã€‚</p><p><code>upstream backend &#123;   hash $request_uri;   server server1.com;   server server2.com;  &#125;</code></p><p>3ï¼‰æ§åˆ¶å±‚ï¼ˆç½‘å…³å±‚ï¼‰</p><p>é™åˆ¶åŒä¸€ä¸ªç”¨æˆ·çš„è®¿é—®é¢‘ç‡ï¼Œé™åˆ¶è®¿é—®æ¬¡æ•°ï¼Œé˜²æ­¢å¤šæ¬¡æ¶æ„è¯·æ±‚ã€‚</p><p>4ï¼‰æœåŠ¡å±‚</p><p>â‘  ä¸šåŠ¡æœåŠ¡å™¨åˆ†ç¦»ï¼šæ¯”å¦‚ï¼Œå°†ç§’æ€ä¸šåŠ¡ç³»ç»Ÿå’Œå…¶ä»–ä¸šåŠ¡åˆ†ç¦»ï¼Œå•ç‹¬æ”¾åœ¨é«˜é…æœåŠ¡å™¨ä¸Šï¼Œå¯ä»¥é›†ä¸­èµ„æºå¯¹è®¿é—®è¯·æ±‚æŠ—å‹ã€‚</p><p>â‘¡ é‡‡ç”¨ MQï¼ˆæ¶ˆæ¯é˜Ÿåˆ—ï¼‰ç¼“å­˜è¯·æ±‚ï¼šMQ å…·æœ‰å‰Šå³°å¡«è°·çš„ä½œç”¨ï¼Œå¯ä»¥æŠŠå®¢æˆ·ç«¯çš„è¯·æ±‚å…ˆå¯¼æµåˆ° MQï¼Œç¨‹åºåœ¨ä» MQ ä¸­è¿›è¡Œæ¶ˆè´¹ï¼ˆæ‰§è¡Œè¯·æ±‚ï¼‰ï¼Œè¿™æ ·å¯ä»¥é¿å…çŸ­æ—¶é—´å†…å¤§é‡è¯·æ±‚ï¼Œå¯¼è‡´æœåŠ¡å™¨ç¨‹åºæ— æ³•å“åº”çš„é—®é¢˜ã€‚ </p><p>â‘¢ åˆ©ç”¨ç¼“å­˜åº”å¯¹è¯»è¯·æ±‚ï¼Œæ¯”å¦‚ï¼Œä½¿ç”¨ Redis ç­‰ç¼“å­˜ï¼Œåˆ©ç”¨ Redis å¯ä»¥åˆ†æ‹…æ•°æ®åº“å¾ˆå¤§ä¸€éƒ¨åˆ†å‹åŠ›ã€‚</p><p>5ï¼‰æ•°æ®åº“å±‚</p><p>â‘  åˆç†ä½¿ç”¨æ•°æ®åº“å¼•æ“ </p><p>â‘¡ åˆç†è®¾ç½®äº‹åŠ¡éš”ç¦»çº§åˆ«ï¼Œåˆç†ä½¿ç”¨äº‹åŠ¡ </p><p>â‘¢ æ­£ç¡®ä½¿ç”¨ SQL è¯­å¥å’ŒæŸ¥è¯¢ç´¢å¼• </p><p>â‘£ åˆç†åˆ†åº“åˆ†è¡¨ </p><p>â‘¤ ä½¿ç”¨æ•°æ®åº“ä¸­é—´ä»¶å®ç°æ•°æ®åº“è¯»å†™åˆ†ç¦» </p><p>â‘¥ è®¾ç½®æ•°æ®åº“ä¸»ä»è¯»å†™åˆ†ç¦»</p>]]></content>
    
    
    <categories>
      
      <category>Datebase</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Datebase</tag>
      
      <tag>MySQL</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€LeetCodeã€‘å›¾ç»“æ„ç›¸å…³</title>
    <link href="/2021/03/12/lt-graph/"/>
    <url>/2021/03/12/lt-graph/</url>
    
    <content type="html"><![CDATA[]]></content>
    
    
    <categories>
      
      <category>Leetcode</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Python</tag>
      
      <tag>Go</tag>
      
      <tag>Java</tag>
      
      <tag>LeetCode</tag>
      
      <tag>scala</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€LeetCodeã€‘æ’åºç®—æ³•</title>
    <link href="/2021/03/10/lt-sort/"/>
    <url>/2021/03/10/lt-sort/</url>
    
    <content type="html"><![CDATA[<h3 id="æ’åºç®—æ³•"><a href="#æ’åºç®—æ³•" class="headerlink" title="æ’åºç®—æ³•"></a><a id="more"></a>æ’åºç®—æ³•</h3><h4 id="å¿«é€Ÿæ’åºï¼ˆQuick-Sortï¼‰åŠä¼˜åŒ–"><a href="#å¿«é€Ÿæ’åºï¼ˆQuick-Sortï¼‰åŠä¼˜åŒ–" class="headerlink" title="å¿«é€Ÿæ’åºï¼ˆQuick-Sortï¼‰åŠä¼˜åŒ–"></a><strong>å¿«é€Ÿæ’åºï¼ˆQuick-Sortï¼‰åŠä¼˜åŒ–</strong></h4><h4 id="å½’å¹¶æ’åºï¼ˆMerge-Sortï¼‰ï¼šä»äºŒè·¯åˆ°å¤šè·¯"><a href="#å½’å¹¶æ’åºï¼ˆMerge-Sortï¼‰ï¼šä»äºŒè·¯åˆ°å¤šè·¯" class="headerlink" title="å½’å¹¶æ’åºï¼ˆMerge-Sortï¼‰ï¼šä»äºŒè·¯åˆ°å¤šè·¯"></a>å½’å¹¶æ’åºï¼ˆMerge-Sortï¼‰ï¼šä»äºŒè·¯åˆ°å¤šè·¯</h4><h4 id="ç®—æ³•ç³»åˆ—ï¼ˆAlgorithæ³•æ‚è°ˆmï¼‰ï¼šæœ‰è¶£çš„æ’åºæ€æƒ³"><a href="#ç®—æ³•ç³»åˆ—ï¼ˆAlgorithæ³•æ‚è°ˆmï¼‰ï¼šæœ‰è¶£çš„æ’åºæ€æƒ³" class="headerlink" title="ç®—æ³•ç³»åˆ—ï¼ˆAlgorithæ³•æ‚è°ˆmï¼‰ï¼šæœ‰è¶£çš„æ’åºæ€æƒ³"></a>ç®—æ³•ç³»åˆ—ï¼ˆAlgorithæ³•æ‚è°ˆmï¼‰ï¼šæœ‰è¶£çš„æ’åºæ€æƒ³</h4>]]></content>
    
    
    <categories>
      
      <category>Leetcode</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Python</tag>
      
      <tag>Go</tag>
      
      <tag>Java</tag>
      
      <tag>LeetCode</tag>
      
      <tag>scala</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€LeetCodeã€‘æ ‘ç»“æ„ç›¸å…³</title>
    <link href="/2021/03/08/lt-tree/"/>
    <url>/2021/03/08/lt-tree/</url>
    
    <content type="html"><![CDATA[<h3 id="æ•°ç»“æ„ç›¸å…³ä¸é€’å½’"><a href="#æ•°ç»“æ„ç›¸å…³ä¸é€’å½’" class="headerlink" title=" æ•°ç»“æ„ç›¸å…³ä¸é€’å½’"></a><a id="more"></a> æ•°ç»“æ„ç›¸å…³ä¸é€’å½’</h3><h4 id="äºŒå‰æ ‘ï¼ˆBinary-Treeï¼‰ä¸ç»å…¸é—®é¢˜"><a href="#äºŒå‰æ ‘ï¼ˆBinary-Treeï¼‰ä¸ç»å…¸é—®é¢˜" class="headerlink" title="äºŒå‰æ ‘ï¼ˆBinary-Treeï¼‰ä¸ç»å…¸é—®é¢˜"></a><strong>äºŒå‰æ ‘ï¼ˆBinary-Treeï¼‰ä¸ç»å…¸é—®é¢˜</strong></h4><h5 id="äºŒå‰æ ‘çš„åŸºæœ¬æ“ä½œ"><a href="#äºŒå‰æ ‘çš„åŸºæœ¬æ“ä½œ" class="headerlink" title="äºŒå‰æ ‘çš„åŸºæœ¬æ“ä½œ"></a>äºŒå‰æ ‘çš„åŸºæœ¬æ“ä½œ</h5><h6 id="144-äºŒå‰æ ‘çš„å‰åºéå†"><a href="#144-äºŒå‰æ ‘çš„å‰åºéå†" class="headerlink" title="144. äºŒå‰æ ‘çš„å‰åºéå†"></a><a href="https://leetcode-cn.com/problems/binary-tree-preorder-traversal/">144. äºŒå‰æ ‘çš„å‰åºéå†</a></h6><p>ç»™ä½ äºŒå‰æ ‘çš„æ ¹èŠ‚ç‚¹ <code>root</code> ï¼Œè¿”å›å®ƒèŠ‚ç‚¹å€¼çš„ <strong>å‰åº</strong> éå†ã€‚</p><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><p><img src="https://assets.leetcode.com/uploads/2020/09/15/inorder_1.jpg"></p><pre><code class="hljs angelscript">è¾“å…¥ï¼šroot = [<span class="hljs-number">1</span>,<span class="hljs-literal">null</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>]è¾“å‡ºï¼š[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>]</code></pre><p><strong>ç¤ºä¾‹ 2ï¼š</strong></p><pre><code class="hljs inform7">è¾“å…¥ï¼šroot = <span class="hljs-comment">[]</span>è¾“å‡ºï¼š<span class="hljs-comment">[]</span></code></pre><p><strong>ç¤ºä¾‹ 3ï¼š</strong></p><pre><code class="hljs angelscript">è¾“å…¥ï¼šroot = [<span class="hljs-number">1</span>]è¾“å‡ºï¼š[<span class="hljs-number">1</span>]</code></pre><p><strong>ç¤ºä¾‹ 4ï¼š</strong></p><p><img src="https://assets.leetcode.com/uploads/2020/09/15/inorder_5.jpg"></p><pre><code class="hljs angelscript">è¾“å…¥ï¼šroot = [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>]è¾“å‡ºï¼š[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>]</code></pre><p><strong>ç¤ºä¾‹ 5ï¼š</strong></p><p><img src="https://assets.leetcode.com/uploads/2020/09/15/inorder_4.jpg"></p><pre><code class="hljs angelscript">è¾“å…¥ï¼šroot = [<span class="hljs-number">1</span>,<span class="hljs-literal">null</span>,<span class="hljs-number">2</span>]è¾“å‡ºï¼š[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>]</code></pre><p><strong>æç¤ºï¼š</strong></p><ul><li>æ ‘ä¸­èŠ‚ç‚¹æ•°ç›®åœ¨èŒƒå›´ <code>[0, 100]</code> å†…</li><li><code>-100 &lt;= Node.val &lt;= 100</code></li></ul><pre><code class="hljs Java"><span class="hljs-keyword">package</span> com.weitrue.leetcode.editor.cn;<span class="hljs-keyword">import</span> java.util.ArrayList;<span class="hljs-keyword">import</span> java.util.List;<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BinaryTreePreorderTraversal</span></span>&#123;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span></span>&#123;        Solution s = <span class="hljs-keyword">new</span> BinaryTreePreorderTraversal().<span class="hljs-function">new <span class="hljs-title">Solution</span><span class="hljs-params">()</span></span>;    &#125;        <span class="hljs-comment">// Given the root of a binary tree, return the preorder traversal of its nodes&#x27; values.</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Example 1:</span>    <span class="hljs-comment">// Input: root = [1,null,2,3]</span>    <span class="hljs-comment">// Output: [1,2,3]</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Example 2:</span>    <span class="hljs-comment">// Input: root = []</span>    <span class="hljs-comment">// Output: []</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Example 3:</span>    <span class="hljs-comment">// Input: root = [1]</span>    <span class="hljs-comment">// Output: [1]</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Example 4:</span>    <span class="hljs-comment">// Input: root = [1,2]</span>    <span class="hljs-comment">// Output: [1,2]</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Example 5:</span>    <span class="hljs-comment">// Input: root = [1,null,2]</span>    <span class="hljs-comment">// Output: [1,2]</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Constraints:</span>    <span class="hljs-comment">// The number of nodes in the tree is in the range [0, 100].</span>    <span class="hljs-comment">// -100 &lt;= Node.val &lt;= 100</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Follow up: Recursive solution is trivial, could you do it iteratively?</span>    <span class="hljs-comment">// Related Topics æ ˆ æ ‘</span>    <span class="hljs-comment">// ğŸ‘ 549 ğŸ‘ 0</span>     <span class="hljs-comment">//leetcode submit region begin(Prohibit modification and deletion)</span>    <span class="hljs-comment">/**</span><span class="hljs-comment">     * Definition for a binary tree node.</span><span class="hljs-comment">     */</span>      <span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TreeNode</span> </span>&#123;          <span class="hljs-keyword">int</span> val;          TreeNode left;          TreeNode right;          TreeNode() &#123;&#125;          TreeNode(<span class="hljs-keyword">int</span> val) &#123; <span class="hljs-keyword">this</span>.val = val; &#125;          TreeNode(<span class="hljs-keyword">int</span> val, TreeNode left, TreeNode right) &#123;              <span class="hljs-keyword">this</span>.val = val;              <span class="hljs-keyword">this</span>.left = left;              <span class="hljs-keyword">this</span>.right = right;          &#125;     &#125;    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span> </span>&#123;          List&lt;Integer&gt; ret = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();          <span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;Integer&gt; <span class="hljs-title">preorderTraversal</span><span class="hljs-params">(TreeNode root)</span> </span>&#123;              preOrder(root);              <span class="hljs-keyword">return</span> ret;          &#125;          <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">preOrder</span><span class="hljs-params">(TreeNode root)</span> </span>&#123;              <span class="hljs-keyword">if</span> (root != <span class="hljs-keyword">null</span>) &#123;                  ret.add(root.val);                  preOrder(root.left);                  preOrder(root.right);              &#125;          &#125;    &#125;<span class="hljs-comment">//leetcode submit region end(Prohibit modification and deletion)</span>&#125;</code></pre><pre><code class="hljs Go"><span class="hljs-comment">/**</span><span class="hljs-comment"> * Definition for a binary tree node.</span><span class="hljs-comment"> * type TreeNode struct &#123;</span><span class="hljs-comment"> *     Val int</span><span class="hljs-comment"> *     Left *TreeNode</span><span class="hljs-comment"> *     Right *TreeNode</span><span class="hljs-comment"> * &#125;</span><span class="hljs-comment"> */</span> <span class="hljs-keyword">var</span> ret []<span class="hljs-keyword">int</span><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">preorderTraversal</span><span class="hljs-params">(root *TreeNode)</span> []<span class="hljs-title">int</span></span> &#123;    ret = <span class="hljs-built_in">make</span>([]<span class="hljs-keyword">int</span>, <span class="hljs-number">0</span>)    preOrder(root)    <span class="hljs-keyword">return</span> ret&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">preOrder</span><span class="hljs-params">(root *TreeNode)</span></span> &#123;    <span class="hljs-keyword">if</span> root == <span class="hljs-literal">nil</span> &#123;        <span class="hljs-keyword">return</span>    &#125;    ret = <span class="hljs-built_in">append</span>(ret, root.Val)    preOrder(root.Left)    preOrder(root.Right)&#125;</code></pre><pre><code class="hljs Python"><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">Module Description: 144-äºŒå‰æ ‘çš„å‰åºéå†</span><span class="hljs-string">Solutionï¼š</span><span class="hljs-string">Author: Wang P</span><span class="hljs-string">Problem:# ç»™ä½ äºŒå‰æ ‘çš„æ ¹èŠ‚ç‚¹ root ï¼Œè¿”å›å®ƒèŠ‚ç‚¹å€¼çš„ å‰åº éå†ã€‚ </span><span class="hljs-string">        #  ç¤ºä¾‹ 1ï¼š</span><span class="hljs-string">        # è¾“å…¥ï¼šroot = [1,null,2,3]</span><span class="hljs-string">        # è¾“å‡ºï¼š[1,2,3]</span><span class="hljs-string">        #  ç¤ºä¾‹ 2ï¼š</span><span class="hljs-string">        # è¾“å…¥ï¼šroot = []</span><span class="hljs-string">        # è¾“å‡ºï¼š[]</span><span class="hljs-string">        #  ç¤ºä¾‹ 3ï¼š</span><span class="hljs-string">        # è¾“å…¥ï¼šroot = [1]</span><span class="hljs-string">        # è¾“å‡ºï¼š[1]</span><span class="hljs-string">        #  ç¤ºä¾‹ 4ï¼š</span><span class="hljs-string">        # è¾“å…¥ï¼šroot = [1,2]</span><span class="hljs-string">        # è¾“å‡ºï¼š[1,2]</span><span class="hljs-string">        #  ç¤ºä¾‹ 5ï¼š</span><span class="hljs-string">        # è¾“å…¥ï¼šroot = [1,null,2]</span><span class="hljs-string">        # è¾“å‡ºï¼š[1,2]</span><span class="hljs-string">        #</span><span class="hljs-string">        #  æç¤ºï¼š</span><span class="hljs-string">        #  æ ‘ä¸­èŠ‚ç‚¹æ•°ç›®åœ¨èŒƒå›´ [0, 100] å†…</span><span class="hljs-string">        #  -100 &lt;= Node.val &lt;= 100</span><span class="hljs-string">        #</span><span class="hljs-string">        #  è¿›é˜¶ï¼šé€’å½’ç®—æ³•å¾ˆç®€å•ï¼Œä½ å¯ä»¥é€šè¿‡è¿­ä»£ç®—æ³•å®Œæˆå—ï¼Ÿ</span><span class="hljs-string">        #  Related Topics æ ˆ æ ‘</span><span class="hljs-string">        #  ğŸ‘ 549 ğŸ‘ 0</span><span class="hljs-string"></span><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-comment"># leetcode submit region begin(Prohibit modification and deletion)</span><span class="hljs-comment"># Definition for a binary tree node.</span><span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> List<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TreeNode</span>:</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, val=<span class="hljs-number">0</span>, left=<span class="hljs-literal">None</span>, right=<span class="hljs-literal">None</span></span>):</span>        self.val = val        self.left = left        self.right = right<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span>:</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self</span>):</span>        self.ret = []    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">preorderTraversal</span>(<span class="hljs-params">self, root: TreeNode</span>) -&gt; List[int]:</span>        self.pre_order(root)        <span class="hljs-keyword">return</span> self.ret    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">pre_order</span>(<span class="hljs-params">self, root: TreeNode</span>):</span>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> root:            <span class="hljs-keyword">return</span>        self.ret.append(root.val)        self.pre_order(root.left)        self.pre_order(root.right)</code></pre><h6 id="589-N-å‰æ ‘çš„å‰åºéå†"><a href="#589-N-å‰æ ‘çš„å‰åºéå†" class="headerlink" title="589. N å‰æ ‘çš„å‰åºéå†"></a><a href="https://leetcode-cn.com/problems/n-ary-tree-preorder-traversal/">589. N å‰æ ‘çš„å‰åºéå†</a></h6><p>ç»™å®šä¸€ä¸ª N å‰æ ‘ï¼Œè¿”å›å…¶èŠ‚ç‚¹å€¼çš„ <strong>å‰åºéå†</strong> ã€‚</p><p>N å‰æ ‘ åœ¨è¾“å…¥ä¸­æŒ‰å±‚åºéå†è¿›è¡Œåºåˆ—åŒ–è¡¨ç¤ºï¼Œæ¯ç»„å­èŠ‚ç‚¹ç”±ç©ºå€¼ <code>null</code> åˆ†éš”ï¼ˆè¯·å‚è§ç¤ºä¾‹ï¼‰ã€‚</p><p><strong>è¿›é˜¶ï¼š</strong></p><p>é€’å½’æ³•å¾ˆç®€å•ï¼Œä½ å¯ä»¥ä½¿ç”¨è¿­ä»£æ³•å®Œæˆæ­¤é¢˜å—?</p><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><p><img src="https://assets.leetcode.com/uploads/2018/10/12/narytreeexample.png"></p><pre><code class="hljs shell">è¾“å…¥ï¼šroot = [1,null,3,2,4,null,5,6]è¾“å‡ºï¼š[1,3,5,6,2,4]</code></pre><p><strong>ç¤ºä¾‹ 2ï¼š</strong></p><p><img src="https://assets.leetcode.com/uploads/2019/11/08/sample_4_964.png"></p><pre><code class="hljs angelscript">è¾“å…¥ï¼šroot = [<span class="hljs-number">1</span>,<span class="hljs-literal">null</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-literal">null</span>,<span class="hljs-literal">null</span>,<span class="hljs-number">6</span>,<span class="hljs-number">7</span>,<span class="hljs-literal">null</span>,<span class="hljs-number">8</span>,<span class="hljs-literal">null</span>,<span class="hljs-number">9</span>,<span class="hljs-number">10</span>,<span class="hljs-literal">null</span>,<span class="hljs-literal">null</span>,<span class="hljs-number">11</span>,<span class="hljs-literal">null</span>,<span class="hljs-number">12</span>,<span class="hljs-literal">null</span>,<span class="hljs-number">13</span>,<span class="hljs-literal">null</span>,<span class="hljs-literal">null</span>,<span class="hljs-number">14</span>]è¾“å‡ºï¼š[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">6</span>,<span class="hljs-number">7</span>,<span class="hljs-number">11</span>,<span class="hljs-number">14</span>,<span class="hljs-number">4</span>,<span class="hljs-number">8</span>,<span class="hljs-number">12</span>,<span class="hljs-number">5</span>,<span class="hljs-number">9</span>,<span class="hljs-number">13</span>,<span class="hljs-number">10</span>]</code></pre><p><strong>æç¤ºï¼š</strong></p><ul><li>N å‰æ ‘çš„é«˜åº¦å°äºæˆ–ç­‰äº <code>1000</code></li><li>èŠ‚ç‚¹æ€»æ•°åœ¨èŒƒå›´ <code>[0, 10^4]</code> å†…</li></ul><pre><code class="hljs Java"><span class="hljs-keyword">package</span> com.weitrue.leetcode.editor.cn;<span class="hljs-keyword">import</span> java.util.ArrayList;<span class="hljs-keyword">import</span> java.util.List;<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">NAryTreePreorderTraversal</span></span>&#123;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span></span>&#123;        Solution s = <span class="hljs-keyword">new</span> NAryTreePreorderTraversal().<span class="hljs-function">new <span class="hljs-title">Solution</span><span class="hljs-params">()</span></span>;    &#125;        <span class="hljs-comment">// Given the root of an n-ary tree, return the preorder traversal of its nodes&#x27; values.</span>    <span class="hljs-comment">// Nary-Tree input serialization is represented in their level order traversal.</span>    <span class="hljs-comment">//Each group of children is separated by the null value (See examples)</span>    <span class="hljs-comment">// Example 1:</span>    <span class="hljs-comment">//Input: root = [1,null,3,2,4,null,5,6]</span>    <span class="hljs-comment">//Output: [1,3,5,6,2,4]</span>    <span class="hljs-comment">// Example 2:</span>    <span class="hljs-comment">//Input: root = [1,null,2,3,4,5,null,null,6,7,null,8,null,9,10,null,null,11,null</span>    <span class="hljs-comment">//,12,null,13,null,null,14]</span>    <span class="hljs-comment">//Output: [1,2,3,6,7,11,14,4,8,12,5,9,13,10]</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Constraints:</span>    <span class="hljs-comment">// The number of nodes in the tree is in the range [0, 104].</span>    <span class="hljs-comment">// 0 &lt;= Node.val &lt;= 104</span>    <span class="hljs-comment">// The height of the n-ary tree is less than or equal to 1000.</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Follow up: Recursive solution is trivial, could you do it iteratively?</span>    <span class="hljs-comment">// Related Topics æ ‘</span>    <span class="hljs-comment">// ğŸ‘ 152 ğŸ‘ 0</span>     <span class="hljs-comment">//leetcode submit region begin(Prohibit modification and deletion)</span>    <span class="hljs-comment">// Definition for a Node.</span>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Node</span> </span>&#123;        <span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> val;        <span class="hljs-keyword">public</span> List&lt;Node&gt; children;        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Node</span><span class="hljs-params">()</span> </span>&#123;&#125;        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Node</span><span class="hljs-params">(<span class="hljs-keyword">int</span> _val)</span> </span>&#123;            val = _val;        &#125;        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Node</span><span class="hljs-params">(<span class="hljs-keyword">int</span> _val, List&lt;Node&gt; _children)</span> </span>&#123;            val = _val;            children = _children;        &#125;    &#125;    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span> </span>&#123;        List&lt;Integer&gt; ret = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();        <span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;Integer&gt; <span class="hljs-title">preorder</span><span class="hljs-params">(Node root)</span> </span>&#123;            preOrder(root);            <span class="hljs-keyword">return</span> ret;        &#125;        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">preOrder</span><span class="hljs-params">(Node root)</span> </span>&#123;            <span class="hljs-keyword">if</span> (root != <span class="hljs-keyword">null</span>) &#123;                ret.add(root.val);                <span class="hljs-keyword">for</span> (Node n: root.children) &#123;                    preOrder(n);                &#125;            &#125;        &#125;    &#125;    <span class="hljs-comment">//leetcode submit region end(Prohibit modification and deletion)</span>&#125;</code></pre><pre><code class="hljs Go"><span class="hljs-comment">/**</span><span class="hljs-comment"> * Definition for a Node.</span><span class="hljs-comment"> * type Node struct &#123;</span><span class="hljs-comment"> *     Val int</span><span class="hljs-comment"> *     Children []*Node</span><span class="hljs-comment"> * &#125;</span><span class="hljs-comment"> */</span><span class="hljs-keyword">var</span> ret []<span class="hljs-keyword">int</span><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">preorder</span><span class="hljs-params">(root *Node)</span> []<span class="hljs-title">int</span></span> &#123;    ret = <span class="hljs-built_in">make</span>([]<span class="hljs-keyword">int</span>, <span class="hljs-number">0</span>)    preOrder(root)    <span class="hljs-keyword">return</span> ret&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">preOrder</span><span class="hljs-params">(root *Node)</span></span> &#123;    <span class="hljs-keyword">if</span> root == <span class="hljs-literal">nil</span> &#123;        <span class="hljs-keyword">return</span>    &#125;    ret = <span class="hljs-built_in">append</span>(ret, root.Val)    <span class="hljs-keyword">for</span> _, c := <span class="hljs-keyword">range</span> root.Children &#123;        preOrder(c)    &#125;&#125;</code></pre><pre><code class="hljs Python"><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">Module Description: 589-N å‰æ ‘çš„å‰åºéå†</span><span class="hljs-string">Solutionï¼š</span><span class="hljs-string">Author: Wang P</span><span class="hljs-string">Problem:# ç»™å®šä¸€ä¸ª N å‰æ ‘ï¼Œè¿”å›å…¶èŠ‚ç‚¹å€¼çš„ å‰åºéå† ã€‚ </span><span class="hljs-string">        #  N å‰æ ‘ åœ¨è¾“å…¥ä¸­æŒ‰å±‚åºéå†è¿›è¡Œåºåˆ—åŒ–è¡¨ç¤ºï¼Œæ¯ç»„å­èŠ‚ç‚¹ç”±ç©ºå€¼ null åˆ†éš”ï¼ˆè¯·å‚è§ç¤ºä¾‹ï¼‰ã€‚</span><span class="hljs-string">        #  è¿›é˜¶ï¼š</span><span class="hljs-string">        #  é€’å½’æ³•å¾ˆç®€å•ï¼Œä½ å¯ä»¥ä½¿ç”¨è¿­ä»£æ³•å®Œæˆæ­¤é¢˜å—?</span><span class="hljs-string">        #  ç¤ºä¾‹ 1ï¼š</span><span class="hljs-string">        # è¾“å…¥ï¼šroot = [1,null,3,2,4,null,5,6]</span><span class="hljs-string">        # è¾“å‡ºï¼š[1,3,5,6,2,4]</span><span class="hljs-string">        # ç¤ºä¾‹ 2ï¼š</span><span class="hljs-string">        # è¾“å…¥ï¼šroot = [1,null,2,3,4,5,null,null,6,7,null,8,null,9,10,null,null,11,null,12,</span><span class="hljs-string">        # null,13,null,null,14]</span><span class="hljs-string">        # è¾“å‡ºï¼š[1,2,3,6,7,11,14,4,8,12,5,9,13,10]</span><span class="hljs-string">        #  æç¤ºï¼š</span><span class="hljs-string">        #  N å‰æ ‘çš„é«˜åº¦å°äºæˆ–ç­‰äº 1000</span><span class="hljs-string">        #  èŠ‚ç‚¹æ€»æ•°åœ¨èŒƒå›´ [0, 10^4] å†…</span><span class="hljs-string">        #  Related Topics æ ‘</span><span class="hljs-string">        #  ğŸ‘ 152 ğŸ‘ 0</span><span class="hljs-string"></span><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-comment"># leetcode submit region begin(Prohibit modification and deletion)</span><span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> List<span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string"># Definition for a Node.</span><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Node</span>:</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, val=<span class="hljs-literal">None</span>, children=<span class="hljs-literal">None</span></span>):</span>        self.val = val        self.children = children<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span>:</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self</span>):</span>        self.ret = []    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">preorder</span>(<span class="hljs-params">self, root: <span class="hljs-string">&#x27;Node&#x27;</span></span>) -&gt; List[int]:</span>        self.pre_order(root)        <span class="hljs-keyword">return</span> self.ret    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">pre_order</span>(<span class="hljs-params">self, root: <span class="hljs-string">&#x27;Node&#x27;</span></span>):</span>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> root:            <span class="hljs-keyword">return</span>        self.ret.append(root.val)        <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> root.children:            self.pre_order(c)        <span class="hljs-comment"># leetcode submit region end(Prohibit modification and deletion)</span></code></pre><h6 id="226-ç¿»è½¬äºŒå‰æ ‘"><a href="#226-ç¿»è½¬äºŒå‰æ ‘" class="headerlink" title="226. ç¿»è½¬äºŒå‰æ ‘"></a><a href="https://leetcode-cn.com/problems/invert-binary-tree/">226. ç¿»è½¬äºŒå‰æ ‘</a></h6><p>ç¿»è½¬ä¸€æ£µäºŒå‰æ ‘ã€‚</p><p><strong>ç¤ºä¾‹ï¼š</strong></p><p>è¾“å…¥ï¼š</p><pre><code class="hljs angelscript">     <span class="hljs-number">4</span>   /   \  <span class="hljs-number">2</span>     <span class="hljs-number">7</span> / \   / \<span class="hljs-number">1</span>   <span class="hljs-number">3</span> <span class="hljs-number">6</span>   <span class="hljs-number">9</span></code></pre><p>è¾“å‡ºï¼š</p><pre><code class="hljs angelscript">     <span class="hljs-number">4</span>   /   \  <span class="hljs-number">7</span>     <span class="hljs-number">2</span> / \   / \<span class="hljs-number">9</span>   <span class="hljs-number">6</span> <span class="hljs-number">3</span>   <span class="hljs-number">1</span></code></pre><p><strong>å¤‡æ³¨:</strong><br>è¿™ä¸ªé—®é¢˜æ˜¯å—åˆ° <a href="https://twitter.com/mxcl">Max Howell </a>çš„ <a href="https://twitter.com/mxcl/status/608682016205344768">åŸé—®é¢˜</a> å¯å‘çš„ ï¼š</p><blockquote><p>è°·æ­Œï¼šæˆ‘ä»¬90ï¼…çš„å·¥ç¨‹å¸ˆä½¿ç”¨æ‚¨ç¼–å†™çš„è½¯ä»¶(Homebrew)ï¼Œä½†æ˜¯æ‚¨å´æ— æ³•åœ¨é¢è¯•æ—¶åœ¨ç™½æ¿ä¸Šå†™å‡ºç¿»è½¬äºŒå‰æ ‘è¿™é“é¢˜ï¼Œè¿™å¤ªç³Ÿç³•äº†ã€‚</p></blockquote><pre><code class="hljs Java"><span class="hljs-keyword">package</span> com.weitrue.leetcode.editor.cn;<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">InvertBinaryTree</span></span>&#123;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span></span>&#123;        Solution s = <span class="hljs-keyword">new</span> InvertBinaryTree().<span class="hljs-function">new <span class="hljs-title">Solution</span><span class="hljs-params">()</span></span>;    &#125;        <span class="hljs-comment">// Given the root of a binary tree, invert the tree, and return its root.</span>    <span class="hljs-comment">// Example 1:</span>    <span class="hljs-comment">//Input: root = [4,2,7,1,3,6,9]</span>    <span class="hljs-comment">//Output: [4,7,2,9,6,3,1]</span>    <span class="hljs-comment">// Example 2:</span>    <span class="hljs-comment">//Input: root = [2,1,3]</span>    <span class="hljs-comment">//Output: [2,3,1]</span>    <span class="hljs-comment">// Example 3:</span>    <span class="hljs-comment">//Input: root = []</span>    <span class="hljs-comment">//Output: []</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Constraints:</span>    <span class="hljs-comment">// The number of nodes in the tree is in the range [0, 100].</span>    <span class="hljs-comment">// -100 &lt;= Node.val &lt;= 100</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Related Topics æ ‘</span>    <span class="hljs-comment">// ğŸ‘ 807 ğŸ‘ 0</span>     <span class="hljs-comment">//leetcode submit region begin(Prohibit modification and deletion)</span><span class="hljs-comment">/**</span><span class="hljs-comment"> * Definition for a binary tree node.</span><span class="hljs-comment"> */</span>    <span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TreeNode</span> </span>&#123;         <span class="hljs-keyword">int</span> val;         TreeNode left;         TreeNode right;         TreeNode() &#123;&#125;         TreeNode(<span class="hljs-keyword">int</span> val) &#123; <span class="hljs-keyword">this</span>.val = val; &#125;         TreeNode(<span class="hljs-keyword">int</span> val, TreeNode left, TreeNode right) &#123;             <span class="hljs-keyword">this</span>.val = val;             <span class="hljs-keyword">this</span>.left = left;             <span class="hljs-keyword">this</span>.right = right;         &#125;     &#125;    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span> </span>&#123;        <span class="hljs-function"><span class="hljs-keyword">public</span> TreeNode <span class="hljs-title">invertTree</span><span class="hljs-params">(TreeNode root)</span> </span>&#123;            <span class="hljs-keyword">if</span> (root == <span class="hljs-keyword">null</span>) &#123;                <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;            &#125;            invertTree(root.left);            invertTree(root.right);            TreeNode temp = root.left;            root.left = root.right;            root.right = temp;            <span class="hljs-keyword">return</span> root;        &#125;    &#125;<span class="hljs-comment">//leetcode submit region end(Prohibit modification and deletion)</span>&#125;</code></pre><pre><code class="hljs Go"><span class="hljs-comment">/**</span><span class="hljs-comment"> * Definition for a binary tree node.</span><span class="hljs-comment"> * type TreeNode struct &#123;</span><span class="hljs-comment"> *     Val int</span><span class="hljs-comment"> *     Left *TreeNode</span><span class="hljs-comment"> *     Right *TreeNode</span><span class="hljs-comment"> * &#125;</span><span class="hljs-comment"> */</span><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">invertTree</span><span class="hljs-params">(root *TreeNode)</span> *<span class="hljs-title">TreeNode</span></span> &#123;    <span class="hljs-keyword">if</span> root == <span class="hljs-literal">nil</span> &#123;        <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>    &#125;    invertTree(root.Left)    invertTree(root.Right)    root.Left, root.Right = root.Right, root.Left     <span class="hljs-keyword">return</span> root&#125;</code></pre><pre><code class="hljs Python"><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">Module Description: 226-ç¿»è½¬äºŒå‰æ ‘</span><span class="hljs-string">Solutionï¼š</span><span class="hljs-string">Author: Wang P</span><span class="hljs-string">Problem:# ç¿»è½¬ä¸€æ£µäºŒå‰æ ‘ã€‚ </span><span class="hljs-string">        #  ç¤ºä¾‹ï¼š</span><span class="hljs-string">        #  è¾“å…¥ï¼š</span><span class="hljs-string">        #       4</span><span class="hljs-string">        #    /   \</span><span class="hljs-string">        #   2     7</span><span class="hljs-string">        #  / \   / \</span><span class="hljs-string">        # 1   3 6   9</span><span class="hljs-string">        #  è¾“å‡ºï¼š</span><span class="hljs-string">        #       4</span><span class="hljs-string">        #    /   \</span><span class="hljs-string">        #   7     2</span><span class="hljs-string">        #  / \   / \</span><span class="hljs-string">        # 9   6 3   1</span><span class="hljs-string">        #  å¤‡æ³¨:</span><span class="hljs-string">        # è¿™ä¸ªé—®é¢˜æ˜¯å—åˆ° Max Howell çš„ åŸé—®é¢˜ å¯å‘çš„ ï¼š</span><span class="hljs-string">        #</span><span class="hljs-string">        #  è°·æ­Œï¼šæˆ‘ä»¬90ï¼…çš„å·¥ç¨‹å¸ˆä½¿ç”¨æ‚¨ç¼–å†™çš„è½¯ä»¶(Homebrew)ï¼Œä½†æ˜¯æ‚¨å´æ— æ³•åœ¨é¢è¯•æ—¶åœ¨ç™½æ¿ä¸Šå†™å‡ºç¿»è½¬äºŒå‰æ ‘è¿™é“é¢˜ï¼Œè¿™å¤ªç³Ÿç³•äº†ã€‚</span><span class="hljs-string">        #  Related Topics æ ‘</span><span class="hljs-string">        #  ğŸ‘ 807 ğŸ‘ 0</span><span class="hljs-string"></span><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-comment"># leetcode submit region begin(Prohibit modification and deletion)</span><span class="hljs-comment"># Definition for a binary tree node.</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TreeNode</span>:</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, val=<span class="hljs-number">0</span>, left=<span class="hljs-literal">None</span>, right=<span class="hljs-literal">None</span></span>):</span>        self.val = val        self.left = left        self.right = right<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span>:</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">invertTree</span>(<span class="hljs-params">self, root: TreeNode</span>) -&gt; TreeNode:</span>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> root:            <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span>        self.invertTree(root.left)        self.invertTree(root.right)        root.left, root.right = root.right, root.left        <span class="hljs-keyword">return</span> root<span class="hljs-comment"># leetcode submit region end(Prohibit modification and deletion)</span></code></pre><h6 id="å‰‘æŒ‡-Offer-32-II-ä»ä¸Šåˆ°ä¸‹æ‰“å°äºŒå‰æ ‘-II"><a href="#å‰‘æŒ‡-Offer-32-II-ä»ä¸Šåˆ°ä¸‹æ‰“å°äºŒå‰æ ‘-II" class="headerlink" title="å‰‘æŒ‡ Offer 32 - II. ä»ä¸Šåˆ°ä¸‹æ‰“å°äºŒå‰æ ‘ II"></a><a href="https://leetcode-cn.com/problems/cong-shang-dao-xia-da-yin-er-cha-shu-ii-lcof/">å‰‘æŒ‡ Offer 32 - II. ä»ä¸Šåˆ°ä¸‹æ‰“å°äºŒå‰æ ‘ II</a></h6><p>ä»ä¸Šåˆ°ä¸‹æŒ‰å±‚æ‰“å°äºŒå‰æ ‘ï¼ŒåŒä¸€å±‚çš„èŠ‚ç‚¹æŒ‰ä»å·¦åˆ°å³çš„é¡ºåºæ‰“å°ï¼Œæ¯ä¸€å±‚æ‰“å°åˆ°ä¸€è¡Œã€‚</p><p>ä¾‹å¦‚:<br>ç»™å®šäºŒå‰æ ‘: <code>[3,9,20,null,null,15,7]</code>,</p><pre><code class="hljs angelscript">  <span class="hljs-number">3</span> / \<span class="hljs-number">9</span>  <span class="hljs-number">20</span>  /  \ <span class="hljs-number">15</span>   <span class="hljs-number">7</span></code></pre><p>è¿”å›å…¶å±‚æ¬¡éå†ç»“æœï¼š</p><pre><code class="hljs json">[  [<span class="hljs-number">3</span>],  [<span class="hljs-number">9</span>,<span class="hljs-number">20</span>],  [<span class="hljs-number">15</span>,<span class="hljs-number">7</span>]]</code></pre><p><strong>æç¤ºï¼š</strong></p><ol><li><code>èŠ‚ç‚¹æ€»æ•° &lt;= 1000</code></li></ol><pre><code class="hljs Java"><span class="hljs-keyword">package</span> com.weitrue.leetcode.editor.cn;<span class="hljs-keyword">import</span> java.util.ArrayList;<span class="hljs-keyword">import</span> java.util.List;<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CongShangDaoXiaDaYinErChaShuIiLcof</span></span>&#123;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span></span>&#123;        Solution s = <span class="hljs-keyword">new</span> CongShangDaoXiaDaYinErChaShuIiLcof().<span class="hljs-function">new <span class="hljs-title">Solution</span><span class="hljs-params">()</span></span>;    &#125;        <span class="hljs-comment">//English description is not available for the problem. Please switch to Chinese</span>    <span class="hljs-comment">//. Related Topics æ ‘ å¹¿åº¦ä¼˜å…ˆæœç´¢</span>    <span class="hljs-comment">// ğŸ‘ 95 ğŸ‘ 0</span>     <span class="hljs-comment">//leetcode submit region begin(Prohibit modification and deletion)</span>    <span class="hljs-comment">/**</span><span class="hljs-comment">     * Definition for a binary tree node.</span><span class="hljs-comment">     */</span>    <span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TreeNode</span> </span>&#123;         <span class="hljs-keyword">int</span> val;         TreeNode left;         TreeNode right;         TreeNode(<span class="hljs-keyword">int</span> x) &#123; val = x; &#125;    &#125;    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span> </span>&#123;        List&lt;List&lt;Integer&gt;&gt; liiRet = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();        <span class="hljs-keyword">public</span> List&lt;List&lt;Integer&gt;&gt; levelOrder(TreeNode root) &#123;            signKLevel(root, <span class="hljs-number">0</span>);            <span class="hljs-keyword">return</span> liiRet;        &#125;        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">signKLevel</span><span class="hljs-params">(TreeNode root, <span class="hljs-keyword">int</span> k)</span> </span>&#123;            <span class="hljs-keyword">if</span> (root != <span class="hljs-keyword">null</span>) &#123;                <span class="hljs-keyword">if</span> (liiRet.size() == k) &#123;                    liiRet.add(<span class="hljs-keyword">new</span> ArrayList&lt;&gt;());                &#125;                liiRet.get(k).add(root.val);                signKLevel(root.left, k+<span class="hljs-number">1</span>);                signKLevel(root.right, k+<span class="hljs-number">1</span>);            &#125;        &#125;    &#125;    <span class="hljs-comment">//leetcode submit region end(Prohibit modification and deletion)</span>&#125;</code></pre><pre><code class="hljs Go"><span class="hljs-comment">/**</span><span class="hljs-comment"> * Definition for a binary tree node.</span><span class="hljs-comment"> * type TreeNode struct &#123;</span><span class="hljs-comment"> *     Val int</span><span class="hljs-comment"> *     Left *TreeNode</span><span class="hljs-comment"> *     Right *TreeNode</span><span class="hljs-comment"> * &#125;</span><span class="hljs-comment"> */</span><span class="hljs-keyword">var</span> ret [][]<span class="hljs-keyword">int</span><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">levelOrder</span><span class="hljs-params">(root *TreeNode)</span> [][]<span class="hljs-title">int</span></span> &#123;    <span class="hljs-comment">// write code here</span>    ret = <span class="hljs-built_in">make</span>([][]<span class="hljs-keyword">int</span>, <span class="hljs-number">0</span>)    <span class="hljs-keyword">if</span> root == <span class="hljs-literal">nil</span> &#123;        <span class="hljs-keyword">return</span> ret    &#125;    ret = <span class="hljs-built_in">append</span>(ret, []<span class="hljs-keyword">int</span>&#123;&#125;)    travelTree(root, <span class="hljs-number">0</span>)    <span class="hljs-keyword">return</span> ret&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">travelTree</span><span class="hljs-params">(root *TreeNode, k <span class="hljs-keyword">int</span>)</span></span> &#123;    <span class="hljs-keyword">if</span> root == <span class="hljs-literal">nil</span> &#123;        <span class="hljs-keyword">return</span>     &#125;    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(ret) == k &#123;        ret = <span class="hljs-built_in">append</span>(ret, []<span class="hljs-keyword">int</span>&#123;&#125;)    &#125;    ret[k] = <span class="hljs-built_in">append</span>(ret[k], root.Val)    travelTree(root.Left, k+<span class="hljs-number">1</span>)    travelTree(root.Right, k+<span class="hljs-number">1</span>)&#125;</code></pre><pre><code class="hljs Python"><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">Module Description: å‰‘æŒ‡ Offer 32 - II-ä»ä¸Šåˆ°ä¸‹æ‰“å°äºŒå‰æ ‘ II</span><span class="hljs-string">Solutionï¼š</span><span class="hljs-string">Date: 2021-04-03 12:10:11</span><span class="hljs-string">Author: Wang P</span><span class="hljs-string">Problem:# ä»ä¸Šåˆ°ä¸‹æŒ‰å±‚æ‰“å°äºŒå‰æ ‘ï¼ŒåŒä¸€å±‚çš„èŠ‚ç‚¹æŒ‰ä»å·¦åˆ°å³çš„é¡ºåºæ‰“å°ï¼Œæ¯ä¸€å±‚æ‰“å°åˆ°ä¸€è¡Œã€‚ </span><span class="hljs-string">        #  ä¾‹å¦‚:</span><span class="hljs-string">        # ç»™å®šäºŒå‰æ ‘: [3,9,20,null,null,15,7],</span><span class="hljs-string">        #      3</span><span class="hljs-string">        #    / \</span><span class="hljs-string">        #   9  20</span><span class="hljs-string">        #     /  \</span><span class="hljs-string">        #    15   7</span><span class="hljs-string">        #  è¿”å›å…¶å±‚æ¬¡éå†ç»“æœï¼š</span><span class="hljs-string">        #  [</span><span class="hljs-string">        #   [3],</span><span class="hljs-string">        #   [9,20],</span><span class="hljs-string">        #   [15,7]</span><span class="hljs-string">        # ]</span><span class="hljs-string">        #  æç¤ºï¼š</span><span class="hljs-string">        #  èŠ‚ç‚¹æ€»æ•° &lt;= 1000</span><span class="hljs-string">        #  æ³¨æ„ï¼šæœ¬é¢˜ä¸ä¸»ç«™ 102 é¢˜ç›¸åŒï¼šhttps://leetcode-cn.com/problems/binary-tree-level-order-traversal/</span><span class="hljs-string">        #  Related Topics æ ‘ å¹¿åº¦ä¼˜å…ˆæœç´¢</span><span class="hljs-string">        #  ğŸ‘ 95 ğŸ‘ 0</span><span class="hljs-string"></span><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-comment"># leetcode submit region begin(Prohibit modification and deletion)</span><span class="hljs-comment"># Definition for a binary tree node.</span><span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> List<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TreeNode</span>:</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, x</span>):</span>        self.val = x        self.left = <span class="hljs-literal">None</span>        self.right = <span class="hljs-literal">None</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span>:</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self</span>):</span>        self.lii_ret = []    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">levelOrder</span>(<span class="hljs-params">self, root: TreeNode</span>) -&gt; List[List[int]]:</span>        self.sign_k_level(root, <span class="hljs-number">0</span>)        <span class="hljs-keyword">return</span> self.lii_ret    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">sign_k_level</span>(<span class="hljs-params">self, root: TreeNode, k: <span class="hljs-built_in">int</span></span>):</span>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> root:            <span class="hljs-keyword">return</span>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(self.lii_ret) == k:            self.lii_ret.append([])        self.lii_ret[k].append(root.val)        self.sign_k_level(root.left, k+<span class="hljs-number">1</span>)        self.sign_k_level(root.right, k+<span class="hljs-number">1</span>)<span class="hljs-comment"># leetcode submit region end(Prohibit modification and deletion)</span></code></pre><h6 id="107-äºŒå‰æ ‘çš„å±‚åºéå†-II"><a href="#107-äºŒå‰æ ‘çš„å±‚åºéå†-II" class="headerlink" title="107. äºŒå‰æ ‘çš„å±‚åºéå† II"></a><a href="https://leetcode-cn.com/problems/binary-tree-level-order-traversal-ii/">107. äºŒå‰æ ‘çš„å±‚åºéå† II</a></h6><p>ç»™å®šä¸€ä¸ªäºŒå‰æ ‘ï¼Œè¿”å›å…¶èŠ‚ç‚¹å€¼è‡ªåº•å‘ä¸Šçš„å±‚åºéå†ã€‚ ï¼ˆå³æŒ‰ä»å¶å­èŠ‚ç‚¹æ‰€åœ¨å±‚åˆ°æ ¹èŠ‚ç‚¹æ‰€åœ¨çš„å±‚ï¼Œé€å±‚ä»å·¦å‘å³éå†ï¼‰</p><p>ä¾‹å¦‚ï¼š<br>ç»™å®šäºŒå‰æ ‘ <code>[3,9,20,null,null,15,7]</code>,</p><pre><code class="hljs angelscript">  <span class="hljs-number">3</span> / \<span class="hljs-number">9</span>  <span class="hljs-number">20</span>  /  \ <span class="hljs-number">15</span>   <span class="hljs-number">7</span></code></pre><p>è¿”å›å…¶è‡ªåº•å‘ä¸Šçš„å±‚åºéå†ä¸ºï¼š</p><pre><code class="hljs json">[  [<span class="hljs-number">15</span>,<span class="hljs-number">7</span>],  [<span class="hljs-number">9</span>,<span class="hljs-number">20</span>],  [<span class="hljs-number">3</span>]]</code></pre><pre><code class="hljs Java"><span class="hljs-keyword">package</span> com.weitrue.leetcode.editor.cn;<span class="hljs-keyword">import</span> java.util.ArrayList;<span class="hljs-keyword">import</span> java.util.List;<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BinaryTreeLevelOrderTraversalIi</span></span>&#123;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span></span>&#123;        Solution s = <span class="hljs-keyword">new</span> BinaryTreeLevelOrderTraversalIi().<span class="hljs-function">new <span class="hljs-title">Solution</span><span class="hljs-params">()</span></span>;    &#125;        <span class="hljs-comment">//Given the root of a binary tree, return the bottom-up level order traversal of its nodes&#x27; values. (i.e., from left to right, level by level from leaf to root).</span>    <span class="hljs-comment">// Example 1:</span>    <span class="hljs-comment">//Input: root = [3,9,20,null,null,15,7]</span>    <span class="hljs-comment">//Output: [[15,7],[9,20],[3]]</span>    <span class="hljs-comment">// Example 2:</span>    <span class="hljs-comment">//Input: root = [1]</span>    <span class="hljs-comment">//Output: [[1]]</span>    <span class="hljs-comment">// Example 3:</span>    <span class="hljs-comment">//Input: root = []</span>    <span class="hljs-comment">//Output: []</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Constraints:</span>    <span class="hljs-comment">// The number of nodes in the tree is in the range [0, 2000].</span>    <span class="hljs-comment">// -1000 &lt;= Node.val &lt;= 1000</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Related Topics æ ‘ å¹¿åº¦ä¼˜å…ˆæœç´¢</span>    <span class="hljs-comment">// ğŸ‘ 423 ğŸ‘ 0</span>     <span class="hljs-comment">//leetcode submit region begin(Prohibit modification and deletion)</span>    <span class="hljs-comment">/**</span><span class="hljs-comment">     * Definition for a binary tree node.</span><span class="hljs-comment">     */</span>    <span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TreeNode</span> </span>&#123;        <span class="hljs-keyword">int</span> val;        TreeNode left;        TreeNode right;        TreeNode() &#123;&#125;        TreeNode(<span class="hljs-keyword">int</span> val) &#123; <span class="hljs-keyword">this</span>.val = val; &#125;        TreeNode(<span class="hljs-keyword">int</span> val, TreeNode left, TreeNode right) &#123;            <span class="hljs-keyword">this</span>.val = val;            <span class="hljs-keyword">this</span>.left = left;            <span class="hljs-keyword">this</span>.right = right;        &#125;    &#125;    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span> </span>&#123;        List&lt;List&lt;Integer&gt;&gt; liiRet = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();        <span class="hljs-keyword">public</span> List&lt;List&lt;Integer&gt;&gt; levelOrderBottom(TreeNode root) &#123;            signKLevel(root, <span class="hljs-number">0</span>);            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>, j=liiRet.size()-<span class="hljs-number">1</span>; i &lt; j; i++, j--) &#123;                List&lt;Integer&gt; tmp = liiRet.get(i);                liiRet.set(i, liiRet.get(j));                liiRet.set(j, tmp);            &#125;            <span class="hljs-keyword">return</span> liiRet;        &#125;        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">signKLevel</span><span class="hljs-params">(TreeNode root, <span class="hljs-keyword">int</span> k)</span> </span>&#123;            <span class="hljs-keyword">if</span> (root != <span class="hljs-keyword">null</span>) &#123;                <span class="hljs-keyword">if</span> (liiRet.size() == k) &#123;                    liiRet.add(<span class="hljs-keyword">new</span> ArrayList&lt;&gt;());                &#125;                liiRet.get(k).add(root.val);                signKLevel(root.left, k+<span class="hljs-number">1</span>);                signKLevel(root.right, k+<span class="hljs-number">1</span>);            &#125;        &#125;    &#125;    <span class="hljs-comment">//leetcode submit region end(Prohibit modification and deletion)</span>&#125;</code></pre><pre><code class="hljs Go"><span class="hljs-comment">/**</span><span class="hljs-comment"> * Definition for a binary tree node.</span><span class="hljs-comment"> * type TreeNode struct &#123;</span><span class="hljs-comment"> *     Val int</span><span class="hljs-comment"> *     Left *TreeNode</span><span class="hljs-comment"> *     Right *TreeNode</span><span class="hljs-comment"> * &#125;</span><span class="hljs-comment"> */</span> <span class="hljs-keyword">var</span> ret [][]<span class="hljs-keyword">int</span><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">levelOrderBottom</span><span class="hljs-params">(root *TreeNode)</span> [][]<span class="hljs-title">int</span></span> &#123;    ret = <span class="hljs-built_in">make</span>([][]<span class="hljs-keyword">int</span>, <span class="hljs-number">0</span>)    <span class="hljs-keyword">if</span> root == <span class="hljs-literal">nil</span> &#123;        <span class="hljs-keyword">return</span> ret    &#125;    travelTree(root, <span class="hljs-number">0</span>)    <span class="hljs-keyword">for</span> i, j := <span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(ret) - <span class="hljs-number">1</span>; i &lt; j; i,j = i+<span class="hljs-number">1</span>, j<span class="hljs-number">-1</span> &#123;        ret[i], ret[j] = ret[j], ret[i]    &#125;    <span class="hljs-keyword">return</span> ret&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">travelTree</span><span class="hljs-params">(root *TreeNode, k <span class="hljs-keyword">int</span>)</span></span> &#123;    <span class="hljs-keyword">if</span> root == <span class="hljs-literal">nil</span> &#123;        <span class="hljs-keyword">return</span>     &#125;    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(ret) == k &#123;        ret = <span class="hljs-built_in">append</span>(ret, []<span class="hljs-keyword">int</span>&#123;&#125;)    &#125;    ret[k] = <span class="hljs-built_in">append</span>(ret[k], root.Val)    travelTree(root.Left, k+<span class="hljs-number">1</span>)    travelTree(root.Right, k+<span class="hljs-number">1</span>)&#125;</code></pre><pre><code class="hljs Python"><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">Module Description: 107-äºŒå‰æ ‘çš„å±‚åºéå† II</span><span class="hljs-string">Solutionï¼š</span><span class="hljs-string">Date: 2021-04-03 12:32:50</span><span class="hljs-string">Author: Wang P</span><span class="hljs-string">Problem:# ç»™å®šä¸€ä¸ªäºŒå‰æ ‘ï¼Œè¿”å›å…¶èŠ‚ç‚¹å€¼è‡ªåº•å‘ä¸Šçš„å±‚åºéå†ã€‚ ï¼ˆå³æŒ‰ä»å¶å­èŠ‚ç‚¹æ‰€åœ¨å±‚åˆ°æ ¹èŠ‚ç‚¹æ‰€åœ¨çš„å±‚ï¼Œé€å±‚ä»å·¦å‘å³éå†ï¼‰ </span><span class="hljs-string">        #  ä¾‹å¦‚ï¼š</span><span class="hljs-string">        # ç»™å®šäºŒå‰æ ‘ [3,9,20,null,null,15,7],</span><span class="hljs-string">        #     3</span><span class="hljs-string">        #    / \</span><span class="hljs-string">        #   9  20</span><span class="hljs-string">        #     /  \</span><span class="hljs-string">        #    15   7</span><span class="hljs-string">        #  è¿”å›å…¶è‡ªåº•å‘ä¸Šçš„å±‚åºéå†ä¸ºï¼š</span><span class="hljs-string">        # [</span><span class="hljs-string">        #   [15,7],</span><span class="hljs-string">        #   [9,20],</span><span class="hljs-string">        #   [3]</span><span class="hljs-string">        # ]</span><span class="hljs-string">        #</span><span class="hljs-string">        #  Related Topics æ ‘ å¹¿åº¦ä¼˜å…ˆæœç´¢</span><span class="hljs-string">        #  ğŸ‘ 423 ğŸ‘ 0</span><span class="hljs-string"></span><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-comment"># leetcode submit region begin(Prohibit modification and deletion)</span><span class="hljs-comment"># Definition for a binary tree node.</span><span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> List<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TreeNode</span>:</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, val=<span class="hljs-number">0</span>, left=<span class="hljs-literal">None</span>, right=<span class="hljs-literal">None</span></span>):</span>        self.val = val        self.left = left        self.right = right<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span>:</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self</span>):</span>        self.lii_ret = []    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">sign_k_level</span>(<span class="hljs-params">self, root: TreeNode, k: <span class="hljs-built_in">int</span></span>):</span>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> root:            <span class="hljs-keyword">return</span>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(self.lii_ret) == k:            self.lii_ret.append([])        self.lii_ret[k].append(root.val)        self.sign_k_level(root.left, k + <span class="hljs-number">1</span>)        self.sign_k_level(root.right, k + <span class="hljs-number">1</span>)    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">levelOrderBottom</span>(<span class="hljs-params">self, root: TreeNode</span>) -&gt; List[List[int]]:</span>        self.sign_k_level(root, <span class="hljs-number">0</span>)        self.lii_ret.reverse()        <span class="hljs-keyword">return</span> self.lii_ret<span class="hljs-comment"># leetcode submit region end(Prohibit modification and deletion)</span></code></pre><h6 id="103-äºŒå‰æ ‘çš„é”¯é½¿å½¢å±‚åºéå†"><a href="#103-äºŒå‰æ ‘çš„é”¯é½¿å½¢å±‚åºéå†" class="headerlink" title="103. äºŒå‰æ ‘çš„é”¯é½¿å½¢å±‚åºéå†"></a><a href="https://leetcode-cn.com/problems/binary-tree-zigzag-level-order-traversal/">103. äºŒå‰æ ‘çš„é”¯é½¿å½¢å±‚åºéå†</a></h6><p>ç»™å®šä¸€ä¸ªäºŒå‰æ ‘ï¼Œè¿”å›å…¶èŠ‚ç‚¹å€¼çš„é”¯é½¿å½¢å±‚åºéå†ã€‚ï¼ˆå³å…ˆä»å·¦å¾€å³ï¼Œå†ä»å³å¾€å·¦è¿›è¡Œä¸‹ä¸€å±‚éå†ï¼Œä»¥æ­¤ç±»æ¨ï¼Œå±‚ä¸å±‚ä¹‹é—´äº¤æ›¿è¿›è¡Œï¼‰ã€‚</p><p>ä¾‹å¦‚ï¼š<br>ç»™å®šäºŒå‰æ ‘ <code>[3,9,20,null,null,15,7]</code>,</p><pre><code class="hljs angelscript">  <span class="hljs-number">3</span> / \<span class="hljs-number">9</span>  <span class="hljs-number">20</span>  /  \ <span class="hljs-number">15</span>   <span class="hljs-number">7</span></code></pre><p>è¿”å›é”¯é½¿å½¢å±‚åºéå†å¦‚ä¸‹ï¼š</p><pre><code class="hljs json">[  [<span class="hljs-number">3</span>],  [<span class="hljs-number">20</span>,<span class="hljs-number">9</span>],  [<span class="hljs-number">15</span>,<span class="hljs-number">7</span>]]</code></pre><pre><code class="hljs Java"><span class="hljs-keyword">package</span> com.weitrue.leetcode.editor.cn;<span class="hljs-keyword">import</span> java.util.ArrayList;<span class="hljs-keyword">import</span> java.util.List;<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BinaryTreeZigzagLevelOrderTraversal</span></span>&#123;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span></span>&#123;        Solution s = <span class="hljs-keyword">new</span> BinaryTreeZigzagLevelOrderTraversal().<span class="hljs-function">new <span class="hljs-title">Solution</span><span class="hljs-params">()</span></span>;    &#125;        <span class="hljs-comment">//Given the root of a binary tree, return the zigzag level order traversal of its nodes&#x27; values. (i.e., from left to right, then right to left for the next level and alternate between).</span>    <span class="hljs-comment">// Example 1:</span>    <span class="hljs-comment">//Input: root = [3,9,20,null,null,15,7]</span>    <span class="hljs-comment">//Output: [[3],[20,9],[15,7]]</span>    <span class="hljs-comment">// Example 2:</span>    <span class="hljs-comment">//Input: root = [1]</span>    <span class="hljs-comment">//Output: [[1]]</span>    <span class="hljs-comment">// Example 3:</span>    <span class="hljs-comment">//Input: root = []</span>    <span class="hljs-comment">//Output: []</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Constraints:</span>    <span class="hljs-comment">// The number of nodes in the tree is in the range [0, 2000].</span>    <span class="hljs-comment">// -100 &lt;= Node.val &lt;= 100</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Related Topics æ ˆ æ ‘ å¹¿åº¦ä¼˜å…ˆæœç´¢</span>    <span class="hljs-comment">// ğŸ‘ 424 ğŸ‘ 0</span>     <span class="hljs-comment">//leetcode submit region begin(Prohibit modification and deletion)</span><span class="hljs-comment">/**</span><span class="hljs-comment"> * Definition for a binary tree node.</span><span class="hljs-comment"> */</span><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TreeNode</span> </span>&#123;     <span class="hljs-keyword">int</span> val;     TreeNode left;     TreeNode right;     TreeNode() &#123;&#125;     TreeNode(<span class="hljs-keyword">int</span> val) &#123; <span class="hljs-keyword">this</span>.val = val; &#125;     TreeNode(<span class="hljs-keyword">int</span> val, TreeNode left, TreeNode right) &#123;         <span class="hljs-keyword">this</span>.val = val;         <span class="hljs-keyword">this</span>.left = left;         <span class="hljs-keyword">this</span>.right = right;     &#125; &#125;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span> </span>&#123;    List&lt;List&lt;Integer&gt;&gt; liiRet = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();    <span class="hljs-keyword">public</span> List&lt;List&lt;Integer&gt;&gt; zigzagLevelOrder(TreeNode root) &#123;        signKLevel(root, <span class="hljs-number">0</span>);        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> k = <span class="hljs-number">0</span>; k &lt; liiRet.size(); k++) &#123;            <span class="hljs-keyword">if</span> (k%<span class="hljs-number">2</span> == <span class="hljs-number">1</span>) &#123;                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>, j=liiRet.get(k).size()-<span class="hljs-number">1</span>; i &lt; j; i++, j--) &#123;                    <span class="hljs-keyword">int</span> tmp = liiRet.get(k).get(i);                    liiRet.get(k).set(i, liiRet.get(k).get(j));                    liiRet.get(k).set(j, tmp);                &#125;            &#125;        &#125;        <span class="hljs-keyword">return</span> liiRet;    &#125;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">signKLevel</span><span class="hljs-params">(TreeNode root, <span class="hljs-keyword">int</span> k)</span> </span>&#123;        <span class="hljs-keyword">if</span> (root != <span class="hljs-keyword">null</span>) &#123;            <span class="hljs-keyword">if</span> (liiRet.size() == k) &#123;                liiRet.add(<span class="hljs-keyword">new</span> ArrayList&lt;&gt;());            &#125;            liiRet.get(k).add(root.val);            signKLevel(root.left, k+<span class="hljs-number">1</span>);            signKLevel(root.right, k+<span class="hljs-number">1</span>);        &#125;    &#125;&#125;<span class="hljs-comment">//leetcode submit region end(Prohibit modification and deletion)</span>&#125;</code></pre><pre><code class="hljs Go"><span class="hljs-comment">/**</span><span class="hljs-comment"> * Definition for a binary tree node.</span><span class="hljs-comment"> * type TreeNode struct &#123;</span><span class="hljs-comment"> *     Val int</span><span class="hljs-comment"> *     Left *TreeNode</span><span class="hljs-comment"> *     Right *TreeNode</span><span class="hljs-comment"> * &#125;</span><span class="hljs-comment"> */</span><span class="hljs-keyword">var</span> ret [][]<span class="hljs-keyword">int</span><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">zigzagLevelOrder</span><span class="hljs-params">(root *TreeNode)</span> [][]<span class="hljs-title">int</span></span> &#123;    <span class="hljs-comment">// write code here</span>    ret = <span class="hljs-built_in">make</span>([][]<span class="hljs-keyword">int</span>, <span class="hljs-number">0</span>)    <span class="hljs-keyword">if</span> root == <span class="hljs-literal">nil</span> &#123;        <span class="hljs-keyword">return</span> ret    &#125;    ret = <span class="hljs-built_in">append</span>(ret, []<span class="hljs-keyword">int</span>&#123;&#125;)    travelTree(root, <span class="hljs-number">0</span>)    <span class="hljs-keyword">for</span> i, v := <span class="hljs-keyword">range</span> ret &#123;        <span class="hljs-keyword">if</span> i% <span class="hljs-number">2</span> == <span class="hljs-number">1</span> &#123;            <span class="hljs-keyword">for</span> j, k := <span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(v)<span class="hljs-number">-1</span>; j&lt;k; j, k = j+<span class="hljs-number">1</span>, k<span class="hljs-number">-1</span> &#123;                v[j], v[k] = v[k], v[j]            &#125;        &#125;    &#125;    <span class="hljs-keyword">return</span> ret&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">travelTree</span><span class="hljs-params">(root *TreeNode, k <span class="hljs-keyword">int</span>)</span></span> &#123;    <span class="hljs-keyword">if</span> root == <span class="hljs-literal">nil</span> &#123;        <span class="hljs-keyword">return</span>     &#125;    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(ret) == k &#123;        ret = <span class="hljs-built_in">append</span>(ret, []<span class="hljs-keyword">int</span>&#123;&#125;)    &#125;    ret[k] = <span class="hljs-built_in">append</span>(ret[k], root.Val)    travelTree(root.Left, k+<span class="hljs-number">1</span>)    travelTree(root.Right, k+<span class="hljs-number">1</span>)&#125;</code></pre><pre><code class="hljs Python"><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">Module Description: 103-äºŒå‰æ ‘çš„é”¯é½¿å½¢å±‚åºéå†</span><span class="hljs-string">Solutionï¼š</span><span class="hljs-string">Author: Wang P</span><span class="hljs-string">Problem:# ç»™å®šä¸€ä¸ªäºŒå‰æ ‘ï¼Œè¿”å›å…¶èŠ‚ç‚¹å€¼çš„é”¯é½¿å½¢å±‚åºéå†ã€‚ï¼ˆå³å…ˆä»å·¦å¾€å³ï¼Œå†ä»å³å¾€å·¦è¿›è¡Œä¸‹ä¸€å±‚éå†ï¼Œä»¥æ­¤ç±»æ¨ï¼Œå±‚ä¸å±‚ä¹‹é—´äº¤æ›¿è¿›è¡Œï¼‰ã€‚ </span><span class="hljs-string">        #  ä¾‹å¦‚ï¼š</span><span class="hljs-string">        # ç»™å®šäºŒå‰æ ‘ [3,9,20,null,null,15,7],</span><span class="hljs-string">        #     3</span><span class="hljs-string">        #    / \</span><span class="hljs-string">        #   9  20</span><span class="hljs-string">        #     /  \</span><span class="hljs-string">        #    15   7</span><span class="hljs-string">        #  è¿”å›é”¯é½¿å½¢å±‚åºéå†å¦‚ä¸‹ï¼š</span><span class="hljs-string">        # [</span><span class="hljs-string">        #   [3],</span><span class="hljs-string">        #   [20,9],</span><span class="hljs-string">        #   [15,7]</span><span class="hljs-string">        # ]</span><span class="hljs-string">        #</span><span class="hljs-string">        #  Related Topics æ ˆ æ ‘ å¹¿åº¦ä¼˜å…ˆæœç´¢</span><span class="hljs-string">        #  ğŸ‘ 424 ğŸ‘ 0</span><span class="hljs-string"></span><span class="hljs-string">        &quot;&quot;&quot;</span><span class="hljs-comment"># leetcode submit region begin(Prohibit modification and deletion)</span><span class="hljs-comment"># Definition for a binary tree node.</span><span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> List<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TreeNode</span>:</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, val=<span class="hljs-number">0</span>, left=<span class="hljs-literal">None</span>, right=<span class="hljs-literal">None</span></span>):</span>        self.val = val        self.left = left        self.right = right<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span>:</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self</span>):</span>        self.lii_ret = []    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">sign_k_level</span>(<span class="hljs-params">self, root: TreeNode, k: <span class="hljs-built_in">int</span></span>):</span>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> root:            <span class="hljs-keyword">return</span>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(self.lii_ret) == k:            self.lii_ret.append([])        self.lii_ret[k].append(root.val)        self.sign_k_level(root.left, k + <span class="hljs-number">1</span>)        self.sign_k_level(root.right, k + <span class="hljs-number">1</span>)    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">zigzagLevelOrder</span>(<span class="hljs-params">self, root: TreeNode</span>) -&gt; List[List[int]]:</span>        self.sign_k_level(root, <span class="hljs-number">0</span>)        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(self.lii_ret)):            <span class="hljs-keyword">if</span> i % <span class="hljs-number">2</span> == <span class="hljs-number">1</span>:                self.lii_ret[i].reverse()        <span class="hljs-keyword">return</span> self.lii_ret<span class="hljs-comment"># leetcode submit region end(Prohibit modification and deletion)</span></code></pre><h5 id="äºŒå‰æ ‘çš„è¿›é˜¶æ“ä½œ"><a href="#äºŒå‰æ ‘çš„è¿›é˜¶æ“ä½œ" class="headerlink" title="äºŒå‰æ ‘çš„è¿›é˜¶æ“ä½œ"></a>äºŒå‰æ ‘çš„è¿›é˜¶æ“ä½œ</h5><h6 id="110-å¹³è¡¡äºŒå‰æ ‘"><a href="#110-å¹³è¡¡äºŒå‰æ ‘" class="headerlink" title="110. å¹³è¡¡äºŒå‰æ ‘"></a><a href="https://leetcode-cn.com/problems/balanced-binary-tree/">110. å¹³è¡¡äºŒå‰æ ‘</a></h6><p>ç»™å®šä¸€ä¸ªäºŒå‰æ ‘ï¼Œåˆ¤æ–­å®ƒæ˜¯å¦æ˜¯é«˜åº¦å¹³è¡¡çš„äºŒå‰æ ‘ã€‚</p><p>æœ¬é¢˜ä¸­ï¼Œä¸€æ£µé«˜åº¦å¹³è¡¡äºŒå‰æ ‘å®šä¹‰ä¸ºï¼š</p><blockquote><p>ä¸€ä¸ªäºŒå‰æ ‘<em>æ¯ä¸ªèŠ‚ç‚¹</em> çš„å·¦å³ä¸¤ä¸ªå­æ ‘çš„é«˜åº¦å·®çš„ç»å¯¹å€¼ä¸è¶…è¿‡ 1 ã€‚</p></blockquote><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><p><img src="https://assets.leetcode.com/uploads/2020/10/06/balance_1.jpg"></p><pre><code class="hljs yaml"><span class="hljs-string">è¾“å…¥ï¼šroot</span> <span class="hljs-string">=</span> [<span class="hljs-number">3</span>,<span class="hljs-number">9</span>,<span class="hljs-number">20</span>,<span class="hljs-literal">null</span>,<span class="hljs-literal">null</span>,<span class="hljs-number">15</span>,<span class="hljs-number">7</span>]<span class="hljs-string">è¾“å‡ºï¼štrue</span></code></pre><p><strong>ç¤ºä¾‹ 2ï¼š</strong></p><p><img src="https://assets.leetcode.com/uploads/2020/10/06/balance_2.jpg"></p><pre><code class="hljs yaml"><span class="hljs-string">è¾“å…¥ï¼šroot</span> <span class="hljs-string">=</span> [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">3</span>,<span class="hljs-literal">null</span>,<span class="hljs-literal">null</span>,<span class="hljs-number">4</span>,<span class="hljs-number">4</span>]<span class="hljs-string">è¾“å‡ºï¼šfalse</span></code></pre><p><strong>ç¤ºä¾‹ 3ï¼š</strong></p><pre><code class="hljs nix">è¾“å…¥ï¼š<span class="hljs-attr">root</span> = []è¾“å‡ºï¼š<span class="hljs-literal">true</span></code></pre><p><strong>æç¤ºï¼š</strong></p><ul><li>æ ‘ä¸­çš„èŠ‚ç‚¹æ•°åœ¨èŒƒå›´ <code>[0, 5000]</code> å†…</li><li><code>-104 &lt;= Node.val &lt;= 104</code></li></ul><pre><code class="hljs Java"><span class="hljs-keyword">package</span> com.weitrue.leetcode.editor.cn;<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BalancedBinaryTree</span></span>&#123;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span></span>&#123;        Solution s = <span class="hljs-keyword">new</span> BalancedBinaryTree().<span class="hljs-function">new <span class="hljs-title">Solution</span><span class="hljs-params">()</span></span>;    &#125;        <span class="hljs-comment">//Given a binary tree, determine if it is height-balanced.</span>    <span class="hljs-comment">// For this problem, a height-balanced binary tree is defined as:</span>    <span class="hljs-comment">// a binary tree in which the left and right subtrees of every node differ in height by no more than 1.</span>    <span class="hljs-comment">// Example 1:</span>    <span class="hljs-comment">//Input: root = [3,9,20,null,null,15,7]</span>    <span class="hljs-comment">//Output: true</span>    <span class="hljs-comment">// Example 2:</span>    <span class="hljs-comment">//Input: root = [1,2,2,3,3,null,null,4,4]</span>    <span class="hljs-comment">//Output: false</span>    <span class="hljs-comment">// Example 3:</span>    <span class="hljs-comment">//Input: root = []</span>    <span class="hljs-comment">//Output: true</span>    <span class="hljs-comment">// Constraints:</span>    <span class="hljs-comment">// The number of nodes in the tree is in the range [0, 5000].</span>    <span class="hljs-comment">// -104 &lt;= Node.val &lt;= 104</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Related Topics æ ‘ æ·±åº¦ä¼˜å…ˆæœç´¢ é€’å½’</span>    <span class="hljs-comment">// ğŸ‘ 652 ğŸ‘ 0</span>     <span class="hljs-comment">//leetcode submit region begin(Prohibit modification and deletion)</span>    <span class="hljs-comment">/**</span><span class="hljs-comment">     * Definition for a binary tree node.</span><span class="hljs-comment">     *</span><span class="hljs-comment">     */</span>    <span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TreeNode</span> </span>&#123;        <span class="hljs-keyword">int</span> val;        TreeNode left;        TreeNode right;        TreeNode() &#123;&#125;        TreeNode(<span class="hljs-keyword">int</span> val) &#123; <span class="hljs-keyword">this</span>.val = val; &#125;        TreeNode(<span class="hljs-keyword">int</span> val, TreeNode left, TreeNode right) &#123;            <span class="hljs-keyword">this</span>.val = val;            <span class="hljs-keyword">this</span>.left = left;            <span class="hljs-keyword">this</span>.right = right;        &#125;    &#125;    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span> </span>&#123;        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">isBalanced</span><span class="hljs-params">(TreeNode root)</span> </span>&#123;            <span class="hljs-keyword">return</span> getTreeHeight(root) &gt;= <span class="hljs-number">0</span>;        &#125;        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">getTreeHeight</span><span class="hljs-params">(TreeNode root)</span> </span>&#123;            <span class="hljs-keyword">if</span> (root == <span class="hljs-keyword">null</span>) &#123;                <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;            &#125;            <span class="hljs-keyword">int</span> l = getTreeHeight(root.left);            <span class="hljs-keyword">int</span> r = getTreeHeight(root.right);            <span class="hljs-keyword">if</span> (l &lt; <span class="hljs-number">0</span> || r &lt; <span class="hljs-number">0</span> || Math.abs(l-r) &gt; <span class="hljs-number">1</span>) &#123;                <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;            &#125;            <span class="hljs-keyword">return</span> Math.max(l, r) + <span class="hljs-number">1</span>;        &#125;    &#125;    <span class="hljs-comment">//leetcode submit region end(Prohibit modification and deletion)</span>&#125;</code></pre><pre><code class="hljs Go"><span class="hljs-comment">/**</span><span class="hljs-comment"> * Definition for a binary tree node.</span><span class="hljs-comment"> * type TreeNode struct &#123;</span><span class="hljs-comment"> *     Val int</span><span class="hljs-comment"> *     Left *TreeNode</span><span class="hljs-comment"> *     Right *TreeNode</span><span class="hljs-comment"> * &#125;</span><span class="hljs-comment"> */</span><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">isBalanced</span><span class="hljs-params">(root *TreeNode)</span> <span class="hljs-title">bool</span></span> &#123;<span class="hljs-keyword">return</span> treeHeight(root) &gt;= <span class="hljs-number">0</span>&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">treeHeight</span><span class="hljs-params">(root *TreeNode)</span> <span class="hljs-title">int</span></span> &#123;<span class="hljs-keyword">if</span> root == <span class="hljs-literal">nil</span> &#123;<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>&#125;l := treeHeight(root.Left)r := treeHeight(root.Right)<span class="hljs-keyword">if</span> l &lt; <span class="hljs-number">0</span> || r &lt; <span class="hljs-number">0</span> || math.Abs(<span class="hljs-keyword">float64</span>(l-r)) &gt; <span class="hljs-number">1</span> &#123;<span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>&#125;<span class="hljs-keyword">return</span> <span class="hljs-keyword">int</span>(math.Max(<span class="hljs-keyword">float64</span>(l), <span class="hljs-keyword">float64</span>(r))) + <span class="hljs-number">1</span>&#125;</code></pre><pre><code class="hljs Python"><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">Module Description: 110-å¹³è¡¡äºŒå‰æ ‘</span><span class="hljs-string">Solutionï¼š</span><span class="hljs-string">Author: Wang P</span><span class="hljs-string">Problem:# ç»™å®šä¸€ä¸ªäºŒå‰æ ‘ï¼Œåˆ¤æ–­å®ƒæ˜¯å¦æ˜¯é«˜åº¦å¹³è¡¡çš„äºŒå‰æ ‘ã€‚ </span><span class="hljs-string">        #  æœ¬é¢˜ä¸­ï¼Œä¸€æ£µé«˜åº¦å¹³è¡¡äºŒå‰æ ‘å®šä¹‰ä¸ºï¼š</span><span class="hljs-string">        #  ä¸€ä¸ªäºŒå‰æ ‘æ¯ä¸ªèŠ‚ç‚¹ çš„å·¦å³ä¸¤ä¸ªå­æ ‘çš„é«˜åº¦å·®çš„ç»å¯¹å€¼ä¸è¶…è¿‡ 1 ã€‚</span><span class="hljs-string">        #  ç¤ºä¾‹ 1ï¼š</span><span class="hljs-string">        # è¾“å…¥ï¼šroot = [3,9,20,null,null,15,7]</span><span class="hljs-string">        # è¾“å‡ºï¼štrue</span><span class="hljs-string">        #  ç¤ºä¾‹ 2ï¼š</span><span class="hljs-string">        # è¾“å…¥ï¼šroot = [1,2,2,3,3,null,null,4,4]</span><span class="hljs-string">        # è¾“å‡ºï¼šfalse</span><span class="hljs-string">        #  ç¤ºä¾‹ 3ï¼š</span><span class="hljs-string">        # è¾“å…¥ï¼šroot = []</span><span class="hljs-string">        # è¾“å‡ºï¼štrue</span><span class="hljs-string">        #</span><span class="hljs-string">        #  æç¤ºï¼š</span><span class="hljs-string">        #  æ ‘ä¸­çš„èŠ‚ç‚¹æ•°åœ¨èŒƒå›´ [0, 5000] å†…</span><span class="hljs-string">        #  -104 &lt;= Node.val &lt;= 104</span><span class="hljs-string">        #</span><span class="hljs-string">        #  Related Topics æ ‘ æ·±åº¦ä¼˜å…ˆæœç´¢ é€’å½’</span><span class="hljs-string">        #  ğŸ‘ 652 ğŸ‘ 0</span><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-comment"># leetcode submit region begin(Prohibit modification and deletion)</span><span class="hljs-comment"># Definition for a binary tree node.</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TreeNode</span>:</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, val=<span class="hljs-number">0</span>, left=<span class="hljs-literal">None</span>, right=<span class="hljs-literal">None</span></span>):</span>        self.val = val        self.left = left        self.right = right<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span>:</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">isBalanced</span>(<span class="hljs-params">self, root: TreeNode</span>) -&gt; bool:</span>        <span class="hljs-keyword">return</span> self.get_tree_height(root) &gt;= <span class="hljs-number">0</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_tree_height</span>(<span class="hljs-params">self, root: TreeNode</span>) -&gt; int:</span>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> root:            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>        l, r = self.get_tree_height(root.left), self.get_tree_height(root.right)        <span class="hljs-keyword">if</span> l &lt; <span class="hljs-number">0</span> <span class="hljs-keyword">or</span> r &lt; <span class="hljs-number">0</span> <span class="hljs-keyword">or</span> <span class="hljs-built_in">abs</span>(l-r) &gt; <span class="hljs-number">1</span>:            <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">max</span>(l, r) + <span class="hljs-number">1</span><span class="hljs-comment"># leetcode submit region end(Prohibit modification and deletion)</span></code></pre><h6 id="112-è·¯å¾„æ€»å’Œ"><a href="#112-è·¯å¾„æ€»å’Œ" class="headerlink" title="112. è·¯å¾„æ€»å’Œ"></a><a href="https://leetcode-cn.com/problems/path-sum/">112. è·¯å¾„æ€»å’Œ</a></h6><p>ç»™ä½ äºŒå‰æ ‘çš„æ ¹èŠ‚ç‚¹ root å’Œä¸€ä¸ªè¡¨ç¤ºç›®æ ‡å’Œçš„æ•´æ•° targetSum ï¼Œåˆ¤æ–­è¯¥æ ‘ä¸­æ˜¯å¦å­˜åœ¨ æ ¹èŠ‚ç‚¹åˆ°å¶å­èŠ‚ç‚¹ çš„è·¯å¾„ï¼Œè¿™æ¡è·¯å¾„ä¸Šæ‰€æœ‰èŠ‚ç‚¹å€¼ç›¸åŠ ç­‰äºç›®æ ‡å’Œ targetSum ã€‚</p><p><strong>å¶å­èŠ‚ç‚¹</strong> æ˜¯æŒ‡æ²¡æœ‰å­èŠ‚ç‚¹çš„èŠ‚ç‚¹ã€‚</p><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><p><img src="https://assets.leetcode.com/uploads/2021/01/18/pathsum1.jpg"></p><pre><code class="hljs yaml"><span class="hljs-string">è¾“å…¥ï¼šroot</span> <span class="hljs-string">=</span> [<span class="hljs-number">5</span>,<span class="hljs-number">4</span>,<span class="hljs-number">8</span>,<span class="hljs-number">11</span>,<span class="hljs-literal">null</span>,<span class="hljs-number">13</span>,<span class="hljs-number">4</span>,<span class="hljs-number">7</span>,<span class="hljs-number">2</span>,<span class="hljs-literal">null</span>,<span class="hljs-literal">null</span>,<span class="hljs-literal">null</span>,<span class="hljs-number">1</span>]<span class="hljs-string">,</span> <span class="hljs-string">targetSum</span> <span class="hljs-string">=</span> <span class="hljs-number">22</span><span class="hljs-string">è¾“å‡ºï¼štrue</span></code></pre><p><strong>ç¤ºä¾‹ 2ï¼š</strong></p><p><img src="https://assets.leetcode.com/uploads/2021/01/18/pathsum2.jpg"></p><pre><code class="hljs angelscript">è¾“å…¥ï¼šroot = [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>], targetSum = <span class="hljs-number">5</span>è¾“å‡ºï¼š<span class="hljs-literal">false</span></code></pre><p><strong>ç¤ºä¾‹ 3</strong></p><pre><code class="hljs angelscript">è¾“å…¥ï¼šroot = [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>], targetSum = <span class="hljs-number">0</span>è¾“å‡ºï¼š<span class="hljs-literal">false</span></code></pre><p><strong>æç¤ºï¼š</strong></p><ul><li>æ ‘ä¸­èŠ‚ç‚¹çš„æ•°ç›®åœ¨èŒƒå›´ [0, 5000] å†…</li><li>-1000 &lt;= Node.val &lt;= 1000</li><li>-1000 &lt;= targetSum &lt;= 1000</li></ul><pre><code class="hljs Java"></code></pre><pre><code class="hljs Go"></code></pre><pre><code class="hljs Python"></code></pre><h6 id="105-ä»å‰åºä¸ä¸­åºéå†åºåˆ—æ„é€ äºŒå‰æ ‘"><a href="#105-ä»å‰åºä¸ä¸­åºéå†åºåˆ—æ„é€ äºŒå‰æ ‘" class="headerlink" title="105. ä»å‰åºä¸ä¸­åºéå†åºåˆ—æ„é€ äºŒå‰æ ‘"></a><a href="https://leetcode-cn.com/problems/construct-binary-tree-from-preorder-and-inorder-traversal/">105. ä»å‰åºä¸ä¸­åºéå†åºåˆ—æ„é€ äºŒå‰æ ‘</a></h6><p>æ ¹æ®ä¸€æ£µæ ‘çš„å‰åºéå†ä¸ä¸­åºéå†æ„é€ äºŒå‰æ ‘ã€‚</p><p><strong>æ³¨æ„:</strong><br>ä½ å¯ä»¥å‡è®¾æ ‘ä¸­æ²¡æœ‰é‡å¤çš„å…ƒç´ ã€‚</p><p>ä¾‹å¦‚ï¼Œç»™å‡º</p><pre><code class="hljs angelscript">å‰åºéå† preorder = [<span class="hljs-number">3</span>,<span class="hljs-number">9</span>,<span class="hljs-number">20</span>,<span class="hljs-number">15</span>,<span class="hljs-number">7</span>]ä¸­åºéå† inorder = [<span class="hljs-number">9</span>,<span class="hljs-number">3</span>,<span class="hljs-number">15</span>,<span class="hljs-number">20</span>,<span class="hljs-number">7</span>]</code></pre><p>è¿”å›å¦‚ä¸‹çš„äºŒå‰æ ‘ï¼š</p><pre><code class="hljs angelscript">  <span class="hljs-number">3</span> / \<span class="hljs-number">9</span>  <span class="hljs-number">20</span>  /  \ <span class="hljs-number">15</span>   <span class="hljs-number">7</span></code></pre><pre><code class="hljs Java"></code></pre><pre><code class="hljs Go"></code></pre><pre><code class="hljs Python"></code></pre><h6 id="222-å®Œå…¨äºŒå‰æ ‘çš„èŠ‚ç‚¹ä¸ªæ•°"><a href="#222-å®Œå…¨äºŒå‰æ ‘çš„èŠ‚ç‚¹ä¸ªæ•°" class="headerlink" title="222. å®Œå…¨äºŒå‰æ ‘çš„èŠ‚ç‚¹ä¸ªæ•°"></a><a href="https://leetcode-cn.com/problems/count-complete-tree-nodes/">222. å®Œå…¨äºŒå‰æ ‘çš„èŠ‚ç‚¹ä¸ªæ•°</a></h6><p>ç»™ä½ ä¸€æ£µ å®Œå…¨äºŒå‰æ ‘ çš„æ ¹èŠ‚ç‚¹ root ï¼Œæ±‚å‡ºè¯¥æ ‘çš„èŠ‚ç‚¹ä¸ªæ•°ã€‚</p><p>å®Œå…¨äºŒå‰æ ‘ çš„å®šä¹‰å¦‚ä¸‹ï¼šåœ¨å®Œå…¨äºŒå‰æ ‘ä¸­ï¼Œé™¤äº†æœ€åº•å±‚èŠ‚ç‚¹å¯èƒ½æ²¡å¡«æ»¡å¤–ï¼Œå…¶ä½™æ¯å±‚èŠ‚ç‚¹æ•°éƒ½è¾¾åˆ°æœ€å¤§å€¼ï¼Œå¹¶ä¸”æœ€ä¸‹é¢ä¸€å±‚çš„èŠ‚ç‚¹éƒ½é›†ä¸­åœ¨è¯¥å±‚æœ€å·¦è¾¹çš„è‹¥å¹²ä½ç½®ã€‚è‹¥æœ€åº•å±‚ä¸ºç¬¬ h å±‚ï¼Œåˆ™è¯¥å±‚åŒ…å« 1~ 2^h ä¸ªèŠ‚ç‚¹ã€‚</p><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><p><img src="https://assets.leetcode.com/uploads/2021/01/14/complete.jpg"></p><pre><code class="hljs angelscript">è¾“å…¥ï¼šroot = [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>]è¾“å‡ºï¼š<span class="hljs-number">6</span></code></pre><p><strong>ç¤ºä¾‹ 2ï¼š</strong></p><pre><code class="hljs angelscript">è¾“å…¥ï¼šroot = []è¾“å‡ºï¼š<span class="hljs-number">0</span></code></pre><p><strong>ç¤ºä¾‹ 3ï¼š</strong></p><pre><code class="hljs angelscript">è¾“å…¥ï¼šroot = [<span class="hljs-number">1</span>]è¾“å‡ºï¼š<span class="hljs-number">1</span></code></pre><p><strong>æç¤ºï¼š</strong></p><ul><li>æ ‘ä¸­èŠ‚ç‚¹çš„æ•°ç›®èŒƒå›´æ˜¯<code>[0, 5 * 104]</code></li><li><code>0 &lt;= Node.val &lt;= 5 * 104</code></li><li>é¢˜ç›®æ•°æ®ä¿è¯è¾“å…¥çš„æ ‘æ˜¯ <strong>å®Œå…¨äºŒå‰æ ‘</strong></li></ul><pre><code class="hljs Java"></code></pre><pre><code class="hljs Go"></code></pre><pre><code class="hljs Python"></code></pre><h6 id="å‰‘æŒ‡-Offer-54-äºŒå‰æœç´¢æ ‘çš„ç¬¬kå¤§èŠ‚ç‚¹"><a href="#å‰‘æŒ‡-Offer-54-äºŒå‰æœç´¢æ ‘çš„ç¬¬kå¤§èŠ‚ç‚¹" class="headerlink" title="å‰‘æŒ‡ Offer 54. äºŒå‰æœç´¢æ ‘çš„ç¬¬kå¤§èŠ‚ç‚¹"></a><a href="https://leetcode-cn.com/problems/er-cha-sou-suo-shu-de-di-kda-jie-dian-lcof/">å‰‘æŒ‡ Offer 54. äºŒå‰æœç´¢æ ‘çš„ç¬¬kå¤§èŠ‚ç‚¹</a></h6><p>ç»™å®šä¸€æ£µäºŒå‰æœç´¢æ ‘ï¼Œè¯·æ‰¾å‡ºå…¶ä¸­ç¬¬kå¤§çš„èŠ‚ç‚¹ã€‚</p><p><strong>ç¤ºä¾‹ 1:</strong></p><pre><code class="hljs yaml"><span class="hljs-string">è¾“å…¥:</span> <span class="hljs-string">root</span> <span class="hljs-string">=</span> [<span class="hljs-number">3</span>,<span class="hljs-number">1</span>,<span class="hljs-number">4</span>,<span class="hljs-literal">null</span>,<span class="hljs-number">2</span>]<span class="hljs-string">,</span> <span class="hljs-string">k</span> <span class="hljs-string">=</span> <span class="hljs-number">1</span>   <span class="hljs-number">3</span>  <span class="hljs-string">/</span> <span class="hljs-string">\</span> <span class="hljs-number">1</span>   <span class="hljs-number">4</span>  <span class="hljs-string">\</span>   <span class="hljs-number">2</span><span class="hljs-string">è¾“å‡º:</span> <span class="hljs-number">4</span></code></pre><p><strong>ç¤ºä¾‹ 2:</strong></p><pre><code class="hljs yaml"><span class="hljs-string">è¾“å…¥:</span> <span class="hljs-string">root</span> <span class="hljs-string">=</span> [<span class="hljs-number">5</span>,<span class="hljs-number">3</span>,<span class="hljs-number">6</span>,<span class="hljs-number">2</span>,<span class="hljs-number">4</span>,<span class="hljs-literal">null</span>,<span class="hljs-literal">null</span>,<span class="hljs-number">1</span>]<span class="hljs-string">,</span> <span class="hljs-string">k</span> <span class="hljs-string">=</span> <span class="hljs-number">3</span>       <span class="hljs-number">5</span>      <span class="hljs-string">/</span> <span class="hljs-string">\</span>     <span class="hljs-number">3</span>   <span class="hljs-number">6</span>    <span class="hljs-string">/</span> <span class="hljs-string">\</span>   <span class="hljs-number">2</span>   <span class="hljs-number">4</span>  <span class="hljs-string">/</span> <span class="hljs-number">1</span><span class="hljs-string">è¾“å‡º:</span> <span class="hljs-number">4</span></code></pre><p><strong>é™åˆ¶ï¼š</strong></p><p>1 â‰¤ k â‰¤ äºŒå‰æœç´¢æ ‘å…ƒç´ ä¸ªæ•°</p><pre><code class="hljs Java"></code></pre><pre><code class="hljs Go"></code></pre><pre><code class="hljs Python"></code></pre><h6 id="å‰‘æŒ‡-Offer-26-æ ‘çš„å­ç»“æ„"><a href="#å‰‘æŒ‡-Offer-26-æ ‘çš„å­ç»“æ„" class="headerlink" title="å‰‘æŒ‡ Offer 26. æ ‘çš„å­ç»“æ„"></a><a href="https://leetcode-cn.com/problems/shu-de-zi-jie-gou-lcof/">å‰‘æŒ‡ Offer 26. æ ‘çš„å­ç»“æ„</a></h6><p>è¾“å…¥ä¸¤æ£µäºŒå‰æ ‘Aå’ŒBï¼Œåˆ¤æ–­Bæ˜¯ä¸æ˜¯Açš„å­ç»“æ„ã€‚(çº¦å®šç©ºæ ‘ä¸æ˜¯ä»»æ„ä¸€ä¸ªæ ‘çš„å­ç»“æ„)</p><p>Bæ˜¯Açš„å­ç»“æ„ï¼Œ å³ Aä¸­æœ‰å‡ºç°å’ŒBç›¸åŒçš„ç»“æ„å’ŒèŠ‚ç‚¹å€¼ã€‚</p><p>ä¾‹å¦‚:<br>ç»™å®šçš„æ ‘ A:</p><pre><code class="hljs angelscript">    <span class="hljs-number">3</span>   / \  <span class="hljs-number">4</span>   <span class="hljs-number">5</span> / \<span class="hljs-number">1</span>   <span class="hljs-number">2</span></code></pre><p>ç»™å®šçš„æ ‘ Bï¼š</p><pre><code class="hljs angelscript">  <span class="hljs-number">4</span>  /<span class="hljs-number">1</span></code></pre><p>è¿”å› trueï¼Œå› ä¸º B ä¸ A çš„ä¸€ä¸ªå­æ ‘æ‹¥æœ‰ç›¸åŒçš„ç»“æ„å’ŒèŠ‚ç‚¹å€¼ã€‚</p><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><pre><code class="hljs angelscript">è¾“å…¥ï¼šA = [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>], B = [<span class="hljs-number">3</span>,<span class="hljs-number">1</span>]è¾“å‡ºï¼š<span class="hljs-literal">false</span></code></pre><p><strong>ç¤ºä¾‹ 2ï¼š</strong></p><pre><code class="hljs angelscript">è¾“å…¥ï¼šA = [<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>], B = [<span class="hljs-number">4</span>,<span class="hljs-number">1</span>]è¾“å‡ºï¼š<span class="hljs-literal">true</span></code></pre><p><strong>é™åˆ¶ï¼š</strong></p><pre><code class="hljs basic"><span class="hljs-symbol">0 </span>&lt;= èŠ‚ç‚¹ä¸ªæ•° &lt;= <span class="hljs-number">10000</span></code></pre><pre><code class="hljs Java"></code></pre><pre><code class="hljs Go"></code></pre><pre><code class="hljs Python"></code></pre><h6 id="662-äºŒå‰æ ‘æœ€å¤§å®½åº¦"><a href="#662-äºŒå‰æ ‘æœ€å¤§å®½åº¦" class="headerlink" title="662. äºŒå‰æ ‘æœ€å¤§å®½åº¦"></a><a href="https://leetcode-cn.com/problems/maximum-width-of-binary-tree/">662. äºŒå‰æ ‘æœ€å¤§å®½åº¦</a></h6><p>ç»™å®šä¸€ä¸ªäºŒå‰æ ‘ï¼Œç¼–å†™ä¸€ä¸ªå‡½æ•°æ¥è·å–è¿™ä¸ªæ ‘çš„æœ€å¤§å®½åº¦ã€‚æ ‘çš„å®½åº¦æ˜¯æ‰€æœ‰å±‚ä¸­çš„æœ€å¤§å®½åº¦ã€‚è¿™ä¸ªäºŒå‰æ ‘ä¸æ»¡äºŒå‰æ ‘ï¼ˆfull binary treeï¼‰ç»“æ„ç›¸åŒï¼Œä½†ä¸€äº›èŠ‚ç‚¹ä¸ºç©ºã€‚</p><p>æ¯ä¸€å±‚çš„å®½åº¦è¢«å®šä¹‰ä¸ºä¸¤ä¸ªç«¯ç‚¹ï¼ˆè¯¥å±‚æœ€å·¦å’Œæœ€å³çš„éç©ºèŠ‚ç‚¹ï¼Œä¸¤ç«¯ç‚¹é—´çš„nullèŠ‚ç‚¹ä¹Ÿè®¡å…¥é•¿åº¦ï¼‰ä¹‹é—´çš„é•¿åº¦ã€‚</p><p><strong>ç¤ºä¾‹ 1:</strong></p><pre><code class="hljs angelscript">è¾“å…¥:            <span class="hljs-number">1</span>         /   \        <span class="hljs-number">3</span>     <span class="hljs-number">2</span>       / \     \        <span class="hljs-number">5</span>   <span class="hljs-number">3</span>     <span class="hljs-number">9</span> è¾“å‡º: <span class="hljs-number">4</span>è§£é‡Š: æœ€å¤§å€¼å‡ºç°åœ¨æ ‘çš„ç¬¬ <span class="hljs-number">3</span> å±‚ï¼Œå®½åº¦ä¸º <span class="hljs-number">4</span> (<span class="hljs-number">5</span>,<span class="hljs-number">3</span>,<span class="hljs-literal">null</span>,<span class="hljs-number">9</span>)ã€‚</code></pre><p><strong>ç¤ºä¾‹ 2:</strong></p><pre><code class="hljs angelscript">è¾“å…¥:           <span class="hljs-number">1</span>         /          <span class="hljs-number">3</span>           / \             <span class="hljs-number">5</span>   <span class="hljs-number">3</span>     è¾“å‡º: <span class="hljs-number">2</span>è§£é‡Š: æœ€å¤§å€¼å‡ºç°åœ¨æ ‘çš„ç¬¬ <span class="hljs-number">3</span> å±‚ï¼Œå®½åº¦ä¸º <span class="hljs-number">2</span> (<span class="hljs-number">5</span>,<span class="hljs-number">3</span>)ã€‚</code></pre><p><strong>ç¤ºä¾‹ 3:</strong></p><pre><code class="hljs angelscript">è¾“å…¥:           <span class="hljs-number">1</span>         / \        <span class="hljs-number">3</span>   <span class="hljs-number">2</span>        /              <span class="hljs-number">5</span>      è¾“å‡º: <span class="hljs-number">2</span>è§£é‡Š: æœ€å¤§å€¼å‡ºç°åœ¨æ ‘çš„ç¬¬ <span class="hljs-number">2</span> å±‚ï¼Œå®½åº¦ä¸º <span class="hljs-number">2</span> (<span class="hljs-number">3</span>,<span class="hljs-number">2</span>)ã€‚</code></pre><p><strong>ç¤ºä¾‹ 4:</strong></p><pre><code class="hljs angelscript">è¾“å…¥:           <span class="hljs-number">1</span>         / \        <span class="hljs-number">3</span>   <span class="hljs-number">2</span>       /     \        <span class="hljs-number">5</span>       <span class="hljs-number">9</span>      /         \    <span class="hljs-number">6</span>           <span class="hljs-number">7</span>è¾“å‡º: <span class="hljs-number">8</span>è§£é‡Š: æœ€å¤§å€¼å‡ºç°åœ¨æ ‘çš„ç¬¬ <span class="hljs-number">4</span> å±‚ï¼Œå®½åº¦ä¸º <span class="hljs-number">8</span> (<span class="hljs-number">6</span>,<span class="hljs-literal">null</span>,<span class="hljs-literal">null</span>,<span class="hljs-literal">null</span>,<span class="hljs-literal">null</span>,<span class="hljs-literal">null</span>,<span class="hljs-literal">null</span>,<span class="hljs-number">7</span>)ã€‚</code></pre><p><strong>æ³¨æ„:</strong> ç­”æ¡ˆåœ¨32ä½æœ‰ç¬¦å·æ•´æ•°çš„è¡¨ç¤ºèŒƒå›´å†…ã€‚</p><pre><code class="hljs Java"></code></pre><pre><code class="hljs Go"></code></pre><pre><code class="hljs Python"></code></pre><h6 id="968-ç›‘æ§äºŒå‰æ ‘"><a href="#968-ç›‘æ§äºŒå‰æ ‘" class="headerlink" title="968. ç›‘æ§äºŒå‰æ ‘"></a><a href="https://leetcode-cn.com/problems/binary-tree-cameras/">968. ç›‘æ§äºŒå‰æ ‘</a></h6><p>ç»™å®šä¸€ä¸ªäºŒå‰æ ‘ï¼Œæˆ‘ä»¬åœ¨æ ‘çš„èŠ‚ç‚¹ä¸Šå®‰è£…æ‘„åƒå¤´ã€‚</p><p>èŠ‚ç‚¹ä¸Šçš„æ¯ä¸ªæ‘„å½±å¤´éƒ½å¯ä»¥ç›‘è§†<strong>å…¶çˆ¶å¯¹è±¡ã€è‡ªèº«åŠå…¶ç›´æ¥å­å¯¹è±¡ã€‚</strong></p><p>è®¡ç®—ç›‘æ§æ ‘çš„æ‰€æœ‰èŠ‚ç‚¹æ‰€éœ€çš„æœ€å°æ‘„åƒå¤´æ•°é‡ã€‚</p><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><p><img src="https://assets.leetcode-cn.com/aliyun-lc-upload/uploads/2018/12/29/bst_cameras_01.png"></p><pre><code class="hljs angelscript">è¾“å…¥ï¼š[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-literal">null</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>]è¾“å‡ºï¼š<span class="hljs-number">1</span>è§£é‡Šï¼šå¦‚å›¾æ‰€ç¤ºï¼Œä¸€å°æ‘„åƒå¤´è¶³ä»¥ç›‘æ§æ‰€æœ‰èŠ‚ç‚¹ã€‚</code></pre><p><strong>ç¤ºä¾‹ 2ï¼š</strong></p><p><img src="https://assets.leetcode-cn.com/aliyun-lc-upload/uploads/2018/12/29/bst_cameras_02.png"></p><pre><code class="hljs angelscript">è¾“å…¥ï¼š[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-literal">null</span>,<span class="hljs-number">0</span>,<span class="hljs-literal">null</span>,<span class="hljs-number">0</span>,<span class="hljs-literal">null</span>,<span class="hljs-literal">null</span>,<span class="hljs-number">0</span>]è¾“å‡ºï¼š<span class="hljs-number">2</span>è§£é‡Šï¼šéœ€è¦è‡³å°‘ä¸¤ä¸ªæ‘„åƒå¤´æ¥ç›‘è§†æ ‘çš„æ‰€æœ‰èŠ‚ç‚¹ã€‚ ä¸Šå›¾æ˜¾ç¤ºäº†æ‘„åƒå¤´æ”¾ç½®çš„æœ‰æ•ˆä½ç½®ä¹‹ä¸€ã€‚</code></pre><p><strong>æç¤ºï¼š</strong></p><ol><li>ç»™å®šæ ‘çš„èŠ‚ç‚¹æ•°çš„èŒƒå›´æ˜¯ <code>[1, 1000]</code>ã€‚</li><li>æ¯ä¸ªèŠ‚ç‚¹çš„å€¼éƒ½æ˜¯ 0ã€‚</li></ol><pre><code class="hljs Java"></code></pre><pre><code class="hljs Go"></code></pre><pre><code class="hljs Python"></code></pre><h4 id="å †ï¼ˆHeapï¼‰ä¸ä¼˜å…ˆé˜Ÿåˆ—"><a href="#å †ï¼ˆHeapï¼‰ä¸ä¼˜å…ˆé˜Ÿåˆ—" class="headerlink" title="å †ï¼ˆHeapï¼‰ä¸ä¼˜å…ˆé˜Ÿåˆ—"></a><strong>å †ï¼ˆHeapï¼‰ä¸ä¼˜å…ˆé˜Ÿåˆ—</strong></h4><blockquote><p>ç»´æŠ¤é›†åˆæœ€å€¼</p></blockquote><h5 id="åŸºç¡€åº”ç”¨"><a href="#åŸºç¡€åº”ç”¨" class="headerlink" title="åŸºç¡€åº”ç”¨"></a>åŸºç¡€åº”ç”¨</h5><h6 id="å‰‘æŒ‡-Offer-40-æœ€å°çš„kä¸ªæ•°"><a href="#å‰‘æŒ‡-Offer-40-æœ€å°çš„kä¸ªæ•°" class="headerlink" title="å‰‘æŒ‡ Offer 40. æœ€å°çš„kä¸ªæ•°"></a><a href="https://leetcode-cn.com/problems/zui-xiao-de-kge-shu-lcof/">å‰‘æŒ‡ Offer 40. æœ€å°çš„kä¸ªæ•°</a></h6><p>è¾“å…¥æ•´æ•°æ•°ç»„ <code>arr</code> ï¼Œæ‰¾å‡ºå…¶ä¸­æœ€å°çš„ <code>k</code> ä¸ªæ•°ã€‚ä¾‹å¦‚ï¼Œè¾“å…¥4ã€5ã€1ã€6ã€2ã€7ã€3ã€8è¿™8ä¸ªæ•°å­—ï¼Œåˆ™æœ€å°çš„4ä¸ªæ•°å­—æ˜¯1ã€2ã€3ã€4ã€‚</p><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><pre><code class="hljs angelscript">è¾“å…¥ï¼šarr = [<span class="hljs-number">3</span>,<span class="hljs-number">2</span>,<span class="hljs-number">1</span>], k = <span class="hljs-number">2</span>è¾“å‡ºï¼š[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>] æˆ–è€… [<span class="hljs-number">2</span>,<span class="hljs-number">1</span>]</code></pre><p><strong>ç¤ºä¾‹ 2ï¼š</strong></p><pre><code class="hljs angelscript">è¾“å…¥ï¼šarr = [<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">1</span>], k = <span class="hljs-number">1</span>è¾“å‡ºï¼š[<span class="hljs-number">0</span>]</code></pre><p><strong>é™åˆ¶ï¼š</strong></p><ul><li><code>0 &lt;= k &lt;= arr.length &lt;= 10000</code></li><li><code>0 &lt;= arr[i] &lt;= 10000</code></li></ul><pre><code class="hljs plain">å¤§é¡¶å †å †é¡¶ä¸ºkä¸ªæ•°çš„æœ€å¤§çš„éå†æ•°ç»„ï¼Œå…¥å † å¦‚æœå…¥å †åå †çš„å¤§å°å¤§äºkï¼Œå‡ºå †</code></pre><pre><code class="hljs Java"></code></pre><pre><code class="hljs Go"></code></pre><pre><code class="hljs Python"></code></pre><h6 id="1046-æœ€åä¸€å—çŸ³å¤´çš„é‡é‡"><a href="#1046-æœ€åä¸€å—çŸ³å¤´çš„é‡é‡" class="headerlink" title="1046. æœ€åä¸€å—çŸ³å¤´çš„é‡é‡"></a><a href="https://leetcode-cn.com/problems/last-stone-weight/">1046. æœ€åä¸€å—çŸ³å¤´çš„é‡é‡</a></h6><p>æœ‰ä¸€å †çŸ³å¤´ï¼Œæ¯å—çŸ³å¤´çš„é‡é‡éƒ½æ˜¯æ­£æ•´æ•°ã€‚</p><p>æ¯ä¸€å›åˆï¼Œä»ä¸­é€‰å‡ºä¸¤å— <strong>æœ€é‡çš„</strong> çŸ³å¤´ï¼Œç„¶åå°†å®ƒä»¬ä¸€èµ·ç²‰ç¢ã€‚å‡è®¾çŸ³å¤´çš„é‡é‡åˆ†åˆ«ä¸º x å’Œ yï¼Œä¸” x &lt;= yã€‚é‚£ä¹ˆç²‰ç¢çš„å¯èƒ½ç»“æœå¦‚ä¸‹ï¼š</p><ul><li>å¦‚æœ x == yï¼Œé‚£ä¹ˆä¸¤å—çŸ³å¤´éƒ½ä¼šè¢«å®Œå…¨ç²‰ç¢ï¼›</li><li>å¦‚æœ x != yï¼Œé‚£ä¹ˆé‡é‡ä¸º x çš„çŸ³å¤´å°†ä¼šå®Œå…¨ç²‰ç¢ï¼Œè€Œé‡é‡ä¸º y çš„çŸ³å¤´æ–°é‡é‡ä¸º y-xã€‚</li></ul><p>æœ€åï¼Œæœ€å¤šåªä¼šå‰©ä¸‹ä¸€å—çŸ³å¤´ã€‚è¿”å›æ­¤çŸ³å¤´çš„é‡é‡ã€‚å¦‚æœæ²¡æœ‰çŸ³å¤´å‰©ä¸‹ï¼Œå°±è¿”å› <code>0</code>ã€‚</p><p><strong>ç¤ºä¾‹ï¼š</strong></p><pre><code class="hljs angelscript">è¾“å…¥ï¼š[<span class="hljs-number">2</span>,<span class="hljs-number">7</span>,<span class="hljs-number">4</span>,<span class="hljs-number">1</span>,<span class="hljs-number">8</span>,<span class="hljs-number">1</span>]è¾“å‡ºï¼š<span class="hljs-number">1</span>è§£é‡Šï¼šå…ˆé€‰å‡º <span class="hljs-number">7</span> å’Œ <span class="hljs-number">8</span>ï¼Œå¾—åˆ° <span class="hljs-number">1</span>ï¼Œæ‰€ä»¥æ•°ç»„è½¬æ¢ä¸º [<span class="hljs-number">2</span>,<span class="hljs-number">4</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>]ï¼Œå†é€‰å‡º <span class="hljs-number">2</span> å’Œ <span class="hljs-number">4</span>ï¼Œå¾—åˆ° <span class="hljs-number">2</span>ï¼Œæ‰€ä»¥æ•°ç»„è½¬æ¢ä¸º [<span class="hljs-number">2</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>]ï¼Œæ¥ç€æ˜¯ <span class="hljs-number">2</span> å’Œ <span class="hljs-number">1</span>ï¼Œå¾—åˆ° <span class="hljs-number">1</span>ï¼Œæ‰€ä»¥æ•°ç»„è½¬æ¢ä¸º [<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>]ï¼Œæœ€åé€‰å‡º <span class="hljs-number">1</span> å’Œ <span class="hljs-number">1</span>ï¼Œå¾—åˆ° <span class="hljs-number">0</span>ï¼Œæœ€ç»ˆæ•°ç»„è½¬æ¢ä¸º [<span class="hljs-number">1</span>]ï¼Œè¿™å°±æ˜¯æœ€åå‰©ä¸‹é‚£å—çŸ³å¤´çš„é‡é‡ã€‚</code></pre><p><strong>æç¤ºï¼š</strong></p><ul><li><code>1 &lt;= stones.length &lt;= 30</code></li><li><code>1 &lt;= stones[i] &lt;= 1000</code></li></ul><pre><code class="hljs plain">å¤§é¡¶å †</code></pre><pre><code class="hljs Java"></code></pre><pre><code class="hljs Go"></code></pre><pre><code class="hljs Python"></code></pre><h6 id="703-æ•°æ®æµä¸­çš„ç¬¬-K-å¤§å…ƒç´ "><a href="#703-æ•°æ®æµä¸­çš„ç¬¬-K-å¤§å…ƒç´ " class="headerlink" title="703. æ•°æ®æµä¸­çš„ç¬¬ K å¤§å…ƒç´ "></a><a href="https://leetcode-cn.com/problems/kth-largest-element-in-a-stream/">703. æ•°æ®æµä¸­çš„ç¬¬ K å¤§å…ƒç´ </a></h6><p>è®¾è®¡ä¸€ä¸ªæ‰¾åˆ°æ•°æ®æµä¸­ç¬¬ <code>k</code> å¤§å…ƒç´ çš„ç±»<code>ï¼ˆclassï¼‰</code>ã€‚æ³¨æ„æ˜¯æ’åºåçš„ç¬¬ <code>k</code> å¤§å…ƒç´ ï¼Œä¸æ˜¯ç¬¬ <code>k</code> ä¸ªä¸åŒçš„å…ƒç´ ã€‚</p><p>è¯·å®ç° <code>KthLargest</code> ç±»ï¼š</p><ul><li><code>KthLargest(int k, int[] nums)</code> ä½¿ç”¨æ•´æ•° k å’Œæ•´æ•°æµ <code>nums </code>åˆå§‹åŒ–å¯¹è±¡ã€‚</li><li><code>int add(int val) </code>å°† val æ’å…¥æ•°æ®æµ <code>nums </code>åï¼Œè¿”å›å½“å‰æ•°æ®æµä¸­ç¬¬ <code>k</code> å¤§çš„å…ƒç´ ã€‚</li></ul><p><strong>ç¤ºä¾‹ï¼š</strong></p><pre><code class="hljs lsl">è¾“å…¥ï¼š[<span class="hljs-string">&quot;KthLargest&quot;</span>, <span class="hljs-string">&quot;add&quot;</span>, <span class="hljs-string">&quot;add&quot;</span>, <span class="hljs-string">&quot;add&quot;</span>, <span class="hljs-string">&quot;add&quot;</span>, <span class="hljs-string">&quot;add&quot;</span>][[<span class="hljs-number">3</span>, [<span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">8</span>, <span class="hljs-number">2</span>]], [<span class="hljs-number">3</span>], [<span class="hljs-number">5</span>], [<span class="hljs-number">10</span>], [<span class="hljs-number">9</span>], [<span class="hljs-number">4</span>]]è¾“å‡ºï¼š[null, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">5</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>]è§£é‡Šï¼šKthLargest kthLargest = new KthLargest(<span class="hljs-number">3</span>, [<span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">8</span>, <span class="hljs-number">2</span>]);kthLargest.add(<span class="hljs-number">3</span>);   <span class="hljs-comment">// return 4</span>kthLargest.add(<span class="hljs-number">5</span>);   <span class="hljs-comment">// return 5</span>kthLargest.add(<span class="hljs-number">10</span>);  <span class="hljs-comment">// return 5</span>kthLargest.add(<span class="hljs-number">9</span>);   <span class="hljs-comment">// return 8</span>kthLargest.add(<span class="hljs-number">4</span>);   <span class="hljs-comment">// return 8</span></code></pre><p><strong>æç¤ºï¼š</strong></p><ul><li><code>1 &lt;= k &lt;= 10^4</code></li><li><code>0 &lt;= nums.length &lt;= 10^4</code></li><li><code>-10^4 &lt;= nums[i] &lt;= 10^4</code></li><li><code>-10^4 &lt;= val &lt;= 10^4</code></li><li>æœ€å¤šè°ƒç”¨ add æ–¹æ³•<code> 10^4</code> æ¬¡</li><li>é¢˜ç›®æ•°æ®ä¿è¯ï¼Œåœ¨æŸ¥æ‰¾ç¬¬ k å¤§å…ƒç´ æ—¶ï¼Œæ•°ç»„ä¸­è‡³å°‘æœ‰ k ä¸ªå…ƒç´ </li></ul><pre><code class="hljs plain">å°é¡¶å †å †é¡¶ä¸ºkä¸ªæ•°çš„æœ€å¤§çš„</code></pre><pre><code class="hljs Java"></code></pre><pre><code class="hljs Go"></code></pre><pre><code class="hljs Python"></code></pre><h6 id="215-æ•°ç»„ä¸­çš„ç¬¬Kä¸ªæœ€å¤§å…ƒç´ "><a href="#215-æ•°ç»„ä¸­çš„ç¬¬Kä¸ªæœ€å¤§å…ƒç´ " class="headerlink" title="215. æ•°ç»„ä¸­çš„ç¬¬Kä¸ªæœ€å¤§å…ƒç´ "></a><a href="https://leetcode-cn.com/problems/kth-largest-element-in-an-array/">215. æ•°ç»„ä¸­çš„ç¬¬Kä¸ªæœ€å¤§å…ƒç´ </a></h6><p>åœ¨æœªæ’åºçš„æ•°ç»„ä¸­æ‰¾åˆ°ç¬¬ <strong>k</strong> ä¸ªæœ€å¤§çš„å…ƒç´ ã€‚è¯·æ³¨æ„ï¼Œä½ éœ€è¦æ‰¾çš„æ˜¯æ•°ç»„æ’åºåçš„ç¬¬ k ä¸ªæœ€å¤§çš„å…ƒç´ ï¼Œè€Œä¸æ˜¯ç¬¬ k ä¸ªä¸åŒçš„å…ƒç´ ã€‚</p><p><strong>ç¤ºä¾‹ 1:</strong></p><pre><code class="hljs angelscript">è¾“å…¥: [<span class="hljs-number">3</span>,<span class="hljs-number">2</span>,<span class="hljs-number">1</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">4</span>] å’Œ k = <span class="hljs-number">2</span>è¾“å‡º: <span class="hljs-number">5</span></code></pre><p><strong>ç¤ºä¾‹ 2:</strong></p><pre><code class="hljs angelscript">è¾“å…¥: [<span class="hljs-number">3</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>] å’Œ k = <span class="hljs-number">4</span>è¾“å‡º: <span class="hljs-number">4</span></code></pre><p><strong>è¯´æ˜:</strong></p><p>ä½ å¯ä»¥å‡è®¾ k æ€»æ˜¯æœ‰æ•ˆçš„ï¼Œä¸” 1 â‰¤ k â‰¤ æ•°ç»„çš„é•¿åº¦ã€‚</p><pre><code class="hljs Java"></code></pre><pre><code class="hljs Go"></code></pre><pre><code class="hljs Python"></code></pre><h5 id="373-æŸ¥æ‰¾å’Œæœ€å°çš„Kå¯¹æ•°å­—"><a href="#373-æŸ¥æ‰¾å’Œæœ€å°çš„Kå¯¹æ•°å­—" class="headerlink" title="373. æŸ¥æ‰¾å’Œæœ€å°çš„Kå¯¹æ•°å­—"></a><a href="https://leetcode-cn.com/problems/find-k-pairs-with-smallest-sums/">373. æŸ¥æ‰¾å’Œæœ€å°çš„Kå¯¹æ•°å­—</a></h5><p>ç»™å®šä¸¤ä¸ªä»¥å‡åºæ’åˆ—çš„æ•´å½¢æ•°ç»„ nums1 å’Œ nums2, ä»¥åŠä¸€ä¸ªæ•´æ•° kã€‚</p><p>å®šä¹‰ä¸€å¯¹å€¼ (u,v)ï¼Œå…¶ä¸­ç¬¬ä¸€ä¸ªå…ƒç´ æ¥è‡ª nums1ï¼Œç¬¬äºŒä¸ªå…ƒç´ æ¥è‡ª nums2ã€‚</p><p>æ‰¾åˆ°å’Œæœ€å°çš„ k å¯¹æ•°å­— (u1,v1), (u2,v2) â€¦ (uk,vk)ã€‚</p><p><strong>ç¤ºä¾‹ 1:</strong></p><pre><code class="hljs angelscript">è¾“å…¥: nums1 = [<span class="hljs-number">1</span>,<span class="hljs-number">7</span>,<span class="hljs-number">11</span>], nums2 = [<span class="hljs-number">2</span>,<span class="hljs-number">4</span>,<span class="hljs-number">6</span>], k = <span class="hljs-number">3</span>è¾“å‡º: [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>],[<span class="hljs-number">1</span>,<span class="hljs-number">4</span>],[<span class="hljs-number">1</span>,<span class="hljs-number">6</span>]è§£é‡Š: è¿”å›åºåˆ—ä¸­çš„å‰ <span class="hljs-number">3</span> å¯¹æ•°ï¼š<span class="hljs-string">     [1,2]</span>,[<span class="hljs-number">1</span>,<span class="hljs-number">4</span>],[<span class="hljs-number">1</span>,<span class="hljs-number">6</span>],[<span class="hljs-number">7</span>,<span class="hljs-number">2</span>],[<span class="hljs-number">7</span>,<span class="hljs-number">4</span>],[<span class="hljs-number">11</span>,<span class="hljs-number">2</span>],[<span class="hljs-number">7</span>,<span class="hljs-number">6</span>],[<span class="hljs-number">11</span>,<span class="hljs-number">4</span>],[<span class="hljs-number">11</span>,<span class="hljs-number">6</span>]</code></pre><p><strong>ç¤ºä¾‹ 2:</strong></p><pre><code class="hljs angelscript">è¾“å…¥: nums1 = [<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>], nums2 = [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>], k = <span class="hljs-number">2</span>è¾“å‡º: [<span class="hljs-number">1</span>,<span class="hljs-number">1</span>],[<span class="hljs-number">1</span>,<span class="hljs-number">1</span>]è§£é‡Š: è¿”å›åºåˆ—ä¸­çš„å‰ <span class="hljs-number">2</span> å¯¹æ•°ï¼š<span class="hljs-string">Â     [1,1]</span>,[<span class="hljs-number">1</span>,<span class="hljs-number">1</span>],[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>],[<span class="hljs-number">2</span>,<span class="hljs-number">1</span>],[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>],[<span class="hljs-number">2</span>,<span class="hljs-number">2</span>],[<span class="hljs-number">1</span>,<span class="hljs-number">3</span>],[<span class="hljs-number">1</span>,<span class="hljs-number">3</span>],[<span class="hljs-number">2</span>,<span class="hljs-number">3</span>]</code></pre><p><strong>ç¤ºä¾‹ 3:</strong></p><pre><code class="hljs angelscript">è¾“å…¥: nums1 = [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>], nums2 = [<span class="hljs-number">3</span>], k = <span class="hljs-number">3</span> è¾“å‡º: [<span class="hljs-number">1</span>,<span class="hljs-number">3</span>],[<span class="hljs-number">2</span>,<span class="hljs-number">3</span>]è§£é‡Š: ä¹Ÿå¯èƒ½åºåˆ—ä¸­æ‰€æœ‰çš„æ•°å¯¹éƒ½è¢«è¿”å›:[<span class="hljs-number">1</span>,<span class="hljs-number">3</span>],[<span class="hljs-number">2</span>,<span class="hljs-number">3</span>]</code></pre><pre><code class="hljs Java"></code></pre><pre><code class="hljs Go"></code></pre><pre><code class="hljs Python"></code></pre><h5 id="è¿›é˜¶åº”ç”¨"><a href="#è¿›é˜¶åº”ç”¨" class="headerlink" title="è¿›é˜¶åº”ç”¨"></a>è¿›é˜¶åº”ç”¨</h5><h6 id="692-å‰Kä¸ªé«˜é¢‘å•è¯"><a href="#692-å‰Kä¸ªé«˜é¢‘å•è¯" class="headerlink" title="692. å‰Kä¸ªé«˜é¢‘å•è¯"></a><a href="https://leetcode-cn.com/problems/top-k-frequent-words/">692. å‰Kä¸ªé«˜é¢‘å•è¯</a></h6><p>ç»™ä¸€éç©ºçš„å•è¯åˆ—è¡¨ï¼Œè¿”å›å‰ <em>k</em> ä¸ªå‡ºç°æ¬¡æ•°æœ€å¤šçš„å•è¯ã€‚</p><p>è¿”å›çš„ç­”æ¡ˆåº”è¯¥æŒ‰å•è¯å‡ºç°é¢‘ç‡ç”±é«˜åˆ°ä½æ’åºã€‚å¦‚æœä¸åŒçš„å•è¯æœ‰ç›¸åŒå‡ºç°é¢‘ç‡ï¼ŒæŒ‰å­—æ¯é¡ºåºæ’åºã€‚</p><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><pre><code class="hljs prolog">è¾“å…¥: [<span class="hljs-string">&quot;i&quot;</span>, <span class="hljs-string">&quot;love&quot;</span>, <span class="hljs-string">&quot;leetcode&quot;</span>, <span class="hljs-string">&quot;i&quot;</span>, <span class="hljs-string">&quot;love&quot;</span>, <span class="hljs-string">&quot;coding&quot;</span>], k = <span class="hljs-number">2</span>è¾“å‡º: [<span class="hljs-string">&quot;i&quot;</span>, <span class="hljs-string">&quot;love&quot;</span>]è§£æ: <span class="hljs-string">&quot;i&quot;</span> å’Œ <span class="hljs-string">&quot;love&quot;</span> ä¸ºå‡ºç°æ¬¡æ•°æœ€å¤šçš„ä¸¤ä¸ªå•è¯ï¼Œå‡ä¸º<span class="hljs-number">2</span>æ¬¡ã€‚    æ³¨æ„ï¼ŒæŒ‰å­—æ¯é¡ºåº <span class="hljs-string">&quot;i&quot;</span> åœ¨ <span class="hljs-string">&quot;love&quot;</span> ä¹‹å‰ã€‚</code></pre><p><strong>ç¤ºä¾‹ 2ï¼š</strong></p><pre><code class="hljs smalltalk">è¾“å…¥: [<span class="hljs-comment">&quot;the&quot;</span>, <span class="hljs-comment">&quot;day&quot;</span>, <span class="hljs-comment">&quot;is&quot;</span>, <span class="hljs-comment">&quot;sunny&quot;</span>, <span class="hljs-comment">&quot;the&quot;</span>, <span class="hljs-comment">&quot;the&quot;</span>, <span class="hljs-comment">&quot;the&quot;</span>, <span class="hljs-comment">&quot;sunny&quot;</span>, <span class="hljs-comment">&quot;is&quot;</span>, <span class="hljs-comment">&quot;is&quot;</span>], k = <span class="hljs-number">4</span>è¾“å‡º: [<span class="hljs-comment">&quot;the&quot;</span>, <span class="hljs-comment">&quot;is&quot;</span>, <span class="hljs-comment">&quot;sunny&quot;</span>, <span class="hljs-comment">&quot;day&quot;</span>]è§£æ: <span class="hljs-comment">&quot;the&quot;</span>, <span class="hljs-comment">&quot;is&quot;</span>, <span class="hljs-comment">&quot;sunny&quot;</span> å’Œ <span class="hljs-comment">&quot;day&quot;</span> æ˜¯å‡ºç°æ¬¡æ•°æœ€å¤šçš„å››ä¸ªå•è¯ï¼Œ    å‡ºç°æ¬¡æ•°ä¾æ¬¡ä¸º <span class="hljs-number">4</span>, <span class="hljs-number">3</span>, <span class="hljs-number">2</span> å’Œ <span class="hljs-number">1</span> æ¬¡ã€‚</code></pre><p><strong>æ³¨æ„ï¼š</strong></p><ol><li>å‡å®š <em>k</em> æ€»ä¸ºæœ‰æ•ˆå€¼ï¼Œ 1 â‰¤ <em>k</em> â‰¤ é›†åˆå…ƒç´ æ•°ã€‚</li><li>è¾“å…¥çš„å•è¯å‡ç”±å°å†™å­—æ¯ç»„æˆã€‚</li></ol><pre><code class="hljs Java"></code></pre><pre><code class="hljs Go"></code></pre><pre><code class="hljs Python"></code></pre><h6 id="å‰‘æŒ‡-Offer-41-æ•°æ®æµä¸­çš„ä¸­ä½æ•°"><a href="#å‰‘æŒ‡-Offer-41-æ•°æ®æµä¸­çš„ä¸­ä½æ•°" class="headerlink" title="å‰‘æŒ‡ Offer 41. æ•°æ®æµä¸­çš„ä¸­ä½æ•°"></a><a href="https://leetcode-cn.com/problems/shu-ju-liu-zhong-de-zhong-wei-shu-lcof/">å‰‘æŒ‡ Offer 41. æ•°æ®æµä¸­çš„ä¸­ä½æ•°</a></h6><p>å¦‚ä½•å¾—åˆ°ä¸€ä¸ªæ•°æ®æµä¸­çš„ä¸­ä½æ•°ï¼Ÿå¦‚æœä»æ•°æ®æµä¸­è¯»å‡ºå¥‡æ•°ä¸ªæ•°å€¼ï¼Œé‚£ä¹ˆä¸­ä½æ•°å°±æ˜¯æ‰€æœ‰æ•°å€¼æ’åºä¹‹åä½äºä¸­é—´çš„æ•°å€¼ã€‚å¦‚æœä»æ•°æ®æµä¸­è¯»å‡ºå¶æ•°ä¸ªæ•°å€¼ï¼Œé‚£ä¹ˆä¸­ä½æ•°å°±æ˜¯æ‰€æœ‰æ•°å€¼æ’åºä¹‹åä¸­é—´ä¸¤ä¸ªæ•°çš„å¹³å‡å€¼ã€‚</p><p>ä¾‹å¦‚ï¼Œ</p><p>[2,3,4] çš„ä¸­ä½æ•°æ˜¯ 3</p><p>[2,3] çš„ä¸­ä½æ•°æ˜¯ (2 + 3) / 2 = 2.5</p><p>è®¾è®¡ä¸€ä¸ªæ”¯æŒä»¥ä¸‹ä¸¤ç§æ“ä½œçš„æ•°æ®ç»“æ„ï¼š</p><ul><li>void addNum(int num) - ä»æ•°æ®æµä¸­æ·»åŠ ä¸€ä¸ªæ•´æ•°åˆ°æ•°æ®ç»“æ„ä¸­ã€‚</li><li>double findMedian() - è¿”å›ç›®å‰æ‰€æœ‰å…ƒç´ çš„ä¸­ä½æ•°ã€‚</li></ul><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><pre><code class="hljs prolog">è¾“å…¥ï¼š[<span class="hljs-string">&quot;MedianFinder&quot;</span>,<span class="hljs-string">&quot;addNum&quot;</span>,<span class="hljs-string">&quot;addNum&quot;</span>,<span class="hljs-string">&quot;findMedian&quot;</span>,<span class="hljs-string">&quot;addNum&quot;</span>,<span class="hljs-string">&quot;findMedian&quot;</span>][[],[<span class="hljs-number">1</span>],[<span class="hljs-number">2</span>],[],[<span class="hljs-number">3</span>],[]]è¾“å‡ºï¼š[null,null,null,<span class="hljs-number">1.50000</span>,null,<span class="hljs-number">2.00000</span>]</code></pre><p><strong>ç¤ºä¾‹ 2ï¼š</strong></p><pre><code class="hljs prolog">è¾“å…¥ï¼š[<span class="hljs-string">&quot;MedianFinder&quot;</span>,<span class="hljs-string">&quot;addNum&quot;</span>,<span class="hljs-string">&quot;findMedian&quot;</span>,<span class="hljs-string">&quot;addNum&quot;</span>,<span class="hljs-string">&quot;findMedian&quot;</span>][[],[<span class="hljs-number">2</span>],[],[<span class="hljs-number">3</span>],[]]è¾“å‡ºï¼š[null,null,<span class="hljs-number">2.00000</span>,null,<span class="hljs-number">2.50000</span>]</code></pre><h6 id="295-æ•°æ®æµçš„ä¸­ä½æ•°"><a href="#295-æ•°æ®æµçš„ä¸­ä½æ•°" class="headerlink" title="295. æ•°æ®æµçš„ä¸­ä½æ•°"></a><a href="https://leetcode-cn.com/problems/find-median-from-data-stream/">295. æ•°æ®æµçš„ä¸­ä½æ•°</a></h6><p>ä¸­ä½æ•°æ˜¯æœ‰åºåˆ—è¡¨ä¸­é—´çš„æ•°ã€‚å¦‚æœåˆ—è¡¨é•¿åº¦æ˜¯å¶æ•°ï¼Œä¸­ä½æ•°åˆ™æ˜¯ä¸­é—´ä¸¤ä¸ªæ•°çš„å¹³å‡å€¼ã€‚</p><p>ä¾‹å¦‚ï¼Œ</p><p>[2,3,4] çš„ä¸­ä½æ•°æ˜¯ 3</p><p>[2,3] çš„ä¸­ä½æ•°æ˜¯ (2 + 3) / 2 = 2.5</p><p>è®¾è®¡ä¸€ä¸ªæ”¯æŒä»¥ä¸‹ä¸¤ç§æ“ä½œçš„æ•°æ®ç»“æ„ï¼š</p><ul><li>void addNum(int num) - ä»æ•°æ®æµä¸­æ·»åŠ ä¸€ä¸ªæ•´æ•°åˆ°æ•°æ®ç»“æ„ä¸­ã€‚</li><li>double findMedian() - è¿”å›ç›®å‰æ‰€æœ‰å…ƒç´ çš„ä¸­ä½æ•°ã€‚</li></ul><p><strong>ç¤ºä¾‹ï¼š</strong></p><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">addNum</span><span class="hljs-params">(<span class="hljs-number">1</span>)</span></span><span class="hljs-function"><span class="hljs-title">addNum</span><span class="hljs-params">(<span class="hljs-number">2</span>)</span></span><span class="hljs-function"><span class="hljs-title">findMedian</span><span class="hljs-params">()</span></span> -&gt; <span class="hljs-number">1.5</span><span class="hljs-function"><span class="hljs-title">addNum</span><span class="hljs-params">(<span class="hljs-number">3</span>)</span></span> <span class="hljs-function"><span class="hljs-title">findMedian</span><span class="hljs-params">()</span></span> -&gt; <span class="hljs-number">2</span></code></pre><p>è¿›é˜¶:</p><ul><li>å¦‚æœæ•°æ®æµä¸­æ‰€æœ‰æ•´æ•°éƒ½åœ¨ 0 åˆ° 100 èŒƒå›´å†…ï¼Œä½ å°†å¦‚ä½•ä¼˜åŒ–ä½ çš„ç®—æ³•ï¼Ÿ</li><li>å¦‚æœæ•°æ®æµä¸­ 99% çš„æ•´æ•°éƒ½åœ¨ 0 åˆ° 100 èŒƒå›´å†…ï¼Œä½ å°†å¦‚ä½•ä¼˜åŒ–ä½ çš„ç®—æ³•ï¼Ÿ</li></ul><pre><code class="hljs plain">ä¸¤ä¸ªå †</code></pre><pre><code class="hljs Java"></code></pre><pre><code class="hljs Go"></code></pre><pre><code class="hljs Python"></code></pre><h6 id="355-è®¾è®¡æ¨ç‰¹"><a href="#355-è®¾è®¡æ¨ç‰¹" class="headerlink" title="355. è®¾è®¡æ¨ç‰¹"></a><a href="https://leetcode-cn.com/problems/design-twitter/">355. è®¾è®¡æ¨ç‰¹</a></h6><p>è®¾è®¡ä¸€ä¸ªç®€åŒ–ç‰ˆçš„æ¨ç‰¹(Twitter)ï¼Œå¯ä»¥è®©ç”¨æˆ·å®ç°å‘é€æ¨æ–‡ï¼Œå…³æ³¨/å–æ¶ˆå…³æ³¨å…¶ä»–ç”¨æˆ·ï¼Œèƒ½å¤Ÿçœ‹è§å…³æ³¨äººï¼ˆåŒ…æ‹¬è‡ªå·±ï¼‰çš„æœ€è¿‘åæ¡æ¨æ–‡ã€‚ä½ çš„è®¾è®¡éœ€è¦æ”¯æŒä»¥ä¸‹çš„å‡ ä¸ªåŠŸèƒ½</p><ul><li><code>postTweet(userId, tweetId)</code>: åˆ›å»ºä¸€æ¡æ–°çš„æ¨æ–‡</li><li><code>getNewsFeed(userId)</code>: æ£€ç´¢æœ€è¿‘çš„åæ¡æ¨æ–‡ã€‚æ¯ä¸ªæ¨æ–‡éƒ½å¿…é¡»æ˜¯ç”±æ­¤ç”¨æˆ·å…³æ³¨çš„äººæˆ–è€…æ˜¯ç”¨æˆ·è‡ªå·±å‘å‡ºçš„ã€‚æ¨æ–‡å¿…é¡»æŒ‰ç…§æ—¶é—´é¡ºåºç”±æœ€è¿‘çš„å¼€å§‹æ’åºã€‚</li><li><code>follow(followerId, followeeId)</code>: å…³æ³¨ä¸€ä¸ªç”¨æˆ·</li><li><code>unfollow(followerId, followeeId)</code>: å–æ¶ˆå…³æ³¨ä¸€ä¸ªç”¨æˆ·</li></ul><p><strong>ç¤ºä¾‹:</strong></p><pre><code class="hljs angelscript">Twitter twitter = new Twitter();<span class="hljs-comment">// ç”¨æˆ·1å‘é€äº†ä¸€æ¡æ–°æ¨æ–‡ (ç”¨æˆ·id = 1, æ¨æ–‡id = 5).</span>twitter.postTweet(<span class="hljs-number">1</span>, <span class="hljs-number">5</span>);<span class="hljs-comment">// ç”¨æˆ·1çš„è·å–æ¨æ–‡åº”å½“è¿”å›ä¸€ä¸ªåˆ—è¡¨ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªidä¸º5çš„æ¨æ–‡.</span>twitter.getNewsFeed(<span class="hljs-number">1</span>);<span class="hljs-comment">// ç”¨æˆ·1å…³æ³¨äº†ç”¨æˆ·2.</span>twitter.follow(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>);<span class="hljs-comment">// ç”¨æˆ·2å‘é€äº†ä¸€ä¸ªæ–°æ¨æ–‡ (æ¨æ–‡id = 6).</span>twitter.postTweet(<span class="hljs-number">2</span>, <span class="hljs-number">6</span>);<span class="hljs-comment">// ç”¨æˆ·1çš„è·å–æ¨æ–‡åº”å½“è¿”å›ä¸€ä¸ªåˆ—è¡¨ï¼Œå…¶ä¸­åŒ…å«ä¸¤ä¸ªæ¨æ–‡ï¼Œidåˆ†åˆ«ä¸º -&gt; [6, 5].</span><span class="hljs-comment">// æ¨æ–‡id6åº”å½“åœ¨æ¨æ–‡id5ä¹‹å‰ï¼Œå› ä¸ºå®ƒæ˜¯åœ¨5ä¹‹åå‘é€çš„.</span>twitter.getNewsFeed(<span class="hljs-number">1</span>);<span class="hljs-comment">// ç”¨æˆ·1å–æ¶ˆå…³æ³¨äº†ç”¨æˆ·2.</span>twitter.unfollow(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>);<span class="hljs-comment">// ç”¨æˆ·1çš„è·å–æ¨æ–‡åº”å½“è¿”å›ä¸€ä¸ªåˆ—è¡¨ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªidä¸º5çš„æ¨æ–‡.</span><span class="hljs-comment">// å› ä¸ºç”¨æˆ·1å·²ç»ä¸å†å…³æ³¨ç”¨æˆ·2.</span>twitter.getNewsFeed(<span class="hljs-number">1</span>);</code></pre><pre><code class="hljs Java"></code></pre><pre><code class="hljs Go"></code></pre><pre><code class="hljs Python"></code></pre><h6 id="é¢è¯•é¢˜-17-20-è¿ç»­ä¸­å€¼"><a href="#é¢è¯•é¢˜-17-20-è¿ç»­ä¸­å€¼" class="headerlink" title="é¢è¯•é¢˜ 17.20. è¿ç»­ä¸­å€¼"></a><a href="https://leetcode-cn.com/problems/continuous-median-lcci/">é¢è¯•é¢˜ 17.20. è¿ç»­ä¸­å€¼</a></h6><p>éšæœºäº§ç”Ÿæ•°å­—å¹¶ä¼ é€’ç»™ä¸€ä¸ªæ–¹æ³•ã€‚ä½ èƒ½å¦å®Œæˆè¿™ä¸ªæ–¹æ³•ï¼Œåœ¨æ¯æ¬¡äº§ç”Ÿæ–°å€¼æ—¶ï¼Œå¯»æ‰¾å½“å‰æ‰€æœ‰å€¼çš„ä¸­é—´å€¼ï¼ˆä¸­ä½æ•°ï¼‰å¹¶ä¿å­˜ã€‚</p><p>ä¸­ä½æ•°æ˜¯æœ‰åºåˆ—è¡¨ä¸­é—´çš„æ•°ã€‚å¦‚æœåˆ—è¡¨é•¿åº¦æ˜¯å¶æ•°ï¼Œä¸­ä½æ•°åˆ™æ˜¯ä¸­é—´ä¸¤ä¸ªæ•°çš„å¹³å‡å€¼ã€‚</p><p>ä¾‹å¦‚ï¼Œ</p><p>[2,3,4] çš„ä¸­ä½æ•°æ˜¯ 3</p><p>[2,3] çš„ä¸­ä½æ•°æ˜¯ (2 + 3) / 2 = 2.5</p><p>è®¾è®¡ä¸€ä¸ªæ”¯æŒä»¥ä¸‹ä¸¤ç§æ“ä½œçš„æ•°æ®ç»“æ„ï¼š</p><ul><li>void addNum(int num) - ä»æ•°æ®æµä¸­æ·»åŠ ä¸€ä¸ªæ•´æ•°åˆ°æ•°æ®ç»“æ„ä¸­ã€‚</li><li>double findMedian() - è¿”å›ç›®å‰æ‰€æœ‰å…ƒç´ çš„ä¸­ä½æ•°ã€‚</li></ul><p><strong>ç¤ºä¾‹ï¼š</strong></p> <pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">addNum</span><span class="hljs-params">(<span class="hljs-number">1</span>)</span></span><span class="hljs-function"><span class="hljs-title">addNum</span><span class="hljs-params">(<span class="hljs-number">2</span>)</span></span><span class="hljs-function"><span class="hljs-title">findMedian</span><span class="hljs-params">()</span></span> -&gt; <span class="hljs-number">1.5</span><span class="hljs-function"><span class="hljs-title">addNum</span><span class="hljs-params">(<span class="hljs-number">3</span>)</span></span> <span class="hljs-function"><span class="hljs-title">findMedian</span><span class="hljs-params">()</span></span> -&gt; <span class="hljs-number">2</span></code></pre><pre><code class="hljs Java"></code></pre><pre><code class="hljs Go"></code></pre><pre><code class="hljs Python"></code></pre><h6 id="1801-ç§¯å‹è®¢å•ä¸­çš„è®¢å•æ€»æ•°"><a href="#1801-ç§¯å‹è®¢å•ä¸­çš„è®¢å•æ€»æ•°" class="headerlink" title="1801. ç§¯å‹è®¢å•ä¸­çš„è®¢å•æ€»æ•°"></a><a href="https://leetcode-cn.com/problems/number-of-orders-in-the-backlog/">1801. ç§¯å‹è®¢å•ä¸­çš„è®¢å•æ€»æ•°</a></h6><p>ç»™ä½ ä¸€ä¸ªäºŒç»´æ•´æ•°æ•°ç»„ <code>orders</code> ï¼Œå…¶ä¸­æ¯ä¸ª <code>orders[i] = [pricei, amounti, orderTypei] </code>è¡¨ç¤ºæœ‰ <code>amounti </code>ç¬”ç±»å‹ä¸º <code>orderTypei </code>ã€ä»·æ ¼ä¸º<code> pricei</code> çš„è®¢å•ã€‚</p><p>è®¢å•ç±»å‹ <code>orderTypei</code> å¯ä»¥åˆ†ä¸ºä¸¤ç§ï¼š</p><ul><li><code>0</code> è¡¨ç¤ºè¿™æ˜¯ä¸€æ‰¹é‡‡è´­è®¢å• <code>buy</code></li><li><code>1</code> è¡¨ç¤ºè¿™æ˜¯ä¸€æ‰¹é”€å”®è®¢å• <code>sell</code></li></ul><p>æ³¨æ„ï¼Œorders[i] è¡¨ç¤ºä¸€æ‰¹å…±è®¡ amounti ç¬”çš„ç‹¬ç«‹è®¢å•ï¼Œè¿™äº›è®¢å•çš„ä»·æ ¼å’Œç±»å‹ç›¸åŒã€‚å¯¹äºæ‰€æœ‰æœ‰æ•ˆçš„ i ï¼Œç”± orders[i] è¡¨ç¤ºçš„æ‰€æœ‰è®¢å•æäº¤æ—¶é—´å‡æ—©äº orders[i+1] è¡¨ç¤ºçš„æ‰€æœ‰è®¢å•ã€‚</p><p>å­˜åœ¨ç”±æœªæ‰§è¡Œè®¢å•ç»„æˆçš„ <strong>ç§¯å‹è®¢å•</strong> ã€‚ç§¯å‹è®¢å•æœ€åˆæ˜¯ç©ºçš„ã€‚æäº¤è®¢å•æ—¶ï¼Œä¼šå‘ç”Ÿä»¥ä¸‹æƒ…å†µï¼š</p><ul><li>å¦‚æœè¯¥è®¢å•æ˜¯ä¸€ç¬”é‡‡è´­è®¢å• buy ï¼Œåˆ™å¯ä»¥æŸ¥çœ‹ç§¯å‹è®¢å•ä¸­ä»·æ ¼ æœ€ä½ çš„é”€å”®è®¢å• sell ã€‚å¦‚æœè¯¥é”€å”®è®¢å• sell çš„ä»·æ ¼ ä½äºæˆ–ç­‰äº å½“å‰é‡‡è´­è®¢å• buy çš„ä»·æ ¼ï¼Œåˆ™åŒ¹é…å¹¶æ‰§è¡Œè¿™ä¸¤ç¬”è®¢å•ï¼Œå¹¶å°†é”€å”®è®¢å• sell ä»ç§¯å‹è®¢å•ä¸­åˆ é™¤ã€‚å¦åˆ™ï¼Œé‡‡è´­è®¢å• buy å°†ä¼šæ·»åŠ åˆ°ç§¯å‹è®¢å•ä¸­ã€‚</li><li>åä¹‹äº¦ç„¶ï¼Œå¦‚æœè¯¥è®¢å•æ˜¯ä¸€ç¬”é”€å”®è®¢å• sell ï¼Œåˆ™å¯ä»¥æŸ¥çœ‹ç§¯å‹è®¢å•ä¸­ä»·æ ¼ æœ€é«˜ çš„é‡‡è´­è®¢å• buy ã€‚å¦‚æœè¯¥é‡‡è´­è®¢å• buy çš„ä»·æ ¼ é«˜äºæˆ–ç­‰äº å½“å‰é”€å”®è®¢å• sell çš„ä»·æ ¼ï¼Œåˆ™åŒ¹é…å¹¶æ‰§è¡Œè¿™ä¸¤ç¬”è®¢å•ï¼Œå¹¶å°†é‡‡è´­è®¢å• buy ä»ç§¯å‹è®¢å•ä¸­åˆ é™¤ã€‚å¦åˆ™ï¼Œé”€å”®è®¢å• sell å°†ä¼šæ·»åŠ åˆ°ç§¯å‹è®¢å•ä¸­ã€‚</li></ul><p>è¾“å…¥æ‰€æœ‰è®¢å•åï¼Œè¿”å›ç§¯å‹è®¢å•ä¸­çš„ <strong>è®¢å•æ€»æ•°</strong> ã€‚ç”±äºæ•°å­—å¯èƒ½å¾ˆå¤§ï¼Œæ‰€ä»¥éœ€è¦è¿”å›å¯¹ <code>109 + 7</code> å–ä½™çš„ç»“æœã€‚</p><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><p><img src="https://assets.leetcode-cn.com/aliyun-lc-upload/uploads/2021/03/21/ex1.png"></p><pre><code class="hljs angelscript">è¾“å…¥ï¼šorders = [[<span class="hljs-number">10</span>,<span class="hljs-number">5</span>,<span class="hljs-number">0</span>],[<span class="hljs-number">15</span>,<span class="hljs-number">2</span>,<span class="hljs-number">1</span>],[<span class="hljs-number">25</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>],[<span class="hljs-number">30</span>,<span class="hljs-number">4</span>,<span class="hljs-number">0</span>]]è¾“å‡ºï¼š<span class="hljs-number">6</span>è§£é‡Šï¼šè¾“å…¥è®¢å•åä¼šå‘ç”Ÿä¸‹è¿°æƒ…å†µï¼š- æäº¤ <span class="hljs-number">5</span> ç¬”é‡‡è´­è®¢å•ï¼Œä»·æ ¼ä¸º <span class="hljs-number">10</span> ã€‚æ²¡æœ‰é”€å”®è®¢å•ï¼Œæ‰€ä»¥è¿™ <span class="hljs-number">5</span> ç¬”è®¢å•æ·»åŠ åˆ°ç§¯å‹è®¢å•ä¸­ã€‚- æäº¤ <span class="hljs-number">2</span> ç¬”é”€å”®è®¢å•ï¼Œä»·æ ¼ä¸º <span class="hljs-number">15</span> ã€‚æ²¡æœ‰é‡‡è´­è®¢å•çš„ä»·æ ¼å¤§äºæˆ–ç­‰äº <span class="hljs-number">15</span> ï¼Œæ‰€ä»¥è¿™ <span class="hljs-number">2</span> ç¬”è®¢å•æ·»åŠ åˆ°ç§¯å‹è®¢å•ä¸­ã€‚- æäº¤ <span class="hljs-number">1</span> ç¬”é”€å”®è®¢å•ï¼Œä»·æ ¼ä¸º <span class="hljs-number">25</span> ã€‚æ²¡æœ‰é‡‡è´­è®¢å•çš„ä»·æ ¼å¤§äºæˆ–ç­‰äº <span class="hljs-number">25</span> ï¼Œæ‰€ä»¥è¿™ <span class="hljs-number">1</span> ç¬”è®¢å•æ·»åŠ åˆ°ç§¯å‹è®¢å•ä¸­ã€‚- æäº¤ <span class="hljs-number">4</span> ç¬”é‡‡è´­è®¢å•ï¼Œä»·æ ¼ä¸º <span class="hljs-number">30</span> ã€‚å‰ <span class="hljs-number">2</span> ç¬”é‡‡è´­è®¢å•ä¸ä»·æ ¼æœ€ä½ï¼ˆä»·æ ¼ä¸º <span class="hljs-number">15</span>ï¼‰çš„ <span class="hljs-number">2</span> ç¬”é”€å”®è®¢å•åŒ¹é…ï¼Œä»ç§¯å‹è®¢å•ä¸­åˆ é™¤è¿™ <span class="hljs-number">2</span> ç¬”é”€å”®è®¢å•ã€‚ç¬¬ <span class="hljs-number">3</span> ç¬”é‡‡è´­è®¢å•ä¸ä»·æ ¼æœ€ä½çš„ <span class="hljs-number">1</span> ç¬”é”€å”®è®¢å•åŒ¹é…ï¼Œé”€å”®è®¢å•ä»·æ ¼ä¸º <span class="hljs-number">25</span> ï¼Œä»ç§¯å‹è®¢å•ä¸­åˆ é™¤è¿™ <span class="hljs-number">1</span> ç¬”é”€å”®è®¢å•ã€‚ç§¯å‹è®¢å•ä¸­ä¸å­˜åœ¨æ›´å¤šé”€å”®è®¢å•ï¼Œæ‰€ä»¥ç¬¬ <span class="hljs-number">4</span> ç¬”é‡‡è´­è®¢å•éœ€è¦æ·»åŠ åˆ°ç§¯å‹è®¢å•ä¸­ã€‚æœ€ç»ˆï¼Œç§¯å‹è®¢å•ä¸­æœ‰ <span class="hljs-number">5</span> ç¬”ä»·æ ¼ä¸º <span class="hljs-number">10</span> çš„é‡‡è´­è®¢å•ï¼Œå’Œ <span class="hljs-number">1</span> ç¬”ä»·æ ¼ä¸º <span class="hljs-number">30</span> çš„é‡‡è´­è®¢å•ã€‚æ‰€ä»¥ç§¯å‹è®¢å•ä¸­çš„è®¢å•æ€»æ•°ä¸º <span class="hljs-number">6</span> ã€‚</code></pre><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><p><img src="https://assets.leetcode-cn.com/aliyun-lc-upload/uploads/2021/03/21/ex2.png"></p><pre><code class="hljs angelscript">è¾“å…¥ï¼šorders = [[<span class="hljs-number">7</span>,<span class="hljs-number">1000000000</span>,<span class="hljs-number">1</span>],[<span class="hljs-number">15</span>,<span class="hljs-number">3</span>,<span class="hljs-number">0</span>],[<span class="hljs-number">5</span>,<span class="hljs-number">999999995</span>,<span class="hljs-number">0</span>],[<span class="hljs-number">5</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>]]è¾“å‡ºï¼š<span class="hljs-number">999999984</span>è§£é‡Šï¼šè¾“å…¥è®¢å•åä¼šå‘ç”Ÿä¸‹è¿°æƒ…å†µï¼š- æäº¤ <span class="hljs-number">109</span> ç¬”é”€å”®è®¢å•ï¼Œä»·æ ¼ä¸º <span class="hljs-number">7</span> ã€‚æ²¡æœ‰é‡‡è´­è®¢å•ï¼Œæ‰€ä»¥è¿™ <span class="hljs-number">109</span> ç¬”è®¢å•æ·»åŠ åˆ°ç§¯å‹è®¢å•ä¸­ã€‚- æäº¤ <span class="hljs-number">3</span> ç¬”é‡‡è´­è®¢å•ï¼Œä»·æ ¼ä¸º <span class="hljs-number">15</span> ã€‚è¿™äº›é‡‡è´­è®¢å•ä¸ä»·æ ¼æœ€ä½ï¼ˆä»·æ ¼ä¸º <span class="hljs-number">7</span> ï¼‰çš„ <span class="hljs-number">3</span> ç¬”é”€å”®è®¢å•åŒ¹é…ï¼Œä»ç§¯å‹è®¢å•ä¸­åˆ é™¤è¿™ <span class="hljs-number">3</span> ç¬”é”€å”®è®¢å•ã€‚- æäº¤ <span class="hljs-number">999999995</span> ç¬”é‡‡è´­è®¢å•ï¼Œä»·æ ¼ä¸º <span class="hljs-number">5</span> ã€‚é”€å”®è®¢å•çš„æœ€ä½ä»·ä¸º <span class="hljs-number">7</span> ï¼Œæ‰€ä»¥è¿™ <span class="hljs-number">999999995</span> ç¬”è®¢å•æ·»åŠ åˆ°ç§¯å‹è®¢å•ä¸­ã€‚- æäº¤ <span class="hljs-number">1</span> ç¬”é”€å”®è®¢å•ï¼Œä»·æ ¼ä¸º <span class="hljs-number">5</span> ã€‚è¿™ç¬”é”€å”®è®¢å•ä¸ä»·æ ¼æœ€é«˜ï¼ˆä»·æ ¼ä¸º <span class="hljs-number">5</span> ï¼‰çš„ <span class="hljs-number">1</span> ç¬”é‡‡è´­è®¢å•åŒ¹é…ï¼Œä»ç§¯å‹è®¢å•ä¸­åˆ é™¤è¿™ <span class="hljs-number">1</span> ç¬”é‡‡è´­è®¢å•ã€‚æœ€ç»ˆï¼Œç§¯å‹è®¢å•ä¸­æœ‰ (<span class="hljs-number">1000000000</span><span class="hljs-number">-3</span>) ç¬”ä»·æ ¼ä¸º <span class="hljs-number">7</span> çš„é”€å”®è®¢å•ï¼Œå’Œ (<span class="hljs-number">999999995</span><span class="hljs-number">-1</span>) ç¬”ä»·æ ¼ä¸º <span class="hljs-number">5</span> çš„é‡‡è´­è®¢å•ã€‚æ‰€ä»¥ç§¯å‹è®¢å•ä¸­çš„è®¢å•æ€»æ•°ä¸º <span class="hljs-number">1999999991</span> ï¼Œç­‰äº <span class="hljs-number">999999984</span> % (<span class="hljs-number">109</span> + <span class="hljs-number">7</span>) ã€‚</code></pre><p>æç¤ºï¼š</p><ul><li><code>1 &lt;= orders.length &lt;= 10^5</code></li><li><code>orders[i].length == 3</code></li><li><code>1 &lt;= pricei, amounti &lt;= 10^9</code></li><li><code>orderTypei ä¸º 0 æˆ– 1</code></li></ul><pre><code class="hljs Java"></code></pre><pre><code class="hljs Go"></code></pre><pre><code class="hljs Python"></code></pre><h5 id="æ™ºåŠ›é¢˜"><a href="#æ™ºåŠ›é¢˜" class="headerlink" title="æ™ºåŠ›é¢˜"></a>æ™ºåŠ›é¢˜</h5><h6 id="264-ä¸‘æ•°-II"><a href="#264-ä¸‘æ•°-II" class="headerlink" title="264. ä¸‘æ•° II"></a><a href="https://leetcode-cn.com/problems/ugly-number-ii/">264. ä¸‘æ•° II</a></h6><p>ç¼–å†™ä¸€ä¸ªç¨‹åºï¼Œæ‰¾å‡ºç¬¬ <code>n</code> ä¸ªä¸‘æ•°ã€‚</p><p>ä¸‘æ•°å°±æ˜¯è´¨å› æ•°åªåŒ…å« <code>2, 3, 5</code> çš„<strong>æ­£æ•´æ•°</strong>ã€‚</p><p><strong>ç¤ºä¾‹:</strong></p><pre><code class="hljs angelscript">è¾“å…¥: n = <span class="hljs-number">10</span>è¾“å‡º: <span class="hljs-number">12</span>è§£é‡Š: <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">8</span>, <span class="hljs-number">9</span>, <span class="hljs-number">10</span>, <span class="hljs-number">12</span> æ˜¯å‰ <span class="hljs-number">10</span> ä¸ªä¸‘æ•°ã€‚</code></pre><p><strong>è¯´æ˜:</strong> </p><ol><li><code>1</code> æ˜¯ä¸‘æ•°ã€‚</li><li><code>n</code> <strong>ä¸è¶…è¿‡</strong>1690ã€‚</li></ol><pre><code class="hljs Java"></code></pre><pre><code class="hljs Go"></code></pre><pre><code class="hljs Python"></code></pre><h6 id="313-è¶…çº§ä¸‘æ•°"><a href="#313-è¶…çº§ä¸‘æ•°" class="headerlink" title="313. è¶…çº§ä¸‘æ•°"></a><a href="https://leetcode-cn.com/problems/super-ugly-number/">313. è¶…çº§ä¸‘æ•°</a></h6><p>ç¼–å†™ä¸€æ®µç¨‹åºæ¥æŸ¥æ‰¾ç¬¬ <code>*n*</code> ä¸ªè¶…çº§ä¸‘æ•°ã€‚</p><p>è¶…çº§ä¸‘æ•°æ˜¯æŒ‡å…¶æ‰€æœ‰è´¨å› æ•°éƒ½æ˜¯é•¿åº¦ä¸º <code>k</code> çš„è´¨æ•°åˆ—è¡¨ <code>primes</code> ä¸­çš„æ­£æ•´æ•°ã€‚</p><p><strong>ç¤ºä¾‹:</strong></p><pre><code class="hljs angelscript">è¾“å…¥: n = <span class="hljs-number">12</span>, primes = [<span class="hljs-number">2</span>,<span class="hljs-number">7</span>,<span class="hljs-number">13</span>,<span class="hljs-number">19</span>]è¾“å‡º: <span class="hljs-number">32</span> è§£é‡Š: ç»™å®šé•¿åº¦ä¸º <span class="hljs-number">4</span> çš„è´¨æ•°åˆ—è¡¨ primes = [<span class="hljs-number">2</span>,<span class="hljs-number">7</span>,<span class="hljs-number">13</span>,<span class="hljs-number">19</span>]ï¼Œå‰ <span class="hljs-number">12</span> ä¸ªè¶…çº§ä¸‘æ•°åºåˆ—ä¸ºï¼š[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">4</span>,<span class="hljs-number">7</span>,<span class="hljs-number">8</span>,<span class="hljs-number">13</span>,<span class="hljs-number">14</span>,<span class="hljs-number">16</span>,<span class="hljs-number">19</span>,<span class="hljs-number">26</span>,<span class="hljs-number">28</span>,<span class="hljs-number">32</span>] ã€‚</code></pre><p>è¯´æ˜:</p><ul><li>1 æ˜¯ä»»ä½•ç»™å®š primes çš„è¶…çº§ä¸‘æ•°ã€‚</li><li> ç»™å®š primes ä¸­çš„æ•°å­—ä»¥å‡åºæ’åˆ—ã€‚</li><li>0 &lt; k â‰¤ 100, 0 &lt; n â‰¤ 10^6, 0 &lt; primes[i] &lt; 1000 ã€‚</li><li>ç¬¬ n ä¸ªè¶…çº§ä¸‘æ•°ç¡®ä¿åœ¨ 32 ä½æœ‰ç¬¦æ•´æ•°èŒƒå›´å†…ã€‚</li></ul><pre><code class="hljs Java"></code></pre><pre><code class="hljs Go"></code></pre><pre><code class="hljs Python"></code></pre><h6 id="1753-ç§»é™¤çŸ³å­çš„æœ€å¤§å¾—åˆ†"><a href="#1753-ç§»é™¤çŸ³å­çš„æœ€å¤§å¾—åˆ†" class="headerlink" title="1753. ç§»é™¤çŸ³å­çš„æœ€å¤§å¾—åˆ†"></a><a href="https://leetcode-cn.com/problems/maximum-score-from-removing-stones/">1753. ç§»é™¤çŸ³å­çš„æœ€å¤§å¾—åˆ†</a></h6><p>ä½ æ­£åœ¨ç©ä¸€ä¸ªå•äººæ¸¸æˆï¼Œé¢å‰æ”¾ç½®ç€å¤§å°åˆ†åˆ«ä¸º <code>a</code>ã€<code>b</code> å’Œ <code>c</code> çš„ <strong>ä¸‰å †</strong> çŸ³å­ã€‚</p><p>æ¯å›åˆä½ éƒ½è¦ä»ä¸¤ä¸ª <strong>ä¸åŒçš„éç©ºå †</strong> ä¸­å–å‡ºä¸€é¢—çŸ³å­ï¼Œå¹¶åœ¨å¾—åˆ†ä¸ŠåŠ  <code>1</code> åˆ†ã€‚å½“å­˜åœ¨ <strong>ä¸¤ä¸ªæˆ–æ›´å¤š</strong> çš„ç©ºå †æ—¶ï¼Œæ¸¸æˆåœæ­¢ã€‚</p><p>ç»™ä½ ä¸‰ä¸ªæ•´æ•° <code>a</code> ã€<code>b</code> å’Œ <code>c</code> ï¼Œè¿”å›å¯ä»¥å¾—åˆ°çš„ <strong>æœ€å¤§åˆ†æ•°</strong> ã€‚</p><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><pre><code class="hljs angelscript">è¾“å…¥ï¼ša = <span class="hljs-number">2</span>, b = <span class="hljs-number">4</span>, c = <span class="hljs-number">6</span>è¾“å‡ºï¼š<span class="hljs-number">6</span>è§£é‡Šï¼šçŸ³å­èµ·å§‹çŠ¶æ€æ˜¯ (<span class="hljs-number">2</span>, <span class="hljs-number">4</span>, <span class="hljs-number">6</span>) ï¼Œæœ€ä¼˜çš„ä¸€ç»„æ“ä½œæ˜¯ï¼š- ä»ç¬¬ä¸€å’Œç¬¬ä¸‰å †å–ï¼ŒçŸ³å­çŠ¶æ€ç°åœ¨æ˜¯ (<span class="hljs-number">1</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>)- ä»ç¬¬ä¸€å’Œç¬¬ä¸‰å †å–ï¼ŒçŸ³å­çŠ¶æ€ç°åœ¨æ˜¯ (<span class="hljs-number">0</span>, <span class="hljs-number">4</span>, <span class="hljs-number">4</span>)- ä»ç¬¬äºŒå’Œç¬¬ä¸‰å †å–ï¼ŒçŸ³å­çŠ¶æ€ç°åœ¨æ˜¯ (<span class="hljs-number">0</span>, <span class="hljs-number">3</span>, <span class="hljs-number">3</span>)- ä»ç¬¬äºŒå’Œç¬¬ä¸‰å †å–ï¼ŒçŸ³å­çŠ¶æ€ç°åœ¨æ˜¯ (<span class="hljs-number">0</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>)- ä»ç¬¬äºŒå’Œç¬¬ä¸‰å †å–ï¼ŒçŸ³å­çŠ¶æ€ç°åœ¨æ˜¯ (<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>)- ä»ç¬¬äºŒå’Œç¬¬ä¸‰å †å–ï¼ŒçŸ³å­çŠ¶æ€ç°åœ¨æ˜¯ (<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>)æ€»åˆ†ï¼š<span class="hljs-number">6</span> åˆ† ã€‚</code></pre><p><strong>ç¤ºä¾‹ 2ï¼š</strong></p><pre><code class="hljs angelscript">è¾“å…¥ï¼ša = <span class="hljs-number">4</span>, b = <span class="hljs-number">4</span>, c = <span class="hljs-number">6</span>è¾“å‡ºï¼š<span class="hljs-number">7</span>è§£é‡Šï¼šçŸ³å­èµ·å§‹çŠ¶æ€æ˜¯ (<span class="hljs-number">4</span>, <span class="hljs-number">4</span>, <span class="hljs-number">6</span>) ï¼Œæœ€ä¼˜çš„ä¸€ç»„æ“ä½œæ˜¯ï¼š- ä»ç¬¬ä¸€å’Œç¬¬äºŒå †å–ï¼ŒçŸ³å­çŠ¶æ€ç°åœ¨æ˜¯ (<span class="hljs-number">3</span>, <span class="hljs-number">3</span>, <span class="hljs-number">6</span>)- ä»ç¬¬ä¸€å’Œç¬¬ä¸‰å †å–ï¼ŒçŸ³å­çŠ¶æ€ç°åœ¨æ˜¯ (<span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>)- ä»ç¬¬ä¸€å’Œç¬¬ä¸‰å †å–ï¼ŒçŸ³å­çŠ¶æ€ç°åœ¨æ˜¯ (<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>)- ä»ç¬¬ä¸€å’Œç¬¬ä¸‰å †å–ï¼ŒçŸ³å­çŠ¶æ€ç°åœ¨æ˜¯ (<span class="hljs-number">0</span>, <span class="hljs-number">3</span>, <span class="hljs-number">3</span>)- ä»ç¬¬äºŒå’Œç¬¬ä¸‰å †å–ï¼ŒçŸ³å­çŠ¶æ€ç°åœ¨æ˜¯ (<span class="hljs-number">0</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>)- ä»ç¬¬äºŒå’Œç¬¬ä¸‰å †å–ï¼ŒçŸ³å­çŠ¶æ€ç°åœ¨æ˜¯ (<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>)- ä»ç¬¬äºŒå’Œç¬¬ä¸‰å †å–ï¼ŒçŸ³å­çŠ¶æ€ç°åœ¨æ˜¯ (<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>)æ€»åˆ†ï¼š<span class="hljs-number">7</span> åˆ† ã€‚</code></pre><p><strong>ç¤ºä¾‹ 3ï¼š</strong></p><pre><code class="hljs angelscript">è¾“å…¥ï¼ša = <span class="hljs-number">1</span>, b = <span class="hljs-number">8</span>, c = <span class="hljs-number">8</span>è¾“å‡ºï¼š<span class="hljs-number">8</span>è§£é‡Šï¼šæœ€ä¼˜çš„ä¸€ç»„æ“ä½œæ˜¯è¿ç»­ä»ç¬¬äºŒå’Œç¬¬ä¸‰å †å– <span class="hljs-number">8</span> å›åˆï¼Œç›´åˆ°å°†å®ƒä»¬å–ç©ºã€‚æ³¨æ„ï¼Œç”±äºç¬¬äºŒå’Œç¬¬ä¸‰å †å·²ç»ç©ºäº†ï¼Œæ¸¸æˆç»“æŸï¼Œä¸èƒ½ç»§ç»­ä»ç¬¬ä¸€å †ä¸­å–çŸ³å­ã€‚</code></pre><p><strong>æç¤ºï¼š</strong></p><ul><li><code>1 &lt;= a, b, c &lt;= 10^5</code></li></ul><pre><code class="hljs Java"></code></pre><pre><code class="hljs Go"></code></pre><pre><code class="hljs Python"></code></pre><h4 id="å¹¶æŸ¥é›†ï¼ˆUnion-findï¼‰åŠç»å…¸é—®é¢˜"><a href="#å¹¶æŸ¥é›†ï¼ˆUnion-findï¼‰åŠç»å…¸é—®é¢˜" class="headerlink" title="å¹¶æŸ¥é›†ï¼ˆUnion-findï¼‰åŠç»å…¸é—®é¢˜"></a><strong>å¹¶æŸ¥é›†ï¼ˆUnion-findï¼‰åŠç»å…¸é—®é¢˜</strong></h4>]]></content>
    
    
    <categories>
      
      <category>Leetcode</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Python</tag>
      
      <tag>Go</tag>
      
      <tag>Java</tag>
      
      <tag>LeetCode</tag>
      
      <tag>scala</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€LeetCodeã€‘çº¿æ€§è¡¨ç›¸å…³é—®é¢˜</title>
    <link href="/2021/03/05/lt-linkedList/"/>
    <url>/2021/03/05/lt-linkedList/</url>
    
    <content type="html"><![CDATA[<blockquote><p>æŠŠæ‰€æœ‰æ•°æ®ç”¨ä¸€æ ¹çº¿å„¿ä¸²èµ·æ¥ï¼Œå†å­˜å‚¨åˆ°ç‰©ç†ç©ºé—´ä¸­çš„æ•°æ®ç»“æ„<a id="more"></a></p></blockquote><p>æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰<br>é“¾æ¥ï¼š<a href="https://leetcode-cn.com/problemset/all/">https://leetcode-cn.com/problemset/all/</a></p><h4 id="é“¾è¡¨ç›¸å…³"><a href="#é“¾è¡¨ç›¸å…³" class="headerlink" title="é“¾è¡¨ç›¸å…³"></a>é“¾è¡¨ç›¸å…³</h4><h5 id="é“¾è¡¨è®¿é—®"><a href="#é“¾è¡¨è®¿é—®" class="headerlink" title="é“¾è¡¨è®¿é—®"></a>é“¾è¡¨è®¿é—®</h5><h6 id="141-ç¯å½¢é“¾è¡¨"><a href="#141-ç¯å½¢é“¾è¡¨" class="headerlink" title="141. ç¯å½¢é“¾è¡¨"></a><a href="https://leetcode-cn.com/problems/linked-list-cycle/">141. ç¯å½¢é“¾è¡¨</a></h6><p>ç»™å®šä¸€ä¸ªé“¾è¡¨ï¼Œåˆ¤æ–­é“¾è¡¨ä¸­æ˜¯å¦æœ‰ç¯ã€‚</p><p>å¦‚æœé“¾è¡¨ä¸­æœ‰æŸä¸ªèŠ‚ç‚¹ï¼Œå¯ä»¥é€šè¿‡è¿ç»­è·Ÿè¸ª next æŒ‡é’ˆå†æ¬¡åˆ°è¾¾ï¼Œåˆ™é“¾è¡¨ä¸­å­˜åœ¨ç¯ã€‚ ä¸ºäº†è¡¨ç¤ºç»™å®šé“¾è¡¨ä¸­çš„ç¯ï¼Œæˆ‘ä»¬ä½¿ç”¨æ•´æ•° pos æ¥è¡¨ç¤ºé“¾è¡¨å°¾è¿æ¥åˆ°é“¾è¡¨ä¸­çš„ä½ç½®ï¼ˆç´¢å¼•ä» 0 å¼€å§‹ï¼‰ã€‚ å¦‚æœ pos æ˜¯ -1ï¼Œåˆ™åœ¨è¯¥é“¾è¡¨ä¸­æ²¡æœ‰ç¯ã€‚æ³¨æ„ï¼špos ä¸ä½œä¸ºå‚æ•°è¿›è¡Œä¼ é€’ï¼Œä»…ä»…æ˜¯ä¸ºäº†æ ‡è¯†é“¾è¡¨çš„å®é™…æƒ…å†µã€‚</p><p>å¦‚æœé“¾è¡¨ä¸­å­˜åœ¨ç¯ï¼Œåˆ™è¿”å› true ã€‚ å¦åˆ™ï¼Œè¿”å› false ã€‚</p><p>è§£é¢˜æ€è·¯</p><pre><code class="hljs angelscript"><span class="hljs-number">1.</span>å¿«æ…¢æŒ‡é’ˆï¼Œç›¸é‡é—®é¢˜<span class="hljs-number">2.</span>å€ŸåŠ©å“ˆå¸Œï¼ˆSetï¼‰</code></pre><p><code>Java</code></p><pre><code class="hljs Java"><span class="hljs-comment">/*</span><span class="hljs-comment"> * Author: Wang P</span><span class="hljs-comment"> * Version: 1.0.0</span><span class="hljs-comment"> * Date: 2021-03-04 17:27:34</span><span class="hljs-comment"> * Description:</span><span class="hljs-comment"> **/</span> <span class="hljs-keyword">package</span> com.weitrue.leetcode.editor.cn;<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LinkedListCycle</span></span>&#123;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span></span>&#123;        Solution s = <span class="hljs-keyword">new</span> LinkedListCycle().<span class="hljs-function">new <span class="hljs-title">Solution</span><span class="hljs-params">()</span></span>;    &#125;        <span class="hljs-comment">//Given head, the head of a linked list, determine if the linked list has a cycl</span>    <span class="hljs-comment">//e in it.</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// There is a cycle in a linked list if there is some node in the list that can</span>    <span class="hljs-comment">//be reached again by continuously following the next pointer. Internally, pos is</span>    <span class="hljs-comment">//used to denote the index of the node that tail&#x27;s next pointer is connected to. N</span>    <span class="hljs-comment">//ote that pos is not passed as a parameter.</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Return true if there is a cycle in the linked list. Otherwise, return false.</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Example 1:</span>    <span class="hljs-comment">//Input: head = [3,2,0,-4], pos = 1</span>    <span class="hljs-comment">//Output: true</span>    <span class="hljs-comment">//Explanation: There is a cycle in the linked list, where the tail connects to t</span>    <span class="hljs-comment">//he 1st node (0-indexed).</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Example 2:</span>    <span class="hljs-comment">//Input: head = [1,2], pos = 0</span>    <span class="hljs-comment">//Output: true</span>    <span class="hljs-comment">//Explanation: There is a cycle in the linked list, where the tail connects to t</span>    <span class="hljs-comment">//he 0th node.</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Example 3:</span>    <span class="hljs-comment">//Input: head = [1], pos = -1</span>    <span class="hljs-comment">//Output: false</span>    <span class="hljs-comment">//Explanation: There is no cycle in the linked list.</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Constraints:</span>    <span class="hljs-comment">// The number of the nodes in the list is in the range [0, 104].</span>    <span class="hljs-comment">// -105 &lt;= Node.val &lt;= 105</span>    <span class="hljs-comment">// pos is -1 or a valid index in the linked-list.</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Follow up: Can you solve it using O(1) (i.e. constant) memory?</span>    <span class="hljs-comment">// Related Topics é“¾è¡¨ åŒæŒ‡é’ˆ</span>    <span class="hljs-comment">// ğŸ‘ 970 ğŸ‘ 0</span>  <span class="hljs-comment">// leetcode submit region begin(Prohibit modification and deletion)</span>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ListNode</span> </span>&#123;        <span class="hljs-keyword">int</span> val;        ListNode next;        ListNode(<span class="hljs-keyword">int</span> x) &#123;            val = x;            next = <span class="hljs-keyword">null</span>;        &#125;    &#125;    <span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span> </span>&#123;        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">hasCycle</span><span class="hljs-params">(ListNode head)</span> </span>&#123;            <span class="hljs-keyword">if</span> (head == <span class="hljs-keyword">null</span> ||  head.next == <span class="hljs-keyword">null</span>) &#123;                <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;            &#125;            ListNode p = head, q = head;            <span class="hljs-keyword">do</span> &#123;                p = p.next;                q = q.next.next;            &#125;            <span class="hljs-keyword">while</span> (q != <span class="hljs-keyword">null</span> &amp;&amp; q.next != <span class="hljs-keyword">null</span> &amp;&amp; p != q);            <span class="hljs-keyword">return</span> p == q;        &#125;    &#125;    <span class="hljs-comment">//leetcode submit region end(Prohibit modification and deletion)</span>&#125;</code></pre><p><code>Golang</code></p><pre><code class="hljs golang"><span class="hljs-keyword">package</span> leetcode<span class="hljs-comment">/**</span><span class="hljs-comment"> * Author: Wang P</span><span class="hljs-comment"> * Version: 1.0.0</span><span class="hljs-comment"> * Date: 2021-03-05 11:03:59</span><span class="hljs-comment"> * Description:</span><span class="hljs-comment"> **/</span><span class="hljs-comment">//Given head, the head of a linked list, determine if the linked list has a cycl</span><span class="hljs-comment">//e in it. </span><span class="hljs-comment">//</span><span class="hljs-comment">// There is a cycle in a linked list if there is some node in the list that can </span><span class="hljs-comment">//be reached again by continuously following the next pointer. Internally, pos is </span><span class="hljs-comment">//used to denote the index of the node that tail&#x27;s next pointer is connected to. N</span><span class="hljs-comment">//ote that pos is not passed as a parameter. </span><span class="hljs-comment">//</span><span class="hljs-comment">// Return true if there is a cycle in the linked list. Otherwise, return false. </span><span class="hljs-comment">// </span><span class="hljs-comment">// Example 1: </span><span class="hljs-comment">//Input: head = [3,2,0,-4], pos = 1</span><span class="hljs-comment">//Output: true</span><span class="hljs-comment">//Explanation: There is a cycle in the linked list, where the tail connects to t</span><span class="hljs-comment">//he 1st node (0-indexed).</span><span class="hljs-comment">// </span><span class="hljs-comment">// Example 2: </span><span class="hljs-comment">//Input: head = [1,2], pos = 0</span><span class="hljs-comment">//Output: true</span><span class="hljs-comment">//Explanation: There is a cycle in the linked list, where the tail connects to t</span><span class="hljs-comment">//he 0th node.</span><span class="hljs-comment">// </span><span class="hljs-comment">// Example 3: </span><span class="hljs-comment">//Input: head = [1], pos = -1</span><span class="hljs-comment">//Output: false</span><span class="hljs-comment">//Explanation: There is no cycle in the linked list.</span><span class="hljs-comment">// </span><span class="hljs-comment">// Constraints: </span><span class="hljs-comment">// The number of the nodes in the list is in the range [0, 104]. </span><span class="hljs-comment">// -105 &lt;= Node.val &lt;= 105 </span><span class="hljs-comment">// pos is -1 or a valid index in the linked-list. </span><span class="hljs-comment">// Follow up: Can you solve it using O(1) (i.e. constant) memory? </span><span class="hljs-comment">// Related Topics é“¾è¡¨ åŒæŒ‡é’ˆ </span><span class="hljs-comment">// ğŸ‘ 971 ğŸ‘ 0</span><span class="hljs-comment">//leetcode submit region begin(Prohibit modification and deletion)</span><span class="hljs-comment">// Definition for singly-linked list.</span><span class="hljs-keyword">type</span> ListNode <span class="hljs-keyword">struct</span> &#123;   Val <span class="hljs-keyword">int</span>   Next *ListNode&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">hasCycle</span><span class="hljs-params">(head *ListNode)</span> <span class="hljs-title">bool</span></span> &#123;<span class="hljs-keyword">if</span> head == <span class="hljs-literal">nil</span> || head.Next == <span class="hljs-literal">nil</span> &#123;<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>&#125;p := head.Nextq := head.Next.Next<span class="hljs-keyword">for</span> q != <span class="hljs-literal">nil</span> &amp;&amp; q.Next != <span class="hljs-literal">nil</span> &amp;&amp; p != q&#123;p = p.Nextq = q.Next.Next&#125;    <span class="hljs-keyword">return</span> p == q&#125;<span class="hljs-comment">//leetcode submit region end(Prohibit modification and deletion)</span></code></pre><p><code>Python</code></p><pre><code class="hljs Python"><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">Module Description: 141-ç¯å½¢é“¾è¡¨</span><span class="hljs-string">Solutionï¼š</span><span class="hljs-string">Date: 2021-03-05 10:38:59</span><span class="hljs-string">Author: Wang P</span><span class="hljs-string">Problem:# ç»™å®šä¸€ä¸ªé“¾è¡¨ï¼Œåˆ¤æ–­é“¾è¡¨ä¸­æ˜¯å¦æœ‰ç¯ã€‚ </span><span class="hljs-string"># </span><span class="hljs-string">#  å¦‚æœé“¾è¡¨ä¸­æœ‰æŸä¸ªèŠ‚ç‚¹ï¼Œå¯ä»¥é€šè¿‡è¿ç»­è·Ÿè¸ª next æŒ‡é’ˆå†æ¬¡åˆ°è¾¾ï¼Œåˆ™é“¾è¡¨ä¸­å­˜åœ¨ç¯ã€‚ ä¸ºäº†è¡¨ç¤ºç»™å®šé“¾è¡¨ä¸­çš„ç¯ï¼Œæˆ‘ä»¬ä½¿ç”¨æ•´æ•° pos æ¥è¡¨ç¤ºé“¾è¡¨å°¾è¿æ¥åˆ°é“¾è¡¨ä¸­çš„</span><span class="hljs-string"># ä½ç½®ï¼ˆç´¢å¼•ä» 0 å¼€å§‹ï¼‰ã€‚ å¦‚æœ pos æ˜¯ -1ï¼Œåˆ™åœ¨è¯¥é“¾è¡¨ä¸­æ²¡æœ‰ç¯ã€‚æ³¨æ„ï¼špos ä¸ä½œä¸ºå‚æ•°è¿›è¡Œä¼ é€’ï¼Œä»…ä»…æ˜¯ä¸ºäº†æ ‡è¯†é“¾è¡¨çš„å®é™…æƒ…å†µã€‚ </span><span class="hljs-string"># </span><span class="hljs-string">#  å¦‚æœé“¾è¡¨ä¸­å­˜åœ¨ç¯ï¼Œåˆ™è¿”å› true ã€‚ å¦åˆ™ï¼Œè¿”å› false ã€‚ </span><span class="hljs-string"># </span><span class="hljs-string">#  è¿›é˜¶ï¼š </span><span class="hljs-string">#  ä½ èƒ½ç”¨ O(1)ï¼ˆå³ï¼Œå¸¸é‡ï¼‰å†…å­˜è§£å†³æ­¤é—®é¢˜å—ï¼Ÿ </span><span class="hljs-string"># </span><span class="hljs-string">#  ç¤ºä¾‹ 1ï¼š </span><span class="hljs-string">#  è¾“å…¥ï¼šhead = [3,2,0,-4], pos = 1</span><span class="hljs-string"># è¾“å‡ºï¼štrue</span><span class="hljs-string"># è§£é‡Šï¼šé“¾è¡¨ä¸­æœ‰ä¸€ä¸ªç¯ï¼Œå…¶å°¾éƒ¨è¿æ¥åˆ°ç¬¬äºŒä¸ªèŠ‚ç‚¹ã€‚</span><span class="hljs-string">#  </span><span class="hljs-string">#  ç¤ºä¾‹ 2ï¼š </span><span class="hljs-string">#  è¾“å…¥ï¼šhead = [1,2], pos = 0</span><span class="hljs-string"># è¾“å‡ºï¼štrue</span><span class="hljs-string"># è§£é‡Šï¼šé“¾è¡¨ä¸­æœ‰ä¸€ä¸ªç¯ï¼Œå…¶å°¾éƒ¨è¿æ¥åˆ°ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ã€‚</span><span class="hljs-string">#  </span><span class="hljs-string">#  ç¤ºä¾‹ 3ï¼š </span><span class="hljs-string">#  è¾“å…¥ï¼šhead = [1], pos = -1</span><span class="hljs-string"># è¾“å‡ºï¼šfalse</span><span class="hljs-string"># è§£é‡Šï¼šé“¾è¡¨ä¸­æ²¡æœ‰ç¯ã€‚</span><span class="hljs-string">#  </span><span class="hljs-string">#  æç¤ºï¼š  </span><span class="hljs-string">#  é“¾è¡¨ä¸­èŠ‚ç‚¹çš„æ•°ç›®èŒƒå›´æ˜¯ [0, 104] </span><span class="hljs-string">#  -105 &lt;= Node.val &lt;= 105 </span><span class="hljs-string">#  pos ä¸º -1 æˆ–è€…é“¾è¡¨ä¸­çš„ä¸€ä¸ª æœ‰æ•ˆç´¢å¼• ã€‚ </span><span class="hljs-string">#  </span><span class="hljs-string">#  Related Topics é“¾è¡¨ åŒæŒ‡é’ˆ </span><span class="hljs-string">#  ğŸ‘ 971 ğŸ‘ 0</span><span class="hljs-string"></span><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-comment"># leetcode submit region begin(Prohibit modification and deletion)</span><span class="hljs-comment"># Definition for singly-linked list.</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ListNode</span>:</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, x</span>):</span>        self.val = x        self.<span class="hljs-built_in">next</span> = <span class="hljs-literal">None</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span>:</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">hasCycle</span>(<span class="hljs-params">self, head: ListNode</span>) -&gt; bool:</span>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> head:            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>        p = ListNode(<span class="hljs-number">-1</span>)        p.<span class="hljs-built_in">next</span> = head        p, q = head, head.<span class="hljs-built_in">next</span>        <span class="hljs-keyword">while</span> q <span class="hljs-keyword">and</span> q.<span class="hljs-built_in">next</span>:            p = p.<span class="hljs-built_in">next</span>            q = q.<span class="hljs-built_in">next</span>.<span class="hljs-built_in">next</span>            <span class="hljs-keyword">if</span> p == q:                <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>        <span class="hljs-comment"># leetcode submit region end(Prohibit modification and deletion)</span></code></pre><h6 id="142-ç¯å½¢é“¾è¡¨-II"><a href="#142-ç¯å½¢é“¾è¡¨-II" class="headerlink" title="142. ç¯å½¢é“¾è¡¨ II"></a><a href="https://leetcode-cn.com/problems/linked-list-cycle-ii/">142. ç¯å½¢é“¾è¡¨ II</a></h6><p>ç»™å®šä¸€ä¸ªé“¾è¡¨ï¼Œè¿”å›é“¾è¡¨å¼€å§‹å…¥ç¯çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ã€‚ å¦‚æœé“¾è¡¨æ— ç¯ï¼Œåˆ™è¿”å› nullã€‚</p><p>ä¸ºäº†è¡¨ç¤ºç»™å®šé“¾è¡¨ä¸­çš„ç¯ï¼Œæˆ‘ä»¬ä½¿ç”¨æ•´æ•° pos æ¥è¡¨ç¤ºé“¾è¡¨å°¾è¿æ¥åˆ°é“¾è¡¨ä¸­çš„ä½ç½®ï¼ˆç´¢å¼•ä» 0 å¼€å§‹ï¼‰ã€‚ å¦‚æœ pos æ˜¯ -1ï¼Œåˆ™åœ¨è¯¥é“¾è¡¨ä¸­æ²¡æœ‰ç¯ã€‚æ³¨æ„ï¼Œpos ä»…ä»…æ˜¯ç”¨äºæ ‡è¯†ç¯çš„æƒ…å†µï¼Œå¹¶ä¸ä¼šä½œä¸ºå‚æ•°ä¼ é€’åˆ°å‡½æ•°ä¸­ã€‚</p><p>è¯´æ˜ï¼šä¸å…è®¸ä¿®æ”¹ç»™å®šçš„é“¾è¡¨ã€‚</p><p>è¿›é˜¶ï¼š</p><p>ä½ æ˜¯å¦å¯ä»¥ä½¿ç”¨ O(1) ç©ºé—´è§£å†³æ­¤é¢˜ï¼Ÿ</p><p><img src="https://assets.leetcode-cn.com/aliyun-lc-upload/uploads/2018/12/07/circularlinkedlist.png"></p><pre><div class="caption"><span>1ï¼š</span></div><code class="hljs ç¤ºä¾‹">è¾“å…¥ï¼šhead &#x3D; [3,2,0,-4], pos &#x3D; 1è¾“å‡ºï¼šè¿”å›ç´¢å¼•ä¸º 1 çš„é“¾è¡¨èŠ‚ç‚¹è§£é‡Šï¼šé“¾è¡¨ä¸­æœ‰ä¸€ä¸ªç¯ï¼Œå…¶å°¾éƒ¨è¿æ¥åˆ°ç¬¬äºŒä¸ªèŠ‚ç‚¹ã€‚</code></pre><p><img src="https://assets.leetcode-cn.com/aliyun-lc-upload/uploads/2018/12/07/circularlinkedlist_test2.png"></p><pre><div class="caption"><span>2ï¼š</span></div><code class="hljs ç¤ºä¾‹">è¾“å…¥ï¼šhead &#x3D; [1,2], pos &#x3D; 0è¾“å‡ºï¼šè¿”å›ç´¢å¼•ä¸º 0 çš„é“¾è¡¨èŠ‚ç‚¹è§£é‡Šï¼šé“¾è¡¨ä¸­æœ‰ä¸€ä¸ªç¯ï¼Œå…¶å°¾éƒ¨è¿æ¥åˆ°ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ã€‚</code></pre><p><img src="https://assets.leetcode-cn.com/aliyun-lc-upload/uploads/2018/12/07/circularlinkedlist_test3.png"></p><pre><div class="caption"><span>3ï¼š</span></div><code class="hljs ç¤ºä¾‹">è¾“å…¥ï¼šhead &#x3D; [1], pos &#x3D; -1è¾“å‡ºï¼šè¿”å› nullè§£é‡Šï¼šé“¾è¡¨ä¸­æ²¡æœ‰ç¯ã€‚</code></pre><p><strong>æç¤ºï¼š</strong></p><ul><li>é“¾è¡¨ä¸­èŠ‚ç‚¹çš„æ•°ç›®èŒƒå›´åœ¨èŒƒå›´ <code>[0, 104]</code> å†…</li><li><code>-105 &lt;= Node.val &lt;= 105</code></li><li><code>pos</code> çš„å€¼ä¸º <code>-1</code> æˆ–è€…é“¾è¡¨ä¸­çš„ä¸€ä¸ªæœ‰æ•ˆç´¢å¼•</li></ul><p>è§£é¢˜æ€è·¯</p><pre><code class="hljs coq"><span class="hljs-number">1.</span>å¿«æ…¢æŒ‡é’ˆï¼Œç›¸é‡åï¼Œhead-&gt;å…¥ç¯çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹è·ç¦»=ç›¸é‡ç‚¹-&gt;å…¥ç¯çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹è·ç¦»<span class="hljs-number">2.</span>å€ŸåŠ©å“ˆå¸Œï¼ˆ<span class="hljs-keyword">Set</span>ï¼‰</code></pre><p><code>Java</code></p><pre><code class="hljs Java"><span class="hljs-comment">/*</span><span class="hljs-comment"> * Author: Wang P</span><span class="hljs-comment"> * Version: 1.0.0</span><span class="hljs-comment"> * Date: 2021-03-04 19:03:31</span><span class="hljs-comment"> * Description: 142-Linked List Cycle II</span><span class="hljs-comment"> **/</span> <span class="hljs-keyword">package</span> com.weitrue.leetcode.editor.cn;<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LinkedListCycleIi</span></span>&#123;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span></span>&#123;        Solution s = <span class="hljs-keyword">new</span> LinkedListCycleIi().<span class="hljs-function">new <span class="hljs-title">Solution</span><span class="hljs-params">()</span></span>;    &#125;        <span class="hljs-comment">//Given a linked list, return the node where the cycle begins. If there is no cy</span>    <span class="hljs-comment">//cle, return null.</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// There is a cycle in a linked list if there is some node in the list that can</span>    <span class="hljs-comment">//be reached again by continuously following the next pointer. Internally, pos is</span>    <span class="hljs-comment">//used to denote the index of the node that tail&#x27;s next pointer is connected to. N</span>    <span class="hljs-comment">//ote that pos is not passed as a parameter.</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Notice that you should not modify the linked list.</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Example 1:</span>    <span class="hljs-comment">//Input: head = [3,2,0,-4], pos = 1</span>    <span class="hljs-comment">//Output: tail connects to node index 1</span>    <span class="hljs-comment">//Explanation: There is a cycle in the linked list, where tail connects to the s</span>    <span class="hljs-comment">//econd node.</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Example 2:</span>    <span class="hljs-comment">//Input: head = [1,2], pos = 0</span>    <span class="hljs-comment">//Output: tail connects to node index 0</span>    <span class="hljs-comment">//Explanation: There is a cycle in the linked list, where tail connects to the f</span>    <span class="hljs-comment">//irst node.</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Example 3:</span>    <span class="hljs-comment">//Input: head = [1], pos = -1</span>    <span class="hljs-comment">//Output: no cycle</span>    <span class="hljs-comment">//Explanation: There is no cycle in the linked list.</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Constraints:</span>    <span class="hljs-comment">// The number of the nodes in the list is in the range [0, 104].</span>    <span class="hljs-comment">// -105 &lt;= Node.val &lt;= 105</span>    <span class="hljs-comment">// pos is -1 or a valid index in the linked-list.</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Follow up: Can you solve it using O(1) (i.e. constant) memory?</span>    <span class="hljs-comment">// Related Topics é“¾è¡¨ åŒæŒ‡é’ˆ</span>    <span class="hljs-comment">// ğŸ‘ 897 ğŸ‘ 0</span>     <span class="hljs-comment">// leetcode submit region begin(Prohibit modification and deletion)</span>     <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ListNode</span> </span>&#123;         <span class="hljs-keyword">int</span> val;         ListNode next;         ListNode(<span class="hljs-keyword">int</span> x) &#123;             val = x;             next = <span class="hljs-keyword">null</span>;         &#125;     &#125;    <span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span> </span>&#123;        <span class="hljs-function"><span class="hljs-keyword">public</span> ListNode <span class="hljs-title">detectCycle</span><span class="hljs-params">(ListNode head)</span> </span>&#123;            <span class="hljs-keyword">if</span>(head == <span class="hljs-keyword">null</span> || head.next == <span class="hljs-keyword">null</span>)&#123;                <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;            &#125;            ListNode p = head, q = head;            <span class="hljs-keyword">do</span> &#123;                p = p.next;                q = q.next.next;            &#125; <span class="hljs-keyword">while</span> (q != <span class="hljs-keyword">null</span> &amp;&amp; q.next != <span class="hljs-keyword">null</span> &amp;&amp; p != q);            <span class="hljs-keyword">if</span> (p != q) &#123;                <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;            &#125;            q = head;            <span class="hljs-keyword">while</span> (p != q) &#123;                p = p.next;                q = q.next;            &#125;            <span class="hljs-keyword">return</span> q;        &#125;    &#125;    <span class="hljs-comment">//leetcode submit region end(Prohibit modification and deletion)</span>&#125;</code></pre><p><code>Golang</code></p><pre><code class="hljs golang"><span class="hljs-keyword">package</span> leetcode<span class="hljs-comment">/**</span><span class="hljs-comment"> * Author: Wang P</span><span class="hljs-comment"> * Version: 1.0.0</span><span class="hljs-comment"> * Date: 2021-03-05 11:14:26</span><span class="hljs-comment"> * Description:</span><span class="hljs-comment"> **/</span><span class="hljs-comment">//Given a linked list, return the node where the cycle begins. If there is no cy</span><span class="hljs-comment">//cle, return null. </span><span class="hljs-comment">//</span><span class="hljs-comment">// There is a cycle in a linked list if there is some node in the list that can </span><span class="hljs-comment">//be reached again by continuously following the next pointer. Internally, pos is </span><span class="hljs-comment">//used to denote the index of the node that tail&#x27;s next pointer is connected to. N</span><span class="hljs-comment">//ote that pos is not passed as a parameter. </span><span class="hljs-comment">//</span><span class="hljs-comment">// Notice that you should not modify the linked list. </span><span class="hljs-comment">//</span><span class="hljs-comment">// Example 1: </span><span class="hljs-comment">//Input: head = [3,2,0,-4], pos = 1</span><span class="hljs-comment">//Output: tail connects to node index 1</span><span class="hljs-comment">//Explanation: There is a cycle in the linked list, where tail connects to the s</span><span class="hljs-comment">//econd node.</span><span class="hljs-comment">// </span><span class="hljs-comment">// Example 2: </span><span class="hljs-comment">//Input: head = [1,2], pos = 0</span><span class="hljs-comment">//Output: tail connects to node index 0</span><span class="hljs-comment">//Explanation: There is a cycle in the linked list, where tail connects to the f</span><span class="hljs-comment">//irst node.</span><span class="hljs-comment">// </span><span class="hljs-comment">// Example 3: </span><span class="hljs-comment">//Input: head = [1], pos = -1</span><span class="hljs-comment">//Output: no cycle</span><span class="hljs-comment">//Explanation: There is no cycle in the linked list.</span><span class="hljs-comment">// </span><span class="hljs-comment">// Constraints: </span><span class="hljs-comment">// The number of the nodes in the list is in the range [0, 104]. </span><span class="hljs-comment">// -105 &lt;= Node.val &lt;= 105 </span><span class="hljs-comment">// pos is -1 or a valid index in the linked-list. </span><span class="hljs-comment">// Follow up: Can you solve it using O(1) (i.e. constant) memory? </span><span class="hljs-comment">// Related Topics é“¾è¡¨ åŒæŒ‡é’ˆ </span><span class="hljs-comment">// ğŸ‘ 898 ğŸ‘ 0</span><span class="hljs-comment">//leetcode submit region begin(Prohibit modification and deletion)</span><span class="hljs-comment">/**</span><span class="hljs-comment"> * Definition for singly-linked list.</span><span class="hljs-comment"> * type ListNode struct &#123;</span><span class="hljs-comment"> *     Val int</span><span class="hljs-comment"> *     Next *ListNode</span><span class="hljs-comment"> * &#125;</span><span class="hljs-comment"> */</span><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">detectCycle</span><span class="hljs-params">(head *ListNode)</span> *<span class="hljs-title">ListNode</span></span> &#123;<span class="hljs-keyword">if</span> head == <span class="hljs-literal">nil</span> || head.Next == <span class="hljs-literal">nil</span> &#123;<span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>&#125;p := head.Nextq := head.Next.Next<span class="hljs-keyword">for</span> q != <span class="hljs-literal">nil</span> &amp;&amp; q.Next != <span class="hljs-literal">nil</span> &amp;&amp; p != q&#123;q = q.Next.Nextp = p.Next&#125;<span class="hljs-keyword">if</span> p != q &#123;<span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>&#125;q = head<span class="hljs-keyword">for</span> p != q &#123;p = p.Nextq = q.Next&#125;<span class="hljs-keyword">return</span> q&#125;<span class="hljs-comment">//leetcode submit region end(Prohibit modification and deletion)</span></code></pre><p><code>Python</code></p><pre><code class="hljs Python"><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">Module Description: 142-ç¯å½¢é“¾è¡¨ II</span><span class="hljs-string">Solutionï¼š</span><span class="hljs-string">Date: 2021-03-05 10:47:28</span><span class="hljs-string">Author: Wang P</span><span class="hljs-string">Problem: ç»™å®šä¸€ä¸ªé“¾è¡¨ï¼Œè¿”å›é“¾è¡¨å¼€å§‹å…¥ç¯çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ã€‚ å¦‚æœé“¾è¡¨æ— ç¯ï¼Œåˆ™è¿”å› nullã€‚</span><span class="hljs-string"># </span><span class="hljs-string">#  ä¸ºäº†è¡¨ç¤ºç»™å®šé“¾è¡¨ä¸­çš„ç¯ï¼Œæˆ‘ä»¬ä½¿ç”¨æ•´æ•° pos æ¥è¡¨ç¤ºé“¾è¡¨å°¾è¿æ¥åˆ°é“¾è¡¨ä¸­çš„ä½ç½®ï¼ˆç´¢å¼•ä» 0 å¼€å§‹ï¼‰ã€‚ å¦‚æœ pos æ˜¯ -1ï¼Œåˆ™åœ¨è¯¥é“¾è¡¨ä¸­æ²¡æœ‰ç¯ã€‚æ³¨æ„ï¼Œpo</span><span class="hljs-string"># s ä»…ä»…æ˜¯ç”¨äºæ ‡è¯†ç¯çš„æƒ…å†µï¼Œå¹¶ä¸ä¼šä½œä¸ºå‚æ•°ä¼ é€’åˆ°å‡½æ•°ä¸­ã€‚ </span><span class="hljs-string"># </span><span class="hljs-string">#  è¯´æ˜ï¼šä¸å…è®¸ä¿®æ”¹ç»™å®šçš„é“¾è¡¨ã€‚ </span><span class="hljs-string"># </span><span class="hljs-string">#  è¿›é˜¶ï¼š</span><span class="hljs-string">#  ä½ æ˜¯å¦å¯ä»¥ä½¿ç”¨ O(1) ç©ºé—´è§£å†³æ­¤é¢˜ï¼Ÿ </span><span class="hljs-string">#</span><span class="hljs-string">#  ç¤ºä¾‹ 1ï¼š</span><span class="hljs-string"># è¾“å…¥ï¼šhead = [3,2,0,-4], pos = 1</span><span class="hljs-string"># è¾“å‡ºï¼šè¿”å›ç´¢å¼•ä¸º 1 çš„é“¾è¡¨èŠ‚ç‚¹</span><span class="hljs-string"># è§£é‡Šï¼šé“¾è¡¨ä¸­æœ‰ä¸€ä¸ªç¯ï¼Œå…¶å°¾éƒ¨è¿æ¥åˆ°ç¬¬äºŒä¸ªèŠ‚ç‚¹ã€‚</span><span class="hljs-string">#</span><span class="hljs-string">#  ç¤ºä¾‹ 2ï¼š</span><span class="hljs-string"># è¾“å…¥ï¼šhead = [1,2], pos = 0</span><span class="hljs-string"># è¾“å‡ºï¼šè¿”å›ç´¢å¼•ä¸º 0 çš„é“¾è¡¨èŠ‚ç‚¹</span><span class="hljs-string"># è§£é‡Šï¼šé“¾è¡¨ä¸­æœ‰ä¸€ä¸ªç¯ï¼Œå…¶å°¾éƒ¨è¿æ¥åˆ°ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ã€‚</span><span class="hljs-string">#</span><span class="hljs-string">#  ç¤ºä¾‹ 3ï¼š</span><span class="hljs-string"># è¾“å…¥ï¼šhead = [1], pos = -1</span><span class="hljs-string"># è¾“å‡ºï¼šè¿”å› null</span><span class="hljs-string"># è§£é‡Šï¼šé“¾è¡¨ä¸­æ²¡æœ‰ç¯ã€‚</span><span class="hljs-string">#</span><span class="hljs-string">#  æç¤ºï¼š</span><span class="hljs-string">#  é“¾è¡¨ä¸­èŠ‚ç‚¹çš„æ•°ç›®èŒƒå›´åœ¨èŒƒå›´ [0, 104] å†… </span><span class="hljs-string">#  -105 &lt;= Node.val &lt;= 105 </span><span class="hljs-string">#  pos çš„å€¼ä¸º -1 æˆ–è€…é“¾è¡¨ä¸­çš„ä¸€ä¸ªæœ‰æ•ˆç´¢å¼• </span><span class="hljs-string">#  </span><span class="hljs-string">#  Related Topics é“¾è¡¨ åŒæŒ‡é’ˆ </span><span class="hljs-string">#  ğŸ‘ 898 ğŸ‘ 0</span><span class="hljs-string"></span><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-comment"># leetcode submit region begin(Prohibit modification and deletion)</span><span class="hljs-comment"># Definition for singly-linked list.</span><span class="hljs-comment">#</span><span class="hljs-comment">#</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ListNode</span>:</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, x</span>):</span>        self.val = x        self.<span class="hljs-built_in">next</span> = <span class="hljs-literal">None</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span>:</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">detectCycle</span>(<span class="hljs-params">self, head: ListNode</span>) -&gt; ListNode:</span>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> head <span class="hljs-keyword">or</span> <span class="hljs-keyword">not</span> head.<span class="hljs-built_in">next</span>:            <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span>        p, q = head.<span class="hljs-built_in">next</span>, head.<span class="hljs-built_in">next</span>.<span class="hljs-built_in">next</span>        <span class="hljs-keyword">while</span> q <span class="hljs-keyword">and</span> q.<span class="hljs-built_in">next</span> <span class="hljs-keyword">and</span> p != q:            p = p.<span class="hljs-built_in">next</span>            q = q.<span class="hljs-built_in">next</span>.<span class="hljs-built_in">next</span>        <span class="hljs-keyword">if</span> p != q:            <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span>        q = head        <span class="hljs-keyword">while</span> p != q:            p = p.<span class="hljs-built_in">next</span>            q = q.<span class="hljs-built_in">next</span>        <span class="hljs-keyword">return</span> q        <span class="hljs-comment"># leetcode submit region end(Prohibit modification and deletion)</span></code></pre><h6 id="202-å¿«ä¹æ•°"><a href="#202-å¿«ä¹æ•°" class="headerlink" title="202. å¿«ä¹æ•°"></a><a href="https://leetcode-cn.com/problems/happy-number/">202. å¿«ä¹æ•°</a></h6><p>ç¼–å†™ä¸€ä¸ªç®—æ³•æ¥åˆ¤æ–­ä¸€ä¸ªæ•° n æ˜¯ä¸æ˜¯å¿«ä¹æ•°ã€‚</p><p>ã€Œå¿«ä¹æ•°ã€å®šä¹‰ä¸ºï¼š</p><p>å¯¹äºä¸€ä¸ªæ­£æ•´æ•°ï¼Œæ¯ä¸€æ¬¡å°†è¯¥æ•°æ›¿æ¢ä¸ºå®ƒæ¯ä¸ªä½ç½®ä¸Šçš„æ•°å­—çš„å¹³æ–¹å’Œã€‚<br>ç„¶åé‡å¤è¿™ä¸ªè¿‡ç¨‹ç›´åˆ°è¿™ä¸ªæ•°å˜ä¸º 1ï¼Œä¹Ÿå¯èƒ½æ˜¯ æ— é™å¾ªç¯ ä½†å§‹ç»ˆå˜ä¸åˆ° 1ã€‚<br>å¦‚æœ å¯ä»¥å˜ä¸º  1ï¼Œé‚£ä¹ˆè¿™ä¸ªæ•°å°±æ˜¯å¿«ä¹æ•°ã€‚<br>å¦‚æœ n æ˜¯å¿«ä¹æ•°å°±è¿”å› true ï¼›ä¸æ˜¯ï¼Œåˆ™è¿”å› false ã€‚</p><p>è§£é¢˜æ€è·¯</p><pre><code class="hljs angelscript"><span class="hljs-number">1.</span>é“¾è¡¨æ˜¯å¦æœ‰ç¯é—®é¢˜</code></pre><p>ç¤ºä¾‹ 2ï¼š</p><pre><code class="hljs angelscript">è¾“å…¥ï¼š<span class="hljs-number">19</span>è¾“å‡ºï¼š<span class="hljs-literal">true</span>è§£é‡Šï¼š<span class="hljs-number">12</span> + <span class="hljs-number">92</span> = <span class="hljs-number">82</span><span class="hljs-number">82</span> + <span class="hljs-number">22</span> = <span class="hljs-number">68</span><span class="hljs-number">62</span> + <span class="hljs-number">82</span> = <span class="hljs-number">100</span><span class="hljs-number">12</span> + <span class="hljs-number">02</span> + <span class="hljs-number">02</span> = <span class="hljs-number">1</span></code></pre><p>ç¤ºä¾‹ 2ï¼š</p><pre><code class="hljs angelscript">è¾“å…¥ï¼šn = <span class="hljs-number">2</span>è¾“å‡ºï¼š<span class="hljs-literal">false</span>æç¤ºï¼š<span class="hljs-number">1</span> &lt;= n &lt;= <span class="hljs-number">231</span> - <span class="hljs-number">1</span></code></pre><p><code>Java</code></p><pre><code class="hljs java"><span class="hljs-comment">/*</span><span class="hljs-comment"> * Author: Wang P</span><span class="hljs-comment"> * Version: 1.0.0</span><span class="hljs-comment"> * Date: 2021-03-04 17:56:08</span><span class="hljs-comment"> * Description:</span><span class="hljs-comment"> **/</span><span class="hljs-keyword">package</span> com.weitrue.leetcode.editor.cn;<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HappyNumber</span></span>&#123;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span></span>&#123;        Solution s = <span class="hljs-keyword">new</span> HappyNumber().<span class="hljs-function">new <span class="hljs-title">Solution</span><span class="hljs-params">()</span></span>;        <span class="hljs-keyword">int</span> sum = <span class="hljs-number">0</span>;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>; i&lt;=<span class="hljs-number">100000</span>; i++) &#123;            <span class="hljs-keyword">if</span> (s.isHappy(i)) &#123;                sum++;            &#125;        &#125;        System.out.println(sum);    &#125;    <span class="hljs-comment">//Write an algorithm to determine if a number n is happy.</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// A happy number is a number defined by the following process:</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Starting with any positive integer, replace the number by the sum of the squares of its digits.</span>    <span class="hljs-comment">// Repeat the process until the number equals 1 (where it will stay), or it loops endlessly in a cycle which does not include 1.</span>    <span class="hljs-comment">// Those numbers for which this process ends in 1 are happy.</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Return true if n is a happy number, and false if not.</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Example 1:</span>    <span class="hljs-comment">//Input: n = 19</span>    <span class="hljs-comment">//Output: true</span>    <span class="hljs-comment">//Explanation:</span>    <span class="hljs-comment">//12 + 92 = 82</span>    <span class="hljs-comment">//82 + 22 = 68</span>    <span class="hljs-comment">//62 + 82 = 100</span>    <span class="hljs-comment">//12 + 02 + 02 = 1</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Example 2:</span>    <span class="hljs-comment">//Input: n = 2</span>    <span class="hljs-comment">//Output: false</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Constraints:</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// 1 &lt;= n &lt;= 231 - 1</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Related Topics å“ˆå¸Œè¡¨ æ•°å­¦</span>    <span class="hljs-comment">// ğŸ‘ 542 ğŸ‘ 0</span>    <span class="hljs-comment">//leetcode submit region begin(Prohibit modification and deletion)</span>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span> </span>&#123;            <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">getNext</span><span class="hljs-params">(<span class="hljs-keyword">int</span> n)</span> </span>&#123;                <span class="hljs-keyword">int</span> x = <span class="hljs-number">0</span>;                <span class="hljs-keyword">while</span>(n &gt; <span class="hljs-number">0</span>) &#123;                    x += (n % <span class="hljs-number">10</span>) * (n % <span class="hljs-number">10</span>);                    n = n / <span class="hljs-number">10</span>;                &#125;                <span class="hljs-keyword">return</span> x;            &#125;            <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">isHappy</span><span class="hljs-params">(<span class="hljs-keyword">int</span> n)</span> </span>&#123;                <span class="hljs-keyword">int</span> p = n, q = n;                <span class="hljs-keyword">do</span>&#123;                    p = getNext(p);                    q = getNext(getNext(q));                &#125; <span class="hljs-keyword">while</span> (p != q &amp;&amp; q!= <span class="hljs-number">1</span>);                <span class="hljs-keyword">return</span> q == <span class="hljs-number">1</span>;            &#125;    &#125;    <span class="hljs-comment">//leetcode submit region end(Prohibit modification and deletion)</span>&#125;</code></pre><p><code>Golang</code></p><pre><code class="hljs golang"><span class="hljs-keyword">package</span> leetcode<span class="hljs-comment">/**</span><span class="hljs-comment"> * Author: Wang P</span><span class="hljs-comment"> * Version: 1.0.0</span><span class="hljs-comment"> * Date: 2021-03-05 12:56:41</span><span class="hljs-comment"> * Description: //Write an algorithm to determine if a number n is happy.</span><span class="hljs-comment">//</span><span class="hljs-comment">// A happy number is a number defined by the following process:</span><span class="hljs-comment">//</span><span class="hljs-comment">// Starting with any positive integer, replace the number by the sum of the squa</span><span class="hljs-comment">//res of its digits.</span><span class="hljs-comment">// Repeat the process until the number equals 1 (where it will stay), or it loop</span><span class="hljs-comment">//s endlessly in a cycle which does not include 1.</span><span class="hljs-comment">// Those numbers for which this process ends in 1 are happy.</span><span class="hljs-comment">//</span><span class="hljs-comment">// Return true if n is a happy number, and false if not.</span><span class="hljs-comment">//</span><span class="hljs-comment">// Example 1:</span><span class="hljs-comment">//Input: n = 19</span><span class="hljs-comment">//Output: true</span><span class="hljs-comment">//Explanation:</span><span class="hljs-comment">//12 + 92 = 82</span><span class="hljs-comment">//82 + 22 = 68</span><span class="hljs-comment">//62 + 82 = 100</span><span class="hljs-comment">//12 + 02 + 02 = 1</span><span class="hljs-comment">//</span><span class="hljs-comment">// Example 2:</span><span class="hljs-comment">//Input: n = 2</span><span class="hljs-comment">//Output: false</span><span class="hljs-comment">//</span><span class="hljs-comment">// Constraints:</span><span class="hljs-comment">// 1 &lt;= n &lt;= 231 - 1</span><span class="hljs-comment">//</span><span class="hljs-comment">// Related Topics å“ˆå¸Œè¡¨ æ•°å­¦</span><span class="hljs-comment">// ğŸ‘ 547 ğŸ‘ 0</span><span class="hljs-comment"> **/</span><span class="hljs-comment">//leetcode submit region begin(Prohibit modification and deletion)</span><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">IsHappy</span><span class="hljs-params">(n <span class="hljs-keyword">int</span>)</span> <span class="hljs-title">bool</span></span> &#123;p, q := getNext(n), getNext(getNext(n))<span class="hljs-keyword">for</span> p != q &amp;&amp; q != <span class="hljs-number">1</span> &#123;p = getNext(p)q = getNext(getNext(q))&#125;<span class="hljs-keyword">return</span> q == <span class="hljs-number">1</span>&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">getNext</span><span class="hljs-params">(n <span class="hljs-keyword">int</span>)</span> <span class="hljs-title">int</span></span> &#123;x := <span class="hljs-number">0</span><span class="hljs-keyword">for</span> n &gt; <span class="hljs-number">0</span> &#123;x += (n % <span class="hljs-number">10</span>) * (n % <span class="hljs-number">10</span>)n = n / <span class="hljs-number">10</span>&#125;<span class="hljs-keyword">return</span> x&#125;<span class="hljs-comment">//leetcode submit region end(Prohibit modification and deletion)</span></code></pre><p><code>Python</code></p><pre><code class="hljs Python"><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">Module Description: 202-å¿«ä¹æ•°</span><span class="hljs-string">Solutionï¼š</span><span class="hljs-string">Date: 2021-03-05 12:02:33</span><span class="hljs-string">Author: Wang P</span><span class="hljs-string">Problem:# ç¼–å†™ä¸€ä¸ªç®—æ³•æ¥åˆ¤æ–­ä¸€ä¸ªæ•° n æ˜¯ä¸æ˜¯å¿«ä¹æ•°ã€‚ </span><span class="hljs-string"># </span><span class="hljs-string">#  ã€Œå¿«ä¹æ•°ã€å®šä¹‰ä¸ºï¼š </span><span class="hljs-string">#  å¯¹äºä¸€ä¸ªæ­£æ•´æ•°ï¼Œæ¯ä¸€æ¬¡å°†è¯¥æ•°æ›¿æ¢ä¸ºå®ƒæ¯ä¸ªä½ç½®ä¸Šçš„æ•°å­—çš„å¹³æ–¹å’Œã€‚ </span><span class="hljs-string">#  ç„¶åé‡å¤è¿™ä¸ªè¿‡ç¨‹ç›´åˆ°è¿™ä¸ªæ•°å˜ä¸º 1ï¼Œä¹Ÿå¯èƒ½æ˜¯ æ— é™å¾ªç¯ ä½†å§‹ç»ˆå˜ä¸åˆ° 1ã€‚ </span><span class="hljs-string">#  å¦‚æœ å¯ä»¥å˜ä¸º 1ï¼Œé‚£ä¹ˆè¿™ä¸ªæ•°å°±æ˜¯å¿«ä¹æ•°ã€‚ </span><span class="hljs-string">#  å¦‚æœ n æ˜¯å¿«ä¹æ•°å°±è¿”å› true ï¼›ä¸æ˜¯ï¼Œåˆ™è¿”å› false ã€‚ </span><span class="hljs-string"># </span><span class="hljs-string">#  ç¤ºä¾‹ 1ï¼š </span><span class="hljs-string"># è¾“å…¥ï¼š19</span><span class="hljs-string"># è¾“å‡ºï¼štrue</span><span class="hljs-string"># è§£é‡Šï¼š</span><span class="hljs-string"># 12 + 92 = 82</span><span class="hljs-string"># 82 + 22 = 68</span><span class="hljs-string"># 62 + 82 = 100</span><span class="hljs-string"># 12 + 02 + 02 = 1</span><span class="hljs-string">#  </span><span class="hljs-string">#  ç¤ºä¾‹ 2ï¼š </span><span class="hljs-string"># è¾“å…¥ï¼šn = 2</span><span class="hljs-string"># è¾“å‡ºï¼šfalse</span><span class="hljs-string">#  </span><span class="hljs-string">#  æç¤ºï¼š </span><span class="hljs-string">#  1 &lt;= n &lt;= 231 - 1 </span><span class="hljs-string">#  </span><span class="hljs-string">#  Related Topics å“ˆå¸Œè¡¨ æ•°å­¦ </span><span class="hljs-string">#  ğŸ‘ 548 ğŸ‘ 0</span><span class="hljs-string"></span><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-comment"># leetcode submit region begin(Prohibit modification and deletion)</span><span class="hljs-keyword">import</span> math<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span>:</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">isHappy</span>(<span class="hljs-params">self, n: <span class="hljs-built_in">int</span></span>) -&gt; bool:</span>        p, q = n, self.get_next(n)        <span class="hljs-keyword">while</span> p != q <span class="hljs-keyword">and</span> q != <span class="hljs-number">1</span>:            p = self.get_next(p)            q = self.get_next(self.get_next(q))        <span class="hljs-keyword">return</span> q == <span class="hljs-number">1</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_next</span>(<span class="hljs-params">self, n: <span class="hljs-built_in">int</span></span>) -&gt; int:</span>        x = <span class="hljs-number">0</span>        <span class="hljs-keyword">while</span> n:            n, tmp = <span class="hljs-built_in">divmod</span>(n, <span class="hljs-number">10</span>)            x += (tmp * tmp)        <span class="hljs-keyword">return</span> x<span class="hljs-comment"># leetcode submit region end(Prohibit modification and deletion)</span></code></pre><h5 id="é“¾è¡¨åè½¬"><a href="#é“¾è¡¨åè½¬" class="headerlink" title="é“¾è¡¨åè½¬"></a>é“¾è¡¨åè½¬</h5><h6 id="206-åè½¬é“¾è¡¨"><a href="#206-åè½¬é“¾è¡¨" class="headerlink" title="206. åè½¬é“¾è¡¨"></a><a href="https://leetcode-cn.com/problems/reverse-linked-list/">206. åè½¬é“¾è¡¨</a></h6><p>åè½¬ä¸€ä¸ªå•é“¾è¡¨ã€‚</p><p>ç¤ºä¾‹:</p><pre><code class="hljs angelscript">è¾“å…¥: <span class="hljs-number">1</span>-&gt;<span class="hljs-number">2</span>-&gt;<span class="hljs-number">3</span>-&gt;<span class="hljs-number">4</span>-&gt;<span class="hljs-number">5</span>-&gt;NULLè¾“å‡º: <span class="hljs-number">5</span>-&gt;<span class="hljs-number">4</span>-&gt;<span class="hljs-number">3</span>-&gt;<span class="hljs-number">2</span>-&gt;<span class="hljs-number">1</span>-&gt;NULL</code></pre><p>è¿›é˜¶:<br>ä½ å¯ä»¥è¿­ä»£æˆ–é€’å½’åœ°åè½¬é“¾è¡¨ã€‚ä½ èƒ½å¦ç”¨ä¸¤ç§æ–¹æ³•è§£å†³è¿™é“é¢˜ï¼Ÿ</p><p>è§£é¢˜æ€è·¯</p><pre><code class="hljs angelscript"><span class="hljs-number">1.</span>é€šè¿‡å‰é©±ã€åç»§å¯¹é“¾è¡¨è¿›è¡Œåè½¬<span class="hljs-number">2.</span>é€’å½’æ–¹å¼<span class="hljs-number">3.</span>å€ŸåŠ©æ ˆç»“æ„</code></pre><p><code>Java</code></p><pre><code class="hljs Java"><span class="hljs-comment">/*</span><span class="hljs-comment"> * Author: Wang P</span><span class="hljs-comment"> * Version: 1.0.0</span><span class="hljs-comment"> * Date: 2021-03-05 17:30:32</span><span class="hljs-comment"> * Description: 206-Reverse Linked List</span><span class="hljs-comment"> **/</span> <span class="hljs-keyword">package</span> com.weitrue.leetcode.editor.cn;<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ReverseLinkedList</span></span>&#123;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span></span>&#123;        Solution s = <span class="hljs-keyword">new</span> ReverseLinkedList().<span class="hljs-function">new <span class="hljs-title">Solution</span><span class="hljs-params">()</span></span>;    &#125;        <span class="hljs-comment">//Given the head of a singly linked list, reverse the list, and return the reversed list.</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Example 1:</span>    <span class="hljs-comment">//Input: head = [1,2,3,4,5]</span>    <span class="hljs-comment">//Output: [5,4,3,2,1]</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Example 2:</span>    <span class="hljs-comment">//Input: head = [1,2]</span>    <span class="hljs-comment">//Output: [2,1]</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Example 3:</span>    <span class="hljs-comment">//Input: head = []</span>    <span class="hljs-comment">//Output: []</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Constraints:</span>    <span class="hljs-comment">// The number of nodes in the list is the range [0, 5000].</span>    <span class="hljs-comment">// -5000 &lt;= Node.val &lt;= 5000</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Follow up: A linked list can be reversed either iteratively or recursively. C</span>    <span class="hljs-comment">//ould you implement both?</span>    <span class="hljs-comment">// Related Topics é“¾è¡¨</span>    <span class="hljs-comment">// ğŸ‘ 1568 ğŸ‘ 0</span>     <span class="hljs-comment">//leetcode submit region begin(Prohibit modification and deletion)</span>    <span class="hljs-comment">/**</span><span class="hljs-comment">     * Definition for singly-linked list.</span><span class="hljs-comment">     */</span>    <span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ListNode</span> </span>&#123;        <span class="hljs-keyword">int</span> val;        ListNode next;        ListNode() &#123;&#125;        ListNode(<span class="hljs-keyword">int</span> val) &#123; <span class="hljs-keyword">this</span>.val = val; &#125;        ListNode(<span class="hljs-keyword">int</span> val, ListNode next) &#123; <span class="hljs-keyword">this</span>.val = val; <span class="hljs-keyword">this</span>.next = next; &#125;    &#125;    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span> </span>&#123;        <span class="hljs-function"><span class="hljs-keyword">public</span> ListNode <span class="hljs-title">reverseList</span><span class="hljs-params">(ListNode head)</span> </span>&#123;            ListNode pre = <span class="hljs-keyword">null</span>, cur = head, next = <span class="hljs-keyword">null</span>;            <span class="hljs-keyword">while</span> (cur != <span class="hljs-keyword">null</span>) &#123;                next = cur.next;                cur.next = pre;                pre = cur;                cur = next;            &#125;            <span class="hljs-keyword">return</span> pre;        &#125;    &#125;<span class="hljs-comment">//leetcode submit region end(Prohibit modification and deletion)</span>&#125;</code></pre><p><code>Golang</code></p><pre><code class="hljs Golang"><span class="hljs-keyword">package</span> leetcode<span class="hljs-comment">/**</span><span class="hljs-comment"> * Author: Wang P</span><span class="hljs-comment"> * Version: 1.0.0</span><span class="hljs-comment"> * Date: 2021-03-05 17:46:07</span><span class="hljs-comment"> * Description: //Given the head of a singly linked list, reverse the list, and return the reversed list.</span><span class="hljs-comment">// Example 1:</span><span class="hljs-comment">//Input: head = [1,2,3,4,5]</span><span class="hljs-comment">//Output: [5,4,3,2,1]</span><span class="hljs-comment">//</span><span class="hljs-comment">// Example 2:</span><span class="hljs-comment">//Input: head = [1,2]</span><span class="hljs-comment">//Output: [2,1]</span><span class="hljs-comment">//</span><span class="hljs-comment">// Example 3:</span><span class="hljs-comment">//Input: head = []</span><span class="hljs-comment">//Output: []</span><span class="hljs-comment">//</span><span class="hljs-comment">// Constraints:</span><span class="hljs-comment">// The number of nodes in the list is the range [0, 5000].</span><span class="hljs-comment">// -5000 &lt;= Node.val &lt;= 5000</span><span class="hljs-comment">//</span><span class="hljs-comment">// Follow up: A linked list can be reversed either iteratively or recursively. C</span><span class="hljs-comment">//ould you implement both?</span><span class="hljs-comment">// Related Topics é“¾è¡¨</span><span class="hljs-comment">// ğŸ‘ 1568 ğŸ‘ 0</span><span class="hljs-comment"> **/</span><span class="hljs-comment">//leetcode submit region begin(Prohibit modification and deletion)</span><span class="hljs-comment">/**</span><span class="hljs-comment"> * Definition for singly-linked list.</span><span class="hljs-comment"> */</span><span class="hljs-keyword">type</span> ListNode <span class="hljs-keyword">struct</span> &#123;Val <span class="hljs-keyword">int</span>Next *ListNode&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">reverseList</span><span class="hljs-params">(head *ListNode)</span> *<span class="hljs-title">ListNode</span></span> &#123;<span class="hljs-keyword">var</span> pre, cur, next *ListNode = <span class="hljs-literal">nil</span>, head, <span class="hljs-literal">nil</span><span class="hljs-keyword">for</span> cur != <span class="hljs-literal">nil</span> &#123;next = cur.Nextcur.Next = prepre = curcur = next&#125;<span class="hljs-keyword">return</span> pre&#125;<span class="hljs-comment">//leetcode submit region end(Prohibit modification and deletion)</span></code></pre><p><code>Python</code></p><pre><code class="hljs Python"><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">Module Description: 206-åè½¬é“¾è¡¨</span><span class="hljs-string">Solutionï¼š</span><span class="hljs-string">Date: 2021-03-05 17:45:14</span><span class="hljs-string">Author: Wang P</span><span class="hljs-string">Problem:# åè½¬ä¸€ä¸ªå•é“¾è¡¨ã€‚ </span><span class="hljs-string">        #</span><span class="hljs-string">        #  ç¤ºä¾‹:</span><span class="hljs-string">        #</span><span class="hljs-string">        #  è¾“å…¥: 1-&gt;2-&gt;3-&gt;4-&gt;5-&gt;NULL</span><span class="hljs-string">        # è¾“å‡º: 5-&gt;4-&gt;3-&gt;2-&gt;1-&gt;NULL</span><span class="hljs-string">        #</span><span class="hljs-string">        #  è¿›é˜¶:</span><span class="hljs-string">        # ä½ å¯ä»¥è¿­ä»£æˆ–é€’å½’åœ°åè½¬é“¾è¡¨ã€‚ä½ èƒ½å¦ç”¨ä¸¤ç§æ–¹æ³•è§£å†³è¿™é“é¢˜ï¼Ÿ</span><span class="hljs-string">        #  Related Topics é“¾è¡¨</span><span class="hljs-string">        #  ğŸ‘ 1568 ğŸ‘ 0</span><span class="hljs-string"></span><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-comment"># leetcode submit region begin(Prohibit modification and deletion)</span><span class="hljs-comment"># Definition for singly-linked list.</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ListNode</span>:</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, val=<span class="hljs-number">0</span>, <span class="hljs-built_in">next</span>=<span class="hljs-literal">None</span></span>):</span>        self.val = val        self.<span class="hljs-built_in">next</span> = <span class="hljs-built_in">next</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span>:</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">reverseList</span>(<span class="hljs-params">self, head: ListNode</span>) -&gt; ListNode:</span>        pre, cur, nex = <span class="hljs-literal">None</span>, head, <span class="hljs-literal">None</span>        <span class="hljs-keyword">while</span> cur:            nex = cur.<span class="hljs-built_in">next</span>            cur.<span class="hljs-built_in">next</span> = pre            pre = cur            cur = nex        <span class="hljs-keyword">return</span> pre<span class="hljs-comment"># leetcode submit region end(Prohibit modification and deletion)</span></code></pre><h6 id="92-åè½¬é“¾è¡¨-II"><a href="#92-åè½¬é“¾è¡¨-II" class="headerlink" title="92. åè½¬é“¾è¡¨ II"></a><a href="https://leetcode-cn.com/problems/reverse-linked-list-ii/">92. åè½¬é“¾è¡¨ II</a></h6><p>åè½¬ä»ä½ç½® m åˆ° n çš„é“¾è¡¨ã€‚è¯·ä½¿ç”¨ä¸€è¶Ÿæ‰«æå®Œæˆåè½¬ã€‚</p><p>è¯´æ˜:<br>1 â‰¤ m â‰¤ n â‰¤ é“¾è¡¨é•¿åº¦ã€‚</p><p>ç¤ºä¾‹:</p><pre><code class="hljs angelscript">è¾“å…¥: <span class="hljs-number">1</span>-&gt;<span class="hljs-number">2</span>-&gt;<span class="hljs-number">3</span>-&gt;<span class="hljs-number">4</span>-&gt;<span class="hljs-number">5</span>-&gt;NULL, m = <span class="hljs-number">2</span>, n = <span class="hljs-number">4</span>è¾“å‡º: <span class="hljs-number">1</span>-&gt;<span class="hljs-number">4</span>-&gt;<span class="hljs-number">3</span>-&gt;<span class="hljs-number">2</span>-&gt;<span class="hljs-number">5</span>-&gt;NULL</code></pre><p>è§£é¢˜æ€è·¯</p><pre><code class="hljs angelscript"><span class="hljs-number">1.</span>å…ˆé€šè¿‡è™šæ‹ŸèŠ‚ç‚¹æ‰¾åˆ°é“¾è¡¨åè½¬éƒ¨åˆ†çš„å¤´éƒ¨<span class="hljs-number">2.</span>ä»åè½¬éƒ¨åˆ†çš„å¤´éƒ¨ï¼Œåè½¬n-m+<span class="hljs-number">1</span>ä¸ª<span class="hljs-number">3.</span>å°†åè½¬åçš„éƒ¨åˆ†æ‹¼æ¥ä¸Š</code></pre><p><code>Java</code></p><pre><code class="hljs Java"><span class="hljs-comment">/*</span><span class="hljs-comment"> * Author: Wang P</span><span class="hljs-comment"> * Version: 1.0.0</span><span class="hljs-comment"> * Date: 2021-03-05 19:05:32</span><span class="hljs-comment"> * Description: 92-Reverse Linked List II</span><span class="hljs-comment"> **/</span> <span class="hljs-keyword">package</span> com.weitrue.leetcode.editor.cn;<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ReverseLinkedListIi</span></span>&#123;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span></span>&#123;        Solution s = <span class="hljs-keyword">new</span> ReverseLinkedListIi().<span class="hljs-function">new <span class="hljs-title">Solution</span><span class="hljs-params">()</span></span>;        ListNode n5 = <span class="hljs-keyword">new</span> ReverseLinkedListIi().<span class="hljs-function">new <span class="hljs-title">ListNode</span><span class="hljs-params">(<span class="hljs-number">5</span>, <span class="hljs-keyword">null</span>)</span></span>;        ListNode n4 = <span class="hljs-keyword">new</span> ReverseLinkedListIi().<span class="hljs-function">new <span class="hljs-title">ListNode</span><span class="hljs-params">(<span class="hljs-number">4</span>, n5)</span></span>;        ListNode n3 = <span class="hljs-keyword">new</span> ReverseLinkedListIi().<span class="hljs-function">new <span class="hljs-title">ListNode</span><span class="hljs-params">(<span class="hljs-number">3</span>, n4)</span></span>;        ListNode n2 = <span class="hljs-keyword">new</span> ReverseLinkedListIi().<span class="hljs-function">new <span class="hljs-title">ListNode</span><span class="hljs-params">(<span class="hljs-number">2</span>, n3)</span></span>;        ListNode n1 = <span class="hljs-keyword">new</span> ReverseLinkedListIi().<span class="hljs-function">new <span class="hljs-title">ListNode</span><span class="hljs-params">(<span class="hljs-number">1</span>, n2)</span></span>;        ListNode n = s.reverseBetween(n1, <span class="hljs-number">2</span>, <span class="hljs-number">4</span>);        <span class="hljs-keyword">while</span> (n != <span class="hljs-keyword">null</span> &amp;&amp; n.val &gt; <span class="hljs-number">0</span>) &#123;            System.out.print(n.val);            System.out.print(<span class="hljs-string">&quot;-&gt;&quot;</span>);            n = n.next;        &#125;    &#125;        <span class="hljs-comment">//Given the head of a singly linked list and two integers left and right where left &lt;= right,</span>    <span class="hljs-comment">// reverse the nodes of the list from position left to position right, and return the reversed list.</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Example 1:</span>    <span class="hljs-comment">//Input: head = [1,2,3,4,5], left = 2, right = 4</span>    <span class="hljs-comment">//Output: [1,4,3,2,5]</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Example 2:</span>    <span class="hljs-comment">//Input: head = [5], left = 1, right = 1</span>    <span class="hljs-comment">//Output: [5]</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Constraints:</span>    <span class="hljs-comment">// The number of nodes in the list is n.</span>    <span class="hljs-comment">// 1 &lt;= n &lt;= 500</span>    <span class="hljs-comment">// -500 &lt;= Node.val &lt;= 500</span>    <span class="hljs-comment">// 1 &lt;= left &lt;= right &lt;= n</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">//Follow up: Could you do it in one pass? Related Topics é“¾è¡¨</span>    <span class="hljs-comment">// ğŸ‘ 709 ğŸ‘ 0</span>     <span class="hljs-comment">//leetcode submit region begin(Prohibit modification and deletion)</span>    <span class="hljs-comment">/**</span><span class="hljs-comment">     * Definition for singly-linked list.</span><span class="hljs-comment">     */</span>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ListNode</span> </span>&#123;        <span class="hljs-keyword">int</span> val;        ListNode next;        ListNode() &#123;&#125;        ListNode(<span class="hljs-keyword">int</span> val) &#123; <span class="hljs-keyword">this</span>.val = val; &#125;        ListNode(<span class="hljs-keyword">int</span> val, ListNode next) &#123; <span class="hljs-keyword">this</span>.val = val; <span class="hljs-keyword">this</span>.next = next; &#125;    &#125;    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span> </span>&#123;        <span class="hljs-function"><span class="hljs-keyword">public</span> ListNode <span class="hljs-title">reverseBetween</span><span class="hljs-params">(ListNode head, <span class="hljs-keyword">int</span> left, <span class="hljs-keyword">int</span> right)</span> </span>&#123;            <span class="hljs-comment">// éœ€è¦è™šæ‹ŸèŠ‚ç‚¹</span>            ListNode hair = <span class="hljs-keyword">new</span> ListNode(<span class="hljs-number">0</span>, head), cur = hair ;            <span class="hljs-keyword">int</span> n = right - left + <span class="hljs-number">1</span>;            <span class="hljs-keyword">while</span> (left &gt; <span class="hljs-number">1</span>) &#123;                cur = cur.next;                left--;            &#125;            cur.next = reverse(cur.next, n);            <span class="hljs-keyword">return</span> hair.next;        &#125;        <span class="hljs-function"><span class="hljs-keyword">public</span> ListNode <span class="hljs-title">reverse</span><span class="hljs-params">(ListNode head, <span class="hljs-keyword">int</span> x)</span> </span>&#123;            <span class="hljs-comment">// ä»å¤´èŠ‚ç‚¹å¼€å§‹ï¼Œåè½¬nä¸ªèŠ‚ç‚¹</span>            ListNode pre = <span class="hljs-keyword">new</span> ListNode(<span class="hljs-number">0</span>), cur = head, next = <span class="hljs-keyword">null</span>;            <span class="hljs-keyword">while</span> (x &gt; <span class="hljs-number">0</span>) &#123;                next = cur.next;                cur.next = pre.next;                pre.next = cur;                cur = next;                x--;            &#125;            head.next = cur;            <span class="hljs-keyword">return</span> pre.next;        &#125;            <span class="hljs-function"><span class="hljs-keyword">public</span> ListNode <span class="hljs-title">reverseN</span><span class="hljs-params">(ListNode head, <span class="hljs-keyword">int</span> n)</span> </span>&#123;            <span class="hljs-comment">// é€’å½’æ–¹å¼</span>            <span class="hljs-keyword">if</span> (n == <span class="hljs-number">1</span>) &#123;                <span class="hljs-keyword">return</span> head;            &#125;            ListNode tail = head.next, p = reverseN(head.next, n-<span class="hljs-number">1</span>);            head.next = tail.next;            tail.next = head;            <span class="hljs-keyword">return</span> p;        &#125;    &#125;    <span class="hljs-comment">//leetcode submit region end(Prohibit modification and deletion)</span>&#125;</code></pre><p><code>Golang</code></p><pre><code class="hljs Golang"><span class="hljs-keyword">package</span> leetcode<span class="hljs-comment">/**</span><span class="hljs-comment"> * Author: Wang P</span><span class="hljs-comment"> * Version: 1.0.0</span><span class="hljs-comment"> * Date: 2021-03-05 19:07:45</span><span class="hljs-comment"> * Description: //Given the head of a singly linked list and two integers left and right where left &lt;= right, reverse</span><span class="hljs-comment">                //the nodes of the list from position left to position right, and return the reversed list.</span><span class="hljs-comment">//</span><span class="hljs-comment">// Example 1:</span><span class="hljs-comment">//Input: head = [1,2,3,4,5], left = 2, right = 4</span><span class="hljs-comment">//Output: [1,4,3,2,5]</span><span class="hljs-comment">//</span><span class="hljs-comment">// Example 2:</span><span class="hljs-comment">//Input: head = [5], left = 1, right = 1</span><span class="hljs-comment">//Output: [5]</span><span class="hljs-comment">//</span><span class="hljs-comment">// Constraints:</span><span class="hljs-comment">// The number of nodes in the list is n.</span><span class="hljs-comment">// 1 &lt;= n &lt;= 500</span><span class="hljs-comment">// -500 &lt;= Node.val &lt;= 500</span><span class="hljs-comment">// 1 &lt;= left &lt;= right &lt;= n</span><span class="hljs-comment">//Follow up: Could you do it in one pass? Related Topics é“¾è¡¨</span><span class="hljs-comment">// ğŸ‘ 709 ğŸ‘ 0</span><span class="hljs-comment"></span><span class="hljs-comment"> **/</span><span class="hljs-comment">//leetcode submit region begin(Prohibit modification and deletion)</span><span class="hljs-comment">/**</span><span class="hljs-comment"> * Definition for singly-linked list.</span><span class="hljs-comment"> */</span><span class="hljs-keyword">type</span> ListNode <span class="hljs-keyword">struct</span> &#123;Val <span class="hljs-keyword">int</span>Next *ListNode&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">reverseBetween</span><span class="hljs-params">(head *ListNode, left <span class="hljs-keyword">int</span>, right <span class="hljs-keyword">int</span>)</span> *<span class="hljs-title">ListNode</span></span> &#123;hair := &amp;ListNode&#123;Next:head&#125;cur := hairn := right - left + <span class="hljs-number">1</span><span class="hljs-keyword">for</span> left &gt; <span class="hljs-number">1</span> &#123;cur = cur.Nextleft--&#125;cur.Next = reverse(cur.Next, n)<span class="hljs-keyword">return</span> hair.Next&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">reverse</span><span class="hljs-params">(head *ListNode, n <span class="hljs-keyword">int</span>)</span> *<span class="hljs-title">ListNode</span></span> &#123;pre, next := &amp;ListNode&#123;&#125;, &amp;ListNode&#123;&#125;cur := head<span class="hljs-keyword">for</span> n &gt; <span class="hljs-number">0</span> &#123;next = cur.Nextcur.Next = pre.Nextpre.Next = curcur = nextn--&#125;head.Next = cur<span class="hljs-keyword">return</span> pre.Next&#125;<span class="hljs-comment">//leetcode submit region end(Prohibit modification and deletion)</span></code></pre><p><code>Python</code></p><pre><code class="hljs Python"><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">Module Description: 92-åè½¬é“¾è¡¨ II</span><span class="hljs-string">Solutionï¼š</span><span class="hljs-string">Date: 2021-03-05 19:06:58</span><span class="hljs-string">Author: Wang P</span><span class="hljs-string">Problem:# åè½¬ä»ä½ç½® m åˆ° n çš„é“¾è¡¨ã€‚è¯·ä½¿ç”¨ä¸€è¶Ÿæ‰«æå®Œæˆåè½¬ã€‚ </span><span class="hljs-string">        #</span><span class="hljs-string">        #  è¯´æ˜:</span><span class="hljs-string">        # 1 â‰¤ m â‰¤ n â‰¤ é“¾è¡¨é•¿åº¦ã€‚</span><span class="hljs-string">        #</span><span class="hljs-string">        #  ç¤ºä¾‹:</span><span class="hljs-string">        #</span><span class="hljs-string">        #  è¾“å…¥: 1-&gt;2-&gt;3-&gt;4-&gt;5-&gt;NULL, m = 2, n = 4</span><span class="hljs-string">        # è¾“å‡º: 1-&gt;4-&gt;3-&gt;2-&gt;5-&gt;NULL</span><span class="hljs-string">        #  Related Topics é“¾è¡¨</span><span class="hljs-string">        #  ğŸ‘ 709 ğŸ‘ 0</span><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-comment"># leetcode submit region begin(Prohibit modification and deletion)</span><span class="hljs-comment"># Definition for singly-linked list.</span><span class="hljs-comment"># class ListNode:</span><span class="hljs-comment">#     def __init__(self, val=0, next=None):</span><span class="hljs-comment">#         self.val = val</span><span class="hljs-comment">#         self.next = next</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span>:</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">reverseBetween</span>(<span class="hljs-params">self, head: ListNode, left: <span class="hljs-built_in">int</span>, right: <span class="hljs-built_in">int</span></span>) -&gt; ListNode:</span>        cur = hair = ListNode(<span class="hljs-built_in">next</span>=head)        n = right - left + <span class="hljs-number">1</span>        <span class="hljs-keyword">while</span> left &gt; <span class="hljs-number">1</span>:            cur = cur.<span class="hljs-built_in">next</span>            left -= <span class="hljs-number">1</span>        cur.<span class="hljs-built_in">next</span> = self.reverse(cur.<span class="hljs-built_in">next</span>, n)        <span class="hljs-keyword">return</span> hair.<span class="hljs-built_in">next</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">reverse</span>(<span class="hljs-params">self, head: ListNode, n: <span class="hljs-built_in">int</span></span>) -&gt; ListNode:</span>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> head:            <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span>        pre, cur, nex = ListNode(), head, <span class="hljs-literal">None</span>        <span class="hljs-keyword">while</span> n &gt; <span class="hljs-number">0</span>:            nex = cur.<span class="hljs-built_in">next</span>            cur.<span class="hljs-built_in">next</span> = pre.<span class="hljs-built_in">next</span>            pre.<span class="hljs-built_in">next</span> = cur            cur = nex            n -= <span class="hljs-number">1</span>        head.<span class="hljs-built_in">next</span> = cur        <span class="hljs-keyword">return</span> pre.<span class="hljs-built_in">next</span><span class="hljs-comment"># leetcode submit region end(Prohibit modification and deletion)</span></code></pre><h6 id="25-K-ä¸ªä¸€ç»„ç¿»è½¬é“¾è¡¨"><a href="#25-K-ä¸ªä¸€ç»„ç¿»è½¬é“¾è¡¨" class="headerlink" title="25. K ä¸ªä¸€ç»„ç¿»è½¬é“¾è¡¨"></a><a href="https://leetcode-cn.com/problems/reverse-nodes-in-k-group/">25. K ä¸ªä¸€ç»„ç¿»è½¬é“¾è¡¨</a></h6><p>ç»™ä½ ä¸€ä¸ªé“¾è¡¨ï¼Œæ¯ k ä¸ªèŠ‚ç‚¹ä¸€ç»„è¿›è¡Œç¿»è½¬ï¼Œè¯·ä½ è¿”å›ç¿»è½¬åçš„é“¾è¡¨ã€‚</p><p>k æ˜¯ä¸€ä¸ªæ­£æ•´æ•°ï¼Œå®ƒçš„å€¼å°äºæˆ–ç­‰äºé“¾è¡¨çš„é•¿åº¦ã€‚</p><p>å¦‚æœèŠ‚ç‚¹æ€»æ•°ä¸æ˜¯ k çš„æ•´æ•°å€ï¼Œé‚£ä¹ˆè¯·å°†æœ€åå‰©ä½™çš„èŠ‚ç‚¹ä¿æŒåŸæœ‰é¡ºåºã€‚</p><p>è¿›é˜¶ï¼š</p><p>ä½ å¯ä»¥è®¾è®¡ä¸€ä¸ªåªä½¿ç”¨å¸¸æ•°é¢å¤–ç©ºé—´çš„ç®—æ³•æ¥è§£å†³æ­¤é—®é¢˜å—ï¼Ÿ<br>ä½ ä¸èƒ½åªæ˜¯å•çº¯çš„æ”¹å˜èŠ‚ç‚¹å†…éƒ¨çš„å€¼ï¼Œè€Œæ˜¯éœ€è¦å®é™…è¿›è¡ŒèŠ‚ç‚¹äº¤æ¢ã€‚</p><p><strong>ç¤ºä¾‹ 1</strong>ï¼š</p><p><img src="https://assets.leetcode.com/uploads/2020/10/03/reverse_ex1.jpg"></p><pre><code class="hljs angelscript">è¾“å…¥ï¼šhead = [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>], k = <span class="hljs-number">2</span>è¾“å‡ºï¼š[<span class="hljs-number">2</span>,<span class="hljs-number">1</span>,<span class="hljs-number">4</span>,<span class="hljs-number">3</span>,<span class="hljs-number">5</span>]</code></pre><p><strong>ç¤ºä¾‹ 2ï¼š</strong></p><p><img src="https://assets.leetcode.com/uploads/2020/10/03/reverse_ex2.jpg"></p><pre><code class="hljs angelscript">è¾“å…¥ï¼šhead = [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>], k = <span class="hljs-number">3</span>è¾“å‡ºï¼š[<span class="hljs-number">3</span>,<span class="hljs-number">2</span>,<span class="hljs-number">1</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>]</code></pre><p><strong>ç¤ºä¾‹ 3ï¼š</strong></p><pre><code class="hljs angelscript">è¾“å…¥ï¼šhead = [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>], k = <span class="hljs-number">1</span>è¾“å‡ºï¼š[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>]</code></pre><p><strong>ç¤ºä¾‹ 4ï¼š</strong></p><pre><code class="hljs angelscript">è¾“å…¥ï¼šhead = [<span class="hljs-number">1</span>], k = <span class="hljs-number">1</span>è¾“å‡ºï¼š[<span class="hljs-number">1</span>]</code></pre><p><strong>æç¤ºï¼š</strong></p><ul><li>åˆ—è¡¨ä¸­èŠ‚ç‚¹çš„æ•°é‡åœ¨èŒƒå›´ <code>sz</code> å†…</li><li><code>1 &lt;= sz &lt;= 5000</code></li><li><code>0 &lt;= Node.val &lt;= 1000</code></li><li><code>1 &lt;= k &lt;= sz</code></li></ul><p>è§£é¢˜æ€è·¯</p><pre><code class="hljs cos">å°†é“¾è¡¨åˆ†æˆsz<span class="hljs-built_in">%k</span>é“¾è¡¨è¿›è¡Œåè½¬ï¼Œç„¶åæ‹¼æ¥æœ«å°¾éƒ¨åˆ†</code></pre><p><code>Java</code></p><pre><code class="hljs Java"><span class="hljs-comment">/*</span><span class="hljs-comment"> * Author: Wang P</span><span class="hljs-comment"> * Version: 1.0.0</span><span class="hljs-comment"> * Date: 2021-03-06 17:42:34</span><span class="hljs-comment"> * Description: 25-Reverse Nodes in k-Group</span><span class="hljs-comment"> **/</span> <span class="hljs-keyword">package</span> com.weitrue.leetcode.editor.cn;<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ReverseNodesInKGroup</span></span>&#123;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span></span>&#123;        Solution s = <span class="hljs-keyword">new</span> ReverseNodesInKGroup().<span class="hljs-function">new <span class="hljs-title">Solution</span><span class="hljs-params">()</span></span>;    &#125;        <span class="hljs-comment">//Given a linked list, reverse the nodes of a linked list k at a time and return its modified list. </span>    <span class="hljs-comment">//k is a positive integer and is less than or equal to the length of the linked list. If the number of nodes is not a multiple of k then left-out nodes, in the end, should remain as it is. </span>    <span class="hljs-comment">// Follow up: </span>    <span class="hljs-comment">// Could you solve the problem in O(1) extra memory space? </span>    <span class="hljs-comment">// You may not alter the values in the list&#x27;s nodes, only nodes itself may be changed. </span>     <span class="hljs-comment">// Example 1: </span>    <span class="hljs-comment">//Input: head = [1,2,3,4,5], k = 2</span>    <span class="hljs-comment">//Output: [2,1,4,3,5]</span>    <span class="hljs-comment">// Example 2: </span>    <span class="hljs-comment">//Input: head = [1,2,3,4,5], k = 3</span>    <span class="hljs-comment">//Output: [3,2,1,4,5]</span>    <span class="hljs-comment">// Example 3: </span>    <span class="hljs-comment">//Input: head = [1,2,3,4,5], k = 1</span>    <span class="hljs-comment">//Output: [1,2,3,4,5]</span>    <span class="hljs-comment">// Example 4: </span>    <span class="hljs-comment">//Input: head = [1], k = 1</span>    <span class="hljs-comment">//Output: [1]</span>    <span class="hljs-comment">// Constraints: </span>    <span class="hljs-comment">// The number of nodes in the list is in the range sz. </span>    <span class="hljs-comment">// 1 &lt;= sz &lt;= 5000 </span>    <span class="hljs-comment">// 0 &lt;= Node.val &lt;= 1000 </span>    <span class="hljs-comment">// 1 &lt;= k &lt;= sz </span>    <span class="hljs-comment">// </span>    <span class="hljs-comment">// Related Topics é“¾è¡¨ </span>    <span class="hljs-comment">// ğŸ‘ 977 ğŸ‘ 0</span>     <span class="hljs-comment">//leetcode submit region begin(Prohibit modification and deletion)</span>    <span class="hljs-comment">/**</span><span class="hljs-comment">     * Definition for singly-linked list.</span><span class="hljs-comment">     */</span>    <span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ListNode</span> </span>&#123;        <span class="hljs-keyword">int</span> val;        ListNode next;        ListNode() &#123;&#125;        ListNode(<span class="hljs-keyword">int</span> val) &#123; <span class="hljs-keyword">this</span>.val = val; &#125;        ListNode(<span class="hljs-keyword">int</span> val, ListNode next) &#123; <span class="hljs-keyword">this</span>.val = val; <span class="hljs-keyword">this</span>.next = next; &#125;    &#125;    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span> </span>&#123;        <span class="hljs-function"><span class="hljs-keyword">public</span> ListNode <span class="hljs-title">reverseKGroup</span><span class="hljs-params">(ListNode head, <span class="hljs-keyword">int</span> k)</span> </span>&#123;            ListNode hair = <span class="hljs-keyword">new</span> ListNode(<span class="hljs-number">0</span>, head), pre = hair, tail = pre;            <span class="hljs-keyword">while</span> (head != <span class="hljs-keyword">null</span>) &#123;                <span class="hljs-comment">//tail = pre;</span>                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>; i&lt;k; i++) &#123;                    tail = tail.next;                    <span class="hljs-keyword">if</span> (tail == <span class="hljs-keyword">null</span>) &#123;                        <span class="hljs-keyword">return</span> hair.next;                    &#125;                &#125;                <span class="hljs-comment">// åè½¬é•¿åº¦ä¸ºkçš„é“¾è¡¨ï¼Œå¹¶è¿”å›é“¾è¡¨çš„æ–°å¤´å°¾èŠ‚ç‚¹</span>                ListNode[] ln = reverse(head, tail);                head = ln[<span class="hljs-number">0</span>];                tail = ln[<span class="hljs-number">1</span>];                pre.next = head;                pre = tail;                head = pre.next;            &#125;            <span class="hljs-keyword">return</span> hair.next;        &#125;        <span class="hljs-keyword">public</span> ListNode[] reverse(ListNode head, ListNode tail)&#123;            ListNode pre = tail.next, cur = head, next = <span class="hljs-keyword">null</span>;            <span class="hljs-keyword">while</span> (tail != pre) &#123;                next = cur.next;                cur.next = pre;                pre = cur;                cur = next;            &#125;            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ListNode[]&#123;tail, head&#125;;        &#125;    &#125;<span class="hljs-comment">//leetcode submit region end(Prohibit modification and deletion)</span>&#125;</code></pre><p><code>Golang</code></p><pre><code class="hljs Golang"><span class="hljs-keyword">package</span> leetcode<span class="hljs-comment">/**</span><span class="hljs-comment"> * Author: Wang P</span><span class="hljs-comment"> * Version: 1.0.0</span><span class="hljs-comment"> * Date: 2021-03-18 18:38:00</span><span class="hljs-comment"> * Description: //Given a linked list, reverse the nodes of a linked list k at a time and return its modified list.</span><span class="hljs-comment">// k is a positive integer and is less than or equal to the length of the linked</span><span class="hljs-comment">// list. If the number of nodes is not a multiple of k then left-out nodes, in the</span><span class="hljs-comment">// end, should remain as it is.</span><span class="hljs-comment">// Follow up:</span><span class="hljs-comment">// Could you solve the problem in O(1) extra memory space?</span><span class="hljs-comment">// You may not alter the values in the list&#x27;s nodes, only nodes itself may be changed.</span><span class="hljs-comment">//</span><span class="hljs-comment">// Example 1:</span><span class="hljs-comment">//Input: head = [1,2,3,4,5], k = 2</span><span class="hljs-comment">//Output: [2,1,4,3,5]</span><span class="hljs-comment">//</span><span class="hljs-comment">// Example 2:</span><span class="hljs-comment">//Input: head = [1,2,3,4,5], k = 3</span><span class="hljs-comment">//Output: [3,2,1,4,5]</span><span class="hljs-comment">//</span><span class="hljs-comment">// Example 3:</span><span class="hljs-comment">//Input: head = [1,2,3,4,5], k = 1</span><span class="hljs-comment">//Output: [1,2,3,4,5]</span><span class="hljs-comment">//</span><span class="hljs-comment">// Example 4:</span><span class="hljs-comment">//Input: head = [1], k = 1</span><span class="hljs-comment">//Output: [1]</span><span class="hljs-comment">//</span><span class="hljs-comment">// Constraints:</span><span class="hljs-comment">// The number of nodes in the list is in the range sz.</span><span class="hljs-comment">// 1 &lt;= sz &lt;= 5000</span><span class="hljs-comment">// 0 &lt;= Node.val &lt;= 1000</span><span class="hljs-comment">// 1 &lt;= k &lt;= sz</span><span class="hljs-comment">// Related Topics é“¾è¡¨</span><span class="hljs-comment">// ğŸ‘ 977 ğŸ‘ 0</span><span class="hljs-comment"></span><span class="hljs-comment"> **/</span><span class="hljs-comment">//leetcode submit region begin(Prohibit modification and deletion)</span><span class="hljs-comment">/**</span><span class="hljs-comment"> * Definition for singly-linked list.</span><span class="hljs-comment"> */</span><span class="hljs-keyword">type</span> ListNode <span class="hljs-keyword">struct</span> &#123;    Val <span class="hljs-keyword">int</span>    Next *ListNode&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">reverseKGroup</span><span class="hljs-params">(head *ListNode, k <span class="hljs-keyword">int</span>)</span> *<span class="hljs-title">ListNode</span></span> &#123;hair := &amp;ListNode&#123;Next:head&#125;pre, tail := hair, hair<span class="hljs-keyword">for</span> head != <span class="hljs-literal">nil</span> &#123;<span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; k; i++ &#123;tail = tail.Next<span class="hljs-keyword">if</span> tail == <span class="hljs-literal">nil</span> &#123;<span class="hljs-keyword">return</span> hair.Next&#125;&#125;head, tail = reverseK(head, tail)pre.Next = headpre = tailhead = pre.Next&#125;<span class="hljs-keyword">return</span> hair.Next&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">reverseK</span><span class="hljs-params">(head, tail *ListNode)</span> <span class="hljs-params">(*ListNode, *ListNode)</span></span> &#123;pre, cur, next := tail.Next, head, &amp;ListNode&#123;&#125;<span class="hljs-keyword">for</span> pre != tail &#123;next = cur.Nextcur.Next = prepre = curcur = next&#125;<span class="hljs-keyword">return</span> tail, head&#125;<span class="hljs-comment">//leetcode submit region end(Prohibit modification and deletion)</span></code></pre><p><code>Python</code></p><pre><code class="hljs Python"><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">Module Description: 25-K ä¸ªä¸€ç»„ç¿»è½¬é“¾è¡¨</span><span class="hljs-string">Solutionï¼š</span><span class="hljs-string">Date: 2021-03-06 18:15:19</span><span class="hljs-string">Author: Wang P</span><span class="hljs-string">Problem:# ç»™ä½ ä¸€ä¸ªé“¾è¡¨ï¼Œæ¯ k ä¸ªèŠ‚ç‚¹ä¸€ç»„è¿›è¡Œç¿»è½¬ï¼Œè¯·ä½ è¿”å›ç¿»è½¬åçš„é“¾è¡¨ã€‚ </span><span class="hljs-string">        #  k æ˜¯ä¸€ä¸ªæ­£æ•´æ•°ï¼Œå®ƒçš„å€¼å°äºæˆ–ç­‰äºé“¾è¡¨çš„é•¿åº¦ã€‚</span><span class="hljs-string">        #  å¦‚æœèŠ‚ç‚¹æ€»æ•°ä¸æ˜¯ k çš„æ•´æ•°å€ï¼Œé‚£ä¹ˆè¯·å°†æœ€åå‰©ä½™çš„èŠ‚ç‚¹ä¿æŒåŸæœ‰é¡ºåºã€‚</span><span class="hljs-string">        #  è¿›é˜¶ï¼š</span><span class="hljs-string">        #  ä½ å¯ä»¥è®¾è®¡ä¸€ä¸ªåªä½¿ç”¨å¸¸æ•°é¢å¤–ç©ºé—´çš„ç®—æ³•æ¥è§£å†³æ­¤é—®é¢˜å—ï¼Ÿ</span><span class="hljs-string">        #  ä½ ä¸èƒ½åªæ˜¯å•çº¯çš„æ”¹å˜èŠ‚ç‚¹å†…éƒ¨çš„å€¼ï¼Œè€Œæ˜¯éœ€è¦å®é™…è¿›è¡ŒèŠ‚ç‚¹äº¤æ¢ã€‚</span><span class="hljs-string">        #</span><span class="hljs-string">        #  ç¤ºä¾‹ 1ï¼š</span><span class="hljs-string">        # è¾“å…¥ï¼šhead = [1,2,3,4,5], k = 2</span><span class="hljs-string">        # è¾“å‡ºï¼š[2,1,4,3,5]</span><span class="hljs-string">        #</span><span class="hljs-string">        #  ç¤ºä¾‹ 2ï¼š</span><span class="hljs-string">        # è¾“å…¥ï¼šhead = [1,2,3,4,5], k = 3</span><span class="hljs-string">        # è¾“å‡ºï¼š[3,2,1,4,5]</span><span class="hljs-string">        #</span><span class="hljs-string">        #  ç¤ºä¾‹ 3ï¼š</span><span class="hljs-string">        # è¾“å…¥ï¼šhead = [1,2,3,4,5], k = 1</span><span class="hljs-string">        # è¾“å‡ºï¼š[1,2,3,4,5]</span><span class="hljs-string">        #</span><span class="hljs-string">        #  ç¤ºä¾‹ 4ï¼š</span><span class="hljs-string">        # è¾“å…¥ï¼šhead = [1], k = 1</span><span class="hljs-string">        # è¾“å‡ºï¼š[1]</span><span class="hljs-string">        #</span><span class="hljs-string">        #  æç¤ºï¼š</span><span class="hljs-string">        #  åˆ—è¡¨ä¸­èŠ‚ç‚¹çš„æ•°é‡åœ¨èŒƒå›´ sz å†…</span><span class="hljs-string">        #  1 &lt;= sz &lt;= 5000</span><span class="hljs-string">        #  0 &lt;= Node.val &lt;= 1000</span><span class="hljs-string">        #  1 &lt;= k &lt;= sz</span><span class="hljs-string">        #</span><span class="hljs-string">        #  Related Topics é“¾è¡¨</span><span class="hljs-string">        #  ğŸ‘ 977 ğŸ‘ 0</span><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-comment"># leetcode submit region begin(Prohibit modification and deletion)</span><span class="hljs-comment"># Definition for singly-linked list.</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ListNode</span>:</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, val=<span class="hljs-number">0</span>, <span class="hljs-built_in">next</span>=<span class="hljs-literal">None</span></span>):</span>        self.val = val        self.<span class="hljs-built_in">next</span> = <span class="hljs-built_in">next</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span>:</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">reverseKGroup</span>(<span class="hljs-params">self, head: ListNode, k: <span class="hljs-built_in">int</span></span>) -&gt; ListNode:</span>        tail = pre = hair = ListNode(<span class="hljs-built_in">next</span>=head)        <span class="hljs-keyword">while</span> head:            <span class="hljs-comment"># tail = pre</span>            <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, k):                tail = tail.<span class="hljs-built_in">next</span>                <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> tail:                    <span class="hljs-keyword">return</span> hair.<span class="hljs-built_in">next</span>            head, tail = self.reverse(head, tail)            pre.<span class="hljs-built_in">next</span> = head            pre = tail            head = pre.<span class="hljs-built_in">next</span>        <span class="hljs-keyword">return</span> hair.<span class="hljs-built_in">next</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">reverse</span>(<span class="hljs-params">self, head, tail: ListNode</span>) -&gt; (ListNode, ListNode):</span>        pre, cur, nex = tail.<span class="hljs-built_in">next</span>, head, <span class="hljs-literal">None</span>        <span class="hljs-keyword">while</span> pre != tail:            nex = cur.<span class="hljs-built_in">next</span>            cur.<span class="hljs-built_in">next</span> = pre            pre = cur            cur = nex        <span class="hljs-keyword">return</span> tail, head<span class="hljs-comment"># leetcode submit region end(Prohibit modification and deletion)</span></code></pre><h6 id="61-æ—‹è½¬é“¾è¡¨"><a href="#61-æ—‹è½¬é“¾è¡¨" class="headerlink" title="61. æ—‹è½¬é“¾è¡¨"></a><a href="https://leetcode-cn.com/problems/rotate-list/">61. æ—‹è½¬é“¾è¡¨</a></h6><p>ç»™å®šä¸€ä¸ªé“¾è¡¨ï¼Œæ—‹è½¬é“¾è¡¨ï¼Œå°†é“¾è¡¨æ¯ä¸ªèŠ‚ç‚¹å‘å³ç§»åŠ¨ <em>k</em> ä¸ªä½ç½®ï¼Œå…¶ä¸­ <em>k</em> æ˜¯éè´Ÿæ•°ã€‚</p><p><strong>ç¤ºä¾‹ 1:</strong></p><pre><code class="hljs angelscript">è¾“å…¥: <span class="hljs-number">1</span>-&gt;<span class="hljs-number">2</span>-&gt;<span class="hljs-number">3</span>-&gt;<span class="hljs-number">4</span>-&gt;<span class="hljs-number">5</span>-&gt;NULL, k = <span class="hljs-number">2</span>è¾“å‡º: <span class="hljs-number">4</span>-&gt;<span class="hljs-number">5</span>-&gt;<span class="hljs-number">1</span>-&gt;<span class="hljs-number">2</span>-&gt;<span class="hljs-number">3</span>-&gt;NULLè§£é‡Š:å‘å³æ—‹è½¬ <span class="hljs-number">1</span> æ­¥: <span class="hljs-number">5</span>-&gt;<span class="hljs-number">1</span>-&gt;<span class="hljs-number">2</span>-&gt;<span class="hljs-number">3</span>-&gt;<span class="hljs-number">4</span>-&gt;NULLå‘å³æ—‹è½¬ <span class="hljs-number">2</span> æ­¥: <span class="hljs-number">4</span>-&gt;<span class="hljs-number">5</span>-&gt;<span class="hljs-number">1</span>-&gt;<span class="hljs-number">2</span>-&gt;<span class="hljs-number">3</span>-&gt;NULL</code></pre><p><strong>ç¤ºä¾‹ 2:</strong></p><pre><code class="hljs angelscript">è¾“å…¥: <span class="hljs-number">0</span>-&gt;<span class="hljs-number">1</span>-&gt;<span class="hljs-number">2</span>-&gt;NULL, k = <span class="hljs-number">4</span>è¾“å‡º: <span class="hljs-number">2</span>-&gt;<span class="hljs-number">0</span>-&gt;<span class="hljs-number">1</span>-&gt;NULLè§£é‡Š:å‘å³æ—‹è½¬ <span class="hljs-number">1</span> æ­¥: <span class="hljs-number">2</span>-&gt;<span class="hljs-number">0</span>-&gt;<span class="hljs-number">1</span>-&gt;NULLå‘å³æ—‹è½¬ <span class="hljs-number">2</span> æ­¥: <span class="hljs-number">1</span>-&gt;<span class="hljs-number">2</span>-&gt;<span class="hljs-number">0</span>-&gt;NULLå‘å³æ—‹è½¬ <span class="hljs-number">3</span> æ­¥:Â <span class="hljs-number">0</span>-&gt;<span class="hljs-number">1</span>-&gt;<span class="hljs-number">2</span>-&gt;NULLå‘å³æ—‹è½¬ <span class="hljs-number">4</span> æ­¥:Â <span class="hljs-number">2</span>-&gt;<span class="hljs-number">0</span>-&gt;<span class="hljs-number">1</span>-&gt;NULL</code></pre><p>è§£é¢˜æ€è·¯</p><pre><code class="hljs angelscript"><span class="hljs-number">1.</span>å…ˆå°†é“¾è¡¨é¦–å°¾ç›¸è¿å¹¶è·å–é“¾è¡¨çš„é•¿åº¦<span class="hljs-number">2.</span>æ‰¾åˆ°æ–°é“¾è¡¨è¦æ–­å¼€çš„å‰ä¸€ä¸ªèŠ‚ç‚¹ï¼Œåç»§æŒ‡å‘<span class="hljs-literal">null</span></code></pre><p><code>Java</code></p><pre><code class="hljs Java"><span class="hljs-comment">/*</span><span class="hljs-comment"> * Author: Wang P</span><span class="hljs-comment"> * Version: 1.0.0</span><span class="hljs-comment"> * Date: 2021-03-06 20:20:15</span><span class="hljs-comment"> * Description: 61-Rotate List</span><span class="hljs-comment"> **/</span> <span class="hljs-keyword">package</span> com.weitrue.leetcode.editor.cn;<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RotateList</span></span>&#123;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span></span>&#123;        Solution s = <span class="hljs-keyword">new</span> RotateList().<span class="hljs-function">new <span class="hljs-title">Solution</span><span class="hljs-params">()</span></span>;        ListNode n5 = <span class="hljs-keyword">new</span> RotateList().<span class="hljs-function">new <span class="hljs-title">ListNode</span><span class="hljs-params">(<span class="hljs-number">5</span>, <span class="hljs-keyword">null</span>)</span></span>;        ListNode n4 = <span class="hljs-keyword">new</span> RotateList().<span class="hljs-function">new <span class="hljs-title">ListNode</span><span class="hljs-params">(<span class="hljs-number">4</span>, n5)</span></span>;        ListNode n3 = <span class="hljs-keyword">new</span> RotateList().<span class="hljs-function">new <span class="hljs-title">ListNode</span><span class="hljs-params">(<span class="hljs-number">3</span>, n4)</span></span>;        ListNode n2 = <span class="hljs-keyword">new</span> RotateList().<span class="hljs-function">new <span class="hljs-title">ListNode</span><span class="hljs-params">(<span class="hljs-number">2</span>, n3)</span></span>;        ListNode n1 = <span class="hljs-keyword">new</span> RotateList().<span class="hljs-function">new <span class="hljs-title">ListNode</span><span class="hljs-params">(<span class="hljs-number">1</span>, n2)</span></span>;        ListNode n = s.rotateRight(n1, <span class="hljs-number">2</span>);        <span class="hljs-keyword">while</span> (n != <span class="hljs-keyword">null</span>) &#123;            System.out.print(n.val);            System.out.print(<span class="hljs-string">&quot;-&gt;&quot;</span>);            n = n.next;        &#125;    &#125;        <span class="hljs-comment">//Given the head of a linked list, rotate the list to the right by k places. </span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Example 1:</span>    <span class="hljs-comment">//Input: head = [1,2,3,4,5], k = 2</span>    <span class="hljs-comment">//Output: [4,5,1,2,3]</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Example 2:</span>    <span class="hljs-comment">//Input: head = [0,1,2], k = 4</span>    <span class="hljs-comment">//Output: [2,0,1]</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Constraints:</span>    <span class="hljs-comment">// The number of nodes in the list is in the range [0, 500].</span>    <span class="hljs-comment">// -100 &lt;= Node.val &lt;= 100</span>    <span class="hljs-comment">// 0 &lt;= k &lt;= 2 * 109</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Related Topics é“¾è¡¨ åŒæŒ‡é’ˆ</span>    <span class="hljs-comment">// ğŸ‘ 444 ğŸ‘ 0</span>    <span class="hljs-comment">//leetcode submit region begin(Prohibit modification and deletion)</span>    <span class="hljs-comment">/**</span><span class="hljs-comment">     * Definition for singly-linked list.</span><span class="hljs-comment">     */</span>     <span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ListNode</span> </span>&#123;         <span class="hljs-keyword">int</span> val;         ListNode next;         ListNode() &#123;&#125;         ListNode(<span class="hljs-keyword">int</span> val) &#123; <span class="hljs-keyword">this</span>.val = val; &#125;         ListNode(<span class="hljs-keyword">int</span> val, ListNode next) &#123; <span class="hljs-keyword">this</span>.val = val; <span class="hljs-keyword">this</span>.next = next; &#125;     &#125;    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span> </span>&#123;        <span class="hljs-function"><span class="hljs-keyword">public</span> ListNode <span class="hljs-title">rotateRight</span><span class="hljs-params">(ListNode head, <span class="hljs-keyword">int</span> k)</span> </span>&#123;            <span class="hljs-keyword">if</span> (head == <span class="hljs-keyword">null</span> || head.next == <span class="hljs-keyword">null</span>) &#123;                <span class="hljs-keyword">return</span> head;            &#125;            <span class="hljs-keyword">int</span> length = <span class="hljs-number">1</span>;            ListNode oldTail = head;            <span class="hljs-keyword">while</span> (oldTail.next != <span class="hljs-keyword">null</span>) &#123;                oldTail = oldTail.next;                length++;            &#125;            oldTail.next = head;            ListNode newTail = head;            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; length - (k % length) - <span class="hljs-number">1</span>; i++)&#123;                newTail = newTail.next;            &#125;            ListNode newHead = newTail.next;            newTail.next = <span class="hljs-keyword">null</span>;            <span class="hljs-keyword">return</span> newHead;        &#125;    &#125;    <span class="hljs-comment">//leetcode submit region end(Prohibit modification and deletion)</span>&#125;</code></pre><p><code>Golang</code></p><pre><code class="hljs Golang"><span class="hljs-keyword">package</span> leetcode<span class="hljs-comment">/**</span><span class="hljs-comment"> * Author: Wang P</span><span class="hljs-comment"> * Version: 1.0.0</span><span class="hljs-comment"> * Date: 2021-03-06 20:26:17</span><span class="hljs-comment"> * Description:  Given the head of a linked list, rotate the list to the right by k places.</span><span class="hljs-comment"></span><span class="hljs-comment"> Example 1:</span><span class="hljs-comment">Input: head = [1,2,3,4,5], k = 2</span><span class="hljs-comment">Output: [4,5,1,2,3]</span><span class="hljs-comment"></span><span class="hljs-comment"> Example 2:</span><span class="hljs-comment">Input: head = [0,1,2], k = 4</span><span class="hljs-comment">Output: [2,0,1]</span><span class="hljs-comment"></span><span class="hljs-comment"> Constraints:</span><span class="hljs-comment"> The number of nodes in the list is in the range [0, 500].</span><span class="hljs-comment"> -100 &lt;= Node.val &lt;= 100</span><span class="hljs-comment"> 0 &lt;= k &lt;= 2 * 109</span><span class="hljs-comment"></span><span class="hljs-comment"> Related Topics é“¾è¡¨ åŒæŒ‡é’ˆ</span><span class="hljs-comment"> ğŸ‘ 444 ğŸ‘ 0</span><span class="hljs-comment"> **/</span><span class="hljs-comment">//leetcode submit region begin(Prohibit modification and deletion)</span><span class="hljs-comment">/**</span><span class="hljs-comment"> * Definition for singly-linked list.</span><span class="hljs-comment"> * type ListNode struct &#123;</span><span class="hljs-comment"> *     Val int</span><span class="hljs-comment"> *     Next *ListNode</span><span class="hljs-comment"> * &#125;</span><span class="hljs-comment"> */</span><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">rotateRight</span><span class="hljs-params">(head *ListNode, k <span class="hljs-keyword">int</span>)</span> *<span class="hljs-title">ListNode</span></span> &#123;<span class="hljs-keyword">if</span> head == <span class="hljs-literal">nil</span> || head.Next == <span class="hljs-literal">nil</span> &#123;<span class="hljs-keyword">return</span> head&#125;oldTail := headlength := <span class="hljs-number">1</span><span class="hljs-keyword">for</span> oldTail.Next != <span class="hljs-literal">nil</span> &#123;oldTail = oldTail.Nextlength++&#125;oldTail.Next = headnewTail := head<span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; length - k%length <span class="hljs-number">-1</span>; i++ &#123;newTail = newTail.Next&#125;head = newTail.NextnewTail.Next = <span class="hljs-literal">nil</span><span class="hljs-keyword">return</span> head&#125;<span class="hljs-comment">//leetcode submit region end(Prohibit modification and deletion)</span></code></pre><p><code>Python</code></p><pre><code class="hljs Python"><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">Module Description: 61-æ—‹è½¬é“¾è¡¨</span><span class="hljs-string">Solutionï¼š</span><span class="hljs-string">Date: 2021-03-06 20:23:59</span><span class="hljs-string">Author: Wang P</span><span class="hljs-string">Problem:  ç»™å®šä¸€ä¸ªé“¾è¡¨ï¼Œæ—‹è½¬é“¾è¡¨ï¼Œå°†é“¾è¡¨æ¯ä¸ªèŠ‚ç‚¹å‘å³ç§»åŠ¨ k ä¸ªä½ç½®ï¼Œå…¶ä¸­ k æ˜¯éè´Ÿæ•°ã€‚</span><span class="hljs-string"></span><span class="hljs-string">          ç¤ºä¾‹ 1:</span><span class="hljs-string">          è¾“å…¥: 1-&gt;2-&gt;3-&gt;4-&gt;5-&gt;NULL, k = 2</span><span class="hljs-string">         è¾“å‡º: 4-&gt;5-&gt;1-&gt;2-&gt;3-&gt;NULL</span><span class="hljs-string">         è§£é‡Š:</span><span class="hljs-string">         å‘å³æ—‹è½¬ 1 æ­¥: 5-&gt;1-&gt;2-&gt;3-&gt;4-&gt;NULL</span><span class="hljs-string">         å‘å³æ—‹è½¬ 2 æ­¥: 4-&gt;5-&gt;1-&gt;2-&gt;3-&gt;NULL</span><span class="hljs-string"></span><span class="hljs-string">          ç¤ºä¾‹ 2:</span><span class="hljs-string">          è¾“å…¥: 0-&gt;1-&gt;2-&gt;NULL, k = 4</span><span class="hljs-string">         è¾“å‡º: 2-&gt;0-&gt;1-&gt;NULL</span><span class="hljs-string">         è§£é‡Š:</span><span class="hljs-string">         å‘å³æ—‹è½¬ 1 æ­¥: 2-&gt;0-&gt;1-&gt;NULL</span><span class="hljs-string">         å‘å³æ—‹è½¬ 2 æ­¥: 1-&gt;2-&gt;0-&gt;NULL</span><span class="hljs-string">         å‘å³æ—‹è½¬ 3 æ­¥:Â 0-&gt;1-&gt;2-&gt;NULL</span><span class="hljs-string">         å‘å³æ—‹è½¬ 4 æ­¥:Â 2-&gt;0-&gt;1-&gt;NULL</span><span class="hljs-string">          Related Topics é“¾è¡¨ åŒæŒ‡é’ˆ</span><span class="hljs-string">          ğŸ‘ 444 ğŸ‘ 0</span><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-comment"># leetcode submit region begin(Prohibit modification and deletion)</span><span class="hljs-comment"># Definition for singly-linked list.</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ListNode</span>:</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, val=<span class="hljs-number">0</span>, <span class="hljs-built_in">next</span>=<span class="hljs-literal">None</span></span>):</span>        self.val = val        self.<span class="hljs-built_in">next</span> = <span class="hljs-built_in">next</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span>:</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">rotateRight</span>(<span class="hljs-params">self, head: ListNode, k: <span class="hljs-built_in">int</span></span>) -&gt; ListNode:</span>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> head <span class="hljs-keyword">or</span> <span class="hljs-keyword">not</span> head.<span class="hljs-built_in">next</span>:            <span class="hljs-keyword">return</span> head        old_tail = head        length = <span class="hljs-number">1</span>        <span class="hljs-keyword">while</span> old_tail.<span class="hljs-built_in">next</span>:            old_tail = old_tail.<span class="hljs-built_in">next</span>            length += <span class="hljs-number">1</span>        old_tail.<span class="hljs-built_in">next</span> = head        new_tail = head        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, length - (k % length) - <span class="hljs-number">1</span>):            new_tail = new_tail.<span class="hljs-built_in">next</span>        head = new_tail.<span class="hljs-built_in">next</span>        new_tail.<span class="hljs-built_in">next</span> = <span class="hljs-literal">None</span>        <span class="hljs-keyword">return</span> head<span class="hljs-comment"># leetcode submit region end(Prohibit modification and deletion)</span></code></pre><h6 id="24-ä¸¤ä¸¤äº¤æ¢é“¾è¡¨ä¸­çš„èŠ‚ç‚¹"><a href="#24-ä¸¤ä¸¤äº¤æ¢é“¾è¡¨ä¸­çš„èŠ‚ç‚¹" class="headerlink" title="24. ä¸¤ä¸¤äº¤æ¢é“¾è¡¨ä¸­çš„èŠ‚ç‚¹"></a><a href="https://leetcode-cn.com/problems/swap-nodes-in-pairs/">24. ä¸¤ä¸¤äº¤æ¢é“¾è¡¨ä¸­çš„èŠ‚ç‚¹</a></h6><p>ç»™å®šä¸€ä¸ªé“¾è¡¨ï¼Œä¸¤ä¸¤äº¤æ¢å…¶ä¸­ç›¸é‚»çš„èŠ‚ç‚¹ï¼Œå¹¶è¿”å›äº¤æ¢åçš„é“¾è¡¨ã€‚</p><p><strong>ä½ ä¸èƒ½åªæ˜¯å•çº¯çš„æ”¹å˜èŠ‚ç‚¹å†…éƒ¨çš„å€¼</strong>ï¼Œè€Œæ˜¯éœ€è¦å®é™…çš„è¿›è¡ŒèŠ‚ç‚¹äº¤æ¢ã€‚</p><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><p><img src="https://assets.leetcode.com/uploads/2020/10/03/swap_ex1.jpg"></p><pre><code class="hljs angelscript">è¾“å…¥ï¼šhead = [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>]è¾“å‡ºï¼š[<span class="hljs-number">2</span>,<span class="hljs-number">1</span>,<span class="hljs-number">4</span>,<span class="hljs-number">3</span>]</code></pre><p><strong>ç¤ºä¾‹ 2ï¼š</strong></p><pre><code class="hljs inform7">è¾“å…¥ï¼šhead = <span class="hljs-comment">[]</span>è¾“å‡ºï¼š<span class="hljs-comment">[]</span></code></pre><p><strong>ç¤ºä¾‹ 3ï¼š</strong></p><pre><code class="hljs angelscript">è¾“å…¥ï¼šhead = [<span class="hljs-number">1</span>]è¾“å‡ºï¼š[<span class="hljs-number">1</span>]</code></pre><p><strong>æç¤ºï¼š</strong></p><ul><li>é“¾è¡¨ä¸­èŠ‚ç‚¹çš„æ•°ç›®åœ¨èŒƒå›´ <code>[0, 100]</code> å†…</li><li><code>0 &lt;= Node.val &lt;= 100</code></li></ul><p><strong>è¿›é˜¶ï¼š</strong>ä½ èƒ½åœ¨ä¸ä¿®æ”¹é“¾è¡¨èŠ‚ç‚¹å€¼çš„æƒ…å†µä¸‹è§£å†³è¿™ä¸ªé—®é¢˜å—?ï¼ˆä¹Ÿå°±æ˜¯è¯´ï¼Œä»…ä¿®æ”¹èŠ‚ç‚¹æœ¬èº«ã€‚ï¼‰</p><p>è§£é¢˜æ€è·¯</p><pre><code class="hljs mathematica"><span class="hljs-keyword">K</span>ä¸ªä¸€ç»„åè½¬ä¸­ <span class="hljs-keyword">K</span>ç­‰äº<span class="hljs-number">2</span></code></pre><p><code>Java</code></p><pre><code class="hljs Java"><span class="hljs-comment">/*</span><span class="hljs-comment"> * Author: Wang P</span><span class="hljs-comment"> * Version: 1.0.0</span><span class="hljs-comment"> * Date: 2021-03-06 20:22:33</span><span class="hljs-comment"> * Description: 24-Swap Nodes in Pairs</span><span class="hljs-comment"> **/</span> <span class="hljs-keyword">package</span> com.weitrue.leetcode.editor.cn;<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SwapNodesInPairs</span></span>&#123;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span></span>&#123;        Solution s = <span class="hljs-keyword">new</span> SwapNodesInPairs().<span class="hljs-function">new <span class="hljs-title">Solution</span><span class="hljs-params">()</span></span>;    &#125;        <span class="hljs-comment">//Given a linked list, swap every two adjacent nodes and return its head. </span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Example 1:</span>    <span class="hljs-comment">//Input: head = [1,2,3,4]</span>    <span class="hljs-comment">//Output: [2,1,4,3]</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Example 2:</span>    <span class="hljs-comment">//Input: head = []</span>    <span class="hljs-comment">//Output: []</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Example 3:</span>    <span class="hljs-comment">//Input: head = [1]</span>    <span class="hljs-comment">//Output: [1]</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Constraints:</span>    <span class="hljs-comment">// The number of nodes in the list is in the range [0, 100].</span>    <span class="hljs-comment">// 0 &lt;= Node.val &lt;= 100</span>    <span class="hljs-comment">//Follow up: Can you solve the problem without modifying the values in the list&#x27;</span>    <span class="hljs-comment">//s nodes? (i.e., Only nodes themselves may be changed.) Related Topics é€’å½’ é“¾è¡¨</span>    <span class="hljs-comment">// ğŸ‘ 859 ğŸ‘ 0</span>        <span class="hljs-comment">//leetcode submit region begin(Prohibit modification and deletion)</span>    <span class="hljs-comment">/**</span><span class="hljs-comment">     * Definition for singly-linked list.</span><span class="hljs-comment">     */</span><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ListNode</span> </span>&#123;        <span class="hljs-keyword">int</span> val;        ListNode next;        ListNode() &#123;&#125;        ListNode(<span class="hljs-keyword">int</span> val) &#123; <span class="hljs-keyword">this</span>.val = val; &#125;        ListNode(<span class="hljs-keyword">int</span> val, ListNode next) &#123; <span class="hljs-keyword">this</span>.val = val; <span class="hljs-keyword">this</span>.next = next; &#125;     &#125;    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span> </span>&#123;        <span class="hljs-function"><span class="hljs-keyword">public</span> ListNode <span class="hljs-title">swapPairs</span><span class="hljs-params">(ListNode head)</span> </span>&#123;            ListNode hair = <span class="hljs-keyword">new</span> ListNode(<span class="hljs-number">0</span>, head), pre = hair, tail = pre;            <span class="hljs-keyword">while</span> (head != <span class="hljs-keyword">null</span>) &#123;                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>; i&lt;<span class="hljs-number">2</span>; i++) &#123;                    tail = tail.next;                    <span class="hljs-keyword">if</span> (tail == <span class="hljs-keyword">null</span>) &#123;                        <span class="hljs-keyword">return</span> hair.next;                    &#125;                &#125;                <span class="hljs-comment">// åè½¬é•¿åº¦ä¸ºkçš„é“¾è¡¨ï¼Œå¹¶è¿”å›é“¾è¡¨çš„æ–°å¤´å°¾èŠ‚ç‚¹</span>                ListNode[] ln = reverse(head, tail);                head = ln[<span class="hljs-number">0</span>];                tail = ln[<span class="hljs-number">1</span>];                pre.next = head;                pre = tail;                head = pre.next;            &#125;            <span class="hljs-keyword">return</span> hair.next;        &#125;        <span class="hljs-keyword">public</span> ListNode[] reverse(ListNode head, ListNode tail)&#123;            ListNode pre = tail.next, cur = head, next = <span class="hljs-keyword">null</span>;            <span class="hljs-keyword">while</span> (tail != pre) &#123;                next = cur.next;                cur.next = pre;                pre = cur;                cur = next;            &#125;            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ListNode[]&#123;tail, head&#125;;        &#125;    &#125;    <span class="hljs-comment">//leetcode submit region end(Prohibit modification and deletion)</span>&#125;</code></pre><p><code>Golang</code></p><pre><code class="hljs Golang"><span class="hljs-keyword">package</span> leetcode<span class="hljs-comment">/**</span><span class="hljs-comment"> * Author: Wang P</span><span class="hljs-comment"> * Version: 1.0.0</span><span class="hljs-comment"> * Date: 2021-03-06 20:26:56</span><span class="hljs-comment"> * Description:  Given a linked list, swap every two adjacent nodes and return its head.</span><span class="hljs-comment"></span><span class="hljs-comment"> Example 1:</span><span class="hljs-comment">Input: head = [1,2,3,4]</span><span class="hljs-comment">Output: [2,1,4,3]</span><span class="hljs-comment"></span><span class="hljs-comment"> Example 2:</span><span class="hljs-comment">Input: head = []</span><span class="hljs-comment">Output: []</span><span class="hljs-comment"></span><span class="hljs-comment"> Example 3:</span><span class="hljs-comment">Input: head = [1]</span><span class="hljs-comment">Output: [1]</span><span class="hljs-comment"></span><span class="hljs-comment"> Constraints:</span><span class="hljs-comment"> The number of nodes in the list is in the range [0, 100].</span><span class="hljs-comment"> 0 &lt;= Node.val &lt;= 100</span><span class="hljs-comment"></span><span class="hljs-comment">Follow up: Can you solve the problem without modifying the values in the list&#x27;</span><span class="hljs-comment">s nodes? (i.e., Only nodes themselves may be changed.) Related Topics é€’å½’ é“¾è¡¨</span><span class="hljs-comment"> ğŸ‘ 859 ğŸ‘ 0</span><span class="hljs-comment"> **/</span><span class="hljs-comment">//leetcode submit region begin(Prohibit modification and deletion)</span><span class="hljs-comment">/**</span><span class="hljs-comment"> * Definition for singly-linked list.</span><span class="hljs-comment"> * type ListNode struct &#123;</span><span class="hljs-comment"> *     Val int</span><span class="hljs-comment"> *     Next *ListNode</span><span class="hljs-comment"> * &#125;</span><span class="hljs-comment"> */</span><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">swapPairs</span><span class="hljs-params">(head *ListNode)</span> *<span class="hljs-title">ListNode</span></span> &#123;hair := &amp;ListNode&#123;Next:head&#125;pre, tail := hair, hair<span class="hljs-keyword">for</span> head != <span class="hljs-literal">nil</span> &#123;<span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">2</span>; i++ &#123;tail = tail.Next<span class="hljs-keyword">if</span> tail == <span class="hljs-literal">nil</span> &#123;<span class="hljs-keyword">return</span> hair.Next&#125;&#125;head, tail = reverseN(head, tail)pre.Next = headpre = tailhead = pre.Next&#125;<span class="hljs-keyword">return</span> hair.Next&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">reverseN</span><span class="hljs-params">(head, tail *ListNode)</span> <span class="hljs-params">(*ListNode, *ListNode)</span></span> &#123;pre, cur, next := tail.Next, head, &amp;ListNode&#123;&#125;<span class="hljs-keyword">for</span> pre != tail &#123;next = cur.Nextcur.Next = prepre = curcur = next&#125;<span class="hljs-keyword">return</span> tail, head&#125;<span class="hljs-comment">//leetcode submit region end(Prohibit modification and deletion)</span></code></pre><p><code>Python</code></p><pre><code class="hljs Python"><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">Module Description: 24-ä¸¤ä¸¤äº¤æ¢é“¾è¡¨ä¸­çš„èŠ‚ç‚¹</span><span class="hljs-string">Solutionï¼š</span><span class="hljs-string">Date: 2021-03-06 20:25:15</span><span class="hljs-string">Author: Wang P</span><span class="hljs-string">Problem:  ç»™å®šä¸€ä¸ªé“¾è¡¨ï¼Œä¸¤ä¸¤äº¤æ¢å…¶ä¸­ç›¸é‚»çš„èŠ‚ç‚¹ï¼Œå¹¶è¿”å›äº¤æ¢åçš„é“¾è¡¨ã€‚</span><span class="hljs-string">          ä½ ä¸èƒ½åªæ˜¯å•çº¯çš„æ”¹å˜èŠ‚ç‚¹å†…éƒ¨çš„å€¼ï¼Œè€Œæ˜¯éœ€è¦å®é™…çš„è¿›è¡ŒèŠ‚ç‚¹äº¤æ¢ã€‚</span><span class="hljs-string"></span><span class="hljs-string">          ç¤ºä¾‹ 1ï¼š</span><span class="hljs-string">         è¾“å…¥ï¼šhead = [1,2,3,4]</span><span class="hljs-string">         è¾“å‡ºï¼š[2,1,4,3]</span><span class="hljs-string"></span><span class="hljs-string">          ç¤ºä¾‹ 2ï¼š</span><span class="hljs-string">         è¾“å…¥ï¼šhead = []</span><span class="hljs-string">         è¾“å‡ºï¼š[]</span><span class="hljs-string"></span><span class="hljs-string">          ç¤ºä¾‹ 3ï¼š</span><span class="hljs-string">         è¾“å…¥ï¼šhead = [1]</span><span class="hljs-string">         è¾“å‡ºï¼š[1]</span><span class="hljs-string"></span><span class="hljs-string">          æç¤ºï¼š</span><span class="hljs-string">          é“¾è¡¨ä¸­èŠ‚ç‚¹çš„æ•°ç›®åœ¨èŒƒå›´ [0, 100] å†…</span><span class="hljs-string">          0 &lt;= Node.val &lt;= 100</span><span class="hljs-string">          è¿›é˜¶ï¼šä½ èƒ½åœ¨ä¸ä¿®æ”¹é“¾è¡¨èŠ‚ç‚¹å€¼çš„æƒ…å†µä¸‹è§£å†³è¿™ä¸ªé—®é¢˜å—?ï¼ˆä¹Ÿå°±æ˜¯è¯´ï¼Œä»…ä¿®æ”¹èŠ‚ç‚¹æœ¬èº«ã€‚ï¼‰</span><span class="hljs-string">          Related Topics é€’å½’ é“¾è¡¨</span><span class="hljs-string">          ğŸ‘ 859 ğŸ‘ 0</span><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-comment"># leetcode submit region begin(Prohibit modification and deletion)</span><span class="hljs-comment"># Definition for singly-linked list.</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ListNode</span>:</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, val=<span class="hljs-number">0</span>, <span class="hljs-built_in">next</span>=<span class="hljs-literal">None</span></span>):</span>        self.val = val        self.<span class="hljs-built_in">next</span> = <span class="hljs-built_in">next</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span>:</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">swapPairs</span>(<span class="hljs-params">self, head: ListNode</span>) -&gt; ListNode:</span>        tail = pre = hair = ListNode(<span class="hljs-built_in">next</span>=head)        <span class="hljs-keyword">while</span> head:            <span class="hljs-comment"># tail = pre</span>            <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">2</span>):                tail = tail.<span class="hljs-built_in">next</span>                <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> tail:                    <span class="hljs-keyword">return</span> hair.<span class="hljs-built_in">next</span>            head, tail = self.reverse(head, tail)            pre.<span class="hljs-built_in">next</span> = head            pre = tail            head = pre.<span class="hljs-built_in">next</span>        <span class="hljs-keyword">return</span> hair.<span class="hljs-built_in">next</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">reverse</span>(<span class="hljs-params">self, head, tail: ListNode</span>) -&gt; (ListNode, ListNode):</span>        pre, cur, nex = tail.<span class="hljs-built_in">next</span>, head, <span class="hljs-literal">None</span>        <span class="hljs-keyword">while</span> pre != tail:            nex = cur.<span class="hljs-built_in">next</span>            cur.<span class="hljs-built_in">next</span> = pre            pre = cur            cur = nex        <span class="hljs-keyword">return</span> tail, head<span class="hljs-comment"># leetcode submit region end(Prohibit modification and deletion)</span></code></pre><h5 id="é“¾è¡¨èŠ‚ç‚¹åˆ é™¤"><a href="#é“¾è¡¨èŠ‚ç‚¹åˆ é™¤" class="headerlink" title="é“¾è¡¨èŠ‚ç‚¹åˆ é™¤"></a>é“¾è¡¨èŠ‚ç‚¹åˆ é™¤</h5><h6 id="19-åˆ é™¤é“¾è¡¨çš„å€’æ•°ç¬¬-N-ä¸ªç»“ç‚¹"><a href="#19-åˆ é™¤é“¾è¡¨çš„å€’æ•°ç¬¬-N-ä¸ªç»“ç‚¹" class="headerlink" title="19. åˆ é™¤é“¾è¡¨çš„å€’æ•°ç¬¬ N ä¸ªç»“ç‚¹"></a><a href="https://leetcode-cn.com/problems/remove-nth-node-from-end-of-list/">19. åˆ é™¤é“¾è¡¨çš„å€’æ•°ç¬¬ N ä¸ªç»“ç‚¹</a></h6><p>ç»™ä½ ä¸€ä¸ªé“¾è¡¨ï¼Œåˆ é™¤é“¾è¡¨çš„å€’æ•°ç¬¬ n ä¸ªç»“ç‚¹ï¼Œå¹¶ä¸”è¿”å›é“¾è¡¨çš„å¤´ç»“ç‚¹ã€‚</p><p>è¿›é˜¶ï¼šä½ èƒ½å°è¯•ä½¿ç”¨ä¸€è¶Ÿæ‰«æå®ç°å—ï¼Ÿ</p><p>ç¤ºä¾‹ 1ï¼š</p><pre><code class="hljs angelscript">è¾“å…¥ï¼šhead = [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>], n = <span class="hljs-number">2</span>è¾“å‡ºï¼š[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">5</span>]</code></pre><p>ç¤ºä¾‹ 2ï¼š</p><pre><code class="hljs angelscript">è¾“å…¥ï¼šhead = [<span class="hljs-number">1</span>], n = <span class="hljs-number">1</span>è¾“å‡ºï¼š[]</code></pre><p>ç¤ºä¾‹ 3ï¼š</p><pre><code class="hljs angelscript">è¾“å…¥ï¼šhead = [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>], n = <span class="hljs-number">1</span>è¾“å‡ºï¼š[<span class="hljs-number">1</span>]</code></pre><p>æç¤ºï¼š</p><pre><code class="hljs angelscript">é“¾è¡¨ä¸­ç»“ç‚¹çš„æ•°ç›®ä¸º sz<span class="hljs-number">1</span> &lt;= sz &lt;= <span class="hljs-number">30</span><span class="hljs-number">0</span> &lt;= Node.val &lt;= <span class="hljs-number">100</span><span class="hljs-number">1</span> &lt;= n &lt;= sz</code></pre><p>è§£é¢˜æ€è·¯</p><pre><code class="hljs angelscript">å¿«æ…¢æŒ‡é’ˆ<span class="hljs-number">1.</span>å¿«æŒ‡é’ˆå…ˆè¡ŒNæ­¥ï¼›<span class="hljs-number">2.</span>æ…¢æŒ‡é’ˆä¸å¿«æŒ‡é’ˆå¼€å§‹åŒæ—¶èµ°ï¼Œå¿«æŒ‡é’ˆèµ°åˆ°å¤´ï¼Œæ…¢æŒ‡é’ˆèµ°åˆ°ç¬¬Nä¸ªèŠ‚ç‚¹çš„å‰é©±</code></pre><p><code>Java</code></p><pre><code class="hljs Java"><span class="hljs-comment">/*</span><span class="hljs-comment"> * Author: Wang P</span><span class="hljs-comment"> * Version: 1.0.0</span><span class="hljs-comment"> * Date: 2021-03-05 12:54:46</span><span class="hljs-comment"> * Description: 19-Remove Nth Node From End of List</span><span class="hljs-comment"> **/</span> <span class="hljs-keyword">package</span> com.weitrue.leetcode.editor.cn;<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RemoveNthNodeFromEndOfList</span></span>&#123;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span></span>&#123;        Solution s = <span class="hljs-keyword">new</span> RemoveNthNodeFromEndOfList().<span class="hljs-function">new <span class="hljs-title">Solution</span><span class="hljs-params">()</span></span>;    &#125;        <span class="hljs-comment">//Given the head of a linked list, remove the nth node from the end of the list </span>    <span class="hljs-comment">//and return its head.</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Follow up: Could you do this in one pass?</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Example 1:</span>    <span class="hljs-comment">//Input: head = [1,2,3,4,5], n = 2</span>    <span class="hljs-comment">//Output: [1,2,3,5]</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Example 2:</span>    <span class="hljs-comment">//Input: head = [1], n = 1</span>    <span class="hljs-comment">//Output: []</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Example 3:</span>    <span class="hljs-comment">//Input: head = [1,2], n = 1</span>    <span class="hljs-comment">//Output: [1]</span>    <span class="hljs-comment">// Constraints:</span>    <span class="hljs-comment">// The number of nodes in the list is sz.</span>    <span class="hljs-comment">// 1 &lt;= sz &lt;= 30</span>    <span class="hljs-comment">// 0 &lt;= Node.val &lt;= 100</span>    <span class="hljs-comment">// 1 &lt;= n &lt;= sz</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Related Topics é“¾è¡¨ åŒæŒ‡é’ˆ</span>    <span class="hljs-comment">// ğŸ‘ 1264 ğŸ‘ 0</span>     <span class="hljs-comment">//leetcode submit region begin(Prohibit modification and deletion)</span>    <span class="hljs-comment">/**</span><span class="hljs-comment">     * Definition for singly-linked list.</span><span class="hljs-comment">     */</span>     <span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ListNode</span> </span>&#123;         <span class="hljs-keyword">int</span> val;         ListNode next;         ListNode() &#123;&#125;         ListNode(<span class="hljs-keyword">int</span> val) &#123; <span class="hljs-keyword">this</span>.val = val; &#125;         ListNode(<span class="hljs-keyword">int</span> val, ListNode next) &#123; <span class="hljs-keyword">this</span>.val = val; <span class="hljs-keyword">this</span>.next = next; &#125;     &#125;    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span> </span>&#123;        <span class="hljs-function"><span class="hljs-keyword">public</span> ListNode <span class="hljs-title">removeNthFromEnd</span><span class="hljs-params">(ListNode head, <span class="hljs-keyword">int</span> n)</span> </span>&#123;            ListNode hair = <span class="hljs-keyword">new</span> ListNode(<span class="hljs-number">0</span>, head), fast = head, slow = hair;            <span class="hljs-keyword">while</span> (n &gt; <span class="hljs-number">0</span>)&#123;                fast = fast.next;                n--;            &#125;            <span class="hljs-keyword">while</span> (fast != <span class="hljs-keyword">null</span>) &#123;                fast = fast.next;                slow = slow.next;            &#125;            slow.next = slow.next.next;            <span class="hljs-keyword">return</span> hair.next;        &#125;&#125;<span class="hljs-comment">//leetcode submit region end(Prohibit modification and deletion)</span>&#125;</code></pre><p><code>Golang</code></p><pre><code class="hljs Golang"><span class="hljs-keyword">package</span> leetcode<span class="hljs-comment">/**</span><span class="hljs-comment"> * Author: Wang P</span><span class="hljs-comment"> * Version: 1.0.0</span><span class="hljs-comment"> * Date: 2021-03-05 13:43:33</span><span class="hljs-comment"> * Description:</span><span class="hljs-comment"> **/</span><span class="hljs-comment">//Given the head of a linked list, remove the nth node from the end of the list </span><span class="hljs-comment">//and return its head. </span><span class="hljs-comment">//</span><span class="hljs-comment">// Follow up: Could you do this in one pass? </span><span class="hljs-comment">//</span><span class="hljs-comment">// Example 1:</span><span class="hljs-comment">//Input: head = [1,2,3,4,5], n = 2</span><span class="hljs-comment">//Output: [1,2,3,5]</span><span class="hljs-comment">//</span><span class="hljs-comment">// Example 2:</span><span class="hljs-comment">//Input: head = [1], n = 1</span><span class="hljs-comment">//Output: []</span><span class="hljs-comment">//</span><span class="hljs-comment">// Example 3:</span><span class="hljs-comment">//Input: head = [1,2], n = 1</span><span class="hljs-comment">//Output: [1]</span><span class="hljs-comment">// Constraints:</span><span class="hljs-comment">// The number of nodes in the list is sz. </span><span class="hljs-comment">// 1 &lt;= sz &lt;= 30 </span><span class="hljs-comment">// 0 &lt;= Node.val &lt;= 100 </span><span class="hljs-comment">// 1 &lt;= n &lt;= sz </span><span class="hljs-comment">// </span><span class="hljs-comment">// Related Topics é“¾è¡¨ åŒæŒ‡é’ˆ </span><span class="hljs-comment">// ğŸ‘ 1264 ğŸ‘ 0</span><span class="hljs-comment">//leetcode submit region begin(Prohibit modification and deletion)</span><span class="hljs-comment">/**</span><span class="hljs-comment"> * Definition for singly-linked list.</span><span class="hljs-comment"> */</span><span class="hljs-keyword">type</span> ListNode <span class="hljs-keyword">struct</span> &#123;Val <span class="hljs-keyword">int</span>Next *ListNode&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">removeNthFromEnd</span><span class="hljs-params">(head *ListNode, n <span class="hljs-keyword">int</span>)</span> *<span class="hljs-title">ListNode</span></span> &#123;hair := &amp;ListNode&#123;Next:head&#125;fast, slow := head, hair<span class="hljs-keyword">for</span> n &gt; <span class="hljs-number">0</span> &#123;fast = fast.Nextn--&#125;<span class="hljs-keyword">for</span> fast != <span class="hljs-literal">nil</span> &#123;fast = fast.Nextslow = slow.Next&#125;slow.Next = slow.Next.Next<span class="hljs-keyword">return</span> hair.Next&#125;<span class="hljs-comment">//leetcode submit region end(Prohibit modification and deletion)</span></code></pre><p><code>Python</code></p><pre><code class="hljs Python"><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">Module Description: 19-åˆ é™¤é“¾è¡¨çš„å€’æ•°ç¬¬ N ä¸ªç»“ç‚¹</span><span class="hljs-string">Solutionï¼š</span><span class="hljs-string">Date: 2021-03-05 13:39:13</span><span class="hljs-string">Author: Wang P</span><span class="hljs-string">Problem:# ç»™ä½ ä¸€ä¸ªé“¾è¡¨ï¼Œåˆ é™¤é“¾è¡¨çš„å€’æ•°ç¬¬ n ä¸ªç»“ç‚¹ï¼Œå¹¶ä¸”è¿”å›é“¾è¡¨çš„å¤´ç»“ç‚¹ã€‚ </span><span class="hljs-string">        #</span><span class="hljs-string">        #  è¿›é˜¶ï¼šä½ èƒ½å°è¯•ä½¿ç”¨ä¸€è¶Ÿæ‰«æå®ç°å—ï¼Ÿ</span><span class="hljs-string"></span><span class="hljs-string">        #  ç¤ºä¾‹ 1ï¼š</span><span class="hljs-string">        # è¾“å…¥ï¼šhead = [1,2,3,4,5], n = 2</span><span class="hljs-string">        # è¾“å‡ºï¼š[1,2,3,5]</span><span class="hljs-string">        #</span><span class="hljs-string">        #  ç¤ºä¾‹ 2ï¼š</span><span class="hljs-string">        # è¾“å…¥ï¼šhead = [1], n = 1</span><span class="hljs-string">        # è¾“å‡ºï¼š[]</span><span class="hljs-string">        #</span><span class="hljs-string">        #  ç¤ºä¾‹ 3ï¼š</span><span class="hljs-string">        # è¾“å…¥ï¼šhead = [1,2], n = 1</span><span class="hljs-string">        # è¾“å‡ºï¼š[1]</span><span class="hljs-string">        #</span><span class="hljs-string">        #  æç¤ºï¼š</span><span class="hljs-string">        #  é“¾è¡¨ä¸­ç»“ç‚¹çš„æ•°ç›®ä¸º sz</span><span class="hljs-string">        #  1 &lt;= sz &lt;= 30</span><span class="hljs-string">        #  0 &lt;= Node.val &lt;= 100</span><span class="hljs-string">        #  1 &lt;= n &lt;= sz</span><span class="hljs-string">        #</span><span class="hljs-string">        #  Related Topics é“¾è¡¨ åŒæŒ‡é’ˆ</span><span class="hljs-string">        #  ğŸ‘ 1264 ğŸ‘ 0</span><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-comment"># leetcode submit region begin(Prohibit modification and deletion)</span><span class="hljs-comment"># Definition for singly-linked list.</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ListNode</span>:</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, val=<span class="hljs-number">0</span>, <span class="hljs-built_in">next</span>=<span class="hljs-literal">None</span></span>):</span>        self.val = val        self.<span class="hljs-built_in">next</span> = <span class="hljs-built_in">next</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span>:</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">removeNthFromEnd</span>(<span class="hljs-params">self, head: ListNode, n: <span class="hljs-built_in">int</span></span>) -&gt; ListNode:</span>        hair = ListNode(<span class="hljs-built_in">next</span>=head)        slow, fast = hair, head;        <span class="hljs-keyword">while</span> n &gt; <span class="hljs-number">0</span>:            fast = fast.<span class="hljs-built_in">next</span>            n -= <span class="hljs-number">1</span>        <span class="hljs-keyword">while</span> fast:            fast = fast.<span class="hljs-built_in">next</span>            slow = slow.<span class="hljs-built_in">next</span>        slow.<span class="hljs-built_in">next</span> = slow.<span class="hljs-built_in">next</span>.<span class="hljs-built_in">next</span>        <span class="hljs-keyword">return</span> hair.<span class="hljs-built_in">next</span><span class="hljs-comment"># leetcode submit region end(Prohibit modification and deletion)</span></code></pre><h6 id="83-åˆ é™¤æ’åºé“¾è¡¨ä¸­çš„é‡å¤å…ƒç´ "><a href="#83-åˆ é™¤æ’åºé“¾è¡¨ä¸­çš„é‡å¤å…ƒç´ " class="headerlink" title="83. åˆ é™¤æ’åºé“¾è¡¨ä¸­çš„é‡å¤å…ƒç´ "></a><a href="https://leetcode-cn.com/problems/remove-duplicates-from-sorted-list/">83. åˆ é™¤æ’åºé“¾è¡¨ä¸­çš„é‡å¤å…ƒç´ </a></h6><p>ç»™å®šä¸€ä¸ª<strong>æ’åº</strong>é“¾è¡¨ï¼Œåˆ é™¤æ‰€æœ‰é‡å¤çš„å…ƒç´ ï¼Œä½¿å¾—æ¯ä¸ªå…ƒç´ åªå‡ºç°ä¸€æ¬¡ã€‚</p><p>ç¤ºä¾‹ 1:</p><pre><code class="hljs angelscript">è¾“å…¥: <span class="hljs-number">1</span>-&gt;<span class="hljs-number">1</span>-&gt;<span class="hljs-number">2</span>è¾“å‡º: <span class="hljs-number">1</span>-&gt;<span class="hljs-number">2</span></code></pre><p>ç¤ºä¾‹ 2:</p><pre><code class="hljs angelscript">è¾“å…¥: <span class="hljs-number">1</span>-&gt;<span class="hljs-number">1</span>-&gt;<span class="hljs-number">2</span>-&gt;<span class="hljs-number">3</span>-&gt;<span class="hljs-number">3</span>è¾“å‡º: <span class="hljs-number">1</span>-&gt;<span class="hljs-number">2</span>-&gt;<span class="hljs-number">3</span></code></pre><p>è§£é¢˜æ€è·¯</p><pre><code class="hljs plain">æ’åºé“¾è¡¨æŸèŠ‚ç‚¹ä¸ä¸‹ä¸€ä¸ªèŠ‚ç‚¹å€¼ç›¸ç­‰åˆ™åˆ é™¤</code></pre><p><code>Java</code></p><pre><code class="hljs Java"><span class="hljs-comment">/*</span><span class="hljs-comment"> * Author: Wang P</span><span class="hljs-comment"> * Version: 1.0.0</span><span class="hljs-comment"> * Date: 2021-03-05 13:48:45</span><span class="hljs-comment"> * Description: 83-Remove Duplicates from Sorted List</span><span class="hljs-comment"> **/</span> <span class="hljs-keyword">package</span> com.weitrue.leetcode.editor.cn;<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RemoveDuplicatesFromSortedList</span></span>&#123;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span></span>&#123;        Solution s = <span class="hljs-keyword">new</span> RemoveDuplicatesFromSortedList().<span class="hljs-function">new <span class="hljs-title">Solution</span><span class="hljs-params">()</span></span>;    &#125;        <span class="hljs-comment">//Given the head of a sorted linked list, delete all duplicates such that each e</span>    <span class="hljs-comment">//lement appears only once. Return the linked list sorted as well. </span>    <span class="hljs-comment">// Example 1: </span>    <span class="hljs-comment">//Input: head = [1,1,2]</span>    <span class="hljs-comment">//Output: [1,2]</span>    <span class="hljs-comment">// Example 2: </span>    <span class="hljs-comment">//Input: head = [1,1,2,3,3]</span>    <span class="hljs-comment">//Output: [1,2,3]</span>    <span class="hljs-comment">// Constraints: </span>    <span class="hljs-comment">// The number of nodes in the list is in the range [0, 300]. </span>    <span class="hljs-comment">// -100 &lt;= Node.val &lt;= 100 </span>    <span class="hljs-comment">// The list is guaranteed to be sorted in ascending order. </span>    <span class="hljs-comment">// </span>    <span class="hljs-comment">// Related Topics é“¾è¡¨ </span>    <span class="hljs-comment">// ğŸ‘ 488 ğŸ‘ 0</span>     <span class="hljs-comment">//leetcode submit region begin(Prohibit modification and deletion)</span>    <span class="hljs-comment">/**</span><span class="hljs-comment">     * Definition for singly-linked list.</span><span class="hljs-comment">     */</span>    <span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ListNode</span> </span>&#123;        <span class="hljs-keyword">int</span> val;        ListNode next;        ListNode() &#123;&#125;        ListNode(<span class="hljs-keyword">int</span> val) &#123; <span class="hljs-keyword">this</span>.val = val; &#125;        ListNode(<span class="hljs-keyword">int</span> val, ListNode next) &#123; <span class="hljs-keyword">this</span>.val = val; <span class="hljs-keyword">this</span>.next = next; &#125;    &#125;    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span> </span>&#123;        <span class="hljs-function"><span class="hljs-keyword">public</span> ListNode <span class="hljs-title">deleteDuplicates</span><span class="hljs-params">(ListNode head)</span> </span>&#123;            <span class="hljs-keyword">if</span>(head == <span class="hljs-keyword">null</span>) &#123;                <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;            &#125;            ListNode fast = head.next, slow = head;            <span class="hljs-keyword">while</span> (fast != <span class="hljs-keyword">null</span>) &#123;                <span class="hljs-keyword">if</span> (fast.val == slow.val) &#123;                    slow.next = fast.next;                    fast = slow.next;                &#125;<span class="hljs-keyword">else</span> &#123;                    fast = fast.next;                    slow = slow.next;                &#125;            &#125;            <span class="hljs-keyword">return</span> head;        &#125;&#125;<span class="hljs-comment">//leetcode submit region end(Prohibit modification and deletion)</span>&#125;</code></pre><p><code>Golang</code></p><pre><code class="hljs Golang"><span class="hljs-keyword">package</span> leetcode<span class="hljs-comment">/**</span><span class="hljs-comment"> * Author: Wang P</span><span class="hljs-comment"> * Version: 1.0.0</span><span class="hljs-comment"> * Date: 2021-03-05 13:50:35</span><span class="hljs-comment"> * Description: //Given the head of a sorted linked list, delete all duplicates such that each e</span><span class="hljs-comment">//lement appears only once. Return the linked list sorted as well.</span><span class="hljs-comment">//</span><span class="hljs-comment">// Example 1:</span><span class="hljs-comment">//Input: head = [1,1,2]</span><span class="hljs-comment">//Output: [1,2]</span><span class="hljs-comment">//</span><span class="hljs-comment">// Example 2:</span><span class="hljs-comment">//Input: head = [1,1,2,3,3]</span><span class="hljs-comment">//Output: [1,2,3]</span><span class="hljs-comment">//</span><span class="hljs-comment">// Constraints:</span><span class="hljs-comment">// The number of nodes in the list is in the range [0, 300].</span><span class="hljs-comment">// -100 &lt;= Node.val &lt;= 100</span><span class="hljs-comment">// The list is guaranteed to be sorted in ascending order.</span><span class="hljs-comment">//</span><span class="hljs-comment">// Related Topics é“¾è¡¨</span><span class="hljs-comment">// ğŸ‘ 488 ğŸ‘ 0</span><span class="hljs-comment"> **/</span><span class="hljs-comment">//leetcode submit region begin(Prohibit modification and deletion)</span><span class="hljs-comment">/**</span><span class="hljs-comment"> * Definition for singly-linked list.</span><span class="hljs-comment"> */</span><span class="hljs-keyword">type</span> ListNode <span class="hljs-keyword">struct</span> &#123;Val <span class="hljs-keyword">int</span>Next *ListNode&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">deleteDuplicates</span><span class="hljs-params">(head *ListNode)</span> *<span class="hljs-title">ListNode</span></span> &#123;cur := head<span class="hljs-keyword">for</span> cur != <span class="hljs-literal">nil</span> &amp;&amp; cur.Next != <span class="hljs-literal">nil</span> &#123;<span class="hljs-keyword">if</span> cur.Val == cur.Next.Val &#123;cur.Next = cur.Next.Next&#125;<span class="hljs-keyword">else</span> &#123;cur = cur.Next&#125;&#125;<span class="hljs-keyword">return</span> head&#125;<span class="hljs-comment">//leetcode submit region end(Prohibit modification and deletion)</span></code></pre><p><code>Python</code></p><pre><code class="hljs Python"><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">Module Description: 83-åˆ é™¤æ’åºé“¾è¡¨ä¸­çš„é‡å¤å…ƒç´ </span><span class="hljs-string">Solutionï¼š</span><span class="hljs-string">Date: 2021-03-05 13:50:26</span><span class="hljs-string">Author: Wang P</span><span class="hljs-string">Problem:# ç»™å®šä¸€ä¸ªæ’åºé“¾è¡¨ï¼Œåˆ é™¤æ‰€æœ‰é‡å¤çš„å…ƒç´ ï¼Œä½¿å¾—æ¯ä¸ªå…ƒç´ åªå‡ºç°ä¸€æ¬¡ã€‚ </span><span class="hljs-string">        #</span><span class="hljs-string">        #  ç¤ºä¾‹ 1:</span><span class="hljs-string">        #</span><span class="hljs-string">        #  è¾“å…¥: 1-&gt;1-&gt;2</span><span class="hljs-string">        # è¾“å‡º: 1-&gt;2</span><span class="hljs-string">        #</span><span class="hljs-string">        #</span><span class="hljs-string">        #  ç¤ºä¾‹ 2:</span><span class="hljs-string">        #</span><span class="hljs-string">        #  è¾“å…¥: 1-&gt;1-&gt;2-&gt;3-&gt;3</span><span class="hljs-string">        # è¾“å‡º: 1-&gt;2-&gt;3</span><span class="hljs-string">        #  Related Topics é“¾è¡¨</span><span class="hljs-string">        #  ğŸ‘ 488 ğŸ‘ 0</span><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-comment"># leetcode submit region begin(Prohibit modification and deletion)</span><span class="hljs-comment"># Definition for singly-linked list.</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ListNode</span>:</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, val=<span class="hljs-number">0</span>, <span class="hljs-built_in">next</span>=<span class="hljs-literal">None</span></span>):</span>        self.val = val        self.<span class="hljs-built_in">next</span> = <span class="hljs-built_in">next</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span>:</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">deleteDuplicates</span>(<span class="hljs-params">self, head: ListNode</span>) -&gt; ListNode:</span>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> head:            <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span>        fast, slow = head.<span class="hljs-built_in">next</span>, head        <span class="hljs-keyword">while</span> fast:            <span class="hljs-keyword">if</span> fast.val == slow.val:                slow.<span class="hljs-built_in">next</span> = fast.<span class="hljs-built_in">next</span>                fast = slow.<span class="hljs-built_in">next</span>            <span class="hljs-keyword">else</span>:                fast = fast.<span class="hljs-built_in">next</span>                slow = slow.<span class="hljs-built_in">next</span>        <span class="hljs-keyword">return</span> head<span class="hljs-comment"># leetcode submit region end(Prohibit modification and deletion)</span></code></pre><h6 id="82-åˆ é™¤æ’åºé“¾è¡¨ä¸­çš„é‡å¤å…ƒç´ -II"><a href="#82-åˆ é™¤æ’åºé“¾è¡¨ä¸­çš„é‡å¤å…ƒç´ -II" class="headerlink" title="82. åˆ é™¤æ’åºé“¾è¡¨ä¸­çš„é‡å¤å…ƒç´  II"></a><a href="https://leetcode-cn.com/problems/remove-duplicates-from-sorted-list-ii/">82. åˆ é™¤æ’åºé“¾è¡¨ä¸­çš„é‡å¤å…ƒç´  II</a></h6><p>ç»™å®šä¸€ä¸ªæ’åºé“¾è¡¨ï¼Œåˆ é™¤æ‰€æœ‰å«æœ‰é‡å¤æ•°å­—çš„èŠ‚ç‚¹ï¼Œåªä¿ç•™åŸå§‹é“¾è¡¨ä¸­ <em>æ²¡æœ‰é‡å¤å‡ºç°</em> çš„æ•°å­—ã€‚</p><p><strong>ç¤ºä¾‹ 1:</strong></p><pre><code class="hljs angelscript">è¾“å…¥: <span class="hljs-number">1</span>-&gt;<span class="hljs-number">2</span>-&gt;<span class="hljs-number">3</span>-&gt;<span class="hljs-number">3</span>-&gt;<span class="hljs-number">4</span>-&gt;<span class="hljs-number">4</span>-&gt;<span class="hljs-number">5</span>è¾“å‡º: <span class="hljs-number">1</span>-&gt;<span class="hljs-number">2</span>-&gt;<span class="hljs-number">5</span></code></pre><p><strong>ç¤ºä¾‹ 2:</strong></p><pre><code class="hljs angelscript">è¾“å…¥: <span class="hljs-number">1</span>-&gt;<span class="hljs-number">1</span>-&gt;<span class="hljs-number">1</span>-&gt;<span class="hljs-number">2</span>-&gt;<span class="hljs-number">3</span>è¾“å‡º: <span class="hljs-number">2</span>-&gt;<span class="hljs-number">3</span></code></pre><p>è§£é¢˜æ€è·¯</p><pre><code class="hljs plain"></code></pre><p><code>Java</code></p><pre><code class="hljs Java"><span class="hljs-comment">/*</span><span class="hljs-comment"> * Author: Wang P</span><span class="hljs-comment"> * Version: 1.0.0</span><span class="hljs-comment"> * Date: 2021-03-05 13:50:14</span><span class="hljs-comment"> * Description: 82-Remove Duplicates from Sorted List II</span><span class="hljs-comment"> **/</span> <span class="hljs-keyword">package</span> com.weitrue.leetcode.editor.cn;<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RemoveDuplicatesFromSortedListIi</span></span>&#123;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span></span>&#123;        Solution s = <span class="hljs-keyword">new</span> RemoveDuplicatesFromSortedListIi().<span class="hljs-function">new <span class="hljs-title">Solution</span><span class="hljs-params">()</span></span>;    &#125;        <span class="hljs-comment">//Given the head of a sorted linked list, delete all nodes that have duplicate numbers, </span>    <span class="hljs-comment">//leaving only distinct numbers from the original list. Return the linked</span>    <span class="hljs-comment">//list sorted as well.</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Example 1:</span>    <span class="hljs-comment">//Input: head = [1,2,3,3,4,4,5]</span>    <span class="hljs-comment">//Output: [1,2,5]</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Example 2:</span>    <span class="hljs-comment">//Input: head = [1,1,1,2,3]</span>    <span class="hljs-comment">//Output: [2,3]</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Constraints:</span>    <span class="hljs-comment">// The number of nodes in the list is in the range [0, 300].</span>    <span class="hljs-comment">// -100 &lt;= Node.val &lt;= 100</span>    <span class="hljs-comment">// The list is guaranteed to be sorted in ascending order.</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Related Topics é“¾è¡¨</span>    <span class="hljs-comment">// ğŸ‘ 469 ğŸ‘ 0</span>     <span class="hljs-comment">//leetcode submit region begin(Prohibit modification and deletion)</span>    <span class="hljs-comment">/**</span><span class="hljs-comment">     * Definition for singly-linked list.</span><span class="hljs-comment">     */</span>    <span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ListNode</span> </span>&#123;        <span class="hljs-keyword">int</span> val;        ListNode next;        ListNode() &#123;&#125;        ListNode(<span class="hljs-keyword">int</span> val) &#123; <span class="hljs-keyword">this</span>.val = val; &#125;        ListNode(<span class="hljs-keyword">int</span> val, ListNode next) &#123; <span class="hljs-keyword">this</span>.val = val; <span class="hljs-keyword">this</span>.next = next; &#125;    &#125;    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span> </span>&#123;        <span class="hljs-function"><span class="hljs-keyword">public</span> ListNode <span class="hljs-title">deleteDuplicates</span><span class="hljs-params">(ListNode head)</span> </span>&#123;            ListNode hair = <span class="hljs-keyword">new</span> ListNode(<span class="hljs-number">0</span>, head), fast = head, slow = hair;            <span class="hljs-keyword">while</span> (fast != <span class="hljs-keyword">null</span>) &#123;                <span class="hljs-keyword">while</span> (fast.next != <span class="hljs-keyword">null</span> &amp;&amp; fast.val == fast.next.val) &#123;                    fast = fast.next;                &#125;                <span class="hljs-keyword">if</span> (slow.next == fast) &#123;                    slow = slow.next;                &#125;<span class="hljs-keyword">else</span> &#123;                    slow.next = fast.next;                &#125;                fast = fast.next;            &#125;            <span class="hljs-keyword">return</span> hair.next;        &#125;    &#125;<span class="hljs-comment">//leetcode submit region end(Prohibit modification and deletion)</span>&#125;</code></pre><p><code>Golang</code></p><pre><code class="hljs Golang"><span class="hljs-keyword">package</span> leetcode<span class="hljs-comment">/**</span><span class="hljs-comment"> * Author: Wang P</span><span class="hljs-comment"> * Version: 1.0.0</span><span class="hljs-comment"> * Date: 2021-03-05 13:50:38</span><span class="hljs-comment"> * Description: //Given the head of a sorted linked list, delete all nodes that have duplicate n</span><span class="hljs-comment">//umbers, leaving only distinct numbers from the original list. Return the linked</span><span class="hljs-comment">//list sorted as well.</span><span class="hljs-comment">// Example 1:</span><span class="hljs-comment">//Input: head = [1,2,3,3,4,4,5]</span><span class="hljs-comment">//Output: [1,2,5]</span><span class="hljs-comment">//</span><span class="hljs-comment">// Example 2:</span><span class="hljs-comment">//Input: head = [1,1,1,2,3]</span><span class="hljs-comment">//Output: [2,3]</span><span class="hljs-comment">//</span><span class="hljs-comment">// Constraints:</span><span class="hljs-comment">// The number of nodes in the list is in the range [0, 300].</span><span class="hljs-comment">// -100 &lt;= Node.val &lt;= 100</span><span class="hljs-comment">// The list is guaranteed to be sorted in ascending order.</span><span class="hljs-comment">//</span><span class="hljs-comment">// Related Topics é“¾è¡¨</span><span class="hljs-comment">// ğŸ‘ 469 ğŸ‘ 0</span><span class="hljs-comment"> **/</span><span class="hljs-comment">//leetcode submit region begin(Prohibit modification and deletion)</span><span class="hljs-comment">/**</span><span class="hljs-comment"> * Definition for singly-linked list.</span><span class="hljs-comment"> */</span><span class="hljs-keyword">type</span> ListNode <span class="hljs-keyword">struct</span> &#123;Val <span class="hljs-keyword">int</span>Next *ListNode&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">deleteDuplicates</span><span class="hljs-params">(head *ListNode)</span> *<span class="hljs-title">ListNode</span></span> &#123;hair := &amp;ListNode&#123;Next: head&#125;fast, slow := head, hair<span class="hljs-keyword">for</span> fast != <span class="hljs-literal">nil</span> &#123;<span class="hljs-keyword">for</span> fast.Next != <span class="hljs-literal">nil</span> &amp;&amp; fast.Val == fast.Next.Val &#123;fast = fast.Next&#125;<span class="hljs-keyword">if</span> slow.Next == fast&#123;slow = slow.Next&#125; <span class="hljs-keyword">else</span> &#123;slow.Next = fast.Next&#125;fast = fast.Next&#125;<span class="hljs-keyword">return</span> hair.Next&#125;<span class="hljs-comment">//leetcode submit region end(Prohibit modification and deletion)</span></code></pre><p><code>Python</code></p><pre><code class="hljs Python"><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">Module Description: 82-åˆ é™¤æ’åºé“¾è¡¨ä¸­çš„é‡å¤å…ƒç´  II</span><span class="hljs-string">Solutionï¼š</span><span class="hljs-string">Date: 2021-03-05 13:50:50</span><span class="hljs-string">Author: Wang P</span><span class="hljs-string">Problem:# ç»™å®šä¸€ä¸ªæ’åºé“¾è¡¨ï¼Œåˆ é™¤æ‰€æœ‰å«æœ‰é‡å¤æ•°å­—çš„èŠ‚ç‚¹ï¼Œåªä¿ç•™åŸå§‹é“¾è¡¨ä¸­ æ²¡æœ‰é‡å¤å‡ºç° çš„æ•°å­—ã€‚</span><span class="hljs-string">        #  ç¤ºä¾‹ 1:</span><span class="hljs-string">        #  è¾“å…¥: 1-&gt;2-&gt;3-&gt;3-&gt;4-&gt;4-&gt;5</span><span class="hljs-string">        # è¾“å‡º: 1-&gt;2-&gt;5</span><span class="hljs-string">        #  ç¤ºä¾‹ 2:</span><span class="hljs-string">        #  è¾“å…¥: 1-&gt;1-&gt;1-&gt;2-&gt;3</span><span class="hljs-string">        # è¾“å‡º: 2-&gt;3</span><span class="hljs-string">        #  Related Topics é“¾è¡¨</span><span class="hljs-string">        #  ğŸ‘ 469 ğŸ‘ 0</span><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-comment"># leetcode submit region begin(Prohibit modification and deletion)</span><span class="hljs-comment"># Definition for singly-linked list.</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ListNode</span>:</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, val=<span class="hljs-number">0</span>, <span class="hljs-built_in">next</span>=<span class="hljs-literal">None</span></span>):</span>        self.val = val        self.<span class="hljs-built_in">next</span> = <span class="hljs-built_in">next</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span>:</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">deleteDuplicates</span>(<span class="hljs-params">self, head: ListNode</span>) -&gt; ListNode:</span>        hair, fast = ListNode(<span class="hljs-built_in">next</span>=head), head        slow = hair        <span class="hljs-keyword">while</span> fast:            <span class="hljs-keyword">while</span> fast.<span class="hljs-built_in">next</span> <span class="hljs-keyword">and</span> fast.val == fast.<span class="hljs-built_in">next</span>.val:                fast = fast.<span class="hljs-built_in">next</span>            <span class="hljs-keyword">if</span> slow.<span class="hljs-built_in">next</span> == fast:                slow = slow.<span class="hljs-built_in">next</span>            <span class="hljs-keyword">else</span>:                slow.<span class="hljs-built_in">next</span> = fast.<span class="hljs-built_in">next</span>            fast = fast.<span class="hljs-built_in">next</span>        <span class="hljs-keyword">return</span> hair.<span class="hljs-built_in">next</span><span class="hljs-comment"># leetcode submit region end(Prohibit modification and deletion)</span></code></pre><h5 id="ç»å…¸é¢è¯•é¢˜"><a href="#ç»å…¸é¢è¯•é¢˜" class="headerlink" title="ç»å…¸é¢è¯•é¢˜"></a>ç»å…¸é¢è¯•é¢˜</h5><h6 id="86-åˆ†éš”é“¾è¡¨"><a href="#86-åˆ†éš”é“¾è¡¨" class="headerlink" title="86. åˆ†éš”é“¾è¡¨"></a><a href="https://leetcode-cn.com/problems/partition-list/">86. åˆ†éš”é“¾è¡¨</a></h6><p>ç»™ä½ ä¸€ä¸ªé“¾è¡¨çš„å¤´èŠ‚ç‚¹ head å’Œä¸€ä¸ªç‰¹å®šå€¼ x ï¼Œè¯·ä½ å¯¹é“¾è¡¨è¿›è¡Œåˆ†éš”ï¼Œä½¿å¾—æ‰€æœ‰ å°äº x çš„èŠ‚ç‚¹éƒ½å‡ºç°åœ¨ å¤§äºæˆ–ç­‰äº x çš„èŠ‚ç‚¹ä¹‹å‰ã€‚</p><p>ä½ åº”å½“ ä¿ç•™ ä¸¤ä¸ªåˆ†åŒºä¸­æ¯ä¸ªèŠ‚ç‚¹çš„åˆå§‹ç›¸å¯¹ä½ç½®ã€‚</p><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><p><img src="https://assets.leetcode.com/uploads/2021/01/04/partition.jpg"></p><pre><code class="hljs angelscript">è¾“å…¥ï¼šhead = [<span class="hljs-number">1</span>,<span class="hljs-number">4</span>,<span class="hljs-number">3</span>,<span class="hljs-number">2</span>,<span class="hljs-number">5</span>,<span class="hljs-number">2</span>], x = <span class="hljs-number">3</span>è¾“å‡ºï¼š[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">2</span>,<span class="hljs-number">4</span>,<span class="hljs-number">3</span>,<span class="hljs-number">5</span>]</code></pre><p><strong>ç¤ºä¾‹ 2ï¼š</strong></p><pre><code class="hljs angelscript">è¾“å…¥ï¼šhead = [<span class="hljs-number">2</span>,<span class="hljs-number">1</span>], x = <span class="hljs-number">2</span>è¾“å‡ºï¼š[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>]</code></pre><p><strong>æç¤ºï¼š</strong></p><ul><li>é“¾è¡¨ä¸­èŠ‚ç‚¹çš„æ•°ç›®åœ¨èŒƒå›´ <code>[0, 200]</code> å†…</li><li><code>-100 &lt;= Node.val &lt;= 100</code></li><li><code>-200 &lt;= x &lt;= 200</code></li></ul><p>è§£é¢˜æ€è·¯</p><pre><code class="hljs gml">å‡†å¤‡ä¸¤ä¸ªè™šæ‹Ÿå¤´æŒ‡é’ˆ ä¸€ä¸ªç”¨äºè¿æ¥å°äº <span class="hljs-symbol">x</span> çš„èŠ‚ç‚¹ï¼Œä¸€ä¸ªç”¨äºè¿æ¥å¤§äºæˆ–ç­‰äº<span class="hljs-symbol">x</span>çš„èŠ‚ç‚¹ï¼Œç„¶åå°†ä¸¤ä¸ªé“¾è¡¨è¿æ¥å³å¯</code></pre><p><code>Java</code></p><pre><code class="hljs Java"><span class="hljs-comment">/*</span><span class="hljs-comment"> * Author: Wang P</span><span class="hljs-comment"> * Version: 1.0.0</span><span class="hljs-comment"> * Date: 2021-03-06 20:29:46</span><span class="hljs-comment"> * Description: 86-Partition List</span><span class="hljs-comment"> **/</span> <span class="hljs-keyword">package</span> com.weitrue.leetcode.editor.cn;<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PartitionList</span></span>&#123;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span></span>&#123;        Solution s = <span class="hljs-keyword">new</span> PartitionList().<span class="hljs-function">new <span class="hljs-title">Solution</span><span class="hljs-params">()</span></span>;    &#125;        <span class="hljs-comment">// Given the head of a linked list and a value x, partition it such that all nodes less than x come before nodes greater than or equal to x.</span>    <span class="hljs-comment">// You should preserve the original relative order of the nodes in each of the two partitions.</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Example 1:</span>    <span class="hljs-comment">//Input: head = [1,4,3,2,5,2], x = 3</span>    <span class="hljs-comment">//Output: [1,2,2,4,3,5]</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Example 2:</span>    <span class="hljs-comment">//Input: head = [2,1], x = 2</span>    <span class="hljs-comment">//Output: [1,2]</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Constraints:</span>    <span class="hljs-comment">// The number of nodes in the list is in the range [0, 200].</span>    <span class="hljs-comment">// -100 &lt;= Node.val &lt;= 100</span>    <span class="hljs-comment">// -200 &lt;= x &lt;= 200</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Related Topics é“¾è¡¨ åŒæŒ‡é’ˆ</span>    <span class="hljs-comment">// ğŸ‘ 378 ğŸ‘ 0</span>    <span class="hljs-comment">//leetcode submit region begin(Prohibit modification and deletion)</span>    <span class="hljs-comment">/**</span><span class="hljs-comment">     * Definition for singly-linked list.</span><span class="hljs-comment">     */</span>    <span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ListNode</span> </span>&#123;        <span class="hljs-keyword">int</span> val;        ListNode next;        ListNode() &#123;&#125;        ListNode(<span class="hljs-keyword">int</span> val) &#123; <span class="hljs-keyword">this</span>.val = val; &#125;        ListNode(<span class="hljs-keyword">int</span> val, ListNode next) &#123; <span class="hljs-keyword">this</span>.val = val; <span class="hljs-keyword">this</span>.next = next; &#125;     &#125;    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span> </span>&#123;        <span class="hljs-function"><span class="hljs-keyword">public</span> ListNode <span class="hljs-title">partition</span><span class="hljs-params">(ListNode head, <span class="hljs-keyword">int</span> x)</span> </span>&#123;            ListNode less = <span class="hljs-keyword">new</span> ListNode(<span class="hljs-number">0</span>, head), greater = <span class="hljs-keyword">new</span> ListNode(<span class="hljs-number">0</span>, head);            ListNode curLess = less, curGreater = greater;            <span class="hljs-keyword">while</span> (head != <span class="hljs-keyword">null</span>) &#123;                <span class="hljs-keyword">if</span> (head.val &lt; x) &#123;                    curLess.next = head;                    curLess = curLess.next;                &#125; <span class="hljs-keyword">else</span> &#123;                    curGreater.next = head;                    curGreater = curGreater.next;                &#125;                head = head.next;            &#125;            curGreater.next = <span class="hljs-keyword">null</span>;            curLess.next = greater.next;            <span class="hljs-keyword">return</span> less.next;        &#125;    &#125;    <span class="hljs-comment">//leetcode submit region end(Prohibit modification and deletion)</span>&#125;</code></pre><p><code>Golang</code></p><pre><code class="hljs Golang"><span class="hljs-keyword">package</span> leetcode<span class="hljs-comment">/**</span><span class="hljs-comment"> * Author: Wang P</span><span class="hljs-comment"> * Version: 1.0.0</span><span class="hljs-comment"> * Date: 2021-03-06 20:37:43</span><span class="hljs-comment"> * Description: Given the head of a linked list and a value x, partition it such that all nodes less than x come before nodes greater than or equal to x.</span><span class="hljs-comment">You should preserve the original relative order of the nodes in each of the two partitions.</span><span class="hljs-comment">Example 1:</span><span class="hljs-comment">Input: head = [1,4,3,2,5,2], x = 3</span><span class="hljs-comment">Output: [1,2,2,4,3,5]</span><span class="hljs-comment"></span><span class="hljs-comment">Example 2:</span><span class="hljs-comment">Input: head = [2,1], x = 2</span><span class="hljs-comment">Output: [1,2]</span><span class="hljs-comment"></span><span class="hljs-comment">Constraints:</span><span class="hljs-comment"> The number of nodes in the list is in the range [0, 200].</span><span class="hljs-comment"> -100 &lt;= Node.val &lt;= 100</span><span class="hljs-comment"> -200 &lt;= x &lt;= 200</span><span class="hljs-comment"></span><span class="hljs-comment"> Related Topics é“¾è¡¨ åŒæŒ‡é’ˆ</span><span class="hljs-comment"> ğŸ‘ 378 ğŸ‘ 0</span><span class="hljs-comment"> **/</span><span class="hljs-comment">//leetcode submit region begin(Prohibit modification and deletion)</span><span class="hljs-comment">/**</span><span class="hljs-comment"> * Definition for singly-linked list.</span><span class="hljs-comment"> * type ListNode struct &#123;</span><span class="hljs-comment"> *     Val int</span><span class="hljs-comment"> *     Next *ListNode</span><span class="hljs-comment"> * &#125;</span><span class="hljs-comment"> */</span><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">partition</span><span class="hljs-params">(head *ListNode, x <span class="hljs-keyword">int</span>)</span> *<span class="hljs-title">ListNode</span></span> &#123;lesser, greater := &amp;ListNode&#123;Next:head&#125;, &amp;ListNode&#123;Next:head&#125;less, great := lesser, greater<span class="hljs-keyword">for</span> head != <span class="hljs-literal">nil</span> &#123;<span class="hljs-keyword">if</span> head.Val &lt; x &#123;less.Next = headless = less.Next&#125; <span class="hljs-keyword">else</span> &#123;great.Next = headgreat = great.Next&#125;head = head.Next&#125;great.Next = <span class="hljs-literal">nil</span>less.Next = greater.Next<span class="hljs-keyword">return</span> lesser.Next&#125;<span class="hljs-comment">//leetcode submit region end(Prohibit modification and deletion)</span></code></pre><p><code>Python</code></p><pre><code class="hljs Python"><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">Module Description: 86-åˆ†éš”é“¾è¡¨</span><span class="hljs-string">Solutionï¼š</span><span class="hljs-string">Date: 2021-03-06 20:33:40</span><span class="hljs-string">Author: Wang P</span><span class="hljs-string">Problem:  ç»™ä½ ä¸€ä¸ªé“¾è¡¨çš„å¤´èŠ‚ç‚¹ head å’Œä¸€ä¸ªç‰¹å®šå€¼ x ï¼Œè¯·ä½ å¯¹é“¾è¡¨è¿›è¡Œåˆ†éš”ï¼Œä½¿å¾—æ‰€æœ‰ å°äº x çš„èŠ‚ç‚¹éƒ½å‡ºç°åœ¨ å¤§äºæˆ–ç­‰äº x çš„èŠ‚ç‚¹ä¹‹å‰ã€‚</span><span class="hljs-string">          ä½ åº”å½“ ä¿ç•™ ä¸¤ä¸ªåˆ†åŒºä¸­æ¯ä¸ªèŠ‚ç‚¹çš„åˆå§‹ç›¸å¯¹ä½ç½®ã€‚</span><span class="hljs-string"></span><span class="hljs-string">          ç¤ºä¾‹ 1ï¼š</span><span class="hljs-string">         è¾“å…¥ï¼šhead = [1,4,3,2,5,2], x = 3</span><span class="hljs-string">         è¾“å‡ºï¼š[1,2,2,4,3,5]</span><span class="hljs-string"></span><span class="hljs-string">          ç¤ºä¾‹ 2ï¼š</span><span class="hljs-string">         è¾“å…¥ï¼šhead = [2,1], x = 2</span><span class="hljs-string">         è¾“å‡ºï¼š[1,2]</span><span class="hljs-string"></span><span class="hljs-string">          æç¤ºï¼š</span><span class="hljs-string">          é“¾è¡¨ä¸­èŠ‚ç‚¹çš„æ•°ç›®åœ¨èŒƒå›´ [0, 200] å†…</span><span class="hljs-string">          -100 &lt;= Node.val &lt;= 100</span><span class="hljs-string">          -200 &lt;= x &lt;= 200</span><span class="hljs-string"></span><span class="hljs-string">          Related Topics é“¾è¡¨ åŒæŒ‡é’ˆ</span><span class="hljs-string">          ğŸ‘ 378 ğŸ‘ 0</span><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-comment"># leetcode submit region begin(Prohibit modification and deletion)</span><span class="hljs-comment"># Definition for singly-linked list.</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ListNode</span>:</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, val=<span class="hljs-number">0</span>, <span class="hljs-built_in">next</span>=<span class="hljs-literal">None</span></span>):</span>        self.val = val        self.<span class="hljs-built_in">next</span> = <span class="hljs-built_in">next</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span>:</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">partition</span>(<span class="hljs-params">self, head: ListNode, x: <span class="hljs-built_in">int</span></span>) -&gt; ListNode:</span>        lesser, greater = ListNode(<span class="hljs-built_in">next</span>=head), ListNode(<span class="hljs-built_in">next</span>=head)        less, great = lesser, greater        <span class="hljs-keyword">while</span> head:            <span class="hljs-keyword">if</span> head.val &lt; x:                less.<span class="hljs-built_in">next</span> = head                less = less.<span class="hljs-built_in">next</span>            <span class="hljs-keyword">else</span>:                great.<span class="hljs-built_in">next</span> = head                great = great.<span class="hljs-built_in">next</span>            head = head.<span class="hljs-built_in">next</span>        great.<span class="hljs-built_in">next</span> = <span class="hljs-literal">None</span>        less.<span class="hljs-built_in">next</span> = greater.<span class="hljs-built_in">next</span>        <span class="hljs-keyword">return</span> lesser.<span class="hljs-built_in">next</span><span class="hljs-comment"># leetcode submit region end(Prohibit modification and deletion)</span></code></pre><h6 id="138-å¤åˆ¶å¸¦éšæœºæŒ‡é’ˆçš„é“¾è¡¨"><a href="#138-å¤åˆ¶å¸¦éšæœºæŒ‡é’ˆçš„é“¾è¡¨" class="headerlink" title="138. å¤åˆ¶å¸¦éšæœºæŒ‡é’ˆçš„é“¾è¡¨"></a><a href="https://leetcode-cn.com/problems/copy-list-with-random-pointer/">138. å¤åˆ¶å¸¦éšæœºæŒ‡é’ˆçš„é“¾è¡¨</a></h6><p>ç»™ä½ ä¸€ä¸ªé•¿åº¦ä¸º n çš„é“¾è¡¨ï¼Œæ¯ä¸ªèŠ‚ç‚¹åŒ…å«ä¸€ä¸ªé¢å¤–å¢åŠ çš„éšæœºæŒ‡é’ˆ random ï¼Œè¯¥æŒ‡é’ˆå¯ä»¥æŒ‡å‘é“¾è¡¨ä¸­çš„ä»»ä½•èŠ‚ç‚¹æˆ–ç©ºèŠ‚ç‚¹ã€‚</p><p>æ„é€ è¿™ä¸ªé“¾è¡¨çš„ æ·±æ‹·è´ã€‚ æ·±æ‹·è´åº”è¯¥æ­£å¥½ç”± n ä¸ª å…¨æ–° èŠ‚ç‚¹ç»„æˆï¼Œå…¶ä¸­æ¯ä¸ªæ–°èŠ‚ç‚¹çš„å€¼éƒ½è®¾ä¸ºå…¶å¯¹åº”çš„åŸèŠ‚ç‚¹çš„å€¼ã€‚æ–°èŠ‚ç‚¹çš„ next æŒ‡é’ˆå’Œ random æŒ‡é’ˆä¹Ÿéƒ½åº”æŒ‡å‘å¤åˆ¶é“¾è¡¨ä¸­çš„æ–°èŠ‚ç‚¹ï¼Œå¹¶ä½¿åŸé“¾è¡¨å’Œå¤åˆ¶é“¾è¡¨ä¸­çš„è¿™äº›æŒ‡é’ˆèƒ½å¤Ÿè¡¨ç¤ºç›¸åŒçš„é“¾è¡¨çŠ¶æ€ã€‚<strong>å¤åˆ¶é“¾è¡¨ä¸­çš„æŒ‡é’ˆéƒ½ä¸åº”æŒ‡å‘åŸé“¾è¡¨ä¸­çš„èŠ‚ç‚¹ ã€‚</strong></p><p>ä¾‹å¦‚ï¼Œå¦‚æœåŸé“¾è¡¨ä¸­æœ‰ X å’Œ Y ä¸¤ä¸ªèŠ‚ç‚¹ï¼Œå…¶ä¸­ X.random â€“&gt; Y ã€‚é‚£ä¹ˆåœ¨å¤åˆ¶é“¾è¡¨ä¸­å¯¹åº”çš„ä¸¤ä¸ªèŠ‚ç‚¹ x å’Œ y ï¼ŒåŒæ ·æœ‰ x.random â€“&gt; y ã€‚</p><p>è¿”å›å¤åˆ¶é“¾è¡¨çš„å¤´èŠ‚ç‚¹ã€‚</p><p>ç”¨ä¸€ä¸ªç”± n ä¸ªèŠ‚ç‚¹ç»„æˆçš„é“¾è¡¨æ¥è¡¨ç¤ºè¾“å…¥/è¾“å‡ºä¸­çš„é“¾è¡¨ã€‚æ¯ä¸ªèŠ‚ç‚¹ç”¨ä¸€ä¸ª [val, random_index] è¡¨ç¤ºï¼š</p><p>valï¼šä¸€ä¸ªè¡¨ç¤º Node.val çš„æ•´æ•°ã€‚<br>random_indexï¼šéšæœºæŒ‡é’ˆæŒ‡å‘çš„èŠ‚ç‚¹ç´¢å¼•ï¼ˆèŒƒå›´ä» 0 åˆ° n-1ï¼‰ï¼›å¦‚æœä¸æŒ‡å‘ä»»ä½•èŠ‚ç‚¹ï¼Œåˆ™ä¸º  null ã€‚<br>ä½ çš„ä»£ç  åª æ¥å—åŸé“¾è¡¨çš„å¤´èŠ‚ç‚¹ head ä½œä¸ºä¼ å…¥å‚æ•°ã€‚</p><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><p><img src="https://assets.leetcode-cn.com/aliyun-lc-upload/uploads/2020/01/09/e1.png"></p><pre><code class="hljs angelscript">è¾“å…¥ï¼šhead = [[<span class="hljs-number">7</span>,<span class="hljs-literal">null</span>],[<span class="hljs-number">13</span>,<span class="hljs-number">0</span>],[<span class="hljs-number">11</span>,<span class="hljs-number">4</span>],[<span class="hljs-number">10</span>,<span class="hljs-number">2</span>],[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>]]è¾“å‡ºï¼š[[<span class="hljs-number">7</span>,<span class="hljs-literal">null</span>],[<span class="hljs-number">13</span>,<span class="hljs-number">0</span>],[<span class="hljs-number">11</span>,<span class="hljs-number">4</span>],[<span class="hljs-number">10</span>,<span class="hljs-number">2</span>],[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>]]</code></pre><p><strong>ç¤ºä¾‹ 2ï¼š</strong></p><p><img src="https://assets.leetcode-cn.com/aliyun-lc-upload/uploads/2020/01/09/e2.png"></p><pre><code class="hljs lua">è¾“å…¥ï¼šhead = <span class="hljs-string">[[1,1],[2,1]]</span>è¾“å‡ºï¼š<span class="hljs-string">[[1,1],[2,1]]</span></code></pre><p><strong>ç¤ºä¾‹ 3ï¼š</strong></p><p><img src="https://assets.leetcode-cn.com/aliyun-lc-upload/uploads/2020/01/09/e3.png"></p><p><strong>ç¤ºä¾‹ 4ï¼š</strong></p><pre><code class="hljs inform7">è¾“å…¥ï¼šhead = <span class="hljs-comment">[]</span>è¾“å‡ºï¼š<span class="hljs-comment">[]</span>è§£é‡Šï¼šç»™å®šçš„é“¾è¡¨ä¸ºç©ºï¼ˆç©ºæŒ‡é’ˆï¼‰ï¼Œå› æ­¤è¿”å› nullã€‚</code></pre><p><strong>æç¤ºï¼š</strong></p><ul><li><code>0 &lt;= n &lt;= 1000</code></li><li><code>-10000 &lt;= Node.val &lt;= 10000</code></li><li><code>Node.random</code> ä¸ºç©ºï¼ˆnullï¼‰æˆ–æŒ‡å‘é“¾è¡¨ä¸­çš„èŠ‚ç‚¹ã€‚</li></ul><p>è§£é¢˜æ€è·¯</p><pre><code class="hljs lsl">ä¸‰è½®ï¼š<span class="hljs-number">1.</span>åŸå§‹é“¾è¡¨æ¯ä¸ªèŠ‚ç‚¹åæ’å…¥è¯¥èŠ‚ç‚¹çš„å¤åˆ¶èŠ‚ç‚¹ï¼ˆ<span class="hljs-number">1</span>-&gt;<span class="hljs-number">2</span>-&gt;<span class="hljs-number">3</span> =&gt; <span class="hljs-number">1</span>-&gt;<span class="hljs-number">1</span>&#x27;-&gt;<span class="hljs-number">2</span>-&gt;<span class="hljs-number">2</span>&#x27;-&gt;<span class="hljs-number">3</span><span class="hljs-number">-3</span>&#x27;ï¼‰<span class="hljs-number">2.</span>ä¿®æ­£æ–°èŠ‚ç‚¹çš„randomå€¼<span class="hljs-number">3.</span>å°†<span class="hljs-number">1</span>-&gt;<span class="hljs-number">1</span>&#x27;-&gt;<span class="hljs-number">2</span>-&gt;<span class="hljs-number">2</span>&#x27;-&gt;<span class="hljs-number">3</span><span class="hljs-number">-3</span>&#x27;æ‹†åˆ†æˆ<span class="hljs-number">1</span>-&gt;<span class="hljs-number">2</span>-&gt;<span class="hljs-number">3</span>  <span class="hljs-number">1</span>&#x27;-&gt;<span class="hljs-number">2</span>&#x27;-&gt;<span class="hljs-number">3</span>&#x27;</code></pre><p><code>Java</code></p><pre><code class="hljs Java"><span class="hljs-comment">/*</span><span class="hljs-comment"> * Author: Wang P</span><span class="hljs-comment"> * Version: 1.0.0</span><span class="hljs-comment"> * Date: 2021-03-06 20:31:24</span><span class="hljs-comment"> * Description: 138-Copy List with Random Pointer</span><span class="hljs-comment"> **/</span> <span class="hljs-keyword">package</span> com.weitrue.leetcode.editor.cn;<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CopyListWithRandomPointer</span></span>&#123;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span></span>&#123;        Solution s = <span class="hljs-keyword">new</span> CopyListWithRandomPointer().<span class="hljs-function">new <span class="hljs-title">Solution</span><span class="hljs-params">()</span></span>;    &#125;        <span class="hljs-comment">//A linked list of length n is given such that each node contains an additional random pointer, which could point to any node in the list, or null.</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Construct a deep copy of the list. The deep copy should consist of exactly n brand new nodes, where each new node has its value set to the value of its corre</span>    <span class="hljs-comment">//sponding original node. Both the next and random pointer of the new nodes should point to new nodes in the copied list such that the pointers in the original li</span>    <span class="hljs-comment">//st and copied list represent the same list state. None of the pointers in the new list should point to nodes in the original list.</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// For example, if there are two nodes X and Y in the original list, where X.random --&gt; Y, then for the corresponding two nodes x and y in the copied list, x.random --&gt; y.</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Return the head of the copied linked list.</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// The linked list is represented in the input/output as a list of n nodes. Each node is represented as a pair of [val, random_index] where:</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// val: an integer representing Node.val</span>    <span class="hljs-comment">// random_index: the index of the node (range from 0 to n-1) that the random pointer points to, or null if it does not point to any node.</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Your code will only be given the head of the original linked list.</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Example 1:</span>    <span class="hljs-comment">//Input: head = [[7,null],[13,0],[11,4],[10,2],[1,0]]</span>    <span class="hljs-comment">//Output: [[7,null],[13,0],[11,4],[10,2],[1,0]]</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Example 2:</span>    <span class="hljs-comment">//Input: head = [[1,1],[2,1]]</span>    <span class="hljs-comment">//Output: [[1,1],[2,1]]</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Example 3:</span>    <span class="hljs-comment">//Input: head = [[3,null],[3,0],[3,null]]</span>    <span class="hljs-comment">//Output: [[3,null],[3,0],[3,null]]</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Example 4:</span>    <span class="hljs-comment">//Input: head = []</span>    <span class="hljs-comment">//Output: []</span>    <span class="hljs-comment">//Explanation: The given linked list is empty (null pointer), so return null.</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Constraints:</span>    <span class="hljs-comment">// 0 &lt;= n &lt;= 1000</span>    <span class="hljs-comment">// -10000 &lt;= Node.val &lt;= 10000</span>    <span class="hljs-comment">// Node.random is null or is pointing to some node in the linked list.</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Related Topics å“ˆå¸Œè¡¨ é“¾è¡¨</span>    <span class="hljs-comment">// ğŸ‘ 519 ğŸ‘ 0</span>    <span class="hljs-comment">//leetcode submit region begin(Prohibit modification and deletion)</span>    <span class="hljs-comment">/*</span><span class="hljs-comment">    // Definition for a Node.</span><span class="hljs-comment"></span><span class="hljs-comment">    */</span>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Node</span> </span>&#123;        <span class="hljs-keyword">int</span> val;        Node next;        Node random;        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Node</span><span class="hljs-params">(<span class="hljs-keyword">int</span> val)</span> </span>&#123;            <span class="hljs-keyword">this</span>.val = val;            <span class="hljs-keyword">this</span>.next = <span class="hljs-keyword">null</span>;            <span class="hljs-keyword">this</span>.random = <span class="hljs-keyword">null</span>;        &#125;    &#125;    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span> </span>&#123;        <span class="hljs-function"><span class="hljs-keyword">public</span> Node <span class="hljs-title">copyRandomList</span><span class="hljs-params">(Node head)</span> </span>&#123;            <span class="hljs-keyword">if</span> (head ==  <span class="hljs-keyword">null</span>) &#123;                <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;            &#125;            Node cur = head;            <span class="hljs-keyword">while</span> (cur != <span class="hljs-keyword">null</span>) &#123;                Node n = <span class="hljs-keyword">new</span> Node(cur.val);                n.next = cur.next;                cur.next = n;                cur = n.next;            &#125;            cur = head;            <span class="hljs-keyword">while</span> (cur != <span class="hljs-keyword">null</span>) &#123;                cur.next.random = (cur.random != <span class="hljs-keyword">null</span>) ? cur.random.next : <span class="hljs-keyword">null</span>;                cur = cur.next.next;            &#125;            cur = head;            Node newNode = head.next, next = newNode;            <span class="hljs-keyword">while</span> (cur != <span class="hljs-keyword">null</span>) &#123;                cur.next = cur.next.next;                next.next = next.next != <span class="hljs-keyword">null</span> ? next.next.next: <span class="hljs-keyword">null</span>;                cur = cur.next;                next = next.next;            &#125;            <span class="hljs-keyword">return</span> newNode;        &#125;    &#125;    <span class="hljs-comment">//leetcode submit region end(Prohibit modification and deletion)</span>&#125;</code></pre><p><code>Golang</code></p><pre><code class="hljs Golang"><span class="hljs-keyword">package</span> leetcode<span class="hljs-comment">/**</span><span class="hljs-comment"> * Author: Wang P</span><span class="hljs-comment"> * Version: 1.0.0</span><span class="hljs-comment"> * Date: 2021-03-18 20:37:49</span><span class="hljs-comment"> * Description: A linked list of length n is given such that each node contains an additional random pointer, which could point to any node in the list, or null.</span><span class="hljs-comment"></span><span class="hljs-comment">Construct a deep copy of the list. The deep copy should consist of exactly n brand new nodes, where each new node has its value set to the value of its corre</span><span class="hljs-comment">sponding original node. Both the next and random pointer of the new nodes should point to new nodes in the copied list such that the pointers in the original li</span><span class="hljs-comment">st and copied list represent the same list state. None of the pointers in the new list should point to nodes in the original list.</span><span class="hljs-comment"></span><span class="hljs-comment">For example, if there are two nodes X and Y in the original list, where X.random --&gt; Y, then for the corresponding two nodes x and y in the copied list, x.random --&gt; y.</span><span class="hljs-comment"></span><span class="hljs-comment">Return the head of the copied linked list.</span><span class="hljs-comment"></span><span class="hljs-comment">The linked list is represented in the input/output as a list of n nodes. Each node is represented as a pair of [val, random_index] where:</span><span class="hljs-comment"></span><span class="hljs-comment">val: an integer representing Node.val</span><span class="hljs-comment">random_index: the index of the node (range from 0 to n-1) that the random pointer points to, or null if it does not point to any node.</span><span class="hljs-comment"></span><span class="hljs-comment">Your code will only be given the head of the original linked list.</span><span class="hljs-comment"></span><span class="hljs-comment">Example 1:</span><span class="hljs-comment">Input: head = [[7,null],[13,0],[11,4],[10,2],[1,0]]</span><span class="hljs-comment">Output: [[7,null],[13,0],[11,4],[10,2],[1,0]]</span><span class="hljs-comment"></span><span class="hljs-comment">Example 2:</span><span class="hljs-comment">Input: head = [[1,1],[2,1]]</span><span class="hljs-comment">Output: [[1,1],[2,1]]</span><span class="hljs-comment"></span><span class="hljs-comment">Example 3:</span><span class="hljs-comment">Input: head = [[3,null],[3,0],[3,null]]</span><span class="hljs-comment">Output: [[3,null],[3,0],[3,null]]</span><span class="hljs-comment"></span><span class="hljs-comment">Example 4:</span><span class="hljs-comment">Input: head = []</span><span class="hljs-comment">Output: []</span><span class="hljs-comment">Explanation: The given linked list is empty (null pointer), so return null.</span><span class="hljs-comment"></span><span class="hljs-comment">Constraints:</span><span class="hljs-comment">0 &lt;= n &lt;= 1000</span><span class="hljs-comment">-10000 &lt;= Node.val &lt;= 10000</span><span class="hljs-comment">Node.random is null or is pointing to some node in the linked list.</span><span class="hljs-comment"></span><span class="hljs-comment">Related Topics å“ˆå¸Œè¡¨ é“¾è¡¨</span><span class="hljs-comment">ğŸ‘ 519 ğŸ‘ 0</span><span class="hljs-comment"> **/</span><span class="hljs-comment">//leetcode submit region begin(Prohibit modification and deletion)</span><span class="hljs-comment">/**</span><span class="hljs-comment"> * Definition for a Node.</span><span class="hljs-comment"> */</span><span class="hljs-keyword">type</span> Node <span class="hljs-keyword">struct</span> &#123;Val <span class="hljs-keyword">int</span>   Next *Node   Random *Node&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">copyRandomList</span><span class="hljs-params">(head *Node)</span> *<span class="hljs-title">Node</span></span> &#123;<span class="hljs-keyword">if</span> head == <span class="hljs-literal">nil</span> &#123;<span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>&#125;cur := head<span class="hljs-keyword">for</span> cur != <span class="hljs-literal">nil</span> &#123;n := &amp;Node&#123;Val:cur.Val, Next:cur.Next&#125;cur.Next = ncur = n.Next&#125;  cur = head<span class="hljs-keyword">for</span> cur != <span class="hljs-literal">nil</span> &amp;&amp; cur.Next != <span class="hljs-literal">nil</span> &#123;<span class="hljs-keyword">if</span> cur.Random != <span class="hljs-literal">nil</span> &#123;cur.Next.Random = cur.Random.Next&#125;<span class="hljs-keyword">else</span> &#123;cur.Next.Random = <span class="hljs-literal">nil</span>&#125;cur = cur.Next.Next&#125;  cur = headnewNode, next := head.Next, head.Next<span class="hljs-keyword">for</span> cur != <span class="hljs-literal">nil</span> &amp;&amp; cur.Next != <span class="hljs-literal">nil</span> &#123;cur.Next = cur.Next.Next<span class="hljs-keyword">if</span> next.Next != <span class="hljs-literal">nil</span> &#123;next.Next = next.Next.Next&#125;<span class="hljs-keyword">else</span> &#123;next.Next = <span class="hljs-literal">nil</span>&#125;cur = cur.Nextnext = next.Next&#125;<span class="hljs-keyword">return</span> newNode&#125;<span class="hljs-comment">//leetcode submit region end(Prohibit modification and deletion)</span></code></pre><p><code>Python</code></p><pre><code class="hljs Python"><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">Module Description: 138-å¤åˆ¶å¸¦éšæœºæŒ‡é’ˆçš„é“¾è¡¨</span><span class="hljs-string">Solutionï¼š</span><span class="hljs-string">Date: 2021-03-06 20:33:56</span><span class="hljs-string">Author: Wang P</span><span class="hljs-string">Problem:  ç»™ä½ ä¸€ä¸ªé•¿åº¦ä¸º n çš„é“¾è¡¨ï¼Œæ¯ä¸ªèŠ‚ç‚¹åŒ…å«ä¸€ä¸ªé¢å¤–å¢åŠ çš„éšæœºæŒ‡é’ˆ random ï¼Œè¯¥æŒ‡é’ˆå¯ä»¥æŒ‡å‘é“¾è¡¨ä¸­çš„ä»»ä½•èŠ‚ç‚¹æˆ–ç©ºèŠ‚ç‚¹ã€‚</span><span class="hljs-string">          æ„é€ è¿™ä¸ªé“¾è¡¨çš„ æ·±æ‹·è´ã€‚ æ·±æ‹·è´åº”è¯¥æ­£å¥½ç”± n ä¸ª å…¨æ–° èŠ‚ç‚¹ç»„æˆï¼Œå…¶ä¸­æ¯ä¸ªæ–°èŠ‚ç‚¹çš„å€¼éƒ½è®¾ä¸ºå…¶å¯¹åº”çš„åŸèŠ‚ç‚¹çš„å€¼ã€‚æ–°èŠ‚ç‚¹çš„ next æŒ‡é’ˆå’Œ random</span><span class="hljs-string">         æŒ‡é’ˆä¹Ÿéƒ½åº”æŒ‡å‘å¤åˆ¶é“¾è¡¨ä¸­çš„æ–°èŠ‚ç‚¹ï¼Œå¹¶ä½¿åŸé“¾è¡¨å’Œå¤åˆ¶é“¾è¡¨ä¸­çš„è¿™äº›æŒ‡é’ˆèƒ½å¤Ÿè¡¨ç¤ºç›¸åŒçš„é“¾è¡¨çŠ¶æ€ã€‚å¤åˆ¶é“¾è¡¨ä¸­çš„æŒ‡é’ˆéƒ½ä¸åº”æŒ‡å‘åŸé“¾è¡¨ä¸­çš„èŠ‚ç‚¹ ã€‚</span><span class="hljs-string">          ä¾‹å¦‚ï¼Œå¦‚æœåŸé“¾è¡¨ä¸­æœ‰ X å’Œ Y ä¸¤ä¸ªèŠ‚ç‚¹ï¼Œå…¶ä¸­ X.random --&gt; Y ã€‚é‚£ä¹ˆåœ¨å¤åˆ¶é“¾è¡¨ä¸­å¯¹åº”çš„ä¸¤ä¸ªèŠ‚ç‚¹ x å’Œ y ï¼ŒåŒæ ·æœ‰ x.random--&gt; y ã€‚</span><span class="hljs-string">          è¿”å›å¤åˆ¶é“¾è¡¨çš„å¤´èŠ‚ç‚¹ã€‚</span><span class="hljs-string">          ç”¨ä¸€ä¸ªç”± n ä¸ªèŠ‚ç‚¹ç»„æˆçš„é“¾è¡¨æ¥è¡¨ç¤ºè¾“å…¥/è¾“å‡ºä¸­çš„é“¾è¡¨ã€‚æ¯ä¸ªèŠ‚ç‚¹ç”¨ä¸€ä¸ª [val, random_index] è¡¨ç¤ºï¼š</span><span class="hljs-string">          valï¼šä¸€ä¸ªè¡¨ç¤º Node.val çš„æ•´æ•°ã€‚</span><span class="hljs-string">          random_indexï¼šéšæœºæŒ‡é’ˆæŒ‡å‘çš„èŠ‚ç‚¹ç´¢å¼•ï¼ˆèŒƒå›´ä» 0 åˆ° n-1ï¼‰ï¼›å¦‚æœä¸æŒ‡å‘ä»»ä½•èŠ‚ç‚¹ï¼Œåˆ™ä¸º null ã€‚</span><span class="hljs-string">          ä½ çš„ä»£ç  åª æ¥å—åŸé“¾è¡¨çš„å¤´èŠ‚ç‚¹ head ä½œä¸ºä¼ å…¥å‚æ•°ã€‚</span><span class="hljs-string"></span><span class="hljs-string">          ç¤ºä¾‹ 1ï¼š</span><span class="hljs-string">         è¾“å…¥ï¼šhead = [[7,null],[13,0],[11,4],[10,2],[1,0]]</span><span class="hljs-string">         è¾“å‡ºï¼š[[7,null],[13,0],[11,4],[10,2],[1,0]]</span><span class="hljs-string"></span><span class="hljs-string">          ç¤ºä¾‹ 2ï¼š</span><span class="hljs-string">         è¾“å…¥ï¼šhead = [[1,1],[2,1]]</span><span class="hljs-string">         è¾“å‡ºï¼š[[1,1],[2,1]]</span><span class="hljs-string"></span><span class="hljs-string">          ç¤ºä¾‹ 3ï¼š</span><span class="hljs-string">         è¾“å…¥ï¼šhead = [[3,null],[3,0],[3,null]]</span><span class="hljs-string">         è¾“å‡ºï¼š[[3,null],[3,0],[3,null]]</span><span class="hljs-string"></span><span class="hljs-string">          ç¤ºä¾‹ 4ï¼š</span><span class="hljs-string"></span><span class="hljs-string">         è¾“å…¥ï¼šhead = []</span><span class="hljs-string">         è¾“å‡ºï¼š[]</span><span class="hljs-string">         è§£é‡Šï¼šç»™å®šçš„é“¾è¡¨ä¸ºç©ºï¼ˆç©ºæŒ‡é’ˆï¼‰ï¼Œå› æ­¤è¿”å› nullã€‚</span><span class="hljs-string"></span><span class="hljs-string">          æç¤ºï¼š</span><span class="hljs-string">          0 &lt;= n &lt;= 1000</span><span class="hljs-string">          -10000 &lt;= Node.val &lt;= 10000</span><span class="hljs-string">          Node.random ä¸ºç©ºï¼ˆnullï¼‰æˆ–æŒ‡å‘é“¾è¡¨ä¸­çš„èŠ‚ç‚¹ã€‚</span><span class="hljs-string"></span><span class="hljs-string">          Related Topics å“ˆå¸Œè¡¨ é“¾è¡¨</span><span class="hljs-string">          ğŸ‘ 519 ğŸ‘ 0</span><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-comment"># leetcode submit region begin(Prohibit modification and deletion)</span><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string"># Definition for a Node.</span><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-comment"># class Node:</span><span class="hljs-comment">#     def __init__(self, x: int, next: &#x27;Node&#x27; = None, random: &#x27;Node&#x27; = None):</span><span class="hljs-comment">#         self.val = int(x)</span><span class="hljs-comment">#         self.next = next</span><span class="hljs-comment">#         self.random = random</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span>:</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">copyRandomList</span>(<span class="hljs-params">self, head: <span class="hljs-string">&#x27;Node&#x27;</span></span>) -&gt; &#x27;Node&#x27;:</span>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> head:            <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span>        cur = head        <span class="hljs-keyword">while</span> cur:            n = Node(x=cur.val, <span class="hljs-built_in">next</span>=cur.<span class="hljs-built_in">next</span>)            cur.<span class="hljs-built_in">next</span> = n            cur = n.<span class="hljs-built_in">next</span>        cur = head        <span class="hljs-keyword">while</span> cur <span class="hljs-keyword">and</span> cur.<span class="hljs-built_in">next</span>:            cur.<span class="hljs-built_in">next</span>.random = cur.random.<span class="hljs-built_in">next</span> <span class="hljs-keyword">if</span> cur.random <span class="hljs-keyword">else</span> <span class="hljs-literal">None</span>            cur = cur.<span class="hljs-built_in">next</span>.<span class="hljs-built_in">next</span>        cur = head        new_node = nex = head.<span class="hljs-built_in">next</span>        <span class="hljs-keyword">while</span> cur <span class="hljs-keyword">and</span> nex:            cur.<span class="hljs-built_in">next</span> = cur.<span class="hljs-built_in">next</span>.<span class="hljs-built_in">next</span>            nex.<span class="hljs-built_in">next</span> = nex.<span class="hljs-built_in">next</span>.<span class="hljs-built_in">next</span> <span class="hljs-keyword">if</span> nex.<span class="hljs-built_in">next</span> <span class="hljs-keyword">else</span> <span class="hljs-literal">None</span>            cur = cur.<span class="hljs-built_in">next</span>            nex = nex.<span class="hljs-built_in">next</span>        <span class="hljs-keyword">return</span> new_node        <span class="hljs-comment"># leetcode submit region end(Prohibit modification and deletion)</span></code></pre><h4 id="çº¿ç¨‹æ± ä¸ä»»åŠ¡é˜Ÿåˆ—"><a href="#çº¿ç¨‹æ± ä¸ä»»åŠ¡é˜Ÿåˆ—" class="headerlink" title="çº¿ç¨‹æ± ä¸ä»»åŠ¡é˜Ÿåˆ—"></a>çº¿ç¨‹æ± ä¸ä»»åŠ¡é˜Ÿåˆ—</h4><h5 id="ç®€å•é˜Ÿåˆ—è®¾è®¡"><a href="#ç®€å•é˜Ÿåˆ—è®¾è®¡" class="headerlink" title="ç®€å•é˜Ÿåˆ—è®¾è®¡"></a>ç®€å•é˜Ÿåˆ—è®¾è®¡</h5><pre><code class="hljs Java"></code></pre><pre><code class="hljs go"><span class="hljs-keyword">package</span> array<span class="hljs-keyword">type</span> Queue []<span class="hljs-keyword">interface</span> &#123;&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(q *Queue)</span><span class="hljs-title">push</span><span class="hljs-params">(v <span class="hljs-keyword">interface</span>&#123;&#125;)</span> <span class="hljs-title">error</span></span> &#123;  <span class="hljs-comment">// å…¥é˜Ÿ</span>*q = <span class="hljs-built_in">append</span>(*q, v)<span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(q *Queue)</span><span class="hljs-title">pop</span><span class="hljs-params">()</span> <span class="hljs-params">(<span class="hljs-keyword">interface</span>&#123;&#125;, <span class="hljs-keyword">bool</span>)</span></span> &#123;  <span class="hljs-comment">// å‡ºé˜Ÿ</span><span class="hljs-keyword">if</span> q.isEmpty() &#123;<span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>, <span class="hljs-literal">false</span>&#125;head := (*q)[<span class="hljs-number">0</span>]*q = (*q)[<span class="hljs-number">1</span>:]<span class="hljs-keyword">return</span> head, <span class="hljs-literal">true</span>&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(q *Queue)</span><span class="hljs-title">isEmpty</span><span class="hljs-params">()</span> <span class="hljs-title">bool</span></span> &#123;  <span class="hljs-comment">// é˜Ÿåˆ—åˆ¤ç©º</span><span class="hljs-keyword">return</span> <span class="hljs-built_in">len</span>(*q) == <span class="hljs-number">0</span>&#125;</code></pre><pre><code class="hljs Python"></code></pre><h6 id="622-è®¾è®¡å¾ªç¯é˜Ÿåˆ—"><a href="#622-è®¾è®¡å¾ªç¯é˜Ÿåˆ—" class="headerlink" title="622. è®¾è®¡å¾ªç¯é˜Ÿåˆ—"></a><a href="https://leetcode-cn.com/problems/design-circular-queue/">622. è®¾è®¡å¾ªç¯é˜Ÿåˆ—</a></h6><p>è®¾è®¡ä½ çš„å¾ªç¯é˜Ÿåˆ—å®ç°ã€‚ å¾ªç¯é˜Ÿåˆ—æ˜¯ä¸€ç§çº¿æ€§æ•°æ®ç»“æ„ï¼Œå…¶æ“ä½œè¡¨ç°åŸºäº FIFOï¼ˆå…ˆè¿›å…ˆå‡ºï¼‰åŸåˆ™å¹¶ä¸”é˜Ÿå°¾è¢«è¿æ¥åœ¨é˜Ÿé¦–ä¹‹åä»¥å½¢æˆä¸€ä¸ªå¾ªç¯ã€‚å®ƒä¹Ÿè¢«ç§°ä¸ºâ€œç¯å½¢ç¼“å†²å™¨â€ã€‚</p><p>å¾ªç¯é˜Ÿåˆ—çš„ä¸€ä¸ªå¥½å¤„æ˜¯æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªé˜Ÿåˆ—ä¹‹å‰ç”¨è¿‡çš„ç©ºé—´ã€‚åœ¨ä¸€ä¸ªæ™®é€šé˜Ÿåˆ—é‡Œï¼Œä¸€æ—¦ä¸€ä¸ªé˜Ÿåˆ—æ»¡äº†ï¼Œæˆ‘ä»¬å°±ä¸èƒ½æ’å…¥ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå³ä½¿åœ¨é˜Ÿåˆ—å‰é¢ä»æœ‰ç©ºé—´ã€‚ä½†æ˜¯ä½¿ç”¨å¾ªç¯é˜Ÿåˆ—ï¼Œæˆ‘ä»¬èƒ½ä½¿ç”¨è¿™äº›ç©ºé—´å»å­˜å‚¨æ–°çš„å€¼ã€‚</p><p><code>(tail-front)</code></p><p>ä½ çš„å®ç°åº”è¯¥æ”¯æŒå¦‚ä¸‹æ“ä½œï¼š</p><ul><li>MyCircularQueue(k): æ„é€ å™¨ï¼Œè®¾ç½®é˜Ÿåˆ—é•¿åº¦ä¸º k ã€‚</li><li>Front: ä»é˜Ÿé¦–è·å–å…ƒç´ ã€‚å¦‚æœé˜Ÿåˆ—ä¸ºç©ºï¼Œè¿”å› -1 ã€‚</li><li>Rear: è·å–é˜Ÿå°¾å…ƒç´ ã€‚å¦‚æœé˜Ÿåˆ—ä¸ºç©ºï¼Œè¿”å› -1 ã€‚</li><li>enQueue(value): å‘å¾ªç¯é˜Ÿåˆ—æ’å…¥ä¸€ä¸ªå…ƒç´ ã€‚å¦‚æœæˆåŠŸæ’å…¥åˆ™è¿”å›çœŸã€‚<br>deQueue(): ä»å¾ªç¯é˜Ÿåˆ—ä¸­åˆ é™¤ä¸€ä¸ªå…ƒç´ ã€‚å¦‚æœæˆåŠŸåˆ é™¤åˆ™è¿”å›çœŸã€‚<br>isEmpty(): æ£€æŸ¥å¾ªç¯é˜Ÿåˆ—æ˜¯å¦ä¸ºç©ºã€‚<br>isFull(): æ£€æŸ¥å¾ªç¯é˜Ÿåˆ—æ˜¯å¦å·²æ»¡ã€‚</li></ul><p>è§£é¢˜æ€è·¯</p><pre><code class="hljs plain">åŸºäºæ•°ç»„å®ç°åŸºäºé“¾è¡¨å®ç°</code></pre><p><code>Java</code></p><pre><code class="hljs Java"><span class="hljs-keyword">package</span> com.weitrue.leetcode.editor.cn;<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DesignCircularQueue</span></span>&#123;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span></span>&#123;        Solution s = <span class="hljs-keyword">new</span> DesignCircularQueue().<span class="hljs-function">new <span class="hljs-title">Solution</span><span class="hljs-params">()</span></span>;    &#125;     <span class="hljs-comment">//leetcode submit region begin(Prohibit modification and deletion)</span>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyCircularQueue</span> </span>&#123;            <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span>[] queue;            <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> capacity, front, rear, count;        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">MyCircularQueue</span><span class="hljs-params">(<span class="hljs-keyword">int</span> k)</span> </span>&#123;            queue = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[k];            capacity = k;            count = <span class="hljs-number">0</span>;            front = <span class="hljs-number">0</span>;            rear = <span class="hljs-number">0</span>;        &#125;        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">enQueue</span><span class="hljs-params">(<span class="hljs-keyword">int</span> value)</span> </span>&#123;            <span class="hljs-keyword">if</span> (isFull()) <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;            queue[rear++] = value;            rear %= capacity;            count++;            <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;        &#125;        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">deQueue</span><span class="hljs-params">()</span> </span>&#123;            <span class="hljs-keyword">if</span> (isEmpty()) <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;            front = (front + <span class="hljs-number">1</span>) % capacity;            count--;            <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;        &#125;        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">Front</span><span class="hljs-params">()</span> </span>&#123;            <span class="hljs-keyword">if</span> (isEmpty()) <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;            <span class="hljs-keyword">return</span> queue[front];        &#125;        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">Rear</span><span class="hljs-params">()</span> </span>&#123;            <span class="hljs-keyword">if</span> (isEmpty()) <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;            <span class="hljs-keyword">return</span> queue[(rear-<span class="hljs-number">1</span>+capacity)%capacity];        &#125;        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">isEmpty</span><span class="hljs-params">()</span> </span>&#123;            <span class="hljs-keyword">return</span> count == <span class="hljs-number">0</span>;        &#125;        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">isFull</span><span class="hljs-params">()</span> </span>&#123;            <span class="hljs-keyword">return</span> count == capacity;        &#125;    &#125;    <span class="hljs-comment">//leetcode submit region end(Prohibit modification and deletion)</span>&#125;</code></pre><p><code>Golang</code></p><pre><code class="hljs Golang"><span class="hljs-keyword">type</span> MyCircularQueue <span class="hljs-keyword">struct</span> &#123;queue []<span class="hljs-keyword">int</span>capacity <span class="hljs-keyword">int</span>count <span class="hljs-keyword">int</span>front <span class="hljs-keyword">int</span>rear <span class="hljs-keyword">int</span>&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">Constructor</span><span class="hljs-params">(k <span class="hljs-keyword">int</span>)</span> <span class="hljs-title">MyCircularQueue</span></span> &#123;<span class="hljs-keyword">return</span> MyCircularQueue&#123;queue:<span class="hljs-built_in">make</span>([]<span class="hljs-keyword">int</span>, k),capacity:k,&#125;&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(this *MyCircularQueue)</span> <span class="hljs-title">EnQueue</span><span class="hljs-params">(value <span class="hljs-keyword">int</span>)</span> <span class="hljs-title">bool</span></span> &#123;<span class="hljs-keyword">if</span> this.IsFull() &#123; <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>&#125;this.queue[this.rear] = valuethis.rear = (this.rear + <span class="hljs-number">1</span>) % this.capacitythis.count++<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(this *MyCircularQueue)</span> <span class="hljs-title">DeQueue</span><span class="hljs-params">()</span> <span class="hljs-title">bool</span></span> &#123;<span class="hljs-keyword">if</span> this.IsEmpty()&#123; <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>&#125;this.front = (this.front + <span class="hljs-number">1</span>) % this.capacitythis.count--<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(this *MyCircularQueue)</span> <span class="hljs-title">Front</span><span class="hljs-params">()</span> <span class="hljs-title">int</span></span> &#123;<span class="hljs-keyword">if</span> this.IsEmpty() &#123; <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>&#125;<span class="hljs-keyword">return</span> this.queue[this.front]&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(this *MyCircularQueue)</span> <span class="hljs-title">Rear</span><span class="hljs-params">()</span> <span class="hljs-title">int</span></span> &#123;<span class="hljs-keyword">if</span> this.IsEmpty() &#123; <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>&#125;<span class="hljs-keyword">return</span> this.queue[(this.rear - <span class="hljs-number">1</span> + this.capacity)%this.capacity]&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(this *MyCircularQueue)</span> <span class="hljs-title">IsEmpty</span><span class="hljs-params">()</span> <span class="hljs-title">bool</span></span> &#123;<span class="hljs-keyword">return</span> this.count == <span class="hljs-number">0</span>&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(this *MyCircularQueue)</span> <span class="hljs-title">IsFull</span><span class="hljs-params">()</span> <span class="hljs-title">bool</span></span> &#123;<span class="hljs-keyword">return</span> this.count == this.capacity&#125;</code></pre><p><code>Python</code></p><pre><code class="hljs Python"><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">Module Description: 622-è®¾è®¡å¾ªç¯é˜Ÿåˆ—</span><span class="hljs-string">Solutionï¼š</span><span class="hljs-string">Author: Wang P</span><span class="hljs-string">Problem:# è®¾è®¡ä½ çš„å¾ªç¯é˜Ÿåˆ—å®ç°ã€‚ å¾ªç¯é˜Ÿåˆ—æ˜¯ä¸€ç§çº¿æ€§æ•°æ®ç»“æ„ï¼Œå…¶æ“ä½œè¡¨ç°åŸºäº FIFOï¼ˆå…ˆè¿›å…ˆå‡ºï¼‰åŸåˆ™å¹¶ä¸”é˜Ÿå°¾è¢«è¿æ¥åœ¨é˜Ÿé¦–ä¹‹åä»¥å½¢æˆä¸€ä¸ªå¾ªç¯ã€‚å®ƒä¹Ÿè¢«ç§°ä¸ºâ€œç¯å½¢ç¼“å†²å™¨â€ã€‚</span><span class="hljs-string">        #  å¾ªç¯é˜Ÿåˆ—çš„ä¸€ä¸ªå¥½å¤„æ˜¯æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªé˜Ÿåˆ—ä¹‹å‰ç”¨è¿‡çš„ç©ºé—´ã€‚åœ¨ä¸€ä¸ªæ™®é€šé˜Ÿåˆ—é‡Œï¼Œä¸€æ—¦ä¸€ä¸ªé˜Ÿåˆ—æ»¡äº†ï¼Œæˆ‘ä»¬å°±ä¸èƒ½æ’å…¥ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå³ä½¿åœ¨é˜Ÿåˆ—å‰é¢ä»æœ‰ç©ºé—´ã€‚ä½†æ˜¯ä½¿ç”¨å¾ªç¯é˜Ÿåˆ—ï¼Œæˆ‘ä»¬èƒ½ä½¿ç”¨è¿™äº›ç©ºé—´å»å­˜å‚¨æ–°çš„å€¼ã€‚</span><span class="hljs-string">        #</span><span class="hljs-string">        #  ä½ çš„å®ç°åº”è¯¥æ”¯æŒå¦‚ä¸‹æ“ä½œï¼š</span><span class="hljs-string">        #</span><span class="hljs-string">        #  MyCircularQueue(k): æ„é€ å™¨ï¼Œè®¾ç½®é˜Ÿåˆ—é•¿åº¦ä¸º k ã€‚</span><span class="hljs-string">        #  Front: ä»é˜Ÿé¦–è·å–å…ƒç´ ã€‚å¦‚æœé˜Ÿåˆ—ä¸ºç©ºï¼Œè¿”å› -1 ã€‚</span><span class="hljs-string">        #  Rear: è·å–é˜Ÿå°¾å…ƒç´ ã€‚å¦‚æœé˜Ÿåˆ—ä¸ºç©ºï¼Œè¿”å› -1 ã€‚</span><span class="hljs-string">        #  enQueue(value): å‘å¾ªç¯é˜Ÿåˆ—æ’å…¥ä¸€ä¸ªå…ƒç´ ã€‚å¦‚æœæˆåŠŸæ’å…¥åˆ™è¿”å›çœŸã€‚</span><span class="hljs-string">        #  deQueue(): ä»å¾ªç¯é˜Ÿåˆ—ä¸­åˆ é™¤ä¸€ä¸ªå…ƒç´ ã€‚å¦‚æœæˆåŠŸåˆ é™¤åˆ™è¿”å›çœŸã€‚</span><span class="hljs-string">        #  isEmpty(): æ£€æŸ¥å¾ªç¯é˜Ÿåˆ—æ˜¯å¦ä¸ºç©ºã€‚</span><span class="hljs-string">        #  isFull(): æ£€æŸ¥å¾ªç¯é˜Ÿåˆ—æ˜¯å¦å·²æ»¡ã€‚</span><span class="hljs-string">        #</span><span class="hljs-string">        #  ç¤ºä¾‹ï¼š</span><span class="hljs-string">        #  MyCircularQueue circularQueue = new MyCircularQueue(3); // è®¾ç½®é•¿åº¦ä¸º 3</span><span class="hljs-string">        # circularQueue.enQueue(1); Â // è¿”å› true</span><span class="hljs-string">        # circularQueue.enQueue(2); Â // è¿”å› true</span><span class="hljs-string">        # circularQueue.enQueue(3); Â // è¿”å› true</span><span class="hljs-string">        # circularQueue.enQueue(4); Â // è¿”å› falseï¼Œé˜Ÿåˆ—å·²æ»¡</span><span class="hljs-string">        # circularQueue.Rear(); Â // è¿”å› 3</span><span class="hljs-string">        # circularQueue.isFull(); Â // è¿”å› true</span><span class="hljs-string">        # circularQueue.deQueue(); Â // è¿”å› true</span><span class="hljs-string">        # circularQueue.enQueue(4); Â // è¿”å› true</span><span class="hljs-string">        # circularQueue.Rear(); Â // è¿”å› 4</span><span class="hljs-string">        #</span><span class="hljs-string">        #  æç¤ºï¼š</span><span class="hljs-string">        #  æ‰€æœ‰çš„å€¼éƒ½åœ¨ 0 è‡³ 1000 çš„èŒƒå›´å†…ï¼›</span><span class="hljs-string">        #  æ“ä½œæ•°å°†åœ¨ 1 è‡³ 1000 çš„èŒƒå›´å†…ï¼›</span><span class="hljs-string">        #  è¯·ä¸è¦ä½¿ç”¨å†…ç½®çš„é˜Ÿåˆ—åº“ã€‚</span><span class="hljs-string">        #</span><span class="hljs-string">        #  Related Topics è®¾è®¡ é˜Ÿåˆ—</span><span class="hljs-string">        #  ğŸ‘ 180 ğŸ‘ 0</span><span class="hljs-string"></span><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-comment"># leetcode submit region begin(Prohibit modification and deletion)</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyCircularQueue</span>:</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, k: <span class="hljs-built_in">int</span></span>):</span>        self.queue = []        self.capacity = k        self.count = <span class="hljs-number">0</span>        self.front = <span class="hljs-number">0</span>        self.rear = <span class="hljs-number">0</span>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, k):            self.queue.append(<span class="hljs-number">-1</span>)    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">enQueue</span>(<span class="hljs-params">self, value: <span class="hljs-built_in">int</span></span>) -&gt; bool:</span>        <span class="hljs-keyword">if</span> self.isFull():            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>        self.queue[self.rear] = value        self.rear = (self.rear + <span class="hljs-number">1</span>) % self.capacity        self.count += <span class="hljs-number">1</span>        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">deQueue</span>(<span class="hljs-params">self</span>) -&gt; bool:</span>        <span class="hljs-keyword">if</span> self.isEmpty():            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>        self.front = (self.front + <span class="hljs-number">1</span>) % self.capacity        self.count -= <span class="hljs-number">1</span>        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">Front</span>(<span class="hljs-params">self</span>) -&gt; int:</span>        <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span> <span class="hljs-keyword">if</span> self.isEmpty() <span class="hljs-keyword">else</span> self.queue[self.front]    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">Rear</span>(<span class="hljs-params">self</span>) -&gt; int:</span>        <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span> <span class="hljs-keyword">if</span> self.isEmpty() <span class="hljs-keyword">else</span> self.queue[(self.rear - <span class="hljs-number">1</span> + self.capacity) % self.capacity]    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">isEmpty</span>(<span class="hljs-params">self</span>) -&gt; bool:</span>        <span class="hljs-keyword">return</span> self.count == <span class="hljs-number">0</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">isFull</span>(<span class="hljs-params">self</span>) -&gt; bool:</span>        <span class="hljs-keyword">return</span> self.count == self.capacity<span class="hljs-comment"># leetcode submit region end(Prohibit modification and deletion)</span></code></pre><p><strong>é“¾è¡¨æ–¹å¼</strong></p><pre><code class="hljs Java"><span class="hljs-comment">// é“¾è¡¨æ–¹å¼å®ç°</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Node</span> </span>&#123;     <span class="hljs-keyword">int</span> val;     Node next;     <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Node</span><span class="hljs-params">(<span class="hljs-keyword">int</span> val)</span> </span>&#123;         <span class="hljs-keyword">this</span>.val = val;     &#125; &#125; <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CircularQueue</span> </span>&#123;     <span class="hljs-keyword">private</span> Node head, tail;     <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> count, capacity;     <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">CircularQueue</span><span class="hljs-params">(<span class="hljs-keyword">int</span> k)</span> </span>&#123;         capacity = k;     &#125;     <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">enQueue</span><span class="hljs-params">(<span class="hljs-keyword">int</span> value)</span> </span>&#123;         <span class="hljs-keyword">if</span> (isFull()) <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;         Node node = <span class="hljs-keyword">new</span> Node(value);         <span class="hljs-keyword">if</span> (count == <span class="hljs-number">0</span>) &#123;             head = node;             tail = node;         &#125;<span class="hljs-keyword">else</span>&#123;             tail.next = node;             tail = tail.next;         &#125;         count++;         <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;     &#125;     <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">deQueue</span><span class="hljs-params">()</span> </span>&#123;         <span class="hljs-keyword">if</span> (isEmpty()) <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;         head = head.next;         <span class="hljs-keyword">if</span> (count == <span class="hljs-number">1</span>) tail = head;         count--;         <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;     &#125;     <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">Front</span><span class="hljs-params">()</span> </span>&#123;         <span class="hljs-keyword">return</span> head.val;     &#125;     <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">Rear</span><span class="hljs-params">()</span> </span>&#123;         <span class="hljs-keyword">return</span> tail.val;     &#125;     <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">isEmpty</span><span class="hljs-params">()</span> </span>&#123;         <span class="hljs-keyword">return</span> count == <span class="hljs-number">0</span>;     &#125;     <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">isFull</span><span class="hljs-params">()</span> </span>&#123;         <span class="hljs-keyword">return</span> count == capacity;     &#125; &#125;</code></pre><pre><code class="hljs Go"><span class="hljs-keyword">type</span> ListNode <span class="hljs-keyword">struct</span> &#123;Val  <span class="hljs-keyword">int</span>Next *ListNode&#125;<span class="hljs-keyword">type</span> CircularQueue <span class="hljs-keyword">struct</span> &#123;capacity <span class="hljs-keyword">int</span>count    <span class="hljs-keyword">int</span>head     *ListNodetail     *ListNode&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">NewCircularQueue</span><span class="hljs-params">(k <span class="hljs-keyword">int</span>)</span> <span class="hljs-title">CircularQueue</span></span> &#123;<span class="hljs-keyword">return</span> CircularQueue&#123;capacity:k,&#125;&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(this *CircularQueue)</span> <span class="hljs-title">EnQueue</span><span class="hljs-params">(value <span class="hljs-keyword">int</span>)</span> <span class="hljs-title">bool</span></span> &#123;<span class="hljs-keyword">if</span> this.IsFull() &#123; <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>&#125;node := ListNode&#123;Val: value&#125;<span class="hljs-keyword">if</span> this.count == <span class="hljs-number">0</span> &#123;this.head = &amp;nodethis.tail = &amp;node&#125; <span class="hljs-keyword">else</span> &#123;this.tail.Next = &amp;nodethis.tail = this.tail.Next&#125;this.count++<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(this *CircularQueue)</span> <span class="hljs-title">DeQueue</span><span class="hljs-params">()</span> <span class="hljs-title">bool</span></span> &#123;<span class="hljs-keyword">if</span> this.IsEmpty()&#123; <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>&#125;this.head = this.head.Next<span class="hljs-keyword">if</span> this.count == <span class="hljs-number">1</span> &#123;this.tail = this.head&#125;this.count--<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(this *CircularQueue)</span> <span class="hljs-title">Front</span><span class="hljs-params">()</span> <span class="hljs-title">int</span></span> &#123;<span class="hljs-keyword">if</span> this.IsEmpty() &#123; <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>&#125;<span class="hljs-keyword">return</span> this.head.Val&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(this *CircularQueue)</span> <span class="hljs-title">Rear</span><span class="hljs-params">()</span> <span class="hljs-title">int</span></span> &#123;<span class="hljs-keyword">if</span> this.IsEmpty() &#123;<span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>&#125;<span class="hljs-keyword">return</span> this.tail.Val&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(this *CircularQueue)</span> <span class="hljs-title">IsEmpty</span><span class="hljs-params">()</span> <span class="hljs-title">bool</span></span> &#123;<span class="hljs-keyword">return</span> this.count == <span class="hljs-number">0</span>&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(this *CircularQueue)</span> <span class="hljs-title">IsFull</span><span class="hljs-params">()</span> <span class="hljs-title">bool</span></span> &#123;<span class="hljs-keyword">return</span> this.count == this.capacity&#125;</code></pre><pre><code class="hljs Python"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Node</span>:</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, value: <span class="hljs-built_in">int</span></span>):</span>        self.val = value        self.next_node = <span class="hljs-literal">None</span>        <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CircularQueue</span>:</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, k: <span class="hljs-built_in">int</span></span>):</span>        self.capacity = k        self.count = <span class="hljs-number">0</span>        self.head = <span class="hljs-literal">None</span>        self.tail = <span class="hljs-literal">None</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">enQueue</span>(<span class="hljs-params">self, value: <span class="hljs-built_in">int</span></span>) -&gt; bool:</span>        <span class="hljs-keyword">if</span> self.isFull():            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>        node = Node(value)        <span class="hljs-keyword">if</span> self.count == <span class="hljs-number">0</span>:            self.head = self.tail = node        <span class="hljs-keyword">else</span>:            self.tail.next_node = node            self.tail = self.tail.next_node        self.count += <span class="hljs-number">1</span>        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">deQueue</span>(<span class="hljs-params">self</span>) -&gt; bool:</span>        <span class="hljs-keyword">if</span> self.isEmpty():            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>        self.head = self.head.next_node        <span class="hljs-keyword">if</span> self.count == <span class="hljs-number">1</span>:            self.tail = self.head        self.count -= <span class="hljs-number">1</span>        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">Front</span>(<span class="hljs-params">self</span>) -&gt; int:</span>        <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span> <span class="hljs-keyword">if</span> self.isEmpty() <span class="hljs-keyword">else</span> self.head.val    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">Rear</span>(<span class="hljs-params">self</span>) -&gt; int:</span>        <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span> <span class="hljs-keyword">if</span> self.isEmpty() <span class="hljs-keyword">else</span> self.tail.val    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">isEmpty</span>(<span class="hljs-params">self</span>) -&gt; bool:</span>        <span class="hljs-keyword">return</span> self.count == <span class="hljs-number">0</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">isFull</span>(<span class="hljs-params">self</span>) -&gt; bool:</span>        <span class="hljs-keyword">return</span> self.count == self.capacity</code></pre><h6 id="641-è®¾è®¡å¾ªç¯åŒç«¯é˜Ÿåˆ—"><a href="#641-è®¾è®¡å¾ªç¯åŒç«¯é˜Ÿåˆ—" class="headerlink" title="641. è®¾è®¡å¾ªç¯åŒç«¯é˜Ÿåˆ—"></a><a href="https://leetcode-cn.com/problems/design-circular-deque/">641. è®¾è®¡å¾ªç¯åŒç«¯é˜Ÿåˆ—</a></h6><p>è®¾è®¡å®ç°åŒç«¯é˜Ÿåˆ—ã€‚<br>ä½ çš„å®ç°éœ€è¦æ”¯æŒä»¥ä¸‹æ“ä½œï¼š</p><ul><li><code>MyCircularDeque(k)</code>ï¼šæ„é€ å‡½æ•°,åŒç«¯é˜Ÿåˆ—çš„å¤§å°ä¸ºkã€‚</li><li><code>insertFront()</code>ï¼šå°†ä¸€ä¸ªå…ƒç´ æ·»åŠ åˆ°åŒç«¯é˜Ÿåˆ—å¤´éƒ¨ã€‚ å¦‚æœæ“ä½œæˆåŠŸè¿”å› trueã€‚</li><li><code>insertLast()</code>ï¼šå°†ä¸€ä¸ªå…ƒç´ æ·»åŠ åˆ°åŒç«¯é˜Ÿåˆ—å°¾éƒ¨ã€‚å¦‚æœæ“ä½œæˆåŠŸè¿”å› trueã€‚</li><li><code>deleteFront()</code>ï¼šä»åŒç«¯é˜Ÿåˆ—å¤´éƒ¨åˆ é™¤ä¸€ä¸ªå…ƒç´ ã€‚ å¦‚æœæ“ä½œæˆåŠŸè¿”å› trueã€‚</li><li><code>deleteLast()</code>ï¼šä»åŒç«¯é˜Ÿåˆ—å°¾éƒ¨åˆ é™¤ä¸€ä¸ªå…ƒç´ ã€‚å¦‚æœæ“ä½œæˆåŠŸè¿”å› trueã€‚</li><li><code>getFront()</code>ï¼šä»åŒç«¯é˜Ÿåˆ—å¤´éƒ¨è·å¾—ä¸€ä¸ªå…ƒç´ ã€‚å¦‚æœåŒç«¯é˜Ÿåˆ—ä¸ºç©ºï¼Œè¿”å› -1ã€‚</li><li><code>getRear()</code>ï¼šè·å¾—åŒç«¯é˜Ÿåˆ—çš„æœ€åä¸€ä¸ªå…ƒç´ ã€‚ å¦‚æœåŒç«¯é˜Ÿåˆ—ä¸ºç©ºï¼Œè¿”å› -1ã€‚</li><li><code>isEmpty()</code>ï¼šæ£€æŸ¥åŒç«¯é˜Ÿåˆ—æ˜¯å¦ä¸ºç©ºã€‚</li><li><code>isFull()</code>ï¼šæ£€æŸ¥åŒç«¯é˜Ÿåˆ—æ˜¯å¦æ»¡äº†ã€‚</li></ul><p><strong>ç¤ºä¾‹ï¼š</strong></p><pre><code class="hljs Java">MyCircularDeque circularDeque = <span class="hljs-keyword">new</span> MycircularDeque(<span class="hljs-number">3</span>); <span class="hljs-comment">// è®¾ç½®å®¹é‡å¤§å°ä¸º3</span>circularDeque.insertLast(<span class="hljs-number">1</span>);        <span class="hljs-comment">// è¿”å› true</span>circularDeque.insertLast(<span class="hljs-number">2</span>);        <span class="hljs-comment">// è¿”å› true</span>circularDeque.insertFront(<span class="hljs-number">3</span>);        <span class="hljs-comment">// è¿”å› true</span>circularDeque.insertFront(<span class="hljs-number">4</span>);        <span class="hljs-comment">// å·²ç»æ»¡äº†ï¼Œè¿”å› false</span>circularDeque.getRear();  <span class="hljs-comment">// è¿”å› 2</span>circularDeque.isFull();        <span class="hljs-comment">// è¿”å› true</span>circularDeque.deleteLast();        <span class="hljs-comment">// è¿”å› true</span>circularDeque.insertFront(<span class="hljs-number">4</span>);        <span class="hljs-comment">// è¿”å› true</span>circularDeque.getFront();<span class="hljs-comment">// è¿”å› 4</span></code></pre><p><strong>æç¤ºï¼š</strong></p><ul><li>æ‰€æœ‰å€¼çš„èŒƒå›´ä¸º [1, 1000]</li><li>æ“ä½œæ¬¡æ•°çš„èŒƒå›´ä¸º [1, 1000]</li><li>è¯·ä¸è¦ä½¿ç”¨å†…ç½®çš„åŒç«¯é˜Ÿåˆ—åº“ã€‚</li></ul><p>è§£é¢˜æ€è·¯</p><pre><code class="hljs plain"></code></pre><p><code>Java</code></p><pre><code class="hljs Java"><span class="hljs-keyword">package</span> com.weitrue.leetcode.editor.cn;<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DesignCircularDeque</span></span>&#123;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span></span>&#123;        MyCircularDeque s = <span class="hljs-keyword">new</span> DesignCircularDeque().<span class="hljs-function">new <span class="hljs-title">MyCircularDeque</span><span class="hljs-params">(<span class="hljs-number">3</span>)</span></span>;        s.insertLast(<span class="hljs-number">1</span>); <span class="hljs-comment">// return True</span>        s.insertLast(<span class="hljs-number">2</span>); <span class="hljs-comment">// return True</span>        s.insertLast(<span class="hljs-number">3</span>); <span class="hljs-comment">// return True</span>        s.insertLast(<span class="hljs-number">4</span>); <span class="hljs-comment">// return False</span>        s.getRear();     <span class="hljs-comment">// return 3</span>        s.isFull();   <span class="hljs-comment">// return True</span>        s.deleteLast();  <span class="hljs-comment">// return True</span>        s.insertFront(<span class="hljs-number">4</span>); <span class="hljs-comment">// return True</span>        s.getFront();     <span class="hljs-comment">// return 4</span>    &#125;        <span class="hljs-comment">//Design your implementation of the circular double-ended queue (deque). </span>    <span class="hljs-comment">// Your implementation should support following operations:</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// MyCircularDeque(k): Constructor, set the size of the deque to be k.</span>    <span class="hljs-comment">// insertFront(): Adds an item at the front of Deque. Return true if the operation is successful.</span>    <span class="hljs-comment">// insertLast(): Adds an item at the rear of Deque. Return true if the operationis successful.</span>    <span class="hljs-comment">// deleteFront(): Deletes an item from the front of Deque. Return true if the operation is successful.</span>    <span class="hljs-comment">// deleteLast(): Deletes an item from the rear of Deque. Return true if the operation is successful.</span>    <span class="hljs-comment">// getFront(): Gets the front item from the Deque. If the deque is empty, return-1.</span>    <span class="hljs-comment">// getRear(): Gets the last item from Deque. If the deque is empty, return -1.</span>    <span class="hljs-comment">// isEmpty(): Checks whether Deque is empty or not.</span>    <span class="hljs-comment">// isFull(): Checks whether Deque is full or not.</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Example:</span>    <span class="hljs-comment">//MyCircularDeque circularDeque = new MycircularDeque(3); // set the size to be</span>    <span class="hljs-comment">//3</span>    <span class="hljs-comment">//circularDeque.insertLast(1);// return true</span>    <span class="hljs-comment">//circularDeque.insertLast(2);// return true</span>    <span class="hljs-comment">//circularDeque.insertFront(3);// return true</span>    <span class="hljs-comment">//circularDeque.insertFront(4);// return false, the queue is full</span>    <span class="hljs-comment">//circularDeque.getRear();  // return 2</span>    <span class="hljs-comment">//circularDeque.isFull();// return true</span>    <span class="hljs-comment">//circularDeque.deleteLast();// return true</span>    <span class="hljs-comment">//circularDeque.insertFront(4);// return true</span>    <span class="hljs-comment">//circularDeque.getFront();// return 4</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Note:</span>    <span class="hljs-comment">// All values will be in the range of [0, 1000].</span>    <span class="hljs-comment">// The number of operations will be in the range of [1, 1000].</span>    <span class="hljs-comment">// Please do not use the built-in Deque library.</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Related Topics è®¾è®¡ é˜Ÿåˆ—</span>    <span class="hljs-comment">// ğŸ‘ 77 ğŸ‘ 0</span>     <span class="hljs-comment">//leetcode submit region begin(Prohibit modification and deletion)</span>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyCircularDeque</span> </span>&#123;        <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span>[] queue;        <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> capacity, front, rear, count;        <span class="hljs-comment">/** Initialize your data structure here. Set the size of the deque to be k. */</span>        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">MyCircularDeque</span><span class="hljs-params">(<span class="hljs-keyword">int</span> k)</span> </span>&#123;            queue = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[k];            capacity = k;            count = <span class="hljs-number">0</span>;            front = <span class="hljs-number">0</span>;            rear = <span class="hljs-number">0</span>;        &#125;        <span class="hljs-comment">/** Adds an item at the front of Deque. Return true if the operation is successful. */</span>        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">insertFront</span><span class="hljs-params">(<span class="hljs-keyword">int</span> value)</span> </span>&#123;            <span class="hljs-keyword">if</span> (isFull()) <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;            front = (front -<span class="hljs-number">1</span> + capacity) % capacity;            queue[front] = value;            count++;            <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;        &#125;        <span class="hljs-comment">/** Adds an item at the rear of Deque. Return true if the operation is successful. */</span>        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">insertLast</span><span class="hljs-params">(<span class="hljs-keyword">int</span> value)</span> </span>&#123;            <span class="hljs-keyword">if</span> (isFull()) <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;            queue[rear++] = value;            rear %= capacity;            count++;            <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;        &#125;        <span class="hljs-comment">/** Deletes an item from the front of Deque. Return true if the operation is successful. */</span>        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">deleteFront</span><span class="hljs-params">()</span> </span>&#123;            <span class="hljs-keyword">if</span> (isEmpty()) <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;            front = (front + <span class="hljs-number">1</span>) % capacity;            count--;            <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;        &#125;        <span class="hljs-comment">/** Deletes an item from the rear of Deque. Return true if the operation is successful. */</span>        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">deleteLast</span><span class="hljs-params">()</span> </span>&#123;            <span class="hljs-keyword">if</span> (isEmpty()) <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;            rear = (rear -<span class="hljs-number">1</span> + capacity) % capacity;            count--;            <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;        &#125;        <span class="hljs-comment">/** Get the front item from the deque. */</span>        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">getFront</span><span class="hljs-params">()</span> </span>&#123;            <span class="hljs-keyword">if</span> (isEmpty()) <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;            <span class="hljs-keyword">return</span> queue[front];        &#125;        <span class="hljs-comment">/** Get the last item from the deque. */</span>        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">getRear</span><span class="hljs-params">()</span> </span>&#123;            <span class="hljs-keyword">if</span> (isEmpty()) <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;            <span class="hljs-keyword">return</span> queue[(rear-<span class="hljs-number">1</span>+capacity)%capacity];        &#125;        <span class="hljs-comment">/** Checks whether the circular deque is empty or not. */</span>        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">isEmpty</span><span class="hljs-params">()</span> </span>&#123;            <span class="hljs-keyword">return</span> count == <span class="hljs-number">0</span>;        &#125;        <span class="hljs-comment">/** Checks whether the circular deque is full or not. */</span>        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">isFull</span><span class="hljs-params">()</span> </span>&#123;            <span class="hljs-keyword">return</span> count == capacity;        &#125;    &#125;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * Your MyCircularDeque object will be instantiated and called as such:</span><span class="hljs-comment">     * MyCircularDeque obj = new MyCircularDeque(k);</span><span class="hljs-comment">     * boolean param_1 = obj.insertFront(value);</span><span class="hljs-comment">     * boolean param_2 = obj.insertLast(value);</span><span class="hljs-comment">     * boolean param_3 = obj.deleteFront();</span><span class="hljs-comment">     * boolean param_4 = obj.deleteLast();</span><span class="hljs-comment">     * int param_5 = obj.getFront();</span><span class="hljs-comment">     * int param_6 = obj.getRear();</span><span class="hljs-comment">     * boolean param_7 = obj.isEmpty();</span><span class="hljs-comment">     * boolean param_8 = obj.isFull();</span><span class="hljs-comment">     */</span>    <span class="hljs-comment">//leetcode submit region end(Prohibit modification and deletion)</span>&#125;</code></pre><p><code>Golang</code></p><pre><code class="hljs Golang"><span class="hljs-keyword">type</span> MyCircularDeque <span class="hljs-keyword">struct</span> &#123;queue []<span class="hljs-keyword">int</span>front <span class="hljs-keyword">int</span>rear <span class="hljs-keyword">int</span>capacity <span class="hljs-keyword">int</span>count <span class="hljs-keyword">int</span>&#125;<span class="hljs-comment">/** Initialize your data structure here. Set the size of the deque to be k. */</span><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">Constructor</span><span class="hljs-params">(k <span class="hljs-keyword">int</span>)</span> <span class="hljs-title">MyCircularDeque</span></span> &#123;<span class="hljs-keyword">return</span> MyCircularDeque&#123;queue:    <span class="hljs-built_in">make</span>([]<span class="hljs-keyword">int</span>, k),capacity: k,&#125;&#125;<span class="hljs-comment">/** Adds an item at the front of Deque. Return true if the operation is successful. */</span><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(this *MyCircularDeque)</span> <span class="hljs-title">InsertFront</span><span class="hljs-params">(value <span class="hljs-keyword">int</span>)</span> <span class="hljs-title">bool</span></span> &#123;<span class="hljs-keyword">if</span> this.IsFull() &#123;<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>&#125;this.front = (this.front - <span class="hljs-number">1</span> + this.capacity) % this.capacitythis.queue[this.front] = valuethis.count += <span class="hljs-number">1</span><span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>&#125;<span class="hljs-comment">/** Adds an item at the rear of Deque. Return true if the operation is successful. */</span><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(this *MyCircularDeque)</span> <span class="hljs-title">InsertLast</span><span class="hljs-params">(value <span class="hljs-keyword">int</span>)</span> <span class="hljs-title">bool</span></span> &#123;<span class="hljs-keyword">if</span> this.IsFull() &#123;<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>&#125;this.queue[this.rear] = valuethis.rear = (this.rear +<span class="hljs-number">1</span>) % this.capacitythis.count += <span class="hljs-number">1</span><span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>&#125;<span class="hljs-comment">/** Deletes an item from the front of Deque. Return true if the operation is successful. */</span><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(this *MyCircularDeque)</span> <span class="hljs-title">DeleteFront</span><span class="hljs-params">()</span> <span class="hljs-title">bool</span></span> &#123;<span class="hljs-keyword">if</span> this.IsEmpty() &#123;<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>&#125;this.front = (this.front +<span class="hljs-number">1</span>) % this.capacitythis.count -= <span class="hljs-number">1</span><span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>&#125;<span class="hljs-comment">/** Deletes an item from the rear of Deque. Return true if the operation is successful. */</span><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(this *MyCircularDeque)</span> <span class="hljs-title">DeleteLast</span><span class="hljs-params">()</span> <span class="hljs-title">bool</span></span> &#123;<span class="hljs-keyword">if</span> this.IsEmpty() &#123;<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>&#125;this.rear = (this.rear - <span class="hljs-number">1</span> + this.capacity) % this.capacitythis.count -= <span class="hljs-number">1</span><span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>&#125;<span class="hljs-comment">/** Get the front item from the deque. */</span><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(this *MyCircularDeque)</span> <span class="hljs-title">GetFront</span><span class="hljs-params">()</span> <span class="hljs-title">int</span></span> &#123;<span class="hljs-keyword">if</span> this.IsEmpty() &#123;<span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>&#125;<span class="hljs-keyword">return</span> this.queue[this.front]&#125;<span class="hljs-comment">/** Get the last item from the deque. */</span><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(this *MyCircularDeque)</span> <span class="hljs-title">GetRear</span><span class="hljs-params">()</span> <span class="hljs-title">int</span></span> &#123;<span class="hljs-keyword">if</span> this.IsEmpty() &#123;<span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>&#125;<span class="hljs-keyword">return</span> this.queue[(this.rear<span class="hljs-number">-1</span>+this.capacity)%this.capacity]&#125;<span class="hljs-comment">/** Checks whether the circular deque is empty or not. */</span><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(this *MyCircularDeque)</span> <span class="hljs-title">IsEmpty</span><span class="hljs-params">()</span> <span class="hljs-title">bool</span></span> &#123;<span class="hljs-keyword">return</span> this.count == <span class="hljs-number">0</span>&#125;<span class="hljs-comment">/** Checks whether the circular deque is full or not. */</span><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(this *MyCircularDeque)</span> <span class="hljs-title">IsFull</span><span class="hljs-params">()</span> <span class="hljs-title">bool</span></span> &#123;<span class="hljs-keyword">return</span> this.count == this.capacity&#125;</code></pre><p><code>Python</code></p><pre><code class="hljs Python"><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">Module Description: 641-è®¾è®¡å¾ªç¯åŒç«¯é˜Ÿåˆ—</span><span class="hljs-string">Solutionï¼š</span><span class="hljs-string">Author: Wang P</span><span class="hljs-string">Problem:# è®¾è®¡å®ç°åŒç«¯é˜Ÿåˆ—ã€‚ </span><span class="hljs-string">        # ä½ çš„å®ç°éœ€è¦æ”¯æŒä»¥ä¸‹æ“ä½œï¼š</span><span class="hljs-string">        #  MyCircularDeque(k)ï¼šæ„é€ å‡½æ•°,åŒç«¯é˜Ÿåˆ—çš„å¤§å°ä¸ºkã€‚</span><span class="hljs-string">        #  insertFront()ï¼šå°†ä¸€ä¸ªå…ƒç´ æ·»åŠ åˆ°åŒç«¯é˜Ÿåˆ—å¤´éƒ¨ã€‚ å¦‚æœæ“ä½œæˆåŠŸè¿”å› trueã€‚</span><span class="hljs-string">        #  insertLast()ï¼šå°†ä¸€ä¸ªå…ƒç´ æ·»åŠ åˆ°åŒç«¯é˜Ÿåˆ—å°¾éƒ¨ã€‚å¦‚æœæ“ä½œæˆåŠŸè¿”å› trueã€‚</span><span class="hljs-string">        #  deleteFront()ï¼šä»åŒç«¯é˜Ÿåˆ—å¤´éƒ¨åˆ é™¤ä¸€ä¸ªå…ƒç´ ã€‚ å¦‚æœæ“ä½œæˆåŠŸè¿”å› trueã€‚</span><span class="hljs-string">        #  deleteLast()ï¼šä»åŒç«¯é˜Ÿåˆ—å°¾éƒ¨åˆ é™¤ä¸€ä¸ªå…ƒç´ ã€‚å¦‚æœæ“ä½œæˆåŠŸè¿”å› trueã€‚</span><span class="hljs-string">        #  getFront()ï¼šä»åŒç«¯é˜Ÿåˆ—å¤´éƒ¨è·å¾—ä¸€ä¸ªå…ƒç´ ã€‚å¦‚æœåŒç«¯é˜Ÿåˆ—ä¸ºç©ºï¼Œè¿”å› -1ã€‚</span><span class="hljs-string">        #  getRear()ï¼šè·å¾—åŒç«¯é˜Ÿåˆ—çš„æœ€åä¸€ä¸ªå…ƒç´ ã€‚ å¦‚æœåŒç«¯é˜Ÿåˆ—ä¸ºç©ºï¼Œè¿”å› -1ã€‚</span><span class="hljs-string">        #  isEmpty()ï¼šæ£€æŸ¥åŒç«¯é˜Ÿåˆ—æ˜¯å¦ä¸ºç©ºã€‚</span><span class="hljs-string">        #  isFull()ï¼šæ£€æŸ¥åŒç«¯é˜Ÿåˆ—æ˜¯å¦æ»¡äº†ã€‚</span><span class="hljs-string">        #  ç¤ºä¾‹ï¼š</span><span class="hljs-string">        #  MyCircularDeque circularDeque = new MycircularDeque(3); // è®¾ç½®å®¹é‡å¤§å°ä¸º3</span><span class="hljs-string">        # circularDeque.insertLast(1);        // è¿”å› true</span><span class="hljs-string">        # circularDeque.insertLast(2);        // è¿”å› true</span><span class="hljs-string">        # circularDeque.insertFront(3);        // è¿”å› true</span><span class="hljs-string">        # circularDeque.insertFront(4);        // å·²ç»æ»¡äº†ï¼Œè¿”å› false</span><span class="hljs-string">        # circularDeque.getRear();          // è¿”å› 2</span><span class="hljs-string">        # circularDeque.isFull();            // è¿”å› true</span><span class="hljs-string">        # circularDeque.deleteLast();          // è¿”å› true</span><span class="hljs-string">        # circularDeque.insertFront(4);        // è¿”å› true</span><span class="hljs-string">        # circularDeque.getFront();          // è¿”å› 4</span><span class="hljs-string">        # Â </span><span class="hljs-string">        #  æç¤ºï¼š</span><span class="hljs-string">        #  æ‰€æœ‰å€¼çš„èŒƒå›´ä¸º [1, 1000]</span><span class="hljs-string">        #  æ“ä½œæ¬¡æ•°çš„èŒƒå›´ä¸º [1, 1000]</span><span class="hljs-string">        #  è¯·ä¸è¦ä½¿ç”¨å†…ç½®çš„åŒç«¯é˜Ÿåˆ—åº“ã€‚</span><span class="hljs-string">        #</span><span class="hljs-string">        #  Related Topics è®¾è®¡ é˜Ÿåˆ—</span><span class="hljs-string">        #  ğŸ‘ 77 ğŸ‘ 0</span><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-comment"># leetcode submit region begin(Prohibit modification and deletion)</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyCircularDeque</span>:</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, k: <span class="hljs-built_in">int</span></span>):</span>        <span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">        Initialize your data structure here. Set the size of the deque to be k.</span><span class="hljs-string">        &quot;&quot;&quot;</span>        self.queue = []        self.capacity = k        self.count = <span class="hljs-number">0</span>        self.front = <span class="hljs-number">0</span>        self.rear = <span class="hljs-number">0</span>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, k):            self.queue.append(<span class="hljs-number">-1</span>)    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">insertFront</span>(<span class="hljs-params">self, value: <span class="hljs-built_in">int</span></span>) -&gt; bool:</span>        <span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">        Adds an item at the front of Deque. Return true if the operation is successful.</span><span class="hljs-string">        &quot;&quot;&quot;</span>        <span class="hljs-keyword">if</span> self.isFull():            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>        self.front = (self.front - <span class="hljs-number">1</span> + self.capacity) % self.capacity        self.queue[self.front] = value        self.count += <span class="hljs-number">1</span>        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">insertLast</span>(<span class="hljs-params">self, value: <span class="hljs-built_in">int</span></span>) -&gt; bool:</span>        <span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">        Adds an item at the rear of Deque. Return true if the operation is successful.</span><span class="hljs-string">        &quot;&quot;&quot;</span>        <span class="hljs-keyword">if</span> self.isFull():            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>        self.queue[self.rear] = value        self.rear = (self.rear + <span class="hljs-number">1</span>) % self.capacity        self.count += <span class="hljs-number">1</span>        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">deleteFront</span>(<span class="hljs-params">self</span>) -&gt; bool:</span>        <span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">        Deletes an item from the front of Deque. Return true if the operation is successful.</span><span class="hljs-string">        &quot;&quot;&quot;</span>        <span class="hljs-keyword">if</span> self.isEmpty():            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>        self.front = (self.front + <span class="hljs-number">1</span>) % self.capacity        self.count -= <span class="hljs-number">1</span>        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">deleteLast</span>(<span class="hljs-params">self</span>) -&gt; bool:</span>        <span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">        Deletes an item from the rear of Deque. Return true if the operation is successful.</span><span class="hljs-string">        &quot;&quot;&quot;</span>        <span class="hljs-keyword">if</span> self.isEmpty():            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>        self.rear = (self.rear - <span class="hljs-number">1</span> + self.capacity) % self.capacity        self.count -= <span class="hljs-number">1</span>        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getFront</span>(<span class="hljs-params">self</span>) -&gt; int:</span>        <span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">        Get the front item from the deque.</span><span class="hljs-string">        &quot;&quot;&quot;</span>        <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span> <span class="hljs-keyword">if</span> self.isEmpty() <span class="hljs-keyword">else</span> self.queue[self.front]    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getRear</span>(<span class="hljs-params">self</span>) -&gt; int:</span>        <span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">        Get the last item from the deque.</span><span class="hljs-string">        &quot;&quot;&quot;</span>        <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span> <span class="hljs-keyword">if</span> self.isEmpty() <span class="hljs-keyword">else</span> self.queue[(self.rear - <span class="hljs-number">1</span> + self.capacity) % self.capacity]    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">isEmpty</span>(<span class="hljs-params">self</span>) -&gt; bool:</span>        <span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">        Checks whether the circular deque is empty or not.</span><span class="hljs-string">        &quot;&quot;&quot;</span>        <span class="hljs-keyword">return</span> self.count == <span class="hljs-number">0</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">isFull</span>(<span class="hljs-params">self</span>) -&gt; bool:</span>        <span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">        Checks whether the circular deque is full or not.</span><span class="hljs-string">        &quot;&quot;&quot;</span>        <span class="hljs-keyword">return</span> self.count == self.capacity    <span class="hljs-comment"># Your MyCircularDeque object will be instantiated and called as such:</span>    <span class="hljs-comment"># obj = MyCircularDeque(k)</span>    <span class="hljs-comment"># param_1 = obj.insertFront(value)</span>    <span class="hljs-comment"># param_2 = obj.insertLast(value)</span>    <span class="hljs-comment"># param_3 = obj.deleteFront()</span>    <span class="hljs-comment"># param_4 = obj.deleteLast()</span>    <span class="hljs-comment"># param_5 = obj.getFront()</span>    <span class="hljs-comment"># param_6 = obj.getRear()</span>    <span class="hljs-comment"># param_7 = obj.isEmpty()</span>    <span class="hljs-comment"># param_8 = obj.isFull()</span>    <span class="hljs-comment"># leetcode submit region end(Prohibit modification and deletion)</span></code></pre><h6 id="1670-è®¾è®¡å‰ä¸­åé˜Ÿåˆ—"><a href="#1670-è®¾è®¡å‰ä¸­åé˜Ÿåˆ—" class="headerlink" title="1670. è®¾è®¡å‰ä¸­åé˜Ÿåˆ—"></a><a href="https://leetcode-cn.com/problems/design-front-middle-back-queue/">1670. è®¾è®¡å‰ä¸­åé˜Ÿåˆ—</a></h6><p>è¯·ä½ è®¾è®¡ä¸€ä¸ªé˜Ÿåˆ—ï¼Œæ”¯æŒåœ¨å‰ï¼Œä¸­ï¼Œåä¸‰ä¸ªä½ç½®çš„ <code>push</code> å’Œ <code>pop</code> æ“ä½œã€‚</p><p>è¯·ä½ å®Œæˆ <code>FrontMiddleBack</code> ç±»ï¼š</p><ul><li><code>FrontMiddleBack()</code> åˆå§‹åŒ–é˜Ÿåˆ—ã€‚</li><li><code>void pushFront(int val) </code>å°†<code>val</code>æ·»åŠ åˆ°é˜Ÿåˆ—çš„<strong>æœ€å‰é¢</strong>ã€‚</li><li><code>void pushMiddle(int val) </code>å°†<code>val</code>æ·»åŠ åˆ°é˜Ÿåˆ—çš„<strong>æ­£ä¸­é—´</strong>ã€‚</li><li><code>void pushBack(int val) </code>å°†<code>val</code>æ·»åŠ åˆ°é˜Ÿé‡Œçš„<strong>æœ€åé¢</strong>ã€‚</li><li><code>int popFront() </code>å°†<strong>æœ€å‰é¢</strong>çš„å…ƒç´ ä»é˜Ÿåˆ—ä¸­åˆ é™¤å¹¶è¿”å›å€¼ï¼Œå¦‚æœåˆ é™¤ä¹‹å‰é˜Ÿåˆ—ä¸ºç©ºï¼Œé‚£ä¹ˆè¿”å› -1 ã€‚</li><li><code>int popMiddle() </code>å°†<strong>æ­£ä¸­é—´</strong>çš„å…ƒç´ ä»é˜Ÿåˆ—ä¸­åˆ é™¤å¹¶è¿”å›å€¼ï¼Œå¦‚æœåˆ é™¤ä¹‹å‰é˜Ÿåˆ—ä¸ºç©ºï¼Œé‚£ä¹ˆè¿”å› -1 ã€‚</li><li><code>int popBack() </code>å°†<strong>æœ€åé¢</strong>çš„å…ƒç´ ä»é˜Ÿåˆ—ä¸­åˆ é™¤å¹¶è¿”å›å€¼ï¼Œå¦‚æœåˆ é™¤ä¹‹å‰é˜Ÿåˆ—ä¸ºç©ºï¼Œé‚£ä¹ˆè¿”å› -1 ã€‚</li></ul><p>è¯·æ³¨æ„å½“æœ‰<strong>ä¸¤ä¸ª</strong>ä¸­é—´ä½ç½®çš„æ—¶å€™ï¼Œé€‰æ‹©é å‰é¢çš„ä½ç½®è¿›è¡Œæ“ä½œã€‚æ¯”æ–¹è¯´ï¼š</p><p>å°† 6 æ·»åŠ åˆ° <code>[1, 2, 3, 4, 5] </code>çš„ä¸­é—´ä½ç½®ï¼Œç»“æœæ•°ç»„ä¸º<code>[1, 2, 6, 3, 4, 5]</code>ã€‚<br>ä» <code>[1, 2, 3, 4, 5, 6] </code>çš„ä¸­é—´ä½ç½®å¼¹å‡ºå…ƒç´ ï¼Œè¿”å›<code>3</code>ï¼Œæ•°ç»„å˜ä¸º<code>[1, 2, 4, 5, 6]</code>ã€‚</p><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><pre><code class="hljs Java">è¾“å…¥ï¼š[<span class="hljs-string">&quot;FrontMiddleBackQueue&quot;</span>, <span class="hljs-string">&quot;pushFront&quot;</span>, <span class="hljs-string">&quot;pushBack&quot;</span>, <span class="hljs-string">&quot;pushMiddle&quot;</span>, <span class="hljs-string">&quot;pushMiddle&quot;</span>, <span class="hljs-string">&quot;popFront&quot;</span>, <span class="hljs-string">&quot;popMiddle&quot;</span>, <span class="hljs-string">&quot;popMiddle&quot;</span>, <span class="hljs-string">&quot;popBack&quot;</span>, <span class="hljs-string">&quot;popFront&quot;</span>][[], [<span class="hljs-number">1</span>], [<span class="hljs-number">2</span>], [<span class="hljs-number">3</span>], [<span class="hljs-number">4</span>], [], [], [], [], []]è¾“å‡ºï¼š[<span class="hljs-keyword">null</span>, <span class="hljs-keyword">null</span>, <span class="hljs-keyword">null</span>, <span class="hljs-keyword">null</span>, <span class="hljs-keyword">null</span>, <span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">2</span>, -<span class="hljs-number">1</span>]è§£é‡Šï¼šFrontMiddleBackQueue q = <span class="hljs-keyword">new</span> FrontMiddleBackQueue();q.pushFront(<span class="hljs-number">1</span>);   <span class="hljs-comment">// [1]</span>q.pushBack(<span class="hljs-number">2</span>);    <span class="hljs-comment">// [1, 2]</span>q.pushMiddle(<span class="hljs-number">3</span>);  <span class="hljs-comment">// [1, 3, 2]</span>q.pushMiddle(<span class="hljs-number">4</span>);  <span class="hljs-comment">// [1, 4, 3, 2]</span>q.popFront();     <span class="hljs-comment">// è¿”å› 1 -&gt; [4, 3, 2]</span>q.popMiddle();    <span class="hljs-comment">// è¿”å› 3 -&gt; [4, 2]</span>q.popMiddle();    <span class="hljs-comment">// è¿”å› 4 -&gt; [2]</span>q.popBack();      <span class="hljs-comment">// è¿”å› 2 -&gt; []</span>q.popFront();     <span class="hljs-comment">// è¿”å› -1 -&gt; [] ï¼ˆé˜Ÿåˆ—ä¸ºç©ºï¼‰</span></code></pre><p><strong>æç¤ºï¼š</strong></p><ul><li><code>1 &lt;= val &lt;= 109</code></li><li>æœ€å¤šè°ƒç”¨ 1000 æ¬¡ <code>pushFront</code>ï¼Œ <code>pushMiddle</code>ï¼Œ <code>pushBack</code>ï¼Œ <code>popFront</code>ï¼Œ <code>popMiddle</code> å’Œ <code>popBack </code>ã€‚</li></ul><p>è§£é¢˜æ€è·¯</p><pre><code class="hljs plain">ä¸¤ä¸ªåŒç«¯é˜Ÿåˆ—</code></pre><p><code>Java</code></p><pre><code class="hljs Java"><span class="hljs-keyword">package</span> com.weitrue.leetcode.editor.cn;<span class="hljs-keyword">import</span> java.util.Deque;<span class="hljs-keyword">import</span> java.util.LinkedList;<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DesignFrontMiddleBackQueue</span></span>&#123;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span></span>&#123;        FrontMiddleBackQueue s = <span class="hljs-keyword">new</span> DesignFrontMiddleBackQueue().<span class="hljs-function">new <span class="hljs-title">FrontMiddleBackQueue</span><span class="hljs-params">()</span></span>;    &#125;        <span class="hljs-comment">//Design a queue that supports push and pop operations in the front, middle, and back.</span>    <span class="hljs-comment">// Implement the FrontMiddleBack class:</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// FrontMiddleBack() Initializes the queue.</span>    <span class="hljs-comment">// void pushFront(int val) Adds val to the front of the queue.</span>    <span class="hljs-comment">// void pushMiddle(int val) Adds val to the middle of the queue.</span>    <span class="hljs-comment">// void pushBack(int val) Adds val to the back of the queue.</span>    <span class="hljs-comment">// int popFront() Removes the front element of the queue and returns it. If the queue is empty, return -1.</span>    <span class="hljs-comment">// int popMiddle() Removes the middle element of the queue and returns it. If the queue is empty, return -1.</span>    <span class="hljs-comment">// int popBack() Removes the back element of the queue and returns it. If the queue is empty, return -1.</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Notice that when there are two middle position choices, the operation is performed on the frontmost middle position choice. For example:</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Pushing 6 into the middle of [1, 2, 3, 4, 5] results in [1, 2, 6, 3, 4, 5].</span>    <span class="hljs-comment">// Popping the middle from [1, 2, 3, 4, 5, 6] returns 3 and results in [1, 2, 4, 5, 6].</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Example 1:</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">//Input:</span>    <span class="hljs-comment">//[&quot;FrontMiddleBackQueue&quot;, &quot;pushFront&quot;, &quot;pushBack&quot;, &quot;pushMiddle&quot;, &quot;pushMiddle&quot;,</span>    <span class="hljs-comment">//&quot;popFront&quot;, &quot;popMiddle&quot;, &quot;popMiddle&quot;, &quot;popBack&quot;, &quot;popFront&quot;]</span>    <span class="hljs-comment">//[[], [1], [2], [3], [4], [], [], [], [], []]</span>    <span class="hljs-comment">//Output:</span>    <span class="hljs-comment">//[null, null, null, null, null, 1, 3, 4, 2, -1]</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">//Explanation:</span>    <span class="hljs-comment">//FrontMiddleBackQueue q = new FrontMiddleBackQueue();</span>    <span class="hljs-comment">//q.pushFront(1);   // [1]</span>    <span class="hljs-comment">//q.pushBack(2);    // [1, 2]</span>    <span class="hljs-comment">//q.pushMiddle(3);  // [1, 3, 2]</span>    <span class="hljs-comment">//q.pushMiddle(4);  // [1, 4, 3, 2]</span>    <span class="hljs-comment">//q.popFront();     // return 1 -&gt; [4, 3, 2]</span>    <span class="hljs-comment">//q.popMiddle();    // return 3 -&gt; [4, 2]</span>    <span class="hljs-comment">//q.popMiddle();    // return 4 -&gt; [2]</span>    <span class="hljs-comment">//q.popBack();      // return 2 -&gt; []</span>    <span class="hljs-comment">//q.popFront();     // return -1 -&gt; [] (The queue is empty)</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Constraints:</span>    <span class="hljs-comment">// 1 &lt;= val &lt;= 109</span>    <span class="hljs-comment">// At most 1000 calls will be made to pushFront, pushMiddle, pushBack, popFront,</span>    <span class="hljs-comment">// popMiddle, and popBack.</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Related Topics è®¾è®¡ é“¾è¡¨</span>    <span class="hljs-comment">// ğŸ‘ 6 ğŸ‘ 0</span>     <span class="hljs-comment">//leetcode submit region begin(Prohibit modification and deletion)</span>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FrontMiddleBackQueue</span> </span>&#123;        <span class="hljs-keyword">private</span> Deque&lt;Integer&gt; left;        <span class="hljs-keyword">private</span> Deque&lt;Integer&gt; right;        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">FrontMiddleBackQueue</span><span class="hljs-params">()</span> </span>&#123;            left = <span class="hljs-keyword">new</span> LinkedList&lt;&gt;();            right = <span class="hljs-keyword">new</span> LinkedList&lt;&gt;();        &#125;        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">pushFront</span><span class="hljs-params">(<span class="hljs-keyword">int</span> val)</span> </span>&#123;            left.addFirst(val);            balanceQueue();        &#125;        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">pushMiddle</span><span class="hljs-params">(<span class="hljs-keyword">int</span> val)</span> </span>&#123;            <span class="hljs-keyword">if</span> (left.size() &gt; right.size()) &#123;                right.addFirst(left.pollLast());            &#125;            left.addLast(val);        &#125;        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">pushBack</span><span class="hljs-params">(<span class="hljs-keyword">int</span> val)</span> </span>&#123;            right.addLast(val);            balanceQueue();        &#125;        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">popFront</span><span class="hljs-params">()</span> </span>&#123;            <span class="hljs-keyword">if</span> (left.size() + right.size() == <span class="hljs-number">0</span>) &#123;                <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;            &#125;            Integer v;            <span class="hljs-keyword">if</span> (left.size() == <span class="hljs-number">0</span>) &#123;                v = right.pollFirst();            &#125;<span class="hljs-keyword">else</span> &#123;                v= left.pollFirst();            &#125;            balanceQueue();            <span class="hljs-keyword">return</span> v == <span class="hljs-keyword">null</span> ? -<span class="hljs-number">1</span>: v;        &#125;        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">popMiddle</span><span class="hljs-params">()</span> </span>&#123;            <span class="hljs-keyword">if</span> (left.size() + right.size() == <span class="hljs-number">0</span>) &#123;                <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;            &#125;            Integer v = left.pollLast();            balanceQueue();            <span class="hljs-keyword">return</span> v == <span class="hljs-keyword">null</span> ? -<span class="hljs-number">1</span>: v;        &#125;        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">popBack</span><span class="hljs-params">()</span> </span>&#123;            <span class="hljs-keyword">if</span> (left.size() + right.size() == <span class="hljs-number">0</span>) &#123;                <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;            &#125;            Integer v;            <span class="hljs-keyword">if</span> (right.size() == <span class="hljs-number">0</span>) &#123;                v = left.pollLast();            &#125; <span class="hljs-keyword">else</span> &#123;                v = right.pollLast();            &#125;            balanceQueue();            <span class="hljs-keyword">return</span> v == <span class="hljs-keyword">null</span> ? -<span class="hljs-number">1</span>: v;        &#125;        <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">balanceQueue</span><span class="hljs-params">()</span> </span>&#123;            <span class="hljs-keyword">if</span> (left.size() - right.size() &gt;=<span class="hljs-number">2</span>) &#123;                right.addFirst(left.pollLast());            &#125;            <span class="hljs-keyword">if</span> (left.size() &lt; right.size()) &#123;                left.addLast(right.pollFirst());            &#125;        &#125;    &#125;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * Your FrontMiddleBackQueue object will be instantiated and called as such:</span><span class="hljs-comment">     * FrontMiddleBackQueue obj = new FrontMiddleBackQueue();</span><span class="hljs-comment">     * obj.pushFront(val);</span><span class="hljs-comment">     * obj.pushMiddle(val);</span><span class="hljs-comment">     * obj.pushBack(val);</span><span class="hljs-comment">     * int param_4 = obj.popFront();</span><span class="hljs-comment">     * int param_5 = obj.popMiddle();</span><span class="hljs-comment">     * int param_6 = obj.popBack();</span><span class="hljs-comment">     */</span>    <span class="hljs-comment">//leetcode submit region end(Prohibit modification and deletion)</span>&#125;</code></pre><p><code>Golang</code></p><pre><code class="hljs Golang"><span class="hljs-keyword">package</span> leetcode<span class="hljs-comment">//leetcode submit region begin(Prohibit modification and deletion)</span><span class="hljs-comment">// åŒå‘é“¾è¡¨åˆ†è£…</span><span class="hljs-keyword">type</span> DNode <span class="hljs-keyword">struct</span> &#123;val <span class="hljs-keyword">int</span>pre *DNodenext *DNode&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(d *DNode)</span> <span class="hljs-title">insertPre</span><span class="hljs-params">(value <span class="hljs-keyword">int</span>)</span></span> &#123;node := &amp;DNode&#123;val: value,pre:d.pre,next: d,&#125;<span class="hljs-keyword">if</span> d.pre != <span class="hljs-literal">nil</span> &#123;d.pre.next = node&#125;d.pre = node&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(d *DNode)</span> <span class="hljs-title">insertNext</span><span class="hljs-params">(value <span class="hljs-keyword">int</span>)</span></span> &#123;node := &amp;DNode&#123;val:  value,pre:  d,next: d.next,&#125;<span class="hljs-keyword">if</span> d.next != <span class="hljs-literal">nil</span> &#123;d.next.pre = node&#125;d.next = node&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(d *DNode)</span> <span class="hljs-title">deletePre</span><span class="hljs-params">()</span></span> &#123;<span class="hljs-keyword">if</span> d.pre == <span class="hljs-literal">nil</span> &#123;<span class="hljs-keyword">return</span>&#125;d.pre = d.pre.pre<span class="hljs-keyword">if</span> d.pre != <span class="hljs-literal">nil</span> &#123;d.pre.next = d&#125;&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(d *DNode)</span> <span class="hljs-title">deleteNext</span><span class="hljs-params">()</span></span>  &#123;<span class="hljs-keyword">if</span> d.next == <span class="hljs-literal">nil</span> &#123;<span class="hljs-keyword">return</span>&#125;d.next = d.next.next<span class="hljs-keyword">if</span> d.next != <span class="hljs-literal">nil</span> &#123;d.next.pre = d&#125;&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(d *DNode)</span> <span class="hljs-title">printNode</span><span class="hljs-params">()</span></span>  &#123;h := d<span class="hljs-keyword">for</span> h != <span class="hljs-literal">nil</span> &#123;fmt.Print(h.val, <span class="hljs-string">&quot;-&gt;&quot;</span>)h = h.next&#125;&#125;<span class="hljs-keyword">type</span> CircularDeque <span class="hljs-keyword">struct</span> &#123;front *DNoderear *DNodecount <span class="hljs-keyword">int</span>&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">NewCircularDeque</span><span class="hljs-params">()</span> <span class="hljs-title">CircularDeque</span></span> &#123;<span class="hljs-keyword">return</span> CircularDeque&#123;front:<span class="hljs-literal">nil</span>,rear:<span class="hljs-literal">nil</span>,&#125;&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(c *CircularDeque)</span><span class="hljs-title">pushPre</span><span class="hljs-params">(value <span class="hljs-keyword">int</span>)</span> <span class="hljs-title">bool</span></span> &#123;<span class="hljs-keyword">if</span> c.count == <span class="hljs-number">0</span> &#123;node := &amp;DNode&#123;val:  value,&#125;c.front = nodec.rear = node&#125; <span class="hljs-keyword">else</span> &#123;c.front.insertPre(value)c.front = c.front.pre&#125;c.count += <span class="hljs-number">1</span><span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(c *CircularDeque)</span><span class="hljs-title">pushTail</span><span class="hljs-params">(value <span class="hljs-keyword">int</span>)</span> <span class="hljs-title">bool</span></span> &#123;<span class="hljs-keyword">if</span> c.count == <span class="hljs-number">0</span> &#123;node := &amp;DNode&#123;val:  value,&#125;c.front = nodec.rear = node&#125; <span class="hljs-keyword">else</span> &#123;c.rear.insertNext(value)c.rear = c.rear.next&#125;c.count += <span class="hljs-number">1</span><span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(c *CircularDeque)</span><span class="hljs-title">popFront</span><span class="hljs-params">()</span> <span class="hljs-title">int</span></span> &#123;<span class="hljs-keyword">if</span> c.isEmpty() &#123;<span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>&#125;v := c.front.val<span class="hljs-keyword">if</span> c.count == <span class="hljs-number">1</span> &#123;c.front = <span class="hljs-literal">nil</span>c.rear = <span class="hljs-literal">nil</span>&#125;<span class="hljs-keyword">else</span>&#123;c.front = c.front.nextc.front.deletePre()&#125;c.count -= <span class="hljs-number">1</span><span class="hljs-keyword">return</span> v&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(c *CircularDeque)</span><span class="hljs-title">popTail</span><span class="hljs-params">()</span> <span class="hljs-title">int</span></span> &#123;<span class="hljs-keyword">if</span> c.isEmpty() &#123;<span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>&#125;v := c.rear.val<span class="hljs-keyword">if</span> c.count == <span class="hljs-number">1</span> &#123;c.front = <span class="hljs-literal">nil</span>c.rear = <span class="hljs-literal">nil</span>&#125;<span class="hljs-keyword">else</span>&#123;c.rear = c.rear.prec.rear.deleteNext()&#125;c.count -= <span class="hljs-number">1</span><span class="hljs-keyword">return</span> v&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(c *CircularDeque)</span><span class="hljs-title">isEmpty</span><span class="hljs-params">()</span> <span class="hljs-title">bool</span></span> &#123;<span class="hljs-keyword">return</span> c.count == <span class="hljs-number">0</span>&#125;<span class="hljs-keyword">type</span> FrontMiddleBackQueue <span class="hljs-keyword">struct</span> &#123;lQueue CircularDequerQueue CircularDeque&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">Constructor</span><span class="hljs-params">()</span> <span class="hljs-title">FrontMiddleBackQueue</span></span> &#123;<span class="hljs-keyword">return</span> FrontMiddleBackQueue&#123;lQueue: NewCircularDeque(),rQueue: NewCircularDeque(),&#125;&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(this *FrontMiddleBackQueue)</span> <span class="hljs-title">PushFront</span><span class="hljs-params">(val <span class="hljs-keyword">int</span>)</span></span>  &#123;this.lQueue.pushPre(val)this.formatQueue()&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(this *FrontMiddleBackQueue)</span> <span class="hljs-title">PushMiddle</span><span class="hljs-params">(val <span class="hljs-keyword">int</span>)</span></span>  &#123;<span class="hljs-comment">// æ’å…¥ä¸­é—´éœ€è¦å…ˆå¹³è¡¡</span>  <span class="hljs-keyword">if</span> this.lQueue.count &gt; this.rQueue.count &#123;this.rQueue.pushPre(this.lQueue.popTail())&#125;this.lQueue.pushTail(val)&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(this *FrontMiddleBackQueue)</span> <span class="hljs-title">PushBack</span><span class="hljs-params">(val <span class="hljs-keyword">int</span>)</span></span>  &#123;this.rQueue.pushTail(val)this.formatQueue()&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(this *FrontMiddleBackQueue)</span> <span class="hljs-title">PopFront</span><span class="hljs-params">()</span> <span class="hljs-title">int</span></span> &#123;v := <span class="hljs-number">-1</span><span class="hljs-keyword">if</span> this.isEmpty() &#123;<span class="hljs-keyword">return</span> v&#125;<span class="hljs-keyword">if</span> this.lQueue.count == <span class="hljs-number">0</span> &#123;v = this.rQueue.popFront()&#125; <span class="hljs-keyword">else</span> &#123;v = this.lQueue.popFront()&#125;this.formatQueue()<span class="hljs-keyword">return</span> v&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(this *FrontMiddleBackQueue)</span> <span class="hljs-title">PopMiddle</span><span class="hljs-params">()</span> <span class="hljs-title">int</span></span> &#123;v := <span class="hljs-number">-1</span><span class="hljs-keyword">if</span> this.isEmpty() &#123;<span class="hljs-keyword">return</span> v&#125;v = this.lQueue.popTail()this.formatQueue()<span class="hljs-keyword">return</span> v&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(this *FrontMiddleBackQueue)</span> <span class="hljs-title">PopBack</span><span class="hljs-params">()</span> <span class="hljs-title">int</span></span> &#123;v := <span class="hljs-number">-1</span><span class="hljs-keyword">if</span> this.isEmpty() &#123;<span class="hljs-keyword">return</span> v&#125;<span class="hljs-keyword">if</span> this.rQueue.count == <span class="hljs-number">0</span> &#123;v = this.lQueue.popTail()&#125; <span class="hljs-keyword">else</span> &#123;v = this.rQueue.popTail()&#125;this.formatQueue()<span class="hljs-keyword">return</span> v&#125;<span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(this *FrontMiddleBackQueue)</span> <span class="hljs-title">isEmpty</span> <span class="hljs-params">()</span> <span class="hljs-title">bool</span></span> &#123;<span class="hljs-keyword">return</span> this.lQueue.count + this.rQueue.count == <span class="hljs-number">0</span>&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(this *FrontMiddleBackQueue)</span> <span class="hljs-title">formatQueue</span><span class="hljs-params">()</span></span> &#123;<span class="hljs-keyword">if</span> this.lQueue.count &lt; this.rQueue.count &#123;this.lQueue.pushTail(this.rQueue.popFront())&#125;<span class="hljs-keyword">if</span> this.lQueue.count - this.rQueue.count &gt;= <span class="hljs-number">2</span> &#123;this.rQueue.pushPre(this.lQueue.popTail())&#125;&#125;<span class="hljs-comment">/**</span><span class="hljs-comment"> * Your FrontMiddleBackQueue object will be instantiated and called as such:</span><span class="hljs-comment"> * obj := Constructor();</span><span class="hljs-comment"> * obj.PushFront(val);</span><span class="hljs-comment"> * obj.PushMiddle(val);</span><span class="hljs-comment"> * obj.PushBack(val);</span><span class="hljs-comment"> * param_4 := obj.PopFront();</span><span class="hljs-comment"> * param_5 := obj.PopMiddle();</span><span class="hljs-comment"> * param_6 := obj.PopBack();</span><span class="hljs-comment"> */</span><span class="hljs-comment">//leetcode submit region end(Prohibit modification and deletion)</span></code></pre><p><code>Python</code></p><pre><code class="hljs Python"><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">Module Description: 1670-è®¾è®¡å‰ä¸­åé˜Ÿåˆ—</span><span class="hljs-string">Solutionï¼š</span><span class="hljs-string">Author: Wang P</span><span class="hljs-string">Problem:# è¯·ä½ è®¾è®¡ä¸€ä¸ªé˜Ÿåˆ—ï¼Œæ”¯æŒåœ¨å‰ï¼Œä¸­ï¼Œåä¸‰ä¸ªä½ç½®çš„ push å’Œ pop æ“ä½œã€‚ </span><span class="hljs-string">        #  è¯·ä½ å®Œæˆ FrontMiddleBack ç±»ï¼š</span><span class="hljs-string">        #  FrontMiddleBack() åˆå§‹åŒ–é˜Ÿåˆ—ã€‚</span><span class="hljs-string">        #  void pushFront(int val) å°† val æ·»åŠ åˆ°é˜Ÿåˆ—çš„ æœ€å‰é¢ ã€‚</span><span class="hljs-string">        #  void pushMiddle(int val) å°† val æ·»åŠ åˆ°é˜Ÿåˆ—çš„ æ­£ä¸­é—´ ã€‚</span><span class="hljs-string">        #  void pushBack(int val) å°† val æ·»åŠ åˆ°é˜Ÿé‡Œçš„ æœ€åé¢ ã€‚</span><span class="hljs-string">        #  int popFront() å°† æœ€å‰é¢ çš„å…ƒç´ ä»é˜Ÿåˆ—ä¸­åˆ é™¤å¹¶è¿”å›å€¼ï¼Œå¦‚æœåˆ é™¤ä¹‹å‰é˜Ÿåˆ—ä¸ºç©ºï¼Œé‚£ä¹ˆè¿”å› -1 ã€‚</span><span class="hljs-string">        #  int popMiddle() å°† æ­£ä¸­é—´ çš„å…ƒç´ ä»é˜Ÿåˆ—ä¸­åˆ é™¤å¹¶è¿”å›å€¼ï¼Œå¦‚æœåˆ é™¤ä¹‹å‰é˜Ÿåˆ—ä¸ºç©ºï¼Œé‚£ä¹ˆè¿”å› -1 ã€‚</span><span class="hljs-string">        #  int popBack() å°† æœ€åé¢ çš„å…ƒç´ ä»é˜Ÿåˆ—ä¸­åˆ é™¤å¹¶è¿”å›å€¼ï¼Œå¦‚æœåˆ é™¤ä¹‹å‰é˜Ÿåˆ—ä¸ºç©ºï¼Œé‚£ä¹ˆè¿”å› -1 ã€‚</span><span class="hljs-string">        #  è¯·æ³¨æ„å½“æœ‰ ä¸¤ä¸ª ä¸­é—´ä½ç½®çš„æ—¶å€™ï¼Œé€‰æ‹©é å‰é¢çš„ä½ç½®è¿›è¡Œæ“ä½œã€‚æ¯”æ–¹è¯´ï¼š</span><span class="hljs-string">        #</span><span class="hljs-string">        #  å°† 6 æ·»åŠ åˆ° [1, 2, 3, 4, 5] çš„ä¸­é—´ä½ç½®ï¼Œç»“æœæ•°ç»„ä¸º [1, 2, 6, 3, 4, 5] ã€‚</span><span class="hljs-string">        #  ä» [1, 2, 3, 4, 5, 6] çš„ä¸­é—´ä½ç½®å¼¹å‡ºå…ƒç´ ï¼Œè¿”å› 3 ï¼Œæ•°ç»„å˜ä¸º [1, 2, 4, 5, 6] ã€‚</span><span class="hljs-string">        #</span><span class="hljs-string">        #  ç¤ºä¾‹ 1ï¼š</span><span class="hljs-string">        # è¾“å…¥ï¼š</span><span class="hljs-string">        # [&quot;FrontMiddleBackQueue&quot;, &quot;pushFront&quot;, &quot;pushBack&quot;, &quot;pushMiddle&quot;, &quot;pushMiddle&quot;,</span><span class="hljs-string">        # &quot;popFront&quot;, &quot;popMiddle&quot;, &quot;popMiddle&quot;, &quot;popBack&quot;, &quot;popFront&quot;]</span><span class="hljs-string">        # [[], [1], [2], [3], [4], [], [], [], [], []]</span><span class="hljs-string">        # è¾“å‡ºï¼š</span><span class="hljs-string">        # [null, null, null, null, null, 1, 3, 4, 2, -1]</span><span class="hljs-string">        #</span><span class="hljs-string">        # è§£é‡Šï¼š</span><span class="hljs-string">        # FrontMiddleBackQueue q = new FrontMiddleBackQueue();</span><span class="hljs-string">        # q.pushFront(1);   // [1]</span><span class="hljs-string">        # q.pushBack(2);    // [1, 2]</span><span class="hljs-string">        # q.pushMiddle(3);  // [1, 3, 2]</span><span class="hljs-string">        # q.pushMiddle(4);  // [1, 4, 3, 2]</span><span class="hljs-string">        # q.popFront();     // è¿”å› 1 -&gt; [4, 3, 2]</span><span class="hljs-string">        # q.popMiddle();    // è¿”å› 3 -&gt; [4, 2]</span><span class="hljs-string">        # q.popMiddle();    // è¿”å› 4 -&gt; [2]</span><span class="hljs-string">        # q.popBack();      // è¿”å› 2 -&gt; []</span><span class="hljs-string">        # q.popFront();     // è¿”å› -1 -&gt; [] ï¼ˆé˜Ÿåˆ—ä¸ºç©ºï¼‰</span><span class="hljs-string">        #</span><span class="hljs-string">        #  æç¤ºï¼š</span><span class="hljs-string">        #  1 &lt;= val &lt;= 109</span><span class="hljs-string">        #  æœ€å¤šè°ƒç”¨ 1000 æ¬¡ pushFrontï¼Œ pushMiddleï¼Œ pushBackï¼Œ popFrontï¼Œ popMiddle å’Œ popBack ã€‚</span><span class="hljs-string">        #</span><span class="hljs-string">        #  Related Topics è®¾è®¡ é“¾è¡¨</span><span class="hljs-string">        #  ğŸ‘ 6 ğŸ‘ 0</span><span class="hljs-string"></span><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-comment"># leetcode submit region begin(Prohibit modification and deletion)</span><span class="hljs-keyword">from</span> collections <span class="hljs-keyword">import</span> deque<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FrontMiddleBackQueue</span>:</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self</span>):</span>        self.left = deque()        self.right = deque()    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">pushFront</span>(<span class="hljs-params">self, val: <span class="hljs-built_in">int</span></span>) -&gt; <span class="hljs-keyword">None</span>:</span>        self.left.appendleft(val)        self.balance_queue()    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">pushMiddle</span>(<span class="hljs-params">self, val: <span class="hljs-built_in">int</span></span>) -&gt; <span class="hljs-keyword">None</span>:</span>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(self.left) &gt; <span class="hljs-built_in">len</span>(self.right):            self.right.appendleft(self.left.pop())        self.left.append(val)    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">pushBack</span>(<span class="hljs-params">self, val: <span class="hljs-built_in">int</span></span>) -&gt; <span class="hljs-keyword">None</span>:</span>        self.right.append(val)        self.balance_queue()    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">popFront</span>(<span class="hljs-params">self</span>) -&gt; int:</span>        v = <span class="hljs-number">-1</span>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(self.left) + <span class="hljs-built_in">len</span>(self.right) == <span class="hljs-number">0</span>:            <span class="hljs-keyword">return</span> v        v = self.left.popleft()        self.balance_queue()        <span class="hljs-keyword">return</span> v    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">popMiddle</span>(<span class="hljs-params">self</span>) -&gt; int:</span>        v = <span class="hljs-number">-1</span>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(self.left) + <span class="hljs-built_in">len</span>(self.right) == <span class="hljs-number">0</span>:            <span class="hljs-keyword">return</span> v        v = self.left.pop()        self.balance_queue()        <span class="hljs-keyword">return</span> v    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">popBack</span>(<span class="hljs-params">self</span>) -&gt; int:</span>        v = <span class="hljs-number">-1</span>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(self.left) + <span class="hljs-built_in">len</span>(self.right) == <span class="hljs-number">0</span>:            <span class="hljs-keyword">return</span> v        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(self.right) == <span class="hljs-number">0</span>:            v = self.left.pop()        <span class="hljs-keyword">else</span>:            v = self.right.pop()        self.balance_queue()        <span class="hljs-keyword">return</span> v    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">balance_queue</span>(<span class="hljs-params">self</span>):</span>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(self.left) - <span class="hljs-built_in">len</span>(self.right) &gt;= <span class="hljs-number">2</span>:            self.right.appendleft(self.left.pop())        <span class="hljs-keyword">else</span>:            <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(self.left) &lt; <span class="hljs-built_in">len</span>(self.right):                self.left.append(self.right.popleft())    <span class="hljs-comment"># Your FrontMiddleBackQueue object will be instantiated and called as such:</span>    <span class="hljs-comment"># obj = FrontMiddleBackQueue()</span>    <span class="hljs-comment"># obj.pushFront(val)</span>    <span class="hljs-comment"># obj.pushMiddle(val)</span>    <span class="hljs-comment"># obj.pushBack(val)</span>    <span class="hljs-comment"># param_4 = obj.popFront()</span>    <span class="hljs-comment"># param_5 = obj.popMiddle()</span>    <span class="hljs-comment"># param_6 = obj.popBack()</span>    <span class="hljs-comment"># leetcode submit region end(Prohibit modification and deletion)</span><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:    obj = FrontMiddleBackQueue()    obj.pushFront(<span class="hljs-number">1</span>)    obj.pushMiddle(<span class="hljs-number">2</span>)    obj.pushBack(<span class="hljs-number">3</span>)    print(obj.popFront())    print(obj.popMiddle())    print(obj.popBack())</code></pre><h6 id="933-æœ€è¿‘çš„è¯·æ±‚æ¬¡æ•°"><a href="#933-æœ€è¿‘çš„è¯·æ±‚æ¬¡æ•°" class="headerlink" title="933. æœ€è¿‘çš„è¯·æ±‚æ¬¡æ•°"></a><a href="https://leetcode-cn.com/problems/number-of-recent-calls/">933. æœ€è¿‘çš„è¯·æ±‚æ¬¡æ•°</a></h6><p>å†™ä¸€ä¸ª <code>RecentCounter </code>ç±»æ¥è®¡ç®—ç‰¹å®šæ—¶é—´èŒƒå›´å†…æœ€è¿‘çš„è¯·æ±‚ã€‚</p><p>è¯·ä½ å®ç°<code>RecentCounter</code>ç±»ï¼š</p><ul><li><code>RecentCounter() </code>åˆå§‹åŒ–è®¡æ•°å™¨ï¼Œè¯·æ±‚æ•°ä¸º 0 ã€‚</li><li><code>int ping(int t) </code>åœ¨æ—¶é—´<code>t</code>æ·»åŠ ä¸€ä¸ªæ–°è¯·æ±‚ï¼Œå…¶ä¸­ <code>t</code> è¡¨ç¤ºä»¥æ¯«ç§’ä¸ºå•ä½çš„æŸä¸ªæ—¶é—´ï¼Œå¹¶è¿”å›è¿‡å» <code>3000</code> æ¯«ç§’å†…å‘ç”Ÿçš„æ‰€æœ‰è¯·æ±‚æ•°ï¼ˆåŒ…æ‹¬æ–°è¯·æ±‚ï¼‰ã€‚ç¡®åˆ‡åœ°è¯´ï¼Œè¿”å›åœ¨<code>[t-3000, t]</code>å†…å‘ç”Ÿçš„è¯·æ±‚æ•°ã€‚<br>ä¿è¯ æ¯æ¬¡å¯¹<code>ping</code>çš„è°ƒç”¨éƒ½ä½¿ç”¨æ¯”ä¹‹å‰æ›´å¤§çš„<code>t</code>å€¼ã€‚</li></ul><p><strong>ç¤ºä¾‹ï¼š</strong></p><pre><code class="hljs Java">è¾“å…¥ï¼š[<span class="hljs-string">&quot;RecentCounter&quot;</span>, <span class="hljs-string">&quot;ping&quot;</span>, <span class="hljs-string">&quot;ping&quot;</span>, <span class="hljs-string">&quot;ping&quot;</span>, <span class="hljs-string">&quot;ping&quot;</span>][[], [<span class="hljs-number">1</span>], [<span class="hljs-number">100</span>], [<span class="hljs-number">3001</span>], [<span class="hljs-number">3002</span>]]è¾“å‡ºï¼š[<span class="hljs-keyword">null</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">3</span>]è§£é‡Šï¼šRecentCounter recentCounter = <span class="hljs-keyword">new</span> RecentCounter();recentCounter.ping(<span class="hljs-number">1</span>);     <span class="hljs-comment">// requests = [1]ï¼ŒèŒƒå›´æ˜¯ [-2999,1]ï¼Œè¿”å› 1</span>recentCounter.ping(<span class="hljs-number">100</span>);   <span class="hljs-comment">// requests = [1, 100]ï¼ŒèŒƒå›´æ˜¯ [-2900,100]ï¼Œè¿”å› 2</span>recentCounter.ping(<span class="hljs-number">3001</span>);  <span class="hljs-comment">// requests = [1, 100, 3001]ï¼ŒèŒƒå›´æ˜¯ [1,3001]ï¼Œè¿”å› 3</span>recentCounter.ping(<span class="hljs-number">3002</span>);  <span class="hljs-comment">// requests = [1, 100, 3001, 3002]ï¼ŒèŒƒå›´æ˜¯ [2,3002]ï¼Œè¿”å› 3</span></code></pre><p><strong>æç¤ºï¼š</strong></p><ul><li><code>1 &lt;= t &lt;= 10^9</code></li><li>ä¿è¯æ¯æ¬¡å¯¹ <code>ping</code> è°ƒç”¨æ‰€ä½¿ç”¨çš„ <code>t</code> å€¼éƒ½ <strong>ä¸¥æ ¼é€’å¢</strong></li><li>è‡³å¤šè°ƒç”¨ <code>ping</code> æ–¹æ³• <code>10^4</code> æ¬¡</li></ul><p>è§£é¢˜æ€è·¯</p><pre><code class="hljs angelscript">é˜Ÿåˆ—å®ç°  å…¥é˜Ÿæ—¶ï¼Œå¯¹æ‰‹è¯·æ±‚æ—¶é—´&lt;å½“å‰<span class="hljs-number">-3000</span>ï¼Œå‡ºé˜Ÿ  é˜Ÿåˆ—ä¸­çš„å…ƒç´ æ•°é‡å³æ˜¯`[t<span class="hljs-number">-3000</span>, t]`å†…å‘ç”Ÿçš„è¯·æ±‚æ•°</code></pre><p><code>Java</code></p><pre><code class="hljs Java"><span class="hljs-keyword">package</span> com.weitrue.leetcode.editor.cn;<span class="hljs-keyword">import</span> java.util.Deque;<span class="hljs-keyword">import</span> java.util.LinkedList;<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">NumberOfRecentCalls</span></span>&#123;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span></span>&#123;        Solution s = <span class="hljs-keyword">new</span> NumberOfRecentCalls().<span class="hljs-function">new <span class="hljs-title">Solution</span><span class="hljs-params">()</span></span>;    &#125;        <span class="hljs-comment">//You have a RecentCounter class which counts the number of recent requests with in a certain time frame.</span>    <span class="hljs-comment">// Implement the RecentCounter class:</span>    <span class="hljs-comment">// RecentCounter() Initializes the counter with zero recent requests.</span>    <span class="hljs-comment">// int ping(int t) Adds a new request at time t, where t represents some time in milliseconds, and returns the number</span>    <span class="hljs-comment">// of requests that has happened in the past 3000 milliseconds (including the new request). Specifically, return the</span>    <span class="hljs-comment">// number of requests that have happened in the inclusive range [t - 3000, t].</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// It is guaranteed that every call to ping uses a strictly larger value of t than the previous call.</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Example 1:</span>    <span class="hljs-comment">//Input</span>    <span class="hljs-comment">//[&quot;RecentCounter&quot;, &quot;ping&quot;, &quot;ping&quot;, &quot;ping&quot;, &quot;ping&quot;]</span>    <span class="hljs-comment">//[[], [1], [100], [3001], [3002]]</span>    <span class="hljs-comment">//Output</span>    <span class="hljs-comment">//[null, 1, 2, 3, 3]</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">//Explanation</span>    <span class="hljs-comment">//RecentCounter recentCounter = new RecentCounter();</span>    <span class="hljs-comment">//recentCounter.ping(1);     // requests = [1], range is [-2999,1], return 1</span>    <span class="hljs-comment">//recentCounter.ping(100);   // requests = [1, 100], range is [-2900,100], return 2</span>    <span class="hljs-comment">//recentCounter.ping(3001);  // requests = [1, 100, 3001], range is [1,3001], return 3</span>    <span class="hljs-comment">//recentCounter.ping(3002);  // requests = [1, 100, 3001, 3002], range is [2,3002], return 3</span>    <span class="hljs-comment">// Constraints:</span>    <span class="hljs-comment">// 1 &lt;= t &lt;= 109</span>    <span class="hljs-comment">// Each test case will call ping with strictly increasing values of t.</span>    <span class="hljs-comment">// At most 104 calls will be made to ping.</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Related Topics é˜Ÿåˆ—</span>    <span class="hljs-comment">// ğŸ‘ 82 ğŸ‘ 0</span>     <span class="hljs-comment">//leetcode submit region begin(Prohibit modification and deletion)</span>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RecentCounter</span> </span>&#123;        <span class="hljs-keyword">private</span> Deque&lt;Integer&gt; deque = <span class="hljs-keyword">new</span> LinkedList();        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">RecentCounter</span><span class="hljs-params">()</span> </span>&#123;        &#125;        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">ping</span><span class="hljs-params">(<span class="hljs-keyword">int</span> t)</span> </span>&#123;            deque.add(t);            <span class="hljs-keyword">while</span> (deque.peek() &lt; t-<span class="hljs-number">3000</span>) &#123;                deque.poll();            &#125;            <span class="hljs-keyword">return</span> deque.size();        &#125;    &#125;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * Your RecentCounter object will be instantiated and called as such:</span><span class="hljs-comment">     * RecentCounter obj = new RecentCounter();</span><span class="hljs-comment">     * int param_1 = obj.ping(t);</span><span class="hljs-comment">     */</span>    <span class="hljs-comment">//leetcode submit region end(Prohibit modification and deletion)</span>&#125;</code></pre><p><code>Golang</code></p><pre><code class="hljs Golang"><span class="hljs-keyword">type</span> RecentCounter <span class="hljs-keyword">struct</span> &#123;queue Queue&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">Constructor</span><span class="hljs-params">()</span> <span class="hljs-title">RecentCounter</span></span> &#123;<span class="hljs-keyword">return</span> RecentCounter&#123;queue: <span class="hljs-built_in">make</span>([]<span class="hljs-keyword">int</span>, <span class="hljs-number">0</span>),&#125;&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(this *RecentCounter)</span> <span class="hljs-title">Ping</span><span class="hljs-params">(t <span class="hljs-keyword">int</span>)</span> <span class="hljs-title">int</span></span> &#123;this.queue.push(t)<span class="hljs-keyword">for</span> this.queue.peek() &lt; t<span class="hljs-number">-3000</span> &#123;this.queue.pop()&#125;<span class="hljs-keyword">return</span> <span class="hljs-built_in">len</span>(this.queue)&#125;<span class="hljs-keyword">type</span> Queue []<span class="hljs-keyword">int</span><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(q *Queue)</span><span class="hljs-title">push</span><span class="hljs-params">(v <span class="hljs-keyword">int</span>)</span> <span class="hljs-title">error</span></span> &#123;*q = <span class="hljs-built_in">append</span>(*q, v)<span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(q *Queue)</span><span class="hljs-title">pop</span><span class="hljs-params">()</span> <span class="hljs-title">int</span></span> &#123;<span class="hljs-keyword">if</span> q.isEmpty() &#123;<span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>&#125;head := (*q)[<span class="hljs-number">0</span>]*q = (*q)[<span class="hljs-number">1</span>:]<span class="hljs-keyword">return</span> head&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(q *Queue)</span><span class="hljs-title">peek</span><span class="hljs-params">()</span> <span class="hljs-title">int</span></span> &#123;<span class="hljs-keyword">if</span> q.isEmpty() &#123;<span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>&#125;<span class="hljs-keyword">return</span> (*q)[<span class="hljs-number">0</span>]&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(q *Queue)</span><span class="hljs-title">isEmpty</span><span class="hljs-params">()</span> <span class="hljs-title">bool</span></span> &#123;<span class="hljs-keyword">return</span> <span class="hljs-built_in">len</span>(*q) == <span class="hljs-number">0</span>&#125;</code></pre><p><code>Python</code></p><pre><code class="hljs Python"><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">Module Description: 933-æœ€è¿‘çš„è¯·æ±‚æ¬¡æ•°</span><span class="hljs-string">Solutionï¼š</span><span class="hljs-string">Author: Wang P</span><span class="hljs-string">Problem:# å†™ä¸€ä¸ª RecentCounter ç±»æ¥è®¡ç®—ç‰¹å®šæ—¶é—´èŒƒå›´å†…æœ€è¿‘çš„è¯·æ±‚ã€‚ </span><span class="hljs-string">        #  è¯·ä½ å®ç° RecentCounter ç±»ï¼š</span><span class="hljs-string">        #</span><span class="hljs-string">        #  RecentCounter() åˆå§‹åŒ–è®¡æ•°å™¨ï¼Œè¯·æ±‚æ•°ä¸º 0 ã€‚</span><span class="hljs-string">        #  int ping(int t) åœ¨æ—¶é—´ t æ·»åŠ ä¸€ä¸ªæ–°è¯·æ±‚ï¼Œå…¶ä¸­ t è¡¨ç¤ºä»¥æ¯«ç§’ä¸ºå•ä½çš„æŸä¸ªæ—¶é—´ï¼Œå¹¶è¿”å›è¿‡å» 3000 æ¯«ç§’å†…å‘ç”Ÿçš„æ‰€æœ‰è¯·æ±‚æ•°ï¼ˆåŒ…æ‹¬æ–°è¯·æ±‚ï¼‰ã€‚ç¡®åˆ‡åœ°è¯´ï¼Œè¿”å›åœ¨ [t-3000, t] å†…å‘ç”Ÿçš„è¯·æ±‚æ•°ã€‚</span><span class="hljs-string">        #  ä¿è¯ æ¯æ¬¡å¯¹ ping çš„è°ƒç”¨éƒ½ä½¿ç”¨æ¯”ä¹‹å‰æ›´å¤§çš„ t å€¼ã€‚</span><span class="hljs-string">        #  ç¤ºä¾‹ï¼š</span><span class="hljs-string">        # è¾“å…¥ï¼š</span><span class="hljs-string">        # [&quot;RecentCounter&quot;, &quot;ping&quot;, &quot;ping&quot;, &quot;ping&quot;, &quot;ping&quot;]</span><span class="hljs-string">        # [[], [1], [100], [3001], [3002]]</span><span class="hljs-string">        # è¾“å‡ºï¼š</span><span class="hljs-string">        # [null, 1, 2, 3, 3]</span><span class="hljs-string">        #</span><span class="hljs-string">        # è§£é‡Šï¼š</span><span class="hljs-string">        # RecentCounter recentCounter = new RecentCounter();</span><span class="hljs-string">        # recentCounter.ping(1);     // requests = [1]ï¼ŒèŒƒå›´æ˜¯ [-2999,1]ï¼Œè¿”å› 1</span><span class="hljs-string">        # recentCounter.ping(100);   // requests = [1, 100]ï¼ŒèŒƒå›´æ˜¯ [-2900,100]ï¼Œè¿”å› 2</span><span class="hljs-string">        # recentCounter.ping(3001);  // requests = [1, 100, 3001]ï¼ŒèŒƒå›´æ˜¯ [1,3001]ï¼Œè¿”å› 3</span><span class="hljs-string">        # recentCounter.ping(3002);  // requests = [1, 100, 3001, 3002]ï¼ŒèŒƒå›´æ˜¯ [2,3002]ï¼Œè¿”å› 3</span><span class="hljs-string">        #  æç¤ºï¼š</span><span class="hljs-string">        #  1 &lt;= t &lt;= 109</span><span class="hljs-string">        #  ä¿è¯æ¯æ¬¡å¯¹ ping è°ƒç”¨æ‰€ä½¿ç”¨çš„ t å€¼éƒ½ ä¸¥æ ¼é€’å¢</span><span class="hljs-string">        #  è‡³å¤šè°ƒç”¨ ping æ–¹æ³• 104 æ¬¡</span><span class="hljs-string">        #</span><span class="hljs-string">        #  Related Topics é˜Ÿåˆ—</span><span class="hljs-string">        #  ğŸ‘ 82 ğŸ‘ 0</span><span class="hljs-string">        &quot;&quot;&quot;</span><span class="hljs-comment"># leetcode submit region begin(Prohibit modification and deletion)</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RecentCounter</span>:</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self</span>):</span>        self.queue = []    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">ping</span>(<span class="hljs-params">self, t: <span class="hljs-built_in">int</span></span>) -&gt; int:</span>        self.push(t)        <span class="hljs-keyword">while</span> self.peek() &lt; t - <span class="hljs-number">3000</span>:            self.pop()        <span class="hljs-keyword">return</span> self.size()    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">push</span>(<span class="hljs-params">self, t: <span class="hljs-built_in">int</span></span>):</span>        self.queue.append(t)    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">pop</span>(<span class="hljs-params">self</span>):</span>        <span class="hljs-keyword">if</span> self.is_empty():            <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>        t = self.queue[<span class="hljs-number">0</span>]        self.queue = self.queue[<span class="hljs-number">1</span>:]        <span class="hljs-keyword">return</span> t    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">peek</span>(<span class="hljs-params">self</span>):</span>        <span class="hljs-keyword">if</span> self.is_empty():            <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>        <span class="hljs-keyword">return</span> self.queue[<span class="hljs-number">0</span>]    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">is_empty</span>(<span class="hljs-params">self</span>):</span>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">len</span>(self.queue) == <span class="hljs-number">0</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">size</span>(<span class="hljs-params">self</span>):</span>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">len</span>(self.queue)</code></pre><h6 id="621-ä»»åŠ¡è°ƒåº¦å™¨"><a href="#621-ä»»åŠ¡è°ƒåº¦å™¨" class="headerlink" title="621. ä»»åŠ¡è°ƒåº¦å™¨"></a><a href="https://leetcode-cn.com/problems/task-scheduler/">621. ä»»åŠ¡è°ƒåº¦å™¨</a></h6><p>ç»™ä½ ä¸€ä¸ªç”¨å­—ç¬¦æ•°ç»„ tasks è¡¨ç¤ºçš„ CPU éœ€è¦æ‰§è¡Œçš„ä»»åŠ¡åˆ—è¡¨ã€‚å…¶ä¸­æ¯ä¸ªå­—æ¯è¡¨ç¤ºä¸€ç§ä¸åŒç§ç±»çš„ä»»åŠ¡ã€‚ä»»åŠ¡å¯ä»¥ä»¥ä»»æ„é¡ºåºæ‰§è¡Œï¼Œå¹¶ä¸”æ¯ä¸ªä»»åŠ¡éƒ½å¯ä»¥åœ¨ 1 ä¸ªå•ä½æ—¶é—´å†…æ‰§è¡Œå®Œã€‚åœ¨ä»»ä½•ä¸€ä¸ªå•ä½æ—¶é—´ï¼ŒCPU å¯ä»¥å®Œæˆä¸€ä¸ªä»»åŠ¡ï¼Œæˆ–è€…å¤„äºå¾…å‘½çŠ¶æ€ã€‚</p><p>ç„¶è€Œï¼Œä¸¤ä¸ª ç›¸åŒç§ç±» çš„ä»»åŠ¡ä¹‹é—´å¿…é¡»æœ‰é•¿åº¦ä¸ºæ•´æ•° n çš„å†·å´æ—¶é—´ï¼Œå› æ­¤è‡³å°‘æœ‰è¿ç»­ n ä¸ªå•ä½æ—¶é—´å†… CPU åœ¨æ‰§è¡Œä¸åŒçš„ä»»åŠ¡ï¼Œæˆ–è€…åœ¨å¾…å‘½çŠ¶æ€ã€‚</p><p>ä½ éœ€è¦è®¡ç®—å®Œæˆæ‰€æœ‰ä»»åŠ¡æ‰€éœ€è¦çš„ æœ€çŸ­æ—¶é—´ ã€‚</p><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><pre><code class="hljs livescript">è¾“å…¥ï¼štasks = [<span class="hljs-string">&quot;A&quot;</span>,<span class="hljs-string">&quot;A&quot;</span>,<span class="hljs-string">&quot;A&quot;</span>,<span class="hljs-string">&quot;B&quot;</span>,<span class="hljs-string">&quot;B&quot;</span>,<span class="hljs-string">&quot;B&quot;</span>], n = <span class="hljs-number">2</span>è¾“å‡ºï¼š<span class="hljs-number">8</span>è§£é‡Šï¼šA<span class="hljs-function"> -&gt;</span> B<span class="hljs-function"> -&gt;</span> <span class="hljs-function"><span class="hljs-params">(å¾…å‘½)</span> -&gt;</span> A<span class="hljs-function"> -&gt;</span> B<span class="hljs-function"> -&gt;</span> <span class="hljs-function"><span class="hljs-params">(å¾…å‘½)</span> -&gt;</span> A<span class="hljs-function"> -&gt;</span> B     åœ¨æœ¬ç¤ºä¾‹ä¸­ï¼Œä¸¤ä¸ªç›¸åŒç±»å‹ä»»åŠ¡ä¹‹é—´å¿…é¡»é—´éš”é•¿åº¦ä¸º n = <span class="hljs-number">2</span> çš„å†·å´æ—¶é—´ï¼Œè€Œæ‰§è¡Œä¸€ä¸ªä»»åŠ¡åªéœ€è¦ä¸€ä¸ªå•ä½æ—¶é—´ï¼Œæ‰€ä»¥ä¸­é—´å‡ºç°äº†ï¼ˆå¾…å‘½ï¼‰çŠ¶æ€ã€‚</code></pre><p><strong>ç¤ºä¾‹ 2ï¼š</strong></p><pre><code class="hljs prolog">è¾“å…¥ï¼štasks = [<span class="hljs-string">&quot;A&quot;</span>,<span class="hljs-string">&quot;A&quot;</span>,<span class="hljs-string">&quot;A&quot;</span>,<span class="hljs-string">&quot;B&quot;</span>,<span class="hljs-string">&quot;B&quot;</span>,<span class="hljs-string">&quot;B&quot;</span>], n = <span class="hljs-number">0</span>è¾“å‡ºï¼š<span class="hljs-number">6</span>è§£é‡Šï¼šåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä»»ä½•å¤§å°ä¸º <span class="hljs-number">6</span> çš„æ’åˆ—éƒ½å¯ä»¥æ»¡è¶³è¦æ±‚ï¼Œå› ä¸º n = <span class="hljs-number">0</span>[<span class="hljs-string">&quot;A&quot;</span>,<span class="hljs-string">&quot;A&quot;</span>,<span class="hljs-string">&quot;A&quot;</span>,<span class="hljs-string">&quot;B&quot;</span>,<span class="hljs-string">&quot;B&quot;</span>,<span class="hljs-string">&quot;B&quot;</span>][<span class="hljs-string">&quot;A&quot;</span>,<span class="hljs-string">&quot;B&quot;</span>,<span class="hljs-string">&quot;A&quot;</span>,<span class="hljs-string">&quot;B&quot;</span>,<span class="hljs-string">&quot;A&quot;</span>,<span class="hljs-string">&quot;B&quot;</span>][<span class="hljs-string">&quot;B&quot;</span>,<span class="hljs-string">&quot;B&quot;</span>,<span class="hljs-string">&quot;B&quot;</span>,<span class="hljs-string">&quot;A&quot;</span>,<span class="hljs-string">&quot;A&quot;</span>,<span class="hljs-string">&quot;A&quot;</span>]...è¯¸å¦‚æ­¤ç±»</code></pre><p><strong>ç¤ºä¾‹ 3ï¼š</strong></p><pre><code class="hljs livescript">è¾“å…¥ï¼štasks = [<span class="hljs-string">&quot;A&quot;</span>,<span class="hljs-string">&quot;A&quot;</span>,<span class="hljs-string">&quot;A&quot;</span>,<span class="hljs-string">&quot;A&quot;</span>,<span class="hljs-string">&quot;A&quot;</span>,<span class="hljs-string">&quot;A&quot;</span>,<span class="hljs-string">&quot;B&quot;</span>,<span class="hljs-string">&quot;C&quot;</span>,<span class="hljs-string">&quot;D&quot;</span>,<span class="hljs-string">&quot;E&quot;</span>,<span class="hljs-string">&quot;F&quot;</span>,<span class="hljs-string">&quot;G&quot;</span>], n = <span class="hljs-number">2</span>è¾“å‡ºï¼š<span class="hljs-number">16</span>è§£é‡Šï¼šä¸€ç§å¯èƒ½çš„è§£å†³æ–¹æ¡ˆæ˜¯ï¼š     A<span class="hljs-function"> -&gt;</span> B<span class="hljs-function"> -&gt;</span> C<span class="hljs-function"> -&gt;</span> A<span class="hljs-function"> -&gt;</span> D<span class="hljs-function"> -&gt;</span> E<span class="hljs-function"> -&gt;</span> A<span class="hljs-function"> -&gt;</span> F<span class="hljs-function"> -&gt;</span> G<span class="hljs-function"> -&gt;</span> A<span class="hljs-function"> -&gt;</span> <span class="hljs-function"><span class="hljs-params">(å¾…å‘½)</span> -&gt;</span> <span class="hljs-function"><span class="hljs-params">(å¾…å‘½)</span> -&gt;</span> A<span class="hljs-function"> -&gt;</span> <span class="hljs-function"><span class="hljs-params">(å¾…å‘½)</span> -&gt;</span> <span class="hljs-function"><span class="hljs-params">(å¾…å‘½)</span> -&gt;</span> A</code></pre><p><strong>æç¤ºï¼š</strong></p><ul><li><code>1 &lt;= task.length &lt;= 104</code></li><li><code>tasks[i]</code> æ˜¯å¤§å†™è‹±æ–‡å­—æ¯</li><li><code>n</code> çš„å–å€¼èŒƒå›´ä¸º <code>[0, 100]</code></li></ul><p>è§£é¢˜æ€è·¯</p><pre><code class="hljs plain"></code></pre><p><code>Java</code></p><pre><code class="hljs Java"></code></pre><p><code>Golang</code></p><pre><code class="hljs Golang"></code></pre><p><code>Python</code></p><pre><code class="hljs Python"></code></pre><h6 id="é¢è¯•é¢˜-17-09-ç¬¬-k-ä¸ªæ•°"><a href="#é¢è¯•é¢˜-17-09-ç¬¬-k-ä¸ªæ•°" class="headerlink" title="é¢è¯•é¢˜ 17.09. ç¬¬ k ä¸ªæ•°"></a><a href="https://leetcode-cn.com/problems/get-kth-magic-number-lcci/">é¢è¯•é¢˜ 17.09. ç¬¬ k ä¸ªæ•°</a></h6><p>æœ‰äº›æ•°çš„ç´ å› å­åªæœ‰ 3ï¼Œ5ï¼Œ7ï¼Œè¯·è®¾è®¡ä¸€ä¸ªç®—æ³•æ‰¾å‡ºç¬¬ k ä¸ªæ•°ã€‚æ³¨æ„ï¼Œä¸æ˜¯å¿…é¡»æœ‰è¿™äº›ç´ å› å­ï¼Œè€Œæ˜¯å¿…é¡»ä¸åŒ…å«å…¶ä»–çš„ç´ å› å­ã€‚ä¾‹å¦‚ï¼Œå‰å‡ ä¸ªæ•°æŒ‰é¡ºåºåº”è¯¥æ˜¯ 1ï¼Œ3ï¼Œ5ï¼Œ7ï¼Œ9ï¼Œ15ï¼Œ21ã€‚</p><p><strong>ç¤ºä¾‹ 1:</strong></p><pre><code class="hljs angelscript">è¾“å…¥: k = <span class="hljs-number">5</span>è¾“å‡º: <span class="hljs-number">9</span></code></pre><p>è§£é¢˜æ€è·¯</p><pre><code class="hljs plain">æ™ºåŠ›é¢˜   ç†Ÿæ‚‰æ•°å­—è§„åˆ™å³å¯</code></pre><p><code>Java</code></p><pre><code class="hljs Java"></code></pre><p><code>Golang</code></p><pre><code class="hljs Golang"></code></pre><p><code>Python</code></p><pre><code class="hljs Python"></code></pre><h6 id="859-äº²å¯†å­—ç¬¦ä¸²"><a href="#859-äº²å¯†å­—ç¬¦ä¸²" class="headerlink" title="859. äº²å¯†å­—ç¬¦ä¸²"></a><a href="https://leetcode-cn.com/problems/buddy-strings/">859. äº²å¯†å­—ç¬¦ä¸²</a></h6><p>ç»™å®šä¸¤ä¸ªç”±å°å†™å­—æ¯æ„æˆçš„å­—ç¬¦ä¸² A å’Œ B ï¼Œåªè¦æˆ‘ä»¬å¯ä»¥é€šè¿‡äº¤æ¢ A ä¸­çš„ä¸¤ä¸ªå­—æ¯å¾—åˆ°ä¸ B ç›¸ç­‰çš„ç»“æœï¼Œå°±è¿”å› true ï¼›å¦åˆ™è¿”å› false ã€‚</p><p>äº¤æ¢å­—æ¯çš„å®šä¹‰æ˜¯å–ä¸¤ä¸ªä¸‹æ ‡ i å’Œ j ï¼ˆä¸‹æ ‡ä» 0 å¼€å§‹ï¼‰ï¼Œåªè¦<code>i!=j</code>å°±äº¤æ¢<code>A[i]</code>å’Œ<code>A[j] </code>å¤„çš„å­—ç¬¦ã€‚ä¾‹å¦‚ï¼Œåœ¨ <code>&quot;abcd&quot;</code> ä¸­äº¤æ¢ä¸‹æ ‡ 0 å’Œä¸‹æ ‡ 2 çš„å…ƒç´ å¯ä»¥ç”Ÿæˆ <code>&quot;cbad&quot; </code>ã€‚</p><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><pre><code class="hljs prolog">è¾“å…¥ï¼š <span class="hljs-symbol">A</span> = <span class="hljs-string">&quot;ab&quot;</span>, <span class="hljs-symbol">B</span> = <span class="hljs-string">&quot;ba&quot;</span>è¾“å‡ºï¼š trueè§£é‡Šï¼š ä½ å¯ä»¥äº¤æ¢ <span class="hljs-symbol">A</span>[<span class="hljs-number">0</span>] = <span class="hljs-string">&#x27;a&#x27;</span> å’Œ <span class="hljs-symbol">A</span>[<span class="hljs-number">1</span>] = <span class="hljs-string">&#x27;b&#x27;</span> ç”Ÿæˆ <span class="hljs-string">&quot;ba&quot;</span>ï¼Œæ­¤æ—¶ <span class="hljs-symbol">A</span> å’Œ <span class="hljs-symbol">B</span> ç›¸ç­‰ã€‚</code></pre><p><strong>ç¤ºä¾‹ 2ï¼š</strong></p><pre><code class="hljs prolog">è¾“å…¥ï¼š <span class="hljs-symbol">A</span> = <span class="hljs-string">&quot;ab&quot;</span>, <span class="hljs-symbol">B</span> = <span class="hljs-string">&quot;ab&quot;</span>è¾“å‡ºï¼š falseè§£é‡Šï¼š ä½ åªèƒ½äº¤æ¢ <span class="hljs-symbol">A</span>[<span class="hljs-number">0</span>] = <span class="hljs-string">&#x27;a&#x27;</span> å’Œ <span class="hljs-symbol">A</span>[<span class="hljs-number">1</span>] = <span class="hljs-string">&#x27;b&#x27;</span> ç”Ÿæˆ <span class="hljs-string">&quot;ba&quot;</span>ï¼Œæ­¤æ—¶ <span class="hljs-symbol">A</span> å’Œ <span class="hljs-symbol">B</span> ä¸ç›¸ç­‰ã€‚</code></pre><p><strong>ç¤ºä¾‹ 3ï¼š</strong></p><pre><code class="hljs vbnet">è¾“å…¥ï¼š A = <span class="hljs-string">&quot;aa&quot;</span>, B = <span class="hljs-string">&quot;aa&quot;</span>è¾“å‡ºï¼š <span class="hljs-literal">true</span>è§£é‡Šï¼š ä½ å¯ä»¥äº¤æ¢ A[<span class="hljs-number">0</span>] = <span class="hljs-comment">&#x27;a&#x27; å’Œ A[1] = &#x27;a&#x27; ç”Ÿæˆ &quot;aa&quot;ï¼Œæ­¤æ—¶ A å’Œ B ç›¸ç­‰ã€‚</span></code></pre><p><strong>ç¤ºä¾‹ 4ï¼š</strong></p><pre><code class="hljs nix">è¾“å…¥ï¼š <span class="hljs-attr">A</span> = <span class="hljs-string">&quot;aaaaaaabc&quot;</span>, <span class="hljs-attr">B</span> = <span class="hljs-string">&quot;aaaaaaacb&quot;</span>è¾“å‡ºï¼š <span class="hljs-literal">true</span></code></pre><p><strong>ç¤ºä¾‹ 5ï¼š</strong></p><pre><code class="hljs nix">è¾“å…¥ï¼š <span class="hljs-attr">A</span> = <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-attr">B</span> = <span class="hljs-string">&quot;aa&quot;</span>è¾“å‡ºï¼š <span class="hljs-literal">false</span></code></pre><p><strong>æç¤ºï¼š</strong></p><ol><li><code>0 &lt;= A.length &lt;= 20000</code></li><li><code>0 &lt;= B.length &lt;= 20000</code></li><li><code>A</code> å’Œ <code>B</code> ä»…ç”±å°å†™å­—æ¯æ„æˆã€‚</li></ol><p>è§£é¢˜æ€è·¯</p><pre><code class="hljs plain"></code></pre><p><code>Java</code></p><pre><code class="hljs Java"></code></pre><p><code>Golang</code></p><pre><code class="hljs Golang"></code></pre><p><code>Python</code></p><pre><code class="hljs Python"></code></pre><h6 id="860-æŸ æª¬æ°´æ‰¾é›¶"><a href="#860-æŸ æª¬æ°´æ‰¾é›¶" class="headerlink" title="860. æŸ æª¬æ°´æ‰¾é›¶"></a><a href="https://leetcode-cn.com/problems/lemonade-change/">860. æŸ æª¬æ°´æ‰¾é›¶</a></h6><p>åœ¨æŸ æª¬æ°´æ‘Šä¸Šï¼Œæ¯ä¸€æ¯æŸ æª¬æ°´çš„å”®ä»·ä¸º 5 ç¾å…ƒã€‚</p><p>é¡¾å®¢æ’é˜Ÿè´­ä¹°ä½ çš„äº§å“ï¼Œï¼ˆæŒ‰è´¦å• bills æ”¯ä»˜çš„é¡ºåºï¼‰ä¸€æ¬¡è´­ä¹°ä¸€æ¯ã€‚</p><p>æ¯ä½é¡¾å®¢åªä¹°ä¸€æ¯æŸ æª¬æ°´ï¼Œç„¶åå‘ä½ ä»˜ 5 ç¾å…ƒã€10 ç¾å…ƒæˆ– 20 ç¾å…ƒã€‚ä½ å¿…é¡»ç»™æ¯ä¸ªé¡¾å®¢æ­£ç¡®æ‰¾é›¶ï¼Œä¹Ÿå°±æ˜¯è¯´å‡€äº¤æ˜“æ˜¯æ¯ä½é¡¾å®¢å‘ä½ æ”¯ä»˜ 5 ç¾å…ƒã€‚</p><p>æ³¨æ„ï¼Œä¸€å¼€å§‹ä½ æ‰‹å¤´æ²¡æœ‰ä»»ä½•é›¶é’±ã€‚</p><p>å¦‚æœä½ èƒ½ç»™æ¯ä½é¡¾å®¢æ­£ç¡®æ‰¾é›¶ï¼Œè¿”å› true ï¼Œå¦åˆ™è¿”å› false ã€‚</p><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><pre><code class="hljs angelscript">è¾“å…¥ï¼š[<span class="hljs-number">5</span>,<span class="hljs-number">5</span>,<span class="hljs-number">5</span>,<span class="hljs-number">10</span>,<span class="hljs-number">20</span>]è¾“å‡ºï¼š<span class="hljs-literal">true</span>è§£é‡Šï¼šå‰ <span class="hljs-number">3</span> ä½é¡¾å®¢é‚£é‡Œï¼Œæˆ‘ä»¬æŒ‰é¡ºåºæ”¶å– <span class="hljs-number">3</span> å¼  <span class="hljs-number">5</span> ç¾å…ƒçš„é’ç¥¨ã€‚ç¬¬ <span class="hljs-number">4</span> ä½é¡¾å®¢é‚£é‡Œï¼Œæˆ‘ä»¬æ”¶å–ä¸€å¼  <span class="hljs-number">10</span> ç¾å…ƒçš„é’ç¥¨ï¼Œå¹¶è¿”è¿˜ <span class="hljs-number">5</span> ç¾å…ƒã€‚ç¬¬ <span class="hljs-number">5</span> ä½é¡¾å®¢é‚£é‡Œï¼Œæˆ‘ä»¬æ‰¾è¿˜ä¸€å¼  <span class="hljs-number">10</span> ç¾å…ƒçš„é’ç¥¨å’Œä¸€å¼  <span class="hljs-number">5</span> ç¾å…ƒçš„é’ç¥¨ã€‚ç”±äºæ‰€æœ‰å®¢æˆ·éƒ½å¾—åˆ°äº†æ­£ç¡®çš„æ‰¾é›¶ï¼Œæ‰€ä»¥æˆ‘ä»¬è¾“å‡º <span class="hljs-literal">true</span>ã€‚</code></pre><p><strong>ç¤ºä¾‹ 2ï¼š</strong></p><pre><code class="hljs angelscript">è¾“å…¥ï¼š[<span class="hljs-number">5</span>,<span class="hljs-number">5</span>,<span class="hljs-number">10</span>]è¾“å‡ºï¼š<span class="hljs-literal">true</span></code></pre><p><strong>ç¤ºä¾‹ 3ï¼š</strong></p><pre><code class="hljs angelscript">è¾“å…¥ï¼š[<span class="hljs-number">10</span>,<span class="hljs-number">10</span>]è¾“å‡ºï¼š<span class="hljs-literal">false</span></code></pre><p><strong>ç¤ºä¾‹ 4ï¼š</strong></p><pre><code class="hljs angelscript">è¾“å…¥ï¼š[<span class="hljs-number">5</span>,<span class="hljs-number">5</span>,<span class="hljs-number">10</span>,<span class="hljs-number">10</span>,<span class="hljs-number">20</span>]è¾“å‡ºï¼š<span class="hljs-literal">false</span>è§£é‡Šï¼šå‰ <span class="hljs-number">2</span> ä½é¡¾å®¢é‚£é‡Œï¼Œæˆ‘ä»¬æŒ‰é¡ºåºæ”¶å– <span class="hljs-number">2</span> å¼  <span class="hljs-number">5</span> ç¾å…ƒçš„é’ç¥¨ã€‚å¯¹äºæ¥ä¸‹æ¥çš„ <span class="hljs-number">2</span> ä½é¡¾å®¢ï¼Œæˆ‘ä»¬æ”¶å–ä¸€å¼  <span class="hljs-number">10</span> ç¾å…ƒçš„é’ç¥¨ï¼Œç„¶åè¿”è¿˜ <span class="hljs-number">5</span> ç¾å…ƒã€‚å¯¹äºæœ€åä¸€ä½é¡¾å®¢ï¼Œæˆ‘ä»¬æ— æ³•é€€å› <span class="hljs-number">15</span> ç¾å…ƒï¼Œå› ä¸ºæˆ‘ä»¬ç°åœ¨åªæœ‰ä¸¤å¼  <span class="hljs-number">10</span> ç¾å…ƒçš„é’ç¥¨ã€‚ç”±äºä¸æ˜¯æ¯ä½é¡¾å®¢éƒ½å¾—åˆ°äº†æ­£ç¡®çš„æ‰¾é›¶ï¼Œæ‰€ä»¥ç­”æ¡ˆæ˜¯ <span class="hljs-literal">false</span>ã€‚</code></pre><p><strong>æç¤ºï¼š</strong></p><ul><li><code>0 &lt;= bills.length &lt;= 10000</code></li><li><code>bills[i]</code> ä¸æ˜¯ <code>5</code> å°±æ˜¯ <code>10</code> æˆ–æ˜¯ <code>20</code> </li></ul><p>è§£é¢˜æ€è·¯</p><pre><code class="hljs plain">è´ªå¿ƒç®—æ³•</code></pre><p><code>Java</code></p><pre><code class="hljs Java"></code></pre><p><code>Golang</code></p><pre><code class="hljs Golang"></code></pre><p><code>Python</code></p><pre><code class="hljs Python"></code></pre><h6 id="969-ç…é¥¼æ’åº"><a href="#969-ç…é¥¼æ’åº" class="headerlink" title="969. ç…é¥¼æ’åº"></a><a href="https://leetcode-cn.com/problems/pancake-sorting/">969. ç…é¥¼æ’åº</a></h6><p>ç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„<code>arr</code>ï¼Œè¯·ä½¿ç”¨<strong>ç…é¥¼ç¿»è½¬</strong>å®Œæˆå¯¹æ•°ç»„çš„æ’åºã€‚</p><p>ä¸€æ¬¡ç…é¥¼ç¿»è½¬çš„æ‰§è¡Œè¿‡ç¨‹å¦‚ä¸‹ï¼š</p><ul><li>é€‰æ‹©ä¸€ä¸ªæ•´æ•°<code>k</code>ï¼Œ<code>1 &lt;= k &lt;= arr.length</code></li><li>åè½¬å­æ•°ç»„ <code>arr[0...k-1]</code>ï¼ˆ<strong>ä¸‹æ ‡ä» 0 å¼€å§‹</strong>ï¼‰</li></ul><p>ä¾‹å¦‚ï¼Œ<code>arr = [3,2,1,4]</code>ï¼Œé€‰æ‹©<code>k = 3</code>è¿›è¡Œä¸€æ¬¡ç…é¥¼ç¿»è½¬ï¼Œåè½¬å­æ•°ç»„<code>[3,2,1]</code>ï¼Œå¾—åˆ°<code>arr = [1,2,3,4]</code>ã€‚</p><p>ä»¥æ•°ç»„å½¢å¼è¿”å›èƒ½ä½¿<code>arr</code>æœ‰åºçš„ç…é¥¼ç¿»è½¬æ“ä½œæ‰€å¯¹åº”çš„<code>k</code>å€¼åºåˆ—ã€‚ä»»ä½•å°†æ•°ç»„æ’åºä¸”ç¿»è½¬æ¬¡æ•°åœ¨<code>10 * arr.length</code>èŒƒå›´å†…çš„æœ‰æ•ˆç­”æ¡ˆéƒ½å°†è¢«åˆ¤æ–­ä¸ºæ­£ç¡®ã€‚</p><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><pre><code class="hljs angelscript">è¾“å…¥ï¼š[<span class="hljs-number">3</span>,<span class="hljs-number">2</span>,<span class="hljs-number">4</span>,<span class="hljs-number">1</span>]è¾“å‡ºï¼š[<span class="hljs-number">4</span>,<span class="hljs-number">2</span>,<span class="hljs-number">4</span>,<span class="hljs-number">3</span>]è§£é‡Šï¼šæˆ‘ä»¬æ‰§è¡Œ <span class="hljs-number">4</span> æ¬¡ç…é¥¼ç¿»è½¬ï¼Œk å€¼åˆ†åˆ«ä¸º <span class="hljs-number">4</span>ï¼Œ<span class="hljs-number">2</span>ï¼Œ<span class="hljs-number">4</span>ï¼Œå’Œ <span class="hljs-number">3</span>ã€‚åˆå§‹çŠ¶æ€ arr = [<span class="hljs-number">3</span>, <span class="hljs-number">2</span>, <span class="hljs-number">4</span>, <span class="hljs-number">1</span>]ç¬¬ä¸€æ¬¡ç¿»è½¬åï¼ˆk = <span class="hljs-number">4</span>ï¼‰ï¼šarr = [<span class="hljs-number">1</span>, <span class="hljs-number">4</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]ç¬¬äºŒæ¬¡ç¿»è½¬åï¼ˆk = <span class="hljs-number">2</span>ï¼‰ï¼šarr = [<span class="hljs-number">4</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]ç¬¬ä¸‰æ¬¡ç¿»è½¬åï¼ˆk = <span class="hljs-number">4</span>ï¼‰ï¼šarr = [<span class="hljs-number">3</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">4</span>]ç¬¬å››æ¬¡ç¿»è½¬åï¼ˆk = <span class="hljs-number">3</span>ï¼‰ï¼šarr = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>]ï¼Œæ­¤æ—¶å·²å®Œæˆæ’åºã€‚</code></pre><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><pre><code class="hljs angelscript">è¾“å…¥ï¼š[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>]è¾“å‡ºï¼š[]è§£é‡Šï¼šè¾“å…¥å·²ç»æ’åºï¼Œå› æ­¤ä¸éœ€è¦ç¿»è½¬ä»»ä½•å†…å®¹ã€‚è¯·æ³¨æ„ï¼Œå…¶ä»–å¯èƒ½çš„ç­”æ¡ˆï¼Œå¦‚ [<span class="hljs-number">3</span>ï¼Œ<span class="hljs-number">3</span>] ï¼Œä¹Ÿå°†è¢«åˆ¤æ–­ä¸ºæ­£ç¡®ã€‚</code></pre><p>æç¤ºï¼š</p><ul><li><code>1 &lt;= arr.length &lt;= 100</code></li><li><code>1 &lt;= arr[i] &lt;= arr.length</code></li><li><code>arr</code>ä¸­çš„æ‰€æœ‰æ•´æ•°äº’ä¸ç›¸åŒï¼ˆå³<code>arr</code>æ˜¯ä»<code>1</code>åˆ°<code>arr.length</code>æ•´æ•°çš„ä¸€ä¸ªæ’åˆ—ï¼‰</li></ul><p>è§£é¢˜æ€è·¯</p><pre><code class="hljs basic"><span class="hljs-symbol">984132657 </span>æ’åº</code></pre><p><code>Java</code></p><pre><code class="hljs Java"></code></pre><p><code>Golang</code></p><pre><code class="hljs Golang"></code></pre><p><code>Python</code></p><pre><code class="hljs Python"></code></pre><h4 id="é€’å½’ä¸æ ˆï¼ˆStackï¼‰ï¼šè§£å†³è¡¨è¾¾å¼æ±‚å€¼"><a href="#é€’å½’ä¸æ ˆï¼ˆStackï¼‰ï¼šè§£å†³è¡¨è¾¾å¼æ±‚å€¼" class="headerlink" title="é€’å½’ä¸æ ˆï¼ˆStackï¼‰ï¼šè§£å†³è¡¨è¾¾å¼æ±‚å€¼"></a>é€’å½’ä¸æ ˆï¼ˆStackï¼‰ï¼šè§£å†³è¡¨è¾¾å¼æ±‚å€¼</h4><h5 id="åŸºç¡€çŸ¥è¯†"><a href="#åŸºç¡€çŸ¥è¯†" class="headerlink" title="åŸºç¡€çŸ¥è¯†"></a>åŸºç¡€çŸ¥è¯†</h5><p>æ ˆé€‚åˆè§£å†³ä»€ä¹ˆé—®é¢˜ï¼Ÿ</p><p>å¤„ç†ä¸€ç§å…·æœ‰å®Œå…¨åŒ…å«å…³ç³»çš„é—®é¢˜ã€‚</p><h5 id="æ ˆç»“æ„åŸºç¡€åº”ç”¨"><a href="#æ ˆç»“æ„åŸºç¡€åº”ç”¨" class="headerlink" title="æ ˆç»“æ„åŸºç¡€åº”ç”¨"></a>æ ˆç»“æ„åŸºç¡€åº”ç”¨</h5><h6 id="227-åŸºæœ¬è®¡ç®—å™¨-II"><a href="#227-åŸºæœ¬è®¡ç®—å™¨-II" class="headerlink" title="227. åŸºæœ¬è®¡ç®—å™¨ II"></a><a href="https://leetcode-cn.com/problems/basic-calculator-ii/">227. åŸºæœ¬è®¡ç®—å™¨ II</a></h6><p>ç»™ä½ ä¸€ä¸ªå­—ç¬¦ä¸²è¡¨è¾¾å¼ <code>s</code> ï¼Œè¯·ä½ å®ç°ä¸€ä¸ªåŸºæœ¬è®¡ç®—å™¨æ¥è®¡ç®—å¹¶è¿”å›å®ƒçš„å€¼ã€‚</p><p>æ•´æ•°é™¤æ³•ä»…ä¿ç•™æ•´æ•°éƒ¨åˆ†ã€‚</p><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><pre><code class="hljs lsl">è¾“å…¥ï¼šs = <span class="hljs-string">&quot;3+2*2&quot;</span>è¾“å‡ºï¼š<span class="hljs-number">7</span></code></pre><p><strong>ç¤ºä¾‹ 2ï¼š</strong></p><pre><code class="hljs lsl">è¾“å…¥ï¼šs = <span class="hljs-string">&quot; 3/2 &quot;</span>è¾“å‡ºï¼š<span class="hljs-number">1</span></code></pre><p><strong>ç¤ºä¾‹ 3ï¼š</strong></p><pre><code class="hljs lsl">è¾“å…¥ï¼šs = <span class="hljs-string">&quot; 3+5 / 2 &quot;</span>è¾“å‡ºï¼š<span class="hljs-number">5</span></code></pre><p>è§£é¢˜æ€è·¯</p><pre><code class="hljs plain"></code></pre><p><code>Java</code></p><pre><code class="hljs Java"></code></pre><p><code>Golang</code></p><pre><code class="hljs Golang"></code></pre><p><code>Python</code></p><pre><code class="hljs Python"></code></pre><h6 id="é¢è¯•é¢˜-03-04-åŒ–æ ˆä¸ºé˜Ÿ"><a href="#é¢è¯•é¢˜-03-04-åŒ–æ ˆä¸ºé˜Ÿ" class="headerlink" title="é¢è¯•é¢˜ 03.04. åŒ–æ ˆä¸ºé˜Ÿ"></a><a href="https://leetcode-cn.com/problems/implement-queue-using-stacks-lcci/">é¢è¯•é¢˜ 03.04. åŒ–æ ˆä¸ºé˜Ÿ</a></h6><p>å®ç°ä¸€ä¸ªMyQueueç±»ï¼Œè¯¥ç±»ç”¨ä¸¤ä¸ªæ ˆæ¥å®ç°ä¸€ä¸ªé˜Ÿåˆ—ã€‚</p><p><strong>ç¤ºä¾‹ï¼š</strong></p><pre><code class="hljs arduino">MyQueue <span class="hljs-built_in">queue</span> = <span class="hljs-keyword">new</span> MyQueue();<span class="hljs-built_in">queue</span>.push(<span class="hljs-number">1</span>);<span class="hljs-built_in">queue</span>.push(<span class="hljs-number">2</span>);<span class="hljs-built_in">queue</span>.<span class="hljs-built_in">peek</span>();  <span class="hljs-comment">// è¿”å› 1</span><span class="hljs-built_in">queue</span>.pop();   <span class="hljs-comment">// è¿”å› 1</span><span class="hljs-built_in">queue</span>.empty(); <span class="hljs-comment">// è¿”å› false</span></code></pre><p><strong>è¯´æ˜ï¼š</strong></p><ul><li>ä½ åªèƒ½ä½¿ç”¨æ ‡å‡†çš„æ ˆæ“ä½œ â€“ ä¹Ÿå°±æ˜¯åªæœ‰ <code>push to top</code>, <code>peek/pop from top</code>, <code>size</code> å’Œ <code>is empty</code> æ“ä½œæ˜¯åˆæ³•çš„ã€‚</li><li>ä½ æ‰€ä½¿ç”¨çš„è¯­è¨€ä¹Ÿè®¸ä¸æ”¯æŒæ ˆã€‚ä½ å¯ä»¥ä½¿ç”¨ list æˆ–è€… dequeï¼ˆåŒç«¯é˜Ÿåˆ—ï¼‰æ¥æ¨¡æ‹Ÿä¸€ä¸ªæ ˆï¼Œåªè¦æ˜¯æ ‡å‡†çš„æ ˆæ“ä½œå³å¯ã€‚</li><li>å‡è®¾æ‰€æœ‰æ“ä½œéƒ½æ˜¯æœ‰æ•ˆçš„ ï¼ˆä¾‹å¦‚ï¼Œä¸€ä¸ªç©ºçš„é˜Ÿåˆ—ä¸ä¼šè°ƒç”¨ pop æˆ–è€… peek æ“ä½œï¼‰ã€‚</li></ul><p>è§£é¢˜æ€è·¯</p><pre><code class="hljs plain"></code></pre><p><code>Java</code></p><pre><code class="hljs Java"></code></pre><p><code>Golang</code></p><pre><code class="hljs Golang"></code></pre><p><code>Python</code></p><pre><code class="hljs Python"></code></pre><h6 id="682-æ£’çƒæ¯”èµ›"><a href="#682-æ£’çƒæ¯”èµ›" class="headerlink" title="682. æ£’çƒæ¯”èµ›"></a><a href="https://leetcode-cn.com/problems/baseball-game/">682. æ£’çƒæ¯”èµ›</a></h6><p>ä½ ç°åœ¨æ˜¯ä¸€åœºé‡‡ç”¨ç‰¹æ®Šèµ›åˆ¶æ£’çƒæ¯”èµ›çš„è®°å½•å‘˜ã€‚è¿™åœºæ¯”èµ›ç”±è‹¥å¹²å›åˆç»„æˆï¼Œè¿‡å»å‡ å›åˆçš„å¾—åˆ†å¯èƒ½ä¼šå½±å“ä»¥åå‡ å›åˆçš„å¾—åˆ†ã€‚</p><p>æ¯”èµ›å¼€å§‹æ—¶ï¼Œè®°å½•æ˜¯ç©ºç™½çš„ã€‚ä½ ä¼šå¾—åˆ°ä¸€ä¸ªè®°å½•æ“ä½œçš„å­—ç¬¦ä¸²åˆ—è¡¨ <code>ops</code>ï¼Œå…¶ä¸­ <code>ops[i]</code> æ˜¯ä½ éœ€è¦è®°å½•çš„ç¬¬ <code>i</code> é¡¹æ“ä½œï¼Œ<code>ops</code> éµå¾ªä¸‹è¿°è§„åˆ™ï¼š</p><ol><li>æ•´æ•° <code>x</code> - è¡¨ç¤ºæœ¬å›åˆæ–°è·å¾—åˆ†æ•° <code>x</code></li><li><code>&quot;+&quot;</code> - è¡¨ç¤ºæœ¬å›åˆæ–°è·å¾—çš„å¾—åˆ†æ˜¯å‰ä¸¤æ¬¡å¾—åˆ†çš„æ€»å’Œã€‚é¢˜ç›®æ•°æ®ä¿è¯è®°å½•æ­¤æ“ä½œæ—¶å‰é¢æ€»æ˜¯å­˜åœ¨ä¸¤ä¸ªæœ‰æ•ˆçš„åˆ†æ•°ã€‚</li><li><code>&quot;D&quot;</code> - è¡¨ç¤ºæœ¬å›åˆæ–°è·å¾—çš„å¾—åˆ†æ˜¯å‰ä¸€æ¬¡å¾—åˆ†çš„ä¸¤å€ã€‚é¢˜ç›®æ•°æ®ä¿è¯è®°å½•æ­¤æ“ä½œæ—¶å‰é¢æ€»æ˜¯å­˜åœ¨ä¸€ä¸ªæœ‰æ•ˆçš„åˆ†æ•°ã€‚</li><li><code>&quot;C&quot;</code> - è¡¨ç¤ºå‰ä¸€æ¬¡å¾—åˆ†æ— æ•ˆï¼Œå°†å…¶ä»è®°å½•ä¸­ç§»é™¤ã€‚é¢˜ç›®æ•°æ®ä¿è¯è®°å½•æ­¤æ“ä½œæ—¶å‰é¢æ€»æ˜¯å­˜åœ¨ä¸€ä¸ªæœ‰æ•ˆçš„åˆ†æ•°ã€‚</li></ol><p>è¯·ä½ è¿”å›è®°å½•ä¸­æ‰€æœ‰å¾—åˆ†çš„æ€»å’Œã€‚</p><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><pre><code class="hljs lsl">è¾“å…¥ï¼šops = [<span class="hljs-string">&quot;5&quot;</span>,<span class="hljs-string">&quot;2&quot;</span>,<span class="hljs-string">&quot;C&quot;</span>,<span class="hljs-string">&quot;D&quot;</span>,<span class="hljs-string">&quot;+&quot;</span>]è¾“å‡ºï¼š<span class="hljs-number">30</span>è§£é‡Šï¼š<span class="hljs-string">&quot;5&quot;</span> - è®°å½•åŠ  <span class="hljs-number">5</span> ï¼Œè®°å½•ç°åœ¨æ˜¯ [<span class="hljs-number">5</span>]<span class="hljs-string">&quot;2&quot;</span> - è®°å½•åŠ  <span class="hljs-number">2</span> ï¼Œè®°å½•ç°åœ¨æ˜¯ [<span class="hljs-number">5</span>, <span class="hljs-number">2</span>]<span class="hljs-string">&quot;C&quot;</span> - ä½¿å‰ä¸€æ¬¡å¾—åˆ†çš„è®°å½•æ— æ•ˆå¹¶å°†å…¶ç§»é™¤ï¼Œè®°å½•ç°åœ¨æ˜¯ [<span class="hljs-number">5</span>].<span class="hljs-string">&quot;D&quot;</span> - è®°å½•åŠ  <span class="hljs-number">2</span> * <span class="hljs-number">5</span> = <span class="hljs-number">10</span> ï¼Œè®°å½•ç°åœ¨æ˜¯ [<span class="hljs-number">5</span>, <span class="hljs-number">10</span>].<span class="hljs-string">&quot;+&quot;</span> - è®°å½•åŠ  <span class="hljs-number">5</span> + <span class="hljs-number">10</span> = <span class="hljs-number">15</span> ï¼Œè®°å½•ç°åœ¨æ˜¯ [<span class="hljs-number">5</span>, <span class="hljs-number">10</span>, <span class="hljs-number">15</span>].æ‰€æœ‰å¾—åˆ†çš„æ€»å’Œ <span class="hljs-number">5</span> + <span class="hljs-number">10</span> + <span class="hljs-number">15</span> = <span class="hljs-number">30</span></code></pre><p><strong>ç¤ºä¾‹ 2ï¼š</strong></p><pre><code class="hljs lsl">è¾“å…¥ï¼šops = [<span class="hljs-string">&quot;5&quot;</span>,<span class="hljs-string">&quot;-2&quot;</span>,<span class="hljs-string">&quot;4&quot;</span>,<span class="hljs-string">&quot;C&quot;</span>,<span class="hljs-string">&quot;D&quot;</span>,<span class="hljs-string">&quot;9&quot;</span>,<span class="hljs-string">&quot;+&quot;</span>,<span class="hljs-string">&quot;+&quot;</span>]è¾“å‡ºï¼š<span class="hljs-number">27</span>è§£é‡Šï¼š<span class="hljs-string">&quot;5&quot;</span> - è®°å½•åŠ  <span class="hljs-number">5</span> ï¼Œè®°å½•ç°åœ¨æ˜¯ [<span class="hljs-number">5</span>]<span class="hljs-string">&quot;-2&quot;</span> - è®°å½•åŠ  <span class="hljs-number">-2</span> ï¼Œè®°å½•ç°åœ¨æ˜¯ [<span class="hljs-number">5</span>, <span class="hljs-number">-2</span>]<span class="hljs-string">&quot;4&quot;</span> - è®°å½•åŠ  <span class="hljs-number">4</span> ï¼Œè®°å½•ç°åœ¨æ˜¯ [<span class="hljs-number">5</span>, <span class="hljs-number">-2</span>, <span class="hljs-number">4</span>]<span class="hljs-string">&quot;C&quot;</span> - ä½¿å‰ä¸€æ¬¡å¾—åˆ†çš„è®°å½•æ— æ•ˆå¹¶å°†å…¶ç§»é™¤ï¼Œè®°å½•ç°åœ¨æ˜¯ [<span class="hljs-number">5</span>, <span class="hljs-number">-2</span>]<span class="hljs-string">&quot;D&quot;</span> - è®°å½•åŠ  <span class="hljs-number">2</span> * <span class="hljs-number">-2</span> = <span class="hljs-number">-4</span> ï¼Œè®°å½•ç°åœ¨æ˜¯ [<span class="hljs-number">5</span>, <span class="hljs-number">-2</span>, <span class="hljs-number">-4</span>]<span class="hljs-string">&quot;9&quot;</span> - è®°å½•åŠ  <span class="hljs-number">9</span> ï¼Œè®°å½•ç°åœ¨æ˜¯ [<span class="hljs-number">5</span>, <span class="hljs-number">-2</span>, <span class="hljs-number">-4</span>, <span class="hljs-number">9</span>]<span class="hljs-string">&quot;+&quot;</span> - è®°å½•åŠ  <span class="hljs-number">-4</span> + <span class="hljs-number">9</span> = <span class="hljs-number">5</span> ï¼Œè®°å½•ç°åœ¨æ˜¯ [<span class="hljs-number">5</span>, <span class="hljs-number">-2</span>, <span class="hljs-number">-4</span>, <span class="hljs-number">9</span>, <span class="hljs-number">5</span>]<span class="hljs-string">&quot;+&quot;</span> - è®°å½•åŠ  <span class="hljs-number">9</span> + <span class="hljs-number">5</span> = <span class="hljs-number">14</span> ï¼Œè®°å½•ç°åœ¨æ˜¯ [<span class="hljs-number">5</span>, <span class="hljs-number">-2</span>, <span class="hljs-number">-4</span>, <span class="hljs-number">9</span>, <span class="hljs-number">5</span>, <span class="hljs-number">14</span>]æ‰€æœ‰å¾—åˆ†çš„æ€»å’Œ <span class="hljs-number">5</span> + <span class="hljs-number">-2</span> + <span class="hljs-number">-4</span> + <span class="hljs-number">9</span> + <span class="hljs-number">5</span> + <span class="hljs-number">14</span> = <span class="hljs-number">27</span></code></pre><p><strong>ç¤ºä¾‹ 3ï¼š</strong></p><pre><code class="hljs lsl">è¾“å…¥ï¼šops = [<span class="hljs-string">&quot;1&quot;</span>]è¾“å‡ºï¼š<span class="hljs-number">1</span></code></pre><p><strong>æç¤ºï¼š</strong></p><ul><li><code>1 &lt;= ops.length &lt;= 1000</code></li><li><code>ops[i]</code> ä¸º <code>&quot;C&quot;</code>ã€<code>&quot;D&quot;</code>ã€<code>&quot;+&quot;</code>ï¼Œæˆ–è€…ä¸€ä¸ªè¡¨ç¤ºæ•´æ•°çš„å­—ç¬¦ä¸²ã€‚æ•´æ•°èŒƒå›´æ˜¯ <code>[-3 * 10^4, 3 * 10^4]</code></li><li>å¯¹äº <code>&quot;+&quot;</code> æ“ä½œï¼Œé¢˜ç›®æ•°æ®ä¿è¯è®°å½•æ­¤æ“ä½œæ—¶å‰é¢æ€»æ˜¯å­˜åœ¨ä¸¤ä¸ªæœ‰æ•ˆçš„åˆ†æ•°</li><li>å¯¹äº <code>&quot;C&quot;</code> å’Œ <code>&quot;D&quot;</code> æ“ä½œï¼Œé¢˜ç›®æ•°æ®ä¿è¯è®°å½•æ­¤æ“ä½œæ—¶å‰é¢æ€»æ˜¯å­˜åœ¨ä¸€ä¸ªæœ‰æ•ˆçš„åˆ†æ•°</li></ul><p>è§£é¢˜æ€è·¯</p><pre><code class="hljs plain"></code></pre><p><code>Java</code></p><pre><code class="hljs Java"></code></pre><p><code>Golang</code></p><pre><code class="hljs Golang"></code></pre><p><code>Python</code></p><pre><code class="hljs Python"></code></pre><h6 id="844-æ¯”è¾ƒå«é€€æ ¼çš„å­—ç¬¦ä¸²"><a href="#844-æ¯”è¾ƒå«é€€æ ¼çš„å­—ç¬¦ä¸²" class="headerlink" title="844. æ¯”è¾ƒå«é€€æ ¼çš„å­—ç¬¦ä¸²"></a><a href="https://leetcode-cn.com/problems/backspace-string-compare/">844. æ¯”è¾ƒå«é€€æ ¼çš„å­—ç¬¦ä¸²</a></h6><p>ç»™å®š <code>S</code> å’Œ <code>T</code> ä¸¤ä¸ªå­—ç¬¦ä¸²ï¼Œå½“å®ƒä»¬åˆ†åˆ«è¢«è¾“å…¥åˆ°ç©ºç™½çš„æ–‡æœ¬ç¼–è¾‘å™¨åï¼Œåˆ¤æ–­äºŒè€…æ˜¯å¦ç›¸ç­‰ï¼Œå¹¶è¿”å›ç»“æœã€‚ <code>#</code> ä»£è¡¨é€€æ ¼å­—ç¬¦ã€‚</p><p><strong>æ³¨æ„ï¼š</strong>å¦‚æœå¯¹ç©ºæ–‡æœ¬è¾“å…¥é€€æ ¼å­—ç¬¦ï¼Œæ–‡æœ¬ç»§ç»­ä¸ºç©ºã€‚</p><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><pre><code class="hljs livescript">è¾“å…¥ï¼šS = <span class="hljs-string">&quot;ab<span class="hljs-subst">#c</span>&quot;</span>, T = <span class="hljs-string">&quot;ad<span class="hljs-subst">#c</span>&quot;</span>è¾“å‡ºï¼š<span class="hljs-literal">true</span>è§£é‡Šï¼šS å’Œ T éƒ½ä¼šå˜æˆ â€œacâ€ã€‚</code></pre><p><strong>ç¤ºä¾‹ 2ï¼š</strong></p><pre><code class="hljs nix">è¾“å…¥ï¼š<span class="hljs-attr">S</span> = <span class="hljs-string">&quot;ab##&quot;</span>, <span class="hljs-attr">T</span> = <span class="hljs-string">&quot;c#d#&quot;</span>è¾“å‡ºï¼š<span class="hljs-literal">true</span>è§£é‡Šï¼šS å’Œ T éƒ½ä¼šå˜æˆ â€œâ€ã€‚</code></pre><p><strong>ç¤ºä¾‹ 3ï¼š</strong></p><pre><code class="hljs livescript">è¾“å…¥ï¼šS = <span class="hljs-string">&quot;a#<span class="hljs-subst">#c</span>&quot;</span>, T = <span class="hljs-string">&quot;<span class="hljs-subst">#a</span><span class="hljs-subst">#c</span>&quot;</span>è¾“å‡ºï¼š<span class="hljs-literal">true</span>è§£é‡Šï¼šS å’Œ T éƒ½ä¼šå˜æˆ â€œcâ€ã€‚</code></pre><p><strong>ç¤ºä¾‹ 4ï¼š</strong></p><pre><code class="hljs nix">è¾“å…¥ï¼š<span class="hljs-attr">S</span> = <span class="hljs-string">&quot;a#c&quot;</span>, <span class="hljs-attr">T</span> = <span class="hljs-string">&quot;b&quot;</span>è¾“å‡ºï¼š<span class="hljs-literal">false</span>è§£é‡Šï¼šS ä¼šå˜æˆ â€œcâ€ï¼Œä½† T ä»ç„¶æ˜¯ â€œbâ€ã€‚</code></pre><p><strong>æç¤ºï¼š</strong></p><ul><li><code>1 &lt;= S.length &lt;= 200</code></li><li><code>1 &lt;= T.length &lt;= 200</code></li><li><code>S</code> å’Œ <code>T</code> åªå«æœ‰å°å†™å­—æ¯ä»¥åŠå­—ç¬¦ <code>&#39;#&#39;</code>ã€‚</li></ul><p><strong>è¿›é˜¶ï¼š</strong></p><ul><li>ä½ å¯ä»¥ç”¨ <code>O(N)</code> çš„æ—¶é—´å¤æ‚åº¦å’Œ <code>O(1)</code> çš„ç©ºé—´å¤æ‚åº¦è§£å†³è¯¥é—®é¢˜å—ï¼Ÿ</li></ul><p>è§£é¢˜æ€è·¯</p><pre><code class="hljs plain"></code></pre><p><code>Java</code></p><pre><code class="hljs Java"></code></pre><p><code>Golang</code></p><pre><code class="hljs Golang"></code></pre><p><code>Python</code></p><pre><code class="hljs Python"></code></pre><h6 id="946-éªŒè¯æ ˆåºåˆ—"><a href="#946-éªŒè¯æ ˆåºåˆ—" class="headerlink" title="946. éªŒè¯æ ˆåºåˆ—"></a><a href="https://leetcode-cn.com/problems/validate-stack-sequences/">946. éªŒè¯æ ˆåºåˆ—</a></h6><p>ç»™å®š pushed å’Œ popped ä¸¤ä¸ªåºåˆ—ï¼Œæ¯ä¸ªåºåˆ—ä¸­çš„ å€¼éƒ½ä¸é‡å¤ï¼Œåªæœ‰å½“å®ƒä»¬å¯èƒ½æ˜¯åœ¨æœ€åˆç©ºæ ˆä¸Šè¿›è¡Œçš„æ¨å…¥ push å’Œå¼¹å‡º pop æ“ä½œåºåˆ—çš„ç»“æœæ—¶ï¼Œè¿”å› trueï¼›å¦åˆ™ï¼Œè¿”å› false ã€‚</p><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><pre><code class="hljs livescript">è¾“å…¥ï¼špushed = [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>], popped = [<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">3</span>,<span class="hljs-number">2</span>,<span class="hljs-number">1</span>]è¾“å‡ºï¼š<span class="hljs-literal">true</span>è§£é‡Šï¼šæˆ‘ä»¬å¯ä»¥æŒ‰ä»¥ä¸‹é¡ºåºæ‰§è¡Œï¼špush<span class="hljs-function"><span class="hljs-params">(<span class="hljs-number">1</span>)</span>, <span class="hljs-title">push</span><span class="hljs-params">(<span class="hljs-number">2</span>)</span>, <span class="hljs-title">push</span><span class="hljs-params">(<span class="hljs-number">3</span>)</span>, <span class="hljs-title">push</span><span class="hljs-params">(<span class="hljs-number">4</span>)</span>, <span class="hljs-title">pop</span><span class="hljs-params">()</span> -&gt;</span> <span class="hljs-number">4</span>,push<span class="hljs-function"><span class="hljs-params">(<span class="hljs-number">5</span>)</span>, <span class="hljs-title">pop</span><span class="hljs-params">()</span> -&gt;</span> <span class="hljs-number">5</span>, pop<span class="hljs-function"><span class="hljs-params">()</span> -&gt;</span> <span class="hljs-number">3</span>, pop<span class="hljs-function"><span class="hljs-params">()</span> -&gt;</span> <span class="hljs-number">2</span>, pop<span class="hljs-function"><span class="hljs-params">()</span> -&gt;</span> <span class="hljs-number">1</span></code></pre><p><strong>ç¤ºä¾‹ 2ï¼š</strong></p><pre><code class="hljs angelscript">è¾“å…¥ï¼špushed = [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>], popped = [<span class="hljs-number">4</span>,<span class="hljs-number">3</span>,<span class="hljs-number">5</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>]è¾“å‡ºï¼š<span class="hljs-literal">false</span>è§£é‡Šï¼š<span class="hljs-number">1</span> ä¸èƒ½åœ¨ <span class="hljs-number">2</span> ä¹‹å‰å¼¹å‡ºã€‚</code></pre><p>æç¤ºï¼š</p><p><code>0 &lt;= pushed.length == popped.length &lt;= 1000</code><br><code>0 &lt;= pushed[i], popped[i] &lt; 1000</code><br><code>pushed</code> æ˜¯ <code>popped </code>çš„æ’åˆ—ã€‚</p><p>è§£é¢˜æ€è·¯</p><pre><code class="hljs plain"></code></pre><p><code>Java</code></p><pre><code class="hljs Java"></code></pre><p><code>Golang</code></p><pre><code class="hljs Golang"></code></pre><p><code>Python</code></p><pre><code class="hljs Python"></code></pre><h6 id><a href="#" class="headerlink" title></a></h6><h5 id="æ ˆç»“æ„æ‰©å±•åº”ç”¨"><a href="#æ ˆç»“æ„æ‰©å±•åº”ç”¨" class="headerlink" title="æ ˆç»“æ„æ‰©å±•åº”ç”¨"></a>æ ˆç»“æ„æ‰©å±•åº”ç”¨</h5><h6 id="20-æœ‰æ•ˆçš„æ‹¬å·"><a href="#20-æœ‰æ•ˆçš„æ‹¬å·" class="headerlink" title="20. æœ‰æ•ˆçš„æ‹¬å·"></a><a href="https://leetcode-cn.com/problems/valid-parentheses/">20. æœ‰æ•ˆçš„æ‹¬å·</a></h6><p>ç»™å®šä¸€ä¸ªåªåŒ…æ‹¬ <code>&#39;(&#39;ï¼Œ&#39;)&#39;ï¼Œ&#39;&#123;&#39;ï¼Œ&#39;&#125;&#39;ï¼Œ&#39;[&#39;ï¼Œ&#39;]&#39; </code>çš„å­—ç¬¦ä¸² s ï¼Œåˆ¤æ–­å­—ç¬¦ä¸²æ˜¯å¦æœ‰æ•ˆã€‚</p><p>æœ‰æ•ˆå­—ç¬¦ä¸²éœ€æ»¡è¶³ï¼š</p><p>å·¦æ‹¬å·å¿…é¡»ç”¨ç›¸åŒç±»å‹çš„å³æ‹¬å·é—­åˆã€‚<br>å·¦æ‹¬å·å¿…é¡»ä»¥æ­£ç¡®çš„é¡ºåºé—­åˆã€‚</p><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><pre><code class="hljs nix">è¾“å…¥ï¼š<span class="hljs-attr">s</span> = <span class="hljs-string">&quot;()&quot;</span>è¾“å‡ºï¼š<span class="hljs-literal">true</span></code></pre><p><strong>ç¤ºä¾‹ 2ï¼š</strong></p><pre><code class="hljs nix">è¾“å…¥ï¼š<span class="hljs-attr">s</span> = <span class="hljs-string">&quot;()[]&#123;&#125;&quot;</span>è¾“å‡ºï¼š<span class="hljs-literal">true</span></code></pre><p><strong>ç¤ºä¾‹ 3ï¼š</strong></p><pre><code class="hljs nix">è¾“å…¥ï¼š<span class="hljs-attr">s</span> = <span class="hljs-string">&quot;(]&quot;</span>è¾“å‡ºï¼š<span class="hljs-literal">false</span></code></pre><p><strong>ç¤ºä¾‹ 4ï¼š</strong></p><pre><code class="hljs nix">è¾“å…¥ï¼š<span class="hljs-attr">s</span> = <span class="hljs-string">&quot;([)]&quot;</span>è¾“å‡ºï¼š<span class="hljs-literal">false</span></code></pre><p><strong>ç¤ºä¾‹ 5ï¼š</strong></p><pre><code class="hljs nix">è¾“å…¥ï¼š<span class="hljs-attr">s</span> = <span class="hljs-string">&quot;&#123;[]&#125;&quot;</span>è¾“å‡ºï¼š<span class="hljs-literal">true</span></code></pre><p><strong>æç¤ºï¼š</strong></p><ul><li><code>1 &lt;= s.length &lt;= 104</code></li><li><code>s</code> ä»…ç”±æ‹¬å· <code>&#39;()[]&#123;&#125;&#39;</code> ç»„æˆ</li></ul><p>è§£é¢˜æ€è·¯</p><pre><code class="hljs plain"></code></pre><p><code>Java</code></p><pre><code class="hljs Java"></code></pre><p><code>Golang</code></p><pre><code class="hljs Golang"></code></pre><p><code>Python</code></p><pre><code class="hljs Python"></code></pre><h6 id="1021-åˆ é™¤æœ€å¤–å±‚çš„æ‹¬å·"><a href="#1021-åˆ é™¤æœ€å¤–å±‚çš„æ‹¬å·" class="headerlink" title="1021. åˆ é™¤æœ€å¤–å±‚çš„æ‹¬å·"></a><a href="https://leetcode-cn.com/problems/remove-outermost-parentheses/">1021. åˆ é™¤æœ€å¤–å±‚çš„æ‹¬å·</a></h6><p>æœ‰æ•ˆæ‹¬å·å­—ç¬¦ä¸²ä¸ºç©º <code>(&quot;&quot;)</code>ã€<code>&quot;(&quot; + A + &quot;)&quot;</code> æˆ– <code>A + B</code>ï¼Œå…¶ä¸­ <code>A</code> å’Œ <code>B</code> éƒ½æ˜¯æœ‰æ•ˆçš„æ‹¬å·å­—ç¬¦ä¸²ï¼Œ<code>+</code> ä»£è¡¨å­—ç¬¦ä¸²çš„è¿æ¥ã€‚ä¾‹å¦‚ï¼Œ<code>&quot;&quot;</code>ï¼Œ<code>&quot;()&quot;</code>ï¼Œ<code>&quot;(())()&quot;</code> å’Œ <code>&quot;(()(()))&quot;</code> éƒ½æ˜¯æœ‰æ•ˆçš„æ‹¬å·å­—ç¬¦ä¸²ã€‚</p><p>å¦‚æœæœ‰æ•ˆå­—ç¬¦ä¸² <code>S</code> éç©ºï¼Œä¸”ä¸å­˜åœ¨å°†å…¶æ‹†åˆ†ä¸º <code>S = A+B</code> çš„æ–¹æ³•ï¼Œæˆ‘ä»¬ç§°å…¶ä¸º<strong>åŸè¯­ï¼ˆprimitiveï¼‰</strong>ï¼Œå…¶ä¸­ <code>A</code> å’Œ <code>B</code> éƒ½æ˜¯éç©ºæœ‰æ•ˆæ‹¬å·å­—ç¬¦ä¸²ã€‚</p><p>ç»™å‡ºä¸€ä¸ªéç©ºæœ‰æ•ˆå­—ç¬¦ä¸² <code>S</code>ï¼Œè€ƒè™‘å°†å…¶è¿›è¡ŒåŸè¯­åŒ–åˆ†è§£ï¼Œä½¿å¾—ï¼š<code>S = P_1 + P_2 + ... + P_k</code>ï¼Œå…¶ä¸­ <code>P_i</code> æ˜¯æœ‰æ•ˆæ‹¬å·å­—ç¬¦ä¸²åŸè¯­ã€‚</p><p>å¯¹ <code>S</code> è¿›è¡ŒåŸè¯­åŒ–åˆ†è§£ï¼Œåˆ é™¤åˆ†è§£ä¸­æ¯ä¸ªåŸè¯­å­—ç¬¦ä¸²çš„æœ€å¤–å±‚æ‹¬å·ï¼Œè¿”å› <code>S</code>ã€‚</p><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><pre><code class="hljs 1c">è¾“å…¥ï¼š<span class="hljs-string">&quot;(()())(())&quot;</span>è¾“å‡ºï¼š<span class="hljs-string">&quot;()()()&quot;</span>è§£é‡Šï¼šè¾“å…¥å­—ç¬¦ä¸²ä¸º <span class="hljs-string">&quot;(()())(())&quot;</span>ï¼ŒåŸè¯­åŒ–åˆ†è§£å¾—åˆ° <span class="hljs-string">&quot;(()())&quot;</span> + <span class="hljs-string">&quot;(())&quot;</span>ï¼Œåˆ é™¤æ¯ä¸ªéƒ¨åˆ†ä¸­çš„æœ€å¤–å±‚æ‹¬å·åå¾—åˆ° <span class="hljs-string">&quot;()()&quot;</span> + <span class="hljs-string">&quot;()&quot;</span> = <span class="hljs-string">&quot;()()()&quot;</span>ã€‚</code></pre><p><strong>ç¤ºä¾‹ 2ï¼š</strong></p><pre><code class="hljs 1c">è¾“å…¥ï¼š<span class="hljs-string">&quot;(()())(())(()(()))&quot;</span>è¾“å‡ºï¼š<span class="hljs-string">&quot;()()()()(())&quot;</span>è§£é‡Šï¼šè¾“å…¥å­—ç¬¦ä¸²ä¸º <span class="hljs-string">&quot;(()())(())(()(()))&quot;</span>ï¼ŒåŸè¯­åŒ–åˆ†è§£å¾—åˆ° <span class="hljs-string">&quot;(()())&quot;</span> + <span class="hljs-string">&quot;(())&quot;</span> + <span class="hljs-string">&quot;(()(()))&quot;</span>ï¼Œåˆ é™¤æ¯ä¸ªéƒ¨åˆ†ä¸­çš„æœ€å¤–å±‚æ‹¬å·åå¾—åˆ° <span class="hljs-string">&quot;()()&quot;</span> + <span class="hljs-string">&quot;()&quot;</span> + <span class="hljs-string">&quot;()(())&quot;</span> = <span class="hljs-string">&quot;()()()()(())&quot;</span>ã€‚</code></pre><p><strong>ç¤ºä¾‹ 3ï¼š</strong></p><pre><code class="hljs 1c">è¾“å…¥ï¼š<span class="hljs-string">&quot;()()&quot;</span>è¾“å‡ºï¼š<span class="hljs-string">&quot;&quot;</span>è§£é‡Šï¼šè¾“å…¥å­—ç¬¦ä¸²ä¸º <span class="hljs-string">&quot;()()&quot;</span>ï¼ŒåŸè¯­åŒ–åˆ†è§£å¾—åˆ° <span class="hljs-string">&quot;()&quot;</span> + <span class="hljs-string">&quot;()&quot;</span>ï¼Œåˆ é™¤æ¯ä¸ªéƒ¨åˆ†ä¸­çš„æœ€å¤–å±‚æ‹¬å·åå¾—åˆ° <span class="hljs-string">&quot;&quot;</span> + <span class="hljs-string">&quot;&quot;</span> = <span class="hljs-string">&quot;&quot;</span>ã€‚</code></pre><p><strong>æç¤ºï¼š</strong></p><ol><li><code>S.length &lt;= 10000</code></li><li><code>S[i]</code> ä¸º <code>&quot;(&quot;</code> æˆ– <code>&quot;)&quot;</code></li><li><code>S</code> æ˜¯ä¸€ä¸ªæœ‰æ•ˆæ‹¬å·å­—ç¬¦ä¸²</li></ol><p>è§£é¢˜æ€è·¯</p><pre><code class="hljs plain"></code></pre><p><code>Java</code></p><pre><code class="hljs Java"></code></pre><p><code>Golang</code></p><pre><code class="hljs Golang"></code></pre><p><code>Python</code></p><pre><code class="hljs Python"></code></pre><h6 id="1249-ç§»é™¤æ— æ•ˆçš„æ‹¬å·"><a href="#1249-ç§»é™¤æ— æ•ˆçš„æ‹¬å·" class="headerlink" title="1249. ç§»é™¤æ— æ•ˆçš„æ‹¬å·"></a><a href="https://leetcode-cn.com/problems/minimum-remove-to-make-valid-parentheses/">1249. ç§»é™¤æ— æ•ˆçš„æ‹¬å·</a></h6><p>ç»™ä½ ä¸€ä¸ªç”± <code>&#39;(&#39;</code>ã€<code>&#39;)&#39;</code> å’Œå°å†™å­—æ¯ç»„æˆçš„å­—ç¬¦ä¸² <code>s</code>ã€‚</p><p>ä½ éœ€è¦ä»å­—ç¬¦ä¸²ä¸­åˆ é™¤æœ€å°‘æ•°ç›®çš„ <code>&#39;(&#39;</code> æˆ–è€… <code>&#39;)&#39;</code> ï¼ˆå¯ä»¥åˆ é™¤ä»»æ„ä½ç½®çš„æ‹¬å·)ï¼Œä½¿å¾—å‰©ä¸‹çš„ã€Œæ‹¬å·å­—ç¬¦ä¸²ã€æœ‰æ•ˆã€‚</p><p>è¯·è¿”å›ä»»æ„ä¸€ä¸ªåˆæ³•å­—ç¬¦ä¸²ã€‚</p><p>æœ‰æ•ˆã€Œæ‹¬å·å­—ç¬¦ä¸²ã€åº”å½“ç¬¦åˆä»¥ä¸‹ <strong>ä»»æ„ä¸€æ¡</strong> è¦æ±‚:</p><ul><li>ç©ºå­—ç¬¦ä¸²æˆ–åªåŒ…å«å°å†™å­—æ¯çš„å­—ç¬¦ä¸²</li><li>å¯ä»¥è¢«å†™ä½œ <code>AB</code>ï¼ˆ<code>A</code> è¿æ¥ <code>B</code>ï¼‰çš„å­—ç¬¦ä¸²ï¼Œå…¶ä¸­ <code>A</code> å’Œ <code>B</code> éƒ½æ˜¯æœ‰æ•ˆã€Œæ‹¬å·å­—ç¬¦ä¸²ã€</li><li>å¯ä»¥è¢«å†™ä½œ <code>(A)</code> çš„å­—ç¬¦ä¸²ï¼Œå…¶ä¸­ <code>A</code> æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„ã€Œæ‹¬å·å­—ç¬¦ä¸²ã€</li></ul><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><pre><code class="hljs nix">è¾“å…¥ï¼š<span class="hljs-attr">s</span> = <span class="hljs-string">&quot;lee(t(c)o)de)&quot;</span>è¾“å‡ºï¼š<span class="hljs-string">&quot;lee(t(c)o)de&quot;</span>è§£é‡Šï¼š<span class="hljs-string">&quot;lee(t(co)de)&quot;</span> , <span class="hljs-string">&quot;lee(t(c)ode)&quot;</span> ä¹Ÿæ˜¯ä¸€ä¸ªå¯è¡Œç­”æ¡ˆã€‚</code></pre><p><strong>ç¤ºä¾‹ 2ï¼š</strong></p><pre><code class="hljs nix">è¾“å…¥ï¼š<span class="hljs-attr">s</span> = <span class="hljs-string">&quot;a)b(c)d&quot;</span>è¾“å‡ºï¼š<span class="hljs-string">&quot;ab(c)d&quot;</span></code></pre><p><strong>ç¤ºä¾‹ 3ï¼š</strong></p><pre><code class="hljs nix">è¾“å…¥ï¼š<span class="hljs-attr">s</span> = <span class="hljs-string">&quot;))((&quot;</span>è¾“å‡ºï¼š<span class="hljs-string">&quot;&quot;</span>è§£é‡Šï¼šç©ºå­—ç¬¦ä¸²ä¹Ÿæ˜¯æœ‰æ•ˆçš„</code></pre><p><strong>ç¤ºä¾‹ 4ï¼š</strong></p><pre><code class="hljs smalltalk">è¾“å…¥ï¼šs = <span class="hljs-comment">&quot;(a(b(c)d)&quot;</span>è¾“å‡ºï¼š<span class="hljs-comment">&quot;a(b(c)d)&quot;</span></code></pre><p><strong>æç¤ºï¼š</strong></p><ul><li><code>1 &lt;= s.length &lt;= 10^5</code></li><li><code>s[i]</code> å¯èƒ½æ˜¯ <code>&#39;(&#39;</code>ã€<code>&#39;)&#39;</code> æˆ–è‹±æ–‡å°å†™å­—æ¯</li></ul><p>è§£é¢˜æ€è·¯</p><pre><code class="hljs plain"></code></pre><p><code>Java</code></p><pre><code class="hljs Java"></code></pre><p><code>Golang</code></p><pre><code class="hljs Golang"></code></pre><p><code>Python</code></p><pre><code class="hljs Python"></code></pre><h6 id="145-äºŒå‰æ ‘çš„ååºéå†"><a href="#145-äºŒå‰æ ‘çš„ååºéå†" class="headerlink" title="145. äºŒå‰æ ‘çš„ååºéå†"></a><a href="https://leetcode-cn.com/problems/binary-tree-postorder-traversal/">145. äºŒå‰æ ‘çš„ååºéå†</a></h6><p>ç»™å®šä¸€ä¸ªäºŒå‰æ ‘ï¼Œè¿”å›å®ƒçš„ <em>ååº</em> éå†ã€‚</p><p><strong>ç¤ºä¾‹:</strong></p><pre><code class="hljs yaml"><span class="hljs-string">è¾“å…¥:</span> [<span class="hljs-number">1</span>,<span class="hljs-literal">null</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>]     <span class="hljs-number">1</span>    <span class="hljs-string">\</span>     <span class="hljs-number">2</span>    <span class="hljs-string">/</span>   <span class="hljs-number">3</span> <span class="hljs-string">è¾“å‡º:</span> [<span class="hljs-number">3</span>,<span class="hljs-number">2</span>,<span class="hljs-number">1</span>]</code></pre><p><strong>è¿›é˜¶:</strong> é€’å½’ç®—æ³•å¾ˆç®€å•ï¼Œä½ å¯ä»¥é€šè¿‡è¿­ä»£ç®—æ³•å®Œæˆå—ï¼Ÿ</p><p>è§£é¢˜æ€è·¯</p><pre><code class="hljs plain"></code></pre><p><code>Java</code></p><pre><code class="hljs Java"></code></pre><p><code>Golang</code></p><pre><code class="hljs Golang"></code></pre><p><code>Python</code></p><pre><code class="hljs Python"></code></pre><h6 id="331-éªŒè¯äºŒå‰æ ‘çš„å‰åºåºåˆ—åŒ–"><a href="#331-éªŒè¯äºŒå‰æ ‘çš„å‰åºåºåˆ—åŒ–" class="headerlink" title="331. éªŒè¯äºŒå‰æ ‘çš„å‰åºåºåˆ—åŒ–"></a><a href="https://leetcode-cn.com/problems/verify-preorder-serialization-of-a-binary-tree/">331. éªŒè¯äºŒå‰æ ‘çš„å‰åºåºåˆ—åŒ–</a></h6><p>åºåˆ—åŒ–äºŒå‰æ ‘çš„ä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨å‰åºéå†ã€‚å½“æˆ‘ä»¬é‡åˆ°ä¸€ä¸ªéç©ºèŠ‚ç‚¹æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥è®°å½•ä¸‹è¿™ä¸ªèŠ‚ç‚¹çš„å€¼ã€‚å¦‚æœå®ƒæ˜¯ä¸€ä¸ªç©ºèŠ‚ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€ä¸ªæ ‡è®°å€¼è®°å½•ï¼Œä¾‹å¦‚ <code>#</code>ã€‚</p><pre><code class="hljs livescript">     _9_    /   <span class="hljs-string">\</span>   <span class="hljs-number">3</span>     <span class="hljs-number">2</span>  / <span class="hljs-string">\</span>   / <span class="hljs-string">\</span> <span class="hljs-number">4</span>   <span class="hljs-number">1</span>  <span class="hljs-comment">#  6</span>/ <span class="hljs-string">\</span> / <span class="hljs-string">\</span>   / <span class="hljs-string">\</span><span class="hljs-comment"># # # #   # #</span></code></pre><p>ä¾‹å¦‚ï¼Œä¸Šé¢çš„äºŒå‰æ ‘å¯ä»¥è¢«åºåˆ—åŒ–ä¸ºå­—ç¬¦ä¸² <code>&quot;9,3,4,#,#,1,#,#,2,#,6,#,#&quot;</code>ï¼Œå…¶ä¸­ <code>#</code> ä»£è¡¨ä¸€ä¸ªç©ºèŠ‚ç‚¹ã€‚</p><p>ç»™å®šä¸€ä¸²ä»¥é€—å·åˆ†éš”çš„åºåˆ—ï¼ŒéªŒè¯å®ƒæ˜¯å¦æ˜¯æ­£ç¡®çš„äºŒå‰æ ‘çš„å‰åºåºåˆ—åŒ–ã€‚ç¼–å†™ä¸€ä¸ªåœ¨ä¸é‡æ„æ ‘çš„æ¡ä»¶ä¸‹çš„å¯è¡Œç®—æ³•ã€‚</p><p>æ¯ä¸ªä»¥é€—å·åˆ†éš”çš„å­—ç¬¦æˆ–ä¸ºä¸€ä¸ªæ•´æ•°æˆ–ä¸ºä¸€ä¸ªè¡¨ç¤º null æŒ‡é’ˆçš„<code>&#39;#&#39;</code>ã€‚</p><p>ä½ å¯ä»¥è®¤ä¸ºè¾“å…¥æ ¼å¼æ€»æ˜¯æœ‰æ•ˆçš„ï¼Œä¾‹å¦‚å®ƒæ°¸è¿œä¸ä¼šåŒ…å«ä¸¤ä¸ªè¿ç»­çš„é€—å·ï¼Œæ¯”å¦‚<code>&quot;1,,3&quot;</code>ã€‚</p><p><strong>ç¤ºä¾‹ 1:</strong></p><pre><code class="hljs actionscript">è¾“å…¥: <span class="hljs-string">&quot;9,3,4,#,#,1,#,#,2,#,6,#,#&quot;</span>è¾“å‡º: <span class="hljs-literal">true</span></code></pre><p><strong>ç¤ºä¾‹ 2:</strong></p><pre><code class="hljs actionscript">è¾“å…¥: <span class="hljs-string">&quot;1,#&quot;</span>è¾“å‡º: <span class="hljs-literal">false</span></code></pre><p><strong>ç¤ºä¾‹ 3:</strong></p><pre><code class="hljs actionscript">è¾“å…¥: <span class="hljs-string">&quot;9,#,#,1&quot;</span>è¾“å‡º: <span class="hljs-literal">false</span></code></pre><p>è§£é¢˜æ€è·¯</p><pre><code class="hljs plain"></code></pre><p><code>Java</code></p><pre><code class="hljs Java"></code></pre><p><code>Golang</code></p><pre><code class="hljs Golang"></code></pre><p><code>Python</code></p><pre><code class="hljs Python"></code></pre><h6 id="636-å‡½æ•°çš„ç‹¬å æ—¶é—´"><a href="#636-å‡½æ•°çš„ç‹¬å æ—¶é—´" class="headerlink" title="636. å‡½æ•°çš„ç‹¬å æ—¶é—´"></a><a href="https://leetcode-cn.com/problems/exclusive-time-of-functions/">636. å‡½æ•°çš„ç‹¬å æ—¶é—´</a></h6><p>ç»™å‡ºä¸€ä¸ªéæŠ¢å å•çº¿ç¨‹CPUçš„ <strong>n</strong> ä¸ªå‡½æ•°è¿è¡Œæ—¥å¿—ï¼Œæ‰¾åˆ°å‡½æ•°çš„ç‹¬å æ—¶é—´ã€‚</p><p>æ¯ä¸ªå‡½æ•°éƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„ Idï¼Œä» <strong>0</strong> åˆ° <strong>n-1</strong>ï¼Œå‡½æ•°å¯èƒ½ä¼šé€’å½’è°ƒç”¨æˆ–è€…è¢«å…¶ä»–å‡½æ•°è°ƒç”¨ã€‚</p><p>æ—¥å¿—æ˜¯å…·æœ‰ä»¥ä¸‹æ ¼å¼çš„å­—ç¬¦ä¸²ï¼š<code>function_idï¼šstart_or_endï¼štimestampã€‚</code>ä¾‹å¦‚ï¼š<code>&quot;0:start:0&quot;</code> è¡¨ç¤ºå‡½æ•° 0 ä» 0 æ—¶åˆ»å¼€å§‹è¿è¡Œã€‚<code>&quot;0:end:0&quot;</code> è¡¨ç¤ºå‡½æ•° 0 åœ¨ 0 æ—¶åˆ»ç»“æŸã€‚</p><p>å‡½æ•°çš„ç‹¬å æ—¶é—´å®šä¹‰æ˜¯åœ¨è¯¥æ–¹æ³•ä¸­èŠ±è´¹çš„æ—¶é—´ï¼Œè°ƒç”¨å…¶ä»–å‡½æ•°èŠ±è´¹çš„æ—¶é—´ä¸ç®—è¯¥å‡½æ•°çš„ç‹¬å æ—¶é—´ã€‚ä½ éœ€è¦æ ¹æ®å‡½æ•°çš„ Id æœ‰åºåœ°è¿”å›æ¯ä¸ªå‡½æ•°çš„ç‹¬å æ—¶é—´ã€‚</p><p><strong>ç¤ºä¾‹ 1:</strong></p><pre><code class="hljs angelscript">è¾“å…¥:n = <span class="hljs-number">2</span>logs = <span class="hljs-string">[&quot;0:start:0&quot;,</span><span class="hljs-string"> &quot;1:start:2&quot;,</span><span class="hljs-string"> &quot;1:end:5&quot;,</span><span class="hljs-string"> &quot;0:end:6&quot;]</span>è¾“å‡º:[<span class="hljs-number">3</span>, <span class="hljs-number">4</span>]è¯´æ˜ï¼šå‡½æ•° <span class="hljs-number">0</span> åœ¨æ—¶åˆ» <span class="hljs-number">0</span> å¼€å§‹ï¼Œåœ¨æ‰§è¡Œäº†  <span class="hljs-number">2</span>ä¸ªæ—¶é—´å•ä½ç»“æŸäºæ—¶åˆ» <span class="hljs-number">1</span>ã€‚ç°åœ¨å‡½æ•° <span class="hljs-number">0</span> è°ƒç”¨å‡½æ•° <span class="hljs-number">1</span>ï¼Œå‡½æ•° <span class="hljs-number">1</span> åœ¨æ—¶åˆ» <span class="hljs-number">2</span> å¼€å§‹ï¼Œæ‰§è¡Œ <span class="hljs-number">4</span> ä¸ªæ—¶é—´å•ä½åç»“æŸäºæ—¶åˆ» <span class="hljs-number">5</span>ã€‚å‡½æ•° <span class="hljs-number">0</span> å†æ¬¡åœ¨æ—¶åˆ» <span class="hljs-number">6</span> å¼€å§‹æ‰§è¡Œï¼Œå¹¶åœ¨æ—¶åˆ» <span class="hljs-number">6</span> ç»“æŸè¿è¡Œï¼Œä»è€Œæ‰§è¡Œäº† <span class="hljs-number">1</span> ä¸ªæ—¶é—´å•ä½ã€‚æ‰€ä»¥å‡½æ•° <span class="hljs-number">0</span> æ€»å…±çš„æ‰§è¡Œäº† <span class="hljs-number">2</span> +<span class="hljs-number">1</span> =<span class="hljs-number">3</span> ä¸ªæ—¶é—´å•ä½ï¼Œå‡½æ•° <span class="hljs-number">1</span> æ€»å…±æ‰§è¡Œäº† <span class="hljs-number">4</span> ä¸ªæ—¶é—´å•ä½ã€‚</code></pre><p>è¯´æ˜ï¼š</p><ol><li>è¾“å…¥çš„æ—¥å¿—ä¼šæ ¹æ®æ—¶é—´æˆ³æ’åºï¼Œè€Œä¸æ˜¯æ ¹æ®æ—¥å¿—Idæ’åºã€‚</li><li>ä½ çš„è¾“å‡ºä¼šæ ¹æ®å‡½æ•°Idæ’åºï¼Œä¹Ÿå°±æ„å‘³ç€ä½ çš„è¾“å‡ºæ•°ç»„ä¸­åºå·ä¸º 0 çš„å…ƒç´ ç›¸å½“äºå‡½æ•° 0 çš„æ‰§è¡Œæ—¶é—´ã€‚</li><li>ä¸¤ä¸ªå‡½æ•°ä¸ä¼šåœ¨åŒæ—¶å¼€å§‹æˆ–ç»“æŸã€‚</li><li>å‡½æ•°å…è®¸è¢«é€’å½’è°ƒç”¨ï¼Œç›´åˆ°è¿è¡Œç»“æŸã€‚</li><li>1 &lt;= n &lt;= 100</li></ol><p>è§£é¢˜æ€è·¯</p><pre><code class="hljs plain"></code></pre><p><code>Java</code></p><pre><code class="hljs Java"></code></pre><p><code>Golang</code></p><pre><code class="hljs Golang"></code></pre><p><code>Python</code></p><pre><code class="hljs Python"></code></pre><h5 id="-1"><a href="#-1" class="headerlink" title></a></h5><h6 id="1124-è¡¨ç°è‰¯å¥½çš„æœ€é•¿æ—¶é—´æ®µ"><a href="#1124-è¡¨ç°è‰¯å¥½çš„æœ€é•¿æ—¶é—´æ®µ" class="headerlink" title="1124. è¡¨ç°è‰¯å¥½çš„æœ€é•¿æ—¶é—´æ®µ"></a><a href="https://leetcode-cn.com/problems/longest-well-performing-interval/">1124. è¡¨ç°è‰¯å¥½çš„æœ€é•¿æ—¶é—´æ®µ</a></h6><p>ç»™ä½ ä¸€ä»½å·¥ä½œæ—¶é—´è¡¨ <code>hours</code>ï¼Œä¸Šé¢è®°å½•ç€æŸä¸€ä½å‘˜å·¥æ¯å¤©çš„å·¥ä½œå°æ—¶æ•°ã€‚</p><p>æˆ‘ä»¬è®¤ä¸ºå½“å‘˜å·¥ä¸€å¤©ä¸­çš„å·¥ä½œå°æ—¶æ•°å¤§äº <code>8</code> å°æ—¶çš„æ—¶å€™ï¼Œé‚£ä¹ˆè¿™ä¸€å¤©å°±æ˜¯ã€Œ<strong>åŠ³ç´¯çš„ä¸€å¤©</strong>ã€ã€‚</p><p>æ‰€è°“ã€Œè¡¨ç°è‰¯å¥½çš„æ—¶é—´æ®µã€ï¼Œæ„å‘³åœ¨è¿™æ®µæ—¶é—´å†…ï¼Œã€ŒåŠ³ç´¯çš„å¤©æ•°ã€æ˜¯ä¸¥æ ¼ <strong>å¤§äº</strong>ã€Œä¸åŠ³ç´¯çš„å¤©æ•°ã€ã€‚</p><p>è¯·ä½ è¿”å›ã€Œè¡¨ç°è‰¯å¥½æ—¶é—´æ®µã€çš„æœ€å¤§é•¿åº¦ã€‚</p><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><pre><code class="hljs angelscript">è¾“å…¥ï¼šhours = [<span class="hljs-number">9</span>,<span class="hljs-number">9</span>,<span class="hljs-number">6</span>,<span class="hljs-number">0</span>,<span class="hljs-number">6</span>,<span class="hljs-number">6</span>,<span class="hljs-number">9</span>]è¾“å‡ºï¼š<span class="hljs-number">3</span>è§£é‡Šï¼šæœ€é•¿çš„è¡¨ç°è‰¯å¥½æ—¶é—´æ®µæ˜¯ [<span class="hljs-number">9</span>,<span class="hljs-number">9</span>,<span class="hljs-number">6</span>]ã€‚</code></pre><p><strong>æç¤ºï¼š</strong></p><ul><li><code>1 &lt;= hours.length &lt;= 10000</code></li><li><code>0 &lt;= hours[i] &lt;= 16</code></li></ul><p>è§£é¢˜æ€è·¯</p><pre><code class="hljs plain"></code></pre><p><code>Java</code></p><pre><code class="hljs Java"></code></pre><p><code>Golang</code></p><pre><code class="hljs Golang"></code></pre><p><code>Python</code></p><pre><code class="hljs Python"></code></pre>]]></content>
    
    
    <categories>
      
      <category>Leetcode</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Python</tag>
      
      <tag>Go</tag>
      
      <tag>Java</tag>
      
      <tag>LeetCode</tag>
      
      <tag>scala</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€Goã€‘å­¦ä¹ ç¬”è®°</title>
    <link href="/2021/02/07/golang/"/>
    <url>/2021/02/07/golang/</url>
    
    <content type="html"><![CDATA[<blockquote><p> â€œGo has indeed become the language of cloud infrastructureâ€ - Rob Pike interview<a id="more"></a></p></blockquote><h3 id="å˜é‡"><a href="#å˜é‡" class="headerlink" title="å˜é‡"></a>å˜é‡</h3><h4 id="varä¸"><a href="#varä¸" class="headerlink" title="varä¸:="></a>varä¸:=</h4><ul><li>:=æ–¹å¼è¾ƒä¸ºç®€æ´ï¼Œä½†åªèƒ½åœ¨å‡½æ•°å†…ä½¿ç”¨è¯¥æ–¹å¼ï¼Œvaræ–¹å¼æ²¡æœ‰è¿™ä¸ªé™åˆ¶ï¼Œvaræ–¹å¼å®šä¹‰åœ¨æ±‰ä¹¦å¤–çš„å˜é‡å±äºåŒ…å†…éƒ¨çš„å˜é‡</li><li>å‡½æ•°ä¸­ä»¥:=æ–¹å¼å®šä¹‰å˜é‡ä¸ºä¸»</li></ul><h4 id="å†…å»ºå˜é‡ç±»å‹"><a href="#å†…å»ºå˜é‡ç±»å‹" class="headerlink" title="å†…å»ºå˜é‡ç±»å‹"></a>å†…å»ºå˜é‡ç±»å‹</h4><ul><li>bool,string</li><li>(u)int, (u)int8, (u)int16, (u)int32, (u)int, uintptr</li><li>byte, rune</li><li>float32, float64, complex64, complex128</li><li>å˜é‡ç±»å‹å†™åœ¨å˜é‡åä¹‹å</li><li>ç¼–è¯‘å™¨å¯æ¨æµ‹å˜é‡ç±»å‹</li><li>æ²¡æœ‰char, åªæœ‰rune</li><li>åŸç”Ÿæ”¯æŒå¤æ•°ç±»å‹</li></ul><pre><code class="hljs golang"><span class="hljs-keyword">package</span> main<span class="hljs-keyword">import</span> (<span class="hljs-string">&quot;fmt&quot;</span><span class="hljs-string">&quot;math&quot;</span><span class="hljs-string">&quot;math/cmplx&quot;</span>)<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">euler</span><span class="hljs-params">()</span></span>  &#123;<span class="hljs-comment">// æ¬§æ‹‰å…¬å¼ e^(i*Pi) + 1 = 0</span>fmt.Println(cmplx.Exp(<span class="hljs-number">1i</span> * math.Pi) + <span class="hljs-number">1</span>)  fmt.Println(cmplx.Pow(math.E, <span class="hljs-number">1i</span> * math.Pi) + <span class="hljs-number">1</span>)&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;euler()&#125;<span class="hljs-comment">// æ‰“å°å†…å®¹</span>(<span class="hljs-number">0</span>+<span class="hljs-number">1.2246467991473515e-16i</span>)(<span class="hljs-number">0</span>+<span class="hljs-number">1.2246467991473515e-16i</span>)</code></pre><h4 id="å¼ºåˆ¶ç±»å‹è½¬æ¢"><a href="#å¼ºåˆ¶ç±»å‹è½¬æ¢" class="headerlink" title="å¼ºåˆ¶ç±»å‹è½¬æ¢"></a>å¼ºåˆ¶ç±»å‹è½¬æ¢</h4><p>goè¯­è¨€éœ€è¦å¼€å‘æ—¶å¼ºåˆ¶ç±»å‹è½¬æ¢ï¼Œä¸ä¼šè‡ªåŠ¨éšå¼è½¬æ¢</p><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">triangle</span><span class="hljs-params">()</span></span>  &#123;a, b := <span class="hljs-number">3</span>, <span class="hljs-number">4</span><span class="hljs-keyword">var</span> c <span class="hljs-keyword">int</span> c = math.Sqrt(a*a + b*b)                    <span class="hljs-comment">// ä¼šåœ¨ç¼–è¯‘å‰ideaä¾¿æç¤ºæŠ¥é”™</span>  c = <span class="hljs-keyword">int</span>(math.Sqrt(<span class="hljs-keyword">float64</span>(a * a + b * b)))  <span class="hljs-comment">// æ­£ç¡®å†™æ³•</span>fmt.Println(c)&#125;</code></pre><p>å¸¸é‡æœªå£°æ˜ç±»å‹ï¼Œå…¶ç±»å‹æ˜¯ä¸ç¡®å®šçš„ï¼ˆæ•°å€¼å¯ä»¥ä½œå„ç§ç±»å‹ä½¿ç”¨ï¼‰</p><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">consts</span><span class="hljs-params">()</span></span>  &#123;<span class="hljs-comment">// å¼ºåˆ¶ç±»å‹è½¬æ¢</span><span class="hljs-keyword">const</span> a, b = <span class="hljs-number">3</span>, <span class="hljs-number">4</span><span class="hljs-keyword">var</span> c <span class="hljs-keyword">int</span>c = <span class="hljs-keyword">int</span>(math.Sqrt(a * a + b * b))    <span class="hljs-comment">// a * a + b * b éƒ¨åˆ†å¯ä»¥ä¸ç”¨åŠ ä¸Šå¼ºåˆ¶ç±»å‹è½¬æ¢</span>fmt.Println(c)&#125;</code></pre><p>å¯ä»¥åˆ©ç”¨å¸¸é‡ç”³æ˜æšä¸¾ç±»å‹</p><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">enums</span><span class="hljs-params">()</span></span>  &#123;<span class="hljs-keyword">const</span> (golang = <span class="hljs-literal">iota</span>_javapython)fmt.Println(golang, java, python)&#125;<span class="hljs-comment">// è¾“å‡º</span><span class="hljs-number">0</span> <span class="hljs-number">2</span> <span class="hljs-number">3</span></code></pre><p>å¯ä»¥ä»¥<code>iota</code>ä¸ºåŸºç¡€ï¼Œç”Ÿæˆä¸€ç³»åˆ—æšä¸¾æ•°</p><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">enums</span><span class="hljs-params">()</span></span>  &#123;<span class="hljs-keyword">const</span> (b = <span class="hljs-number">1</span> &lt;&lt; (<span class="hljs-number">10</span> * <span class="hljs-literal">iota</span>)kbmbgbtb)fmt.Println(b, kb, mb, gb, tb)&#125;<span class="hljs-comment">// è¾“å‡º</span><span class="hljs-number">1</span> <span class="hljs-number">1024</span> <span class="hljs-number">1048576</span> <span class="hljs-number">1073741824</span> <span class="hljs-number">1099511627776</span></code></pre><p><a href="https://github.com/weitrue/note/blob/master/go/variable.go">https://github.com/weitrue/note/blob/master/go/variable.go</a></p><h3 id="æŒ‡é’ˆ"><a href="#æŒ‡é’ˆ" class="headerlink" title="æŒ‡é’ˆ"></a>æŒ‡é’ˆ</h3><p>æŒ‡é’ˆä¸èƒ½è¿ç®—</p><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<span class="hljs-keyword">import</span> <span class="hljs-string">&quot;fmt&quot;</span><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<span class="hljs-keyword">var</span> a <span class="hljs-keyword">int</span> = <span class="hljs-number">2</span><span class="hljs-keyword">var</span> pa *<span class="hljs-keyword">int</span> = &amp;a*pa = <span class="hljs-number">3</span>fmt.Println(a)&#125;<span class="hljs-comment">// è¿è¡Œç»“æœ</span><span class="hljs-number">3</span></code></pre><p>å‚æ•°ä¼ é€’â€”åªæœ‰<em>å€¼ä¼ é€’</em>ä¸€ç§æ–¹å¼</p><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">swapV</span><span class="hljs-params">(a, b <span class="hljs-keyword">int</span>)</span></span> &#123;b, a = a, bfmt.Println(<span class="hljs-string">&quot;in &quot;</span>, a, b, &amp;a, &amp;b)&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">swapRN</span><span class="hljs-params">(a, b *<span class="hljs-keyword">int</span>)</span></span> &#123;<span class="hljs-comment">// å±€éƒ¨å˜é‡äº¤æ¢å€¼ï¼ˆåœ°å€ï¼‰</span>b, a = a, bfmt.Println(<span class="hljs-string">&quot;in &quot;</span>, a, b, *a, *b)&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">swapR</span><span class="hljs-params">(a, b *<span class="hljs-keyword">int</span>)</span></span> &#123;<span class="hljs-comment">// äº¤æ¢å˜é‡å€¼ï¼ˆåœ°å€ï¼‰æŒ‡å‘çš„å€¼</span>*b, *a = *a, *bfmt.Println(<span class="hljs-string">&quot;in &quot;</span>, a, b, *a, *b)&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">pointerSwap</span><span class="hljs-params">()</span></span>  &#123;a, b := <span class="hljs-number">3</span>, <span class="hljs-number">4</span>swapV(a, b)fmt.Println(<span class="hljs-string">&quot;out&quot;</span>, a, b, &amp;a, &amp;b)a, b = <span class="hljs-number">3</span>, <span class="hljs-number">4</span>swapRN(&amp;a, &amp;b)fmt.Println(<span class="hljs-string">&quot;out&quot;</span>, a, b, &amp;a, &amp;b)a, b = <span class="hljs-number">3</span>, <span class="hljs-number">4</span>swapR(&amp;a, &amp;b)fmt.Println(<span class="hljs-string">&quot;out&quot;</span>, a, b, &amp;a, &amp;b)&#125;<span class="hljs-comment">// è¾“å‡º</span>in  <span class="hljs-number">4</span> <span class="hljs-number">3</span> <span class="hljs-number">0xc00001e0c8</span> <span class="hljs-number">0xc00001e0d0</span>out <span class="hljs-number">3</span> <span class="hljs-number">4</span> <span class="hljs-number">0xc00001e0b8</span> <span class="hljs-number">0xc00001e0c0</span>in  <span class="hljs-number">0xc00001e0c0</span> <span class="hljs-number">0xc00001e0b8</span> <span class="hljs-number">4</span> <span class="hljs-number">3</span>out <span class="hljs-number">3</span> <span class="hljs-number">4</span> <span class="hljs-number">0xc00001e0b8</span> <span class="hljs-number">0xc00001e0c0</span>in  <span class="hljs-number">0xc00001e0b8</span> <span class="hljs-number">0xc00001e0c0</span> <span class="hljs-number">4</span> <span class="hljs-number">3</span>out <span class="hljs-number">4</span> <span class="hljs-number">3</span> <span class="hljs-number">0xc00001e0b8</span> <span class="hljs-number">0xc00001e0c0</span></code></pre><p><a href="https://github.com/weitrue/note/blob/master/go/pointer.go">https://github.com/weitrue/note/blob/master/go/pointer.go</a></p><h3 id="å®¹å™¨"><a href="#å®¹å™¨" class="headerlink" title="å®¹å™¨"></a>å®¹å™¨</h3><h4 id="æ•°ç»„"><a href="#æ•°ç»„" class="headerlink" title="æ•°ç»„"></a>æ•°ç»„</h4><p>æ•°ç»„å®šä¹‰</p><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">define</span><span class="hljs-params">()</span></span>  &#123;<span class="hljs-keyword">var</span> arr1 [<span class="hljs-number">5</span>]<span class="hljs-keyword">int</span>arr2 := [<span class="hljs-number">3</span>]<span class="hljs-keyword">int</span>&#123;<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>&#125;arr3 := [...]<span class="hljs-keyword">int</span>&#123;<span class="hljs-number">2</span>, <span class="hljs-number">4</span>, <span class="hljs-number">6</span>, <span class="hljs-number">8</span>, <span class="hljs-number">10</span>&#125;<span class="hljs-keyword">var</span> grid [<span class="hljs-number">4</span>][<span class="hljs-number">5</span>]<span class="hljs-keyword">bool</span>fmt.Println(arr1, arr2, arr3)fmt.Println(grid)&#125;<span class="hljs-comment">// è¾“å‡º</span>[<span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span>] [<span class="hljs-number">1</span> <span class="hljs-number">3</span> <span class="hljs-number">5</span>] [<span class="hljs-number">2</span> <span class="hljs-number">4</span> <span class="hljs-number">6</span> <span class="hljs-number">8</span> <span class="hljs-number">10</span>][[<span class="hljs-literal">false</span> <span class="hljs-literal">false</span> <span class="hljs-literal">false</span> <span class="hljs-literal">false</span> <span class="hljs-literal">false</span>] [<span class="hljs-literal">false</span> <span class="hljs-literal">false</span> <span class="hljs-literal">false</span> <span class="hljs-literal">false</span> <span class="hljs-literal">false</span>] [<span class="hljs-literal">false</span> <span class="hljs-literal">false</span> <span class="hljs-literal">false</span> <span class="hljs-literal">false</span> <span class="hljs-literal">false</span>] [<span class="hljs-literal">false</span> <span class="hljs-literal">false</span> <span class="hljs-literal">false</span> <span class="hljs-literal">false</span> <span class="hljs-literal">false</span>]]</code></pre><p>[5]intå’Œ[10]intæ˜¯ä¸åŒç±»å‹</p><p>è°ƒç”¨func f(arr [10]int)ä¼š<em>æ‹·è´</em>æ•°ç»„</p><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">printArr</span><span class="hljs-params">(arr [5]<span class="hljs-keyword">int</span>)</span></span>  &#123;arr[<span class="hljs-number">0</span>] = <span class="hljs-number">100</span><span class="hljs-keyword">for</span> i, v := <span class="hljs-keyword">range</span> arr &#123;fmt.Println(i, v)&#125;&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">arrTest</span><span class="hljs-params">()</span></span>  &#123;<span class="hljs-keyword">var</span> arr1 [<span class="hljs-number">5</span>]<span class="hljs-keyword">int</span>arr2 := [...]<span class="hljs-keyword">int</span>&#123;<span class="hljs-number">2</span>, <span class="hljs-number">4</span>, <span class="hljs-number">6</span>, <span class="hljs-number">8</span>, <span class="hljs-number">10</span>&#125;fmt.Println()printArr(arr2)fmt.Println()<span class="hljs-keyword">for</span> i, v := <span class="hljs-keyword">range</span> arr1 &#123;fmt.Println(i, v)&#125;&#125;<span class="hljs-comment">// è¾“å‡º</span><span class="hljs-number">0</span> <span class="hljs-number">100</span><span class="hljs-number">1</span> <span class="hljs-number">0</span><span class="hljs-number">2</span> <span class="hljs-number">0</span><span class="hljs-number">3</span> <span class="hljs-number">0</span><span class="hljs-number">4</span> <span class="hljs-number">0</span><span class="hljs-number">0</span> <span class="hljs-number">100</span><span class="hljs-number">1</span> <span class="hljs-number">4</span><span class="hljs-number">2</span> <span class="hljs-number">6</span><span class="hljs-number">3</span> <span class="hljs-number">8</span><span class="hljs-number">4</span> <span class="hljs-number">10</span><span class="hljs-number">0</span> <span class="hljs-number">0</span><span class="hljs-number">1</span> <span class="hljs-number">0</span><span class="hljs-number">2</span> <span class="hljs-number">0</span><span class="hljs-number">3</span> <span class="hljs-number">0</span><span class="hljs-number">4</span> <span class="hljs-number">0</span></code></pre><p>è‹¥è¦æ”¹å˜æ•°ç»„çš„å€¼ éœ€è¦ä¼ å…¥æ•°ç»„çš„åœ°å€ï¼Œå› æ­¤goè¯­è¨€ä¸€èˆ¬ä¸ä½¿ç”¨æ•°ç»„</p><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">printArrR</span><span class="hljs-params">(arr *[5]<span class="hljs-keyword">int</span>)</span></span>  &#123;arr[<span class="hljs-number">0</span>] = <span class="hljs-number">100</span><span class="hljs-keyword">for</span> i, v := <span class="hljs-keyword">range</span> arr &#123;fmt.Println(i, v)&#125;&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">arrTest</span><span class="hljs-params">()</span></span>  &#123;<span class="hljs-keyword">var</span> arr1 [<span class="hljs-number">5</span>]<span class="hljs-keyword">int</span>printArrR(&amp;arr1)fmt.Println()fmt.Println(arr1)&#125;<span class="hljs-comment">// è¾“å‡º</span><span class="hljs-number">0</span> <span class="hljs-number">100</span><span class="hljs-number">1</span> <span class="hljs-number">0</span><span class="hljs-number">2</span> <span class="hljs-number">0</span><span class="hljs-number">3</span> <span class="hljs-number">0</span><span class="hljs-number">4</span> <span class="hljs-number">0</span>[<span class="hljs-number">100</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span>]</code></pre><p><a href="https://github.com/weitrue/note/blob/master/go/collections/array.go">https://github.com/weitrue/note/blob/master/go/collections/array.go</a></p><h4 id="åˆ‡ç‰‡"><a href="#åˆ‡ç‰‡" class="headerlink" title="åˆ‡ç‰‡"></a>åˆ‡ç‰‡</h4><ul><li><p>sliceå¯ä»¥å‘åæ‰©å±•ï¼Œä½†ä¸èƒ½å‘å‰æ‰©å±•</p></li><li><p>s[i]ä¸å¯è¶…è¶Šlen(s)ï¼Œå‘åæ‰©å±•ä¸å¯ä»¥è¶…è¶Šåº•å±‚æ•°ç»„cap(s)</p></li></ul><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">slice</span><span class="hljs-params">()</span></span> &#123;arr := [...]<span class="hljs-keyword">int</span>&#123;<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>&#125;s1 := arr[<span class="hljs-number">2</span>: <span class="hljs-number">6</span>]fmt.Println(s1)s2 := s1[<span class="hljs-number">3</span>: <span class="hljs-number">5</span>]fmt.Println(s2)  s3 := s1[<span class="hljs-number">3</span>:<span class="hljs-number">6</span>]fmt.Println(s3)&#125;<span class="hljs-comment">//è¾“å‡º</span>[<span class="hljs-number">3</span> <span class="hljs-number">4</span> <span class="hljs-number">5</span> <span class="hljs-number">6</span>][<span class="hljs-number">6</span> <span class="hljs-number">7</span>]<span class="hljs-built_in">panic</span>: runtime error: slice bounds out of <span class="hljs-keyword">range</span> [:<span class="hljs-number">6</span>] with capacity <span class="hljs-number">5</span>goroutine <span class="hljs-number">1</span> [running]:main.sliceDefine()        ~/Projects/golang/src/offer/note/slices.<span class="hljs-keyword">go</span>:<span class="hljs-number">20</span> +<span class="hljs-number">0x164</span>main.main()        ~/Projects/golang/src/offer/note/ab_test_func.<span class="hljs-keyword">go</span>:<span class="hljs-number">28</span> +<span class="hljs-number">0x20</span></code></pre><p><img src="/images/golang/slice.png"></p><ul><li><p>å‘sliceæ·»åŠ å…ƒç´ ï¼Œå¦‚æœè¶…è¶Šcapï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨åˆ†é…æ›´å¤§çš„åº•å±‚æ•°ç»„</p></li><li><p>ç”±äºå€¼ä¼ é€’çš„åŸå› ï¼Œå¿…é¡»æ¥æ”¶appendçš„è¿”å›å€¼<code>s=append(s, val)</code></p></li></ul><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">sliceAppend</span><span class="hljs-params">()</span></span> &#123;arr := [...]<span class="hljs-keyword">int</span>&#123;<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span>&#125;s1 := arr[<span class="hljs-number">2</span>: <span class="hljs-number">6</span>]fmt.Println(s1, <span class="hljs-built_in">cap</span>(s1), <span class="hljs-built_in">len</span>(s1))s2 := s1[<span class="hljs-number">3</span>: <span class="hljs-number">5</span>]fmt.Println(s2)s3 := <span class="hljs-built_in">append</span>(s2, <span class="hljs-number">10</span>)s4 := <span class="hljs-built_in">append</span>(s3, <span class="hljs-number">11</span>)s5 := <span class="hljs-built_in">append</span>(s4, <span class="hljs-number">12</span>)fmt.Println(<span class="hljs-string">&quot;s3, s4, s5=&quot;</span>, s3, s4, s5)fmt.Println(arr)    s6 := <span class="hljs-built_in">append</span>(s1, <span class="hljs-number">10</span>)s7 := <span class="hljs-built_in">append</span>(s6, <span class="hljs-number">11</span>)s8 := <span class="hljs-built_in">append</span>(s7, <span class="hljs-number">12</span>)fmt.Println(<span class="hljs-string">&quot;s6, s7, s8=&quot;</span>, s6, s7, s8)fmt.Println(<span class="hljs-string">&quot;cap(s6), cap(s7), cap(s8) =&quot;</span>, <span class="hljs-built_in">cap</span>(s6), <span class="hljs-built_in">cap</span>(s7), <span class="hljs-built_in">cap</span>(s8))fmt.Println(arr)&#125;<span class="hljs-comment">// è¾“å‡º</span>[<span class="hljs-number">3</span> <span class="hljs-number">4</span> <span class="hljs-number">5</span> <span class="hljs-number">6</span>] <span class="hljs-number">6</span> <span class="hljs-number">4</span>[<span class="hljs-number">6</span> <span class="hljs-number">7</span>]s3, s4, s5= [<span class="hljs-number">6</span> <span class="hljs-number">7</span> <span class="hljs-number">10</span>] [<span class="hljs-number">6</span> <span class="hljs-number">7</span> <span class="hljs-number">10</span> <span class="hljs-number">11</span>] [<span class="hljs-number">6</span> <span class="hljs-number">7</span> <span class="hljs-number">10</span> <span class="hljs-number">11</span> <span class="hljs-number">12</span>]<span class="hljs-built_in">cap</span>(s3), <span class="hljs-built_in">cap</span>(s4), <span class="hljs-built_in">cap</span>(s5) = <span class="hljs-number">3</span> <span class="hljs-number">6</span> <span class="hljs-number">6</span>[<span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">3</span> <span class="hljs-number">4</span> <span class="hljs-number">5</span> <span class="hljs-number">6</span> <span class="hljs-number">7</span> <span class="hljs-number">10</span>]s6, s7, s8= [<span class="hljs-number">3</span> <span class="hljs-number">4</span> <span class="hljs-number">5</span> <span class="hljs-number">6</span> <span class="hljs-number">10</span>] [<span class="hljs-number">3</span> <span class="hljs-number">4</span> <span class="hljs-number">5</span> <span class="hljs-number">6</span> <span class="hljs-number">10</span> <span class="hljs-number">11</span>] [<span class="hljs-number">3</span> <span class="hljs-number">4</span> <span class="hljs-number">5</span> <span class="hljs-number">6</span> <span class="hljs-number">10</span> <span class="hljs-number">11</span> <span class="hljs-number">12</span>]<span class="hljs-built_in">cap</span>(s6), <span class="hljs-built_in">cap</span>(s7), <span class="hljs-built_in">cap</span>(s8) = <span class="hljs-number">6</span> <span class="hljs-number">6</span> <span class="hljs-number">12</span>[<span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">3</span> <span class="hljs-number">4</span> <span class="hljs-number">5</span> <span class="hljs-number">6</span> <span class="hljs-number">10</span> <span class="hljs-number">11</span>]</code></pre><ul><li>Zero value for slice is nil</li></ul><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">sliceDefine</span><span class="hljs-params">()</span></span> &#123;<span class="hljs-keyword">var</span> s []<span class="hljs-keyword">int</span><span class="hljs-keyword">for</span> i :=<span class="hljs-number">0</span>; i &lt;<span class="hljs-number">10</span>; i++ &#123;fmt.Printf(<span class="hljs-string">&quot;%v, cap(s) = %d, len(s) = %d\n&quot;</span>, s, <span class="hljs-built_in">cap</span>(s), <span class="hljs-built_in">len</span>(s))s = <span class="hljs-built_in">append</span>(s, <span class="hljs-number">2</span>*i + <span class="hljs-number">1</span>)&#125;s1 := []<span class="hljs-keyword">int</span>&#123;<span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>&#125;fmt.Printf(<span class="hljs-string">&quot;%v, cap(s1) = %d, len(s1) = %d\n&quot;</span>, s1, <span class="hljs-built_in">cap</span>(s1), <span class="hljs-built_in">len</span>(s1))s2 := <span class="hljs-built_in">make</span>([]<span class="hljs-keyword">int</span>, <span class="hljs-number">8</span>)fmt.Printf(<span class="hljs-string">&quot;%v, cap(s2) = %d, len(s2) = %d\n&quot;</span>, s2, <span class="hljs-built_in">cap</span>(s2), <span class="hljs-built_in">len</span>(s2))s3 := <span class="hljs-built_in">make</span>([]<span class="hljs-keyword">int</span>, <span class="hljs-number">8</span>, <span class="hljs-number">32</span>)fmt.Printf(<span class="hljs-string">&quot;%v, cap(s3) = %d, len(s3) = %d\n&quot;</span>, s3, <span class="hljs-built_in">cap</span>(s3), <span class="hljs-built_in">len</span>(s3))<span class="hljs-comment">// æ‹·è´</span><span class="hljs-built_in">copy</span>(s2, s1)fmt.Printf(<span class="hljs-string">&quot;%v, cap(s2) = %d, len(s2) = %d\n&quot;</span>, s2, <span class="hljs-built_in">cap</span>(s2), <span class="hljs-built_in">len</span>(s2))<span class="hljs-comment">// åˆ é™¤ æ²¡æœ‰å†…å»ºå‡½æ•°ï¼Œåªèƒ½é€šè¿‡æˆªå–+append</span>s4 := <span class="hljs-built_in">append</span>(s2[:<span class="hljs-number">2</span>], s2[<span class="hljs-number">3</span>:]...)fmt.Printf(<span class="hljs-string">&quot;%v, cap(s4) = %d, len(s4) = %d\n&quot;</span>, s4, <span class="hljs-built_in">cap</span>(s4), <span class="hljs-built_in">len</span>(s4))&#125;<span class="hljs-comment">//è¾“å‡º</span>[], <span class="hljs-built_in">cap</span>(s) = <span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(s) = <span class="hljs-number">0</span>[<span class="hljs-number">1</span>], <span class="hljs-built_in">cap</span>(s) = <span class="hljs-number">1</span>, <span class="hljs-built_in">len</span>(s) = <span class="hljs-number">1</span>[<span class="hljs-number">1</span> <span class="hljs-number">3</span>], <span class="hljs-built_in">cap</span>(s) = <span class="hljs-number">2</span>, <span class="hljs-built_in">len</span>(s) = <span class="hljs-number">2</span>[<span class="hljs-number">1</span> <span class="hljs-number">3</span> <span class="hljs-number">5</span>], <span class="hljs-built_in">cap</span>(s) = <span class="hljs-number">4</span>, <span class="hljs-built_in">len</span>(s) = <span class="hljs-number">3</span>[<span class="hljs-number">1</span> <span class="hljs-number">3</span> <span class="hljs-number">5</span> <span class="hljs-number">7</span>], <span class="hljs-built_in">cap</span>(s) = <span class="hljs-number">4</span>, <span class="hljs-built_in">len</span>(s) = <span class="hljs-number">4</span>[<span class="hljs-number">1</span> <span class="hljs-number">3</span> <span class="hljs-number">5</span> <span class="hljs-number">7</span> <span class="hljs-number">9</span>], <span class="hljs-built_in">cap</span>(s) = <span class="hljs-number">8</span>, <span class="hljs-built_in">len</span>(s) = <span class="hljs-number">5</span>[<span class="hljs-number">1</span> <span class="hljs-number">3</span> <span class="hljs-number">5</span> <span class="hljs-number">7</span> <span class="hljs-number">9</span> <span class="hljs-number">11</span>], <span class="hljs-built_in">cap</span>(s) = <span class="hljs-number">8</span>, <span class="hljs-built_in">len</span>(s) = <span class="hljs-number">6</span>[<span class="hljs-number">1</span> <span class="hljs-number">3</span> <span class="hljs-number">5</span> <span class="hljs-number">7</span> <span class="hljs-number">9</span> <span class="hljs-number">11</span> <span class="hljs-number">13</span>], <span class="hljs-built_in">cap</span>(s) = <span class="hljs-number">8</span>, <span class="hljs-built_in">len</span>(s) = <span class="hljs-number">7</span>[<span class="hljs-number">1</span> <span class="hljs-number">3</span> <span class="hljs-number">5</span> <span class="hljs-number">7</span> <span class="hljs-number">9</span> <span class="hljs-number">11</span> <span class="hljs-number">13</span> <span class="hljs-number">15</span>], <span class="hljs-built_in">cap</span>(s) = <span class="hljs-number">8</span>, <span class="hljs-built_in">len</span>(s) = <span class="hljs-number">8</span>[<span class="hljs-number">1</span> <span class="hljs-number">3</span> <span class="hljs-number">5</span> <span class="hljs-number">7</span> <span class="hljs-number">9</span> <span class="hljs-number">11</span> <span class="hljs-number">13</span> <span class="hljs-number">15</span> <span class="hljs-number">17</span>], <span class="hljs-built_in">cap</span>(s) = <span class="hljs-number">16</span>, <span class="hljs-built_in">len</span>(s) = <span class="hljs-number">9</span>[<span class="hljs-number">2</span> <span class="hljs-number">3</span> <span class="hljs-number">4</span>], <span class="hljs-built_in">cap</span>(s1) = <span class="hljs-number">3</span>, <span class="hljs-built_in">len</span>(s1) = <span class="hljs-number">3</span>[<span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span>], <span class="hljs-built_in">cap</span>(s2) = <span class="hljs-number">8</span>, <span class="hljs-built_in">len</span>(s2) = <span class="hljs-number">8</span>[<span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span>], <span class="hljs-built_in">cap</span>(s3) = <span class="hljs-number">32</span>, <span class="hljs-built_in">len</span>(s3) = <span class="hljs-number">8</span>[<span class="hljs-number">2</span> <span class="hljs-number">3</span> <span class="hljs-number">4</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span>], <span class="hljs-built_in">cap</span>(s2) = <span class="hljs-number">8</span>, <span class="hljs-built_in">len</span>(s2) = <span class="hljs-number">8</span>[<span class="hljs-number">2</span> <span class="hljs-number">3</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span>], <span class="hljs-built_in">cap</span>(s4) = <span class="hljs-number">8</span>, <span class="hljs-built_in">len</span>(s4) = <span class="hljs-number">7</span></code></pre><p><a href="https://github.com/weitrue/note/blob/master/go/collections/slices.go">https://github.com/weitrue/note/blob/master/go/collections/slices.go</a></p><h4 id="Map"><a href="#Map" class="headerlink" title="Map"></a>Map</h4><ul><li><p>åˆ›å»º<code>make(map[type]type)</code></p></li><li><p>keyä¸å­˜åœ¨æ—¶ï¼Œè·å–valueç±»å‹çš„åˆå§‹å€¼ï¼Œéœ€è¦<code>if value, ok := m[key]; ok &#123;...&#125;</code> åˆ¤æ–­æ˜¯å¦å­˜åœ¨key</p></li><li><p>mapä½¿ç”¨å“ˆå¸Œè¡¨ï¼Œå¿…é¡»å¯ä»¥æ¯”è¾ƒç›¸ç­‰</p></li><li><p>é™¤äº†slice, map,functionçš„å†…å»ºç±»å‹éƒ½å¯ä»¥ä½œä¸ºmapçš„key,Structç±»å‹ä¸åŒ…å«ä¸Šè¿°å­—æ®µæ—¶ï¼Œä¹Ÿå¯ä½œä¸ºkey</p></li></ul><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">mapDefine</span><span class="hljs-params">()</span></span>  &#123;m := <span class="hljs-keyword">map</span>[<span class="hljs-keyword">int</span>]<span class="hljs-keyword">string</span>&#123;<span class="hljs-number">1</span>: <span class="hljs-string">&quot;aa&quot;</span>,<span class="hljs-number">2</span>: <span class="hljs-string">&quot;bb&quot;</span>,&#125;<span class="hljs-keyword">if</span> v, ok := m[<span class="hljs-number">3</span>]; ok &#123;fmt.Println(v)&#125; <span class="hljs-keyword">else</span> &#123;<span class="hljs-built_in">panic</span>(<span class="hljs-string">&quot;key not exists&quot;</span>)&#125;&#125;<span class="hljs-comment">//è¾“å‡º</span><span class="hljs-built_in">panic</span>: key not existsgoroutine <span class="hljs-number">1</span> [running]:main.mapDefine()        /Users/wangpeng/Projects/golang/src/offer/note/maps.<span class="hljs-keyword">go</span>:<span class="hljs-number">20</span> +<span class="hljs-number">0x1f6</span>main.main()        /Users/wangpeng/Projects/golang/src/offer/note/ab_test_func.<span class="hljs-keyword">go</span>:<span class="hljs-number">32</span> +<span class="hljs-number">0x20</span></code></pre><p><a href="https://github.com/weitrue/note/blob/master/go/collections/maps.go">https://github.com/weitrue/note/blob/master/go/collections/maps.go</a></p><h4 id="Rune"><a href="#Rune" class="headerlink" title="Rune"></a>Rune</h4><p>å­—ç¬¦ä¸²åœ¨UTF-8ç¼–ç ä¸­ï¼Œä¸€ä¸ªä¸­æ–‡å ä¸‰ä¸ªå­—èŠ‚ï¼Œ</p><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">strByte</span><span class="hljs-params">(s <span class="hljs-keyword">string</span>)</span></span>  &#123;<span class="hljs-keyword">if</span> s == <span class="hljs-string">&quot;&quot;</span> &#123;s = <span class="hljs-string">&quot;yes,æˆ‘å–œæ¬¢ä½ ï¼&quot;</span>&#125;<span class="hljs-keyword">for</span> i, ch := <span class="hljs-keyword">range</span> []<span class="hljs-keyword">byte</span>(s) &#123;fmt.Printf(<span class="hljs-string">&quot;(%d, %X)&quot;</span>, i, ch)&#125;fmt.Println()  <span class="hljs-keyword">for</span> i, ch := <span class="hljs-keyword">range</span> s &#123; <span class="hljs-comment">// ch is a rune å…¶å®æ˜¯å°†sè¿›è¡Œutf-8è§£ç ï¼Œè§£ç åçš„å­—ç¬¦ä¼šè½¬æˆunicode,ç„¶åæ”¾å…¥runeä¸­</span>fmt.Printf(<span class="hljs-string">&quot;(%d, %X)&quot;</span>, i, ch)&#125;fmt.Println()  bytes := []<span class="hljs-keyword">byte</span>(s)<span class="hljs-keyword">for</span> <span class="hljs-built_in">len</span>(bytes) &gt;<span class="hljs-number">0</span> &#123;ch, size := utf8.DecodeRune(bytes)bytes = bytes[size:]fmt.Printf(<span class="hljs-string">&quot;%c &quot;</span>, ch)&#125;fmt.Println()<span class="hljs-keyword">for</span> i, ch := <span class="hljs-keyword">range</span> []<span class="hljs-keyword">rune</span>(s) &#123;fmt.Printf(<span class="hljs-string">&quot;(%d, %X)&quot;</span>, i, ch)&#125;&#125;<span class="hljs-comment">// è¾“å‡º</span>(<span class="hljs-number">0</span>, <span class="hljs-number">79</span>)(<span class="hljs-number">1</span>, <span class="hljs-number">65</span>)(<span class="hljs-number">2</span>, <span class="hljs-number">73</span>)(<span class="hljs-number">3</span>, <span class="hljs-number">2</span>C)(<span class="hljs-number">4</span>, E6)(<span class="hljs-number">5</span>, <span class="hljs-number">88</span>)(<span class="hljs-number">6</span>, <span class="hljs-number">91</span>)(<span class="hljs-number">7</span>, E5)(<span class="hljs-number">8</span>, <span class="hljs-number">96</span>)(<span class="hljs-number">9</span>, <span class="hljs-number">9</span>C)(<span class="hljs-number">10</span>, E6)(<span class="hljs-number">11</span>, AC)(<span class="hljs-number">12</span>, A2)(<span class="hljs-number">13</span>, E4)(<span class="hljs-number">14</span>, BD)(<span class="hljs-number">15</span>, A0)(<span class="hljs-number">16</span>, EF)(<span class="hljs-number">17</span>, BC)(<span class="hljs-number">18</span>, <span class="hljs-number">81</span>)(<span class="hljs-number">0</span>, <span class="hljs-number">79</span>)(<span class="hljs-number">1</span>, <span class="hljs-number">65</span>)(<span class="hljs-number">2</span>, <span class="hljs-number">73</span>)(<span class="hljs-number">3</span>, <span class="hljs-number">2</span>C)(<span class="hljs-number">4</span>, <span class="hljs-number">6211</span>)(<span class="hljs-number">7</span>, <span class="hljs-number">559</span>C)(<span class="hljs-number">10</span>, <span class="hljs-number">6</span>B22)(<span class="hljs-number">13</span>, <span class="hljs-number">4</span>F60)(<span class="hljs-number">16</span>, FF01)y e s , æˆ‘ å–œ æ¬¢ ä½  ï¼(<span class="hljs-number">0</span>, <span class="hljs-number">79</span>)(<span class="hljs-number">1</span>, <span class="hljs-number">65</span>)(<span class="hljs-number">2</span>, <span class="hljs-number">73</span>)(<span class="hljs-number">3</span>, <span class="hljs-number">2</span>C)(<span class="hljs-number">4</span>, <span class="hljs-number">6211</span>)(<span class="hljs-number">5</span>, <span class="hljs-number">559</span>C)(<span class="hljs-number">6</span>, <span class="hljs-number">6</span>B22)(<span class="hljs-number">7</span>, <span class="hljs-number">4</span>F60)(<span class="hljs-number">8</span>, FF01)</code></pre><p>å› æ­¤åœ¨éœ€è¦ä½¿ç”¨rune</p><pre><code class="hljs go"><span class="hljs-comment">/**</span><span class="hljs-comment"> * Version: 1.0.0</span><span class="hljs-comment"> * Description: è·å–å­—ç¬¦ä¸²ä¸­ä¸é‡å¤å­—ä¸²æœ€å¤§é•¿åº¦</span><span class="hljs-comment"> **/</span><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">maxNoRepeated</span><span class="hljs-params">(s <span class="hljs-keyword">string</span>)</span> <span class="hljs-title">int</span></span> &#123;  <span class="hljs-comment">// ä»…æ”¯æŒè‹±æ–‡å­—ç¬¦</span><span class="hljs-comment">// å­—ç¬¦ä¸‹æ ‡æ˜ å°„</span>  chNotRepeatIndex := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">map</span>[<span class="hljs-keyword">byte</span>] <span class="hljs-keyword">int</span>)<span class="hljs-comment">// æœ€é•¿ä¸²èµ·å§‹ä½ç½®</span>  start := <span class="hljs-number">0</span>  <span class="hljs-comment">// æœ€é•¿ä¸²é•¿åº¦</span>maxLength := <span class="hljs-number">0</span> <span class="hljs-keyword">for</span> i, ch := <span class="hljs-keyword">range</span> []<span class="hljs-keyword">byte</span>(s) &#123; <span class="hljs-keyword">if</span> lastI, ok := chNotRepeatIndex[ch]; ok &amp;&amp; lastI &gt;= start &#123; start = lastI + <span class="hljs-number">1</span>&#125;<span class="hljs-keyword">if</span> i - start + <span class="hljs-number">1</span> &gt; maxLength &#123;maxLength = i - start + <span class="hljs-number">1</span>&#125;chNotRepeatIndex[ch] = i &#125; <span class="hljs-keyword">return</span> maxLength&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">maxNoRepeatedChn</span><span class="hljs-params">(s <span class="hljs-keyword">string</span>)</span> <span class="hljs-title">int</span></span> &#123;  <span class="hljs-comment">// é€šè¿‡rune</span>chNotRepeatIndex := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">map</span>[<span class="hljs-keyword">rune</span>] <span class="hljs-keyword">int</span>)start := <span class="hljs-number">0</span>maxLength := <span class="hljs-number">0</span><span class="hljs-keyword">for</span> i, ch := <span class="hljs-keyword">range</span> []<span class="hljs-keyword">rune</span>(s) &#123;<span class="hljs-keyword">if</span> lastI, ok := chNotRepeatIndex[ch]; ok &amp;&amp; lastI &gt;= start &#123;start = lastI + <span class="hljs-number">1</span>&#125;<span class="hljs-keyword">if</span> i - start + <span class="hljs-number">1</span> &gt; maxLength &#123;maxLength = i - start + <span class="hljs-number">1</span>&#125;chNotRepeatIndex[ch] = i&#125;<span class="hljs-keyword">return</span> maxLength&#125;</code></pre><p><a href="https://github.com/weitrue/note/blob/master/go/collections/strings.go">https://github.com/weitrue/note/blob/master/go/collections/strings.go</a></p><h3 id="é¢å‘å¯¹è±¡"><a href="#é¢å‘å¯¹è±¡" class="headerlink" title="é¢å‘å¯¹è±¡"></a>é¢å‘å¯¹è±¡</h3><p>ä»…<em>æ”¯æŒå°è£…</em>ï¼Œä¸æ”¯æŒç»§æ‰¿å’Œå¤šæ€</p><pre><code class="hljs go"><span class="hljs-keyword">import</span> <span class="hljs-string">&quot;fmt&quot;</span><span class="hljs-keyword">type</span> Node <span class="hljs-keyword">struct</span> &#123;Value       <span class="hljs-keyword">int</span>Left, Right *Node&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(node Node)</span> <span class="hljs-title">Print</span><span class="hljs-params">()</span></span> &#123;fmt.Print(node.Value, <span class="hljs-string">&quot; &quot;</span>)&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(node *Node)</span> <span class="hljs-title">SetValue</span><span class="hljs-params">(value <span class="hljs-keyword">int</span>)</span></span> &#123;  <span class="hljs-comment">// æ¥æ”¶è€…ä½¿ç”¨æŒ‡é’ˆæ‰å¯ä»¥æ”¹å˜ç»“æ„å†…å®¹</span><span class="hljs-keyword">if</span> node == <span class="hljs-literal">nil</span> &#123;fmt.Println(<span class="hljs-string">&quot;Setting Value to nil node. Ignored.&quot;</span>)<span class="hljs-keyword">return</span>&#125;node.Value = value&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(node Node)</span> <span class="hljs-title">SetValueNotUpdate</span><span class="hljs-params">(value <span class="hljs-keyword">int</span>)</span></span> &#123;  <span class="hljs-comment">// å€¼ä¼ é€’ nodeå†…å®¹æ— æ³•æ”¹å˜</span><span class="hljs-keyword">if</span> &amp;node == <span class="hljs-literal">nil</span> &#123;fmt.Println(<span class="hljs-string">&quot;Setting Value to nil node. Ignored.&quot;</span>)<span class="hljs-keyword">return</span>&#125;node.Value = value&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">CreateNode</span><span class="hljs-params">(value <span class="hljs-keyword">int</span>)</span> *<span class="hljs-title">Node</span></span> &#123;  <span class="hljs-comment">// è¿”å›å±€éƒ¨å˜é‡åœ°å€ï¼Œè¿™æ ·å˜é‡ä¼šåœ¨å †ä¸­å£°æ˜ï¼Œå¯ä»¥ä¼ åˆ°å¤–éƒ¨</span><span class="hljs-keyword">return</span> &amp;Node&#123;Value: value&#125;&#125;</code></pre><p>æ–¹æ³•æœ‰æ¥æ”¶è€…ï¼ˆå€¼/æŒ‡é’ˆæ¥æ”¶è€…ï¼‰ï¼Œéœ€è¦æ”¹å˜å†…å®¹å¿…é¡»ä½¿ç”¨æŒ‡é’ˆæ¥æ”¶è€…ï¼Œç»“æ„ä½“è¿‡å¤§è€ƒè™‘ç”¨æŒ‡é’ˆæ¥æ”¶è€…</p><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;  node := Node&#123;&#125;node.Print()node.SetValueNotUpdate(<span class="hljs-number">10</span>)node.Print()node.SetValue(<span class="hljs-number">10</span>)node.Print()&#125;<span class="hljs-comment">// è¾“å‡º</span><span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">10</span></code></pre><p>nilä¹Ÿå¯ä»¥è°ƒç”¨æ–¹æ³•</p><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;  <span class="hljs-keyword">var</span> pNode *NodepNode.SetValue(<span class="hljs-number">30</span>)&#125;<span class="hljs-comment">// è¾“å‡º</span>Setting Value to <span class="hljs-literal">nil</span> node. Ignored.</code></pre><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;  <span class="hljs-keyword">var</span> pNode *NodepNode.SetValueNotUpdate(<span class="hljs-number">20</span>)&#125;<span class="hljs-comment">// è¾“å‡º</span><span class="hljs-built_in">panic</span>: runtime error: invalid memory address or <span class="hljs-literal">nil</span> pointer dereference[signal SIGSEGV: segmentation violation code=<span class="hljs-number">0x1</span> addr=<span class="hljs-number">0x0</span> pc=<span class="hljs-number">0x109d0af</span>]goroutine <span class="hljs-number">1</span> [running]:main.main()        ï½/Projects/golang/src/offer/note/ab_test_func.<span class="hljs-keyword">go</span>:<span class="hljs-number">50</span> +<span class="hljs-number">0x1f</span></code></pre><p><a href="https://github.com/weitrue/note/blob/master/go/object/tree.go">https://github.com/weitrue/note/blob/master/go/object/tree.go</a></p><h4 id="å°è£…ä¸åŒ…"><a href="#å°è£…ä¸åŒ…" class="headerlink" title="å°è£…ä¸åŒ…"></a>å°è£…ä¸åŒ…</h4><p>é¦–å­—æ¯å¤§å†™:publicï¼Œé¦–å­—æ¯å°å†™:private</p><p>ä¸ºç»“æ„ä½“å®šä¹‰çš„æ–¹æ³•éœ€è¦æ”¾åœ¨ä¸€ä¸ªåŒ…ä¸‹ï¼ˆå¯ä»¥æ˜¯ä¸åŒçš„æ–‡ä»¶ï¼‰</p><p>æ‰©å……ç³»ç»Ÿç±»å‹æˆ–è€…è‡ªå®šä¹‰ç±»å‹æ–¹å¼ï¼šå®šä¹‰åˆ«åå’Œä½¿ç”¨ç»„åˆ</p><pre><code class="hljs go"><span class="hljs-keyword">type</span> Queue []<span class="hljs-keyword">int</span><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(q *Queue)</span><span class="hljs-title">Push</span><span class="hljs-params">(val <span class="hljs-keyword">int</span>)</span> <span class="hljs-title">error</span></span> &#123;*q = <span class="hljs-built_in">append</span>(*q, val)<span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(q *Queue)</span><span class="hljs-title">Pop</span><span class="hljs-params">()</span> <span class="hljs-params">(<span class="hljs-keyword">int</span>,<span class="hljs-keyword">bool</span>)</span></span> &#123;<span class="hljs-keyword">if</span> q.IsEmpty() &#123;<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>, <span class="hljs-literal">false</span>&#125;head := (*q)[<span class="hljs-number">0</span>]*q = (*q)[<span class="hljs-number">1</span>:]<span class="hljs-keyword">return</span> head, <span class="hljs-literal">true</span>&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(q *Queue)</span><span class="hljs-title">IsEmpty</span><span class="hljs-params">()</span> <span class="hljs-title">bool</span></span> &#123;<span class="hljs-keyword">return</span> <span class="hljs-built_in">len</span>(*q) == <span class="hljs-number">0</span>&#125;</code></pre><pre><code class="hljs go"><span class="hljs-keyword">type</span> Node <span class="hljs-keyword">struct</span> &#123;Value       <span class="hljs-keyword">int</span>Left, Right *Node&#125;<span class="hljs-keyword">type</span> MyNode <span class="hljs-keyword">struct</span> &#123;node *Node&#125;</code></pre><p><a href="https://github.com/weitrue/note/blob/master/go/object/queue.go">https://github.com/weitrue/note/blob/master/go/object/queue.go</a></p><h3 id="æ¥å£"><a href="#æ¥å£" class="headerlink" title="æ¥å£"></a>æ¥å£</h3><h4 id="é¸­å­ç±»å‹"><a href="#é¸­å­ç±»å‹" class="headerlink" title="é¸­å­ç±»å‹"></a>é¸­å­ç±»å‹</h4><h5 id="Duck-Typing"><a href="#Duck-Typing" class="headerlink" title="Duck Typing"></a>Duck Typing</h5><p>æ¥å£ç”±ä½¿ç”¨è€…å®šä¹‰</p><p>â€‹    Pythonçš„åœ¨è¿è¡Œæ—¶æ‰èƒ½çŸ¥é“è¢«è°ƒç”¨çš„å¯¹è±¡æ˜¯å¦å®ç°æŸä¸ªæ–¹æ³•</p><p>â€‹    Javaä¸­ç¼–è¯‘å‰ï¼Œè°ƒç”¨çš„å¯¹è±¡å°±å¿…é¡»å®ç°æ¥å£æ‰€æœ‰æ–¹æ³•</p><p>æ¥å£å˜é‡è‡ªå¸¦æŒ‡é’ˆï¼ˆå‚æ•°ä¼ é€’ä¹Ÿæ˜¯å€¼ä¼ é€’ï¼‰ï¼Œå› æ­¤å‡ ä¹ä¸éœ€è¦ä½¿ç”¨æ¥å£æŒ‡é’ˆ    </p><p><img src="/images/golang/interface.png"></p><pre><code class="hljs go"><span class="hljs-comment">// offer/note/interfaces/mock/duck.go</span><span class="hljs-keyword">package</span> mock<span class="hljs-keyword">type</span> Duck <span class="hljs-keyword">struct</span> &#123;Name <span class="hljs-keyword">string</span>&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(d *Duck)</span> <span class="hljs-title">GetName</span><span class="hljs-params">()</span> <span class="hljs-title">string</span></span> &#123;  <span class="hljs-comment">// å®ç°è€…æ²¡æœ‰æŒ‡æ˜å®ç°äº†å“ªä¸ªæ¥å£</span><span class="hljs-keyword">if</span> d.Name != <span class="hljs-string">&quot;&quot;</span> &#123;<span class="hljs-keyword">return</span> d.Name&#125; <span class="hljs-keyword">else</span> &#123;<span class="hljs-keyword">return</span> <span class="hljs-string">&quot;è¿™æ˜¯ä¸€ä¸ªé¸­å­ï¼&quot;</span>&#125;&#125;<span class="hljs-comment">// offer/note/interfaces/duckI.go</span><span class="hljs-keyword">package</span> interfaces<span class="hljs-keyword">import</span> <span class="hljs-string">&quot;fmt&quot;</span><span class="hljs-keyword">type</span> DuckI <span class="hljs-keyword">interface</span> &#123;  <span class="hljs-comment">// ä½¿ç”¨æ¥å£è€… å®šä¹‰æ–¹æ³•</span>GetName() <span class="hljs-keyword">string</span>&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">FindDuck</span><span class="hljs-params">(d DuckI)</span></span>  &#123; <span class="hljs-comment">// æ¥å£å˜é‡è‡ªå¸¦æŒ‡é’ˆ</span>name := d.GetName()fmt.Println(name)&#125;<span class="hljs-comment">// offer/note/main.go</span><span class="hljs-keyword">package</span> main<span class="hljs-keyword">import</span> (<span class="hljs-string">&quot;offer/note/interfaces&quot;</span><span class="hljs-string">&quot;offer/note/interfaces/mock&quot;</span>)<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;  interfaces.FindDuck(&amp;mock.Duck&#123;&#125;)  interfaces.FindDuck(&amp;mock.Duck&#123;Name:<span class="hljs-string">&quot;è¿™æ˜¯ä¸€åªå‡é¸­å­&quot;</span>&#125;)&#125;<span class="hljs-comment">// è¾“å‡º</span>è¿™æ˜¯ä¸€ä¸ªé¸­å­ï¼è¿™æ˜¯ä¸€åªå‡é¸­å­</code></pre><h5 id="å¤šæ€"><a href="#å¤šæ€" class="headerlink" title="å¤šæ€"></a>å¤šæ€</h5><pre><code class="hljs go"><span class="hljs-keyword">type</span> MemberRights <span class="hljs-keyword">interface</span> &#123; Information () <span class="hljs-keyword">string</span>&#125;<span class="hljs-keyword">type</span> BronzeMember <span class="hljs-keyword">struct</span> &#123; Discount <span class="hljs-keyword">uint8</span>&#125;<span class="hljs-keyword">type</span> SilverMember <span class="hljs-keyword">struct</span> &#123; Discount <span class="hljs-keyword">uint8</span>&#125;<span class="hljs-keyword">type</span> GoldMember <span class="hljs-keyword">struct</span> &#123; Discount <span class="hljs-keyword">uint8</span>&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(b *BronzeMember)</span> <span class="hljs-title">Information</span> <span class="hljs-params">()</span> <span class="hljs-title">string</span></span> &#123; <span class="hljs-keyword">return</span> fmt.Sprintf(<span class="hljs-string">&quot;Discount:%d&quot;</span>, b.Discount)&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(s *SilverMember)</span> <span class="hljs-title">Information</span> <span class="hljs-params">()</span> <span class="hljs-title">string</span></span> &#123; <span class="hljs-keyword">return</span> fmt.Sprintf(<span class="hljs-string">&quot;Discount:%d&quot;</span>, s.Discount)&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(g *GoldMember)</span> <span class="hljs-title">Information</span> <span class="hljs-params">()</span> <span class="hljs-title">string</span></span> &#123; <span class="hljs-keyword">return</span> fmt.Sprintf(<span class="hljs-string">&quot;Discount:%d&quot;</span>, g.Discount)&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">Price</span> <span class="hljs-params">(m MemberRights)</span></span> &#123; fmt.Println(m.Information())&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span> <span class="hljs-params">()</span></span> &#123; b := &amp;BronzeMember&#123;Discount: <span class="hljs-number">9</span>&#125; Price(b) s := &amp;SilverMember&#123;<span class="hljs-number">8</span>&#125; Price(s) g := <span class="hljs-built_in">new</span>(GoldMember) g.Discount = <span class="hljs-number">7</span> Price(g)&#125;</code></pre><h4 id="ä»»ä½•ç±»å‹"><a href="#ä»»ä½•ç±»å‹" class="headerlink" title="ä»»ä½•ç±»å‹"></a>ä»»ä½•ç±»å‹</h4><p><code>interface&#123;&#125;</code></p><pre><code class="hljs go"><span class="hljs-keyword">type</span> Queue []<span class="hljs-keyword">interface</span>&#123;&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(q *Queue)</span><span class="hljs-title">Push</span><span class="hljs-params">(val <span class="hljs-keyword">interface</span>&#123;&#125;)</span> <span class="hljs-title">error</span></span> &#123;*q = <span class="hljs-built_in">append</span>(*q, val)<span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(q *Queue)</span><span class="hljs-title">Pop</span><span class="hljs-params">()</span> <span class="hljs-params">(<span class="hljs-keyword">interface</span>&#123;&#125;,<span class="hljs-keyword">bool</span>)</span></span> &#123;<span class="hljs-keyword">if</span> q.IsEmpty() &#123;<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>, <span class="hljs-literal">false</span>&#125;head := (*q)[<span class="hljs-number">0</span>]*q = (*q)[<span class="hljs-number">1</span>:]<span class="hljs-keyword">return</span> head, <span class="hljs-literal">true</span>&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(q *Queue)</span><span class="hljs-title">IsEmpty</span><span class="hljs-params">()</span> <span class="hljs-title">bool</span></span> &#123;<span class="hljs-keyword">return</span> <span class="hljs-built_in">len</span>(*q) == <span class="hljs-number">0</span>&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;  q := interfaces.Queue&#123;&#125;_ = q.Push(<span class="hljs-string">&quot;asd&quot;</span>)_ = q.Push(<span class="hljs-number">123</span>)<span class="hljs-keyword">if</span> v, ok := q.Pop(); ok &#123;fmt.Println(v)&#125;<span class="hljs-keyword">if</span> v, ok := q.Pop(); ok &#123;fmt.Println(v)&#125;&#125;<span class="hljs-comment">// è¾“å‡º</span>asd<span class="hljs-number">123</span></code></pre><h4 id="ç»„åˆ"><a href="#ç»„åˆ" class="headerlink" title="ç»„åˆ"></a>ç»„åˆ</h4><pre><code class="hljs go"><span class="hljs-comment">// offer/note/interfaces/animals.go</span><span class="hljs-keyword">package</span> animal<span class="hljs-keyword">import</span> <span class="hljs-string">&quot;fmt&quot;</span><span class="hljs-keyword">type</span> AnimalsI <span class="hljs-keyword">interface</span> &#123;DuckIBehaviorI&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">DuckBehavior</span><span class="hljs-params">(a AnimalsI)</span></span>  &#123;name := a.GetName()dark := a.Shout(<span class="hljs-string">&quot;å‘±å‘±ä¹±å«&quot;</span>)fmt.Println(name, dark)  fmt.Println(a.String())&#125;<span class="hljs-comment">// offer/note/interfaces/behaviorI.go</span><span class="hljs-keyword">package</span> animal<span class="hljs-keyword">type</span> BehaviorI <span class="hljs-keyword">interface</span> &#123;Shout(dark <span class="hljs-keyword">string</span>) <span class="hljs-keyword">string</span>&#125;<span class="hljs-comment">// offer/note/interfaces/duckI.go</span><span class="hljs-keyword">package</span> animal<span class="hljs-keyword">type</span> DuckI <span class="hljs-keyword">interface</span> &#123;GetName() <span class="hljs-keyword">string</span>&#125;<span class="hljs-comment">// offer/note/interfaces/mock/duck.go</span><span class="hljs-keyword">package</span> mock<span class="hljs-keyword">type</span> Duck <span class="hljs-keyword">struct</span> &#123;name <span class="hljs-keyword">string</span>bark <span class="hljs-keyword">string</span>&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(d *Duck)</span> <span class="hljs-title">GetName</span><span class="hljs-params">()</span> <span class="hljs-title">string</span></span> &#123;<span class="hljs-keyword">if</span> d.name != <span class="hljs-string">&quot;&quot;</span> &#123;<span class="hljs-keyword">return</span> d.name&#125; <span class="hljs-keyword">else</span> &#123;<span class="hljs-keyword">return</span> <span class="hljs-string">&quot;è¿™æ˜¯ä¸€ä¸ªé¸­å­&quot;</span>&#125;&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(d *Duck)</span> <span class="hljs-title">Shout</span><span class="hljs-params">(dark <span class="hljs-keyword">string</span>)</span> <span class="hljs-title">string</span></span> &#123;<span class="hljs-keyword">if</span> d.bark == <span class="hljs-string">&quot;&quot;</span>&#123;<span class="hljs-keyword">return</span> <span class="hljs-string">&quot;å‘±å‘±å‘±å‘±çš„å«&quot;</span>&#125;<span class="hljs-keyword">else</span> &#123;<span class="hljs-keyword">return</span> dark&#125;&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(d *Duck)</span> <span class="hljs-title">String</span><span class="hljs-params">()</span> <span class="hljs-title">string</span></span> &#123;<span class="hljs-keyword">return</span> fmt.Sprintf(<span class="hljs-string">&quot;Duck: &#123; name = %s, bark = %s &#125;&quot;</span>, d.name, d.bark)&#125;<span class="hljs-comment">// è¾“å‡º</span>è¿™æ˜¯ä¸€ä¸ªé¸­å­ å‘±å‘±å‘±å‘±çš„å«Duck: &#123; name = , bark =  &#125;</code></pre><p><a href="https://github.com/weitrue/note/tree/master/go/interfaces">https://github.com/weitrue/note/tree/master/go/interfaces</a></p><h4 id="å¸¸ç”¨æ¥å£"><a href="#å¸¸ç”¨æ¥å£" class="headerlink" title="å¸¸ç”¨æ¥å£"></a>å¸¸ç”¨æ¥å£</h4><ul><li><code>Stringer</code>ç›¸å½“äºtoString()</li></ul><pre><code class="hljs go"><span class="hljs-keyword">type</span> Stringer <span class="hljs-keyword">interface</span> &#123;String() <span class="hljs-keyword">string</span>&#125;</code></pre><ul><li><code>Reader</code></li><li><code>Writer</code></li></ul><pre><code class="hljs go"><span class="hljs-comment">// io/io.go</span><span class="hljs-comment">// Reader is the interface that wraps the basic Read method.</span><span class="hljs-comment">//</span><span class="hljs-comment">// Read reads up to len(p) bytes into p. It returns the number of bytes</span><span class="hljs-comment">// read (0 &lt;= n &lt;= len(p)) and any error encountered. Even if Read</span><span class="hljs-comment">// returns n &lt; len(p), it may use all of p as scratch space during the call.</span><span class="hljs-comment">// If some data is available but not len(p) bytes, Read conventionally</span><span class="hljs-comment">// returns what is available instead of waiting for more.</span><span class="hljs-comment">//</span><span class="hljs-comment">// When Read encounters an error or end-of-file condition after</span><span class="hljs-comment">// successfully reading n &gt; 0 bytes, it returns the number of</span><span class="hljs-comment">// bytes read. It may return the (non-nil) error from the same call</span><span class="hljs-comment">// or return the error (and n == 0) from a subsequent call.</span><span class="hljs-comment">// An instance of this general case is that a Reader returning</span><span class="hljs-comment">// a non-zero number of bytes at the end of the input stream may</span><span class="hljs-comment">// return either err == EOF or err == nil. The next Read should</span><span class="hljs-comment">// return 0, EOF.</span><span class="hljs-comment">//</span><span class="hljs-comment">// Callers should always process the n &gt; 0 bytes returned before</span><span class="hljs-comment">// considering the error err. Doing so correctly handles I/O errors</span><span class="hljs-comment">// that happen after reading some bytes and also both of the</span><span class="hljs-comment">// allowed EOF behaviors.</span><span class="hljs-comment">//</span><span class="hljs-comment">// Implementations of Read are discouraged from returning a</span><span class="hljs-comment">// zero byte count with a nil error, except when len(p) == 0.</span><span class="hljs-comment">// Callers should treat a return of 0 and nil as indicating that</span><span class="hljs-comment">// nothing happened; in particular it does not indicate EOF.</span><span class="hljs-comment">//</span><span class="hljs-comment">// Implementations must not retain p.</span><span class="hljs-keyword">type</span> Reader <span class="hljs-keyword">interface</span> &#123;Read(p []<span class="hljs-keyword">byte</span>) (n <span class="hljs-keyword">int</span>, err error)&#125;<span class="hljs-comment">// Writer is the interface that wraps the basic Write method.</span><span class="hljs-comment">//</span><span class="hljs-comment">// Write writes len(p) bytes from p to the underlying data stream.</span><span class="hljs-comment">// It returns the number of bytes written from p (0 &lt;= n &lt;= len(p))</span><span class="hljs-comment">// and any error encountered that caused the write to stop early.</span><span class="hljs-comment">// Write must return a non-nil error if it returns n &lt; len(p).</span><span class="hljs-comment">// Write must not modify the slice data, even temporarily.</span><span class="hljs-comment">//</span><span class="hljs-comment">// Implementations must not retain p.</span><span class="hljs-keyword">type</span> Writer <span class="hljs-keyword">interface</span> &#123;Write(p []<span class="hljs-keyword">byte</span>) (n <span class="hljs-keyword">int</span>, err error)&#125;<span class="hljs-comment">// ReadWriter is the interface that groups the basic Read and Write methods.</span><span class="hljs-keyword">type</span> ReadWriter <span class="hljs-keyword">interface</span> &#123;ReaderWriter&#125;</code></pre><h3 id="å‡½æ•°"><a href="#å‡½æ•°" class="headerlink" title="å‡½æ•°"></a>å‡½æ•°</h3><ul><li>å‡½æ•°å¯ä»¥æœ‰å¤šä¸ªè¿”å›å€¼ï¼Œå¹¶ä¸”è¿™äº›è¿”å›å€¼å¯ä»¥èµ·åˆ«åï¼ˆåˆ«åå¤šç”¨äºç®€å•å‡½æ•°ï¼‰ï¼Œåˆ«åä¸è°ƒç”¨è€…çš„ç”³æ˜å˜é‡å¹¶æ— å…³è”</li></ul><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<span class="hljs-keyword">import</span> <span class="hljs-string">&quot;fmt&quot;</span><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">eval</span><span class="hljs-params">(a, b <span class="hljs-keyword">int</span>, op <span class="hljs-keyword">string</span>)</span> <span class="hljs-params">(<span class="hljs-keyword">int</span>, error)</span></span> &#123;<span class="hljs-keyword">switch</span> op &#123;<span class="hljs-keyword">case</span> <span class="hljs-string">&quot;+&quot;</span>:<span class="hljs-keyword">return</span>  a + b, <span class="hljs-literal">nil</span><span class="hljs-keyword">case</span> <span class="hljs-string">&quot;-&quot;</span>:<span class="hljs-keyword">return</span> a - b, <span class="hljs-literal">nil</span><span class="hljs-keyword">case</span> <span class="hljs-string">&quot;*&quot;</span>:<span class="hljs-keyword">return</span> a * b, <span class="hljs-literal">nil</span><span class="hljs-keyword">case</span> <span class="hljs-string">&quot;/&quot;</span>:r, _ := div(a, b)<span class="hljs-keyword">return</span> r, <span class="hljs-literal">nil</span><span class="hljs-keyword">default</span>:<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>, fmt.Errorf(<span class="hljs-string">&quot;unsupported operation&quot;</span>)&#125;&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">div</span><span class="hljs-params">(a, b <span class="hljs-keyword">int</span>)</span> <span class="hljs-params">(q, r <span class="hljs-keyword">int</span>)</span></span> &#123;<span class="hljs-keyword">return</span> a/b, a%b&#125;</code></pre><ul><li><em>ä¸€ç­‰å…¬æ°‘</em> :å˜é‡ã€å‚æ•°ã€è¿”å›å€¼å‡å¯ä»¥æ˜¯å‡½æ•°</li></ul><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<span class="hljs-keyword">import</span> (<span class="hljs-string">&quot;fmt&quot;</span><span class="hljs-string">&quot;math&quot;</span><span class="hljs-string">&quot;reflect&quot;</span><span class="hljs-string">&quot;runtime&quot;</span>)<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">apply</span><span class="hljs-params">(op <span class="hljs-keyword">func</span>(<span class="hljs-keyword">int</span>, <span class="hljs-keyword">int</span>)</span> <span class="hljs-title">float64</span>, <span class="hljs-title">a</span>, <span class="hljs-title">b</span> <span class="hljs-title">int</span>) <span class="hljs-title">float64</span></span> &#123;<span class="hljs-comment">//</span>p := reflect.ValueOf(op).Pointer()opName := runtime.FuncForPC(p).Name()fmt.Printf(<span class="hljs-string">&quot;Calling function %s with params (%d, %d)\n&quot;</span>, opName, a, b)<span class="hljs-keyword">return</span> op(<span class="hljs-keyword">int</span>(a), <span class="hljs-keyword">int</span>(b))&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">pow</span><span class="hljs-params">(a, b <span class="hljs-keyword">int</span>)</span> <span class="hljs-title">float64</span></span> &#123;<span class="hljs-keyword">return</span> math.Pow(<span class="hljs-keyword">float64</span>(a), <span class="hljs-keyword">float64</span>(b))&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;fmt.Println(apply(pow, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>))<span class="hljs-comment">// åŒ¿åå‡½æ•°æ–¹å¼</span>fmt.Println(apply(<span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(f, f2 <span class="hljs-keyword">int</span>)</span> <span class="hljs-title">float64</span></span> &#123;<span class="hljs-keyword">return</span> math.Pow(<span class="hljs-keyword">float64</span>(f), <span class="hljs-keyword">float64</span>(f2))&#125;, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>))&#125;<span class="hljs-comment">// æ‰“å°ç»“æœ</span>Calling function main.pow with params (<span class="hljs-number">3</span>, <span class="hljs-number">4</span>)<span class="hljs-number">81</span>Calling function main.main.func1 with params (<span class="hljs-number">3</span>, <span class="hljs-number">4</span>)<span class="hljs-number">81</span></code></pre><ul><li>å¯å˜å‚æ•°åˆ—è¡¨ï¼Œç±»ä¼¼äºPythonä¸­çš„*args</li></ul><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">sum</span><span class="hljs-params">(nums ...<span class="hljs-keyword">int</span>)</span> <span class="hljs-title">int</span></span> &#123;<span class="hljs-comment">// å‡½æ•°å¯å˜å‚æ•°åˆ—è¡¨</span>sum := <span class="hljs-number">0</span><span class="hljs-keyword">for</span> i := <span class="hljs-keyword">range</span> nums &#123;sum += nums[i]&#125;<span class="hljs-keyword">return</span> sum&#125;</code></pre><p><a href="https://github.com/weitrue/note/blob/master/go/functions/func.go">https://github.com/weitrue/note/blob/master/go/functions/func.go</a></p><h4 id="é—­åŒ…"><a href="#é—­åŒ…" class="headerlink" title="é—­åŒ…"></a>é—­åŒ…</h4><p><img src="/images/golang/func.png"></p><p>å…¶ä¸­ï¼Œ<code>func(i int)</code>ä¸­<code>i</code>ä¸ºå±€éƒ¨å˜é‡ï¼Œ<code>sum</code>ä¸ºè‡ªç”±å˜é‡</p><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">adder</span><span class="hljs-params">()</span> <span class="hljs-title">func</span><span class="hljs-params">(<span class="hljs-keyword">int</span>)</span> <span class="hljs-title">int</span></span> &#123;sum := <span class="hljs-number">0</span><span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(i <span class="hljs-keyword">int</span>)</span> <span class="hljs-title">int</span></span> &#123;sum += i<span class="hljs-keyword">return</span> sum&#125;&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">TestAdder</span><span class="hljs-params">()</span></span>  &#123;a := adder()<span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span> ; i++ &#123;fmt.Printf(<span class="hljs-string">&quot;0 + ... + %d = %d \n&quot;</span>, i, a(i))&#125;&#125;<span class="hljs-comment">// è¾“å‡º</span><span class="hljs-number">0</span> + ... + <span class="hljs-number">0</span> = <span class="hljs-number">0</span> <span class="hljs-number">0</span> + ... + <span class="hljs-number">1</span> = <span class="hljs-number">1</span> <span class="hljs-number">0</span> + ... + <span class="hljs-number">2</span> = <span class="hljs-number">3</span> <span class="hljs-number">0</span> + ... + <span class="hljs-number">3</span> = <span class="hljs-number">6</span> <span class="hljs-number">0</span> + ... + <span class="hljs-number">4</span> = <span class="hljs-number">10</span> <span class="hljs-number">0</span> + ... + <span class="hljs-number">5</span> = <span class="hljs-number">15</span> <span class="hljs-number">0</span> + ... + <span class="hljs-number">6</span> = <span class="hljs-number">21</span> <span class="hljs-number">0</span> + ... + <span class="hljs-number">7</span> = <span class="hljs-number">28</span> <span class="hljs-number">0</span> + ... + <span class="hljs-number">8</span> = <span class="hljs-number">36</span> <span class="hljs-number">0</span> + ... + <span class="hljs-number">9</span> = <span class="hljs-number">45</span> <span class="hljs-comment">// æ­£ç»Ÿå‡½æ•°å¼ç¼–ç¨‹</span><span class="hljs-keyword">type</span> iAdder <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(<span class="hljs-keyword">int</span>)</span> <span class="hljs-params">(<span class="hljs-keyword">int</span>, iAdder)</span></span><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">iAdd</span><span class="hljs-params">(base <span class="hljs-keyword">int</span>)</span> <span class="hljs-title">iAdder</span></span> &#123;<span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(v <span class="hljs-keyword">int</span>)</span> <span class="hljs-params">(<span class="hljs-keyword">int</span>, iAdder)</span></span> &#123;<span class="hljs-keyword">return</span> base +v, iAdd(base+v)&#125;&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">TestAdder</span><span class="hljs-params">()</span></span> &#123;a2 := iAdd(<span class="hljs-number">0</span>)<span class="hljs-keyword">var</span> s <span class="hljs-keyword">int</span><span class="hljs-keyword">for</span> i := <span class="hljs-number">1</span>; i &lt;<span class="hljs-number">10</span>; i++ &#123;s, a2 = a2(i)fmt.Printf(<span class="hljs-string">&quot;0 + ... + %d = %d \n&quot;</span>, i, s)&#125;&#125;<span class="hljs-comment">// è¾“å‡º</span><span class="hljs-number">0</span> + ... + <span class="hljs-number">1</span> = <span class="hljs-number">1</span> <span class="hljs-number">0</span> + ... + <span class="hljs-number">2</span> = <span class="hljs-number">3</span> <span class="hljs-number">0</span> + ... + <span class="hljs-number">3</span> = <span class="hljs-number">6</span> <span class="hljs-number">0</span> + ... + <span class="hljs-number">4</span> = <span class="hljs-number">10</span> <span class="hljs-number">0</span> + ... + <span class="hljs-number">5</span> = <span class="hljs-number">15</span> <span class="hljs-number">0</span> + ... + <span class="hljs-number">6</span> = <span class="hljs-number">21</span> <span class="hljs-number">0</span> + ... + <span class="hljs-number">7</span> = <span class="hljs-number">28</span> <span class="hljs-number">0</span> + ... + <span class="hljs-number">8</span> = <span class="hljs-number">36</span> <span class="hljs-number">0</span> + ... + <span class="hljs-number">9</span> = <span class="hljs-number">45</span></code></pre><p><a href="https://github.com/weitrue/note/blob/master/go/functions/closure.go">https://github.com/weitrue/note/blob/master/go/functions/closure.go</a></p><h5 id="Pythonä¸­çš„é—­åŒ…"><a href="#Pythonä¸­çš„é—­åŒ…" class="headerlink" title="Pythonä¸­çš„é—­åŒ…"></a>Pythonä¸­çš„é—­åŒ…</h5><p>PythonåŸç”Ÿæ”¯æŒé—­åŒ…</p><p><code>__closure__</code>å¯ä»¥æŸ¥çœ‹é—­åŒ…å†…å®¹</p><pre><code class="hljs Python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">adder</span>():</span>    s = <span class="hljs-number">0</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">f</span>(<span class="hljs-params">v: <span class="hljs-built_in">int</span></span>):</span>        <span class="hljs-keyword">nonlocal</span> s        s += v        <span class="hljs-keyword">return</span> s    <span class="hljs-keyword">return</span> f<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:    a = adder()    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):        print(i, a(i), a.__closure__)        <span class="hljs-comment"># è¾“å‡º</span><span class="hljs-number">0</span> <span class="hljs-number">0</span> (&lt;cell at <span class="hljs-number">0x7f9048e7d3d0</span>: <span class="hljs-built_in">int</span> <span class="hljs-built_in">object</span> at <span class="hljs-number">0x106eb6290</span>&gt;,)<span class="hljs-number">1</span> <span class="hljs-number">1</span> (&lt;cell at <span class="hljs-number">0x7f9048e7d3d0</span>: <span class="hljs-built_in">int</span> <span class="hljs-built_in">object</span> at <span class="hljs-number">0x106eb62b0</span>&gt;,)<span class="hljs-number">2</span> <span class="hljs-number">3</span> (&lt;cell at <span class="hljs-number">0x7f9048e7d3d0</span>: <span class="hljs-built_in">int</span> <span class="hljs-built_in">object</span> at <span class="hljs-number">0x106eb62f0</span>&gt;,)<span class="hljs-number">3</span> <span class="hljs-number">6</span> (&lt;cell at <span class="hljs-number">0x7f9048e7d3d0</span>: <span class="hljs-built_in">int</span> <span class="hljs-built_in">object</span> at <span class="hljs-number">0x106eb6350</span>&gt;,)<span class="hljs-number">4</span> <span class="hljs-number">10</span> (&lt;cell at <span class="hljs-number">0x7f9048e7d3d0</span>: <span class="hljs-built_in">int</span> <span class="hljs-built_in">object</span> at <span class="hljs-number">0x106eb63d0</span>&gt;,)<span class="hljs-number">5</span> <span class="hljs-number">15</span> (&lt;cell at <span class="hljs-number">0x7f9048e7d3d0</span>: <span class="hljs-built_in">int</span> <span class="hljs-built_in">object</span> at <span class="hljs-number">0x106eb6470</span>&gt;,)<span class="hljs-number">6</span> <span class="hljs-number">21</span> (&lt;cell at <span class="hljs-number">0x7f9048e7d3d0</span>: <span class="hljs-built_in">int</span> <span class="hljs-built_in">object</span> at <span class="hljs-number">0x106eb6530</span>&gt;,)<span class="hljs-number">7</span> <span class="hljs-number">28</span> (&lt;cell at <span class="hljs-number">0x7f9048e7d3d0</span>: <span class="hljs-built_in">int</span> <span class="hljs-built_in">object</span> at <span class="hljs-number">0x106eb6610</span>&gt;,)<span class="hljs-number">8</span> <span class="hljs-number">36</span> (&lt;cell at <span class="hljs-number">0x7f9048e7d3d0</span>: <span class="hljs-built_in">int</span> <span class="hljs-built_in">object</span> at <span class="hljs-number">0x106eb6710</span>&gt;,)<span class="hljs-number">9</span> <span class="hljs-number">45</span> (&lt;cell at <span class="hljs-number">0x7f9048e7d3d0</span>: <span class="hljs-built_in">int</span> <span class="hljs-built_in">object</span> at <span class="hljs-number">0x106eb6830</span>&gt;,)</code></pre><h5 id="Javaä¸­çš„é—­åŒ…"><a href="#Javaä¸­çš„é—­åŒ…" class="headerlink" title="Javaä¸­çš„é—­åŒ…"></a>Javaä¸­çš„é—­åŒ…</h5><p>1.8ä»¥åï¼Œå¯ä»¥ä½¿ç”¨Functionæ¥å£å’ŒLambdaè¡¨è¾¾å¼å¯ä»¥åˆ›å»ºå‡½æ•°å¯¹è±¡ï¼›</p><p>1.8ä¹‹å‰ï¼Œå¯ä»¥ä½¿ç”¨Lambdaè¡¨è¾¾å¼æˆ–è€…åŒ¿åå†…éƒ¨ç±»ä¹Ÿå¯ä»¥å®ç°é—­åŒ…ï¼›</p><pre><code class="hljs Java"><span class="hljs-keyword">import</span> javax.xml.ws.Holder;<span class="hljs-keyword">import</span> java.util.function.Function;<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyTest</span> </span>&#123;    <span class="hljs-keyword">final</span> Holder&lt;Integer&gt; sum = <span class="hljs-keyword">new</span> Holder&lt;&gt;(<span class="hljs-number">0</span>);    <span class="hljs-keyword">public</span>  Function&lt;Integer, Integer&gt;testClosure()&#123;        <span class="hljs-comment">// é—­åŒ…  ä½¿ç”¨Functionæ¥å£å’ŒLambdaè¡¨è¾¾å¼å¯ä»¥åˆ›å»ºå‡½æ•°å¯¹è±¡</span>        <span class="hljs-keyword">return</span> (Integer value) -&gt; &#123;            sum.value += value;            <span class="hljs-keyword">return</span> sum.value;        &#125;;    &#125;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;        MyTest mt = <span class="hljs-keyword">new</span> MyTest();        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++) &#123;            System.out.println(i +<span class="hljs-string">&quot;, &quot;</span>+ mt.testClosure().apply(<span class="hljs-keyword">new</span> Integer(i)));        &#125;    &#125;&#125;</code></pre><h4 id="é—­åŒ…åº”ç”¨"><a href="#é—­åŒ…åº”ç”¨" class="headerlink" title="é—­åŒ…åº”ç”¨"></a>é—­åŒ…åº”ç”¨</h4><h6 id="ä¸ºå‡½æ•°å®ç°æ¥å£"><a href="#ä¸ºå‡½æ•°å®ç°æ¥å£" class="headerlink" title="ä¸ºå‡½æ•°å®ç°æ¥å£"></a>ä¸ºå‡½æ•°å®ç°æ¥å£</h6><h6 id="å®ç°å‡½æ•°éå†äºŒå‰æ ‘"><a href="#å®ç°å‡½æ•°éå†äºŒå‰æ ‘" class="headerlink" title="å®ç°å‡½æ•°éå†äºŒå‰æ ‘"></a>å®ç°å‡½æ•°éå†äºŒå‰æ ‘</h6><h3 id="defer-recoveråœ¨ç®€å•webæœåŠ¡åº”ç”¨"><a href="#defer-recoveråœ¨ç®€å•webæœåŠ¡åº”ç”¨" class="headerlink" title="defer/recoveråœ¨ç®€å•webæœåŠ¡åº”ç”¨"></a>defer/recoveråœ¨ç®€å•webæœåŠ¡åº”ç”¨</h3><p>ä»£ç ç»“æ„<img src="/images/golang/web.jpg"></p><p><a href="https://github.com/weitrue/note/tree/master/go/web/">https://github.com/weitrue/note/tree/master/go/web/</a></p><h3 id="åŒ…ç®¡ç†"><a href="#åŒ…ç®¡ç†" class="headerlink" title="åŒ…ç®¡ç†"></a>åŒ…ç®¡ç†</h3><h4 id="gopm-è·å–æ— æ³•ä¸‹è½½çš„åŒ…"><a href="#gopm-è·å–æ— æ³•ä¸‹è½½çš„åŒ…" class="headerlink" title="gopm è·å–æ— æ³•ä¸‹è½½çš„åŒ…"></a>gopm è·å–æ— æ³•ä¸‹è½½çš„åŒ…</h4><p><code>go get -v github.com/gpmgo/gopm</code></p><p>githubåœ°å€ï¼š<a href="https://github.com/gpmgo/gopm">https://github.com/gpmgo/gopm</a></p><p>æ–‡æ¡£è·¯å¾„ï¼š<a href="https://github.com/gpmgo/docs/tree/master/zh-CN">https://github.com/gpmgo/docs/tree/master/zh-CN</a></p><p>å®‰è£…è¸©å‘ï¼š</p><pre><code class="hljs zsh">github.com/codegangsta/cli: github.com/codegangsta/cli@v1.22.5: parsing go.mod:module declares its path as: github.com/urfave/cli        but was required as: github.com/codegangsta/cli</code></pre><p>å…³é—­go modå³å¯æˆåŠŸå®‰è£…</p><h3 id="ç¬”è¯•é¢˜"><a href="#ç¬”è¯•é¢˜" class="headerlink" title="ç¬”è¯•é¢˜"></a>ç¬”è¯•é¢˜</h3><h4 id="é€‰æ‹©é¢˜"><a href="#é€‰æ‹©é¢˜" class="headerlink" title="é€‰æ‹©é¢˜"></a>é€‰æ‹©é¢˜</h4><p>1.[primary] ä¸‹é¢å±äºå…³é”®å­—çš„æ˜¯ï¼ˆï¼‰<br>A. func<br>B. def<br>C. struct<br>D. classâ€‹</p><p>AC</p><p>2.[primary] å®šä¹‰ä¸€ä¸ªåŒ…å†…å…¨å±€å­—ç¬¦ä¸²å˜é‡ï¼Œä¸‹é¢è¯­æ³•æ­£ç¡®çš„æ˜¯ ï¼ˆï¼‰<br>A. var str string<br>B. str := â€œâ€<br>C. str = â€œâ€<br>D. var str = â€œâ€</p><p>AD</p><p>3.[primary] é€šè¿‡æŒ‡é’ˆå˜é‡ p è®¿é—®å…¶æˆå‘˜å˜é‡ nameï¼Œä¸‹é¢è¯­æ³•æ­£ç¡®çš„æ˜¯ï¼ˆï¼‰<br>A. p.name<br>B. (*p).name<br>C. (&amp;p).name<br>D. p-&gt;name</p><p>AB</p><p>4.[primary] å…³äºæ¥å£å’Œç±»çš„è¯´æ³•ï¼Œä¸‹é¢è¯´æ³•æ­£ç¡®çš„æ˜¯ï¼ˆï¼‰<br>A. ä¸€ä¸ªç±»åªéœ€è¦å®ç°äº†æ¥å£è¦æ±‚çš„æ‰€æœ‰å‡½æ•°ï¼Œæˆ‘ä»¬å°±è¯´è¿™ä¸ªç±»å®ç°äº†è¯¥æ¥å£<br>B. å®ç°ç±»çš„æ—¶å€™ï¼Œåªéœ€è¦å…³å¿ƒè‡ªå·±åº”è¯¥æä¾›å“ªäº›æ–¹æ³•ï¼Œä¸ç”¨å†çº ç»“æ¥å£éœ€è¦æ‹†å¾—å¤šç»†æ‰åˆç†<br>C. ç±»å®ç°æ¥å£æ—¶ï¼Œéœ€è¦å¯¼å…¥æ¥å£æ‰€åœ¨çš„åŒ…<br>D. æ¥å£ç”±ä½¿ç”¨æ–¹æŒ‰è‡ªèº«éœ€æ±‚æ¥å®šä¹‰ï¼Œä½¿ç”¨æ–¹æ— éœ€å…³å¿ƒæ˜¯å¦æœ‰å…¶ä»–æ¨¡å—å®šä¹‰è¿‡ç±»ä¼¼çš„æ¥å£</p><p>ABD</p><p>5.[primary] å…³äºå­—ç¬¦ä¸²è¿æ¥ï¼Œä¸‹é¢è¯­æ³•æ­£ç¡®çš„æ˜¯ï¼ˆï¼‰<br>A. str := â€˜abcâ€™ + â€˜123â€™<br>B. str := â€œabcâ€ + â€œ123â€<br>C. str ï¼š= â€˜123â€™ + â€œabcâ€<br>D. fmt.Sprintf(â€œabc%dâ€, 123)</p><p>BD</p><p>6.[primary] å…³äºåç¨‹ï¼Œä¸‹é¢è¯´æ³•æ­£ç¡®æ˜¯ï¼ˆï¼‰<br>A. åç¨‹å’Œçº¿ç¨‹éƒ½å¯ä»¥å®ç°ç¨‹åºçš„å¹¶å‘æ‰§è¡Œ<br>B. çº¿ç¨‹æ¯”åç¨‹æ›´è½»é‡çº§<br>C. åç¨‹ä¸å­˜åœ¨æ­»é”é—®é¢˜<br>D. é€šè¿‡channelæ¥è¿›è¡Œåç¨‹é—´çš„é€šä¿¡</p><p>AD</p><p>7.[intermediate] å…³äºinitå‡½æ•°ï¼Œä¸‹é¢è¯´æ³•æ­£ç¡®çš„æ˜¯ï¼ˆï¼‰<br>A. ä¸€ä¸ªåŒ…ä¸­ï¼Œå¯ä»¥åŒ…å«å¤šä¸ªinitå‡½æ•°<br>B. ç¨‹åºç¼–è¯‘æ—¶ï¼Œå…ˆæ‰§è¡Œå¯¼å…¥åŒ…çš„initå‡½æ•°ï¼Œå†æ‰§è¡Œæœ¬åŒ…å†…çš„initå‡½æ•°<br>C. mainåŒ…ä¸­ï¼Œä¸èƒ½æœ‰initå‡½æ•°<br>D. initå‡½æ•°å¯ä»¥è¢«å…¶ä»–å‡½æ•°è°ƒç”¨</p><p>AB</p><p>8.[primary] å…³äºå¾ªç¯è¯­å¥ï¼Œä¸‹é¢è¯´æ³•æ­£ç¡®çš„æœ‰ï¼ˆï¼‰<br>A. å¾ªç¯è¯­å¥æ—¢æ”¯æŒforå…³é”®å­—ï¼Œä¹Ÿæ”¯æŒwhileå’Œdo-while<br>B. å…³é”®å­—forçš„åŸºæœ¬ä½¿ç”¨æ–¹æ³•ä¸C/C++ä¸­æ²¡æœ‰ä»»ä½•å·®å¼‚<br>C. forå¾ªç¯æ”¯æŒcontinueå’Œbreakæ¥æ§åˆ¶å¾ªç¯ï¼Œä½†æ˜¯å®ƒæä¾›äº†ä¸€ä¸ªæ›´é«˜çº§çš„breakï¼Œå¯ä»¥é€‰æ‹©ä¸­æ–­å“ªä¸€ä¸ªå¾ªç¯<br>D. forå¾ªç¯ä¸æ”¯æŒä»¥é€—å·ä¸ºé—´éš”çš„å¤šä¸ªèµ‹å€¼è¯­å¥ï¼Œå¿…é¡»ä½¿ç”¨å¹³è¡Œèµ‹å€¼çš„æ–¹å¼æ¥åˆå§‹åŒ–å¤šä¸ªå˜é‡</p><p>CD</p><p>9.[intermediate] å¯¹äºå‡½æ•°å®šä¹‰ï¼š</p><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">add</span><span class="hljs-params">(args ...<span class="hljs-keyword">int</span>)</span> <span class="hljs-title">int</span></span> &#123;        sum := <span class="hljs-number">0</span>        <span class="hljs-keyword">for</span> _, arg := <span class="hljs-keyword">range</span> args &#123;            sum += arg        &#125;        <span class="hljs-keyword">return</span> sum&#125;</code></pre><p>ä¸‹é¢å¯¹addå‡½æ•°è°ƒç”¨æ­£ç¡®çš„æ˜¯ï¼ˆï¼‰</p><p> A. add(1, 2)<br> B. add(1, 3, 7)<br> C. add([]int{1, 2})<br> D. add([]int{1, 3, 7}â€¦)</p><p>ABD</p><p>10.[primary] å…³äºç±»å‹è½¬åŒ–ï¼Œä¸‹é¢è¯­æ³•æ­£ç¡®çš„æ˜¯ï¼ˆï¼‰<br>A.</p><pre><code class="hljs go"><span class="hljs-keyword">type</span> MyInt <span class="hljs-keyword">int</span><span class="hljs-keyword">var</span> i <span class="hljs-keyword">int</span> = <span class="hljs-number">1</span><span class="hljs-keyword">var</span> j MyInt = i</code></pre><p>B.</p><pre><code class="hljs go"><span class="hljs-keyword">type</span> MyInt <span class="hljs-keyword">int</span><span class="hljs-keyword">var</span> i <span class="hljs-keyword">int</span> = <span class="hljs-number">1</span><span class="hljs-keyword">var</span> j MyInt = (MyInt)i</code></pre><p>C.</p><pre><code class="hljs go"><span class="hljs-keyword">type</span> MyInt <span class="hljs-keyword">int</span><span class="hljs-keyword">var</span> i <span class="hljs-keyword">int</span> = <span class="hljs-number">1</span><span class="hljs-keyword">var</span> j MyInt = MyInt(i)</code></pre><p>D.</p><pre><code class="hljs go"><span class="hljs-keyword">type</span> MyInt <span class="hljs-keyword">int</span><span class="hljs-keyword">var</span> i <span class="hljs-keyword">int</span> = <span class="hljs-number">1</span><span class="hljs-keyword">var</span> j MyInt = i.(MyInt)   <span class="hljs-comment">// Invalid type assertion: i.(MyInt) (non-interface type int on left)</span></code></pre><p>C</p><p>11.[primary] å…³äºå±€éƒ¨å˜é‡çš„åˆå§‹åŒ–ï¼Œä¸‹é¢æ­£ç¡®çš„ä½¿ç”¨æ–¹å¼æ˜¯ï¼ˆï¼‰<br>A. var i int = 10<br>B. var i = 10<br>C. i := 10<br>D. i = 10</p><p>12.[primary] å…³äºconstå¸¸é‡å®šä¹‰ï¼Œä¸‹é¢æ­£ç¡®çš„ä½¿ç”¨æ–¹å¼æ˜¯ï¼ˆï¼‰<br>A.</p><pre><code class="hljs go"><span class="hljs-keyword">const</span> Pi <span class="hljs-keyword">float64</span> = <span class="hljs-number">3.14159265358979323846</span><span class="hljs-keyword">const</span> zero = <span class="hljs-number">0.0</span></code></pre><p>B.</p><pre><code class="hljs go"><span class="hljs-keyword">const</span> (        size <span class="hljs-keyword">int64</span> = <span class="hljs-number">1024</span>        eof = <span class="hljs-number">-1</span>)</code></pre><p>C.</p><pre><code class="hljs go"><span class="hljs-keyword">const</span> (        ERR_ELEM_EXIST error = errors.New(<span class="hljs-string">&quot;element already exists&quot;</span>)        ERR_ELEM_NT_EXIST error = errors.New(<span class="hljs-string">&quot;element not exists&quot;</span>)) <span class="hljs-comment">// Const initializer &#x27;errors.New(&quot;element already exists&quot;)&#x27; is not a constant</span></code></pre><p>D.</p><pre><code class="hljs go"><span class="hljs-keyword">const</span> u, v <span class="hljs-keyword">float32</span> = <span class="hljs-number">0</span>, <span class="hljs-number">3</span><span class="hljs-keyword">const</span> a, b, c = <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-string">&quot;foo&quot;</span></code></pre><p>ABD</p><p>13.[primary] å…³äºå¸ƒå°”å˜é‡bçš„èµ‹å€¼ï¼Œä¸‹é¢é”™è¯¯çš„ç”¨æ³•æ˜¯ï¼ˆï¼‰<br>A. b = true<br>B. b = 1     //  Cannot use â€˜1â€™ (type untyped int) as type bool in assignment<br>C. b = bool(1)   //Cannot convert expression of type int to type bool<br>D. b = (1 == 2)</p><p>BC</p><p>14.[intermediate] ä¸‹é¢çš„ç¨‹åºçš„è¿è¡Œç»“æœæ˜¯ï¼ˆï¼‰</p><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;        <span class="hljs-keyword">if</span> (<span class="hljs-literal">true</span>) &#123;            <span class="hljs-keyword">defer</span> fmt.Printf(<span class="hljs-string">&quot;1&quot;</span>)        &#125; <span class="hljs-keyword">else</span> &#123;            <span class="hljs-keyword">defer</span> fmt.Printf(<span class="hljs-string">&quot;2&quot;</span>)        &#125;        fmt.Printf(<span class="hljs-string">&quot;3&quot;</span>)&#125;</code></pre><p>A. 321<br>B. 32<br>C. 31<br>D. 13</p><p>C</p><p>15.[primary] å…³äºswitchè¯­å¥ï¼Œä¸‹é¢è¯´æ³•æ­£ç¡®çš„æœ‰ï¼ˆï¼‰<br>A. æ¡ä»¶è¡¨è¾¾å¼å¿…é¡»ä¸ºå¸¸é‡æˆ–è€…æ•´æ•°<br>B. å•ä¸ªcaseä¸­ï¼Œå¯ä»¥å‡ºç°å¤šä¸ªç»“æœé€‰é¡¹<br>C. éœ€è¦ç”¨breakæ¥æ˜ç¡®é€€å‡ºä¸€ä¸ªcase<br>D. åªæœ‰åœ¨caseä¸­æ˜ç¡®æ·»åŠ fallthroughå…³é”®å­—ï¼Œæ‰ä¼šç»§ç»­æ‰§è¡Œç´§è·Ÿçš„ä¸‹ä¸€ä¸ªcase</p><p>BD</p><p>16.[intermediate] golangä¸­æ²¡æœ‰éšè—çš„thisæŒ‡é’ˆï¼Œè¿™å¥è¯çš„å«ä¹‰æ˜¯ï¼ˆï¼‰<br>A. æ–¹æ³•æ–½åŠ çš„å¯¹è±¡æ˜¾å¼ä¼ é€’ï¼Œæ²¡æœ‰è¢«éšè—èµ·æ¥<br>B. golangæ²¿è¢­äº†ä¼ ç»Ÿé¢å‘å¯¹è±¡ç¼–ç¨‹ä¸­çš„è¯¸å¤šæ¦‚å¿µï¼Œæ¯”å¦‚ç»§æ‰¿ã€è™šå‡½æ•°å’Œæ„é€ å‡½æ•°<br>C. golangçš„é¢å‘å¯¹è±¡è¡¨è¾¾æ›´ç›´è§‚ï¼Œå¯¹äºé¢å‘è¿‡ç¨‹åªæ˜¯æ¢äº†ä¸€ç§è¯­æ³•å½¢å¼æ¥è¡¨è¾¾<br>D. æ–¹æ³•æ–½åŠ çš„å¯¹è±¡ä¸éœ€è¦éå¾—æ˜¯æŒ‡é’ˆï¼Œä¹Ÿä¸ç”¨éå¾—å«this</p><p>ACD</p><p>17.[intermediate] golangä¸­çš„å¼•ç”¨ç±»å‹åŒ…æ‹¬ï¼ˆï¼‰<br>A. æ•°ç»„åˆ‡ç‰‡<br>B. map<br>C. channel<br>D. interface</p><p>ABCD</p><p>18.[intermediate] golangä¸­çš„æŒ‡é’ˆè¿ç®—åŒ…æ‹¬ï¼ˆï¼‰<br>A. å¯ä»¥å¯¹æŒ‡é’ˆè¿›è¡Œè‡ªå¢æˆ–è‡ªå‡è¿ç®—<br>B. å¯ä»¥é€šè¿‡â€œ&amp;â€å–æŒ‡é’ˆçš„åœ°å€<br>C. å¯ä»¥é€šè¿‡â€œ*â€å–æŒ‡é’ˆæŒ‡å‘çš„æ•°æ®<br>D. å¯ä»¥å¯¹æŒ‡é’ˆè¿›è¡Œä¸‹æ ‡è¿ç®—</p><p>BC</p><p>19.[primary] å…³äºmainå‡½æ•°ï¼ˆå¯æ‰§è¡Œç¨‹åºçš„æ‰§è¡Œèµ·ç‚¹ï¼‰ï¼Œä¸‹é¢è¯´æ³•æ­£ç¡®çš„æ˜¯ï¼ˆï¼‰<br>A. mainå‡½æ•°ä¸èƒ½å¸¦å‚æ•°<br>B. mainå‡½æ•°ä¸èƒ½å®šä¹‰è¿”å›å€¼<br>C. mainå‡½æ•°æ‰€åœ¨çš„åŒ…å¿…é¡»ä¸ºmainåŒ…<br>D. mainå‡½æ•°ä¸­å¯ä»¥ä½¿ç”¨flagåŒ…æ¥è·å–å’Œè§£æå‘½ä»¤è¡Œå‚æ•°</p><p>ABCD</p><p>20.[intermediate] ä¸‹é¢èµ‹å€¼æ­£ç¡®çš„æ˜¯ï¼ˆï¼‰<br>A. var x = nil<br>B. var x interface{} = nil<br>C. var x string = nil<br>D. var x error = nil</p><p>BD</p><p>21.[intermediate] å…³äºæ•´å‹åˆ‡ç‰‡çš„åˆå§‹åŒ–ï¼Œä¸‹é¢æ­£ç¡®çš„æ˜¯ï¼ˆï¼‰<br>A. s := make([]int)<br>B. s := make([]int, 0)<br>C. s := make([]int, 5, 10)<br>D. s := []int{1, 2, 3, 4, 5}</p><p>BCD</p><p>22.[intermediate] ä»åˆ‡ç‰‡ä¸­åˆ é™¤ä¸€ä¸ªå…ƒç´ ï¼Œä¸‹é¢çš„ç®—æ³•å®ç°æ­£ç¡®çš„æ˜¯ï¼ˆï¼‰<br>A.</p><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(s *Slice)</span><span class="hljs-title">Remove</span><span class="hljs-params">(value <span class="hljs-keyword">interface</span>&#123;&#125;)</span> <span class="hljs-title">error</span></span> &#123;        <span class="hljs-keyword">for</span> i, v := <span class="hljs-keyword">range</span> *s &#123;            <span class="hljs-keyword">if</span> isEqual(value, v) &#123;                <span class="hljs-keyword">if</span> i== <span class="hljs-built_in">len</span>(*s) - <span class="hljs-number">1</span> &#123;                    *s = (*s)[:i]                &#125;<span class="hljs-keyword">else</span> &#123;                    *s = <span class="hljs-built_in">append</span>((*s)[:i],(*s)[i + <span class="hljs-number">2</span>:]...)                &#125;                <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>            &#125;        &#125;        <span class="hljs-keyword">return</span> ERR_ELEM_NT_EXIST&#125;</code></pre><p>B.</p><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(s *Slice)</span><span class="hljs-title">Remove</span><span class="hljs-params">(value <span class="hljs-keyword">interface</span>&#123;&#125;)</span> <span class="hljs-title">error</span></span> &#123;        <span class="hljs-keyword">for</span> i, v := <span class="hljs-keyword">range</span> *s &#123;            <span class="hljs-keyword">if</span> isEqual(value, v) &#123;                *s = <span class="hljs-built_in">append</span>((*s)[:i],(*s)[i + <span class="hljs-number">1</span>:])                <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>            &#125;        &#125;        <span class="hljs-keyword">return</span> ERR_ELEM_NT_EXIST&#125;</code></pre><p>C.</p><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(s *Slice)</span><span class="hljs-title">Remove</span><span class="hljs-params">(value <span class="hljs-keyword">interface</span>&#123;&#125;)</span> <span class="hljs-title">error</span></span> &#123;        <span class="hljs-keyword">for</span> i, v := <span class="hljs-keyword">range</span> *s &#123;            <span class="hljs-keyword">if</span> isEqual(value, v) &#123;                <span class="hljs-built_in">delete</span>(*s, v)                <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>            &#125;        &#125;        <span class="hljs-keyword">return</span> ERR_ELEM_NT_EXIST&#125;</code></pre><p>D.</p><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(s *Slice)</span><span class="hljs-title">Remove</span><span class="hljs-params">(value <span class="hljs-keyword">interface</span>&#123;&#125;)</span> <span class="hljs-title">error</span></span> &#123;        <span class="hljs-keyword">for</span> i, v := <span class="hljs-keyword">range</span> *s &#123;            <span class="hljs-keyword">if</span> isEqual(value, v) &#123;                *s = <span class="hljs-built_in">append</span>((*s)[:i],(*s)[i + <span class="hljs-number">1</span>:]...)                <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>            &#125;        &#125;        <span class="hljs-keyword">return</span> ERR_ELEM_NT_EXIST&#125;</code></pre><p>D</p><p>23.[primary] å…³äºå˜é‡çš„è‡ªå¢å’Œè‡ªå‡æ“ä½œï¼Œä¸‹é¢è¯­å¥æ­£ç¡®çš„æ˜¯ï¼ˆï¼‰<br>A.<br>i := 1<br>i++<br>B.</p><p>i := 1<br>j = i++      // â€˜,â€™, â€˜;â€™, new line or â€˜}â€™ expected, got â€˜++â€™<br>C.</p><p>i := 1<br>++i<br>D.</p><p>i := 1<br>iâ€“</p><p>BD</p><p>24.[intermediate] å…³äºå‡½æ•°å£°æ˜ï¼Œä¸‹é¢è¯­æ³•é”™è¯¯çš„æ˜¯ï¼ˆï¼‰<br>A. func f(a, b int) (value int, err error)<br>B. func f(a int, b int) (value int, err error)<br>C. func f(a, b int) (value int, error)<br>D. func f(a int, b int) (int, int, error)</p><p>C</p><p>25.[intermediate] å¦‚æœAddå‡½æ•°çš„è°ƒç”¨ä»£ç ä¸ºï¼š</p><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;        <span class="hljs-keyword">var</span> a Integer = <span class="hljs-number">1</span>        <span class="hljs-keyword">var</span> b Integer = <span class="hljs-number">2</span>        <span class="hljs-keyword">var</span> i <span class="hljs-keyword">interface</span>&#123;&#125; = &amp;a        sum := i.(*Integer).Add(b)        fmt.Println(sum)&#125;</code></pre><p>åˆ™Addå‡½æ•°å®šä¹‰æ­£ç¡®çš„æ˜¯ï¼ˆï¼‰<br>A.</p><pre><code class="hljs go"><span class="hljs-keyword">type</span> Integer <span class="hljs-keyword">int</span><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(a Integer)</span> <span class="hljs-title">Add</span><span class="hljs-params">(b Integer)</span> <span class="hljs-title">Integer</span></span> &#123;        <span class="hljs-keyword">return</span> a + b&#125;</code></pre><p>B.</p><pre><code class="hljs go"><span class="hljs-keyword">type</span> Integer <span class="hljs-keyword">int</span><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(a Integer)</span> <span class="hljs-title">Add</span><span class="hljs-params">(b *Integer)</span> <span class="hljs-title">Integer</span></span> &#123;        <span class="hljs-keyword">return</span> a + *b&#125;</code></pre><p>C.</p><pre><code class="hljs go"><span class="hljs-keyword">type</span> Integer <span class="hljs-keyword">int</span><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(a *Integer)</span> <span class="hljs-title">Add</span><span class="hljs-params">(b Integer)</span> <span class="hljs-title">Integer</span></span> &#123;        <span class="hljs-keyword">return</span> *a + b&#125;</code></pre><p>D.</p><pre><code class="hljs go"><span class="hljs-keyword">type</span> Integer <span class="hljs-keyword">int</span><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(a *Integer)</span> <span class="hljs-title">Add</span><span class="hljs-params">(b *Integer)</span> <span class="hljs-title">Integer</span></span> &#123;        <span class="hljs-keyword">return</span> *a + *b&#125;</code></pre><p>AC<br>26.[intermediate] å¦‚æœAddå‡½æ•°çš„è°ƒç”¨ä»£ç ä¸ºï¼š</p><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;        <span class="hljs-keyword">var</span> a Integer = <span class="hljs-number">1</span>        <span class="hljs-keyword">var</span> b Integer = <span class="hljs-number">2</span>        <span class="hljs-keyword">var</span> i <span class="hljs-keyword">interface</span>&#123;&#125; = a        sum := i.(Integer).Add(b)        fmt.Println(sum)&#125;</code></pre><p>åˆ™Addå‡½æ•°å®šä¹‰æ­£ç¡®çš„æ˜¯ï¼ˆï¼‰<br>A.</p><pre><code class="hljs go"><span class="hljs-keyword">type</span> Integer <span class="hljs-keyword">int</span><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(a Integer)</span> <span class="hljs-title">Add</span><span class="hljs-params">(b Integer)</span> <span class="hljs-title">Integer</span></span> &#123;        <span class="hljs-keyword">return</span> a + b&#125;</code></pre><p>B.</p><pre><code class="hljs go"><span class="hljs-keyword">type</span> Integer <span class="hljs-keyword">int</span><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(a Integer)</span> <span class="hljs-title">Add</span><span class="hljs-params">(b *Integer)</span> <span class="hljs-title">Integer</span></span> &#123;        <span class="hljs-keyword">return</span> a + *b&#125;</code></pre><p>C.</p><pre><code class="hljs go"><span class="hljs-keyword">type</span> Integer <span class="hljs-keyword">int</span><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(a *Integer)</span> <span class="hljs-title">Add</span><span class="hljs-params">(b Integer)</span> <span class="hljs-title">Integer</span></span> &#123;        <span class="hljs-keyword">return</span> *a + b&#125;</code></pre><p>D.</p><pre><code class="hljs go"><span class="hljs-keyword">type</span> Integer <span class="hljs-keyword">int</span><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(a *Integer)</span> <span class="hljs-title">Add</span><span class="hljs-params">(b *Integer)</span> <span class="hljs-title">Integer</span></span> &#123;        <span class="hljs-keyword">return</span> *a + *b&#125;</code></pre><p>AC</p><p>27.[intermediate] å…³äºGetPodActionå®šä¹‰ï¼Œä¸‹é¢èµ‹å€¼æ­£ç¡®çš„æ˜¯ï¼ˆï¼‰</p><pre><code class="hljs go"><span class="hljs-keyword">type</span> Fragment <span class="hljs-keyword">interface</span> &#123;        Exec(transInfo *TransInfo) error&#125;<span class="hljs-keyword">type</span> GetPodAction <span class="hljs-keyword">struct</span> &#123;&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(g GetPodAction)</span> <span class="hljs-title">Exec</span><span class="hljs-params">(transInfo *TransInfo)</span> <span class="hljs-title">error</span></span> &#123;        ...        <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>&#125;</code></pre><p>A. var fragment Fragment = new(GetPodAction)<br>B. var fragment Fragment = GetPodAction<br>C. var fragment Fragment = &amp;GetPodAction{}<br>D. var fragment Fragment = GetPodAction{}</p><p>ACD</p><p>28.[intermediate] å…³äºGoMockï¼Œä¸‹é¢è¯´æ³•æ­£ç¡®çš„æ˜¯ï¼ˆï¼‰<br>A. GoMockå¯ä»¥å¯¹interfaceæ‰“æ¡©<br>B. GoMockå¯ä»¥å¯¹ç±»çš„æˆå‘˜å‡½æ•°æ‰“æ¡©<br>C. GoMockå¯ä»¥å¯¹å‡½æ•°æ‰“æ¡©<br>D. GoMockæ‰“æ¡©åçš„ä¾èµ–æ³¨å…¥å¯ä»¥é€šè¿‡GoStubå®Œæˆ</p><p>[AD]</p><p>29.[intermediate] å…³äºæ¥å£ï¼Œä¸‹é¢è¯´æ³•æ­£ç¡®çš„æ˜¯ï¼ˆï¼‰<br>A. åªè¦ä¸¤ä¸ªæ¥å£æ‹¥æœ‰ç›¸åŒçš„æ–¹æ³•åˆ—è¡¨ï¼ˆæ¬¡åºä¸åŒä¸è¦ç´§ï¼‰ï¼Œé‚£ä¹ˆå®ƒä»¬å°±æ˜¯ç­‰ä»·çš„ï¼Œå¯ä»¥ç›¸äº’èµ‹å€¼<br>B. å¦‚æœæ¥å£Açš„æ–¹æ³•åˆ—è¡¨æ˜¯æ¥å£Bçš„æ–¹æ³•åˆ—è¡¨çš„å­é›†ï¼Œé‚£ä¹ˆæ¥å£Bå¯ä»¥èµ‹å€¼ç»™æ¥å£A<br>C. æ¥å£æŸ¥è¯¢æ˜¯å¦æˆåŠŸï¼Œè¦åœ¨è¿è¡ŒæœŸæ‰èƒ½å¤Ÿç¡®å®š<br>D. æ¥å£èµ‹å€¼æ˜¯å¦å¯è¡Œï¼Œè¦åœ¨è¿è¡ŒæœŸæ‰èƒ½å¤Ÿç¡®å®š</p><p>[ABC]</p><p>30.[primary] å…³äºchannelï¼Œä¸‹é¢è¯­æ³•æ­£ç¡®çš„æ˜¯ï¼ˆï¼‰<br>A. var ch chan int<br>B. ch := make(chan int)<br>C. &lt;- ch<br>D. ch &lt;-<br>ABC</p><p>31.[primary] å…³äºåŒæ­¥é”ï¼Œä¸‹é¢è¯´æ³•æ­£ç¡®çš„æ˜¯ï¼ˆï¼‰<br>A. å½“ä¸€ä¸ªgoroutineè·å¾—äº†Mutexåï¼Œå…¶ä»–goroutineå°±åªèƒ½ä¹–ä¹–çš„ç­‰å¾…ï¼Œé™¤éè¯¥goroutineé‡Šæ”¾è¿™ä¸ªMutex<br>B. RWMutexåœ¨è¯»é”å ç”¨çš„æƒ…å†µä¸‹ï¼Œä¼šé˜»æ­¢å†™ï¼Œä½†ä¸é˜»æ­¢è¯»<br>C. RWMutexåœ¨å†™é”å ç”¨æƒ…å†µä¸‹ï¼Œä¼šé˜»æ­¢ä»»ä½•å…¶ä»–goroutineï¼ˆæ— è®ºè¯»å’Œå†™ï¼‰è¿›æ¥ï¼Œæ•´ä¸ªé”ç›¸å½“äºç”±è¯¥goroutineç‹¬å <br>D. Lock()æ“ä½œéœ€è¦ä¿è¯æœ‰Unlock()æˆ–RUnlock()è°ƒç”¨ä¸ä¹‹å¯¹åº”</p><p>ABC</p><p>32.[intermediate] golangä¸­å¤§å¤šæ•°æ•°æ®ç±»å‹éƒ½å¯ä»¥è½¬åŒ–ä¸ºæœ‰æ•ˆçš„JSONæ–‡æœ¬ï¼Œä¸‹é¢å‡ ç§ç±»å‹é™¤å¤–ï¼ˆï¼‰<br>A. æŒ‡é’ˆ<br>B. channel<br>C. complex<br>D. å‡½æ•°</p><p>BCD</p><p>33.[intermediate] å…³äºgo vendorï¼Œä¸‹é¢è¯´æ³•æ­£ç¡®çš„æ˜¯ï¼ˆï¼‰<br>A. åŸºæœ¬æ€è·¯æ˜¯å°†å¼•ç”¨çš„å¤–éƒ¨åŒ…çš„æºä»£ç æ”¾åœ¨å½“å‰å·¥ç¨‹çš„vendorç›®å½•ä¸‹é¢<br>B. ç¼–è¯‘goä»£ç ä¼šä¼˜å…ˆä»vendorç›®å½•å…ˆå¯»æ‰¾ä¾èµ–åŒ…<br>C. å¯ä»¥æŒ‡å®šå¼•ç”¨æŸä¸ªç‰¹å®šç‰ˆæœ¬çš„å¤–éƒ¨åŒ…<br>D. æœ‰äº†vendorç›®å½•åï¼Œæ‰“åŒ…å½“å‰çš„å·¥ç¨‹ä»£ç åˆ°å…¶ä»–æœºå™¨çš„$GOPATH/srcä¸‹éƒ½å¯ä»¥é€šè¿‡ç¼–è¯‘</p><p>ABD</p><p>34.[primary] flagæ˜¯boolå‹å˜é‡ï¼Œä¸‹é¢ifè¡¨è¾¾å¼ç¬¦åˆç¼–ç è§„èŒƒçš„æ˜¯ï¼ˆï¼‰<br>A. if flag == 1<br>B. if flag<br>C. if flag == false<br>D. if !flag</p><p>BD</p><p>35.[primary] valueæ˜¯æ•´å‹å˜é‡ï¼Œä¸‹é¢ifè¡¨è¾¾å¼ç¬¦åˆç¼–ç è§„èŒƒçš„æ˜¯ï¼ˆï¼‰<br>A. if value == 0<br>B. if value<br>C. if value != 0<br>D. if !value</p><p>AC</p><p>36.[intermediate] å…³äºå‡½æ•°è¿”å›å€¼çš„é”™è¯¯è®¾è®¡ï¼Œä¸‹é¢è¯´æ³•æ­£ç¡®çš„æ˜¯ï¼ˆï¼‰<br>A. å¦‚æœå¤±è´¥åŸå› åªæœ‰ä¸€ä¸ªï¼Œåˆ™è¿”å›bool<br>B. å¦‚æœå¤±è´¥åŸå› è¶…è¿‡ä¸€ä¸ªï¼Œåˆ™è¿”å›error<br>C. å¦‚æœæ²¡æœ‰å¤±è´¥åŸå› ï¼Œåˆ™ä¸è¿”å›boolæˆ–error<br>D. å¦‚æœé‡è¯•å‡ æ¬¡å¯ä»¥é¿å…å¤±è´¥ï¼Œåˆ™ä¸è¦ç«‹å³è¿”å›boolæˆ–error</p><p>37.[intermediate] å…³äºå¼‚å¸¸è®¾è®¡ï¼Œä¸‹é¢è¯´æ³•æ­£ç¡®çš„æ˜¯ï¼ˆï¼‰<br>A. åœ¨ç¨‹åºå¼€å‘é˜¶æ®µï¼ŒåšæŒé€Ÿé”™ï¼Œè®©ç¨‹åºå¼‚å¸¸å´©æºƒ<br>B. åœ¨ç¨‹åºéƒ¨ç½²åï¼Œåº”æ¢å¤å¼‚å¸¸é¿å…ç¨‹åºç»ˆæ­¢<br>C. ä¸€åˆ‡çš†é”™è¯¯ï¼Œä¸ç”¨è¿›è¡Œå¼‚å¸¸è®¾è®¡<br>D. å¯¹äºä¸åº”è¯¥å‡ºç°çš„åˆ†æ”¯ï¼Œä½¿ç”¨å¼‚å¸¸å¤„ç†</p><p>[intermediate] å…³äºsliceæˆ–mapæ“ä½œï¼Œä¸‹é¢æ­£ç¡®çš„æ˜¯ï¼ˆï¼‰<br>A.</p><p>var s []int<br>s = append(s,1)<br>1<br>2<br>B.</p><p>var m map[string]int<br>m[â€œoneâ€] = 1<br>1<br>2<br>C.</p><p>var s []int<br>s = make([]int, 0)<br>s = append(s,1)<br>1<br>2<br>3<br>D.</p><p>var m map[string]int<br>m = make(map[string]int)<br>m[â€œoneâ€] = 1<br>1<br>2<br>3<br>[intermediate] å…³äºchannelçš„ç‰¹æ€§ï¼Œä¸‹é¢è¯´æ³•æ­£ç¡®çš„æ˜¯ï¼ˆï¼‰<br>A. ç»™ä¸€ä¸ª nil channel å‘é€æ•°æ®ï¼Œé€ æˆæ°¸è¿œé˜»å¡<br>B. ä»ä¸€ä¸ª nil channel æ¥æ”¶æ•°æ®ï¼Œé€ æˆæ°¸è¿œé˜»å¡<br>C. ç»™ä¸€ä¸ªå·²ç»å…³é—­çš„ channel å‘é€æ•°æ®ï¼Œå¼•èµ· panic<br>D. ä»ä¸€ä¸ªå·²ç»å…³é—­çš„ channel æ¥æ”¶æ•°æ®ï¼Œå¦‚æœç¼“å†²åŒºä¸­ä¸ºç©ºï¼Œåˆ™è¿”å›ä¸€ä¸ªé›¶å€¼</p><p>[intermediate] å…³äºæ— ç¼“å†²å’Œæœ‰å†²çªçš„channelï¼Œä¸‹é¢è¯´æ³•æ­£ç¡®çš„æ˜¯ï¼ˆï¼‰<br>A. æ— ç¼“å†²çš„channelæ˜¯é»˜è®¤çš„ç¼“å†²ä¸º1çš„channel<br>B. æ— ç¼“å†²çš„channelå’Œæœ‰ç¼“å†²çš„channeléƒ½æ˜¯åŒæ­¥çš„<br>C. æ— ç¼“å†²çš„channelå’Œæœ‰ç¼“å†²çš„channeléƒ½æ˜¯éåŒæ­¥çš„<br>D. æ— ç¼“å†²çš„channelæ˜¯åŒæ­¥çš„ï¼Œè€Œæœ‰ç¼“å†²çš„channelæ˜¯éåŒæ­¥çš„</p><p>ç­”æ¡ˆä¸‹è½½é“¾æ¥ ï¼š<a href="https://wws.lanzous.com/ifgqgmunf8d">https://wws.lanzous.com/ifgqgmunf8d</a></p><p>[intermediate] å…³äºå¼‚å¸¸çš„è§¦å‘ï¼Œä¸‹é¢è¯´æ³•æ­£ç¡®çš„æ˜¯ï¼ˆï¼‰<br>A. ç©ºæŒ‡é’ˆè§£æ<br>B. ä¸‹æ ‡è¶Šç•Œ<br>C. é™¤æ•°ä¸º0<br>D. è°ƒç”¨panicå‡½æ•°</p><p>[intermediate] å…³äºcapå‡½æ•°çš„é€‚ç”¨ç±»å‹ï¼Œä¸‹é¢è¯´æ³•æ­£ç¡®çš„æ˜¯ï¼ˆï¼‰<br>A. array<br>B. slice<br>C. map<br>D. channel</p><p>[intermediate] å…³äºbeegoæ¡†æ¶ï¼Œä¸‹é¢è¯´æ³•æ­£ç¡®çš„æ˜¯ï¼ˆï¼‰<br>A. beegoæ˜¯ä¸€ä¸ªgolangå®ç°çš„è½»é‡çº§HTTPæ¡†æ¶<br>B. beegoå¯ä»¥é€šè¿‡æ³¨é‡Šè·¯ç”±ã€æ­£åˆ™è·¯ç”±ç­‰å¤šç§æ–¹å¼å®Œæˆurlè·¯ç”±æ³¨å…¥<br>C. å¯ä»¥ä½¿ç”¨bee newå·¥å…·ç”Ÿæˆç©ºå·¥ç¨‹ï¼Œç„¶åä½¿ç”¨bee runå‘½ä»¤è‡ªåŠ¨çƒ­ç¼–è¯‘<br>D. beegoæ¡†æ¶åªæä¾›äº†å¯¹urlè·¯ç”±çš„å¤„ç†ï¼Œ è€Œå¯¹äºMVCæ¶æ„ä¸­çš„æ•°æ®åº“éƒ¨åˆ†æœªæä¾›æ¡†æ¶æ”¯æŒ</p><p>[intermediate] å…³äºgoconveyï¼Œä¸‹é¢è¯´æ³•æ­£ç¡®çš„æ˜¯ï¼ˆï¼‰<br>A. goconveyæ˜¯ä¸€ä¸ªæ”¯æŒgolangçš„å•å…ƒæµ‹è¯•æ¡†æ¶<br>B. goconveyèƒ½å¤Ÿè‡ªåŠ¨ç›‘æ§æ–‡ä»¶ä¿®æ”¹å¹¶å¯åŠ¨æµ‹è¯•ï¼Œå¹¶å¯ä»¥å°†æµ‹è¯•ç»“æœå®æ—¶è¾“å‡ºåˆ°webç•Œé¢<br>C. goconveyæä¾›äº†ä¸°å¯Œçš„æ–­è¨€ç®€åŒ–æµ‹è¯•ç”¨ä¾‹çš„ç¼–å†™<br>D. goconveyæ— æ³•ä¸go testé›†æˆ</p><p>[intermediate] å…³äºgo vetï¼Œä¸‹é¢è¯´æ³•æ­£ç¡®çš„æ˜¯ï¼ˆï¼‰<br>A. go vetæ˜¯golangè‡ªå¸¦å·¥å…·go tool vetçš„å°è£…<br>B. å½“æ‰§è¡Œgo vet databaseæ—¶ï¼Œå¯ä»¥å¯¹databaseæ‰€åœ¨ç›®å½•ä¸‹çš„æ‰€æœ‰å­æ–‡ä»¶å¤¹è¿›è¡Œé€’å½’æ£€æµ‹<br>C. go vetå¯ä»¥ä½¿ç”¨ç»å¯¹è·¯å¾„ã€ç›¸å¯¹è·¯å¾„æˆ–ç›¸å¯¹GOPATHçš„è·¯å¾„æŒ‡å®šå¾…æ£€æµ‹çš„åŒ…<br>D. go vetå¯ä»¥æ£€æµ‹å‡ºæ­»ä»£ç </p><p>[intermediate] å…³äºmapï¼Œä¸‹é¢è¯´æ³•æ­£ç¡®çš„æ˜¯ï¼ˆï¼‰<br>A. mapååºåˆ—åŒ–æ—¶json.unmarshalçš„å…¥å‚å¿…é¡»ä¸ºmapçš„åœ°å€<br>B. åœ¨å‡½æ•°è°ƒç”¨ä¸­ä¼ é€’mapï¼Œåˆ™å­å‡½æ•°ä¸­å¯¹mapå…ƒç´ çš„å¢åŠ ä¸ä¼šå¯¼è‡´çˆ¶å‡½æ•°ä¸­mapçš„ä¿®æ”¹<br>C. åœ¨å‡½æ•°è°ƒç”¨ä¸­ä¼ é€’mapï¼Œåˆ™å­å‡½æ•°ä¸­å¯¹mapå…ƒç´ çš„ä¿®æ”¹ä¸ä¼šå¯¼è‡´çˆ¶å‡½æ•°ä¸­mapçš„ä¿®æ”¹<br>D. ä¸èƒ½ä½¿ç”¨å†…ç½®å‡½æ•°deleteåˆ é™¤mapçš„å…ƒç´ </p><p>[intermediate] å…³äºGoStubï¼Œä¸‹é¢è¯´æ³•æ­£ç¡®çš„æ˜¯ï¼ˆï¼‰<br>A. GoStubå¯ä»¥å¯¹å…¨å±€å˜é‡æ‰“æ¡©<br>B. GoStubå¯ä»¥å¯¹å‡½æ•°æ‰“æ¡©<br>C. GoStubå¯ä»¥å¯¹ç±»çš„æˆå‘˜æ–¹æ³•æ‰“æ¡©<br>D. GoStubå¯ä»¥æ‰“åŠ¨æ€æ¡©ï¼Œæ¯”å¦‚å¯¹ä¸€ä¸ªå‡½æ•°æ‰“æ¡©åï¼Œå¤šæ¬¡è°ƒç”¨è¯¥å‡½æ•°ä¼šæœ‰ä¸åŒçš„è¡Œä¸º</p><p>[primary] å…³äºselectæœºåˆ¶ï¼Œä¸‹é¢è¯´æ³•æ­£ç¡®çš„æ˜¯ï¼ˆï¼‰<br>A. selectæœºåˆ¶ç”¨æ¥å¤„ç†å¼‚æ­¥IOé—®é¢˜<br>B. selectæœºåˆ¶æœ€å¤§çš„ä¸€æ¡é™åˆ¶å°±æ˜¯æ¯ä¸ªcaseè¯­å¥é‡Œå¿…é¡»æ˜¯ä¸€ä¸ªIOæ“ä½œ<br>C. golangåœ¨è¯­è¨€çº§åˆ«æ”¯æŒselectå…³é”®å­—<br>D. selectå…³é”®å­—çš„ç”¨æ³•ä¸switchè¯­å¥éå¸¸ç±»ä¼¼ï¼Œåé¢è¦å¸¦åˆ¤æ–­æ¡ä»¶</p><p>[primary] å…³äºå†…å­˜æ³„éœ²ï¼Œä¸‹é¢è¯´æ³•æ­£ç¡®çš„æ˜¯ï¼ˆï¼‰<br>A. golangæœ‰è‡ªåŠ¨åƒåœ¾å›æ”¶ï¼Œä¸å­˜åœ¨å†…å­˜æ³„éœ²<br>B. golangä¸­æ£€æµ‹å†…å­˜æ³„éœ²ä¸»è¦ä¾é çš„æ˜¯pprofåŒ…<br>C. å†…å­˜æ³„éœ²å¯ä»¥åœ¨ç¼–è¯‘é˜¶æ®µå‘ç°<br>D. åº”å®šæœŸä½¿ç”¨æµè§ˆå™¨æ¥æŸ¥çœ‹ç³»ç»Ÿçš„å®æ—¶å†…å­˜ä¿¡æ¯ï¼ŒåŠæ—¶å‘ç°å†…å­˜æ³„éœ²é—®é¢˜</p><p>[primary] å¯¹äºå±€éƒ¨å˜é‡æ•´å‹åˆ‡ç‰‡xçš„èµ‹å€¼ï¼Œä¸‹é¢å®šä¹‰æ­£ç¡®çš„æ˜¯ï¼ˆï¼‰<br>A.</p><p>x := []int{<br>        1, 2, 3,<br>        4, 5, 6,<br>}<br>1<br>2<br>3<br>4<br>B.</p><p>x := []int{<br>        1, 2, 3,<br>        4, 5, 6<br>}<br>1<br>2<br>3<br>4<br>C.</p><p>x := []int{<br>        1, 2, 3,<br>        4, 5, 6}<br>1<br>2<br>3<br>D.</p><p>x := []int{1, 2, 3, 4, 5, 6,}</p><p>[primary] å£°æ˜ä¸€ä¸ªæ•´å‹å˜é‡i ?</p><p>[primary] å£°æ˜ä¸€ä¸ªå«æœ‰10ä¸ªå…ƒç´ çš„æ•´å‹æ•°ç»„a ?</p><p>[primary] å£°æ˜ä¸€ä¸ªæ•´å‹æ•°ç»„åˆ‡ç‰‡s?</p><p>[primary] å£°æ˜ä¸€ä¸ªæ•´å‹æŒ‡é’ˆå˜é‡p?</p><p>[primary] å£°æ˜ä¸€ä¸ªkeyä¸ºå­—ç¬¦ä¸²å‹valueä¸ºæ•´å‹çš„mapå˜é‡m?</p><p>[primary] å£°æ˜ä¸€ä¸ªå…¥å‚å’Œè¿”å›å€¼å‡ä¸ºæ•´å‹çš„å‡½æ•°å˜é‡ f?</p><p>[primary] å£°æ˜ä¸€ä¸ªåªç”¨äºè¯»å–intæ•°æ®çš„å•å‘channelå˜é‡ch?</p><p>[primary] å‡è®¾æºæ–‡ä»¶çš„å‘½åä¸ºslice.goï¼Œåˆ™æµ‹è¯•æ–‡ä»¶çš„å‘½åä¸º?</p><p>[primary] go testè¦æ±‚æµ‹è¯•å‡½æ•°çš„å‰ç¼€å¿…é¡»å‘½åä¸º?</p><p>[intermediate] ä¸‹é¢çš„ç¨‹åºçš„è¿è¡Œç»“æœæ˜¯?</p><p>for i := 0; i &lt; 5; i++ {<br>        defer fmt.Printf(â€œ%d â€œ, i)<br>}<br>1<br>2<br>3<br>[intermediate] ä¸‹é¢çš„ç¨‹åºçš„è¿è¡Œç»“æœæ˜¯?<br>func main() {<br>        x := 1<br>        {<br>            x := 2<br>            fmt.Print(x)<br>        }<br>        fmt.Println(x)<br>}<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>[intermediate] ä¸‹é¢çš„ç¨‹åºçš„è¿è¡Œç»“æœæ˜¯?<br>func main() {<br>        strs := []string{â€œoneâ€, â€œtwoâ€, â€œthreeâ€}</p><pre><code>    for _, s := range strs &#123;        go func() &#123;            time.Sleep(1 * time.Second)            fmt.Printf(&quot;%s &quot;, s)        &#125;()    &#125;    time.Sleep(3 * time.Second)</code></pre><p>}<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>[intermediate] ä¸‹é¢çš„ç¨‹åºçš„è¿è¡Œç»“æœæ˜¯?<br>func main() {<br>        x := []string{â€œaâ€, â€œbâ€, â€œcâ€}<br>        for v := range x {<br>            fmt.Print(v)<br>        }<br>}<br>1<br>2<br>3<br>4<br>5<br>6<br>[intermediate] ä¸‹é¢çš„ç¨‹åºçš„è¿è¡Œç»“æœæ˜¯ï¼Ÿ<br>func main() {<br>        x := []string{â€œaâ€, â€œbâ€, â€œcâ€}<br>        for _, v := range x {<br>            fmt.Print(v)<br>        }<br>}<br>1<br>2<br>3<br>4<br>5<br>6<br>[primary] ä¸‹é¢çš„ç¨‹åºçš„è¿è¡Œç»“æœæ˜¯ï¼Ÿ<br>func main() {<br>       i := 1<br>       j := 2<br>       i, j = j, i<br>       fmt.Printf(â€œ%d%d\nâ€, i, j)<br>}<br>1<br>2<br>3<br>4<br>5<br>6<br>[primary] ä¸‹é¢çš„ç¨‹åºçš„è¿è¡Œç»“æœæ˜¯ï¼Ÿ<br>func incr(p *int) int {<br>        *p++<br>        return *p<br>}<br>func main() {<br>        v := 1<br>        incr(&amp;v)<br>        fmt.Println(v)<br>}<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>[primary] å¯åŠ¨ä¸€ä¸ªgoroutineçš„å…³é”®å­—æ˜¯ï¼Ÿ</p><p>[intermediate] ä¸‹é¢çš„ç¨‹åºçš„è¿è¡Œç»“æœæ˜¯ï¼Ÿ</p><p>type Slice []int<br>func NewSlice() Slice {<br>         return make(Slice, 0)<br>}<br>func (s* Slice) Add(elem int) *Slice {<br>         *s = append(*s, elem)<br>         fmt.Print(elem)<br>         return s<br>}<br>func main() {<br>         s := NewSlice()<br>         defer s.Add(1).Add(2)<br>         s.Add(3)<br>}</p><ol start="3"><li>åˆ¤æ–­é¢˜<br>[primary] æ•°ç»„æ˜¯ä¸€ä¸ªå€¼ç±»å‹ï¼ˆï¼‰</li></ol><p>[primary] ä½¿ç”¨mapä¸éœ€è¦å¼•å…¥ä»»ä½•åº“ï¼ˆï¼‰</p><p>[intermediate] å†…ç½®å‡½æ•°deleteå¯ä»¥åˆ é™¤æ•°ç»„åˆ‡ç‰‡å†…çš„å…ƒç´ ï¼ˆï¼‰</p><p>[primary] æŒ‡é’ˆæ˜¯åŸºç¡€ç±»å‹ï¼ˆï¼‰</p><p>[primary] interface{}æ˜¯å¯ä»¥æŒ‡å‘ä»»æ„å¯¹è±¡çš„Anyç±»å‹ï¼ˆï¼‰</p><p>[intermediate] ä¸‹é¢å…³äºæ–‡ä»¶æ“ä½œçš„ä»£ç å¯èƒ½è§¦å‘å¼‚å¸¸ï¼ˆï¼‰</p><p>file, err := os.Open(â€œtest.goâ€)<br>defer file.Close()<br>if err != nil {<br>        fmt.Println(â€œopen file failed:â€, err)<br>        return<br>}<br>â€¦<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>[primary] Golangä¸æ”¯æŒè‡ªåŠ¨åƒåœ¾å›æ”¶ï¼ˆï¼‰</p><p>[primary] Golangæ”¯æŒåå°„ï¼Œåå°„æœ€å¸¸è§çš„ä½¿ç”¨åœºæ™¯æ˜¯åšå¯¹è±¡çš„åºåˆ—åŒ–ï¼ˆï¼‰</p><p>[primary] Golangå¯ä»¥å¤ç”¨C/C++çš„æ¨¡å—ï¼Œè¿™ä¸ªåŠŸèƒ½å«Cgoï¼ˆï¼‰</p><p>[primary] ä¸‹é¢ä»£ç ä¸­ä¸¤ä¸ªæ–œç‚¹ä¹‹é—´çš„ä»£ç ï¼Œæ¯”å¦‚json:â€xâ€ï¼Œä½œç”¨æ˜¯Xå­—æ®µåœ¨ä»ç»“æ„ä½“å®ä¾‹ç¼–ç åˆ°JSONæ•°æ®æ ¼å¼çš„æ—¶å€™ï¼Œä½¿ç”¨xä½œä¸ºåå­—ï¼Œè¿™å¯ä»¥çœ‹ä½œæ˜¯ä¸€ç§é‡å‘½åçš„æ–¹å¼ï¼ˆï¼‰</p><p>type Position struct {<br>        X int <code>json:&quot;x&quot;</code><br>        Y int <code>json:&quot;y&quot;</code><br>        Z int <code>json:&quot;z&quot;</code><br>}<br>1<br>2<br>3<br>4<br>5<br>[primary] é€šè¿‡æˆå‘˜å˜é‡æˆ–å‡½æ•°é¦–å­—æ¯çš„å¤§å°å†™æ¥å†³å®šå…¶ä½œç”¨åŸŸï¼ˆï¼‰</p><p>[primary] å¯¹äºå¸¸é‡å®šä¹‰zero(const zero = 0.0)ï¼Œzeroæ˜¯æµ®ç‚¹å‹å¸¸é‡ï¼ˆï¼‰</p><p>[primary] å¯¹å˜é‡xçš„å–åæ“ä½œæ˜¯~xï¼ˆï¼‰</p><p>[primary] ä¸‹é¢çš„ç¨‹åºçš„è¿è¡Œç»“æœæ˜¯xelloï¼ˆï¼‰</p><p>func main() {<br>        str := â€œhelloâ€<br>        str[0] = â€˜xâ€™<br>        fmt.Println(str)<br>}<br>1<br>2<br>3<br>4<br>5<br>[primary] golangæ”¯æŒgotoè¯­å¥ï¼ˆï¼‰</p><p>[primary] ä¸‹é¢ä»£ç ä¸­çš„æŒ‡é’ˆpä¸ºé‡æŒ‡é’ˆï¼Œå› ä¸ºè¿”å›çš„æ ˆå†…å­˜åœ¨å‡½æ•°ç»“æŸæ—¶ä¼šè¢«é‡Šæ”¾ï¼ˆï¼‰</p><p>type TimesMatcher struct {<br>        base int<br>}<br>func NewTimesMatcher(base int) *TimesMatcher{<br>        return &amp;TimesMatcher{base:base}<br>}<br>func main() {<br>        p := NewTimesMatcher(3)<br>        â€¦<br>}<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>[primary] åŒ¿åå‡½æ•°å¯ä»¥ç›´æ¥èµ‹å€¼ç»™ä¸€ä¸ªå˜é‡æˆ–è€…ç›´æ¥æ‰§è¡Œï¼ˆï¼‰</p><p>[primary] å¦‚æœè°ƒç”¨æ–¹è°ƒç”¨äº†ä¸€ä¸ªå…·æœ‰å¤šè¿”å›å€¼çš„æ–¹æ³•ï¼Œä½†æ˜¯å´ä¸æƒ³å…³å¿ƒå…¶ä¸­çš„æŸä¸ªè¿”å›å€¼ï¼Œå¯ä»¥ç®€å•åœ°ç”¨ä¸€ä¸ªä¸‹åˆ’çº¿â€œ_â€æ¥è·³è¿‡è¿™ä¸ªè¿”å›å€¼ï¼Œè¯¥ä¸‹åˆ’çº¿å¯¹åº”çš„å˜é‡å«åŒ¿åå˜é‡ï¼ˆï¼‰</p><p>[primary] åœ¨å‡½æ•°çš„å¤šè¿”å›å€¼ä¸­ï¼Œå¦‚æœæœ‰erroræˆ–boolç±»å‹ï¼Œåˆ™ä¸€èˆ¬æ”¾åœ¨æœ€åä¸€ä¸ªï¼ˆï¼‰</p><p>[primary] é”™è¯¯æ˜¯ä¸šåŠ¡è¿‡ç¨‹çš„ä¸€éƒ¨åˆ†ï¼Œè€Œå¼‚å¸¸ä¸æ˜¯ï¼ˆï¼‰</p><p>[primary] å‡½æ•°æ‰§è¡Œæ—¶ï¼Œå¦‚æœç”±äºpanicå¯¼è‡´äº†å¼‚å¸¸ï¼Œåˆ™å»¶è¿Ÿå‡½æ•°ä¸ä¼šæ‰§è¡Œï¼ˆï¼‰</p><p>[intermediate] å½“ç¨‹åºè¿è¡Œæ—¶ï¼Œå¦‚æœé‡åˆ°å¼•ç”¨ç©ºæŒ‡é’ˆã€ä¸‹æ ‡è¶Šç•Œæˆ–æ˜¾å¼è°ƒç”¨panicå‡½æ•°ç­‰æƒ…å†µï¼Œåˆ™å…ˆè§¦å‘panicå‡½æ•°çš„æ‰§è¡Œï¼Œç„¶åè°ƒç”¨å»¶è¿Ÿå‡½æ•°ã€‚è°ƒç”¨è€…ç»§ç»­ä¼ é€’panicï¼Œå› æ­¤è¯¥è¿‡ç¨‹ä¸€ç›´åœ¨è°ƒç”¨æ ˆä¸­é‡å¤å‘ç”Ÿï¼šå‡½æ•°åœæ­¢æ‰§è¡Œï¼Œè°ƒç”¨å»¶è¿Ÿæ‰§è¡Œå‡½æ•°ã€‚å¦‚æœä¸€è·¯åœ¨å»¶è¿Ÿå‡½æ•°ä¸­æ²¡æœ‰recoverå‡½æ•°çš„è°ƒç”¨ï¼Œåˆ™ä¼šåˆ°è¾¾è¯¥æºç¨‹çš„èµ·ç‚¹ï¼Œè¯¥æºç¨‹ç»“æŸï¼Œç„¶åç»ˆæ­¢å…¶ä»–æ‰€æœ‰æºç¨‹ï¼Œå…¶ä»–æºç¨‹çš„ç»ˆæ­¢è¿‡ç¨‹ä¹Ÿæ˜¯é‡å¤å‘ç”Ÿï¼šå‡½æ•°åœæ­¢æ‰§è¡Œï¼Œè°ƒç”¨å»¶è¿Ÿæ‰§è¡Œå‡½æ•°ï¼ˆï¼‰</p><p>[primary] åŒçº§æ–‡ä»¶çš„åŒ…åä¸å…è®¸æœ‰å¤šä¸ªï¼ˆï¼‰</p><p>[intermediate] å¯ä»¥ç»™ä»»æ„ç±»å‹æ·»åŠ ç›¸åº”çš„æ–¹æ³•ï¼ˆï¼‰</p><p>[primary] golangè™½ç„¶æ²¡æœ‰æ˜¾å¼çš„æä¾›ç»§æ‰¿è¯­æ³•ï¼Œä½†æ˜¯é€šè¿‡åŒ¿åç»„åˆå®ç°äº†ç»§æ‰¿ï¼ˆï¼‰</p><p>[primary] ä½¿ç”¨for rangeè¿­ä»£mapæ—¶æ¯æ¬¡è¿­ä»£çš„é¡ºåºå¯èƒ½ä¸ä¸€æ ·ï¼Œå› ä¸ºmapçš„è¿­ä»£æ˜¯éšæœºçš„ï¼ˆï¼‰</p><p>[primary] switchåé¢å¯ä»¥ä¸è·Ÿè¡¨è¾¾å¼ï¼ˆï¼‰</p><p>[intermediate] ç»“æ„ä½“åœ¨åºåˆ—åŒ–æ—¶éå¯¼å‡ºå˜é‡ï¼ˆä»¥å°å†™å­—æ¯å¼€å¤´çš„å˜é‡åï¼‰ä¸ä¼šè¢«encodeï¼Œå› æ­¤åœ¨decodeæ—¶è¿™äº›éå¯¼å‡ºå˜é‡çš„å€¼ä¸ºå…¶ç±»å‹çš„é›¶å€¼ï¼ˆï¼‰</p><p>[primary] golangä¸­æ²¡æœ‰æ„é€ å‡½æ•°çš„æ¦‚å¿µï¼Œå¯¹è±¡çš„åˆ›å»ºé€šå¸¸äº¤ç”±ä¸€ä¸ªå…¨å±€çš„åˆ›å»ºå‡½æ•°æ¥å®Œæˆï¼Œä»¥NewXXXæ¥å‘½åï¼ˆï¼‰</p><p>[intermediate] å½“å‡½æ•°deferDemoè¿”å›å¤±è´¥æ—¶ï¼Œå¹¶ä¸èƒ½destroyå·²createæˆåŠŸçš„èµ„æºï¼ˆï¼‰</p><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">deferDemo</span><span class="hljs-params">()</span> <span class="hljs-title">error</span></span> &#123;        err := createResource1()        <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;            <span class="hljs-keyword">return</span> ERR_CREATE_RESOURCE1_FAILED        &#125;        <span class="hljs-keyword">defer</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> &#123;            <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;                destroyResource1()            &#125;        &#125;()    err = createResource2()    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;        <span class="hljs-keyword">return</span> ERR_CREATE_RESOURCE2_FAILED    &#125;    <span class="hljs-keyword">defer</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> &#123;        <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;            destroyResource2()        &#125;    &#125;()    err = createResource3()    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;        <span class="hljs-keyword">return</span> ERR_CREATE_RESOURCE3_FAILED    &#125;    <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>&#125;</code></pre><p>[intermediate] channelæœ¬èº«å¿…ç„¶æ˜¯åŒæ—¶æ”¯æŒè¯»å†™çš„ï¼Œæ‰€ä»¥ä¸å­˜åœ¨å•å‘channelï¼ˆï¼‰</p><p>[primary] importåé¢çš„æœ€åä¸€ä¸ªå…ƒç´ æ˜¯åŒ…åï¼ˆï¼‰</p>]]></content>
    
    
    <categories>
      
      <category>Golang</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Go</tag>
      
      <tag>ADT</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€MLã€‘æœºå™¨å­¦ä¹ æ¦‚è¿°ä¸ç®€å•åº”ç”¨</title>
    <link href="/2021/01/11/ml/"/>
    <url>/2021/01/11/ml/</url>
    
    <content type="html"><![CDATA[<h3 id="ä»€ä¹ˆæ˜¯æœºå™¨å­¦ä¹ "><a href="#ä»€ä¹ˆæ˜¯æœºå™¨å­¦ä¹ " class="headerlink" title="ä»€ä¹ˆæ˜¯æœºå™¨å­¦ä¹ "></a><a id="more"></a>ä»€ä¹ˆæ˜¯æœºå™¨å­¦ä¹ </h3><h4 id="ç›´è§‚è§†è§’ä¸‹çš„æœºå™¨å­¦ä¹ "><a href="#ç›´è§‚è§†è§’ä¸‹çš„æœºå™¨å­¦ä¹ " class="headerlink" title="ç›´è§‚è§†è§’ä¸‹çš„æœºå™¨å­¦ä¹ "></a>ç›´è§‚è§†è§’ä¸‹çš„æœºå™¨å­¦ä¹ </h4><p>å¤§ä¼—è§†è§’ï¼š</p><p><img src="/images/ml/1.jpg" alt="1"></p><p>ç¨‹åºå‘˜è§†è§’ï¼š</p><p><img src="/images/ml/2.jpg" alt="2"></p><p><img src="/images/ml/2.png" alt="2"></p><p>ç›®å‰æœºå™¨å­¦ä¹ å·²ç»åº”ç”¨åˆ°äº†ç”Ÿæ´»çš„å„ä¸ªæ–¹é¢ã€‚</p><p>ç™¾åº¦æœç´¢ï¼šå…¶èƒŒåæœ‰è¿™å¤æ‚çš„æœºå™¨å­¦ä¹ ç³»ç»Ÿåœ¨åŠªåŠ›åœ°è¿›è¡Œè¿™ä¸ªè·Ÿæˆ‘ä»¬ç›®æ ‡å…³é”®è¯ç›¸å…³çš„æ£€ç´¢ã€æ’åºå·¥ä½œï¼›</p><p>ç¾å›¾ã€ç¾æ‹è¿™æ ·çš„ç…§ç›¸è½¯ä»¶ï¼šä½¿ç”¨äº†æœºå™¨å­¦ä¹ æ¥è¯†åˆ«é¢éƒ¨å¹¶è¿›è¡Œä¸€å®šç¨‹åº¦çš„ç¾åŒ–ï¼›</p><p>åƒåœ¾ç®±é‡Œèººç€çš„åƒåœ¾é‚®ä»¶ï¼šå®ƒä»¬éƒ½ä¸æ˜¯æˆ‘ä»¬ä¸»åŠ¨æ‹–æ‹½ç§»åŠ¨è¿›å»çš„ï¼Œè€Œæ˜¯æœºå™¨å­¦ä¹ å¸®æˆ‘ä»¬è‡ªåŠ¨åœ°è¯†åˆ«äº†åƒåœ¾é‚®ä»¶ï¼›</p><p>äº¬ä¸œã€å¤©çŒ«è´­ç‰©æ—¶ï¼Œæ¨èçš„ä¸€äº›æˆ‘ä»¬æ„Ÿå…´è¶£çš„å•†å“ï¼šä¿ƒæˆæˆ‘ä»¬æ›´åŠ ä¾¿æ·åœ°è´­ä¹°ï¼Œæœºå™¨å­¦ä¹ çš„æ¨èç®—æ³•åœ¨å…¶ä¸­å‘æŒ¥ä½œç”¨ï¼›</p><p>è¿˜æœ‰ï¼Œæ–°é—»çš„æ¨èç³»ç»Ÿã€è¯­éŸ³è¯†åˆ«ã€è‡ªç„¶è¯­è¨€å¤„ç†ã€æ— äººé©¾é©¶ã€æœºå™¨ç¿»è¯‘ç­‰ä¼—å¤šé¢†åŸŸéƒ½æœ‰æœºå™¨å­¦ä¹ çš„å½±å­ã€‚</p><p>ç»´åŸºç™¾ç§‘ï¼š<a href="https://zh.wikipedia.org/wiki/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0">https://zh.wikipedia.org/wiki/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0</a></p><p>ç™¾åº¦ç™¾ç§‘ï¼š<a href="https://baike.baidu.com/item/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/217599">https://baike.baidu.com/item/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/217599</a></p><p>æœºå™¨å­¦ä¹ å®é™…ä¸Šæ˜¯ä¸€é—¨â€æ•™ä¼šâ€è®¡ç®—æœºå­¦ä¹ è€Œä¸éœ€è¦æ˜ç¡®åœ°è¿›è¡Œç¼–ç¨‹çš„ç§‘å­¦ã€‚æ¯”å¦‚ï¼Œæ‰«åœ°æœºå™¨äººï¼Œå®ƒåº”è¯¥æ€æ ·å¸®åŠ©æˆ‘ä»¬æ¸…æ‰«æˆ‘ä»¬çš„æˆ¿å­å‘¢ï¼Ÿä¸€ç§åŠæ³•æ˜¯è®©å®ƒå­¦ä¹ æˆ‘ä»¬å¦‚ä½•æ¸…æ‰«ï¼Œè®©å®ƒçœ‹çœ‹æˆ‘ä»¬éƒ½æ¡èµ·äº†ä»€ä¹ˆä¸œè¥¿ï¼Œç„¶åæŠŠå®ƒä»¬åˆæ”¾åˆ°ä»€ä¹ˆåœ°æ–¹ï¼Œè€Œä¸éœ€è¦ç¼–å†™å›ºå®šçš„ç¨‹åºè®©å®ƒä»¬è¯†åˆ«åƒåœ¾ï¼Œå¹¶å°†å®ƒä»¬ç§»åŠ¨åˆ°å›ºå®šçš„åƒåœ¾æ¡¶ã€‚</p><p>æœºå™¨å­¦ä¹ â€”â€”å®é™…ä¸Šåœ¨å¾ˆå¤šé—®é¢˜ä¸Šéƒ½æ˜¯ä¸€ç§é€šç”¨è§£å†³æ–¹æ¡ˆã€‚</p><p>å®ƒåªéœ€è¦é€šè¿‡å¤§é‡çš„å®ä¾‹å°±å¯ä»¥ä»¥å¾ˆé«˜çš„ç²¾åº¦é€¼è¿‘å‡†ç¡®çš„è§£å†³æ–¹æ¡ˆã€‚å®ƒå¸¦æ¥çš„å¥½å¤„æ˜¯ä¸éœ€è¦ä¸¥æ ¼åœ°å»åˆ†æå…·ä½“é—®é¢˜å¹¶æ„é€ ç²¾ç¡®è§£ï¼Œå®ƒä»¥ä¸€ç§é€šç”¨çš„è§£å†³æ–¹æ¡ˆæ¡†æ¶æ¥å¯¹é—®é¢˜è¿›è¡ŒæŠ½è±¡å»ºæ¨¡ï¼Œå¹¶é€šè¿‡å¤§é‡çš„å®ä¾‹æ¥çº æ­£æ¨¡å‹ä¸­çš„å‚æ•°ï¼Œå¹¶æœ€ç»ˆä»¥è¯¥æ¨¡å‹æ¥é€¼è¿‘ç²¾ç¡®è§£ï¼Œæœ€ç»ˆè¾¾åˆ°åº”ç”¨æ ‡å‡†ã€‚</p><p><img src="/images/ml/1-2.jpg" alt="1-2"></p><h4 id="äººå·¥æ™ºèƒ½ã€æœºå™¨å­¦ä¹ ä¸æ·±åº¦å­¦ä¹ "><a href="#äººå·¥æ™ºèƒ½ã€æœºå™¨å­¦ä¹ ä¸æ·±åº¦å­¦ä¹ " class="headerlink" title="äººå·¥æ™ºèƒ½ã€æœºå™¨å­¦ä¹ ä¸æ·±åº¦å­¦ä¹ "></a>äººå·¥æ™ºèƒ½ã€æœºå™¨å­¦ä¹ ä¸æ·±åº¦å­¦ä¹ </h4><p><img src="/images/ml/2-1.jpg" alt="2-1"></p><p><img src="/images/ml/2-2.jpg" alt="2-2"></p><p><img src="/images/ml/2-3.jpg" alt="2-3"></p><p><img src="/images/ml/2-4.jpg" alt="2-4"></p><p><img src="/images/ml/2-5.jpg" alt="2-5"></p><h4 id="æœºå™¨å­¦ä¹ åˆ†ç±»"><a href="#æœºå™¨å­¦ä¹ åˆ†ç±»" class="headerlink" title="æœºå™¨å­¦ä¹ åˆ†ç±»"></a>æœºå™¨å­¦ä¹ åˆ†ç±»</h4><p>æœºå™¨å­¦ä¹ æ ¹æ®è®­ç»ƒæ–¹æ³•å¤§è‡´å¯ä»¥åˆ†ä¸º3å¤§ç±»ï¼š</p><ol><li>ç›‘ç£å­¦ä¹ </li><li>éç›‘ç£å­¦ä¹ </li><li>å¼ºåŒ–å­¦ä¹ </li></ol><p>é™¤æ­¤ä¹‹å¤–ï¼Œå¤§å®¶å¯èƒ½è¿˜å¬è¿‡â€œåŠç›‘ç£å­¦ä¹ â€ä¹‹ç±»çš„è¯´æ³•ï¼Œä½†æ˜¯é‚£äº›éƒ½æ˜¯åŸºäºä¸Šé¢3ç±»çš„å˜ç§ï¼Œæœ¬è´¨æ²¡æœ‰æ”¹å˜ã€‚</p><h5 id="ç›‘ç£å­¦ä¹ "><a href="#ç›‘ç£å­¦ä¹ " class="headerlink" title="ç›‘ç£å­¦ä¹ "></a>ç›‘ç£å­¦ä¹ </h5><p>ç›‘ç£å­¦ä¹ æ˜¯æŒ‡æˆ‘ä»¬ç»™ç®—æ³•ä¸€ä¸ªæ•°æ®é›†ï¼Œå¹¶ä¸”ç»™å®šæ­£ç¡®ç­”æ¡ˆã€‚æœºå™¨é€šè¿‡æ•°æ®æ¥å­¦ä¹ æ­£ç¡®ç­”æ¡ˆçš„è®¡ç®—æ–¹æ³•ã€‚</p><p><img src="/images/ml/1-31.png" alt="1-31"></p><p><img src="/images/ml/1-312.png" alt="1-312"></p><p>ç›‘ç£å¼å­¦ä¹ é‡‡ç”¨åˆ†ç±»å’Œå›å½’æŠ€æœ¯å¼€å‘é¢„æµ‹æ¨¡å‹ã€‚</p><p>   <strong>åˆ†ç±»æŠ€æœ¯</strong>å¯é¢„æµ‹ç¦»æ•£çš„å“åº” â€” ä¾‹å¦‚ï¼Œç”µå­é‚®ä»¶æ˜¯ä¸æ˜¯åƒåœ¾é‚®ä»¶ï¼Œè‚¿ç˜¤æ˜¯æ¶æ€§è¿˜æ˜¯è‰¯æ€§çš„ã€‚åˆ†ç±»æ¨¡å‹å¯å°†è¾“å…¥æ•°æ®åˆ’åˆ†æˆä¸åŒç±»åˆ«ã€‚å…¸å‹çš„åº”ç”¨åŒ…æ‹¬åŒ»å­¦æˆåƒã€è¯­éŸ³è¯†åˆ«å’Œä¿¡ç”¨è¯„ä¼°ã€‚</p><p>å¦‚æœæ‚¨çš„æ•°æ®èƒ½è¿›è¡Œæ ‡è®°ã€åˆ†ç±»æˆ–åˆ†ä¸ºç‰¹å®šçš„ç»„æˆ–ç±»ï¼Œåˆ™ä½¿ç”¨åˆ†ç±»ã€‚ä¾‹å¦‚ï¼Œç¬”è¿¹è¯†åˆ«çš„åº”ç”¨ç¨‹åºä½¿ç”¨åˆ†ç±»æ¥è¯†åˆ«å­—æ¯å’Œæ•°å­—ã€‚åœ¨å›¾åƒå¤„ç†å’Œè®¡ç®—æœºè§†è§‰ä¸­ï¼Œ<a href="https://ww2.mathworks.cn/discovery/pattern-recognition.html">æ— ç›‘ç£æ¨¡å¼è¯†åˆ«</a>æŠ€æœ¯ç”¨äºå¯¹è±¡æ£€æµ‹å’Œå›¾åƒåˆ†å‰²ã€‚</p><p>  <strong>å›å½’æŠ€æœ¯</strong>å¯é¢„æµ‹è¿ç»­çš„å“åº” â€” ä¾‹å¦‚ï¼Œæ¸©åº¦çš„å˜åŒ–æˆ–ç”µåŠ›éœ€æ±‚ä¸­çš„æ³¢åŠ¨ã€‚å…¸å‹çš„åº”ç”¨åŒ…æ‹¬ç”µåŠ›ç³»ç»Ÿè´Ÿè·é¢„æµ‹å’Œç®—æ³•äº¤æ˜“ã€‚</p><p>å¦‚æœæ‚¨åœ¨å¤„ç†ä¸€ä¸ªæ•°æ®èŒƒå›´ï¼Œæˆ–æ‚¨çš„å“åº”æ€§è´¨æ˜¯ä¸€ä¸ªå®æ•°ï¼ˆæ¯”å¦‚æ¸©åº¦ï¼Œæˆ–ä¸€ä»¶è®¾å¤‡å‘ç”Ÿæ•…éšœå‰çš„è¿è¡Œæ—¶é—´ï¼‰ï¼Œåˆ™ä½¿ç”¨å›å½’æ–¹æ³•ã€‚</p><h5 id="éç›‘ç£å­¦ä¹ "><a href="#éç›‘ç£å­¦ä¹ " class="headerlink" title="éç›‘ç£å­¦ä¹ "></a>éç›‘ç£å­¦ä¹ </h5><p>éç›‘ç£å­¦ä¹ ä¸­ï¼Œç»™å®šçš„æ•°æ®é›†æ²¡æœ‰â€œæ­£ç¡®ç­”æ¡ˆâ€ï¼Œæ‰€æœ‰çš„æ•°æ®éƒ½æ˜¯ä¸€æ ·çš„ã€‚æ— ç›‘ç£å­¦ä¹ çš„ä»»åŠ¡æ˜¯ä»ç»™å®šçš„æ•°æ®é›†ä¸­ï¼ŒæŒ–æ˜å‡ºæ½œåœ¨çš„ç»“æ„ã€‚</p><p><img src="/images/ml/1-32.png" alt="1-32"></p><p><img src="/images/ml/1-322.png" alt="1-322"></p><p>  <strong>èšç±»</strong>æ˜¯ä¸€ç§æœ€å¸¸ç”¨çš„æ— ç›‘ç£å­¦ä¹ æŠ€æœ¯ã€‚è¿™ç§æŠ€æœ¯å¯é€šè¿‡æ¢ç´¢æ€§æ•°æ®åˆ†æå‘ç°æ•°æ®ä¸­éšè—çš„æ¨¡å¼æˆ–åˆ†ç»„ã€‚<a href="https://ww2.mathworks.cn/discovery/cluster-analysis.html">èšç±»åˆ†æ</a>çš„åº”ç”¨åŒ…æ‹¬åŸºå› åºåˆ—åˆ†æã€å¸‚åœºè°ƒæŸ¥å’Œå¯¹è±¡è¯†åˆ«ã€‚</p><p>  <strong>é™ç»´</strong>å°±æ˜¯æŒ‡é‡‡ç”¨æŸç§æ˜ å°„æ–¹æ³•ï¼Œå°†åŸé«˜ç»´ç©ºé—´ä¸­çš„æ•°æ®ç‚¹æ˜ å°„åˆ°ä½ç»´åº¦çš„ç©ºé—´ä¸­ã€‚é™ç»´çš„æœ¬è´¨æ˜¯å­¦ä¹ ä¸€ä¸ªæ˜ å°„å‡½æ•° f : x-&gt;yï¼Œå…¶ä¸­xæ˜¯åŸå§‹æ•°æ®ç‚¹çš„è¡¨è¾¾ï¼Œç›®å‰æœ€å¤šä½¿ç”¨å‘é‡è¡¨è¾¾å½¢å¼ã€‚</p><p>ç›®å‰å¤§éƒ¨åˆ†é™ç»´ç®—æ³•å¤„ç†å‘é‡è¡¨è¾¾çš„æ•°æ®ï¼Œä¹Ÿæœ‰ä¸€äº›é™ç»´ç®—æ³•å¤„ç†é«˜é˜¶å¼ é‡è¡¨è¾¾çš„æ•°æ®ã€‚ä¹‹æ‰€ä»¥ä½¿ç”¨é™ç»´åçš„æ•°æ®è¡¨ç¤ºæ˜¯å› ä¸ºåœ¨åŸå§‹çš„é«˜ç»´ç©ºé—´ä¸­ï¼ŒåŒ…å«æœ‰å†—ä½™ä¿¡æ¯ä»¥åŠå™ªéŸ³ä¿¡æ¯ï¼Œåœ¨å®é™…åº”ç”¨ä¾‹å¦‚å›¾åƒè¯†åˆ«ä¸­é€ æˆäº†è¯¯å·®ï¼Œé™ä½äº†å‡†ç¡®ç‡ï¼›è€Œé€šè¿‡é™ç»´,æˆ‘ä»¬å¸Œæœ›å‡å°‘ <a href="http://www.hudong.com/wiki/%E5%86%97%E4%BD%99%E4%BF%A1%E6%81%AF">å†—ä½™ä¿¡æ¯</a> æ‰€é€ æˆçš„è¯¯å·®,æé«˜è¯†åˆ«ï¼ˆæˆ–å…¶ä»–åº”ç”¨ï¼‰çš„ç²¾åº¦ã€‚åˆæˆ–è€…å¸Œæœ›é€šè¿‡é™ç»´ç®—æ³•æ¥å¯»æ‰¾æ•°æ®å†…éƒ¨çš„æœ¬è´¨ç»“æ„ç‰¹å¾ã€‚</p><h5 id="å¼ºåŒ–å­¦ä¹ "><a href="#å¼ºåŒ–å­¦ä¹ " class="headerlink" title="å¼ºåŒ–å­¦ä¹ "></a>å¼ºåŒ–å­¦ä¹ </h5><p>å¼ºåŒ–å­¦ä¹ æ›´æ¥è¿‘ç”Ÿç‰©å­¦ä¹ çš„æœ¬è´¨ï¼Œå› æ­¤æœ‰æœ›è·å¾—æ›´é«˜çš„æ™ºèƒ½ã€‚å®ƒå…³æ³¨çš„æ˜¯æ™ºèƒ½ä½“å¦‚ä½•åœ¨ç¯å¢ƒä¸­é‡‡å–ä¸€ç³»åˆ—è¡Œä¸ºï¼Œä»è€Œè·å¾—æœ€å¤§çš„ç´¯ç§¯å›æŠ¥ã€‚é€šè¿‡å¼ºåŒ–å­¦ä¹ ï¼Œä¸€ä¸ªæ™ºèƒ½ä½“åº”è¯¥çŸ¥é“åœ¨ä»€ä¹ˆçŠ¶æ€ä¸‹åº”è¯¥é‡‡å–ä»€ä¹ˆè¡Œä¸ºã€‚</p><p><img src="/images/ml/1-33.jpg" alt="1-33"></p><h3 id="æ€æ ·ç”±æ•°æ®å’Œç­”æ¡ˆå¾—åˆ°è§„åˆ™ï¼Ÿ"><a href="#æ€æ ·ç”±æ•°æ®å’Œç­”æ¡ˆå¾—åˆ°è§„åˆ™ï¼Ÿ" class="headerlink" title="æ€æ ·ç”±æ•°æ®å’Œç­”æ¡ˆå¾—åˆ°è§„åˆ™ï¼Ÿ"></a>æ€æ ·ç”±æ•°æ®å’Œç­”æ¡ˆå¾—åˆ°è§„åˆ™ï¼Ÿ</h3><h4 id="æ•°æ®æ”¶é›†"><a href="#æ•°æ®æ”¶é›†" class="headerlink" title="æ•°æ®æ”¶é›†"></a>æ•°æ®æ”¶é›†</h4><h5 id="å…¬å¸å†å²æ•°æ®ç§¯ç´¯"><a href="#å…¬å¸å†å²æ•°æ®ç§¯ç´¯" class="headerlink" title="å…¬å¸å†å²æ•°æ®ç§¯ç´¯"></a>å…¬å¸å†å²æ•°æ®ç§¯ç´¯</h5><h5 id="å¸¸è§å…¬å¼€æ•°æ®é›†"><a href="#å¸¸è§å…¬å¼€æ•°æ®é›†" class="headerlink" title="å¸¸è§å…¬å¼€æ•°æ®é›†"></a>å¸¸è§å…¬å¼€æ•°æ®é›†</h5><p><a href="https://www.infoq.cn/article/zCGdpvyxJJl7*ja4RQAZ">https://www.infoq.cn/article/zCGdpvyxJJl7*ja4RQAZ</a></p><p><a href="https://zhuanlan.zhihu.com/p/34497496">https://zhuanlan.zhihu.com/p/34497496</a></p><h5 id="ç½‘ç»œçˆ¬è™«"><a href="#ç½‘ç»œçˆ¬è™«" class="headerlink" title="ç½‘ç»œçˆ¬è™«"></a>ç½‘ç»œçˆ¬è™«</h5><h4 id="ç‰¹å¾è¡¨è¾¾ï¼ˆå»å™ªã€ç‰¹å¾æå–ä¸é€‰æ‹©ï¼‰"><a href="#ç‰¹å¾è¡¨è¾¾ï¼ˆå»å™ªã€ç‰¹å¾æå–ä¸é€‰æ‹©ï¼‰" class="headerlink" title="ç‰¹å¾è¡¨è¾¾ï¼ˆå»å™ªã€ç‰¹å¾æå–ä¸é€‰æ‹©ï¼‰"></a>ç‰¹å¾è¡¨è¾¾ï¼ˆå»å™ªã€ç‰¹å¾æå–ä¸é€‰æ‹©ï¼‰</h4><p>å…¶å®ï¼Œè¯´ç™½äº†ï¼Œå°±æ˜¯æˆ‘ä»¬äººçœ¼å¯è§çš„ç‰¹å¾è½¬åŒ–ä¸ºæ•°å­—ç‰¹å¾ï¼ˆå¯ä»¥ç”¨æ•°å­¦å…¬å¼ï¼‰çš„è¿‡ç¨‹ï¼Œå¹¶ä¸”è¿™ä¸€è¿‡ç¨‹æ˜¯æœºå™¨å­¦ä¹ æœ€é‡è¦çš„ç¯èŠ‚ã€‚</p><p>  <strong>å»å™ª</strong>ï¼šå»é™¤å½±å“æœºå™¨å­¦ä¹ ç»“æœçš„åŸå§‹æ•°æ®ã€‚</p><p>  <strong>åˆ†ç±»å˜é‡ç‰¹å¾æå–</strong>ï¼šæˆ¿ä»·é¢„æµ‹ä¸­æˆ¿å­çš„é¢ç§¯ã€æœå‘ã€ä½ç½®ã€è£…ä¿®ã€æ¥¼å±‚ç­‰ç­‰ï¼Œå®ƒæ˜¯æ ‡è®°çš„å˜é‡ï¼Œä¸æ˜¯è¿ç»­çš„ã€‚</p><p>  <strong>æ–‡å­—ç‰¹å¾æå–</strong>ï¼šå¾ˆå¤šæœºå™¨å­¦ä¹ é—®é¢˜æ¶‰åŠè‡ªç„¶è¯­è¨€å¤„ç†ï¼ˆNLPï¼‰ï¼Œå¿…ç„¶è¦å¤„ç†æ–‡å­—ä¿¡æ¯ã€‚æ–‡å­—å¿…é¡»è½¬æ¢æˆå¯ä»¥é‡åŒ–çš„ç‰¹å¾å‘é‡ã€‚ä¾‹å¦‚å’±ä»¬å…¬å¸çš„ç ”å‘éƒ¨ç®—æ³•ç»„åšçš„åƒåœ¾å¹¿å‘Šå±è”½å™¨ã€‚</p><p>  <strong>å›¾ç‰‡ç‰¹å¾æå–</strong>ï¼šåšå›¾åƒè¯†åˆ«æ—¶ï¼Œæˆ‘ä»¬äººçœ¼çœ‹åˆ°çš„æ—¶å›¾ç‰‡ï¼Œä½†æ˜¯åœ¨æœºå™¨ä¸­åˆ™æ˜¯ä¸€ä¸ªæ•°å­—è¡¨ç¤ºçš„äºŒç»´çŸ©é˜µã€‚</p><p>  <strong>æ•°æ®æ ‡å‡†åŒ–</strong>ï¼šä¸»è¦ç”¨äºå¯¹æå–åçš„æ•°å­—ç‰¹å¾è¿›è¡Œå¤„ç†ï¼Œå› ä¸ºæå–å¥½çš„æ•°å­—ç‰¹å¾å¯èƒ½ä¼šå·®è·æ¯”è¾ƒå¤§ï¼Œé‚£ä¹ˆè®­ç»ƒæ¨¡å‹æ—¶ï¼Œå¾—åˆ°çš„ç‰¹å¾æƒé‡ä¼šæ¯”è¾ƒå¤§æˆ–è€…æ¯”è¾ƒå°ï¼ŒåŒæ—¶ä¹Ÿå½±å“è®¡ç®—é€Ÿåº¦ã€‚</p><h4 id="æ¨¡å‹é€‰æ‹©"><a href="#æ¨¡å‹é€‰æ‹©" class="headerlink" title="æ¨¡å‹é€‰æ‹©"></a>æ¨¡å‹é€‰æ‹©</h4><p>é€‰æ‹©æ­£ç¡®çš„ç®—æ³•çœ‹ä¼¼éš¾ä»¥é©¾é©­â€”â€”éœ€è¦ä»å‡ åç§ç›‘ç£å¼å’Œéç›‘ç£æœºå™¨å­¦ä¹ ç®—æ³•ä¸­é€‰æ‹©ï¼Œæ¯ç§ç®—æ³•åˆåŒ…å«ä¸åŒçš„å­¦ä¹ æ–¹æ³•ã€‚</p><p>æ²¡æœ‰æœ€ä½³æ–¹æ³•æˆ–ä¸‡å…¨ä¹‹ç­–ã€‚æ‰¾åˆ°æ­£ç¡®çš„ç®—æ³•åªæ˜¯è¯•é”™è¿‡ç¨‹çš„ä¸€éƒ¨åˆ†â€”â€”å³ä½¿æ˜¯ç»éªŒä¸°å¯Œçš„æ•°æ®ç§‘å­¦å®¶ï¼Œä¹Ÿæ— æ³•è¯´å‡ºæŸç§ç®—æ³•æ˜¯å¦æ— éœ€è¯•é”™å³å¯ä½¿ç”¨ã€‚ä½†ç®—æ³•çš„é€‰æ‹©è¿˜å–å†³äºæ‚¨è¦å¤„ç†çš„æ•°æ®çš„å¤§å°å’Œç±»å‹ã€æ‚¨è¦ä»æ•°æ®ä¸­è·å¾—çš„æ´å¯ŸåŠ›ä»¥åŠå¦‚ä½•è¿ç”¨è¿™äº›æ´å¯ŸåŠ›ã€‚</p><p><img src="/images/ml/3-31.png" alt="3-31"></p><h4 id="æ¨¡å‹è®­ç»ƒ"><a href="#æ¨¡å‹è®­ç»ƒ" class="headerlink" title="æ¨¡å‹è®­ç»ƒ"></a>æ¨¡å‹è®­ç»ƒ</h4><p>æˆ¿ä»·é¢„æµ‹ä¸ºä¾‹</p><p><img src="/images/ml/3-4-1.png" alt="3-4-1"></p><p>ç®—æ³•æ¨¡å‹ä»¥ç®€å•å¤šå˜é‡çº¿æ€§å›å½’ä¸ºä¾‹</p><table><thead><tr><th>é¢ç§¯(ã¡)</th><th>å§å®¤æ•°</th><th>å«ç”Ÿé—´æ•°</th><th>æˆ¿é¾„</th><th>å”®ä»·(ç™¾ä¸‡å…ƒ)</th></tr></thead><tbody><tr><td>62.47</td><td>2</td><td>1</td><td>12</td><td>213</td></tr><tr><td>58.05</td><td>1</td><td>1</td><td>20</td><td>180</td></tr><tr><td>55.87</td><td>1</td><td>1</td><td>16</td><td>152</td></tr><tr><td>68.04</td><td>2</td><td>2</td><td>18</td><td>198</td></tr></tbody></table><p><img src="/images/ml/3-4-2.jpg" alt="3-4-2"></p><p>é‚£ä¹ˆï¼Œè¿™é‡Œçš„å‡è®¾å‡½æ•°</p><p><img src="/images/ml/3-4-3.jpg" alt="3-4-3"></p><p>å‡è®¾å€¼ä¸çœŸå®å€¼ä¹‹é—´çš„å·®å°±æ˜¯è¿™ä¸ªæ¨¡å‹çš„è¯¯å·®ï¼ˆä»£ä»·ï¼‰</p><p><img src="/images/ml/3-4-4.jpg" alt="3-4-4"></p><p>å½“ä»£ä»·å‡½æ•°çš„å€¼è¶‹è¿‘äº0æ—¶ï¼Œæ¨¡å‹å°±æ¯”è¾ƒå®Œç¾äº†</p><h4 id="å‚æ•°è°ƒæ•´"><a href="#å‚æ•°è°ƒæ•´" class="headerlink" title="å‚æ•°è°ƒæ•´"></a>å‚æ•°è°ƒæ•´</h4><p>é‚£æ€æ ·èƒ½æ˜¯ä»£ä»·å‡½æ•°æœ€å°åŒ–ï¼Ÿ</p><p>æ¢¯åº¦ä¸‹é™</p><p>å…±è½­æ¢¯åº¦</p><p>æ‹Ÿç‰›é¡¿è¿­ä»£æ³•ï¼ˆBFGSï¼‰</p><p>L-BFGS</p><p>â€¦â€¦</p><p>è¿™é‡Œï¼Œæˆ‘ä»¬å·²æ¢¯åº¦ä¸‹é™æ³•ä¸ºä¾‹ï¼š</p><p><img src="/images/ml/3-4-5.jpg" alt="3-4-5"></p><h4 id><a href="#" class="headerlink" title></a><img src="/images/ml/3-4-6.jpg" alt="3-4-6"></h4><h4 id="æ¨¡å‹è¯„ä¼°"><a href="#æ¨¡å‹è¯„ä¼°" class="headerlink" title="æ¨¡å‹è¯„ä¼°"></a>æ¨¡å‹è¯„ä¼°</h4><p>å¯¹äºåˆ†ç±»é—®é¢˜ï¼š</p><p>æ­£ç¡®ç‡ã€å¬å›ç‡ã€F1å€¼ç­‰ç­‰</p><p><img src="/images/ml/3-4-8.jpg" alt="3-4-8"></p><p><img src="/images/ml/3-4-7.jpg" alt="3-4-7"></p><p>å¯¹äºå›å½’é—®é¢˜ï¼š</p><p><img src="/images/ml/3-4-9.jpg" alt="3-6-3"></p><p><img src="/images/ml/3-4-10.jpg" alt="3-6-4"></p><p>ä¸è¿‡æ‹Ÿåˆå¯¹åº”çš„ï¼Œå°±æœ‰æ¬ æ‹Ÿåˆ</p><h4 id="å®é™…é¢„æµ‹"><a href="#å®é™…é¢„æµ‹" class="headerlink" title="å®é™…é¢„æµ‹"></a>å®é™…é¢„æµ‹</h4><p>ç›´æ¥å°†æ ·æœ¬å‚æ•°å¸¦å…¥hå‡è®¾å‡½æ•°ï¼Œä¾¿å¯ä»¥å¾—åˆ°é¢„æµ‹å€¼</p><h3 id="ç®€å•çº¿æ€§å›å½’å®ç°"><a href="#ç®€å•çº¿æ€§å›å½’å®ç°" class="headerlink" title="ç®€å•çº¿æ€§å›å½’å®ç°"></a>ç®€å•çº¿æ€§å›å½’å®ç°</h3><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<span class="hljs-keyword">import</span> matplotlibmatplotlib.rcParams[<span class="hljs-string">&#x27;font.sans-serif&#x27;</span>] = [<span class="hljs-string">&#x27;SimHei&#x27;</span>]matplotlib.rcParams[<span class="hljs-string">&#x27;font.family&#x27;</span>] = <span class="hljs-string">&#x27;sans-serif&#x27;</span>matplotlib.rcParams[<span class="hljs-string">&#x27;axes.unicode_minus&#x27;</span>] = <span class="hljs-literal">False</span><span class="hljs-keyword">from</span> mpl_toolkits.mplot3d <span class="hljs-keyword">import</span> axes3d<span class="hljs-keyword">from</span> matplotlib <span class="hljs-keyword">import</span> cmimport matplotlib.ticker <span class="hljs-keyword">as</span> mtick<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">loadDataSet</span>(<span class="hljs-params">filename</span>):</span>    X = []    Y = []    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(filename, <span class="hljs-string">&#x27;rb&#x27;</span>) <span class="hljs-keyword">as</span> f:        <span class="hljs-keyword">for</span> idx, line <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(f):            line = line.decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>).strip()            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> line:                <span class="hljs-keyword">continue</span>            eles = line.split()            <span class="hljs-keyword">if</span> idx == <span class="hljs-number">0</span>:                numFea = <span class="hljs-built_in">len</span>(eles)            eles = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">float</span>, eles))            X.append(eles[:<span class="hljs-number">-1</span>])            Y.append([eles[<span class="hljs-number">-1</span>]])    <span class="hljs-keyword">return</span> np.array(X), np.array(Y)<span class="hljs-comment"># å‡è®¾å‡½æ•°</span><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">h</span>(<span class="hljs-params">theta, X</span>):</span>    <span class="hljs-keyword">return</span> np.dot(X, theta)<span class="hljs-comment"># ä»£ä»·å‡½æ•°</span><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">J</span>(<span class="hljs-params">theta, X, Y</span>):</span>    m = <span class="hljs-built_in">len</span>(X)    <span class="hljs-keyword">return</span> np.<span class="hljs-built_in">sum</span>(np.dot((h(theta, X) - Y).T, (h(theta, X) - Y)) / (<span class="hljs-number">2</span> * m))<span class="hljs-comment"># æ¢¯åº¦ä¸‹é™æ›´æ–°å…¬å¼</span><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">bgd</span>(<span class="hljs-params">alpha, maxloop, epsilon, X, Y</span>):</span>    m, n = X.shape  <span class="hljs-comment"># mæ˜¯æ ·æœ¬æ•°ï¼Œnæ˜¯ç‰¹å¾æ•°(åŒ…æ‹¬äº†å…¨éƒ¨æ˜¯1çš„x0)ï¼Œå…¶å®ä¹Ÿå°±æ˜¯å‚æ•°thetaçš„ä¸ªæ•°</span>    theta = np.zeros((n, <span class="hljs-number">1</span>))  <span class="hljs-comment"># å‚æ•°thetaå…¨éƒ¨åˆå§‹åŒ–ä¸º0</span>    count = <span class="hljs-number">0</span>  <span class="hljs-comment"># è®°å½•è¿­ä»£è½®æ¬¡</span>    converged = <span class="hljs-literal">False</span>  <span class="hljs-comment"># æ˜¯å¦å·²ç»æ”¶æ•›çš„æ ‡å¿—</span>    error = np.inf  <span class="hljs-comment"># å½“å‰çš„ä»£ä»·å‡½æ•°å€¼</span>    errors = [J(theta, X, Y), ]  <span class="hljs-comment"># è®°å½•æ¯ä¸€æ¬¡è¿­ä»£å¾—ä»£ä»·å‡½æ•°å€¼</span>    thetas = &#123;&#125;    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):        thetas[i] = [theta[i, <span class="hljs-number">0</span>], ]  <span class="hljs-comment"># è®°å½•æ¯ä¸€ä¸ªtheta jçš„å†å²æ›´æ–°</span>    <span class="hljs-keyword">while</span> count &lt;= maxloop:        <span class="hljs-keyword">if</span> (converged):            <span class="hljs-keyword">break</span>        count = count + <span class="hljs-number">1</span>        <span class="hljs-comment"># è¿™é‡Œï¼Œæˆ‘ä»¬çš„æ¢¯åº¦è®¡ç®—ç»Ÿä¸€äº†</span>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):            deriv = np.dot(X[:, j].T, (h(theta, X) - Y)).<span class="hljs-built_in">sum</span>() / m            thetas[j].append(theta[j, <span class="hljs-number">0</span>] - alpha * deriv)        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):            theta[j, <span class="hljs-number">0</span>] = thetas[j][<span class="hljs-number">-1</span>]        error = J(theta, X, Y)        errors.append(error)        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">abs</span>(errors[<span class="hljs-number">-1</span>] - errors[<span class="hljs-number">-2</span>]) &lt; epsilon):            converged = <span class="hljs-literal">True</span>    <span class="hljs-keyword">return</span> theta, errors, thetas<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">standarize</span>(<span class="hljs-params">X</span>):</span>    <span class="hljs-string">&quot;&quot;&quot;ç‰¹å¾æ ‡å‡†åŒ–å¤„ç†</span><span class="hljs-string"></span><span class="hljs-string">    Args:</span><span class="hljs-string">        X æ ·æœ¬é›†</span><span class="hljs-string">    Returns:</span><span class="hljs-string">        æ ‡å‡†åçš„æ ·æœ¬é›†</span><span class="hljs-string">    &quot;&quot;&quot;</span>    m, n = X.shape    <span class="hljs-comment"># å½’ä¸€åŒ–æ¯ä¸€ä¸ªç‰¹å¾</span>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):        features = X[:, j]        meanVal = features.mean(axis=<span class="hljs-number">0</span>)        std = features.std(axis=<span class="hljs-number">0</span>)        <span class="hljs-keyword">if</span> std != <span class="hljs-number">0</span>:            X[:, j] = (features - meanVal) / std        <span class="hljs-keyword">else</span>:            X[:, j] = <span class="hljs-number">0</span>    <span class="hljs-keyword">return</span> X<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:    data_set = os.path.dirname(os.path.abspath(__file__))+<span class="hljs-string">&#x27;/houses.txt&#x27;</span>    ori_X, Y = loadDataSet(data_set)  <span class="hljs-comment"># ä»å—äº¬é“¾å®¶æŠ“å–çš„å¤«å­åº™é™„è¿‘çš„æˆ¿å±‹æ•°æ®</span>    print(ori_X.shape)    print(Y.shape)    m, n = ori_X.shape    X = standarize(ori_X.copy())    X = np.concatenate((np.ones((m, <span class="hljs-number">1</span>)), X), axis=<span class="hljs-number">1</span>)    alpha = <span class="hljs-number">1</span>  <span class="hljs-comment"># å­¦ä¹ ç‡</span>    maxloop = <span class="hljs-number">5000</span>  <span class="hljs-comment"># æœ€å¤§è¿­ä»£æ¬¡æ•°</span>    epsilon = <span class="hljs-number">0.000001</span>  <span class="hljs-comment"># æ”¶æ•›åˆ¤æ–­æ¡ä»¶</span>    result = bgd(alpha, maxloop, epsilon, X, Y)    theta, errors, thetas = result    <span class="hljs-comment"># é¢„æµ‹</span>    normalizedSize = (<span class="hljs-number">70</span> - ori_X[:, <span class="hljs-number">0</span>].mean(<span class="hljs-number">0</span>)) / ori_X[:, <span class="hljs-number">0</span>].std(<span class="hljs-number">0</span>)    normalizedBr = (<span class="hljs-number">2</span> - ori_X[:, <span class="hljs-number">1</span>].mean(<span class="hljs-number">0</span>)) / ori_X[:, <span class="hljs-number">1</span>].std(<span class="hljs-number">0</span>)    predicateX = np.matrix([[<span class="hljs-number">1</span>, normalizedSize, normalizedBr]])    price = h(theta, predicateX)    print(<span class="hljs-string">&#x27;70ã¡ä¸¤å±…ä¼°ä»·: ï¿¥%.4fä¸‡å…ƒ&#x27;</span> % price)    <span class="hljs-comment"># %matplotlib</span>    <span class="hljs-comment"># æ‰“å°æ‹Ÿåˆå¹³é¢</span>    fittingFig = plt.figure(figsize=(<span class="hljs-number">16</span>, <span class="hljs-number">12</span>))    title = <span class="hljs-string">&#x27;bgd: rate=%.3f, maxloop=%d, epsilon=%.3f \n&#x27;</span> % (alpha, maxloop, epsilon)    ax = fittingFig.gca(projection=<span class="hljs-string">&#x27;3d&#x27;</span>)    xx = np.linspace(<span class="hljs-number">0</span>, <span class="hljs-number">200</span>, <span class="hljs-number">25</span>)    yy = np.linspace(<span class="hljs-number">0</span>, <span class="hljs-number">5</span>, <span class="hljs-number">25</span>)    zz = np.zeros((<span class="hljs-number">25</span>, <span class="hljs-number">25</span>))    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">25</span>):        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">25</span>):            normalizedSize = (xx[i] - ori_X[:, <span class="hljs-number">0</span>].mean(<span class="hljs-number">0</span>)) / ori_X[:, <span class="hljs-number">0</span>].std(<span class="hljs-number">0</span>)            normalizedSize = (xx[i] - ori_X[:, <span class="hljs-number">0</span>].mean(<span class="hljs-number">0</span>)) / ori_X[:, <span class="hljs-number">0</span>].std(<span class="hljs-number">0</span>)            x = np.matrix([[<span class="hljs-number">1</span>, normalizedSize, normalizedBr]])            zz[i, j] = h(theta, x)    xx, yy = np.meshgrid(xx, yy)    ax.zaxis.set_major_formatter(mtick.FormatStrFormatter(<span class="hljs-string">&#x27;%.2e&#x27;</span>))    ax.plot_surface(xx, yy, zz, rstride=<span class="hljs-number">1</span>, cstride=<span class="hljs-number">1</span>, cmap=cm.rainbow, alpha=<span class="hljs-number">0.1</span>, antialiased=<span class="hljs-literal">True</span>)    xs = ori_X[:, <span class="hljs-number">0</span>].flatten()    ys = ori_X[:, <span class="hljs-number">1</span>].flatten()    zs = Y[:, <span class="hljs-number">0</span>].flatten()    ax.scatter(xs, ys, zs, c=<span class="hljs-string">&#x27;b&#x27;</span>, marker=<span class="hljs-string">&#x27;o&#x27;</span>)    ax.set_xlabel(<span class="hljs-string">u&#x27;é¢ç§¯&#x27;</span>)    ax.set_ylabel(<span class="hljs-string">u&#x27;å§å®¤æ•°&#x27;</span>)    ax.set_zlabel(<span class="hljs-string">u&#x27;ä¼°ä»·&#x27;</span>)    plt.show()    errorsFig = plt.figure()    ax = errorsFig.add_subplot(<span class="hljs-number">111</span>)    ax.yaxis.set_major_formatter(mtick.FormatStrFormatter(<span class="hljs-string">&#x27;%.2e&#x27;</span>))    ax.plot(<span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(errors)), errors)    ax.set_xlabel(<span class="hljs-string">u&#x27;è¿­ä»£æ¬¡æ•°&#x27;</span>)    ax.set_ylabel(<span class="hljs-string">u&#x27;ä»£ä»·å‡½æ•°&#x27;</span>)    plt.show()</code></pre><p><img src="/images/ml/3-6-1.jpg" alt="3-6-1"></p><p><img src="/images/ml/3-6-2.jpg" alt="3-6-2"></p>]]></content>
    
    
    <categories>
      
      <category>ML</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Python</tag>
      
      <tag>ML</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€Macã€‘vimç¯å¢ƒè®¾ç½®</title>
    <link href="/2021/01/10/vim/"/>
    <url>/2021/01/10/vim/</url>
    
    <content type="html"><![CDATA[<h2 id="å¼€å‘ç¥å™¨vimå·¥å…·"><a href="#å¼€å‘ç¥å™¨vimå·¥å…·" class="headerlink" title="å¼€å‘ç¥å™¨vimå·¥å…·"></a><a id="more"></a>å¼€å‘ç¥å™¨vimå·¥å…·</h2><p><img src="/images/vim/vim-keymap.png"></p><h3 id="å®‰è£…MacVimæ¥æ›¿ä»£ç³»ç»Ÿè‡ªå¸¦vim"><a href="#å®‰è£…MacVimæ¥æ›¿ä»£ç³»ç»Ÿè‡ªå¸¦vim" class="headerlink" title="å®‰è£…MacVimæ¥æ›¿ä»£ç³»ç»Ÿè‡ªå¸¦vim"></a>å®‰è£…MacVimæ¥æ›¿ä»£ç³»ç»Ÿè‡ªå¸¦vim</h3><p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒMac è‡ªå¸¦çš„Vimä¸èƒ½æ»¡è¶³å¤§å¤šçš„éœ€æ±‚ï¼Œæ‰€ä»¥é€‰æ‹©å®‰è£…MacVim</p><p>é€šè¿‡ä¸€ä¸‹å‘½ä»¤å¯ä»¥æŸ¥çœ‹é¢„è£…vimçš„ä¿¡æ¯</p><pre><code class="hljs zsh"><span class="hljs-comment"># æŸ¥çœ‹é¢„è£…vimç‰ˆæœ¬</span>vim --version<span class="hljs-comment"># æŸ¥çœ‹é¢„è£…vimè·¯å¾„</span><span class="hljs-built_in">where</span> vim</code></pre><h4 id="MacVimå®‰è£…"><a href="#MacVimå®‰è£…" class="headerlink" title="MacVimå®‰è£…"></a>MacVimå®‰è£…</h4><p>æœ‰ä¸¤ç§æ–¹å¼æ¥å®‰è£…macvim:</p><ol><li>Githubä¸Šä¸‹è½½<a href="https://macvim-dev.github.io/macvim"><code>macvim.dmg</code></a>å®‰è£…åŒ…è¿›è¡Œå®‰è£…</li><li>ä½¿ç”¨<a href="https://brew.sh/">Homebrew</a>å®‰è£…ã€æ¨èã€‘</li></ol><p>brewå®‰è£…macvim</p><pre><code class="hljs zsh">brew install macvim</code></pre><p>ä¸ºmacvimä¸­çš„vimåˆ›å»ºåˆ«åï¼Œè¦†ç›–æ‰ç³»ç»Ÿè‡ªå¸¦çš„vimï¼Œåœ¨~/.bash_profileä¸­æ·»åŠ ä»¥ä¸‹å‘½ä»¤</p><pre><code class="hljs zsh"><span class="hljs-built_in">alias</span> vi=vim<span class="hljs-built_in">alias</span> vim=mvim<span class="hljs-built_in">alias</span> mvim=<span class="hljs-string">&#x27;/usr/local/bin/mvim -v&#x27;</span><span class="hljs-comment"># åˆ·æ–°é…ç½®æ–‡ä»¶</span><span class="hljs-built_in">source</span> ~/.bash_profile</code></pre><h4 id="MacVimé…ç½®"><a href="#MacVimé…ç½®" class="headerlink" title="MacVimé…ç½®"></a>MacVimé…ç½®</h4><p>åœ¨vimå¯åŠ¨è¿‡ç¨‹ä¸­ï¼Œé¦–å…ˆå°†æŸ¥æ‰¾é…ç½®æ–‡ä»¶å¹¶æ‰§è¡Œå…¶ä¸­çš„å‘½ä»¤ï¼Œè€Œè¿™äº›åˆå§‹åŒ–æ–‡ä»¶ä¸€èˆ¬æœ‰vimrcã€gvimrcå’Œexrcä¸‰ç§ã€‚é€šè¿‡<code>:version</code>å‘½ä»¤å¯ä»¥æŸ¥çœ‹vimçš„é…ç½®æ–‡ä»¶ä¿¡æ¯ã€‚</p><p>vimçš„é…ç½®æ–‡ä»¶æœ‰å…¨å±€å’Œç”¨æˆ·ä¸¤ç§ç‰ˆæœ¬ï¼Œåˆ†åˆ«å­˜æ”¾äº<code>$VIM</code>å’Œ<code>$HOME</code>ç›®å½•ä¸­ï¼Œç”¨æˆ·é…ç½®æ–‡ä»¶é»˜è®¤æ˜¯æ²¡æœ‰çš„ï¼Œå¿…è¦æ—¶ç”±ç”¨æˆ·è‡ªå·±åœ¨<code>$HOME</code>ç›®å½•ä¸‹åˆ›å»ºã€‚å¯ä»¥ä½¿ç”¨<code>:echo</code>å‘½ä»¤æŸ¥çœ‹ä»–ä»¬çš„è·¯å¾„ï¼Œä½¿ç”¨<code>:e</code>å‘½ä»¤è¿›å…¥ç›®å½•ã€‚</p><pre><code class="hljs zsh">:<span class="hljs-built_in">echo</span> <span class="hljs-variable">$VIM</span>/usr/<span class="hljs-built_in">local</span>/Cellar/macvim/8.2-166_1/MacVim.app/Contents/Resources/vim:<span class="hljs-built_in">echo</span> <span class="hljs-variable">$HOME</span>/Users/wangpeng<span class="hljs-comment"># å¯ä»¥é€šè¿‡:scriptnameæŸ¥çœ‹å„è„šæœ¬çš„åŠ è½½é¡ºåº</span>:scriptname/usr/<span class="hljs-built_in">local</span>/Cellar/macvim/8.2-166_1/MacVim.app/Contents/Resources/vim/vimrc  2: ~/.vimrc  3: /usr/<span class="hljs-built_in">local</span>/Cellar/macvim/8.2-166_1/MacVim.app/Contents/Resources/vim/runtime/syntax/syntax.vim  4: /usr/<span class="hljs-built_in">local</span>/Cellar/macvim/8.2-166_1/MacVim.app/Contents/Resources/vim/runtime/syntax/synload.vim  5: /usr/<span class="hljs-built_in">local</span>/Cellar/macvim/8.2-166_1/MacVim.app/Contents/Resources/vim/runtime/syntax/syncolor.vim  6: /usr/<span class="hljs-built_in">local</span>/Cellar/macvim/8.2-166_1/MacVim.app/Contents/Resources/vim/runtime/filetype.vim  7: ~/.vim/colors/solarized.vim  8: /usr/<span class="hljs-built_in">local</span>/Cellar/macvim/8.2-166_1/MacVim.app/Contents/Resources/vim/runtime/ftoff.vim  9: ~/.vim/bundle/Vundle.vim/<span class="hljs-built_in">autoload</span>/vundle.vim 10: ~/.vim/bundle/Vundle.vim/<span class="hljs-built_in">autoload</span>/vundle/config.vim 11: /usr/<span class="hljs-built_in">local</span>/Cellar/macvim/8.2-166_1/MacVim.app/Contents/Resources/vim/runtime/ftplugin.vim 12: /usr/<span class="hljs-built_in">local</span>/Cellar/macvim/8.2-166_1/MacVim.app/Contents/Resources/vim/runtime/indent.vim 13: ~/.vim/bundle/nerdtree/plugin/NERD_tree.vim 14: ~/.vim/bundle/nerdtree/<span class="hljs-built_in">autoload</span>/nerdtree.vim 15: ~/.vim/bundle/nerdtree/lib/nerdtree/path.vim 16: ~/.vim/bundle/nerdtree/lib/nerdtree/menu_controller.vim 17: ~/.vim/bundle/nerdtree/lib/nerdtree/menu_item.vim 18: ~/.vim/bundle/nerdtree/lib/nerdtree/key_map.vim 19: ~/.vim/bundle/nerdtree/lib/nerdtree/bookmark.vim 20: ~/.vim/bundle/nerdtree/lib/nerdtree/tree_file_node.vim 21: ~/.vim/bundle/nerdtree/lib/nerdtree/tree_dir_node.vim 22: ~/.vim/bundle/nerdtree/lib/nerdtree/opener.vim 23: ~/.vim/bundle/nerdtree/lib/nerdtree/creator.vim 24: ~/.vim/bundle/nerdtree/lib/nerdtree/flag_set.vim 25: ~/.vim/bundle/nerdtree/lib/nerdtree/nerdtree.vim 26: ~/.vim/bundle/nerdtree/lib/nerdtree/ui.vim 27: ~/.vim/bundle/nerdtree/lib/nerdtree/event.vim 28: ~/.vim/bundle/nerdtree/lib/nerdtree/notifier.vim 29: ~/.vim/bundle/nerdtree/<span class="hljs-built_in">autoload</span>/nerdtree/ui_glue.vim 30: ~/.vim/bundle/nerdtree/nerdtree_plugin/exec_menuitem.vim 31: ~/.vim/bundle/nerdtree/nerdtree_plugin/fs_menu.vim 32: ~/.vim/bundle/nerdtree/nerdtree_plugin/vcs.vim 33: ~/.vim/bundle/nerdtree-git-plugin/nerdtree_plugin/git_status.vim 34: ~/.vim/bundle/nerdtree-git-plugin/<span class="hljs-built_in">autoload</span>/gitstatus.vim 35: ~/.vim/bundle/nerdtree-git-plugin/<span class="hljs-built_in">autoload</span>/gitstatus/log.vim 36: ~/.vim/bundle/nerdtree-git-plugin/<span class="hljs-built_in">autoload</span>/gitstatus/listener.vim 37: ~/.vim/bundle/vim-autopep8/plugin/python_autopep8.vim 38: /usr/<span class="hljs-built_in">local</span>/Cellar/macvim/8.2-166_1/MacVim.app/Contents/Resources/vim/runtime/plugin/getscriptPlugin.vim 39: /usr/<span class="hljs-built_in">local</span>/Cellar/macvim/8.2-166_1/MacVim.app/Contents/Resources/vim/runtime/plugin/gzip.vim 40: /usr/<span class="hljs-built_in">local</span>/Cellar/macvim/8.2-166_1/MacVim.app/Contents/Resources/vim/runtime/plugin/logiPat.vim 41: /usr/<span class="hljs-built_in">local</span>/Cellar/macvim/8.2-166_1/MacVim.app/Contents/Resources/vim/runtime/plugin/manpager.vim 42: /usr/<span class="hljs-built_in">local</span>/Cellar/macvim/8.2-166_1/MacVim.app/Contents/Resources/vim/runtime/plugin/matchparen.vim 43: /usr/<span class="hljs-built_in">local</span>/Cellar/macvim/8.2-166_1/MacVim.app/Contents/Resources/vim/runtime/plugin/netrwPlugin.vim 44: /usr/<span class="hljs-built_in">local</span>/Cellar/macvim/8.2-166_1/MacVim.app/Contents/Resources/vim/runtime/plugin/rrhelper.vim 45: /usr/<span class="hljs-built_in">local</span>/Cellar/macvim/8.2-166_1/MacVim.app/Contents/Resources/vim/runtime/plugin/spellfile.vim 46: /usr/<span class="hljs-built_in">local</span>/Cellar/macvim/8.2-166_1/MacVim.app/Contents/Resources/vim/runtime/plugin/tarPlugin.vim 47: /usr/<span class="hljs-built_in">local</span>/Cellar/macvim/8.2-166_1/MacVim.app/Contents/Resources/vim/runtime/plugin/tohtml.vim 48: /usr/<span class="hljs-built_in">local</span>/Cellar/macvim/8.2-166_1/MacVim.app/Contents/Resources/vim/runtime/plugin/vimballPlugin.vim 49: /usr/<span class="hljs-built_in">local</span>/Cellar/macvim/8.2-166_1/MacVim.app/Contents/Resources/vim/runtime/plugin/zipPlugin.vim 50: ~/.vim/bundle/indentLine/after/plugin/indentLine.vim 51: ~/.vim/bundle/nerdtree/syntax/nerdtree.vim 52: ~/.vim/bundle/nerdtree-git-plugin/after/syntax/nerdtree.vim 53: ~/.vim/bundle/nerdtree-git-plugin/<span class="hljs-built_in">autoload</span>/gitstatus/util.vim 54: ~/.vim/bundle/nerdtree-git-plugin/<span class="hljs-built_in">autoload</span>/gitstatus/job.vim</code></pre><h5 id="ç”¨æˆ·é…ç½®æ–‡ä»¶"><a href="#ç”¨æˆ·é…ç½®æ–‡ä»¶" class="headerlink" title="ç”¨æˆ·é…ç½®æ–‡ä»¶"></a>ç”¨æˆ·é…ç½®æ–‡ä»¶</h5><pre><code class="hljs zsh"><span class="hljs-comment"># åˆ‡æ¢è‡³ç”¨æˆ·ç›®å½•</span><span class="hljs-built_in">cd</span> ~<span class="hljs-comment"># ä½¿ç”¨vimåˆ›å»ºå¹¶æ‰“å¼€.vimrc</span>vim .vimrc</code></pre><h5 id="è®¾ç½®ä¸»é¢˜"><a href="#è®¾ç½®ä¸»é¢˜" class="headerlink" title="è®¾ç½®ä¸»é¢˜"></a>è®¾ç½®ä¸»é¢˜</h5><pre><code class="hljs zsh">colorscheme solarized</code></pre><h5 id="æ˜¾ç¤ºå¸®åŠ©ä¸ºä¸­æ–‡"><a href="#æ˜¾ç¤ºå¸®åŠ©ä¸ºä¸­æ–‡" class="headerlink" title="æ˜¾ç¤ºå¸®åŠ©ä¸ºä¸­æ–‡"></a>æ˜¾ç¤ºå¸®åŠ©ä¸ºä¸­æ–‡</h5><p>ä¸‹è½½<a href="https://sourceforge.net/projects/vimcdoc/?source=typ_redirect">vimdoc</a></p><p><img src="/images/vim/doc.png"></p><p>å°†æ–‡ä»¶è§£å‹åˆ°~/.vim/docï¼Œè‹¥è·¯å¾„ä¸å­˜åœ¨åˆ™åˆ›å»º</p><p>æ‰“å¼€vimæ‰§è¡Œ:helptags ~/.vim/doc</p><p>åœ¨~/.vimrcä¸­è¿›è¡Œé…ç½®ï¼š</p><pre><code class="hljs zsh"><span class="hljs-built_in">set</span> helplang=cn <span class="hljs-keyword">if</span> version &gt;= 603    <span class="hljs-built_in">set</span> helplang=cn    <span class="hljs-built_in">set</span> encoding=utf-8endif</code></pre><p>å¸¸è§çš„vimå¿«æ·é”®å¯ä»¥çœ‹<a href="https://stackoverflow.com/questions/5400806/what-are-the-most-used-vim-commands-keypresses/5400978#5400978">è¿™é‡Œ</a></p><h5 id="å­—ç¬¦ç¼–ç "><a href="#å­—ç¬¦ç¼–ç " class="headerlink" title="å­—ç¬¦ç¼–ç "></a>å­—ç¬¦ç¼–ç </h5><p>enc,fenc,fencs,tenc,ä¸€èˆ¬ä¹±ç å¤šæ˜¯å› è¿™äº›å‚æ•°è®¾ç½®ä¸æ­£ç¡®å¼•èµ·ï¼š</p><ol><li>encï¼Œvimå†…éƒ¨ä½¿ç”¨çš„ç¼–ç ï¼Œå¦‚bufferï¼Œå¯„å­˜å™¨ä¸­çš„å­—ç¬¦ä¸²ï¼Œwindowsä¸€èˆ¬æ˜¯gbkï¼Œmacæ˜¯utf-8</li><li>fencï¼Œå½“å‰æ‰“å¼€æ–‡ä»¶è‡ªèº«çš„ç¼–ç ï¼Œå¦‚æœencå’Œfencä¸ä¸€è‡´ï¼Œvimä¼šåšç¼–ç è½¬æ¢ï¼Œè½¬æ¢æˆfencç¼–ç ä¿å­˜æ–‡ä»¶</li><li>fencsï¼Œä¸€ä¸ªå­—ç¬¦ç¼–ç åˆ—è¡¨ï¼Œç¼–ç çš„è‡ªåŠ¨è¯†åˆ«å°±æ˜¯é€šè¿‡å®ƒå®ç°çš„</li><li>tencï¼Œç»ˆç«¯ä½¿ç”¨çš„ç¼–ç ï¼Œæˆ–è€…è¯´vimç”¨äºå±å¹•æ˜¾ç¤ºæ—¶çš„ç¼–ç ï¼Œæ˜¾ç¤ºæ—¶vimä¼šæŠŠå†…éƒ¨ç¼–ç è½¬æ¢ä¸ºå±å¹•ç¼–ç è¿›è¡Œè¾“å‡ºï¼Œé»˜è®¤ä¸ºenc</li></ol><pre><code class="hljs zsh"><span class="hljs-string">&quot; å°†encè®¾ç½®ä¸ºutf-8</span><span class="hljs-string">set enc=utf-8</span></code></pre><h4 id="vimæ’ä»¶ç®¡ç†å™¨â€”Vundle"><a href="#vimæ’ä»¶ç®¡ç†å™¨â€”Vundle" class="headerlink" title="vimæ’ä»¶ç®¡ç†å™¨â€”Vundle"></a>vimæ’ä»¶ç®¡ç†å™¨â€”Vundle</h4><p><a href="http://github.com/VundleVim/Vundle.vim">Vundle</a> is short for <em>Vim bundle</em> and is a <a href="http://www.vim.org/">Vim</a> plugin manager.</p><p><a href="http://github.com/VundleVim/Vundle.vim">Vundle</a> allows you toâ€¦</p><ul><li>keep track of and <a href="https://github.com/VundleVim/Vundle.vim/blob/v0.10.2/doc/vundle.txt#L126-L233">configure</a> your plugins right in the <code>.vimrc</code></li><li><a href="https://github.com/VundleVim/Vundle.vim/blob/v0.10.2/doc/vundle.txt#L234-L254">install</a> configured plugins (a.k.a. scripts/bundle)</li><li><a href="https://github.com/VundleVim/Vundle.vim/blob/v0.10.2/doc/vundle.txt#L255-L265">update</a> configured plugins</li><li><a href="https://github.com/VundleVim/Vundle.vim/blob/v0.10.2/doc/vundle.txt#L266-L295">search</a> by name all available <a href="http://vim-scripts.org/vim/scripts.html">Vim scripts</a></li><li><a href="https://github.com/VundleVim/Vundle.vim/blob/v0.10.2/doc/vundle.txt#L303-L318">clean</a> unused plugins up</li><li>run the above actions in a <em>single keypress</em> with <a href="https://github.com/VundleVim/Vundle.vim/blob/v0.10.2/doc/vundle.txt#L319-L360">interactive mode</a></li></ul><p><a href="http://github.com/VundleVim/Vundle.vim">Vundle</a> automaticallyâ€¦</p><ul><li>manages the <a href="http://vimdoc.sourceforge.net/htmldoc/options.html#'runtimepath'">runtime path</a> of your installed scripts</li><li>regenerates <a href="http://vimdoc.sourceforge.net/htmldoc/helphelp.html#:helptags">help tags</a> after installing and updating</li></ul><p><a href="http://github.com/VundleVim/Vundle.vim">Vundle</a> is undergoing an <a href="https://github.com/VundleVim/Vundle.vim/blob/v0.10.2/doc/vundle.txt#L372-L396">interface change</a>, please stay up to date to get latest changes.</p><h5 id="å®‰è£…Vundle"><a href="#å®‰è£…Vundle" class="headerlink" title="å®‰è£…Vundle"></a>å®‰è£…Vundle</h5><pre><code class="hljs zsh">git <span class="hljs-built_in">clone</span> https://github.com/gmarik/Vundle.vim.git ~/.vim/bundle/Vundle.vim</code></pre><p>ä¸‹è½½Vundleæ’ä»¶ç®¡ç†å™¨ï¼Œå°†å…¶æ”¾ç½®åœ¨Vimç¼–è¾‘å™¨bundlesæ–‡ä»¶å¤¹ä¸­ã€‚ç°åœ¨ï¼Œå¯ä»¥é€šè¿‡.vimrcé…ç½®æ–‡ä»¶æ¥ç®¡ç†æ‰€æœ‰æ‰©å±•äº†ã€‚</p><h5 id="é…ç½®Vundle"><a href="#é…ç½®Vundle" class="headerlink" title="é…ç½®Vundle"></a>é…ç½®Vundle</h5><pre><code class="hljs zsh"><span class="hljs-built_in">set</span> nocompatible              <span class="hljs-string">&quot; required</span><span class="hljs-string">filetype off                  &quot;</span> required<span class="hljs-string">&quot; set the runtime path to include Vundle and initialize</span><span class="hljs-string">set rtp+=~/.vim/bundle/Vundle.vim</span><span class="hljs-string">call vundle#begin()</span><span class="hljs-string"></span><span class="hljs-string">&quot;</span> alternatively, pass a path <span class="hljs-built_in">where</span> Vundle should install plugins<span class="hljs-string">&quot;call vundle#begin(&#x27;~/some/path/here&#x27;)</span><span class="hljs-string"></span><span class="hljs-string">&quot;</span> <span class="hljs-built_in">let</span> Vundle manage Vundle, requiredPlugin <span class="hljs-string">&#x27;gmarik/Vundle.vim&#x27;</span><span class="hljs-string">&quot; Add all your plugins here (note older versions of Vundle used Bundle instead of Plugin)</span><span class="hljs-string"></span><span class="hljs-string"></span><span class="hljs-string">&quot;</span> All of your Plugins must be added before the following linecall vundle<span class="hljs-comment">#end()            &quot; required</span>filetype plugin indent on    <span class="hljs-string">&quot; required</span></code></pre><h5 id="ä½¿ç”¨Vundle"><a href="#ä½¿ç”¨Vundle" class="headerlink" title="ä½¿ç”¨Vundle"></a>ä½¿ç”¨Vundle</h5><p>å°†æƒ³è¦å®‰è£…çš„æ’ä»¶ï¼ŒæŒ‰ç…§åœ°å€å¡«å†™æ–¹æ³•ï¼Œå°†åœ°å€å¡«å†™åœ¨<strong>vundle#begin</strong>å’Œ<strong>vundle#end</strong>ä¹‹é—´å°±å¯ä»¥</p><p>è¿è¡Œ :PluginInstall</p><pre><code class="hljs zsh">:PlugInstall</code></pre><p>æ‰§è¡Œ<code>:PluginInstall</code>åçš„æˆªå›¾</p><p><img src="/images/vim/vundle.png"></p><h5 id="ç§»é™¤ä¸éœ€è¦çš„æ’ä»¶"><a href="#ç§»é™¤ä¸éœ€è¦çš„æ’ä»¶" class="headerlink" title="ç§»é™¤ä¸éœ€è¦çš„æ’ä»¶"></a>ç§»é™¤ä¸éœ€è¦çš„æ’ä»¶</h5><ol><li>ç¼–è¾‘.vimrcæ–‡ä»¶ç§»é™¤çš„ä½ è¦ç§»é™¤çš„æ’ä»¶æ‰€å¯¹åº”çš„pluginé‚£ä¸€è¡Œ</li><li>è¾“å…¥å‘½ä»¤<code>:BundleClean</code></li></ol><h5 id="å…¶ä»–å¸¸ç”¨å‘½ä»¤"><a href="#å…¶ä»–å¸¸ç”¨å‘½ä»¤" class="headerlink" title="å…¶ä»–å¸¸ç”¨å‘½ä»¤"></a>å…¶ä»–å¸¸ç”¨å‘½ä»¤</h5><pre><code class="hljs zsh">:BundleList              -åˆ—ä¸¾åˆ—è¡¨(ä¹Ÿå°±æ˜¯.vimrc)ä¸­é…ç½®çš„æ‰€æœ‰æ’ä»¶:BundleInstall          -å®‰è£…åˆ—è¡¨ä¸­çš„å…¨éƒ¨æ’ä»¶:BundleInstall!         -æ›´æ–°åˆ—è¡¨ä¸­çš„å…¨éƒ¨æ’ä»¶:BundleSearch foo   -æŸ¥æ‰¾fooæ’ä»¶:BundleSearch! foo  -åˆ·æ–°fooæ’ä»¶ç¼“å­˜:BundleClean           -æ¸…é™¤åˆ—è¡¨ä¸­æ²¡æœ‰çš„æ’ä»¶:BundleClean!          -æ¸…é™¤åˆ—è¡¨ä¸­æ²¡æœ‰çš„æ’ä»¶</code></pre><h4 id="å®‰è£…æ’ä»¶â€”æ‰“é€ IDE"><a href="#å®‰è£…æ’ä»¶â€”æ‰“é€ IDE" class="headerlink" title="å®‰è£…æ’ä»¶â€”æ‰“é€ IDE"></a>å®‰è£…æ’ä»¶â€”æ‰“é€ IDE</h4><h5 id="æ·»åŠ ç›®å½•æ ‘â€”NERDTree"><a href="#æ·»åŠ ç›®å½•æ ‘â€”NERDTree" class="headerlink" title="æ·»åŠ ç›®å½•æ ‘â€”NERDTree"></a>æ·»åŠ ç›®å½•æ ‘â€”NERDTree</h5><p>NERDTreeçš„ä½œç”¨å°±æ˜¯åˆ—å‡ºå½“å‰è·¯å¾„çš„ç›®å½•æ ‘ï¼Œä¸€èˆ¬IDEéƒ½æ˜¯æœ‰çš„ã€‚å¯ä»¥æ–¹ä¾¿çš„æµè§ˆé¡¹ç›®çš„æ€»ä½“çš„ç›®å½•ç»“æ„å’Œåˆ›å»ºåˆ é™¤é‡å‘½åæ–‡ä»¶æˆ–æ–‡ä»¶å</p><h6 id="å®‰è£…NERDTree"><a href="#å®‰è£…NERDTree" class="headerlink" title="å®‰è£…NERDTree"></a>å®‰è£…NERDTree</h6><p>æ·»åŠ ç›®å½•æ ‘ï¼š<a href="https://github.com/preservim/nerdtree">nerdtree</a></p><pre><code class="hljs bash">Plugin <span class="hljs-string">&#x27;scrooloose/nerdtree&#x27;</span></code></pre><p>æ·»åŠ gitçŠ¶æ€å›¾æ ‡ï¼š<a href="https://github.com/Xuyuanp/nerdtree-git-plugin">nerdtree-git</a></p><pre><code class="hljs bash">Plugin <span class="hljs-string">&#x27;Xuyuanp/nerdtree-git-plugin&#x27;</span></code></pre><h6 id="é…ç½®NERDTree"><a href="#é…ç½®NERDTree" class="headerlink" title="é…ç½®NERDTree"></a>é…ç½®NERDTree</h6><pre><code class="hljs zsh"><span class="hljs-string">&quot;ä½¿ç”¨F3é”®å¿«é€Ÿè°ƒå‡ºå’Œéšè—å®ƒ</span><span class="hljs-string">map &lt;F3&gt; :NERDTreeToggle&lt;CR&gt;</span><span class="hljs-string"></span><span class="hljs-string">let NERDTreeChDirMode=1</span><span class="hljs-string"></span><span class="hljs-string">&quot;</span>æ˜¾ç¤ºä¹¦ç­¾<span class="hljs-string">&quot;</span><span class="hljs-string">let NERDTreeShowBookmarks=1</span><span class="hljs-string"></span><span class="hljs-string">&quot;</span>è®¾ç½®å¿½ç•¥æ–‡ä»¶ç±»å‹<span class="hljs-string">&quot;</span><span class="hljs-string">let NERDTreeIgnore=[&#x27;\~$&#x27;, &#x27;\.pyc$&#x27;, &#x27;\.swp$&#x27;]</span><span class="hljs-string"></span><span class="hljs-string">&quot;</span>çª—å£å¤§å°<span class="hljs-string">&quot;</span><span class="hljs-string">let NERDTreeWinSize=25</span><span class="hljs-string"></span><span class="hljs-string">&quot;</span> ä¿®æ”¹é»˜è®¤ç®­å¤´<span class="hljs-built_in">let</span> g:NERDTreeDirArrowExpandable = <span class="hljs-string">&#x27;â–¸&#x27;</span><span class="hljs-built_in">let</span> g:NERDTreeDirArrowCollapsible = <span class="hljs-string">&#x27;â–¾&#x27;</span><span class="hljs-string">&quot;How can I open a NERDTree automatically when vim starts up if no files were specified?</span><span class="hljs-string">autocmd StdinReadPre * let s:std_in=1</span><span class="hljs-string">autocmd VimEnter * if argc() == 0 &amp;&amp; !exists(&quot;</span>s:std_in<span class="hljs-string">&quot;) | NERDTree | endif</span><span class="hljs-string"></span><span class="hljs-string">&quot;</span> æ‰“å¼€vimæ—¶è‡ªåŠ¨æ‰“å¼€NERDTreeautocmd vimenter * NERDTree           <span class="hljs-string">&quot;How can I open NERDTree automatically when vim starts up on opening a directory?</span><span class="hljs-string">autocmd StdinReadPre * let s:std_in=1</span><span class="hljs-string">autocmd VimEnter * if argc() == 1 &amp;&amp; isdirectory(argv()[0]) &amp;&amp; !exists(&quot;</span>s:std_in<span class="hljs-string">&quot;) | exe &#x27;NERDTree&#x27; argv()[0] | wincmd p | ene | endif</span><span class="hljs-string"></span><span class="hljs-string">&quot;</span> å…³é—­vimæ—¶ï¼Œå¦‚æœæ‰“å¼€çš„æ–‡ä»¶é™¤äº†NERDTreeæ²¡æœ‰å…¶ä»–æ–‡ä»¶æ—¶ï¼Œå®ƒè‡ªåŠ¨å…³é—­ï¼Œå‡å°‘å¤šæ¬¡æŒ‰:q!autocmd bufenter * <span class="hljs-keyword">if</span> (winnr(<span class="hljs-string">&quot;$&quot;</span>) == 1 &amp;&amp; exists(<span class="hljs-string">&quot;b:NERDTree&quot;</span>) &amp;&amp; b:NERDTree.isTabTree()) | q | endif<span class="hljs-string">&quot; å¼€å‘çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¸Œæœ›gitä¿¡æ¯ç›´æ¥åœ¨NERDTreeä¸­æ˜¾ç¤ºå‡ºæ¥ï¼Œ å’ŒEclipseä¸€æ ·ï¼Œä¿®æ”¹çš„æ–‡ä»¶å’Œå¢åŠ çš„æ–‡ä»¶éƒ½ç»™å‡ºç›¸åº”çš„æ ‡æ³¨ï¼Œ è¿™æ—¶éœ€è¦å®‰è£…çš„æ’ä»¶å°±æ˜¯ nerdtree-git-plugin,é…ç½®ä¿¡æ¯å¦‚ä¸‹</span><span class="hljs-string">let g:NERDTreeIndicatorMapCustom = &#123;</span><span class="hljs-string">    \ &quot;</span>Modified<span class="hljs-string">&quot;  : &quot;</span>âœ¹<span class="hljs-string">&quot;,</span><span class="hljs-string">    \ &quot;</span>Staged<span class="hljs-string">&quot;    : &quot;</span>âœš<span class="hljs-string">&quot;,</span><span class="hljs-string">    \ &quot;</span>Untracked<span class="hljs-string">&quot; : &quot;</span>âœ­<span class="hljs-string">&quot;,</span><span class="hljs-string">    \ &quot;</span>Renamed<span class="hljs-string">&quot;   : &quot;</span>âœ<span class="hljs-string">&quot;,</span><span class="hljs-string">    \ &quot;</span>Unmerged<span class="hljs-string">&quot;  : &quot;</span>â•<span class="hljs-string">&quot;,</span><span class="hljs-string">    \ &quot;</span>Deleted<span class="hljs-string">&quot;   : &quot;</span>âœ–<span class="hljs-string">&quot;,</span><span class="hljs-string">    \ &quot;</span>Dirty<span class="hljs-string">&quot;     : &quot;</span>âœ—<span class="hljs-string">&quot;,</span><span class="hljs-string">    \ &quot;</span>Clean<span class="hljs-string">&quot;     : &quot;</span>âœ”ï¸<span class="hljs-string">&quot;,</span><span class="hljs-string">    \ &quot;</span>Unknown<span class="hljs-string">&quot;   : &quot;</span>?<span class="hljs-string">&quot;</span><span class="hljs-string">    \ &#125;</span><span class="hljs-string"></span><span class="hljs-string">&quot;</span> æ˜¾ç¤ºè¡Œå·<span class="hljs-built_in">let</span> NERDTreeShowLineNumbers=1<span class="hljs-built_in">let</span> NERDTreeAutoCenter=1<span class="hljs-string">&quot; åœ¨ç»ˆç«¯å¯åŠ¨vimæ—¶ï¼Œå…±äº«NERDTree</span><span class="hljs-string">let g:nerdtree_tabs_open_on_console_startup=1</span></code></pre><h5 id="åˆ†å‰²å¸ƒå±€"><a href="#åˆ†å‰²å¸ƒå±€" class="headerlink" title="åˆ†å‰²å¸ƒå±€"></a>åˆ†å‰²å¸ƒå±€</h5><p>ä¸ç”¨å®‰è£…é¢å¤–æ’ä»¶ï¼Œåªéœ€è¦åœ¨.vimrcè®¾ç½®å³å¯</p><pre><code class="hljs zsh"><span class="hljs-string">&quot; æŒ‡å®šå±å¹•ä¸Šå¯ä»¥è¿›è¡Œåˆ†å‰²å¸ƒå±€çš„åŒºåŸŸ</span><span class="hljs-string">set splitbelow               &quot;</span> å…è®¸åœ¨ä¸‹éƒ¨åˆ†å‰²å¸ƒå±€<span class="hljs-built_in">set</span> splitright               <span class="hljs-string">&quot; å…è®¸åœ¨å³ä¾§åˆ†éš”å¸ƒå±€</span><span class="hljs-string"></span><span class="hljs-string">&quot;</span> ç»„åˆå¿«æ·é”®ï¼šnnoremap &lt;C-J&gt; &lt;C-W&gt;&lt;C-J&gt;    <span class="hljs-string">&quot; ç»„åˆå¿«æ·é”®ï¼š- Ctrl-j åˆ‡æ¢åˆ°ä¸‹æ–¹çš„åˆ†å‰²çª—å£</span><span class="hljs-string">nnoremap &lt;C-K&gt; &lt;C-W&gt;&lt;C-K&gt;    &quot;</span> ç»„åˆå¿«æ·é”®ï¼š- Ctrl-k åˆ‡æ¢åˆ°ä¸Šæ–¹çš„åˆ†å‰²çª—å£nnoremap &lt;C-L&gt; &lt;C-W&gt;&lt;C-L&gt;    <span class="hljs-string">&quot; ç»„åˆå¿«æ·é”®ï¼š- Ctrl-l åˆ‡æ¢åˆ°å³ä¾§çš„åˆ†å‰²çª—å£</span><span class="hljs-string">nnoremap &lt;C-H&gt; &lt;C-W&gt;&lt;C-H&gt;    &quot;</span> ç»„åˆå¿«æ·é”®ï¼š- Ctrl-h åˆ‡æ¢åˆ°å·¦ä¾§çš„åˆ†å‰²çª—å£</code></pre><p>nnoremapå°†ä¸€ä¸ªç»„åˆå¿«æ·é”®æ˜ å°„ä¸ºå¦ä¸€ä¸ªå¿«æ·é”®ã€‚noéƒ¨åˆ†ï¼ŒæŒ‡çš„æ˜¯åœ¨Vimçš„æ­£å¸¸æ¨¡å¼ï¼ˆNormal Modeï¼‰ä¸‹ï¼Œ<br>è€Œä¸æ˜¯å¯è§†æ¨¡å¼ä¸‹é‡æ–°æ˜ å°„ï¼Œæ›´å¤šä¿¡æ¯è¯·çœ‹<a href="https://stackoverflow.com/questions/3776117/what-is-the-difference-between-the-remap-noremap-nnoremap-and-vnoremap-mapping">è¿™é‡Œ</a></p><h5 id="pythonä»£ç ç¼©è¿›"><a href="#pythonä»£ç ç¼©è¿›" class="headerlink" title="pythonä»£ç ç¼©è¿›"></a>pythonä»£ç ç¼©è¿›</h5><p>ä»£ç çš„æ­£ç¡®ç¼©è¿›æ˜¯è‡³å…³é‡è¦çš„ï¼Œæˆ‘ä»¬å°†ä»ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ä¸ºvimé…ç½®ä»£ç ç¼©è¿›åŠŸèƒ½ï¼š</p><ol><li>pythonä»£ç çš„è‡ªåŠ¨ç¼©è¿›</li><li>éµä»<a href="https://www.cnblogs.com/ajianbeyourself/p/4377933.html">PEP8</a>ä»£ç é£æ ¼æ ‡å‡†</li><li>è‡ªåŠ¨æ ¼å¼åŒ–ä¸ºPEP8ä»£ç </li></ol><h6 id="å®‰è£…æ’ä»¶"><a href="#å®‰è£…æ’ä»¶" class="headerlink" title="å®‰è£…æ’ä»¶"></a><strong>å®‰è£…æ’ä»¶</strong></h6><p>è‡ªåŠ¨ç¼©è¿›æœ‰ç”¨ï¼Œä½†æ˜¯åœ¨æŸäº›æƒ…å†µä¸‹ï¼ˆæ¯”å¦‚å‡½æ•°å®šä¹‰æœ‰å¤šè¡Œçš„æ—¶å€™ï¼‰ï¼Œå¹¶ä¸æ€»æ˜¯ä¼šè¾¾åˆ°ä½ æƒ³è¦çš„æ•ˆæœï¼Œå°¤å…¶æ˜¯åœ¨ç¬¦åˆPEP8æ ‡å‡†æ–¹é¢ã€‚æˆ‘ä»¬å¯ä»¥åˆ©ç”¨<a href="https://github.com/vim-scripts/indentpython.vim"><code>indentpython.vim</code></a>æ’ä»¶ï¼Œæ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼š</p><pre><code class="hljs zsh">Plugin <span class="hljs-string">&#x27;vim-scripts/indentpython.vim&#x27;</span></code></pre><p>å°†pythonä»£ç è‡ªåŠ¨æ ¼å¼åŒ–ä¸ºç¬¦åˆpep8æ ‡å‡†çš„ä»£ç ç”¨åˆ°<a href="https://github.com/tell-k/vim-autopep8"><code>tell-k/vim-autopep8</code></a>æ’ä»¶ï¼š</p><pre><code class="hljs zsh">Plugin <span class="hljs-string">&#x27;tell-k/vim-autopep8&#x27;</span></code></pre><p>è¦ä½¿ç”¨<code>tell-k/vim-autopep8</code>æ’ä»¶å¿…é¡»å…ˆåœ¨ç”µè„‘ä¸Šå®‰è£…pythonçš„ç¬¬ä¸‰æ–¹åŒ…<a href="https://pypi.org/project/autopep8/"><code>autopep8</code></a>ã€‚ä½†å¥‡æ€ªçš„æ˜¯ç”¨pipå®‰è£…æ—¶æ‰¾ä¸åˆ°è¿™ä¸ªåŒ…ï¼Œæˆ‘ä»¬ä½¿ç”¨<code>easy-install</code>æ¥å®‰è£…ï¼Œåªéœ€è¦åœ¨mæŸä¸ªpythonç¯å¢ƒä¸‹å®‰è£…ä¸€æ¬¡å³å¯ï¼Œå®æµ‹åœ¨å…¶ä»–ç¯å¢ƒä¸‹ä¹Ÿå¯ç”¨ï¼š</p><pre><code class="hljs zsh">easy_install autopep8</code></pre><h6 id="é…ç½®æ’ä»¶"><a href="#é…ç½®æ’ä»¶" class="headerlink" title="é…ç½®æ’ä»¶"></a>é…ç½®æ’ä»¶</h6><p>.vimrcæ–‡ä»¶ä¸­æ·»åŠ ä¸‹é¢çš„é…ç½®ã€‚è¿™äº›è®¾ç½®å°†è®©Vimä¸­çš„Tabé”®å°±ç›¸å½“äº4ä¸ªæ ‡å‡†çš„ç©ºæ ¼ç¬¦ï¼Œç¡®ä¿æ¯è¡Œä»£ç é•¿åº¦ä¸è¶…è¿‡80ä¸ªå­—ç¬¦ï¼Œå¹¶ä¸”ä¼šä»¥unixæ ¼å¼å‚¨å­˜æ–‡ä»¶ï¼Œé¿å…åœ¨æ¨é€åˆ°Githubæˆ–åˆ†äº«ç»™å…¶ä»–ç”¨æˆ·æ—¶å‡ºç°æ–‡ä»¶è½¬æ¢é—®é¢˜ã€‚</p><pre><code class="hljs zsh"><span class="hljs-string">&quot; æŒ‰ç…§PEP8æ ‡å‡†æ¥é…ç½®vim</span><span class="hljs-string">au BufNewFile,BufRead *.py set tabstop=4 |set softtabstop=4|set shiftwidth=4|set textwidth=79|set expandtab|set autoindent|set fileformat=unix</span></code></pre><p>å¯¹äºå…¨æ ˆå¼€å‘ï¼Œä½ å¯ä»¥è®¾ç½®é’ˆå¯¹æ¯ç§æ–‡ä»¶ç±»å‹è®¾ç½®auå‘½ä»¤ï¼š</p><pre><code class="hljs zsh">au BufNewFile,BufRead *.js, *.html, *.css <span class="hljs-built_in">set</span> tabstop=2|<span class="hljs-built_in">set</span> softtabstop=2|<span class="hljs-built_in">set</span> shiftwidth=2</code></pre><p>ä¸‹é¢æ¥é…ç½®vim-autopep8</p><pre><code class="hljs zsh"><span class="hljs-string">&quot; Disable show diff window</span><span class="hljs-string">let g:autopep8_disable_show_diff=1</span><span class="hljs-string"></span><span class="hljs-string">&quot;</span> vim-autopep8è‡ª1.11ç‰ˆæœ¬ä¹‹åå–æ¶ˆäº†F8å¿«æ·é”®ï¼Œéœ€è¦ç”¨æˆ·è‡ªå·±ä¸º:Autopep8è®¾ç½®å¿«æ·é”®ï¼šautocmd FileType python noremap &lt;buffer&gt; &lt;F8&gt; :call Autopep8()&lt;CR&gt;</code></pre><h6 id="ä½¿ç”¨æ’ä»¶"><a href="#ä½¿ç”¨æ’ä»¶" class="headerlink" title="ä½¿ç”¨æ’ä»¶"></a>ä½¿ç”¨æ’ä»¶</h6><p>åœ¨ä½¿ç”¨macvimç¼–è¾‘<code>*.py</code>æ–‡ä»¶æ—¶ï¼š</p><ul><li>ä»£ç è‡ªåŠ¨æŒ‰ç…§PEP8è§„åˆ™è¿›è¡Œç¼©è¿›ï¼›</li><li>tapé”®ç›¸å½“äº4ä¸ªæ ‡å‡†ç©ºæ ¼ï¼Œæ¯è¡Œä»£ç ä¸è¶…è¿‡80å­—ç¬¦ï¼›</li><li>ä½¿ç”¨<code>:Autopep8</code>å‘½ä»¤æˆ–è€…<code>F8</code>å¿«æ·é”®è‡ªåŠ¨æŒ‰ç…§PEP8æ ‡å‡†æ ¼å¼åŒ–pythonä»£ç </li></ul><p>åœ¨ä½¿ç”¨macvimç¼–è¾‘<code>*.js</code>, <code>*.html</code>, <code>*.css</code>æ–‡ä»¶æ—¶,tapé”®ç›¸å½“äº2ä¸ªæ ‡å‡†ç©ºæ ¼</p><h5 id="æ·»åŠ ä»£ç ç¼©è¿›æŒ‡ç¤ºçº¿"><a href="#æ·»åŠ ä»£ç ç¼©è¿›æŒ‡ç¤ºçº¿" class="headerlink" title="æ·»åŠ ä»£ç ç¼©è¿›æŒ‡ç¤ºçº¿"></a>æ·»åŠ ä»£ç ç¼©è¿›æŒ‡ç¤ºçº¿</h5><h6 id="å®‰è£…indentline"><a href="#å®‰è£…indentline" class="headerlink" title="å®‰è£…indentline"></a>å®‰è£…indentline</h6><p>indentLineæ˜¯ä¸€æ¬¾ç¼©è¿›æŒ‡ç¤ºçº¿ï¼Œç”±çº¯å­—ç¬¦å®ç°ï¼Œæ•ˆæœæ¯”è¾ƒå®Œç¾</p><pre><code class="hljs bash">Plugin <span class="hljs-string">&#x27;Yggdroot/indentLine&#x27;</span></code></pre><h6 id="é…ç½®indentline"><a href="#é…ç½®indentline" class="headerlink" title="é…ç½®indentline"></a>é…ç½®indentline</h6><p><a href="https://github.com/Yggdroot/indentLine"><code>indentLine</code></a>é»˜è®¤æ˜¯å…³é—­çš„ï¼Œå› æ­¤éœ€è¦åœ¨.vimrcä¸­é…ç½®æ‰èƒ½çœ‹åˆ°æ•ˆæœï¼š</p><pre><code class="hljs bash"><span class="hljs-string">&quot; æ”¯æŒä»»æ„ASCIIç ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ç‰¹æ®Šå­—ç¬¦ï¼šÂ¦, â”†, or â”‚ ï¼Œä½†åªåœ¨utf-8ç¼–ç ä¸‹æœ‰æ•ˆ</span><span class="hljs-string">let g:indentLine_char=&#x27;Â¦&#x27;   </span><span class="hljs-string"></span><span class="hljs-string">&quot;</span> ä½¿indentlineç”Ÿæ•ˆ<span class="hljs-built_in">let</span> g:indentLine_enabled = 1</code></pre><h6 id="ä½¿ç”¨indentline"><a href="#ä½¿ç”¨indentline" class="headerlink" title="ä½¿ç”¨indentline"></a>ä½¿ç”¨indentline</h6><p>åœ¨ä»£ç ç¼©è¿›å¤„ï¼Œè‡ªåŠ¨ç”Ÿæˆç¼©è¿›æŒ‡ç¤ºçº¿</p><h5 id="ä»£ç æŠ˜å "><a href="#ä»£ç æŠ˜å " class="headerlink" title="ä»£ç æŠ˜å "></a>ä»£ç æŠ˜å </h5><p>å¤§å¤šæ•°â€œç°ä»£â€é›†æˆå¼€å‘ç¯å¢ƒï¼ˆIDEï¼‰éƒ½æä¾›å¯¹æ–¹æ³•ï¼ˆmethodsï¼‰æˆ–ç±»ï¼ˆclassesï¼‰è¿›è¡ŒæŠ˜å çš„æ‰‹æ®µï¼Œåªæ˜¾ç¤ºç±»æˆ–æ–¹æ³•çš„å®šä¹‰éƒ¨åˆ†ï¼Œè€Œä¸æ˜¯å…¨éƒ¨çš„ä»£ç ã€‚</p><h6 id="å®‰è£…æ’ä»¶-1"><a href="#å®‰è£…æ’ä»¶-1" class="headerlink" title="å®‰è£…æ’ä»¶"></a>å®‰è£…æ’ä»¶</h6><p>æœ¬èº«ä¸ç”¨å®‰è£…é¢å¤–æ’ä»¶ï¼Œä½†ä¸ºé¿å…å‡ºç°è¶…è¿‡ä½ æ‰€å¸Œæœ›çš„æŠ˜å æ•°ç›®ï¼Œæˆ‘ä»¬æ¨è<a href="https://github.com/tmhedberg/SimpylFold"><code>SimplyFold</code></a>æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼š</p><pre><code class="hljs bash">Plugin <span class="hljs-string">&#x27;tmhedberg/SimpylFold&#x27;</span></code></pre><h6 id="é…ç½®æ’ä»¶-1"><a href="#é…ç½®æ’ä»¶-1" class="headerlink" title="é…ç½®æ’ä»¶"></a>é…ç½®æ’ä»¶</h6><pre><code class="hljs bash"><span class="hljs-string">&quot; å¿…é¡»æ‰‹åŠ¨è¾“å…¥zaæ¥æŠ˜å ï¼ˆå’Œå–æ¶ˆæŠ˜å ï¼‰</span><span class="hljs-string">set foldmethod=indent                &quot;</span> æ ¹æ®æ¯è¡Œçš„ç¼©è¿›å¼€å¯æŠ˜å <span class="hljs-built_in">set</span> foldlevel=99<span class="hljs-string">&quot; ä½¿ç”¨ç©ºæ ¼é”®ä¼šæ˜¯æ›´å¥½çš„é€‰æ‹©,æ‰€ä»¥åœ¨ä½ çš„é…ç½®æ–‡ä»¶ä¸­åŠ ä¸Šè¿™ä¸€è¡Œå‘½ä»¤å§ï¼š</span><span class="hljs-string">nnoremap &lt;space&gt; za</span><span class="hljs-string"></span><span class="hljs-string">&quot;</span> å¸Œæœ›çœ‹åˆ°æŠ˜å ä»£ç çš„æ–‡æ¡£å­—ç¬¦ä¸²ï¼Ÿ<span class="hljs-built_in">let</span> g:SimpylFold_docstring_preview=1</code></pre><h6 id="ä½¿ç”¨æ’ä»¶-1"><a href="#ä½¿ç”¨æ’ä»¶-1" class="headerlink" title="ä½¿ç”¨æ’ä»¶"></a>ä½¿ç”¨æ’ä»¶</h6><p>åœ¨ç¨‹åºå—å¤„ä¼šæ˜¾ç¤ºæŠ˜å çº¿ï¼Œå½“å…‰æ ‡æ”¾äºæŠ˜å çº¿æ—¶ï¼ŒæŒ‰ç©ºæ ¼é”®å¯ä»¥åˆ‡æ¢åœ¨è¯¥æŠ˜å çº¿å¤„æ˜¯å¦æŠ˜å ã€‚</p><h5 id="æ‹¬å·è‡ªåŠ¨è¡¥å…¨"><a href="#æ‹¬å·è‡ªåŠ¨è¡¥å…¨" class="headerlink" title="æ‹¬å·è‡ªåŠ¨è¡¥å…¨"></a>æ‹¬å·è‡ªåŠ¨è¡¥å…¨</h5><p><a href="https://github.com/jiangmiao/auto-pairs">auto-pairs</a>ä¸»è¦åŠŸèƒ½æ˜¯æ‹¬å·å’Œå¼•å·è‡ªåŠ¨è¡¥å…¨ï¼Œè¾“å…¥å·¦å¼•å·å’Œå·¦æ‹¬å·è‡ªåŠ¨è¡¥å…¨å¦å¤–ä¸€åŠ,å®‰è£…å¥½å°±å¯ä»¥æ— éœ€é¢å¤–é…ç½®</p><pre><code class="hljs bash">Plugin <span class="hljs-string">&#x27;jiangmiao/auto-pairs&#x27;</span></code></pre><h5 id="å¤šè¡Œæ³¨é‡Š"><a href="#å¤šè¡Œæ³¨é‡Š" class="headerlink" title="å¤šè¡Œæ³¨é‡Š"></a>å¤šè¡Œæ³¨é‡Š</h5><h6 id="å®‰è£…æ’ä»¶-2"><a href="#å®‰è£…æ’ä»¶-2" class="headerlink" title="å®‰è£…æ’ä»¶"></a>å®‰è£…æ’ä»¶</h6><pre><code class="hljs bash">Plugin <span class="hljs-string">&#x27;scrooloose/nerdcommenter&#x27;</span></code></pre><h6 id="é…ç½®æ’ä»¶-2"><a href="#é…ç½®æ’ä»¶-2" class="headerlink" title="é…ç½®æ’ä»¶"></a>é…ç½®æ’ä»¶</h6><pre><code class="hljs xml">&quot; nerdcommenteré»˜è®¤çƒ­é”®<span class="hljs-tag">&lt;<span class="hljs-name">leader</span>&gt;</span>ä¸º&#x27;\&#x27;ï¼Œè¿™é‡Œå°†çƒ­é”®è®¾ç½®ä¸º&#x27;,&#x27;let mapleader=&#x27;,&#x27;&quot; è®¾ç½®æ³¨é‡Šå¿«æ·é”®map <span class="hljs-tag">&lt;<span class="hljs-name">F4</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">leader</span>&gt;</span>ci<span class="hljs-tag">&lt;<span class="hljs-name">CR</span>&gt;</span></code></pre><h6 id="ä½¿ç”¨æ’ä»¶-2"><a href="#ä½¿ç”¨æ’ä»¶-2" class="headerlink" title="ä½¿ç”¨æ’ä»¶"></a>ä½¿ç”¨æ’ä»¶</h6><p>åœ¨normalæ¨¡å¼ä¸‹æŒ‰vå¹¶ç§»åŠ¨å…‰æ ‡é€‰æ‹©éœ€è¦æ³¨é‡Šçš„è¡Œï¼Œå†æŒ‰F4å°±å¯ä»¥ä¸ºæ‰€æœ‰é€‰ä¸­çš„è¡Œæ·»åŠ æ³¨é‡Š</p>]]></content>
    
    
    <categories>
      
      <category>Develop</category>
      
    </categories>
    
    
    <tags>
      
      <tag>vim</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€ALLã€‘CAPåˆ†å¸ƒå¼ä¸€è‡´æ€§</title>
    <link href="/2020/11/25/cap/"/>
    <url>/2020/11/25/cap/</url>
    
    <content type="html"><![CDATA[<h3 id><a href="#" class="headerlink" title></a><a id="more"></a></h3>]]></content>
    
    
    <categories>
      
      <category>Develop</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Paxos</tag>
      
      <tag>Raft</tag>
      
      <tag>ZAB</tag>
      
      <tag>Zookeeper</tag>
      
      <tag>Etcd</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€ALLã€‘MR&amp;Yarn:Hadoopè®¡ç®—æ¡†æ¶ä¸èµ„æºè°ƒåº¦æ¡†æ¶</title>
    <link href="/2020/11/25/hadoop-MR/"/>
    <url>/2020/11/25/hadoop-MR/</url>
    
    <content type="html"><![CDATA[<h3 id><a href="#" class="headerlink" title></a><a id="more"></a></h3>]]></content>
    
    
    <categories>
      
      <category>Bdata</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Hadoop</tag>
      
      <tag>å¤§æ•°æ®</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€Pythonã€‘è®¾è®¡æ¨¡å¼</title>
    <link href="/2020/11/20/design-pattern-python/"/>
    <url>/2020/11/20/design-pattern-python/</url>
    
    <content type="html"><![CDATA[<blockquote><p>Patterns mean â€œI have run out of language.â€ - Rich Hickey</p><p><strong>Design patterns</strong> are typical solutions to common problemsin software design. Each pattern is like a blueprintthat you can customize to solve a particulardesign problem in your code.<a id="more"></a> </p></blockquote><h3 id="åˆ›å»ºå‹"><a href="#åˆ›å»ºå‹" class="headerlink" title="åˆ›å»ºå‹"></a>åˆ›å»ºå‹</h3><h4 id="Method-å·¥å‚æ–¹æ³•"><a href="#Method-å·¥å‚æ–¹æ³•" class="headerlink" title="Method(å·¥å‚æ–¹æ³•)"></a>Method(å·¥å‚æ–¹æ³•)</h4><p>æ‰§è¡Œå•ç‹¬çš„å‡½æ•°ï¼Œé€šè¿‡ä¼ å‚æä¾›éœ€è¦çš„å¯¹è±¡çš„ä¿¡æ¯ã€‚</p><pre><code class="hljs Python"><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">Module Description: å·¥å‚æ–¹æ³•</span><span class="hljs-string">Problem:åœ¨å·¥å‚æ–¹æ³•æ¨¡å¼ä¸­ï¼Œæˆ‘ä»¬æ‰§è¡Œå‡½æ•°ï¼Œä¼ å…¥ä¸€ä¸ªå‚æ•°ï¼Œä½†ä¸éœ€è¦çŸ¥é“ä»»ä½•å…³äºå¯¹è±¡å¦‚ä½•å®ç°ä»¥åŠå¯¹è±¡æ¥è‡ªå“ªé‡Œçš„ç»†èŠ‚</span><span class="hljs-string">Solutionï¼š</span><span class="hljs-string">Date: 2020/1/8 </span><span class="hljs-string">Author: Wang P</span><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-keyword">import</span> json<span class="hljs-keyword">import</span> xml.etree.ElementTree <span class="hljs-keyword">as</span> etree<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Connector</span>:</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, filepath</span>):</span>        factory = <span class="hljs-literal">None</span>        <span class="hljs-keyword">try</span>:            factory = self.connector_factory(filepath)        <span class="hljs-keyword">except</span> ValueError <span class="hljs-keyword">as</span> e:            print(e)        self.factory = factory    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">connector_factory</span>(<span class="hljs-params">self, filepath</span>):</span>        <span class="hljs-keyword">if</span> filepath.endswith(<span class="hljs-string">&#x27;json&#x27;</span>):            connector = self.JSONConnector        <span class="hljs-keyword">elif</span> filepath.endswith(<span class="hljs-string">&#x27;xml&#x27;</span>):            connector = self.XMLConnector        <span class="hljs-keyword">else</span>:            <span class="hljs-keyword">raise</span> ValueError(<span class="hljs-string">&#x27;Cannot connect to &#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(filepath))        <span class="hljs-keyword">return</span> connector(filepath)    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">JSONConnector</span>:</span>        <span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">        JSONå·¥å‚</span><span class="hljs-string">        &quot;&quot;&quot;</span>        <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, filepath</span>):</span>            self.data = <span class="hljs-built_in">dict</span>()            <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(filepath, mode=<span class="hljs-string">&#x27;r&#x27;</span>, encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>) <span class="hljs-keyword">as</span> f:                self.data = json.load(f)<span class="hljs-meta">        @property</span>        <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">parsed_data</span>(<span class="hljs-params">self</span>):</span>            <span class="hljs-keyword">return</span> self.data    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">XMLConnector</span>:</span>        <span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">        XMLå·¥å‚</span><span class="hljs-string">        &quot;&quot;&quot;</span>        <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, filepath</span>):</span>            self.tree = etree.parse(filepath)<span class="hljs-meta">        @property</span>        <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">parsed_date</span>(<span class="hljs-params">self</span>):</span>            <span class="hljs-keyword">return</span> self.tree<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span>():</span>    xml_factory = Connector(<span class="hljs-string">&#x27;data/person.xml&#x27;</span>)    xml_data = xml_factory.factory.parsed_date    smiths = xml_data.findall(<span class="hljs-string">&quot;.//&#123;&#125;[&#123;&#125;=&#x27;&#123;&#125;&#x27;]&quot;</span>.<span class="hljs-built_in">format</span>(<span class="hljs-string">&#x27;person&#x27;</span>, <span class="hljs-string">&#x27;lastName&#x27;</span>, <span class="hljs-string">&#x27;Smith&#x27;</span>))    print(<span class="hljs-string">&#x27;found: &#123;&#125; persons&#x27;</span>.<span class="hljs-built_in">format</span>(<span class="hljs-built_in">len</span>(smiths)))    <span class="hljs-keyword">for</span> smith <span class="hljs-keyword">in</span> smiths:        print(<span class="hljs-string">&#x27;first name:&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(smith.find(<span class="hljs-string">&#x27;firstName&#x27;</span>).text))        print(<span class="hljs-string">&#x27;last name:&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(smith.find(<span class="hljs-string">&#x27;lastName&#x27;</span>).text))    print()    json_factory = Connector(<span class="hljs-string">&#x27;data/donut.json&#x27;</span>)    json_data = json_factory.factory.parsed_data    print(<span class="hljs-string">&#x27;find: &#123;&#125; donuts. &#x27;</span>.<span class="hljs-built_in">format</span>(<span class="hljs-built_in">len</span>(json_data)))    <span class="hljs-keyword">for</span> donut <span class="hljs-keyword">in</span> json_data:        print(<span class="hljs-string">&#x27;name:&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(donut[<span class="hljs-string">&#x27;name&#x27;</span>]))        print(<span class="hljs-string">&#x27;ppu:&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(donut[<span class="hljs-string">&#x27;ppu&#x27;</span>]))<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:    main()</code></pre><h4 id="Abstract-Factory-æŠ½è±¡å·¥å‚-è§£å†³å¤æ‚å¯¹è±¡åˆ›å»ºé—®é¢˜"><a href="#Abstract-Factory-æŠ½è±¡å·¥å‚-è§£å†³å¤æ‚å¯¹è±¡åˆ›å»ºé—®é¢˜" class="headerlink" title="Abstract Factory(æŠ½è±¡å·¥å‚: è§£å†³å¤æ‚å¯¹è±¡åˆ›å»ºé—®é¢˜)"></a>Abstract Factory(æŠ½è±¡å·¥å‚: è§£å†³å¤æ‚å¯¹è±¡åˆ›å»ºé—®é¢˜)</h4><p>å·¥å‚æ–¹æ³•é€‚åˆå¯¹è±¡ç§ç±»è¾ƒå°‘çš„æƒ…å†µï¼Œå¦‚æœæœ‰å¤šç§ä¸åŒç±»å‹å¯¹è±¡éœ€è¦åˆ›å»ºï¼Œä½¿ç”¨æŠ½è±¡å·¥å‚æ¨¡å¼ã€‚</p><pre><code class="hljs Python"><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">Module Description: æŠ½è±¡å·¥å‚ï¼ˆå®é™…ä¸Šä¸€ä¸ªæŠ½è±¡å·¥å‚å…¶å®æ˜¯ä¸€ç»„å·¥å‚æ–¹æ³•ï¼Œæ¯ä¸ªå·¥å‚æ–¹æ³•è´Ÿè´£ç”Ÿäº§ä¸åŒç±»å‹çš„å¯¹è±¡ï¼‰</span><span class="hljs-string">Problem:</span><span class="hljs-string">Solutionï¼š</span><span class="hljs-string">Date: 2020/1/8 </span><span class="hljs-string">Author: Wang P</span><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Frog</span>(<span class="hljs-params"><span class="hljs-built_in">object</span></span>):</span>    <span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">    æ¸¸æˆè§’è‰²å¯¹è±¡-é’è›™</span><span class="hljs-string">    &quot;&quot;&quot;</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, name</span>):</span>        self.name = name    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__str__</span>(<span class="hljs-params">self</span>):</span>        <span class="hljs-keyword">return</span> self.name    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">interact_with</span>(<span class="hljs-params">self, obstacle</span>):</span>        print(<span class="hljs-string">&#x27;&#123;&#125; the Frog encounters &#123;&#125; and &#123;&#125;!&#x27;</span>.<span class="hljs-built_in">format</span>(self, obstacle, obstacle.action()))<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Bug</span>(<span class="hljs-params"><span class="hljs-built_in">object</span></span>):</span>    <span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">    éšœç¢ç‰©å¯¹è±¡-è™«å­</span><span class="hljs-string">    &quot;&quot;&quot;</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__str__</span>(<span class="hljs-params">self</span>):</span>        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;a bug&#x27;</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">action</span>(<span class="hljs-params">self</span>):</span>        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;eats it&#x27;</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FrogWorld</span>(<span class="hljs-params"><span class="hljs-built_in">object</span></span>):</span>    <span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">    æŠ½è±¡å·¥å‚ï¼Œè´Ÿè´£åˆ›å»ºæ¸¸æˆè§’è‰²ä¸éšœç¢ç‰©å¯¹è±¡</span><span class="hljs-string">    make_character()å’Œmake_obstacle()åŠ¨æ€æ”¹å˜å½“å‰æ¿€æ´»çš„å·¥å‚</span><span class="hljs-string">    åœ¨é™æ€è¯­è¨€ä¸­ï¼ŒæŠ½è±¡å·¥å‚æ˜¯æŠ½è±¡ç±»/æ¥å£ï¼Œå…·æœ‰ä¸€äº›ç©ºæ–¹æ³•ï¼ŒPythonä¸­æ— é¡»å¦‚æ­¤</span><span class="hljs-string">    &quot;&quot;&quot;</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, name</span>):</span>        print(self)        self.player_name = name    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__str__</span>(<span class="hljs-params">self</span>):</span>        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;\n\n\t------- Frog Word -------&#x27;</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">make_character</span>(<span class="hljs-params">self</span>):</span>        <span class="hljs-keyword">return</span> Frog(self.player_name)    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">make_obstacle</span>(<span class="hljs-params">self</span>):</span>        <span class="hljs-keyword">return</span> Bug()<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Wizard</span>(<span class="hljs-params"><span class="hljs-built_in">object</span></span>):</span>    <span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">    æ¸¸æˆè§’è‰²å¯¹è±¡-ç”·å·«</span><span class="hljs-string">    &quot;&quot;&quot;</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, name</span>):</span>        self.name = name    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__str__</span>(<span class="hljs-params">self</span>):</span>        <span class="hljs-keyword">return</span> self.name    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">interact_with</span>(<span class="hljs-params">self, obstacle</span>):</span>        print(<span class="hljs-string">&#x27;&#123;&#125; the Wizard battles against &#123;&#125; and &#123;&#125;!&#x27;</span>.<span class="hljs-built_in">format</span>(self, obstacle, obstacle.action()))<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Ork</span>(<span class="hljs-params"><span class="hljs-built_in">object</span></span>):</span>    <span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">    éšœç¢ç‰©å¯¹è±¡-æ€ªå…½</span><span class="hljs-string">    &quot;&quot;&quot;</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__str__</span>(<span class="hljs-params">self</span>):</span>        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;an evil ork&#x27;</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">action</span>(<span class="hljs-params">self</span>):</span>        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;kills it&#x27;</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">WizardWorld</span>(<span class="hljs-params"><span class="hljs-built_in">object</span></span>):</span>    <span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">    æŠ½è±¡å·¥å‚ï¼Œè´Ÿè´£åˆ›å»ºæ¸¸æˆè§’è‰²ä¸éšœç¢ç‰©å¯¹è±¡</span><span class="hljs-string">    make_character()å’Œmake_obstacle()åŠ¨æ€æ”¹å˜å½“å‰æ¿€æ´»çš„å·¥å‚</span><span class="hljs-string">    åœ¨é™æ€è¯­è¨€ä¸­ï¼ŒæŠ½è±¡å·¥å‚æ˜¯æŠ½è±¡ç±»/æ¥å£ï¼Œå…·æœ‰ä¸€äº›ç©ºæ–¹æ³•ï¼ŒPythonä¸­æ— é¡»å¦‚æ­¤</span><span class="hljs-string">    &quot;&quot;&quot;</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, name</span>):</span>        print(self)        self.player_name = name    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__str__</span>(<span class="hljs-params">self</span>):</span>        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;\n\n\t------- Wizard Word -------&#x27;</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">make_character</span>(<span class="hljs-params">self</span>):</span>        <span class="hljs-keyword">return</span> Wizard(self.player_name)    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">make_obstacle</span>(<span class="hljs-params">self</span>):</span>        <span class="hljs-keyword">return</span> Ork()<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">GameEnvironment</span>(<span class="hljs-params"><span class="hljs-built_in">object</span></span>):</span>    <span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">    æ¸¸æˆçš„ä¸»å…¥å£ï¼Œæ¥æ”¶factoryä¸ºè¾“å…¥</span><span class="hljs-string">    &quot;&quot;&quot;</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, factory</span>):</span>        self.hero = factory.make_character()        self.obstacle = factory.make_obstacle()    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">play</span>(<span class="hljs-params">self</span>):</span>        self.hero.interact_with(self.obstacle)<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">validate_age</span>(<span class="hljs-params">name</span>):</span>    <span class="hljs-keyword">try</span>:        age = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;Welcome &#123;&#125;. How old are you? &quot;</span>.<span class="hljs-built_in">format</span>(name))        age = <span class="hljs-built_in">int</span>(age)    <span class="hljs-keyword">except</span> ValueError <span class="hljs-keyword">as</span> e:        print(<span class="hljs-string">&quot;Age &#123;&#125; is invalid, please try again...&quot;</span>.<span class="hljs-built_in">format</span>(age))        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>, age    <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>, age<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span>():</span>    name = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;Hello. What&#x27;s your name?&quot;</span>)    valid_input = <span class="hljs-literal">False</span>    age = <span class="hljs-number">0</span>    <span class="hljs-keyword">while</span> <span class="hljs-keyword">not</span> valid_input:        valid_input, age = validate_age(name)    game = FrogWorld <span class="hljs-keyword">if</span> age &lt; <span class="hljs-number">18</span> <span class="hljs-keyword">else</span> WizardWorld    environment = GameEnvironment(game(name))    environment.play()<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:    main()</code></pre><h4 id="The-Builder-Pattern-æ„é€ æ¨¡å¼-æ§åˆ¶å¤æ‚å¯¹è±¡çš„æ„é€ "><a href="#The-Builder-Pattern-æ„é€ æ¨¡å¼-æ§åˆ¶å¤æ‚å¯¹è±¡çš„æ„é€ " class="headerlink" title="The Builder Pattern(æ„é€ æ¨¡å¼: æ§åˆ¶å¤æ‚å¯¹è±¡çš„æ„é€ )"></a>The Builder Pattern(æ„é€ æ¨¡å¼: æ§åˆ¶å¤æ‚å¯¹è±¡çš„æ„é€ )</h4><p>å½“å¯¹è±¡éœ€è¦å¤šä¸ªéƒ¨åˆ†ç»„åˆèµ·æ¥ä¸€æ­¥æ­¥åˆ›å»ºï¼Œå¹¶ä¸”åˆ›å»ºå’Œè¡¨ç¤ºåˆ†ç¦»çš„æ—¶å€™ã€‚å¯ä»¥è¿™ä¹ˆç†è§£ï¼Œä½ è¦ä¹°ç”µè„‘ï¼Œå·¥å‚æ¨¡å¼ç›´æ¥è¿”å›ä¸€ä¸ªä½ éœ€è¦å‹å·çš„ç”µè„‘ï¼Œä½†æ˜¯æ„é€ æ¨¡å¼å…è®¸ä½ è‡ªå®šä¹‰ç”µè„‘å„ç§é…ç½®ç±»å‹ï¼Œç»„è£…å®Œæˆåç»™ä½ ã€‚è¿™ä¸ªè¿‡ç¨‹å¯ä»¥ä¼ å…¥builderä»è€Œè‡ªå®šä¹‰åˆ›å»ºçš„æ–¹å¼ã€‚</p><pre><code class="hljs Python"><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">Module Description:å»ºé€ è€…è®¾è®¡æ¨¡å¼demo</span><span class="hljs-string">Problem:å½“éœ€è¦åˆ›å»ºä¸€ä¸ªç”±å¤šä¸ªéƒ¨åˆ†æ„æˆçš„å¯¹è±¡ï¼Œè€Œä¸”å®ƒçš„æ„é€ éœ€è¦ä¸€æ­¥æ¥ä¸€æ­¥çš„å®Œæˆï¼›åªæœ‰å½“å„ä¸ªéƒ¨åˆ†éƒ½åˆ›å»ºå¥½ï¼Œè¿™ä¸ªå¯¹è±¡æ‰ç®—å®Œæ•´</span><span class="hljs-string">Solutionï¼š</span><span class="hljs-string">Extension:å·¥å‚æ¨¡å¼ä¸åˆ›å»ºè€…çš„åŒºåˆ«ä¸ºï¼ˆ1ï¼‰å·¥å‚æ¨¡å¼ä¸€ä½†ä¸ªæ­¥éª¤åˆ›å»ºå¯¹è±¡ï¼›åˆ›å»ºè€…ä»¥å¤šä¸ªæ­¥éª¤åˆ›å»ºå¯¹è±¡ï¼Œå¹¶ä¸”å‡ ä¹å§‹ç»ˆä¼šä½¿ç”¨ä¸€ä¸ªæŒ‡æŒ¥è€…ã€‚</span><span class="hljs-string">                              ï¼ˆ2ï¼‰å·¥å‚æ¨¡å¼ä¸‹ä¼šç«‹å³è¿”å›ä¸€ä¸ªåˆ›å»ºå¥½çš„å¯¹è±¡ï¼Œå»ºé€ è€…ä»…åœ¨å®¢æˆ·ç«¯ä»£ç æ‰æ˜¾å¼è¯·æ±‚æŒ‡æŒ¥è€…è¿”å›çš„æœ€ç»ˆå¯¹è±¡</span><span class="hljs-string">                               ä¾‹å¦‚ï¼šå‡è®¾ä½ æƒ³ä¹°ä¸ªç”µè„‘ï¼Œå¦‚æœå†³å®šä¹°ä¸€å°ç‰¹å®šé…ç½®çš„ç”µè„‘ï¼Œåˆ™ä½¿ç”¨å·¥å‚æ¨¡å¼ï¼›å¦‚æœä½ è¦è´­ä¹°ä¸€å°å®šåˆ¶çš„PCï¼Œ</span><span class="hljs-string">                               ä½ å¼æŒ‡æŒ¥è€…ï¼Œä¼šå‘åˆ¶é€ å•†æä¾›æŒ‡ä»¤è¯´æ˜å¿ƒä¸­ç†æƒ³çš„ç”µè„‘è§„æ ¼ã€‚</span><span class="hljs-string">Date: 2020/1/8</span><span class="hljs-string">Author: Wang P</span><span class="hljs-string">&quot;&quot;&quot;</span>MINI14 = <span class="hljs-string">&#x27;1.4GHz Mac Mini&#x27;</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AppleFactory</span>:</span>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MacMini14</span>:</span>        <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self</span>):</span>            self.memory = <span class="hljs-number">4</span>            self.hdd = <span class="hljs-number">500</span>            self.gpu = <span class="hljs-string">&#x27;Intel HD Graphics 5000&#x27;</span>        <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__str__</span>(<span class="hljs-params">self</span>):</span>            info = (<span class="hljs-string">&#x27;Model: &#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(MINI14),                    <span class="hljs-string">&#x27;Memory: &#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(self.memory),                    <span class="hljs-string">&#x27;Hard Disk: &#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(self.hdd),                    <span class="hljs-string">&#x27;Graphics Card: &#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(self.gpu))            <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;\n&#x27;</span>.join(info)    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">build_computer</span>(<span class="hljs-params">self, model</span>):</span>        <span class="hljs-keyword">if</span> model == MINI14:            <span class="hljs-keyword">return</span> self.MacMini14()        <span class="hljs-keyword">else</span>:            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;I dont&#x27;t know how to build &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(model)<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">apple_computer_use_factory</span>():</span>    afac = AppleFactory()    mac_mini = afac.build_computer(MINI14)    print(mac_mini)<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Computer</span>:</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, serial_number</span>):</span>        self.serial_number = serial_number        self.memory = <span class="hljs-literal">None</span>        self.hdd = <span class="hljs-literal">None</span>        self.gpu = <span class="hljs-literal">None</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__str__</span>(<span class="hljs-params">self</span>):</span>        info = (<span class="hljs-string">&#x27;Serial: &#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(self.serial_number),                <span class="hljs-string">&#x27;Memory: &#123;&#125;GB&#x27;</span>.<span class="hljs-built_in">format</span>(self.memory),                <span class="hljs-string">&#x27;Hard Disk: &#123;&#125;GB&#x27;</span>.<span class="hljs-built_in">format</span>(self.hdd),                <span class="hljs-string">&#x27;Graphics Card: &#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(self.gpu))        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;\n&#x27;</span>.join(info)<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ComputerBuilder</span>:</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self</span>):</span>        self.computer = Computer(<span class="hljs-string">&#x27;AI563924&#x27;</span>)    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">conf_memory</span>(<span class="hljs-params">self, amount</span>):</span>        self.computer.memory = amount    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">conf_hdd</span>(<span class="hljs-params">self, amount</span>):</span>        self.computer.hdd = amount    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">conf_gpu</span>(<span class="hljs-params">self, model</span>):</span>        self.computer.gpu = model<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HardwareEngineer</span>:</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self</span>):</span>        self.builder = <span class="hljs-literal">None</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">construct_computer</span>(<span class="hljs-params">self, memory, hdd, gpu</span>):</span>        self.builder = ComputerBuilder()        self.builder.conf_memory(memory)        self.builder.conf_hdd(hdd)        self.builder.conf_gpu(gpu)<span class="hljs-meta">    @property</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">computer</span>(<span class="hljs-params">self</span>):</span>        <span class="hljs-keyword">return</span> self.builder.computer<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">apple_computer_use_builder</span>():</span>    engineer = HardwareEngineer()    engineer.construct_computer(memory=<span class="hljs-number">8</span>, hdd=<span class="hljs-number">500</span>, gpu=<span class="hljs-string">&#x27;GeForce GTX 650 Ti&#x27;</span>)    computer = engineer.computer    print(computer)<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:    apple_computer_use_builder()    print(<span class="hljs-string">&#x27;*&#x27;</span>*<span class="hljs-number">50</span>)    apple_computer_use_factory()</code></pre><h4 id="å•ä¾‹æ¨¡å¼-ä½¿å¾—ä¸€ä¸ªç±»æœ€å¤šç”Ÿæˆä¸€ä¸ªå®ä¾‹"><a href="#å•ä¾‹æ¨¡å¼-ä½¿å¾—ä¸€ä¸ªç±»æœ€å¤šç”Ÿæˆä¸€ä¸ªå®ä¾‹" class="headerlink" title="å•ä¾‹æ¨¡å¼: ä½¿å¾—ä¸€ä¸ªç±»æœ€å¤šç”Ÿæˆä¸€ä¸ªå®ä¾‹"></a>å•ä¾‹æ¨¡å¼: ä½¿å¾—ä¸€ä¸ªç±»æœ€å¤šç”Ÿæˆä¸€ä¸ªå®ä¾‹</h4><p>(åŸºäºå…ƒç±»)å•ä¾‹æ¨¡å¼</p><pre><code class="hljs Python"><span class="hljs-comment"># -*- coding:utf-8 -*-</span><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">Module Description:(åŸºäºå…ƒç±»)å•ä¾‹æ¨¡å¼</span><span class="hljs-string">Problem:</span><span class="hljs-string">Solution:</span><span class="hljs-string">Date: 2020/1/6 </span><span class="hljs-string">Author: Wang P</span><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Singleton</span>(<span class="hljs-params"><span class="hljs-built_in">type</span></span>):</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">cls, *args, **kwargs</span>):</span>        print(<span class="hljs-string">&quot;__init__ &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(cls.__name__))        cls.__instance = <span class="hljs-literal">None</span>        <span class="hljs-built_in">super</span>().__init__(*args, **kwargs)    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__call__</span>(<span class="hljs-params">cls, *args, **kwargs</span>):</span>        <span class="hljs-keyword">if</span> cls.__instance <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:            print(<span class="hljs-string">&quot;__call__ &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(cls.__name__))            cls.__instance = <span class="hljs-built_in">super</span>(Singleton, cls).__call__(*args, **kwargs)        <span class="hljs-keyword">return</span> cls.__instance<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Instance</span>(<span class="hljs-params">metaclass=Singleton</span>):</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, name</span>):</span>        self.name = name<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:    i1 = Instance(<span class="hljs-string">&#x27;zhang san&#x27;</span>)    i2 = Instance(<span class="hljs-string">&#x27;li si&#x27;</span>)    print(i1 <span class="hljs-keyword">is</span> i2)</code></pre><p>é€šè¿‡newå‡½æ•°å®ç°ç®€å•çš„å•ä¾‹æ¨¡å¼</p><pre><code class="hljs Python"><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">Module Description: é€šè¿‡newå‡½æ•°å®ç°ç®€å•çš„å•ä¾‹æ¨¡å¼</span><span class="hljs-string">Problem:</span><span class="hljs-string">Solutionï¼š</span><span class="hljs-string">Date: 2020/1/20 </span><span class="hljs-string">Author: Wang P</span><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Singleton</span>:</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__new__</span>(<span class="hljs-params">cls, name, *args, **kwargs</span>):</span>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-built_in">hasattr</span>(cls, <span class="hljs-string">&#x27;_instance&#x27;</span>):            cls._instance = <span class="hljs-built_in">super</span>().__new__(cls, *args, **kwargs)        print(<span class="hljs-string">&quot;__call__ &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(cls.__class__))        <span class="hljs-keyword">return</span> cls._instance    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, name</span>):</span>        print(<span class="hljs-string">&quot;__init__ &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(self.__str__()))        <span class="hljs-built_in">super</span>().__init__()        self.name = name<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:    ins1 = Singleton(<span class="hljs-string">&#x27;zhang san&#x27;</span>)    ins2 = Singleton(<span class="hljs-string">&#x27;li si&#x27;</span>)    print(<span class="hljs-built_in">id</span>(ins1), <span class="hljs-built_in">id</span>(ins2))    print(ins1.name)    print(ins2.name)</code></pre><p>è£…é¥°å™¨å®ç°</p><pre><code class="hljs Python"><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">Module Description: é€šè¿‡è£…é¥°å™¨æ–¹å¼å®ç°å•ä¾‹æ¨¡å¼</span><span class="hljs-string">Problem:</span><span class="hljs-string">Solutionï¼š</span><span class="hljs-string">Date: 2020/2/20 </span><span class="hljs-string">Author: Wang P</span><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-comment"># è£…é¥°å™¨å®ç°</span><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">singleton</span>(<span class="hljs-params">class_</span>):</span>    instances = &#123;&#125;    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getinstance</span>(<span class="hljs-params">*args, **kwargs</span>):</span>        <span class="hljs-keyword">if</span> class_ <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> instances:            instances[class_] = class_(*args, **kwargs)        <span class="hljs-keyword">return</span> instances[class_]    <span class="hljs-keyword">return</span> getinstance<span class="hljs-meta">@singleton</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyClass</span>:</span>    <span class="hljs-keyword">pass</span><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:    i1 = MyClass()    i2 = MyClass()    print(i1 <span class="hljs-keyword">is</span> i2)</code></pre><h4 id="The-Prototype-Pattern-åŸå‹æ¨¡å¼-è§£å†³å¯¹è±¡æ‹·è´é—®é¢˜"><a href="#The-Prototype-Pattern-åŸå‹æ¨¡å¼-è§£å†³å¯¹è±¡æ‹·è´é—®é¢˜" class="headerlink" title="The Prototype Pattern(åŸå‹æ¨¡å¼:è§£å†³å¯¹è±¡æ‹·è´é—®é¢˜)"></a>The Prototype Pattern(åŸå‹æ¨¡å¼:è§£å†³å¯¹è±¡æ‹·è´é—®é¢˜)</h4><h3 id="è¡Œä¸ºå‹"><a href="#è¡Œä¸ºå‹" class="headerlink" title="è¡Œä¸ºå‹"></a>è¡Œä¸ºå‹</h3><h4 id="The-Observer-Pattern-è§‚å¯Ÿè€…æ¨¡å¼ï¼šç”¨æ¥å¤„ç†å¤šä¸ªå¯¹è±¡ä¹‹é—´çš„å‘å¸ƒè®¢é˜…é—®é¢˜"><a href="#The-Observer-Pattern-è§‚å¯Ÿè€…æ¨¡å¼ï¼šç”¨æ¥å¤„ç†å¤šä¸ªå¯¹è±¡ä¹‹é—´çš„å‘å¸ƒè®¢é˜…é—®é¢˜" class="headerlink" title="The Observer Pattern(è§‚å¯Ÿè€…æ¨¡å¼ï¼šç”¨æ¥å¤„ç†å¤šä¸ªå¯¹è±¡ä¹‹é—´çš„å‘å¸ƒè®¢é˜…é—®é¢˜)"></a>The Observer Pattern(è§‚å¯Ÿè€…æ¨¡å¼ï¼šç”¨æ¥å¤„ç†å¤šä¸ªå¯¹è±¡ä¹‹é—´çš„å‘å¸ƒè®¢é˜…é—®é¢˜)</h4><pre><code class="hljs Python"><span class="hljs-comment"># -*- coding:utf-8 -*-</span><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">Module Description: </span><span class="hljs-string">Date: 2019/12/13 </span><span class="hljs-string">Author: Wang P</span><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">WaterHeater</span>(<span class="hljs-params"><span class="hljs-built_in">object</span></span>):</span>    <span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">    çƒ­æ°´å™¨ï¼šæˆ˜èƒœå¯’å†¬çš„æœ‰åˆ©æ­¦å™¨</span><span class="hljs-string">    &quot;&quot;&quot;</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self</span>):</span>        self.__observers = []        self.__temperature = <span class="hljs-number">25</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getTemperature</span>(<span class="hljs-params">self</span>):</span>        <span class="hljs-keyword">return</span> self.__temperature    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">setTemperature</span>(<span class="hljs-params">self, temperature</span>):</span>        self.__temperature = temperature        print(<span class="hljs-string">&quot;current temperature is:&quot;</span>, self.__temperature)        self.notifies()    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">addObserver</span>(<span class="hljs-params">self, observer</span>):</span>        self.__observers.append(observer)    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">notifies</span>(<span class="hljs-params">self</span>):</span>        <span class="hljs-keyword">for</span> o <span class="hljs-keyword">in</span> self.__observers:            o.update(self)<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Observer</span>(<span class="hljs-params"><span class="hljs-built_in">object</span></span>):</span>    <span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">    æ´—æ¾¡æ¨¡å¼å’Œé¥®ç”¨æ¨¡å¼çš„çˆ¶ç±»</span><span class="hljs-string">    &quot;&quot;&quot;</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">update</span>(<span class="hljs-params">self, waterHeater</span>):</span>        <span class="hljs-keyword">pass</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">WashingMode</span>(<span class="hljs-params">Observer</span>):</span>    <span class="hljs-string">&quot;&quot;&quot;è¯¥æ¨¡å¼ç”¨äºæ´—æ¾¡ç”¨&quot;&quot;&quot;</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">update</span>(<span class="hljs-params">self, waterHeater</span>):</span>        <span class="hljs-keyword">if</span> <span class="hljs-number">50</span> &lt;= waterHeater.getTemperature() &lt; <span class="hljs-number">70</span>:            print(<span class="hljs-string">&quot;æ°´å·²çƒ§å¥½ï¼Œæ¸©åº¦æ­£å¥½ï¼å¯ä»¥ç”¨æ¥æ´—æ¾¡äº†ã€‚&quot;</span>)<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DrinkingMode</span>(<span class="hljs-params">Observer</span>):</span>    <span class="hljs-string">&quot;&quot;&quot;è¯¥æ¨¡å¼ç”¨äºé¥®ç”¨&quot;&quot;&quot;</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">update</span>(<span class="hljs-params">self, waterHeater</span>):</span>        <span class="hljs-keyword">if</span> waterHeater.getTemperature() &gt;= <span class="hljs-number">100</span>:            print(<span class="hljs-string">&quot;æ°´å·²çƒ§å¼€ï¼å¯ä»¥ç”¨æ¥é¥®ç”¨äº†ã€‚&quot;</span>)<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">test_water_heater</span>():</span>    heater = WaterHeater()    washing_obser = WashingMode()    drinking_obser = DrinkingMode()    heater.addObserver(washing_obser)    heater.addObserver(drinking_obser)    heater.setTemperature(<span class="hljs-number">40</span>)    heater.setTemperature(<span class="hljs-number">60</span>)    heater.setTemperature(<span class="hljs-number">100</span>)<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:    test_water_heater()</code></pre><h4 id="The-State-Pattern-çŠ¶æ€æ¨¡å¼ï¼šå®ç°æœ‰é™çŠ¶æ€æœº"><a href="#The-State-Pattern-çŠ¶æ€æ¨¡å¼ï¼šå®ç°æœ‰é™çŠ¶æ€æœº" class="headerlink" title="The State Pattern(çŠ¶æ€æ¨¡å¼ï¼šå®ç°æœ‰é™çŠ¶æ€æœº)"></a>The State Pattern(çŠ¶æ€æ¨¡å¼ï¼šå®ç°æœ‰é™çŠ¶æ€æœº)</h4><h4 id="The-Strategy-Pattern-ç­–ç•¥æ¨¡å¼ï¼šåŠ¨æ€é€‰æ‹©ç®—æ³•ç­–ç•¥"><a href="#The-Strategy-Pattern-ç­–ç•¥æ¨¡å¼ï¼šåŠ¨æ€é€‰æ‹©ç®—æ³•ç­–ç•¥" class="headerlink" title="The Strategy Pattern(ç­–ç•¥æ¨¡å¼ï¼šåŠ¨æ€é€‰æ‹©ç®—æ³•ç­–ç•¥)"></a>The Strategy Pattern(ç­–ç•¥æ¨¡å¼ï¼šåŠ¨æ€é€‰æ‹©ç®—æ³•ç­–ç•¥)</h4><h4 id="The-Chain-of-Responsibility-Pattern-è´£ä»»é“¾æ¨¡å¼-åˆ›å»ºé“¾å¼å¯¹è±¡ç”¨æ¥æ¥æ”¶å¹¿æ’­æ¶ˆæ¯"><a href="#The-Chain-of-Responsibility-Pattern-è´£ä»»é“¾æ¨¡å¼-åˆ›å»ºé“¾å¼å¯¹è±¡ç”¨æ¥æ¥æ”¶å¹¿æ’­æ¶ˆæ¯" class="headerlink" title="The Chain of Responsibility Pattern (è´£ä»»é“¾æ¨¡å¼:åˆ›å»ºé“¾å¼å¯¹è±¡ç”¨æ¥æ¥æ”¶å¹¿æ’­æ¶ˆæ¯)"></a>The Chain of Responsibility Pattern (è´£ä»»é“¾æ¨¡å¼:åˆ›å»ºé“¾å¼å¯¹è±¡ç”¨æ¥æ¥æ”¶å¹¿æ’­æ¶ˆæ¯)</h4><h4 id="The-Command-Pattern-å‘½ä»¤æ¨¡å¼ï¼šç”¨æ¥ç»™åº”ç”¨æ·»åŠ Undoæ“ä½œ"><a href="#The-Command-Pattern-å‘½ä»¤æ¨¡å¼ï¼šç”¨æ¥ç»™åº”ç”¨æ·»åŠ Undoæ“ä½œ" class="headerlink" title="The Command Pattern(å‘½ä»¤æ¨¡å¼ï¼šç”¨æ¥ç»™åº”ç”¨æ·»åŠ Undoæ“ä½œ)"></a>The Command Pattern(å‘½ä»¤æ¨¡å¼ï¼šç”¨æ¥ç»™åº”ç”¨æ·»åŠ Undoæ“ä½œ)</h4><h4 id="The-Interpreter-Pattern-è§£é‡Šå™¨æ¨¡å¼ï¼šç”¨æ¥å®ç°Domain-Specific-Language-DSL"><a href="#The-Interpreter-Pattern-è§£é‡Šå™¨æ¨¡å¼ï¼šç”¨æ¥å®ç°Domain-Specific-Language-DSL" class="headerlink" title="The Interpreter Pattern(è§£é‡Šå™¨æ¨¡å¼ï¼šç”¨æ¥å®ç°Domain Specific Language(DSL))"></a>The Interpreter Pattern(è§£é‡Šå™¨æ¨¡å¼ï¼šç”¨æ¥å®ç°Domain Specific Language(DSL))</h4><h4 id="The-Template-Pattern-æ¨¡æ¿æ¨¡å¼ï¼šæŠ½è±¡å‡ºç®—æ³•å…¬å…±éƒ¨åˆ†ä»è€Œå®ç°ä»£ç å¤ç”¨"><a href="#The-Template-Pattern-æ¨¡æ¿æ¨¡å¼ï¼šæŠ½è±¡å‡ºç®—æ³•å…¬å…±éƒ¨åˆ†ä»è€Œå®ç°ä»£ç å¤ç”¨" class="headerlink" title="The Template Pattern(æ¨¡æ¿æ¨¡å¼ï¼šæŠ½è±¡å‡ºç®—æ³•å…¬å…±éƒ¨åˆ†ä»è€Œå®ç°ä»£ç å¤ç”¨)"></a>The Template Pattern(æ¨¡æ¿æ¨¡å¼ï¼šæŠ½è±¡å‡ºç®—æ³•å…¬å…±éƒ¨åˆ†ä»è€Œå®ç°ä»£ç å¤ç”¨)</h4><h3 id="ç»“æ„æ€§"><a href="#ç»“æ„æ€§" class="headerlink" title="ç»“æ„æ€§"></a>ç»“æ„æ€§</h3><h4 id="The-Adapter-Pattern-é€‚é…å™¨æ¨¡å¼-è§£å†³æ¥å£ä¸å…¼å®¹é—®é¢˜"><a href="#The-Adapter-Pattern-é€‚é…å™¨æ¨¡å¼-è§£å†³æ¥å£ä¸å…¼å®¹é—®é¢˜" class="headerlink" title="The Adapter Pattern(é€‚é…å™¨æ¨¡å¼: è§£å†³æ¥å£ä¸å…¼å®¹é—®é¢˜)"></a>The Adapter Pattern(é€‚é…å™¨æ¨¡å¼: è§£å†³æ¥å£ä¸å…¼å®¹é—®é¢˜)</h4><h4 id="The-Decorator-Pattern-è£…é¥°å™¨æ¨¡å¼ï¼š-æ— éœ€å­ç±»åŒ–å®ç°æ‰©å±•å¯¹è±¡åŠŸèƒ½é—®é¢˜"><a href="#The-Decorator-Pattern-è£…é¥°å™¨æ¨¡å¼ï¼š-æ— éœ€å­ç±»åŒ–å®ç°æ‰©å±•å¯¹è±¡åŠŸèƒ½é—®é¢˜" class="headerlink" title="The Decorator Pattern(è£…é¥°å™¨æ¨¡å¼ï¼š æ— éœ€å­ç±»åŒ–å®ç°æ‰©å±•å¯¹è±¡åŠŸèƒ½é—®é¢˜)"></a>The Decorator Pattern(è£…é¥°å™¨æ¨¡å¼ï¼š æ— éœ€å­ç±»åŒ–å®ç°æ‰©å±•å¯¹è±¡åŠŸèƒ½é—®é¢˜)</h4><h4 id="The-Facade-Pattern-å¤–è§‚æ¨¡å¼-ç®€åŒ–å¤æ‚å¯¹è±¡çš„è®¿é—®é—®é¢˜"><a href="#The-Facade-Pattern-å¤–è§‚æ¨¡å¼-ç®€åŒ–å¤æ‚å¯¹è±¡çš„è®¿é—®é—®é¢˜" class="headerlink" title="The Facade Pattern(å¤–è§‚æ¨¡å¼: ç®€åŒ–å¤æ‚å¯¹è±¡çš„è®¿é—®é—®é¢˜)"></a>The Facade Pattern(å¤–è§‚æ¨¡å¼: ç®€åŒ–å¤æ‚å¯¹è±¡çš„è®¿é—®é—®é¢˜)</h4><h4 id="The-Flyweight-Pattern-äº«å…ƒæ¨¡å¼-å®ç°å¯¹è±¡å¤ç”¨ä»è€Œæ”¹å–„èµ„æºä½¿ç”¨"><a href="#The-Flyweight-Pattern-äº«å…ƒæ¨¡å¼-å®ç°å¯¹è±¡å¤ç”¨ä»è€Œæ”¹å–„èµ„æºä½¿ç”¨" class="headerlink" title="The Flyweight Pattern(äº«å…ƒæ¨¡å¼: å®ç°å¯¹è±¡å¤ç”¨ä»è€Œæ”¹å–„èµ„æºä½¿ç”¨)"></a>The Flyweight Pattern(äº«å…ƒæ¨¡å¼: å®ç°å¯¹è±¡å¤ç”¨ä»è€Œæ”¹å–„èµ„æºä½¿ç”¨)</h4><h4 id="The-Model-View-Controller-Pattern-mvcæ¨¡å¼ï¼šè§£è€¦å±•ç¤ºé€»è¾‘å’Œä¸šåŠ¡é€»è¾‘"><a href="#The-Model-View-Controller-Pattern-mvcæ¨¡å¼ï¼šè§£è€¦å±•ç¤ºé€»è¾‘å’Œä¸šåŠ¡é€»è¾‘" class="headerlink" title="The Model-View-Controller Pattern(mvcæ¨¡å¼ï¼šè§£è€¦å±•ç¤ºé€»è¾‘å’Œä¸šåŠ¡é€»è¾‘)"></a>The Model-View-Controller Pattern(mvcæ¨¡å¼ï¼šè§£è€¦å±•ç¤ºé€»è¾‘å’Œä¸šåŠ¡é€»è¾‘)</h4><h4 id="The-Proxy-Pattern-ä»£ç†æ¨¡å¼ï¼šé€šè¿‡ä¸€å±‚é—´æ¥ä¿æŠ¤å±‚å®ç°æ›´å®‰å…¨çš„æ¥å£è®¿é—®ï¼‰"><a href="#The-Proxy-Pattern-ä»£ç†æ¨¡å¼ï¼šé€šè¿‡ä¸€å±‚é—´æ¥ä¿æŠ¤å±‚å®ç°æ›´å®‰å…¨çš„æ¥å£è®¿é—®ï¼‰" class="headerlink" title="The Proxy Pattern(ä»£ç†æ¨¡å¼ï¼šé€šè¿‡ä¸€å±‚é—´æ¥ä¿æŠ¤å±‚å®ç°æ›´å®‰å…¨çš„æ¥å£è®¿é—®ï¼‰"></a>The Proxy Pattern(ä»£ç†æ¨¡å¼ï¼šé€šè¿‡ä¸€å±‚é—´æ¥ä¿æŠ¤å±‚å®ç°æ›´å®‰å…¨çš„æ¥å£è®¿é—®ï¼‰</h4>]]></content>
    
    
    <categories>
      
      <category>è®¾è®¡æ¨¡å¼</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Python</tag>
      
      <tag>è®¾è®¡æ¨¡å¼</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€Pythonã€‘åŸºæœ¬æ•°æ®ç»“æ„å’Œç®—æ³•</title>
    <link href="/2020/11/20/adt-python/"/>
    <url>/2020/11/20/adt-python/</url>
    
    <content type="html"><![CDATA[<p>How to select datastructures for ADT</p><ol><li>Dose the data structure provide for the storage requirements as specified by the domain of the ADT?</li><li>Does the data structure provide the data access and manipulation functionality to fully implement the ADT?</li><li>Effcient implemention? based on complexity analysis.<a id="more"></a></li></ol><h3 id="Strings"><a href="#Strings" class="headerlink" title="Strings"></a>Strings</h3><pre><code class="hljs Python"><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">Module Description: å­—ç¬¦ä¸²ç›¸å…³</span><span class="hljs-string">Problem:</span><span class="hljs-string">Solutionï¼š</span><span class="hljs-string">Date: 2020/2/18 </span><span class="hljs-string">Author: Wang P</span><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ReverseString</span>:</span>    <span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">    å­—ç¬¦æ•°ç»„åè½¬</span><span class="hljs-string">    &quot;&quot;&quot;</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">reverse_string</span>(<span class="hljs-params">self, x, reverse=<span class="hljs-literal">False</span></span>):</span>        <span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">        :param x: å­—ç¬¦æ•°ç»„</span><span class="hljs-string">        :param reverse: æ˜¯å¦ä¹‹ç”¨å†…ç½®åº“</span><span class="hljs-string">        :return:</span><span class="hljs-string">        &quot;&quot;&quot;</span>        <span class="hljs-keyword">if</span> reverse:            x.reverse()            <span class="hljs-keyword">return</span> x        <span class="hljs-keyword">else</span>:            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> x:                <span class="hljs-keyword">return</span>            beg, end = <span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(x)<span class="hljs-number">-1</span>            <span class="hljs-keyword">while</span> beg &lt; end:                x[beg], x[end] = x[end], x[beg]                beg += <span class="hljs-number">1</span>                end -= <span class="hljs-number">1</span>            <span class="hljs-keyword">return</span> x<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Palindrome</span>:</span>    <span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">    åˆ¤æ–­å­—ç¬¦ä¸²æ˜¯å¦æ˜¯å›æ–‡</span><span class="hljs-string">    &quot;&quot;&quot;</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">is_palindrome</span>(<span class="hljs-params">self, x</span>):</span>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(x, <span class="hljs-built_in">int</span>) <span class="hljs-keyword">and</span> x &lt; <span class="hljs-number">0</span>:            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>        xx = <span class="hljs-built_in">str</span>(x)        beg, end = <span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(xx)<span class="hljs-number">-1</span>        <span class="hljs-keyword">while</span> beg &lt; end:            <span class="hljs-keyword">if</span> xx[beg] == xx[end]:                beg += <span class="hljs-number">1</span>                end -= <span class="hljs-number">1</span>            <span class="hljs-keyword">else</span>:                <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:    r = ReverseString()    print(r.reverse_string([<span class="hljs-string">&#x27;d&#x27;</span>, <span class="hljs-string">&#x27;h&#x27;</span>, <span class="hljs-string">&#x27;s&#x27;</span>, <span class="hljs-string">&#x27;j&#x27;</span>, <span class="hljs-string">&#x27;f&#x27;</span>], <span class="hljs-literal">False</span>))</code></pre><p><a href="https://github.com/weitrue/note/blob/master/python/algorithm/data_structure/strings.py">https://github.com/weitrue/note/blob/master/python/algorithm/data_structure/strings.py</a></p><h3 id="Array-and-List"><a href="#Array-and-List" class="headerlink" title="Array and List"></a>Array and List</h3><h4 id="array"><a href="#array" class="headerlink" title="array"></a>array</h4><p>å®šé•¿ï¼Œæ“ä½œæœ‰é™ï¼Œä½†æ˜¯èŠ‚çœå†…å­˜ï¼›è²Œä¼¼æˆ‘çš„ç”Ÿæ¶¯ä¸­è¿˜æ²¡ç”¨è¿‡ï¼Œä¸è¿‡python3.5ä¸­æˆ‘è¯•äº†ç¡®å®æœ‰arrayç±»ï¼Œå¯ä»¥ç”¨import arrayç›´æ¥å¯¼å…¥ã€‚</p><h4 id="list"><a href="#list" class="headerlink" title="list"></a>list</h4><p>ä¼šé¢„å…ˆåˆ†é…å†…å­˜ï¼Œæ“ä½œä¸°å¯Œï¼Œä½†æ˜¯è€—è´¹å†…å­˜ã€‚ç”¨sys.getsizeofåšå®éªŒå¯ä»¥å‘ç°è¯¥ç»“æ„éå¸¸ç±»ä¼¼C++ STLé‡Œçš„vectorï¼Œæ˜¯ä½¿ç”¨æœ€é¢‘ç¹çš„æ•°æ®ç»“æ„ã€‚</p><ul><li>list.append: å¦‚æœä¹‹å‰æ²¡æœ‰åˆ†é…å¤Ÿå†…å­˜ï¼Œä¼šé‡æ–°å¼€è¾Ÿæ–°åŒºåŸŸï¼Œç„¶åå¤åˆ¶ä¹‹å‰çš„æ•°æ®ï¼Œå¤æ‚åº¦é€€åŒ–</li><li>list.insert: ä¼šç§»åŠ¨è¢«æ’å…¥åŒºåŸŸåæ‰€æœ‰å…ƒç´ ,O(n)</li><li>list.pop: popä¸åŒä½ç½®éœ€è¦çš„å¤æ‚åº¦ä¸åŒpop(0)æ˜¯O(1)å¤æ‚åº¦,pop()é¦–ä½O(n)å¤æ‚åº¦</li><li>list[]: sliceæ“ä½œcopyæ•°æ®ï¼ˆé¢„ç•™ç©ºé—´ï¼‰åˆ°å¦ä¸€ä¸ªlist</li></ul><p><a href="https://github.com/weitrue/note/blob/master/python/algorithm/data_structure/array_and_list.py">https://github.com/weitrue/note/blob/master/python/algorithm/data_structure/array_and_list.py</a></p><h3 id="Sets-and-Maps"><a href="#Sets-and-Maps" class="headerlink" title="Sets and Maps"></a>Sets and Maps</h3><h4 id="sets-ADT"><a href="#sets-ADT" class="headerlink" title="sets ADT"></a>sets ADT</h4><p>A set is a container that stores a collection of unique values over a given comparable domain in which the stored values have no particular ordering.</p><h4 id="Maps-or-Dict-ADT"><a href="#Maps-or-Dict-ADT" class="headerlink" title="Maps or Dict ADT"></a>Maps or Dict ADT</h4><p>pythonå†…éƒ¨é‡‡ç”¨hashå®ç°ã€‚</p><pre><code class="hljs Python"><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">Module Description: åŸºäºcollections.OrderedDictå®ç°LRU_cache(æœ€è¿‘æœ€å°‘ä½¿ç”¨ç¼“å­˜ç®—æ³•)</span><span class="hljs-string">Problem:</span><span class="hljs-string">Solutionï¼š</span><span class="hljs-string">Date: 2020/2/13 </span><span class="hljs-string">Author: Wang P</span><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-keyword">from</span> collections <span class="hljs-keyword">import</span> OrderedDict<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LURCache</span>:</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, capacity=<span class="hljs-number">128</span></span>):</span>        self._od = OrderedDict()        self._capacity = capacity    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get</span>(<span class="hljs-params">self, key</span>):</span>        <span class="hljs-keyword">if</span> key <span class="hljs-keyword">in</span> self._od:            val = self._od[key]            self._od.move_to_end(key)            <span class="hljs-keyword">return</span> val        <span class="hljs-keyword">else</span>:            <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">push</span>(<span class="hljs-params">self, key, value</span>):</span>        <span class="hljs-keyword">if</span> key <span class="hljs-keyword">in</span> self._od:            <span class="hljs-keyword">del</span> self._od[key]            self._od[key] = value        <span class="hljs-keyword">else</span>:  <span class="hljs-comment"># insert</span>            self._od[key] = value            <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(self._od) &gt; self._capacity:                self._od.popitem(last=<span class="hljs-literal">False</span>)    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">items</span>(<span class="hljs-params">self</span>):</span>        <span class="hljs-keyword">return</span> self._od.items()<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:    lru_cache = LURCache(<span class="hljs-number">3</span>)    lru_cache.push(<span class="hljs-string">&quot;1&quot;</span>, <span class="hljs-number">1</span>)    lru_cache.push(<span class="hljs-string">&quot;2&quot;</span>, <span class="hljs-number">2</span>)    lru_cache.push(<span class="hljs-string">&quot;3&quot;</span>, <span class="hljs-number">3</span>)    lru_cache.push(<span class="hljs-string">&quot;4&quot;</span>, <span class="hljs-number">4</span>)    lru_cache.get(<span class="hljs-string">&quot;2&quot;</span>)    print(lru_cache.items())</code></pre><p><a href="https://github.com/weitrue/note/blob/master/python/algorithm/collections_examples/lru_cache.py">https://github.com/weitrue/note/blob/master/python/algorithm/collections_examples/lru_cache.py</a></p><h3 id="Algorithm-Analysis"><a href="#Algorithm-Analysis" class="headerlink" title="Algorithm Analysis"></a>Algorithm Analysis</h3><p>ä¸€èˆ¬ä½¿ç”¨å¤§Oæ ‡è®°æ³•æ¥è¡¡é‡ç®—æ³•çš„å¹³å‡æ—¶é—´å¤æ‚åº¦, 1 &lt; log(n) &lt; n &lt; nlog(n) &lt; n^2 &lt; n^3 &lt; a^nã€‚ äº†è§£å¸¸ç”¨æ•°æ®ç»“æ„æ“ä½œçš„å¹³å‡æ—¶é—´å¤æ‚åº¦æœ‰åˆ©äºä½¿ç”¨æ›´é«˜æ•ˆçš„æ•°æ®ç»“æ„ï¼Œå½“ç„¶æœ‰æ—¶å€™éœ€è¦åœ¨æ—¶é—´å’Œç©ºé—´ä¸Šè¿›è¡Œè¡¡é‡ï¼Œæœ‰äº›æ“ä½œç”šè‡³è¿˜ä¼šé€€åŒ–ï¼Œæ¯”å¦‚listçš„appendæ“ä½œï¼Œå¦‚æœlistç©ºé—´ä¸å¤Ÿï¼Œä¼šå»å¼€è¾Ÿæ–°çš„ç©ºé—´ï¼Œæ“ä½œå¤æ‚åº¦é€€åŒ–åˆ°O(n)ï¼Œæœ‰æ—¶å€™è¿˜éœ€è¦ä½¿ç”¨å‡æ‘Šåˆ†æ(amortized)ã€‚</p><h3 id="Searching"><a href="#Searching" class="headerlink" title="Searching"></a>Searching</h3><p>pythonå†…ç½®äº†inæ“ä½œç¬¦å’ŒbisectäºŒåˆ†æ“ä½œæ¨¡å—å®ç°æŸ¥æ‰¾ã€‚</p><pre><code class="hljs python"><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">Module Description: äºŒåˆ†æŸ¥æ‰¾ç®—æ³•</span><span class="hljs-string">Problem:</span><span class="hljs-string">Solutionï¼š</span><span class="hljs-string">Date: 2020/1/20 </span><span class="hljs-string">Author: Wang P</span><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">binary_search</span>(<span class="hljs-params">arr, target</span>):</span>    n = <span class="hljs-built_in">len</span>(arr)    left = <span class="hljs-number">0</span>    right = n - <span class="hljs-number">1</span>    <span class="hljs-keyword">while</span> left &lt;= right:        mid = (left + right) // <span class="hljs-number">2</span>        <span class="hljs-keyword">if</span> arr[mid] &lt; target:            left = mid + <span class="hljs-number">1</span>        <span class="hljs-keyword">elif</span> arr[mid] &gt; target:            right = mid - <span class="hljs-number">1</span>        <span class="hljs-keyword">else</span>:            print(<span class="hljs-string">f&quot;index: <span class="hljs-subst">&#123;mid&#125;</span>, value:<span class="hljs-subst">&#123;arr[mid]&#125;</span>&quot;</span>)            <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>    <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:    l = [<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span>]    binary_search(l, <span class="hljs-number">8</span>)</code></pre><p><a href="https://github.com/weitrue/note/blob/master/python/algorithm/search/binary_search.py">https://github.com/weitrue/note/blob/master/python/algorithm/search/binary_search.py</a></p><h3 id="Sorting"><a href="#Sorting" class="headerlink" title="Sorting"></a>Sorting</h3><p>pythonå†…ç½®äº†sortedæ–¹æ³•æ¥å®ç°æ’åºæ“ä½œã€‚</p><pre><code class="hljs Python"><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">Module Description: å†’æ³¡æ’åº</span><span class="hljs-string">Problem:</span><span class="hljs-string">Solutionï¼š</span><span class="hljs-string">Date: 2020/3/23 </span><span class="hljs-string">Author: Wang P</span><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-keyword">import</span> random<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BubbleSort</span>:</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">bubble_sort</span>(<span class="hljs-params">self, arr</span>):</span>        <span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">        å†’æ³¡æ’åº</span><span class="hljs-string">        :param arr:</span><span class="hljs-string">        :return:</span><span class="hljs-string">        &quot;&quot;&quot;</span>        n = <span class="hljs-built_in">len</span>(arr)        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):            <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n-i<span class="hljs-number">-1</span>):                <span class="hljs-keyword">if</span> arr[j] &gt; arr[j+<span class="hljs-number">1</span>]:                    arr[j], arr[j+<span class="hljs-number">1</span>] = arr[j+<span class="hljs-number">1</span>], arr[j]<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:    list_a = [random.randint(<span class="hljs-number">0</span>, <span class="hljs-number">8</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>)]    print(list_a)    bs = BubbleSort()    bs.bubble_sort(list_a)    print(list_a)</code></pre><pre><code class="hljs Python"><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">Module Description: å½’å¹¶æ’åºç®—æ³•-åˆ†æ²»æ³•</span><span class="hljs-string">Problem:</span><span class="hljs-string">Solutionï¼š</span><span class="hljs-string">Date: 2020/2/15 </span><span class="hljs-string">Author: Wang P</span><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MergeSort</span>:</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">merge_sort</span>(<span class="hljs-params">self, arr</span>):</span>        <span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">        åˆ†æ²»æ³•åˆ†ä¸‰æ­¥èµ°ï¼Œè¦æ³¨æ„å‡ºå£</span><span class="hljs-string">        :param arr:</span><span class="hljs-string">        :return:</span><span class="hljs-string">        &quot;&quot;&quot;</span>        <span class="hljs-comment"># é€’å½’å‡ºå£</span>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(arr) &lt;= <span class="hljs-number">1</span>:            <span class="hljs-keyword">return</span> arr        <span class="hljs-keyword">else</span>:            mid = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">len</span>(arr)/<span class="hljs-number">2</span>)            left_half = self.merge_sort(arr[:mid])            right_half = self.merge_sort(arr[mid:])            <span class="hljs-keyword">return</span> self.merge_sorted_list(left_half, right_half)    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">merge_sorted_list</span>(<span class="hljs-params">self, list_a, list_b</span>):</span>        <span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">        åˆå¹¶ä¸¤ä¸ªæœ‰åºåºåˆ—</span><span class="hljs-string">        :param list_a:</span><span class="hljs-string">        :param list_b:</span><span class="hljs-string">        :return:</span><span class="hljs-string">        &quot;&quot;&quot;</span>        length_a = <span class="hljs-built_in">len</span>(list_a)        length_b = <span class="hljs-built_in">len</span>(list_b)        a = b = <span class="hljs-number">0</span>        new_list = []        <span class="hljs-keyword">while</span> a &lt; length_a <span class="hljs-keyword">and</span> b &lt; length_b:            <span class="hljs-keyword">if</span> list_a[a] &lt; list_b[b]:                new_list.append(list_a[a])                a += <span class="hljs-number">1</span>            <span class="hljs-keyword">else</span>:                new_list.append(list_b[b])                b += <span class="hljs-number">1</span>        <span class="hljs-keyword">if</span> a &lt; length_a:            new_list.extend(list_a[a:])        <span class="hljs-keyword">if</span> b &lt; length_b:            new_list.extend(list_b[b:])        <span class="hljs-keyword">return</span> new_list<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:    <span class="hljs-keyword">import</span> random    ms = MergeSort()    ll = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>))    random.shuffle(ll)    print(ll)    ll = ms.merge_sort(ll)    print(ll)</code></pre><pre><code class="hljs Python"><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">Module Description: å¿«é€Ÿæ’åºç®—æ³•-åˆ†æ²»æ³•</span><span class="hljs-string">Problem:</span><span class="hljs-string">Solutionï¼šPartition:é€‰æ‹©åŸºå‡†åˆ†å‰²æ•°ç»„ä¸ºä¸¤ä¸ªå­—æ•°ç»„ï¼Œå°äºåŸºå‡†å’Œå¤§äºåŸºå‡†</span><span class="hljs-string">         å¯¹ä¸¤ä¸ªå­—æ•°ç»„åˆ†åˆ«å¿«æ’</span><span class="hljs-string">         åˆå¹¶ç»“æœ</span><span class="hljs-string">Date: 2020/2/15 </span><span class="hljs-string">Author: Wang P</span><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-keyword">import</span> random<span class="hljs-keyword">import</span> pysnooper  <span class="hljs-comment"># è°ƒè¯•ç¥å™¨</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">QuickSort</span>:</span><span class="hljs-meta">    @pysnooper.snoop()</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">quick_sort</span>(<span class="hljs-params">self, arr</span>):</span>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(arr) &lt; <span class="hljs-number">2</span>:            <span class="hljs-keyword">return</span> arr        pivot_index = <span class="hljs-number">0</span>  <span class="hljs-comment"># ç¬¬ä¸€ä¸ªæ•°ä½œä¸ºpivot</span>        pivot = arr[pivot_index]        less_part = [i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> arr[pivot_index+<span class="hljs-number">1</span>:] <span class="hljs-keyword">if</span> i &lt; pivot]        great_part = [i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> arr[pivot_index+<span class="hljs-number">1</span>:] <span class="hljs-keyword">if</span> i &gt;= pivot]        <span class="hljs-keyword">return</span> self.quick_sort(less_part) + [pivot] + self.quick_sort(great_part)<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:    qs = QuickSort()    ll = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>))    random.shuffle(ll)    print(ll)    ll = qs.quick_sort(ll)    print(ll)</code></pre><pre><code class="hljs Python"><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">Module Description: æ‹“æ‰‘æ’åº</span><span class="hljs-string">Problem: å¯¹åº”äºè¯¥å›¾çš„æ‹“æ‰‘æ’åº,æ¯ä¸€ä¸ªæœ‰å‘æ— ç¯å›¾éƒ½è‡³å°‘å­˜åœ¨ä¸€ç§æ‹“æ‰‘æ’åº</span><span class="hljs-string">Solutionï¼š</span><span class="hljs-string">Date: 2020/3/23 </span><span class="hljs-string">Author: Wang P</span><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-keyword">import</span> pysnooper<span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> Mapping<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TopologicalSort</span>:</span><span class="hljs-meta">    @pysnooper.snoop()  # pysnooper è°ƒè¯•ç¥å™¨</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">topological_sort</span>(<span class="hljs-params">self, graph: Mapping</span>):</span>        <span class="hljs-comment"># in_degrees = &#123;&#x27;a&#x27;ï¼š 0, &#x27;b&#x27;ï¼š 0, &#x27;c&#x27;ï¼š 0, &#x27;d&#x27;ï¼š 0, &#x27;e&#x27;ï¼š 0, &#x27;f&#x27;ï¼š 0&#125;</span>        in_degrees = <span class="hljs-built_in">dict</span>((u, <span class="hljs-number">0</span>) <span class="hljs-keyword">for</span> u <span class="hljs-keyword">in</span> graph)        <span class="hljs-keyword">for</span> u <span class="hljs-keyword">in</span> graph:            <span class="hljs-keyword">for</span> v <span class="hljs-keyword">in</span> graph[u]:  <span class="hljs-comment"># æ ¹æ®é”®æ‰¾å‡ºå€¼ä¹Ÿå°±æ˜¯ä¸‹çº§èŠ‚ç‚¹</span>                in_degrees[v] += <span class="hljs-number">1</span>  <span class="hljs-comment"># å¯¹è·å–åˆ°çš„ä¸‹çº§èŠ‚ç‚¹çš„å…¥åº¦åŠ  1</span>        <span class="hljs-comment"># å¾ªç¯ç»“æŸä¹‹åçš„ç»“æœï¼š &#123;&#x27;a&#x27;ï¼š 0, &#x27;b&#x27;ï¼š 1, &#x27;c&#x27;ï¼š 1, &#x27;d&#x27;ï¼š 2, &#x27;e&#x27;ï¼š 1, &#x27;f&#x27;ï¼š 4&#125;</span>        Q = [u <span class="hljs-keyword">for</span> u <span class="hljs-keyword">in</span> graph <span class="hljs-keyword">if</span> in_degrees[u] == <span class="hljs-number">0</span>]  <span class="hljs-comment"># å…¥åº¦ä¸º 0 çš„èŠ‚ç‚¹</span>        in_degrees_zero = []        <span class="hljs-keyword">while</span> Q:            u = Q.pop()  <span class="hljs-comment"># é»˜è®¤ä»æœ€åä¸€ä¸ªç§»é™¤</span>            in_degrees_zero.append(u)  <span class="hljs-comment"># å­˜å‚¨å…¥åº¦ä¸º 0 çš„èŠ‚ç‚¹</span>            <span class="hljs-keyword">for</span> v <span class="hljs-keyword">in</span> graph[u]:                in_degrees[v] -= <span class="hljs-number">1</span>  <span class="hljs-comment"># åˆ é™¤å…¥åº¦ä¸º 0 çš„èŠ‚ç‚¹ï¼Œä»¥åŠç§»é™¤å…¶æŒ‡å‘</span>                <span class="hljs-keyword">if</span> in_degrees[v] == <span class="hljs-number">0</span>:                    Q.append(v)        <span class="hljs-keyword">return</span> in_degrees_zero<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:    <span class="hljs-comment"># ç”¨å­—å…¸çš„é”®å€¼è¡¨ç¤ºå›¾çš„èŠ‚ç‚¹ä¹‹é—´çš„å…³ç³»ï¼Œé”®å½“å‰èŠ‚ç‚¹ã€‚å€¼æ˜¯åç»­èŠ‚ç‚¹ã€‚</span>    graph_dict = &#123;        <span class="hljs-string">&#x27;a&#x27;</span>: <span class="hljs-string">&#x27;bf&#x27;</span>,  <span class="hljs-comment"># è¡¨ç¤º a æŒ‡å‘ b å’Œ f</span>        <span class="hljs-string">&#x27;b&#x27;</span>: <span class="hljs-string">&#x27;cdf&#x27;</span>,        <span class="hljs-string">&#x27;c&#x27;</span>: <span class="hljs-string">&#x27;d&#x27;</span>,        <span class="hljs-string">&#x27;d&#x27;</span>: <span class="hljs-string">&#x27;ef&#x27;</span>,        <span class="hljs-string">&#x27;e&#x27;</span>: <span class="hljs-string">&#x27;f&#x27;</span>,        <span class="hljs-string">&#x27;f&#x27;</span>: <span class="hljs-string">&#x27;&#x27;</span>    &#125;    ts = TopologicalSort()    t = ts.topological_sort(graph_dict)    print(t)</code></pre><p><a href="https://github.com/weitrue/note/tree/master/python/algorithm/sort">https://github.com/weitrue/note/tree/master/python/algorithm/sort</a></p><h3 id="Linked-Structure"><a href="#Linked-Structure" class="headerlink" title="Linked Structure"></a>Linked Structure</h3><p>listæ˜¯æœ€å¸¸ç”¨çš„æ•°æ®ç»“æ„ï¼Œä½†æ˜¯liståœ¨ä¸­é—´å¢å‡å…ƒç´ çš„æ—¶å€™æ•ˆç‡ä¼šå¾ˆä½ï¼Œè¿™æ—¶å€™linked listä¼šæ›´é€‚åˆï¼Œç¼ºç‚¹å°±æ˜¯è·å–å…ƒç´ çš„å¹³å‡æ—¶é—´å¤æ‚åº¦å˜æˆäº†O(n)ã€‚</p><pre><code class="hljs Python"><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">Module Description: é“¾è¡¨ </span><span class="hljs-string">Problem:</span><span class="hljs-string">Solutionï¼š</span><span class="hljs-string">Date: 2020/2/16 </span><span class="hljs-string">Author: Wang P</span><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ListNode</span>:</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, val</span>):</span>        self.val = val        self.<span class="hljs-built_in">next</span> = <span class="hljs-literal">None</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DeleteNode</span>:</span>    <span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">    é“¾è¡¨ä¸­åˆ é™¤ä¸€ä¸ªèŠ‚ç‚¹ï¼ˆå·²çŸ¥è¦åˆ é™¤çš„èŠ‚ç‚¹ï¼Œä¸çŸ¥é“¾è¡¨çš„headï¼‰</span><span class="hljs-string">    æ€è·¯ï¼šå°†è¦åˆ é™¤çš„é“¾è¡¨èŠ‚ç‚¹nodeçš„å€¼ä¿®æ”¹ä¸ºnode.nextçš„å€¼</span><span class="hljs-string">         node.nextæŒ‡å‘node.next.next</span><span class="hljs-string">         è¿™æ ·ç›¸å½“äºåˆ é™¤äº†nodeèŠ‚ç‚¹</span><span class="hljs-string">    &quot;&quot;&quot;</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, node_list=<span class="hljs-literal">None</span>, node=<span class="hljs-literal">None</span></span>):</span>        <span class="hljs-keyword">if</span> node_list <span class="hljs-keyword">and</span> <span class="hljs-built_in">isinstance</span>(node_list, <span class="hljs-built_in">list</span>):            self._head = ListNode(node_list[<span class="hljs-number">0</span>])            cur_index = self._head            <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-built_in">len</span>(node_list)):                <span class="hljs-keyword">if</span> cur_index.val == node:                    self._node = cur_index                cur_index.<span class="hljs-built_in">next</span> = ListNode(node_list[i])                cur_index = cur_index.<span class="hljs-built_in">next</span>        <span class="hljs-keyword">else</span>:            self._head = <span class="hljs-literal">None</span>            self._node = <span class="hljs-literal">None</span><span class="hljs-meta">    @staticmethod</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">delete_node_in_a_linked_list</span>(<span class="hljs-params">node</span>):</span>        next_node = node.<span class="hljs-built_in">next</span>        next_next_node = node.<span class="hljs-built_in">next</span>.<span class="hljs-built_in">next</span>        node.val = next_node.val        node.<span class="hljs-built_in">next</span> = next_next_node    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">traversal</span>(<span class="hljs-params">self</span>):</span>        cur = self._head        link_list = []        <span class="hljs-keyword">while</span> cur:            link_list.append(cur.val)            cur = cur.<span class="hljs-built_in">next</span>        print(link_list)<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MergeLinkedList</span>:</span>    <span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">    åˆå¹¶ä¸¤ä¸ªæœ‰åºé“¾è¡¨</span><span class="hljs-string">    æ€è·¯ï¼šæ–°å»ºä¸€ä¸ªé“¾è¡¨rootï¼Œå°†list_one, list_twoéå†ï¼ŒæŒ‰å¤§å°æ”¾å…¥root</span><span class="hljs-string">    &quot;&quot;&quot;</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, list_one=<span class="hljs-literal">None</span>, list_two=<span class="hljs-literal">None</span></span>):</span>        <span class="hljs-keyword">if</span> list_one <span class="hljs-keyword">and</span> <span class="hljs-built_in">isinstance</span>(list_one, <span class="hljs-built_in">list</span>) <span class="hljs-keyword">and</span> list_two <span class="hljs-keyword">and</span> <span class="hljs-built_in">isinstance</span>(list_two, <span class="hljs-built_in">list</span>):            self.list_one = ListNode(list_one[<span class="hljs-number">0</span>])            cur_index = self.list_one            <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-built_in">len</span>(list_one)):                cur_index.<span class="hljs-built_in">next</span> = ListNode(list_one[i])                cur_index = cur_index.<span class="hljs-built_in">next</span>            self.list_two = ListNode(list_two[<span class="hljs-number">0</span>])            cur_index = self.list_two            <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-built_in">len</span>(list_two)):                cur_index.<span class="hljs-built_in">next</span> = ListNode(list_two[i])                cur_index = cur_index.<span class="hljs-built_in">next</span>        <span class="hljs-keyword">else</span>:            self.list_one = <span class="hljs-literal">None</span>            self.list_two = <span class="hljs-literal">None</span>        self._head = <span class="hljs-literal">None</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">merge_linked_list</span>(<span class="hljs-params">self</span>):</span>        one_cur_val = self.list_one        two_cur_val = self.list_two        self._head = ListNode(<span class="hljs-literal">None</span>)        cur = self._head        <span class="hljs-keyword">while</span> one_cur_val <span class="hljs-keyword">and</span> two_cur_val:            <span class="hljs-keyword">if</span> one_cur_val.val &lt; two_cur_val.val:                node = ListNode(one_cur_val.val)                one_cur_val = one_cur_val.<span class="hljs-built_in">next</span>            <span class="hljs-keyword">else</span>:                node = ListNode(two_cur_val.val)                two_cur_val = two_cur_val.<span class="hljs-built_in">next</span>            cur.<span class="hljs-built_in">next</span> = node            cur = node        cur.<span class="hljs-built_in">next</span> = one_cur_val <span class="hljs-keyword">or</span> two_cur_val    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">traversal</span>(<span class="hljs-params">self</span>):</span>        cur = self._head.<span class="hljs-built_in">next</span>        link_list = []        <span class="hljs-keyword">while</span> cur:            link_list.append(cur.val)            cur = cur.<span class="hljs-built_in">next</span>        print(link_list)<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ReverseLinkList</span>:</span>    <span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">    å•é“¾è¡¨åè½¬</span><span class="hljs-string">    &quot;&quot;&quot;</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, head=<span class="hljs-literal">None</span></span>):</span>        <span class="hljs-string">&quot;&quot;&quot;é“¾è¡¨çš„å¤´éƒ¨&quot;&quot;&quot;</span>        self._head = head    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">add</span>(<span class="hljs-params">self, val: <span class="hljs-built_in">int</span></span>):</span>        <span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">        ç»™é“¾è¡¨æ·»åŠ å…ƒç´ </span><span class="hljs-string">        ï¼šparam valï¼š ä¼ è¿‡æ¥çš„æ•°å­—</span><span class="hljs-string">        ï¼šreturnï¼š</span><span class="hljs-string">        &quot;&quot;&quot;</span>        <span class="hljs-comment"># åˆ›å»ºä¸€ä¸ªèŠ‚ç‚¹</span>        node = ListNode(val)        <span class="hljs-keyword">if</span> self._head <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:            self._head = node        <span class="hljs-keyword">else</span>:            cur = self._head            <span class="hljs-keyword">while</span> cur.<span class="hljs-built_in">next</span> <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:                cur = cur.<span class="hljs-built_in">next</span>  <span class="hljs-comment"># ç§»åŠ¨æ¸¸æ ‡</span>            cur.<span class="hljs-built_in">next</span> = node  <span class="hljs-comment"># å¦‚æœ next åé¢æ²¡äº†è¯æ˜ä»¥åŠåˆ°æœ€åä¸€ä¸ªèŠ‚ç‚¹äº†</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">traversal</span>(<span class="hljs-params">self</span>):</span>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> self._head:            <span class="hljs-keyword">return</span>        cur = self._head        link_list = []        <span class="hljs-keyword">while</span> cur:            link_list.append(cur.val)            cur = cur.<span class="hljs-built_in">next</span>        print(link_list)    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">size</span>(<span class="hljs-params">self</span>):</span>        <span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">        è·å–é“¾è¡¨çš„å¤§å°</span><span class="hljs-string">        ï¼šreturnï¼š</span><span class="hljs-string">        &quot;&quot;&quot;</span>        count = <span class="hljs-number">0</span>        <span class="hljs-keyword">if</span> self._head <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:            <span class="hljs-keyword">return</span> count        <span class="hljs-keyword">else</span>:            cur = self._head            <span class="hljs-keyword">while</span> cur <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:                count += <span class="hljs-number">1</span>                cur = cur.<span class="hljs-built_in">next</span>            <span class="hljs-keyword">return</span> count    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">reverse_link</span>(<span class="hljs-params">self</span>):</span>        <span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">        å•é“¾è¡¨åè½¬</span><span class="hljs-string">        æ€è·¯ï¼š</span><span class="hljs-string">        è®© cur.next å…ˆæ–­å¼€å³æŒ‡å‘ noneï¼ŒæŒ‡å‘è®¾å®š pre æ¸¸æ ‡æŒ‡å‘æ–­å¼€çš„å…ƒç´ ï¼Œç„¶å</span><span class="hljs-string">        cur.next æŒ‡å‘æ–­å¼€çš„å…ƒç´ ï¼Œå†æŠŠå¼€å§‹ self._head å†æœ€åä¸€ä¸ªå…ƒç´ çš„æ—¶å€™.</span><span class="hljs-string">        ï¼šreturnï¼š</span><span class="hljs-string">        &quot;&quot;&quot;</span>        <span class="hljs-keyword">if</span> self._head <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span> <span class="hljs-keyword">or</span> self.size() == <span class="hljs-number">1</span>:            <span class="hljs-keyword">return</span>        <span class="hljs-keyword">else</span>:            pre = <span class="hljs-literal">None</span>            cur = self._head            <span class="hljs-keyword">while</span> cur <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:                post = cur.<span class="hljs-built_in">next</span>                cur.<span class="hljs-built_in">next</span> = pre                pre = cur                cur = post            self._head = pre  <span class="hljs-comment"># é€†å‘åçš„å¤´èŠ‚ç‚¹</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LinkListIntersectionNode</span>:</span><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">ä¸¤ä¸ªé“¾è¡¨çš„çš„äº¤å‰èŠ‚ç‚¹</span><span class="hljs-string">&quot;&quot;&quot;</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_intersection_node</span>(<span class="hljs-params">self, headA, headB</span>):</span>        <span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">        cur1ã€cur2ï¼Œ2 ä¸ªæŒ‡é’ˆçš„åˆå§‹ä½ç½®æ˜¯é“¾è¡¨ headAã€headB å¤´ç»“ç‚¹ï¼Œcur1ã€cur2 ä¸¤ä¸ªæŒ‡é’ˆä¸€ç›´å¾€åéå†ã€‚</span><span class="hljs-string">        ç›´åˆ° cur1 æŒ‡é’ˆèµ°åˆ°é“¾è¡¨çš„æœ«å°¾ï¼Œç„¶å cur1 æŒ‡å‘ headBï¼›</span><span class="hljs-string">        ç›´åˆ° cur2 æŒ‡é’ˆèµ°åˆ°é“¾è¡¨çš„æœ«å°¾ï¼Œç„¶å cur2 æŒ‡å‘ headAï¼›</span><span class="hljs-string">        ç„¶åå†ç»§ç»­éå†ï¼›</span><span class="hljs-string">        æ¯æ¬¡ cur1ã€cur2 æŒ‡å‘ Noneï¼Œåˆ™å°† cur1ã€cur2 åˆ†åˆ«æŒ‡å‘ headBã€headAã€‚</span><span class="hljs-string">        å¾ªç¯çš„æ¬¡æ•°è¶Šå¤šï¼Œcur1ã€cur2 çš„è·ç¦»è¶Šæ¥è¿‘ï¼Œç›´åˆ° cur1 ç­‰äº cur2ã€‚åˆ™æ˜¯ä¸¤ä¸ªé“¾è¡¨çš„ç›¸äº¤ç‚¹ã€‚</span><span class="hljs-string">        ï¼štye head1, head1ï¼š ListNode</span><span class="hljs-string">        ï¼šrtyeï¼š ListNode</span><span class="hljs-string">        &quot;&quot;&quot;</span>        <span class="hljs-keyword">if</span> headA <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span> <span class="hljs-keyword">and</span> headB <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:            cur1, cur2 = headA, headB            <span class="hljs-keyword">while</span> cur1 != cur2:                cur1 = cur1.<span class="hljs-built_in">next</span> <span class="hljs-keyword">if</span> cur1 <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span> <span class="hljs-keyword">else</span> headA                cur2 = cur2.<span class="hljs-built_in">next</span> <span class="hljs-keyword">if</span> cur2 <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span> <span class="hljs-keyword">else</span> headB            <span class="hljs-keyword">return</span> cur1<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:    dn = DeleteNode([<span class="hljs-number">5</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">9</span>], <span class="hljs-number">3</span>)    dn.traversal()    dn.delete_node_in_a_linked_list(dn._node)    dn.traversal()    mn = MergeLinkedList([<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">4</span>, <span class="hljs-number">7</span>])    mn.merge_linked_list()    mn.traversal()    r_link = ReverseLinkList()    r_link.add(<span class="hljs-number">3</span>)    r_link.add(<span class="hljs-number">5</span>)    r_link.add(<span class="hljs-number">6</span>)    r_link.add(<span class="hljs-number">7</span>)    r_link.add(<span class="hljs-number">8</span>)    print(<span class="hljs-string">&quot;å¯¹é“¾è¡¨è¿›è¡Œéå†&quot;</span>)    r_link.traversal()    print(<span class="hljs-string">f&quot;sizeï¼š<span class="hljs-subst">&#123;r_link.size()&#125;</span>&quot;</span>)    print(<span class="hljs-string">&quot;å¯¹é“¾è¡¨è¿›è¡Œé€†å‘æ“ä½œä¹‹å&quot;</span>)    r_link.reverse_link()    r_link.traversal()</code></pre><p><a href="https://github.com/weitrue/note/blob/master/python/algorithm/data_structure/link_list_cases.py">https://github.com/weitrue/note/blob/master/python/algorithm/data_structure/link_list_cases.py</a></p><h3 id="Advanced-Linked-Lists"><a href="#Advanced-Linked-Lists" class="headerlink" title="Advanced Linked Lists"></a>Advanced Linked Lists</h3><h4 id="Doubly-Linked-List"><a href="#Doubly-Linked-List" class="headerlink" title="Doubly Linked List"></a>Doubly Linked List</h4><p>åŒé“¾è¡¨ï¼Œæ¯ä¸ªèŠ‚ç‚¹å¤šäº†ä¸ªprevæŒ‡å‘å‰ä¸€ä¸ªèŠ‚ç‚¹ã€‚åŒé“¾è¡¨å¯ä»¥ç”¨æ¥ç¼–å†™æ–‡æœ¬ç¼–è¾‘å™¨çš„bufferã€‚</p><h4 id="å¾ªç¯é“¾è¡¨"><a href="#å¾ªç¯é“¾è¡¨" class="headerlink" title="å¾ªç¯é“¾è¡¨"></a>å¾ªç¯é“¾è¡¨</h4><p>åˆ©ç”¨å¾ªç¯åŒç«¯é“¾è¡¨æˆ‘ä»¬å¯ä»¥å®ç°ä¸€ä¸ªç»å…¸çš„ç¼“å­˜å¤±æ•ˆç®—æ³•ï¼Œlruï¼š</p><pre><code class="hljs Python"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Node</span>(<span class="hljs-params"><span class="hljs-built_in">object</span></span>):</span>      <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, prev=<span class="hljs-literal">None</span>, <span class="hljs-built_in">next</span>=<span class="hljs-literal">None</span>, key=<span class="hljs-literal">None</span>, value=<span class="hljs-literal">None</span></span>):</span>        self.prev, self.<span class="hljs-built_in">next</span>, self.key, self.value = prev, <span class="hljs-built_in">next</span>, key, value               <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CircularDoubleLinkedList</span>(<span class="hljs-params"><span class="hljs-built_in">object</span></span>):</span>      <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self</span>):</span>        node = Node()        node.prev, node.<span class="hljs-built_in">next</span> = node, node        self.rootnode = node            <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">headnode</span>(<span class="hljs-params">self</span>):</span>        <span class="hljs-keyword">return</span> self.rootnode.<span class="hljs-built_in">next</span>          <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">tailnode</span>(<span class="hljs-params">self</span>):</span>        <span class="hljs-keyword">return</span> self.rootnode.prev          <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">remove</span>(<span class="hljs-params">self, node</span>):</span>        <span class="hljs-keyword">if</span> node <span class="hljs-keyword">is</span> self.rootnode:            <span class="hljs-keyword">return</span>        <span class="hljs-keyword">else</span>:            node.prev.<span class="hljs-built_in">next</span> = node.<span class="hljs-built_in">next</span>            node.<span class="hljs-built_in">next</span>.prev = node.prev                <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">append</span>(<span class="hljs-params">self, node</span>):</span>        tailnode = self.tailnode()        tailnode.<span class="hljs-built_in">next</span> = node        node.<span class="hljs-built_in">next</span> = self.rootnode        self.rootnode.prev = node                <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LRUCache</span>(<span class="hljs-params"><span class="hljs-built_in">object</span></span>):</span>      <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, maxsize=<span class="hljs-number">16</span></span>):</span>        self.maxsize = maxsize        self.cache = &#123;&#125;        self.access = CircularDoubleLinkedList()        self.isfull = <span class="hljs-built_in">len</span>(self.cache) &gt;= self.maxsize            <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__call__</span>(<span class="hljs-params">self, func</span>):</span>        <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">wrapper</span>(<span class="hljs-params">n</span>):</span>            cachenode = self.cache.get(n)            <span class="hljs-keyword">if</span> cachenode <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:  <span class="hljs-comment"># hit</span>                self.access.remove(cachenode)                self.access.append(cachenode)                <span class="hljs-keyword">return</span> cachenode.value            <span class="hljs-keyword">else</span>:  <span class="hljs-comment"># miss</span>                value = func(n)                <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> self.isfull:                    tailnode = self.access.tailnode()                    newnode = Node(tailnode, self.access.rootnode, n, value)                    self.access.append(newnode)                    self.cache[n] = newnode                    self.isfull = <span class="hljs-built_in">len</span>(self.cache) &gt;= self.maxsize                    <span class="hljs-keyword">return</span> value                <span class="hljs-keyword">else</span>:  <span class="hljs-comment"># full</span>                    lru_node = self.access.headnode()                    <span class="hljs-keyword">del</span> self.cache[lru_node.key]                    self.access.remove(lru_node)                    tailnode = self.access.tailnode()                    newnode = Node(tailnode, self.access.rootnode, n, value)                    self.access.append(newnode)                    self.cache[n] = newnode                <span class="hljs-keyword">return</span> value        <span class="hljs-keyword">return</span> wrapper            <span class="hljs-meta">@LRUCache()</span><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">fib</span>(<span class="hljs-params">n</span>):</span>    <span class="hljs-keyword">if</span> n &lt;= <span class="hljs-number">2</span>:        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>    <span class="hljs-keyword">else</span>:        <span class="hljs-keyword">return</span> fib(n - <span class="hljs-number">1</span>) + fib(n - <span class="hljs-number">2</span>)            <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">10</span>):    print(fib(i))        <span class="hljs-comment"># è¾“å‡º</span><span class="hljs-number">1</span><span class="hljs-number">1</span><span class="hljs-number">2</span><span class="hljs-number">3</span><span class="hljs-number">5</span><span class="hljs-number">8</span><span class="hljs-number">13</span><span class="hljs-number">21</span><span class="hljs-number">34</span></code></pre><h3 id="Stacks"><a href="#Stacks" class="headerlink" title="Stacks"></a>Stacks</h3><p>æ ˆï¼Œä¸€ç§åè¿›å…ˆå‡ºçš„æ•°æ®ç»“æ„ã€‚</p><pre><code class="hljs Python"><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">Module Description: åŸºé˜Ÿåˆ—å®ç°æ ˆ</span><span class="hljs-string">Problem:</span><span class="hljs-string">Solutionï¼šåŸºäºcollections.dequeå®ç°æ ˆ</span><span class="hljs-string">          åŸºäº 2 ä¸ªé˜Ÿåˆ—å®ç°</span><span class="hljs-string">          åŸºäº 1 ä¸ªé˜Ÿåˆ—å®ç°</span><span class="hljs-string">Date: 2020/2/15 </span><span class="hljs-string">Author: Wang P</span><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-keyword">from</span> collections <span class="hljs-keyword">import</span> deque<span class="hljs-keyword">from</span> queue <span class="hljs-keyword">import</span> Queue<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Stack</span>:</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self</span>):</span>        self.items = deque()    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">push</span>(<span class="hljs-params">self, val</span>):</span>        self.items.append(val)    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">top</span>(<span class="hljs-params">self</span>):</span>        <span class="hljs-keyword">return</span> self.items[<span class="hljs-number">-1</span>]    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">pop</span>(<span class="hljs-params">self</span>):</span>        <span class="hljs-keyword">return</span> self.items.pop()    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">empty</span>(<span class="hljs-params">self</span>):</span>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">len</span>(self.items) == <span class="hljs-number">0</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyStack</span>:</span>    <span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">    ä½¿ç”¨ 2 ä¸ªé˜Ÿåˆ—å®ç°</span><span class="hljs-string">    &quot;&quot;&quot;</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self</span>):</span>        <span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">        åˆå§‹åŒ–</span><span class="hljs-string">        &quot;&quot;&quot;</span>        <span class="hljs-comment"># q1 ä½œä¸ºè¿›æ ˆå‡ºæ ˆï¼Œq2 ä½œä¸ºä¸­è½¬ç«™</span>        self.q1 = Queue()        self.q2 = Queue()    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">push</span>(<span class="hljs-params">self, x</span>):</span>        <span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">        å…¥æ ˆ</span><span class="hljs-string">        ï¼štype xï¼š int</span><span class="hljs-string">        ï¼šrtypeï¼š void</span><span class="hljs-string">        &quot;&quot;&quot;</span>        self.q1.put(x)    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">pop</span>(<span class="hljs-params">self</span>):</span>        <span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">        å‡ºæ ˆ</span><span class="hljs-string">        ï¼šrtypeï¼š int</span><span class="hljs-string">        &quot;&quot;&quot;</span>        <span class="hljs-keyword">while</span> self.q1.qsize() &gt; <span class="hljs-number">1</span>:            self.q2.put(self.q1.get())  <span class="hljs-comment"># å°† q1 ä¸­é™¤å°¾å…ƒç´ å¤–çš„æ‰€æœ‰å…ƒç´ è½¬åˆ° q2 ä¸­</span>        <span class="hljs-keyword">if</span> self.q1.qsize() == <span class="hljs-number">1</span>:            res = self.q1.get()  <span class="hljs-comment"># å¼¹å‡º q1 çš„æœ€åä¸€ä¸ªå…ƒç´ </span>            self.q1, self.q2 = self.q2, self.q1  <span class="hljs-comment"># äº¤æ¢ q1,q2</span>            <span class="hljs-keyword">return</span> res    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">top</span>(<span class="hljs-params">self</span>):</span>        <span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">        æ ˆé¡¶</span><span class="hljs-string">        ï¼šrtypeï¼š int</span><span class="hljs-string">        &quot;&quot;&quot;</span>        <span class="hljs-keyword">while</span> self.q1.qsize() &gt; <span class="hljs-number">1</span>:            self.q2.put(self.q1.get())  <span class="hljs-comment"># å°† q1 ä¸­é™¤å°¾å…ƒç´ å¤–çš„æ‰€æœ‰å…ƒç´ è½¬åˆ° q2 ä¸­</span>        <span class="hljs-keyword">if</span> self.q1.qsize() == <span class="hljs-number">1</span>:            res = self.q1.get()  <span class="hljs-comment"># å¼¹å‡º q1 çš„æœ€åä¸€ä¸ªå…ƒç´ </span>            self.q2.put(res)  <span class="hljs-comment"># ä¸ pop å”¯ä¸€ä¸åŒçš„æ˜¯éœ€è¦å°† q1 æœ€åä¸€ä¸ªå…ƒç´ ä¿å­˜åˆ° q2 ä¸­</span>            self.q1, self.q2 = self.q2, self.q1  <span class="hljs-comment"># äº¤æ¢ q1,q2</span>            <span class="hljs-keyword">return</span> res    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">empty</span>(<span class="hljs-params">self</span>):</span>        <span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">        åˆ¤æ–­æ˜¯å¦ä¸ºç©º</span><span class="hljs-string">        ï¼šrtypeï¼š bool</span><span class="hljs-string">        &quot;&quot;&quot;</span>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">not</span> <span class="hljs-built_in">bool</span>(self.q1.qsize() + self.q2.qsize())  <span class="hljs-comment"># ä¸ºç©ºè¿”å› Trueï¼Œä¸ä¸ºç©ºè¿”å› False</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyStack2</span>(<span class="hljs-params"><span class="hljs-built_in">object</span></span>):</span>    <span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">    ä½¿ç”¨ 1 ä¸ªé˜Ÿåˆ—å®ç°</span><span class="hljs-string">    &quot;&quot;&quot;</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self</span>):</span>        <span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">        åˆå§‹åŒ–</span><span class="hljs-string">        &quot;&quot;&quot;</span>        self.sq1 = Queue()    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">push</span>(<span class="hljs-params">self, x</span>):</span>        <span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">        å…¥æ ˆ</span><span class="hljs-string">        ï¼štype xï¼š int</span><span class="hljs-string">        ï¼šrtypeï¼š void</span><span class="hljs-string">        &quot;&quot;&quot;</span>        self.sq1.put(x)    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">pop</span>(<span class="hljs-params">self</span>):</span>        <span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">        å‡ºæ ˆ</span><span class="hljs-string">        ï¼šrtypeï¼š int</span><span class="hljs-string">        &quot;&quot;&quot;</span>        count = self.sq1.qsize()        <span class="hljs-keyword">if</span> count == <span class="hljs-number">0</span>:            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>        <span class="hljs-keyword">while</span> count &gt; <span class="hljs-number">1</span>:            x = self.sq1.get()            self.sq1.put(x)            count -= <span class="hljs-number">1</span>        <span class="hljs-keyword">return</span> self.sq1.get()    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">top</span>(<span class="hljs-params">self</span>):</span>        <span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">        Get the top element.</span><span class="hljs-string">        ï¼šrtypeï¼š int</span><span class="hljs-string">        &quot;&quot;&quot;</span>        count = self.sq1.qsize()        <span class="hljs-keyword">if</span> count == <span class="hljs-number">0</span>:            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>        <span class="hljs-keyword">while</span> count:            x = self.sq1.get()            self.sq1.put(x)            count -= <span class="hljs-number">1</span>        <span class="hljs-keyword">return</span> x    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">empty</span>(<span class="hljs-params">self</span>):</span>        <span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">        Returns whether the stack is empty.</span><span class="hljs-string">        ï¼šrtypeï¼š bool</span><span class="hljs-string">        &quot;&quot;&quot;</span>        <span class="hljs-keyword">return</span> self.sq1.empty()<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:    obj = MyStack2()    obj.push(<span class="hljs-number">1</span>)    obj.push(<span class="hljs-number">3</span>)    print(obj.pop())    obj.push(<span class="hljs-number">4</span>)    print(obj.pop())    print(obj.pop())    print(obj.empty())</code></pre><p><a href="https://github.com/weitrue/note/blob/master/python/algorithm/data_structure/stack_cases.py">https://github.com/weitrue/note/blob/master/python/algorithm/data_structure/stack_cases.py</a></p><h3 id="Queues"><a href="#Queues" class="headerlink" title="Queues"></a>Queues</h3><p>é˜Ÿåˆ—ä¹Ÿæ˜¯ç»å¸¸ä½¿ç”¨çš„æ•°æ®ç»“æ„ï¼Œæ¯”å¦‚å‘é€æ¶ˆæ¯ç­‰ï¼Œceleryå¯ä»¥ä½¿ç”¨redisæä¾›çš„listå®ç°æ¶ˆæ¯é˜Ÿåˆ—ã€‚</p><pre><code class="hljs Python"><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">Module Description: åŸºäºcollections.dequeå®ç°é˜Ÿåˆ—</span><span class="hljs-string">                    åŸºäºæ ˆå®ç°é˜Ÿåˆ—</span><span class="hljs-string">Problem:</span><span class="hljs-string">Solutionï¼š</span><span class="hljs-string">Date: 2020/2/15 </span><span class="hljs-string">Author: Wang P</span><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-keyword">from</span> collections <span class="hljs-keyword">import</span> deque<span class="hljs-keyword">from</span> examples.example_0x_cases.algorithm.data_structure.stack_cases <span class="hljs-keyword">import</span> Stack<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Queue</span>:</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self</span>):</span>        self.items = deque()    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">push</span>(<span class="hljs-params">self, val</span>):</span>        self.items.append(val)    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">pop</span>(<span class="hljs-params">self</span>):</span>        <span class="hljs-keyword">return</span> self.items.popleft()    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">empty</span>(<span class="hljs-params">self</span>):</span>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">len</span>(self.items) == <span class="hljs-number">0</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">QueueByStack</span>:</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self</span>):</span>        self.stack_one = Stack()        self.stack_two = Stack()    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">push</span>(<span class="hljs-params">self, val</span>):</span>        self.stack_one.push(val)    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">pop</span>(<span class="hljs-params">self</span>):</span>        <span class="hljs-keyword">if</span> self.stack_two.empty():            <span class="hljs-keyword">if</span> self.stack_one.empty():                <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;nil&#x27;</span>            <span class="hljs-keyword">while</span> <span class="hljs-keyword">not</span> self.stack_one.empty():                self.stack_two.push(self.stack_one.pop())        <span class="hljs-keyword">return</span> self.stack_two.pop()    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">peek</span>(<span class="hljs-params">self</span>):</span>        <span class="hljs-keyword">if</span> self.stack_two.empty():            <span class="hljs-keyword">if</span> self.stack_one.empty():                <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;nil&#x27;</span>            <span class="hljs-keyword">while</span> <span class="hljs-keyword">not</span> self.stack_one.empty():                self.stack_two.push(self.stack_one.pop())        <span class="hljs-keyword">return</span> self.stack_two.top()    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">empty</span>(<span class="hljs-params">self</span>):</span>        <span class="hljs-keyword">return</span> self.stack_two<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:    qu = QueueByStack()    qu.push(<span class="hljs-number">1</span>)    qu.push(<span class="hljs-number">2</span>)    qu.push(<span class="hljs-number">3</span>)    print(qu.pop())    print(qu.peek())    print(qu.pop())    print(qu.pop())    print(qu.pop())</code></pre><p><a href="https://github.com/weitrue/note/blob/master/python/algorithm/data_structure/queue_cases.py">https://github.com/weitrue/note/blob/master/python/algorithm/data_structure/queue_cases.py</a></p><h2 id="Binary-Tree"><a href="#Binary-Tree" class="headerlink" title="Binary Tree"></a>Binary Tree</h2><p>äºŒå‰æ ‘ï¼Œæ¯ä¸ªèŠ‚ç‚¹åšå¤šåªæœ‰ä¸¤ä¸ªå­èŠ‚ç‚¹</p><pre><code class="hljs Python"><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">Module Description: äºŒå‰æ ‘çš„éå†ï¼šå‰åºã€ä¸­åºã€ååºã€å±‚æ¬¡éå†</span><span class="hljs-string">                    äºŒå‰æ ‘çš„åè½¬</span><span class="hljs-string">Problem:</span><span class="hljs-string">Solutionï¼š</span><span class="hljs-string">Date: 2020/2/16 </span><span class="hljs-string">Author: Wang P</span><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TreeNode</span>:</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, val, left, right</span>):</span>        self.val, self.left, self.right = val, left, right<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BinTreeTravel</span>:</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, node_list=<span class="hljs-literal">None</span></span>):</span>        <span class="hljs-keyword">if</span> node_list <span class="hljs-keyword">and</span> <span class="hljs-built_in">isinstance</span>(node_list, <span class="hljs-built_in">list</span>):            tree_node_list = []            <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(node_list)):                tree_node_list.append(TreeNode(node_list[i], <span class="hljs-literal">None</span>, <span class="hljs-literal">None</span>))            <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(node_list)):                <span class="hljs-keyword">if</span> i * <span class="hljs-number">2</span> + <span class="hljs-number">1</span> &lt;= <span class="hljs-built_in">len</span>(tree_node_list) - <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> i * <span class="hljs-number">2</span> + <span class="hljs-number">2</span> &lt;= <span class="hljs-built_in">len</span>(tree_node_list) - <span class="hljs-number">1</span>:                    tree_node_list[i].left = tree_node_list[i * <span class="hljs-number">2</span> + <span class="hljs-number">1</span>]                    tree_node_list[i].right = tree_node_list[i * <span class="hljs-number">2</span> + <span class="hljs-number">2</span>]                <span class="hljs-keyword">elif</span> i * <span class="hljs-number">2</span> + <span class="hljs-number">1</span> &lt;= <span class="hljs-built_in">len</span>(tree_node_list) - <span class="hljs-number">1</span> &lt; i * <span class="hljs-number">2</span> + <span class="hljs-number">2</span>:                    tree_node_list[i].left = tree_node_list[i * <span class="hljs-number">2</span> + <span class="hljs-number">1</span>]                <span class="hljs-keyword">else</span>:                    <span class="hljs-keyword">break</span>            self.root = tree_node_list[<span class="hljs-number">0</span>]    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">pre_order_travel</span>(<span class="hljs-params">self, sub_tree</span>):</span>        <span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">        å…ˆåºéå†</span><span class="hljs-string">        :param sub_tree:</span><span class="hljs-string">        :return:</span><span class="hljs-string">        &quot;&quot;&quot;</span>        <span class="hljs-keyword">if</span> sub_tree:            print(sub_tree.val)            self.pre_order_travel(sub_tree.left)            self.pre_order_travel(sub_tree.right)    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">in_order_travel</span>(<span class="hljs-params">self, sub_tree</span>):</span>        <span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">        ä¸­åºéå†</span><span class="hljs-string">        :param sub_tree:</span><span class="hljs-string">        :return:</span><span class="hljs-string">        &quot;&quot;&quot;</span>        <span class="hljs-keyword">if</span> sub_tree:            self.in_order_travel(sub_tree.left)            print(sub_tree.val)            self.in_order_travel(sub_tree.right)    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">post_order_travel</span>(<span class="hljs-params">self, sub_tree</span>):</span>        <span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">        ååºéå†</span><span class="hljs-string">        :param sub_tree:</span><span class="hljs-string">        :return:</span><span class="hljs-string">        &quot;&quot;&quot;</span>        <span class="hljs-keyword">if</span> sub_tree:            self.post_order_travel(sub_tree.left)            self.post_order_travel(sub_tree.right)            print(sub_tree.val)    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">level_order_travel</span>(<span class="hljs-params">self, root</span>):</span>        <span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">        å±‚æ¬¡éå†</span><span class="hljs-string">        :param root:</span><span class="hljs-string">        :return: list[list[int]]</span><span class="hljs-string">        &quot;&quot;&quot;</span>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> root:            print([])            <span class="hljs-keyword">return</span>        cur_nodes = [root]        next_nodes = []        print([i.val <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> cur_nodes])        <span class="hljs-keyword">while</span> cur_nodes <span class="hljs-keyword">or</span> next_nodes:            <span class="hljs-keyword">for</span> node <span class="hljs-keyword">in</span> cur_nodes:                <span class="hljs-keyword">if</span> node.left:                    next_nodes.append(node.left)                <span class="hljs-keyword">if</span> node.right:                    next_nodes.append(node.right)            <span class="hljs-keyword">if</span> next_nodes:                print([i.val <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> next_nodes])            cur_nodes = next_nodes            next_nodes = []<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ReverseBinaryTree</span>:</span>    <span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">    åè½¬äºŒå‰æ ‘</span><span class="hljs-string">               1                         1</span><span class="hljs-string">            3     4                   4     3</span><span class="hljs-string">         5   7  8   9      =&gt;       9  8  7   5</span><span class="hljs-string">      10                                        10</span><span class="hljs-string">    &quot;&quot;&quot;</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, node_list=<span class="hljs-literal">None</span></span>):</span>        <span class="hljs-keyword">if</span> node_list <span class="hljs-keyword">and</span> <span class="hljs-built_in">isinstance</span>(node_list, <span class="hljs-built_in">list</span>):            tree_node_list = []            <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(node_list)):                tree_node_list.append(TreeNode(node_list[i], <span class="hljs-literal">None</span>, <span class="hljs-literal">None</span>))            <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(node_list)):                <span class="hljs-keyword">if</span> i * <span class="hljs-number">2</span> + <span class="hljs-number">1</span> &lt;= <span class="hljs-built_in">len</span>(tree_node_list) - <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> i * <span class="hljs-number">2</span> + <span class="hljs-number">2</span> &lt;= <span class="hljs-built_in">len</span>(tree_node_list) - <span class="hljs-number">1</span>:                    tree_node_list[i].left = tree_node_list[i * <span class="hljs-number">2</span> + <span class="hljs-number">1</span>]                    tree_node_list[i].right = tree_node_list[i * <span class="hljs-number">2</span> + <span class="hljs-number">2</span>]                <span class="hljs-keyword">elif</span> i * <span class="hljs-number">2</span> + <span class="hljs-number">1</span> &lt;= <span class="hljs-built_in">len</span>(tree_node_list) - <span class="hljs-number">1</span> &lt; i * <span class="hljs-number">2</span> + <span class="hljs-number">2</span>:                    tree_node_list[i].left = tree_node_list[i * <span class="hljs-number">2</span> + <span class="hljs-number">1</span>]                <span class="hljs-keyword">else</span>:                    <span class="hljs-keyword">break</span>            self.root = tree_node_list[<span class="hljs-number">0</span>]    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">reverse_tree</span>(<span class="hljs-params">self, root</span>):</span>        <span class="hljs-keyword">if</span> root <span class="hljs-keyword">and</span> root.left <span class="hljs-keyword">and</span> root.right:            root.left, root.right = root.right, root.left            self.reverse_tree(root.left)            self.reverse_tree(root.right)        self.root = root<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FindTreeKthSmallest</span>:</span>    <span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">    äºŒå‰æœç´¢æ ‘ä¸­ç¬¬ K å°çš„å…ƒç´ </span><span class="hljs-string">    äºŒå‰æœç´¢æ ‘æŒ‰ç…§ä¸­åºéå†çš„é¡ºåºæ‰“å°å‡ºæ¥æ­£å¥½å°±æ˜¯æ’åºå¥½çš„é¡ºåºã€‚æ‰€ä»¥å¯¹å…¶éå†ä¸€ä¸ªèŠ‚ç‚¹å°±è¿›è¡Œè®¡æ•°ï¼Œè®¡æ•°è¾¾åˆ° k çš„æ—¶å€™å°±ç»“æŸã€‚</span><span class="hljs-string">    &quot;&quot;&quot;</span>    count = <span class="hljs-number">0</span>    node_val = <span class="hljs-number">0</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">kth_smallest</span>(<span class="hljs-params">self, root: TreeNode, k</span>):</span>        <span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">        ï¼štype rootï¼š TreeNode</span><span class="hljs-string">        ï¼štype kï¼š int</span><span class="hljs-string">        ï¼šrtypeï¼š int</span><span class="hljs-string">        &quot;&quot;&quot;</span>        self.dfs(root, k)        <span class="hljs-keyword">return</span> self.node_val    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">dfs</span>(<span class="hljs-params">self, node: TreeNode, k</span>):</span>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> node:            <span class="hljs-keyword">return</span>        self.dfs(node.left, k)        self.count = self.count + <span class="hljs-number">1</span>        <span class="hljs-keyword">if</span> self.count == k:            self.node_val = node.val            <span class="hljs-comment"># å°†è¯¥èŠ‚ç‚¹çš„å·¦å³å­æ ‘ç½®ä¸º None,æ¥ç»“æŸé€’å½’ï¼Œå‡å°‘æ—¶é—´å¤æ‚åº¦</span>            node.left = <span class="hljs-literal">None</span>            node.right = <span class="hljs-literal">None</span>        self.dfs(node.right, k)<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:    bt = BinTreeTravel([<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span>, <span class="hljs-number">9</span>, <span class="hljs-number">10</span>])    bt.pre_order_travel(bt.root)    bt.in_order_travel(bt.root)    bt.post_order_travel(bt.root)    bt.level_order_travel(bt.root)    print(<span class="hljs-string">&quot;#################################################&quot;</span>)    it = ReverseBinaryTree()    it.reverse_tree(bt.root)    bt.pre_order_travel(bt.root)</code></pre><p><a href="https://github.com/weitrue/note/blob/master/python/algorithm/data_structure/tree_cases.py">https://github.com/weitrue/note/blob/master/python/algorithm/data_structure/tree_cases.py</a></p><h3 id="Heap"><a href="#Heap" class="headerlink" title="Heap"></a>Heap</h3><p>äºŒå‰æ ‘æœ€ç›´æ¥çš„ä¸€ä¸ªåº”ç”¨å°±æ˜¯å®ç°å †ã€‚å †å°±æ˜¯ä¸€é¢—å®Œå…¨äºŒå‰æ ‘ï¼Œæœ€å¤§å †çš„éå¶å­èŠ‚ç‚¹çš„å€¼éƒ½æ¯”å­©å­å¤§ï¼Œæœ€å°å †çš„éå¶å­ç»“ç‚¹çš„å€¼éƒ½æ¯”å­©å­å°ã€‚ pythonå†…ç½®äº†heapqæ¨¡å—å¸®åŠ©æˆ‘ä»¬å®ç°å †æ“ä½œï¼Œæ¯”å¦‚ç”¨å†…ç½®çš„heapqæ¨¡å—å®ç°ä¸ªå †æ’åº</p><pre><code class="hljs Python"><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">Module Description: è·å–å¤§é‡å…ƒç´ ä¸­ top-n å¤§ä¸ªå…ƒç´ ï¼Œå›ºå®šå†…å­˜</span><span class="hljs-string">Problem:</span><span class="hljs-string">Solutionï¼š</span><span class="hljs-string">Date: 2020/2/16 </span><span class="hljs-string">Author: Wang P</span><span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-keyword">import</span> heapq<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TopN</span>:</span>    <span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">    å…ˆæ”¾å…¥å…ƒç´ å‰nä¸ªå»ºç«‹å°é¡¶å †</span><span class="hljs-string">    è¿­ä»£å‰©ä½™å…ƒç´ ï¼š</span><span class="hljs-string">        å¦‚æœå½“å‰å…ƒç´ å°äºå †é¡¶å…ƒç´ ï¼Œè·³è¿‡è¯¥å…ƒç´ </span><span class="hljs-string">        å¦åˆ™é€€æ¢å †é¡¶å…ƒç´ ä¸ºå½“å‰å…ƒç´ ï¼Œå¹¶é‡æ–°è°ƒæ•´å †</span><span class="hljs-string">    &quot;&quot;&quot;</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, iterable, n</span>):</span>        self.min_heap = []        self.capacity = n        self.iterable = iterable    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">push</span>(<span class="hljs-params">self, val</span>):</span>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(self.min_heap) &gt;= self.capacity:            min_val = self.min_heap[<span class="hljs-number">0</span>]            <span class="hljs-keyword">if</span> val &lt; min_val:  <span class="hljs-comment"># å¯ä»¥çœç•¥</span>                <span class="hljs-keyword">pass</span>            <span class="hljs-keyword">else</span>:                heapq.heapreplace(self.min_heap, val)  <span class="hljs-comment"># è¿”å›å¹¶ä¸”popå †é¡¶æœ€å°å€¼ï¼Œæ¨å…¥å¿ƒå¾—valå¹¶è°ƒæ•´å †</span>        <span class="hljs-keyword">else</span>:            heapq.heapreplace(self.min_heap, val)  <span class="hljs-comment"># å‰nä¸ªå…ƒç´ ç›´æ¥æ”¾å…¥å †ä¸­</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_top_n</span>(<span class="hljs-params">self</span>):</span>        <span class="hljs-keyword">for</span> val <span class="hljs-keyword">in</span> self.iterable:            self.push(val)        <span class="hljs-keyword">return</span> self.min_heap</code></pre><p><a href="https://github.com/weitrue/note/blob/master/python/algorithm/data_structure/heap_cases.py">https://github.com/weitrue/note/blob/master/python/algorithm/data_structure/heap_cases.py</a></p><h3 id="Hash-Tables"><a href="#Hash-Tables" class="headerlink" title="Hash Tables"></a>Hash Tables</h3><p>åŸºäºæ¯”è¾ƒçš„æœç´¢ï¼ˆçº¿æ€§æœç´¢ï¼Œæœ‰åºæ•°ç»„çš„äºŒåˆ†æœç´¢ï¼‰æœ€å¥½çš„æ—¶é—´å¤æ‚åº¦åªèƒ½è¾¾åˆ°O(logn)ï¼Œåˆ©ç”¨hashå¯ä»¥å®ç°O(1)æŸ¥æ‰¾ï¼Œpythonå†…ç½®dictçš„å®ç°æ–¹å¼å°±æ˜¯hashï¼Œä½ ä¼šå‘ç°dictçš„keyå¿…é¡»è¦æ˜¯å®ç°äº† <code>__hash__</code> å’Œ <code>__eq__</code> æ–¹æ³•çš„ã€‚</p><p>Hashing: hashing is the process of mapping a search a key to a limited range of array indeices with the goal of providing direct access to the keys.</p><p>hashæ–¹æ³•æœ‰ä¸ªhashå‡½æ•°ç”¨æ¥ç»™keyè®¡ç®—ä¸€ä¸ªhashå€¼ï¼Œä½œä¸ºæ•°ç»„ä¸‹æ ‡ï¼Œæ”¾åˆ°è¯¥ä¸‹æ ‡å¯¹åº”çš„æ§½ä¸­ã€‚å½“ä¸åŒkeyæ ¹æ®hashå‡½æ•°è®¡ç®—å¾—åˆ°çš„ä¸‹æ ‡ç›¸åŒæ—¶ï¼Œå°±å‡ºç°äº†å†²çªã€‚è§£å†³å†²çªæœ‰å¾ˆå¤šæ–¹å¼ï¼Œæ¯”å¦‚è®©æ¯ä¸ªæ§½æˆä¸ºé“¾è¡¨ï¼Œæ¯æ¬¡å†²çªä»¥åæ”¾åˆ°è¯¥æ§½é“¾è¡¨çš„å°¾éƒ¨ï¼Œä½†æ˜¯æŸ¥è¯¢æ—¶é—´å°±ä¼šé€€åŒ–ï¼Œä¸å†æ˜¯O(1)ã€‚è¿˜æœ‰ä¸€ç§æ¢æŸ¥æ–¹å¼ï¼Œå½“keyçš„æ§½å†²çªæ—¶å€™ï¼Œå°±ä¼šæ ¹æ®ä¸€ç§è®¡ç®—æ–¹å¼å»å¯»æ‰¾ä¸‹ä¸€ä¸ªç©ºçš„æ§½å­˜æ”¾ï¼Œæ¢æŸ¥æ–¹å¼æœ‰çº¿æ€§æ¢æŸ¥ï¼ŒäºŒæ¬¡æ–¹æ¢æŸ¥æ³•ç­‰ï¼Œcpythonè§£é‡Šå™¨ä½¿ç”¨çš„æ˜¯äºŒæ¬¡æ–¹æ¢æŸ¥æ³•ã€‚è¿˜æœ‰ä¸€ä¸ªé—®é¢˜å°±æ˜¯å½“pythonä½¿ç”¨çš„æ§½æ•°é‡å¤§äºé¢„åˆ†é…çš„2/3æ—¶å€™ï¼Œä¼šé‡æ–°åˆ†é…å†…å­˜å¹¶æ‹·è´ä»¥å‰çš„æ•°æ®ï¼Œæ‰€ä»¥æœ‰æ—¶å€™dictçš„addæ“ä½œä»£ä»·è¿˜æ˜¯æ¯”è¾ƒé«˜çš„ï¼Œç‰ºç‰²ç©ºé—´ä½†æ˜¯å¯ä»¥å§‹ç»ˆä¿è¯O(1)çš„æŸ¥è¯¢æ•ˆç‡ã€‚å¦‚æœæœ‰å¤§é‡çš„æ•°æ®ï¼Œå»ºè®®è¿˜æ˜¯ä½¿ç”¨bloomfilteræˆ–è€…redisæä¾›çš„HyperLogLogã€‚</p><p>å¦‚æœæ„Ÿå…´è¶£ï¼Œå¯ä»¥çœ‹çœ‹è¿™ç¯‡æ–‡ç« ï¼Œä»‹ç»cè§£é‡Šå™¨å¦‚ä½•å®ç°çš„python dictå¯¹è±¡ï¼š<a href="http://www.laurentluce.com/posts/python-dictionary-implementation/">Python dictionary implementation</a>ã€‚æˆ‘ä»¬ä½¿ç”¨Pythonæ¥å®ç°ä¸€ä¸ªç±»ä¼¼çš„hashç»“æ„ã€‚</p><h3 id="Recursion"><a href="#Recursion" class="headerlink" title="Recursion"></a>Recursion</h3><p>é€’å½’å‡½æ•°ï¼šRecursion is a process for solving problems by subdividing a larger problem into smaller cases of the problem itself and then solving the smaller, more trivial parts.</p><p>Properties of Recursion: ä½¿ç”¨stackè§£å†³çš„é—®é¢˜éƒ½èƒ½ç”¨é€’å½’è§£å†³</p><ul><li>A recursive solution must contain a base case; é€’å½’å‡ºå£ï¼Œä»£è¡¨æœ€å°å­é—®é¢˜(n == 0é€€å‡ºæ‰“å°)</li><li>A recursive solution must contain a recursive case; å¯ä»¥åˆ†è§£çš„å­é—®é¢˜</li><li>A recursive solution must make progress toward the base case. é€’å‡nä½¿å¾—nåƒé€’å½’å‡ºå£é è¿‘</li></ul><p>Tail Recursion: occurs when a function includes a single recursive call as the last statement of the function. In this case, a stack is not needed to store values to te used upon the return of the recursive call and thus a solution can be implemented using a iterative loop instead.</p>]]></content>
    
    
    <categories>
      
      <category>ADT</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Python</tag>
      
      <tag>ADT</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€ALLã€‘HDFS:Hadoopåˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿ</title>
    <link href="/2020/11/09/Hadoop-HDFS/"/>
    <url>/2020/11/09/Hadoop-HDFS/</url>
    
    <content type="html"><![CDATA[<blockquote><p> HDFS is the primary distributed storage used by Hadoop applications. A HDFS cluster primarily consists of a NameNode that manages the file system metadata and DataNodes that store the actual data. The HDFS Architecture Guide describes HDFS in detail. This user guide primarily deals with the interaction of users and administrators with HDFS clusters. The HDFS architecture diagram depicts basic interactions among NameNode, the DataNodes, and the clients. Clients contact NameNode for file metadata or file modifications and perform actual file I/O directly with the DataNodes.<a id="more"></a> </p></blockquote><h3 id="å¤§æ•°æ®å…¨é“¾è·¯æ¶æ„"><a href="#å¤§æ•°æ®å…¨é“¾è·¯æ¶æ„" class="headerlink" title="å¤§æ•°æ®å…¨é“¾è·¯æ¶æ„"></a>å¤§æ•°æ®å…¨é“¾è·¯æ¶æ„</h3><p>æ•°æ®åœ¨ç”Ÿäº§ç¯å¢ƒä¸­çš„æµå‘åŠå¤„ç†æµç¨‹</p><p><img src="/images/hdfs/image-20190629152840146.png"></p><h3 id="å¤§æ•°æ®ä¸»æµæ¡†æ¶"><a href="#å¤§æ•°æ®ä¸»æµæ¡†æ¶" class="headerlink" title="å¤§æ•°æ®ä¸»æµæ¡†æ¶"></a>å¤§æ•°æ®ä¸»æµæ¡†æ¶</h3><p>1 ç¬¬ä¸€ä»£å¤§æ•°æ®æ¡†æ¶: å„è‡ªä¸ºæˆ˜</p><p><img src="/images/hdfs/image-20190629153348534.png"></p><p>2 ç¬¬äºŒä»£å¤§æ•°æ®è®¡ç®—æ¡†æ¶</p><p><img src="/images/hdfs/image-20190629153652036.png"></p><p>3 ç¬¬ä¸‰ä»£å¤§æ•°æ®è®¡ç®—æ¡†æ¶ Flink</p><p><img src="/images/hdfs/image-20190629153835100.png"></p><h3 id="Hadoopçš„æ¶æ„æ¨¡å—"><a href="#Hadoopçš„æ¶æ„æ¨¡å—" class="headerlink" title="Hadoopçš„æ¶æ„æ¨¡å—"></a>Hadoopçš„æ¶æ„æ¨¡å—</h3><div align="center">  <img src="/images/hdfs/image-20200414134203318.png" alt="image-20200414134203318" style="zoom:50%;align: center"></div><ul><li>Hadoopç”±ä¸‰ä¸ªæ¨¡å—ç»„æˆï¼š**<em>åˆ†å¸ƒå¼**</em>å­˜å‚¨HDFSã€åˆ†å¸ƒå¼è®¡ç®—MapReduceã€èµ„æºè°ƒåº¦å¼•æ“Yarn</li></ul><div align="center">  <img src="/images/hdfs/image-20200414134230170.png" alt="image-20200414134230170" style="zoom: 33%;align: center"></div><pre><code class="hljs markdown"><span class="hljs-bullet">-</span> HDFSæ¨¡å—ï¼š<span class="hljs-bullet">  -</span>  namenodeï¼šä¸»èŠ‚ç‚¹ï¼Œä¸»è¦è´Ÿè´£é›†ç¾¤çš„ç®¡ç†ä»¥åŠå…ƒæ•°æ®ä¿¡æ¯ç®¡ç†<span class="hljs-bullet">  -</span>  datanodeï¼šä»èŠ‚ç‚¹ï¼Œä¸»è¦è´Ÿè´£å­˜å‚¨ç”¨æˆ·æ•°æ®<span class="hljs-bullet">  -</span>  secondaryNameNodeï¼šè¾…åŠ©namenodeç®¡ç†å…ƒæ•°æ®ä¿¡æ¯ï¼Œä»¥åŠå…ƒæ•°æ®ä¿¡æ¯çš„å†·å¤‡ä»½<span class="hljs-bullet">-</span> Yarnæ¨¡å—ï¼š<span class="hljs-bullet">  -</span> ResourceManagerï¼šä¸»èŠ‚ç‚¹ï¼Œä¸»è¦è´Ÿè´£èµ„æºåˆ†é…<span class="hljs-bullet">  -</span> NodeManagerï¼šä»èŠ‚ç‚¹ï¼Œä¸»è¦è´Ÿè´£æ‰§è¡Œä»»åŠ¡</code></pre><h3 id="HDFSåŠŸèƒ½æ¨¡å—"><a href="#HDFSåŠŸèƒ½æ¨¡å—" class="headerlink" title="HDFSåŠŸèƒ½æ¨¡å—"></a>HDFSåŠŸèƒ½æ¨¡å—</h3><h4 id="hdfsçš„æ¶æ„"><a href="#hdfsçš„æ¶æ„" class="headerlink" title="hdfsçš„æ¶æ„"></a>hdfsçš„æ¶æ„</h4><h5 id="æ–‡ä»¶åˆ†å—å­˜å‚¨-amp-3å‰¯æœ¬"><a href="#æ–‡ä»¶åˆ†å—å­˜å‚¨-amp-3å‰¯æœ¬" class="headerlink" title="æ–‡ä»¶åˆ†å—å­˜å‚¨&amp;3å‰¯æœ¬"></a>æ–‡ä»¶åˆ†å—å­˜å‚¨&amp;3å‰¯æœ¬</h5><p><img src="/images/hdfs/block3.gif"></p><p><img src="/images/hdfs/image-20200414151438737.png"></p><ul><li><p>ä¿å­˜æ–‡ä»¶åˆ°HDFSæ—¶ï¼Œä¼šå…ˆé»˜è®¤æŒ‰**<em>128M**</em>çš„å¤§å°å¯¹æ–‡ä»¶è¿›è¡Œåˆ‡åˆ†ï¼›æ•ˆæœå¦‚ä¸Šå›¾</p><ul><li>æ•°æ®ä»¥blockå—çš„å½¢å¼è¿›ç»Ÿä¸€å­˜å‚¨ç®¡ç†ï¼Œæ¯ä¸ªblockå—é»˜è®¤æœ€å¤šå¯ä»¥å­˜å‚¨128Mçš„æ–‡ä»¶ã€‚</li><li>å¦‚æœæœ‰ä¸€ä¸ªæ–‡ä»¶å¤§å°ä¸º1KBï¼Œä¹Ÿæ˜¯è¦å ç”¨ä¸€ä¸ªblockå—ï¼Œä½†æ˜¯å®é™…å ç”¨ç£ç›˜ç©ºé—´è¿˜æ˜¯1KBå¤§å°ï¼Œç±»ä¼¼äºæœ‰ä¸€ä¸ªæ°´æ¡¶å¯ä»¥è£…128æ–¤çš„æ°´ï¼Œä½†æ˜¯æˆ‘åªè£…äº†1æ–¤çš„æ°´ï¼Œé‚£ä¹ˆæˆ‘çš„æ°´æ¡¶é‡Œé¢æ°´çš„é‡é‡å°±æ˜¯1æ–¤ï¼Œè€Œä¸æ˜¯128æ–¤</li></ul></li><li><p>æ¯ä¸ªblockå—çš„å…ƒæ•°æ®å¤§å°å¤§æ¦‚ä¸º150å­—èŠ‚</p></li><li><p>æ‰€æœ‰çš„æ–‡ä»¶éƒ½æ˜¯ä»¥blockå—çš„æ–¹å¼å­˜æ”¾åœ¨HDFSæ–‡ä»¶ç³»ç»Ÿå½“ä¸­ï¼Œåœ¨hadoop1å½“ä¸­ï¼Œæ–‡ä»¶çš„blockå—é»˜è®¤å¤§å°æ˜¯64Mï¼Œhadoop2å½“ä¸­ï¼Œæ–‡ä»¶çš„blockå—å¤§å°é»˜è®¤æ˜¯128Mï¼Œblockå—çš„å¤§å°å¯ä»¥é€šè¿‡hdfs-site.xmlå½“ä¸­çš„é…ç½®æ–‡ä»¶è¿›è¡ŒæŒ‡å®š</p></li></ul><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>dfs.block.size<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>å—å¤§å° ä»¥å­—èŠ‚ä¸ºå•ä½<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><span class="hljs-comment">&lt;!-- åªå†™æ•°å€¼å°±å¯ä»¥ --&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span></code></pre><ul><li><p>ä¸ºäº†ä¿è¯blockå—çš„å®‰å…¨æ€§ï¼Œä¹Ÿå°±æ˜¯æ•°æ®çš„å®‰å…¨æ€§ï¼Œåœ¨hadoop2å½“ä¸­ï¼Œæ–‡ä»¶é»˜è®¤ä¿å­˜**<em>ä¸‰ä¸ªå‰¯æœ¬**</em>ï¼Œæˆ‘ä»¬å¯ä»¥æ›´æ”¹å‰¯æœ¬æ•°ä»¥æé«˜æ•°æ®çš„å®‰å…¨æ€§</p></li><li><p>åœ¨hdfs-site.xmlå½“ä¸­ä¿®æ”¹ä»¥ä¸‹é…ç½®å±æ€§ï¼Œå³å¯æ›´æ”¹æ–‡ä»¶çš„å‰¯æœ¬æ•°</p></li></ul><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span>      <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>dfs.replication<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span>      <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>3<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span></code></pre><h5 id="æŠ½è±¡æˆæ•°æ®å—çš„å¥½å¤„"><a href="#æŠ½è±¡æˆæ•°æ®å—çš„å¥½å¤„" class="headerlink" title="æŠ½è±¡æˆæ•°æ®å—çš„å¥½å¤„"></a>æŠ½è±¡æˆæ•°æ®å—çš„å¥½å¤„</h5><ol><li><p>ä¸€ä¸ªæ–‡ä»¶æœ‰å¯èƒ½å¤§äºé›†ç¾¤ä¸­ä»»æ„ä¸€ä¸ªç£ç›˜<br>10T*3/128 = xxxå— 2Tï¼Œ2Tï¼Œ2T æ–‡ä»¶æ–¹å¼å­˜â€”â€“&gt;å¤šä¸ªblockå—ï¼Œè¿™äº›blockå—å±äºä¸€ä¸ªæ–‡ä»¶</p></li><li><p>ä½¿ç”¨å—æŠ½è±¡è€Œä¸æ˜¯æ–‡ä»¶å¯ä»¥ç®€åŒ–å­˜å‚¨å­ç³»ç»Ÿ</p><p>hdfså°†æ‰€æœ‰çš„æ–‡ä»¶å…¨éƒ¨æŠ½è±¡æˆä¸ºblockå—æ¥è¿›è¡Œå­˜å‚¨ï¼Œä¸ç®¡æ–‡ä»¶å¤§å°ï¼Œå…¨éƒ¨ä¸€è§†åŒä»éƒ½æ˜¯ä»¥blockå—çš„å½¢å¼è¿›è¡Œå­˜å‚¨ï¼Œæ–¹ä¾¿æˆ‘ä»¬çš„åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿå¯¹æ–‡ä»¶çš„ç®¡ç†</p></li><li><p>å—éå¸¸é€‚åˆç”¨äºæ•°æ®å¤‡ä»½è¿›è€Œæä¾›æ•°æ®å®¹é”™èƒ½åŠ›å’Œå¯ç”¨æ€§</p></li></ol><h5 id="HDFSæ¶æ„"><a href="#HDFSæ¶æ„" class="headerlink" title="HDFSæ¶æ„"></a>HDFSæ¶æ„</h5><p><img src="/images/hdfs/image-20200416160250256.png"></p><ul><li>HDFSé›†ç¾¤åŒ…æ‹¬ï¼ŒNameNodeå’ŒDataNodeä»¥åŠSecondary Namenodeã€‚<ul><li>NameNodeè´Ÿè´£ç®¡ç†æ•´ä¸ªæ–‡ä»¶ç³»ç»Ÿçš„å…ƒæ•°æ®ï¼Œä»¥åŠæ¯ä¸€ä¸ªè·¯å¾„ï¼ˆæ–‡ä»¶ï¼‰æ‰€å¯¹åº”çš„æ•°æ®å—ä¿¡æ¯ã€‚</li><li>DataNode è´Ÿè´£ç®¡ç†ç”¨æˆ·çš„æ–‡ä»¶æ•°æ®å—ï¼Œæ¯ä¸€ä¸ªæ•°æ®å—éƒ½å¯ä»¥åœ¨å¤šä¸ªdatanodeä¸Šå­˜å‚¨å¤šä¸ªå‰¯æœ¬ã€‚</li><li>Secondary NameNodeç”¨æ¥ç›‘æ§HDFSçŠ¶æ€çš„è¾…åŠ©åå°ç¨‹åºï¼Œæ¯éš”ä¸€æ®µæ—¶é—´è·å–HDFSå…ƒæ•°æ®çš„å¿«ç…§ã€‚æœ€ä¸»è¦ä½œç”¨æ˜¯è¾…åŠ©namenodeç®¡ç†å…ƒæ•°æ®ä¿¡æ¯</li></ul></li><li>NameNodeä¸Datanodeçš„æ€»ç»“æ¦‚è¿°</li></ul><p><img src="/images/hdfs/image-20200416160339310.png"></p><h5 id="æ‰©å±•"><a href="#æ‰©å±•" class="headerlink" title="æ‰©å±•"></a>æ‰©å±•</h5><p>å—ç¼“å­˜</p><ul><li><p>é€šå¸¸DataNodeä»ç£ç›˜ä¸­è¯»å–å—ï¼Œä½†å¯¹äºè®¿é—®é¢‘ç¹çš„æ–‡ä»¶ï¼Œå…¶å¯¹åº”çš„å—å¯èƒ½è¢«æ˜¾ç¤ºçš„ç¼“å­˜åœ¨DataNodeçš„å†…å­˜ä¸­ï¼Œä»¥å †å¤–å—ç¼“å­˜çš„å½¢å¼å­˜åœ¨ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œä¸€ä¸ªå—ä»…ç¼“å­˜åœ¨ä¸€ä¸ªDataNodeçš„å†…å­˜ä¸­ï¼Œå½“ç„¶å¯ä»¥é’ˆå¯¹æ¯ä¸ªæ–‡ä»¶é…ç½®DataNodeçš„æ•°é‡ã€‚ä½œä¸šè°ƒåº¦å™¨é€šè¿‡åœ¨ç¼“å­˜å—çš„DataNodeä¸Šè¿è¡Œä»»åŠ¡ï¼Œå¯ä»¥åˆ©ç”¨å—ç¼“å­˜çš„ä¼˜åŠ¿æé«˜è¯»æ“ä½œçš„æ€§èƒ½ã€‚</p><p>ä¾‹å¦‚ï¼š<br> è¿æ¥ï¼ˆjoinï¼‰æ“ä½œä¸­ä½¿ç”¨çš„ä¸€ä¸ªå°çš„æŸ¥è¯¢è¡¨å°±æ˜¯å—ç¼“å­˜çš„ä¸€ä¸ªå¾ˆå¥½çš„å€™é€‰ã€‚<br> ç”¨æˆ·æˆ–åº”ç”¨é€šè¿‡åœ¨ç¼“å­˜æ± ä¸­å¢åŠ ä¸€ä¸ªcache directiveæ¥å‘Šè¯‰namenodeéœ€è¦ç¼“å­˜å“ªäº›æ–‡ä»¶åŠå­˜å¤šä¹…ã€‚ç¼“å­˜æ± ï¼ˆcache poolï¼‰æ˜¯ä¸€ä¸ªæ‹¥æœ‰ç®¡ç†ç¼“å­˜æƒé™å’Œèµ„æºä½¿ç”¨çš„ç®¡ç†æ€§åˆ†ç»„</p></li></ul><p>hdfsçš„æ–‡ä»¶æƒé™éªŒè¯</p><ul><li><p>hdfsçš„æ–‡ä»¶æƒé™æœºåˆ¶ä¸linuxç³»ç»Ÿçš„æ–‡ä»¶æƒé™æœºåˆ¶ç±»ä¼¼</p><p>r:read  w:write x:execute æƒé™xå¯¹äºæ–‡ä»¶è¡¨ç¤ºå¿½ç•¥ï¼Œå¯¹äºæ–‡ä»¶å¤¹è¡¨ç¤ºæ˜¯å¦æœ‰æƒé™è®¿é—®å…¶å†…å®¹</p><p>å¦‚æœlinuxç³»ç»Ÿç”¨æˆ·zhangsanä½¿ç”¨hadoopå‘½ä»¤åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œé‚£ä¹ˆè¿™ä¸ªæ–‡ä»¶åœ¨HDFSå½“ä¸­çš„ownerå°±æ˜¯zhangsan</p><p>HDFSæ–‡ä»¶æƒé™çš„ç›®çš„ï¼Œé˜²æ­¢å¥½äººåšé”™äº‹ï¼Œè€Œä¸æ˜¯é˜»æ­¢åäººåšåäº‹ã€‚HDFSç›¸ä¿¡ä½ å‘Šè¯‰æˆ‘ä½ æ˜¯è°ï¼Œä½ å°±æ˜¯è°</p></li></ul><h4 id="HDFSçš„shellå‘½ä»¤æ“ä½œ"><a href="#HDFSçš„shellå‘½ä»¤æ“ä½œ" class="headerlink" title="HDFSçš„shellå‘½ä»¤æ“ä½œ"></a>HDFSçš„shellå‘½ä»¤æ“ä½œ</h4><ul><li>HDFSå‘½ä»¤æœ‰ä¸¤ç§é£æ ¼ï¼š<ul><li>hadoop fså¼€å¤´çš„</li><li>hdfs dfså¼€å¤´çš„</li><li>ä¸¤ç§å‘½ä»¤å‡å¯ä½¿ç”¨ï¼Œæ•ˆæœç›¸åŒ</li></ul></li></ul><p>æŸ¥çœ‹hdfsæˆ–hadoopå­å‘½ä»¤çš„å¸®åŠ©ä¿¡æ¯ï¼Œå¦‚lså­å‘½ä»¤</p><pre><code class="hljs shell">hdfs dfs -help lshadoop fs -help ls #ä¸¤ä¸ªå‘½ä»¤ç­‰ä»·</code></pre><p>æŸ¥çœ‹hdfsæ–‡ä»¶ç³»ç»Ÿä¸­æŒ‡å®šç›®å½•çš„æ–‡ä»¶åˆ—è¡¨ã€‚å¯¹æ¯”linuxå‘½ä»¤ls</p><pre><code class="hljs shell">hdfs dfs -ls /hadoop fs -ls /hdfs dfs -ls -R /</code></pre><p>åœ¨hdfsæ–‡ä»¶ç³»ç»Ÿä¸­åˆ›å»ºæ–‡ä»¶</p><pre><code class="hljs shell">hdfs dfs -touchz /edits.txt</code></pre><p>å‘HDFSæ–‡ä»¶ä¸­è¿½åŠ å†…å®¹</p><pre><code class="hljs shell">hadoop fs -appendToFile edit1.xml /edits.txt #å°†æœ¬åœ°ç£ç›˜å½“å‰ç›®å½•çš„edit1.xmlå†…å®¹è¿½åŠ åˆ°HDFSæ ¹ç›®å½• çš„edits.txtæ–‡ä»¶</code></pre><p>æŸ¥çœ‹HDFSæ–‡ä»¶å†…å®¹</p><pre><code class="hljs shell">hdfs dfs -cat /edits.txt</code></pre><p>ä»æœ¬åœ°è·¯å¾„ä¸Šä¼ æ–‡ä»¶è‡³HDFS</p><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">ç”¨æ³•ï¼šhdfs dfs -put /æœ¬åœ°è·¯å¾„ /hdfsè·¯å¾„</span>hdfs dfs -put /linuxæœ¬åœ°ç£ç›˜æ–‡ä»¶ /hdfsè·¯å¾„æ–‡ä»¶hdfs dfs -copyFromLocal /linuxæœ¬åœ°ç£ç›˜æ–‡ä»¶ /hdfsè·¯å¾„æ–‡ä»¶  #è·Ÿputä½œç”¨ä¸€æ ·hdfs dfs -moveFromLocal /linuxæœ¬åœ°ç£ç›˜æ–‡ä»¶ /hdfsè·¯å¾„æ–‡ä»¶  #è·Ÿputä½œç”¨ä¸€æ ·ï¼Œåªä¸è¿‡ï¼Œæºæ–‡ä»¶è¢«æ‹·è´æˆåŠŸåï¼Œä¼šè¢«åˆ é™¤</code></pre><p>åœ¨hdfsæ–‡ä»¶ç³»ç»Ÿä¸­ä¸‹è½½æ–‡ä»¶</p><pre><code class="hljs shell">hdfs dfs -get /hdfsè·¯å¾„ /æœ¬åœ°è·¯å¾„hdfs dfs -copyToLocal /hdfsè·¯å¾„ /æœ¬åœ°è·¯å¾„  #æ ¹getä½œç”¨ä¸€æ ·</code></pre><p>åœ¨hdfsæ–‡ä»¶ç³»ç»Ÿä¸­åˆ›å»ºç›®å½•</p><pre><code class="hljs shell">hdfs dfs -mkdir /shell</code></pre><p>åœ¨hdfsæ–‡ä»¶ç³»ç»Ÿä¸­åˆ é™¤æ–‡ä»¶</p><pre><code class="hljs shell">hdfs dfs -rm /edits.txt</code></pre><p>åœ¨hdfsæ–‡ä»¶ç³»ç»Ÿä¸­ä¿®æ”¹æ–‡ä»¶åç§°ï¼ˆä¹Ÿå¯ä»¥ç”¨æ¥ç§»åŠ¨æ–‡ä»¶åˆ°ç›®å½•ï¼‰</p><pre><code class="hljs shell">hdfs dfs -mv /xcall.sh /call.shhdfs dfs -mv /call.sh /shell</code></pre><p>åœ¨hdfsä¸­æ‹·è´æ–‡ä»¶åˆ°ç›®å½•</p><pre><code class="hljs shell">hdfs dfs -cp /xrsync.sh /shell</code></pre><p>é€’å½’åˆ é™¤ç›®å½•</p><pre><code class="hljs shell">hdfs dfs -rm -r /shell</code></pre><p>åˆ—å‡ºæœ¬åœ°æ–‡ä»¶çš„å†…å®¹ï¼ˆé»˜è®¤æ˜¯hdfsæ–‡ä»¶ç³»ç»Ÿï¼‰</p><pre><code class="hljs shell">hdfs dfs -ls file:///home/hadoop/</code></pre><p>æŸ¥æ‰¾æ–‡ä»¶</p><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> linux findå‘½ä»¤</span>find . -name &#x27;edit*&#x27;<span class="hljs-meta">#</span><span class="bash"> HDFS findå‘½ä»¤</span>hadoop fs -find / -name part-r-00000 # åœ¨HDFSæ ¹ç›®å½•ä¸­ï¼ŒæŸ¥æ‰¾part-r-00000æ–‡ä»¶</code></pre><h4 id="HDFSå®‰å…¨æ¨¡å¼"><a href="#HDFSå®‰å…¨æ¨¡å¼" class="headerlink" title="HDFSå®‰å…¨æ¨¡å¼"></a>HDFSå®‰å…¨æ¨¡å¼</h4><ul><li>å®‰å…¨æ¨¡å¼æ˜¯HDFSæ‰€å¤„çš„ä¸€ç§ç‰¹æ®ŠçŠ¶æ€ï¼Œåœ¨è¿™ç§çŠ¶æ€ä¸‹ï¼Œæ–‡ä»¶ç³»ç»Ÿåªæ¥å—è¯»æ•°æ®è¯·æ±‚ï¼Œè€Œä¸æ¥å—åˆ é™¤ã€ä¿®æ”¹ç­‰å˜æ›´è¯·æ±‚ã€‚åœ¨NameNodeä¸»èŠ‚ç‚¹å¯åŠ¨æ—¶ï¼ŒHDFSé¦–å…ˆè¿›å…¥å®‰å…¨æ¨¡å¼ï¼ŒDataNodeåœ¨å¯åŠ¨çš„æ—¶å€™ä¼šå‘namenodeæ±‡æŠ¥å¯ç”¨çš„blockç­‰çŠ¶æ€ï¼Œå½“æ•´ä¸ªç³»ç»Ÿè¾¾åˆ°å®‰å…¨æ ‡å‡†æ—¶ï¼ŒHDFSè‡ªåŠ¨ç¦»å¼€å®‰å…¨æ¨¡å¼ã€‚å¦‚æœHDFSå‡ºäºå®‰å…¨æ¨¡å¼ä¸‹ï¼Œåˆ™æ–‡ä»¶blockä¸èƒ½è¿›è¡Œä»»ä½•çš„å‰¯æœ¬å¤åˆ¶æ“ä½œï¼Œå› æ­¤è¾¾åˆ°æœ€å°çš„å‰¯æœ¬æ•°é‡è¦æ±‚æ˜¯åŸºäºdatanodeå¯åŠ¨æ—¶çš„çŠ¶æ€æ¥åˆ¤å®šçš„ï¼Œå¯åŠ¨æ—¶ä¸ä¼šå†åšä»»ä½•å¤åˆ¶ï¼ˆä»è€Œè¾¾åˆ°æœ€å°å‰¯æœ¬æ•°é‡è¦æ±‚ï¼‰ï¼Œhdfsé›†ç¾¤åˆšå¯åŠ¨çš„æ—¶å€™ï¼Œé»˜è®¤30Sé’Ÿçš„æ—¶é—´æ˜¯å‡ºäºå®‰å…¨æœŸçš„ï¼Œåªæœ‰è¿‡äº†30Sä¹‹åï¼Œé›†ç¾¤è„±ç¦»äº†å®‰å…¨æœŸï¼Œç„¶åæ‰å¯ä»¥å¯¹é›†ç¾¤è¿›è¡Œæ“ä½œ</li><li>ä½•æ—¶æ¨å‡ºå®‰å…¨æ¨¡å¼<ul><li>namenodeçŸ¥é“é›†ç¾¤å…±å¤šå°‘ä¸ªblockï¼ˆä¸è€ƒè™‘å‰¯æœ¬ï¼‰ï¼Œå‡è®¾å€¼æ˜¯totalï¼›</li><li>namenodeå¯åŠ¨åï¼Œä¼šä¸ŠæŠ¥block reportï¼Œnamenodeå¼€å§‹ç´¯åŠ ç»Ÿè®¡æ»¡è¶³æœ€å°å‰¯æœ¬æ•°ï¼ˆé»˜è®¤1ï¼‰çš„blockä¸ªæ•°ï¼Œå‡è®¾æ˜¯num</li><li>å½“num/total &gt; 99.9%æ—¶ï¼Œæ¨å‡ºå®‰å…¨æ¨¡å¼</li></ul></li></ul><pre><code class="hljs shell">[hadoop@node01 hadoop]$ hdfs dfsadmin -safemode  Usage: hdfs dfsadmin [-safemode enter | leave | get | wait]</code></pre><h4 id="NameNodeå’ŒSecondaryNameNode"><a href="#NameNodeå’ŒSecondaryNameNode" class="headerlink" title="NameNodeå’ŒSecondaryNameNode"></a>NameNodeå’ŒSecondaryNameNode</h4><h5 id="namenodeä¸secondaryName"><a href="#namenodeä¸secondaryName" class="headerlink" title="namenodeä¸secondaryName"></a>namenodeä¸secondaryName</h5><ul><li><p>NameNodeä¸»è¦è´Ÿè´£é›†ç¾¤å½“ä¸­çš„å…ƒæ•°æ®ä¿¡æ¯ç®¡ç†ï¼Œè€Œä¸”å…ƒæ•°æ®ä¿¡æ¯éœ€è¦ç»å¸¸éšæœºè®¿é—®ï¼Œå› ä¸ºå…ƒæ•°æ®ä¿¡æ¯å¿…é¡»é«˜æ•ˆçš„æ£€ç´¢ï¼Œé‚£ä¹ˆå¦‚ä½•ä¿è¯namenodeå¿«é€Ÿæ£€ç´¢å‘¢ï¼Ÿï¼Ÿå…ƒæ•°æ®ä¿¡æ¯ä¿å­˜åœ¨å“ªé‡Œèƒ½å¤Ÿå¿«é€Ÿæ£€ç´¢å‘¢ï¼Ÿï¼Ÿå¦‚ä½•ä¿è¯å…ƒæ•°æ®çš„æŒä¹…å®‰å…¨å‘¢ï¼Ÿï¼Ÿ</p></li><li><p>ä¸ºäº†ä¿è¯å…ƒæ•°æ®ä¿¡æ¯çš„å¿«é€Ÿæ£€ç´¢ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¿…é¡»å°†å…ƒæ•°æ®å­˜æ”¾åœ¨å†…å­˜å½“ä¸­ï¼Œå› ä¸ºåœ¨å†…å­˜å½“ä¸­å…ƒæ•°æ®ä¿¡æ¯èƒ½å¤Ÿæœ€å¿«é€Ÿçš„æ£€ç´¢ï¼Œé‚£ä¹ˆéšç€å…ƒæ•°æ®ä¿¡æ¯çš„å¢å¤šï¼ˆæ¯ä¸ªblockå—å¤§æ¦‚å ç”¨150å­—èŠ‚çš„å…ƒæ•°æ®ä¿¡æ¯ï¼‰ï¼Œå†…å­˜çš„æ¶ˆè€—ä¹Ÿä¼šè¶Šæ¥è¶Šå¤šã€‚</p></li><li><p>å¦‚æœæ‰€æœ‰çš„å…ƒæ•°æ®ä¿¡æ¯éƒ½å­˜æ”¾å†…å­˜ï¼ŒæœåŠ¡å™¨æ–­ç”µï¼Œå†…å­˜å½“ä¸­æ‰€æœ‰æ•°æ®éƒ½æ¶ˆå¤±ï¼Œä¸ºäº†ä¿è¯å…ƒæ•°æ®çš„å®‰å…¨æŒä¹…ï¼Œå…ƒæ•°æ®ä¿¡æ¯å¿…é¡»åšå¯é çš„æŒä¹…åŒ–ï¼Œåœ¨hadoopå½“ä¸­ä¸ºäº†æŒä¹…åŒ–å­˜å‚¨å…ƒæ•°æ®ä¿¡æ¯ï¼Œå°†æ‰€æœ‰çš„å…ƒæ•°æ®ä¿¡æ¯ä¿å­˜åœ¨äº†FSImageæ–‡ä»¶å½“ä¸­ï¼Œé‚£ä¹ˆFSImageéšç€æ—¶é—´æ¨ç§»ï¼Œå¿…ç„¶è¶Šæ¥è¶Šè†¨èƒ€ï¼ŒFSImageçš„æ“ä½œå˜å¾—è¶Šæ¥è¶Šéš¾ï¼Œä¸ºäº†è§£å†³å…ƒæ•°æ®ä¿¡æ¯çš„å¢åˆ æ”¹ï¼Œhadoopå½“ä¸­è¿˜å¼•å…¥äº†å…ƒæ•°æ®æ“ä½œæ—¥å¿—editsæ–‡ä»¶ï¼Œeditsæ–‡ä»¶è®°å½•äº†å®¢æˆ·ç«¯æ“ä½œå…ƒæ•°æ®çš„ä¿¡æ¯ï¼Œéšç€æ—¶é—´çš„æ¨ç§»ï¼Œeditsä¿¡æ¯ä¹Ÿä¼šè¶Šæ¥è¶Šå¤§ï¼Œä¸ºäº†è§£å†³editsæ–‡ä»¶è†¨èƒ€çš„é—®é¢˜ï¼Œhadoopå½“ä¸­å¼•å…¥äº†secondaryNamenodeæ¥ä¸“é—¨åšfsimageä¸editsæ–‡ä»¶çš„åˆå¹¶</p></li></ul><p><img src="/images/hdfs/checkpoint.gif"></p><h5 id="namenodeå·¥ä½œæœºåˆ¶"><a href="#namenodeå·¥ä½œæœºåˆ¶" class="headerlink" title="namenodeå·¥ä½œæœºåˆ¶"></a>namenodeå·¥ä½œæœºåˆ¶</h5><p>ï¼ˆ1ï¼‰ç¬¬ä¸€æ¬¡å¯åŠ¨namenodeæ ¼å¼åŒ–åï¼Œåˆ›å»ºfsimageå’Œeditsæ–‡ä»¶ã€‚å¦‚æœä¸æ˜¯ç¬¬ä¸€æ¬¡å¯åŠ¨ï¼Œç›´æ¥åŠ è½½ç¼–è¾‘æ—¥å¿—å’Œé•œåƒæ–‡ä»¶åˆ°å†…å­˜ã€‚</p><p>ï¼ˆ2ï¼‰å®¢æˆ·ç«¯å¯¹å…ƒæ•°æ®è¿›è¡Œå¢åˆ æ”¹çš„è¯·æ±‚</p><p>ï¼ˆ3ï¼‰namenodeè®°å½•æ“ä½œæ—¥å¿—ï¼Œæ›´æ–°æ»šåŠ¨æ—¥å¿—ã€‚</p><p>ï¼ˆ4ï¼‰namenodeåœ¨å†…å­˜ä¸­å¯¹æ•°æ®è¿›è¡Œå¢åˆ æ”¹æŸ¥</p><h5 id="Secondary-NameNodeå·¥ä½œ"><a href="#Secondary-NameNodeå·¥ä½œ" class="headerlink" title="Secondary NameNodeå·¥ä½œ"></a>Secondary NameNodeå·¥ä½œ</h5><p>ï¼ˆ1ï¼‰Secondary NameNodeè¯¢é—®namenodeæ˜¯å¦éœ€è¦checkpointã€‚ç›´æ¥å¸¦å›namenodeæ˜¯å¦æ£€æŸ¥ç»“æœã€‚</p><p>ï¼ˆ2ï¼‰Secondary NameNodeè¯·æ±‚æ‰§è¡Œcheckpointã€‚</p><p>ï¼ˆ3ï¼‰namenodeæ»šåŠ¨æ­£åœ¨å†™çš„editsæ—¥å¿—</p><p>ï¼ˆ4ï¼‰å°†æ»šåŠ¨å‰çš„ç¼–è¾‘æ—¥å¿—å’Œé•œåƒæ–‡ä»¶æ‹·è´åˆ°Secondary NameNode</p><p>ï¼ˆ5ï¼‰Secondary NameNodeåŠ è½½ç¼–è¾‘æ—¥å¿—å’Œé•œåƒæ–‡ä»¶åˆ°å†…å­˜ï¼Œå¹¶åˆå¹¶ã€‚</p><p>ï¼ˆ6ï¼‰ç”Ÿæˆæ–°çš„é•œåƒæ–‡ä»¶fsimage.chkpoint</p><p>ï¼ˆ7ï¼‰ æ‹·è´fsimage.chkpointåˆ°namenode</p><p>ï¼ˆ8ï¼‰namenodeå°†fsimage.chkpointé‡æ–°å‘½åæˆfsimage</p><h5 id="FSImageä¸editsè¯¦è§£"><a href="#FSImageä¸editsè¯¦è§£" class="headerlink" title="FSImageä¸editsè¯¦è§£"></a>FSImageä¸editsè¯¦è§£</h5><ul><li>æ‰€æœ‰çš„å…ƒæ•°æ®ä¿¡æ¯éƒ½ä¿å­˜åœ¨äº†FsImageä¸Eidtsæ–‡ä»¶å½“ä¸­ï¼Œè¿™ä¸¤ä¸ªæ–‡ä»¶å°±è®°å½•äº†æ‰€æœ‰çš„æ•°æ®çš„å…ƒæ•°æ®ä¿¡æ¯ï¼Œå…ƒæ•°æ®ä¿¡æ¯çš„ä¿å­˜ç›®å½•é…ç½®åœ¨äº†hdfs-site.xmlå½“ä¸­</li></ul><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>dfs.namenode.name.dir<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>file:///weitrue/install/hadoop-2.6.0-cdh5.14.2/hadoopDatas/namenodeDatas<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span>   <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>dfs.namenode.edits.dir<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span>   <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>file:///weitrue/install/hadoop-2.6.0-cdh5.14.2/hadoopDatas/dfs/nn/edits<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span></code></pre><ul><li><p>å®¢æˆ·ç«¯å¯¹hdfsè¿›è¡Œå†™æ–‡ä»¶æ—¶ä¼šé¦–å…ˆè¢«è®°å½•åœ¨editsæ–‡ä»¶ä¸­ã€‚</p><p>editsä¿®æ”¹æ—¶å…ƒæ•°æ®ä¹Ÿä¼šæ›´æ–°ã€‚</p><p>æ¯æ¬¡hdfsæ›´æ–°æ—¶editså…ˆæ›´æ–°åå®¢æˆ·ç«¯æ‰ä¼šçœ‹åˆ°æœ€æ–°ä¿¡æ¯ã€‚</p><p>fsimage:æ˜¯namenodeä¸­å…³äºå…ƒæ•°æ®çš„é•œåƒï¼Œä¸€èˆ¬ç§°ä¸ºæ£€æŸ¥ç‚¹ã€‚</p><p>ä¸€èˆ¬å¼€å§‹æ—¶å¯¹namenodeçš„æ“ä½œéƒ½æ”¾åœ¨editsä¸­ï¼Œä¸ºä»€ä¹ˆä¸æ”¾åœ¨fsimageä¸­å‘¢ï¼Ÿ</p><p>å› ä¸ºfsimageæ˜¯namenodeçš„å®Œæ•´çš„é•œåƒï¼Œå†…å®¹å¾ˆå¤§ï¼Œå¦‚æœæ¯æ¬¡éƒ½åŠ è½½åˆ°å†…å­˜çš„è¯ç”Ÿæˆæ ‘çŠ¶æ‹“æ‰‘ç»“æ„ï¼Œè¿™æ˜¯éå¸¸è€—å†…å­˜å’ŒCPUã€‚</p><p>fsimageå†…å®¹åŒ…å«äº†namenodeç®¡ç†ä¸‹çš„æ‰€æœ‰datanodeä¸­æ–‡ä»¶åŠæ–‡ä»¶blockåŠblockæ‰€åœ¨çš„datanodeçš„å…ƒæ•°æ®ä¿¡æ¯ã€‚éšç€editså†…å®¹å¢å¤§ï¼Œå°±éœ€è¦åœ¨ä¸€å®šæ—¶é—´ç‚¹å’Œfsimageåˆå¹¶ã€‚</p></li></ul><h5 id="FSimageæ–‡ä»¶å½“ä¸­çš„æ–‡ä»¶ä¿¡æ¯æŸ¥çœ‹"><a href="#FSimageæ–‡ä»¶å½“ä¸­çš„æ–‡ä»¶ä¿¡æ¯æŸ¥çœ‹" class="headerlink" title="FSimageæ–‡ä»¶å½“ä¸­çš„æ–‡ä»¶ä¿¡æ¯æŸ¥çœ‹"></a>FSimageæ–‡ä»¶å½“ä¸­çš„æ–‡ä»¶ä¿¡æ¯æŸ¥çœ‹</h5><ul><li><p>å®˜æ–¹æŸ¥çœ‹æ–‡æ¡£</p><p><a href="http://archive.cloudera.com/cdh5/cdh/5/hadoop-2.6.0-cdh5.14.0/hadoop-project-dist/hadoop-hdfs/HdfsImageViewer.html">http://archive.cloudera.com/cdh5/cdh/5/hadoop-2.6.0-cdh5.14.2/hadoop-project-dist/hadoop-hdfs/HdfsImageViewer.html</a></p></li><li><p>ä½¿ç”¨å‘½ä»¤ hdfs oiv </p></li></ul><pre><code class="hljs shell">cd  /weitrue/install/hadoop-2.6.0-cdh5.14.2/hadoopDatas/namenodeDatas/currenthdfs oiv -i fsimage_0000000000000000864 -p XML -o hello.xml</code></pre><h5 id="editså½“ä¸­çš„æ–‡ä»¶ä¿¡æ¯æŸ¥çœ‹"><a href="#editså½“ä¸­çš„æ–‡ä»¶ä¿¡æ¯æŸ¥çœ‹" class="headerlink" title="editså½“ä¸­çš„æ–‡ä»¶ä¿¡æ¯æŸ¥çœ‹"></a>editså½“ä¸­çš„æ–‡ä»¶ä¿¡æ¯æŸ¥çœ‹</h5><ul><li><p>å®˜æ–¹æŸ¥çœ‹æ–‡æ¡£</p><p><a href="http://archive.cloudera.com/cdh5/cdh/5/hadoop-2.6.0-cdh5.14.0/hadoop-project-dist/hadoop-hdfs/HdfsEditsViewer.html">http://archive.cloudera.com/cdh5/cdh/5/hadoop-2.6.0-cdh5.14.2/hadoop-project-dist/hadoop-hdfs/HdfsEditsViewer.html</a></p></li><li><p>æŸ¥çœ‹å‘½ä»¤ hdfs oev</p></li></ul><pre><code class="hljs shell">cd /weitrue/install/hadoop-2.6.0-cdh5.14.2/hadoopDatas/dfs/nn/editshdfs oev -i edits_0000000000000000865-0000000000000000866 -o myedit.xml -p XML</code></pre><h5 id="secondarynameNodeå¦‚ä½•è¾…åŠ©ç®¡ç†FSImageä¸Editsæ–‡ä»¶"><a href="#secondarynameNodeå¦‚ä½•è¾…åŠ©ç®¡ç†FSImageä¸Editsæ–‡ä»¶" class="headerlink" title="secondarynameNodeå¦‚ä½•è¾…åŠ©ç®¡ç†FSImageä¸Editsæ–‡ä»¶"></a>secondarynameNodeå¦‚ä½•è¾…åŠ©ç®¡ç†FSImageä¸Editsæ–‡ä»¶</h5><h5 id="namenodeå…ƒæ•°æ®ä¿¡æ¯å¤šç›®å½•é…ç½®"><a href="#namenodeå…ƒæ•°æ®ä¿¡æ¯å¤šç›®å½•é…ç½®" class="headerlink" title="namenodeå…ƒæ•°æ®ä¿¡æ¯å¤šç›®å½•é…ç½®"></a>namenodeå…ƒæ•°æ®ä¿¡æ¯å¤šç›®å½•é…ç½®</h5><ul><li><p>ä¸ºäº†ä¿è¯å…ƒæ•°æ®çš„å®‰å…¨æ€§ï¼Œæˆ‘ä»¬ä¸€èˆ¬éƒ½æ˜¯å…ˆç¡®å®šå¥½æˆ‘ä»¬çš„ç£ç›˜æŒ‚è½½ç›®å½•ï¼Œå°†å…ƒæ•°æ®çš„ç£ç›˜åšRAID1</p><p>namenodeçš„æœ¬åœ°ç›®å½•å¯ä»¥é…ç½®æˆå¤šä¸ªï¼Œä¸”æ¯ä¸ªç›®å½•å­˜æ”¾å†…å®¹ç›¸åŒï¼Œå¢åŠ äº†å¯é æ€§ã€‚</p></li><li><p>å…·ä½“é…ç½®å¦‚ä¸‹ï¼š</p><p>hdfs-site.xml</p></li></ul><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span>   <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>dfs.namenode.name.dir<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span>   <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>file:///weitrue/install/hadoop-2.6.0-cdh5.14.2/hadoopDatas/namenodeDatas<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span></code></pre>]]></content>
    
    
    <categories>
      
      <category>Bdata</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Hadoop</tag>
      
      <tag>å¤§æ•°æ®</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€Linuxã€‘Dockerå®‰è£…ä¸ä½¿ç”¨</title>
    <link href="/2020/06/24/docker/"/>
    <url>/2020/06/24/docker/</url>
    
    <content type="html"><![CDATA[<blockquote><p>Developers bring their ideas to life with Docker<a id="more"></a> </p></blockquote><h3 id="å®˜æ–¹æ–‡æ¡£"><a href="#å®˜æ–¹æ–‡æ¡£" class="headerlink" title="å®˜æ–¹æ–‡æ¡£"></a><strong>å®˜æ–¹æ–‡æ¡£</strong></h3><p><a href="https://links.jianshu.com/go?to=https://docs.docker.com/install/linux/docker-ce/centos/">https://docs.docker.com/install/linux/docker-ce/centos/</a></p><h3 id="å®‰è£…æ–¹å¼"><a href="#å®‰è£…æ–¹å¼" class="headerlink" title="å®‰è£…æ–¹å¼"></a><strong>å®‰è£…æ–¹å¼</strong></h3><ul><li>è®¾ç½®dockeræºçš„æ–¹å¼æ¥å®‰è£…(ç®€å•ï¼Œ å®˜æ–¹æ¨è)</li><li>ä¸‹è½½rpmåŒ…çš„æ–¹å¼å®‰è£…(é€‚ç”¨äºç¦»çº¿ç¯å¢ƒ)</li><li>ä½¿ç”¨è„šæœ¬å®‰è£…(é€‚ç”¨äºæµ‹è¯•å’Œå¼€å‘ç¯å¢ƒ)</li></ul><h4 id="dockeræºæ–¹å¼å®‰è£…"><a href="#dockeræºæ–¹å¼å®‰è£…" class="headerlink" title="dockeræºæ–¹å¼å®‰è£…"></a><strong>dockeræºæ–¹å¼å®‰è£…</strong></h4><p>ï¼ˆ1ï¼‰æ›´æ–°yumï¼Œ å®‰è£…ä¾èµ–</p><pre><code class="hljs shell">yum updateyum install -y yum-utils device-mapper-persistent-data lvm2</code></pre><p><img src="/images/docker/1.png"></p><p>ï¼ˆ2ï¼‰å°†dockeræºæ·»åŠ åˆ°ç³»ç»Ÿä¸­</p><pre><code class="hljs shell">yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo</code></pre><p><img src="/images/docker/1-1.png"></p><p>ï¼ˆ3ï¼‰Dockerå®‰è£…</p><pre><code class="hljs shell">yum install docker-ce docker-ce-cli containerd.io</code></pre><p>æ­¤æ—¶ï¼Œå¯èƒ½ä¼šæŠ¥é”™ï¼š</p><p><img src="/images/docker/2.png"></p><p>è¯¥å›¾ä¸­åŸå› æ˜¯</p><p>containerd.ioæ­¤è½¯ä»¶åŒ…å·²ç»å®‰è£…ï¼Œå¹¶ä¸”æ˜¯è¾ƒä½ç‰ˆæœ¬ï¼Œä¸è¦å®‰è£…çš„docker-ceæ‰€ä¾èµ–containerd.ioçš„ç‰ˆæœ¬ä¸ç¬¦ï¼Œå› æ­¤æœ€å¥½å®‰è£…è¾ƒæ–°ç‰ˆæœ¬çš„containerd.io</p><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> ä¸‹é¢ç½‘å€å¯ä»¥çœ‹åˆ°ä¸€ç³»åˆ—ç‰ˆæœ¬çš„containerd.io</span>https://download.docker.com/linux/centos/7/x86_64/edge/Packages/<span class="hljs-meta">#</span><span class="bash">wget å‘½ä»¤ä¸‹è½½æŒ‡å®šç‰ˆæœ¬çš„containerd.ioï¼ˆå¦‚æœæœªå®‰è£…wgetï¼Œéœ€è¦yum -y install wgetï¼‰</span>wget https://download.docker.com/linux/centos/7/x86_64/edge/Packages/containerd.io-1.2.6-3.3.el7.x86_64.rpm</code></pre><p><img src="/images/docker/3.png"></p><p> é‡æ–°æ‰§è¡Œå®‰è£…å‘½ä»¤</p><pre><code class="hljs shell">yum -y install docker-ce</code></pre><p><img src="/images/docker/4.png"></p><p>ï¼ˆ4ï¼‰Dockerå¯åŠ¨è®¾ç½®-â€”å¯åŠ¨dockerå’Œæ·»åŠ å¼€å¯è‡ªå¯åŠ¨</p><pre><code class="hljs shell">systemctl enable dockersystemctl start docker</code></pre><p><img src="/images/docker/5.png"></p><p>ï¼ˆ5ï¼‰æŸ¥çœ‹Dockerç‰ˆæœ¬</p><pre><code class="hljs shell">docker -v</code></pre><h3 id="Dockerä½¿ç”¨"><a href="#Dockerä½¿ç”¨" class="headerlink" title="Dockerä½¿ç”¨"></a><strong>Dockerä½¿ç”¨</strong></h3><h4 id="dockerå‘½ä»¤"><a href="#dockerå‘½ä»¤" class="headerlink" title="dockerå‘½ä»¤"></a><strong>dockerå‘½ä»¤</strong></h4><p>ï¼ˆ1ï¼‰å‘½ä»¤å¸®åŠ©ï¼ˆ-hå·²è¢«å¼ƒç”¨ï¼‰</p><pre><code class="hljs shell">docker --help</code></pre><p>ï¼ˆ2ï¼‰å¸¸ç”¨é€‰é¡¹è¯´æ˜</p><ul><li><p>-d, â€“detach=falseï¼Œ æŒ‡å®šå®¹å™¨è¿è¡Œäºå‰å°è¿˜æ˜¯åå°ï¼Œé»˜è®¤ä¸ºfalse</p></li><li><p>-i, â€“interactive=falseï¼Œ æ‰“å¼€STDINï¼Œç”¨äºæ§åˆ¶å°äº¤äº’</p></li><li><p>-t, â€“tty=falseï¼Œ åˆ†é…ttyè®¾å¤‡ï¼Œè¯¥å¯ä»¥æ”¯æŒç»ˆç«¯ç™»å½•ï¼Œé»˜è®¤ä¸ºfalse</p></li><li><p>-u, â€“user=â€â€ï¼Œ æŒ‡å®šå®¹å™¨çš„ç”¨æˆ·</p></li><li><p>-a, â€“attach=[]ï¼Œ ç™»å½•å®¹å™¨ï¼ˆå¿…é¡»æ˜¯ä»¥docker run -då¯åŠ¨çš„å®¹å™¨ï¼‰</p></li><li><p>-w, â€“workdir=â€â€ï¼Œ æŒ‡å®šå®¹å™¨çš„å·¥ä½œç›®å½•</p></li><li><p>-c, â€“cpu-shares=0ï¼Œ è®¾ç½®å®¹å™¨CPUæƒé‡ï¼Œåœ¨CPUå…±äº«åœºæ™¯ä½¿ç”¨</p></li><li><p>-e, â€“env=[]ï¼Œ æŒ‡å®šç¯å¢ƒå˜é‡ï¼Œå®¹å™¨ä¸­å¯ä»¥ä½¿ç”¨è¯¥ç¯å¢ƒå˜é‡</p></li><li><p>-m, â€“memory=â€â€ï¼Œ æŒ‡å®šå®¹å™¨çš„å†…å­˜ä¸Šé™</p></li><li><p>-P, â€“publish-all=falseï¼Œ æŒ‡å®šå®¹å™¨æš´éœ²çš„ç«¯å£</p></li><li><p>-p, â€“publish=[]ï¼Œ æŒ‡å®šå®¹å™¨æš´éœ²çš„ç«¯å£</p></li><li><p>-h, â€“hostname=â€â€ï¼Œ æŒ‡å®šå®¹å™¨çš„ä¸»æœºå</p></li><li><p>-v, â€“volume=[]ï¼Œ ç»™å®¹å™¨æŒ‚è½½å­˜å‚¨å·ï¼ŒæŒ‚è½½åˆ°å®¹å™¨çš„æŸä¸ªç›®å½•</p></li><li><p>â€“volumes-from=[]ï¼Œ ç»™å®¹å™¨æŒ‚è½½å…¶ä»–å®¹å™¨ä¸Šçš„å·ï¼ŒæŒ‚è½½åˆ°å®¹å™¨çš„æŸä¸ªç›®å½•</p></li><li><p>â€“cap-add=[]ï¼Œ æ·»åŠ æƒé™ï¼Œæƒé™æ¸…å•è¯¦è§ï¼š<a href="http://linux.die.net/man/7/capabilities">http://linux.die.net/man/7/capabilities</a></p></li><li><p>â€“cap-drop=[]ï¼Œ åˆ é™¤æƒé™ï¼Œæƒé™æ¸…å•è¯¦è§ï¼š<a href="http://linux.die.net/man/7/capabilities">http://linux.die.net/man/7/capabilities</a></p></li><li><p>â€“cidfile=â€â€ï¼Œ è¿è¡Œå®¹å™¨åï¼Œåœ¨æŒ‡å®šæ–‡ä»¶ä¸­å†™å…¥å®¹å™¨PIDå€¼ï¼Œä¸€ç§å…¸å‹çš„ç›‘æ§ç³»ç»Ÿç”¨æ³•</p></li><li><p>â€“cpuset=â€â€ï¼Œ è®¾ç½®å®¹å™¨å¯ä»¥ä½¿ç”¨å“ªäº›CPUï¼Œæ­¤å‚æ•°å¯ä»¥ç”¨æ¥å®¹å™¨ç‹¬å CPU</p></li><li><p>â€“device=[]ï¼Œ æ·»åŠ ä¸»æœºè®¾å¤‡ç»™å®¹å™¨ï¼Œç›¸å½“äºè®¾å¤‡ç›´é€š</p></li><li><p>â€“dns=[]ï¼Œ æŒ‡å®šå®¹å™¨çš„dnsæœåŠ¡å™¨</p></li><li><p>â€“dns-search=[]ï¼Œ æŒ‡å®šå®¹å™¨çš„dnsæœç´¢åŸŸåï¼Œå†™å…¥åˆ°å®¹å™¨çš„/etc/resolv.confæ–‡ä»¶</p></li><li><p>â€“entrypoint=â€â€ï¼Œ è¦†ç›–imageçš„å…¥å£ç‚¹</p></li><li><p>â€“env-file=[]ï¼Œ æŒ‡å®šç¯å¢ƒå˜é‡æ–‡ä»¶ï¼Œæ–‡ä»¶æ ¼å¼ä¸ºæ¯è¡Œä¸€ä¸ªç¯å¢ƒå˜é‡</p></li><li><p>â€“expose=[]ï¼Œ æŒ‡å®šå®¹å™¨æš´éœ²çš„ç«¯å£ï¼Œå³ä¿®æ”¹é•œåƒçš„æš´éœ²ç«¯å£</p></li><li><p>â€“link=[]ï¼Œ æŒ‡å®šå®¹å™¨é—´çš„å…³è”ï¼Œä½¿ç”¨å…¶ä»–å®¹å™¨çš„IPã€envç­‰ä¿¡æ¯</p></li><li><p>â€“lxc-conf=[]ï¼Œ æŒ‡å®šå®¹å™¨çš„é…ç½®æ–‡ä»¶ï¼Œåªæœ‰åœ¨æŒ‡å®šâ€“exec-driver=lxcæ—¶ä½¿ç”¨</p></li><li><p>â€“name=â€â€ï¼Œ æŒ‡å®šå®¹å™¨åå­—ï¼Œåç»­å¯ä»¥é€šè¿‡åå­—è¿›è¡Œå®¹å™¨ç®¡ç†ï¼Œlinksç‰¹æ€§éœ€è¦ä½¿ç”¨åå­—</p></li><li><p>â€“net=â€bridgeâ€ï¼Œ å®¹å™¨ç½‘ç»œè®¾ç½®:</p></li><li><ul><li>bridge ä½¿ç”¨docker daemonæŒ‡å®šçš„ç½‘æ¡¥</li><li>host //å®¹å™¨ä½¿ç”¨ä¸»æœºçš„ç½‘ç»œ</li><li>container:NAME_or_ID &gt;//ä½¿ç”¨å…¶ä»–å®¹å™¨çš„ç½‘è·¯ï¼Œå…±äº«IPå’ŒPORTç­‰ç½‘ç»œèµ„æº</li><li>none å®¹å™¨ä½¿ç”¨è‡ªå·±çš„ç½‘ç»œï¼ˆç±»ä¼¼â€“net=bridgeï¼‰ï¼Œä½†æ˜¯ä¸è¿›è¡Œé…ç½®</li></ul></li><li><p>â€“privileged=falseï¼Œ æŒ‡å®šå®¹å™¨æ˜¯å¦ä¸ºç‰¹æƒå®¹å™¨ï¼Œç‰¹æƒå®¹å™¨æ‹¥æœ‰æ‰€æœ‰çš„capabilities</p></li><li><p>â€“restart=â€noâ€ï¼Œ æŒ‡å®šå®¹å™¨åœæ­¢åçš„é‡å¯ç­–ç•¥:</p></li><li><ul><li>noï¼šå®¹å™¨é€€å‡ºæ—¶ä¸é‡å¯</li><li>on-failureï¼šå®¹å™¨æ•…éšœé€€å‡ºï¼ˆè¿”å›å€¼éé›¶ï¼‰æ—¶é‡å¯</li><li>alwaysï¼šå®¹å™¨é€€å‡ºæ—¶æ€»æ˜¯é‡å¯</li></ul></li><li><p>â€“rm=falseï¼Œ æŒ‡å®šå®¹å™¨åœæ­¢åè‡ªåŠ¨åˆ é™¤å®¹å™¨(ä¸æ”¯æŒä»¥docker run -då¯åŠ¨çš„å®¹å™¨)</p></li><li><p>â€“sig-proxy=trueï¼Œ è®¾ç½®ç”±ä»£ç†æ¥å—å¹¶å¤„ç†ä¿¡å·ï¼Œä½†æ˜¯SIGCHLDã€SIGSTOPå’ŒSIGKILLä¸èƒ½è¢«ä»£ç†</p></li></ul><h4 id="éƒ¨ç½²-è¿è¡Œé•œåƒ"><a href="#éƒ¨ç½²-è¿è¡Œé•œåƒ" class="headerlink" title="éƒ¨ç½²/è¿è¡Œé•œåƒ"></a><strong>éƒ¨ç½²/è¿è¡Œé•œåƒ</strong></h4><h5 id="pullæ–¹å¼"><a href="#pullæ–¹å¼" class="headerlink" title="pullæ–¹å¼"></a><strong>pullæ–¹å¼</strong></h5><p>ï¼ˆ1ï¼‰ä¸‹è½½å‘½ä»¤</p><pre><code class="hljs shell">docker pull é•œåƒå</code></pre><p>ï¼ˆ2ï¼‰[ä¾‹å¦‚]ä¸‹è½½gitlab</p><pre><code class="hljs shell">docker pull gitlab/gitlab-ce</code></pre><p>ä¸‹è½½çš„é•œåƒæ‰€åœ¨ä½ç½®ï¼ˆå…¶ä¸­ä¸€ä¸ªï¼‰</p><pre><code class="hljs shell">cd var/lib/docker/containers</code></pre><p><img src="/images/docker/6.png"></p><p>ï¼ˆ3ï¼‰æŸ¥çœ‹é•œåƒè¯¦ç»†ä¿¡æ¯</p><pre><code class="hljs shell">docker inspect gitlab/gitlab-ce</code></pre><p>ï¼ˆ4ï¼‰è¿è¡Œé•œåƒ</p><pre><code class="hljs shell">docker run --detach \  --hostname 127.0.0.1 \  --publish 10443:443 --publish 1080:80 --publish 1022:22 \  --name gitlab \  --restart always \  --volume /srv/gitlab/config:/etc/gitlab \  --volume /srv/gitlab/logs:/var/log/gitlab \  --volume /srv/gitlab/data:/var/opt/gitlab \  gitlab/gitlab-ce:latest</code></pre><p>è¿™é‡Œï¼Œ</p><p>127.0.0.1ä¸ºæœåŠ¡å™¨IPåœ°å€ï¼›</p><p>â€“publish 10443:443 â€“publish 1080:80 â€“publish 1022:22 æ˜¯æŒ‡å°†443ç«¯å£å¯¹å¤–æ˜ å°„ï¼ˆæš´éœ²ï¼‰æˆ10443ï¼Œ22ç«¯å£å¯¹å¤–æ˜ å°„ï¼ˆæš´éœ²ï¼‰æˆ1022ï¼Œ80ç«¯å£å¯¹å¤–æ˜ å°„ï¼ˆæš´éœ²ï¼‰æˆ1080ã€‚</p><p>ï¼ˆ5ï¼‰è®¿é—®gitlab</p><p><img src="/images/docker/7.png"></p><h5 id="å®¹å™¨åŒ–æ–¹å¼ï¼ˆgithub-comä¸Šé¡¹ç›®ï¼‰"><a href="#å®¹å™¨åŒ–æ–¹å¼ï¼ˆgithub-comä¸Šé¡¹ç›®ï¼‰" class="headerlink" title="å®¹å™¨åŒ–æ–¹å¼ï¼ˆgithub.comä¸Šé¡¹ç›®ï¼‰"></a><strong>å®¹å™¨åŒ–æ–¹å¼ï¼ˆgithub.comä¸Šé¡¹ç›®ï¼‰</strong></h5><blockquote><p>å¾…æ›´æ–°</p></blockquote><h4 id="å¸¸ç”¨å‘½ä»¤"><a href="#å¸¸ç”¨å‘½ä»¤" class="headerlink" title="å¸¸ç”¨å‘½ä»¤"></a><strong>å¸¸ç”¨å‘½ä»¤</strong></h4><p>ï¼ˆ1ï¼‰æŸ¥çœ‹é•œåƒ</p><pre><code class="hljs shell">docker ps -a</code></pre><p>è¿™é‡Œdocker ps çš„å‘½ä»¤åŒ…æ‹¬ï¼š </p><ul><li>-a åˆ—å‡ºæ‰€æœ‰å®¹å™¨ </li><li>-l åˆ—å‡ºæœ€æ–°åˆ›å»ºå®¹å™¨ </li><li>-n=2 åˆ—å‡ºæœ€è¿‘åˆ›å»ºçš„2ä¸ªå®¹å™¨ </li><li>-q ä»…åˆ—å‡ºå®¹å™¨ID </li><li>-s æ˜¾ç¤ºå®¹å™¨å¤§å° </li></ul><p><img src="/images/docker/8.png"></p><p>å…¶ä¸­ï¼Œ</p><p>CONTAINER IDï¼šå®¹å™¨ID</p><p>IMAGEï¼šé•œåƒå</p><p><strong>æ³¨æ„</strong>ï¼šå¦‚æœå®¹å™¨æ­£åœ¨è¿è¡Œæ˜¯æ— æ³•åˆ é™¤ï¼Œéœ€è¦å…ˆåœæ­¢</p><p>ï¼ˆ2ï¼‰stopå®¹å™¨</p><pre><code class="hljs shell">docker stop&lt;å®¹å™¨IDæˆ–å®¹å™¨å&gt;</code></pre><p><img src="/images/docker/9.png"></p><p>ï¼ˆ3ï¼‰åˆ é™¤å®¹å™¨</p><pre><code class="hljs shell">docker rm &lt;å®¹å™¨IDæˆ–å®¹å™¨å&gt;</code></pre><p>ï¼ˆ4ï¼‰åˆ é™¤é•œåƒ</p><pre><code class="hljs shell">docker rmi &lt;é•œåƒIDæˆ–é•œåƒå&gt;</code></pre><p>é•œåƒIDå¯ä»¥é€šè¿‡docker images</p><pre><code class="hljs shell">docker images</code></pre><p><img src="/images/docker/10.png"></p><p>æˆ–docker image ls</p><pre><code class="hljs shell">docker image ls</code></pre><p><img src="/images/docker/11.png"></p><p>ï¼ˆ5ï¼‰è¿›å…¥å®¹å™¨Console</p><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> è¿›å…¥æ§åˆ¶å°</span>docker exec -it [container name] [/bin/sh|bash]<span class="hljs-meta">#</span><span class="bash"> é€€å‡º</span>exit</code></pre><h4 id="dockerç£ç›˜å ç”¨"><a href="#dockerç£ç›˜å ç”¨" class="headerlink" title="dockerç£ç›˜å ç”¨"></a><strong>dockerç£ç›˜å ç”¨</strong></h4><h5 id="æŸ¥çœ‹ç³»ç»Ÿç£ç›˜å ç”¨æƒ…å†µ"><a href="#æŸ¥çœ‹ç³»ç»Ÿç£ç›˜å ç”¨æƒ…å†µ" class="headerlink" title="æŸ¥çœ‹ç³»ç»Ÿç£ç›˜å ç”¨æƒ…å†µ"></a>æŸ¥çœ‹ç³»ç»Ÿç£ç›˜å ç”¨æƒ…å†µ</h5><pre><code class="hljs shell">[root@docker-app ~]# df -h</code></pre><h5 id="æŸ¥çœ‹dockerå·¥ä½œç›®å½•å ç”¨ç£ç›˜æƒ…å†µ"><a href="#æŸ¥çœ‹dockerå·¥ä½œç›®å½•å ç”¨ç£ç›˜æƒ…å†µ" class="headerlink" title="æŸ¥çœ‹dockerå·¥ä½œç›®å½•å ç”¨ç£ç›˜æƒ…å†µ"></a>æŸ¥çœ‹dockerå·¥ä½œç›®å½•å ç”¨ç£ç›˜æƒ…å†µ</h5><pre><code class="hljs shell">[root@docker-app ~]# du -hs /var/lib/docker</code></pre><h5 id="docker-system-df"><a href="#docker-system-df" class="headerlink" title="docker system df"></a>docker system df</h5><pre><code class="hljs shell">[root@docker-app ~]# docker system dfTYPE                TOTAL               ACTIVE              SIZE                RECLAIMABLEImages              3                   3                   2.422GB             0B (0%)Containers          3                   3                   1.676MB             0B (0%)Local Volumes       2                   2                   251.4kB             0B (0%)Build Cache         0                   0                   0B                  0B</code></pre><h5 id="è‡ªåŠ¨æ¸…ç†ç£ç›˜"><a href="#è‡ªåŠ¨æ¸…ç†ç£ç›˜" class="headerlink" title="è‡ªåŠ¨æ¸…ç†ç£ç›˜"></a>è‡ªåŠ¨æ¸…ç†ç£ç›˜</h5><pre><code class="hljs shell">[root@docker-app ~]# docker system pruneWARNING! This will remove:  - all stopped containers  - all networks not used by at least one container  - all dangling images  - all dangling build cache è¯¥æŒ‡ä»¤é»˜è®¤ä¼šæ¸…é™¤æ‰€æœ‰å¦‚ä¸‹èµ„æºï¼šå·²åœæ­¢çš„å®¹å™¨ï¼ˆcontainerï¼‰æœªè¢«ä»»ä½•å®¹å™¨æ‰€ä½¿ç”¨çš„å·ï¼ˆvolumeï¼‰æœªè¢«ä»»ä½•å®¹å™¨æ‰€å…³è”çš„ç½‘ç»œï¼ˆnetworkï¼‰æ‰€æœ‰æ‚¬ç©ºé•œåƒï¼ˆimageï¼‰è¯¥æŒ‡ä»¤é»˜è®¤åªä¼šæ¸…é™¤æ‚¬ç©ºé•œåƒï¼Œæœªè¢«ä½¿ç”¨çš„é•œåƒä¸ä¼šè¢«åˆ é™¤ã€‚æ·»åŠ  -a æˆ– --all å‚æ•°åï¼Œå¯ä»¥ä¸€å¹¶æ¸…é™¤æ‰€æœ‰æœªä½¿ç”¨çš„é•œåƒå’Œæ‚¬ç©ºé•œåƒã€‚å¯ä»¥æ·»åŠ  -f æˆ– --force å‚æ•°ç”¨ä»¥å¿½ç•¥ç›¸å…³å‘Šè­¦ç¡®è®¤ä¿¡æ¯æ³¨æ„:docker system prune -aå‘½ä»¤æ¸…ç†å¾—æ›´åŠ å½»åº•ï¼Œå¯ä»¥å°†æ²¡æœ‰å®¹å™¨ä½¿ç”¨Dockeré•œåƒéƒ½åˆ æ‰ã€‚è¿™ä¸¤ä¸ªå‘½ä»¤ä¼šæŠŠä½ æš‚æ—¶å…³é—­çš„å®¹å™¨ï¼Œä»¥åŠæš‚æ—¶æ²¡æœ‰ç”¨åˆ°çš„Dockeré•œåƒéƒ½åˆ æ‰äº†â€¦æ‰€ä»¥ä½¿ç”¨ä¹‹å‰ä¸€å®šè¦æƒ³æ¸…æ¥šã€‚</code></pre><h5 id="æ‰‹åŠ¨æ¸…ç†"><a href="#æ‰‹åŠ¨æ¸…ç†" class="headerlink" title="æ‰‹åŠ¨æ¸…ç†"></a>æ‰‹åŠ¨æ¸…ç†</h5><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> æŸ¥æ‰¾<span class="hljs-string">&quot;/&quot;</span>ç›®å½•ä¸‹æ‰€æœ‰å¤§äº100Mçš„æ‰€æœ‰æ–‡ä»¶</span>[root@docker-app ~]# find / -type f -size +100M -print0 | xargs -0 du -h | sort -nrfind: â€˜/proc/7572/task/7572/fdinfo/6â€™: æ²¡æœ‰é‚£ä¸ªæ–‡ä»¶æˆ–ç›®å½•find: â€˜/proc/7572/fdinfo/5â€™: æ²¡æœ‰é‚£ä¸ªæ–‡ä»¶æˆ–ç›®å½•find: â€˜/proc/7687â€™: æ²¡æœ‰é‚£ä¸ªæ–‡ä»¶æˆ–ç›®å½•184M/srv/gitlab/data/prometheus/data/01F4Q52GBKGYAXCQE37V2GMS70.tmp/chunks/000001138M/var/lib/rpm/Packages102M/usr/lib/locale/locale-archive32G   /var/lib/docker/containers/&#123;container_id&#125;/&#123;container_id&#125;-json.log0/proc/kcore</code></pre><p>å‘ç°<code>/var/lib/docker/containers/&#123;container_id&#125;/</code>ä¸‹å­˜åœ¨æ•°æ®è¾ƒå¤§çš„<code>*-json.log</code>æ—¥å¿—æ–‡ä»¶ï¼Œç™¾åº¦å‘ç°è¿™æ˜¯dockerå®¹å™¨è¿è¡Œçš„<code>æ ‡å‡†è¾“å…¥æ—¥å¿—</code>ï¼Œé‚åˆ é™¤ä¹‹ã€‚é¡¹ç›®ä¸­å·²ä½¿ç”¨<code>-v</code>çš„æ–¹å¼æŒ‚è½½é¡¹ç›®è¾“å‡ºæ—¥å¿—æ–‡ä»¶ï¼Œå› æ­¤å¯¹å®¹å™¨è¿è¡Œæ—¥å¿—æ²¡æœ‰äº†éœ€æ±‚ï¼Œç ”ç©¶åå‘ç°åœ¨æ„å»ºå‚æ•°çš„æ—¶å€™å¯ä»¥å¯¹æ ‡å‡†è¾“å…¥æ—¥å¿—<code>å¤§å°</code>ä¸<code>æ•°é‡</code>è¿›è¡Œé™åˆ¶ï¼Œä»¥å‡å°‘æ—¥å¿—æ–‡ä»¶å¯¹å­˜å‚¨ç©ºé—´çš„å ç”¨ï¼Œä»¥ä¸‹é…ç½®åˆ†åˆ«ä¸ºæ—¥å¿—æ–‡ä»¶æœ€å¤§å®¹é‡ã€æœ€å¤§æ—¥å¿—æ–‡ä»¶æ•°ã€‚</p><pre><code class="hljs shell">docker run ...... --log-opt max-size=10m --log-opt max-file=1</code></pre><p>æ–°å»ºæˆ–ä¿®æ”¹/etc/docker/daemon.jsonï¼Œæ·»åŠ log-dirverå’Œlog-optså‚æ•°</p><pre><code class="hljs shell">&#123;   &quot;log-driver&quot;:&quot;json-file&quot;,   &quot;log-opts&quot;: &#123;&quot;max-size&quot;:&quot;10m&quot;, &quot;max-file&quot;:&quot;1&quot;&#125;&#125;</code></pre><h4 id="ä¿®æ”¹æ˜ å°„ç«¯å£"><a href="#ä¿®æ”¹æ˜ å°„ç«¯å£" class="headerlink" title="ä¿®æ”¹æ˜ å°„ç«¯å£"></a><strong>ä¿®æ”¹æ˜ å°„ç«¯å£</strong></h4><h5 id="é‡æ–°éƒ¨ç½²é•œåƒ"><a href="#é‡æ–°éƒ¨ç½²é•œåƒ" class="headerlink" title="é‡æ–°éƒ¨ç½²é•œåƒ"></a><strong>é‡æ–°éƒ¨ç½²é•œåƒ</strong></h5><h5 id="ä¿®æ”¹éƒ¨ç½²å®¹å™¨é…ç½®æ–‡ä»¶"><a href="#ä¿®æ”¹éƒ¨ç½²å®¹å™¨é…ç½®æ–‡ä»¶" class="headerlink" title="ä¿®æ”¹éƒ¨ç½²å®¹å™¨é…ç½®æ–‡ä»¶"></a><strong>ä¿®æ”¹éƒ¨ç½²å®¹å™¨é…ç½®æ–‡ä»¶</strong></h5><p>ï¼ˆ1ï¼‰åœæ­¢éœ€è¦ä¿®æ”¹çš„å®¹å™¨</p><pre><code class="hljs shell">docker ps -a docker stop &lt;å®¹å™¨IDæˆ–å®¹å™¨å&gt;</code></pre><p>ï¼ˆ2ï¼‰æ‰¾åˆ°hostconfig.jsonæ–‡ä»¶</p><pre><code class="hljs shell">cd /var/lib/docker/containers/&lt;å®¹å™¨IDç›®å½•,ä¾‹å¦‚651dcd904c5eec9617ea006f2ac3e59a9a015de237cae891fc5ef46a17bd3033&gt;</code></pre><p><img src="/images/docker/12.png"></p><p>ï¼ˆ3ï¼‰ä¿®æ”¹hostconfig.jsonæ–‡ä»¶ä¸­â€PortBindingsâ€é…ç½®</p><pre><code class="hljs shell">vim hostconfig.json</code></pre><p><img src="/images/docker/13.png"></p><p>ï¼ˆ4ï¼‰é‡å¯docker[éå¸¸é‡è¦]ï¼Œå¦åˆ™ä¿®æ”¹ä¼šå¤±æ•ˆ</p><pre><code class="hljs shell">systemctl restart docker</code></pre><p>ï¼ˆ5ï¼‰å¯åŠ¨ä¿®æ”¹åçš„å®¹å™¨</p><pre><code class="hljs shell">docker start &lt;å®¹å™¨IDæˆ–å®¹å™¨å&gt;</code></pre><p>ï¼ˆ6ï¼‰æŸ¥çœ‹æ˜¯å¦ä¿®æ”¹æˆåŠŸ</p><pre><code class="hljs shell">docker ps -a</code></pre><p><img src="/images/docker/14.png"></p><h3 id="Dockeré•œåƒéƒ¨ç½²å®¹å™¨"><a href="#Dockeré•œåƒéƒ¨ç½²å®¹å™¨" class="headerlink" title="Dockeré•œåƒéƒ¨ç½²å®¹å™¨"></a><strong>Dockeré•œåƒéƒ¨ç½²å®¹å™¨</strong></h3><h4 id="æ‹‰å–è¿œç«¯é•œåƒæ–¹å¼"><a href="#æ‹‰å–è¿œç«¯é•œåƒæ–¹å¼" class="headerlink" title="æ‹‰å–è¿œç«¯é•œåƒæ–¹å¼"></a><strong>æ‹‰å–è¿œç«¯é•œåƒæ–¹å¼</strong></h4><h5 id="éƒ¨ç½²portainerï¼ˆdockerå¯è§†åŒ–ç®¡ç†å·¥å…·ï¼‰"><a href="#éƒ¨ç½²portainerï¼ˆdockerå¯è§†åŒ–ç®¡ç†å·¥å…·ï¼‰" class="headerlink" title="éƒ¨ç½²portainerï¼ˆdockerå¯è§†åŒ–ç®¡ç†å·¥å…·ï¼‰"></a><strong>éƒ¨ç½²portainerï¼ˆdockerå¯è§†åŒ–ç®¡ç†å·¥å…·ï¼‰</strong></h5><pre><code class="hljs shell">docker pull docker.io/portainer/portainerdocker run --detach \    --hostname 127.0.0.1 \    --publish 9000:9000 \    --name portainer\    --restart=always \    --volume /var/run/docker.sock:/var/run/docker.sock \    docker.io/portainer/portainer</code></pre><h5 id="éƒ¨ç½²gitlabï¼ˆç§æœ‰ä»£ç åº“ï¼‰"><a href="#éƒ¨ç½²gitlabï¼ˆç§æœ‰ä»£ç åº“ï¼‰" class="headerlink" title="éƒ¨ç½²gitlabï¼ˆç§æœ‰ä»£ç åº“ï¼‰"></a><strong>éƒ¨ç½²gitlabï¼ˆç§æœ‰ä»£ç åº“ï¼‰</strong></h5><h6 id="æ‹‰å–é•œåƒå¹¶å¯åŠ¨"><a href="#æ‹‰å–é•œåƒå¹¶å¯åŠ¨" class="headerlink" title="æ‹‰å–é•œåƒå¹¶å¯åŠ¨"></a>æ‹‰å–é•œåƒå¹¶å¯åŠ¨</h6><pre><code class="hljs shell">docker pull gitlab/gitlab-cedocker run --detach \  --publish 443:443 --publish 80:80 --publish 1022:22 \  --name gitlab \  --restart always \  --volume /srv/gitlab/config:/etc/gitlab \  --volume /srv/gitlab/logs:/var/log/gitlab \  --volume /srv/gitlab/data:/var/opt/gitlab \  gitlab/gitlab-ce:latest</code></pre><h6 id="ä¿®æ”¹é…ç½®æ–‡ä»¶"><a href="#ä¿®æ”¹é…ç½®æ–‡ä»¶" class="headerlink" title="ä¿®æ”¹é…ç½®æ–‡ä»¶"></a>ä¿®æ”¹é…ç½®æ–‡ä»¶</h6><blockquote><p>ç­‰å¾…dockerè¿è¡Œgitlabä¸€å°æ®µæ—¶é—´ååœ¨æ“ä½œï¼Œå¦åˆ™å¯èƒ½å‡ºç°æ–‡ä»¶æ‰¾ä¸åˆ°</p></blockquote><p><strong>gitlab.ymlæ–‡ä»¶</strong></p><pre><code class="hljs shell">vim /srv/gitlab/data/gitlab-rails/etc/gitlab.yml<span class="hljs-meta">#</span><span class="bash"> æ‰¾åˆ°å¦‚ä¸‹é…ç½®</span><span class="hljs-meta">  #</span><span class="bash"><span class="hljs-comment"># GitLab settings</span></span>  gitlab:    ## Web server settings (note: host is the FQDN, do not include http://)    host: xx.xx.xx.xx   # æ­¤å¤„æ›¿æ¢ä¸ºè‡ªå·±çš„ip    port: 80    https: false</code></pre><p><strong>gitlab.rbæ–‡ä»¶</strong></p><pre><code class="hljs shell">vim /srv/gitlab/config/gitlab.rb</code></pre><p>æ‰¾åˆ°<code>external_url</code>ï¼Œé»˜è®¤æ˜¯è¢«æ³¨é‡Šçš„ã€‚</p><p>å¦‚æœæ‰“å¼€ï¼Œå¡«å†™æš´éœ²å‡ºå»çš„<code>http://ip:port</code>ï¼Œ<code>IP</code>ä¸€å®šè¦å’Œ<code>gitlab.yml</code>æ–‡ä»¶é…ç½®çš„ç›¸åŒï¼Œ<code>port</code>ä¸ºä½ å¯åŠ¨æ—¶æŒ‡å®šçš„ï¼Œè¿™é‡Œä½¿ç”¨é»˜è®¤<code>80</code>ä½œä¸ºç«¯å£ã€‚</p><p>æœ€ååŠ ä¸Šsshåè®®ä¸‹ä½¿ç”¨çš„IPå’Œç«¯å£(è¿™é‡Œçš„ç«¯å£æ˜¯å¯åŠ¨æ—¶æŒ‡å®šçš„ï¼Œè¿™é‡Œæ˜¯<code>1022</code>)ï¼Œæœ€åä¿å­˜å¹¶é€€å‡ºã€‚</p><pre><code class="hljs shell">external_url &#x27;http://xx.xx.xx.xx:80&#x27;gitlab_rails[&#x27;gitlab_ssh_host&#x27;] = &#x27;xx.xx.xx.xx&#x27;gitlab_rails[&#x27;gitlab_shell_ssh_host&#x27;] = &#x27;1022&#x27;</code></pre><h6 id="åœæ­¢å¹¶ç§»é™¤ä¹‹å‰å¯åŠ¨çš„gitlab"><a href="#åœæ­¢å¹¶ç§»é™¤ä¹‹å‰å¯åŠ¨çš„gitlab" class="headerlink" title="åœæ­¢å¹¶ç§»é™¤ä¹‹å‰å¯åŠ¨çš„gitlab"></a>åœæ­¢å¹¶ç§»é™¤ä¹‹å‰å¯åŠ¨çš„gitlab</h6><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> åœæ­¢å¹¶ç§»é™¤ä¹‹å‰å¯åŠ¨çš„GitLabå®¹å™¨</span>docker rm -f gitlab</code></pre><h6 id="é‡æ–°å¯åŠ¨gitlab"><a href="#é‡æ–°å¯åŠ¨gitlab" class="headerlink" title="é‡æ–°å¯åŠ¨gitlab"></a>é‡æ–°å¯åŠ¨gitlab</h6><pre><code class="hljs shell">docker pull gitlab/gitlab-cedocker run --detach \  --publish 443:443 --publish 80:80 --publish 1022:22 \  --name gitlab \  --restart always \  --volume /srv/gitlab/config:/etc/gitlab \  --volume /srv/gitlab/logs:/var/log/gitlab \  --volume /srv/gitlab/data:/var/opt/gitlab \  gitlab/gitlab-ce:latest</code></pre><p>ç­‰å¾…ä¸€æ®µæ—¶é—´ï¼Œå°±å¯ä»¥è®¿é—®äº†ï¼Œé¦–æ¬¡éœ€è¦æ›´æ”¹<code>root</code>è´¦æˆ·çš„å¯†ç </p><h5 id="éƒ¨ç½²gitlab-runner"><a href="#éƒ¨ç½²gitlab-runner" class="headerlink" title="éƒ¨ç½²gitlab-runner"></a><strong>éƒ¨ç½²gitlab-runner</strong></h5><h6 id="å…¨å±€é…ç½®"><a href="#å…¨å±€é…ç½®" class="headerlink" title="å…¨å±€é…ç½®"></a><strong>å…¨å±€é…ç½®</strong></h6><p>æ‰€æœ‰é¡¹ç›®éƒ½å¯ä»¥ä¸€èµ·ä½¿ç”¨</p><p><img src="/images/docker/runner-all.png"></p><h6 id="æ‹‰å–Runneré•œåƒå¹¶å¯åŠ¨"><a href="#æ‹‰å–Runneré•œåƒå¹¶å¯åŠ¨" class="headerlink" title="æ‹‰å–Runneré•œåƒå¹¶å¯åŠ¨"></a>æ‹‰å–Runneré•œåƒå¹¶å¯åŠ¨</h6><pre><code class="hljs shell">docker run -d \--name gitlab-runner \--restart always \    --volume /srv/gitlab-runner/config:/etc/gitlab-runner \    --volume /srv/gitlab-runner/run/docker.sock:/var/run/docker.sock \    gitlab/gitlab-runner:latest</code></pre><h6 id="Runner-æ³¨å†Œ"><a href="#Runner-æ³¨å†Œ" class="headerlink" title="Runner æ³¨å†Œ"></a>Runner æ³¨å†Œ</h6><p><strong>è¿›å…¥Runnerå®¹å™¨å†…</strong></p><pre><code class="hljs shell">docker exec -it gitlab-runner bash</code></pre><p><strong>è¿è¡Œå‘½ä»¤è¿›è¡Œæ³¨å†Œ</strong></p><pre><code class="hljs shell">gitlab-runner register</code></pre><p><strong>è¾“å…¥Gitlabå®åœ°å€</strong></p><p>åœ°å€æ˜¯æ‰‹åŠ¨è®¾ç½®RunneråŒºåŸŸé‡Œé¢çš„URL</p><pre><code class="hljs awk">&gt; Please enter the gitlab-ci coordinator URL (e.g. https:<span class="hljs-regexp">//gi</span>tlab.com )http:<span class="hljs-regexp">//</span>xxx</code></pre><p><strong>è¾“å…¥token</strong></p><p>tokenæ˜¯æ‰‹åŠ¨è®¾ç½®RunneråŒºåŸŸé‡Œé¢çš„ä»¤ç‰Œ</p><pre><code class="hljs kotlin">&gt; Please enter the gitlab-ci token <span class="hljs-keyword">for</span> <span class="hljs-keyword">this</span> runnerxxx</code></pre><p><strong>è¾“å…¥Runnerçš„æè¿°</strong></p><p>Runnerçš„æè¿°ï¼Œåé¢å¯ä»¥åœ¨GitLabä¸­çš„UIä¸­è¿›è¡Œæ›´æ”¹ã€‚</p><pre><code class="hljs angelscript">&gt; Please enter the gitlab-ci description <span class="hljs-keyword">for</span> <span class="hljs-keyword">this</span> runner<span class="hljs-string">[hostname]</span> test-runner</code></pre><p><strong>è¾“å…¥ä¸Runnerå…³è”çš„æ ‡ç­¾</strong></p><p>æ ‡ç­¾æ˜¯ä¸ºäº†è®©åæœŸåœ¨CIè„šæœ¬ä¸­æŒ‡å®šé€‰æ‹©æŸä¸ªæˆ–è€…å¤šä¸ªRunnerï¼Œè¿™é‡Œè®¾ç½®æ ‡ç­¾ä¸º<code>test</code>ã€‚å½“ä½¿ç”¨è¿™ä¸ª Runneræ—¶ï¼Œåœ¨<code>.gitlab-ci.yml</code>çš„ tagå­—æ®µé‡Œä¹Ÿå¿…é¡»æ˜ç¡®æŒ‡æ˜è¿™äº› tags)ã€‚</p><pre><code class="hljs kotlin">&gt; Please enter the gitlab-ci tags <span class="hljs-keyword">for</span> <span class="hljs-keyword">this</span> runner (comma separated):test</code></pre><p><strong>è¾“å…¥Runnerçš„æ‰§è¡Œå™¨</strong></p><p>ç”±äºéƒ½æ˜¯åŸºäºDockerï¼Œæ‰€ä»¥è¿™é‡Œé€‰æ‹©æ‰§è¡Œå™¨ä¸ºDocker</p><pre><code class="hljs dockerfile">&gt; Please enter the executor: ssh, docker+machine, docker-ssh+machine, kubernetes, docker, parallels, virtualbox, docker-ssh, <span class="hljs-keyword">shell</span><span class="bash">:</span>docker</code></pre><p><strong>è®¾ç½®æ‰§è¡Œå™¨çš„ç‰ˆæœ¬</strong></p><p>é€‰æ‹©Dockerä½œä¸ºRunnerçš„executorï¼Œè¿˜éœ€è¦æŒ‡å®šä¸€ä¸ªé»˜è®¤çš„ åŸºç¡€é•œåƒ æ¥è¿è¡Œjob (è¿™ä¼šåœ¨<code>.gitlab-ci.yml</code>ä¸­æœªæŒ‡æ˜åŸºç¡€é•œåƒæ—¶ä½œä¸ºé»˜è®¤åŸºç¡€é•œåƒä½¿ç”¨)ï¼Œç½‘ä¸Šå¾ˆå¤šäººéƒ½é€‰çš„ <code>alpine:latest</code>ã€‚å¦‚æœè¿è¡Œjavaé¡¹ç›®ï¼Œå¯ä»¥é€‰jdkçš„é•œåƒã€‚</p><pre><code class="hljs less">&gt; <span class="hljs-selector-tag">Please</span> <span class="hljs-selector-tag">enter</span> <span class="hljs-selector-tag">the</span> <span class="hljs-selector-tag">Docker</span> <span class="hljs-selector-tag">image</span> (eg. <span class="hljs-attribute">ruby</span>:<span class="hljs-number">2.1</span>):<span class="hljs-selector-tag">alpine</span><span class="hljs-selector-pseudo">:latest</span></code></pre><p><strong>é€€å‡ºå®¹å™¨</strong></p><pre><code class="hljs awk"><span class="hljs-keyword">exit</span></code></pre><p>é€šè¿‡ä»¥ä¸Šå‘½ä»¤åï¼Œå°±åˆ›å»ºæˆåŠŸrunnerå•¦ã€‚è¿™æ—¶å€™å»GitLabä¸­åˆ›å»ºRunnerçš„åŒºåŸŸåˆ·æ–°å°±èƒ½çœ‹åˆ°äº†ã€‚</p><p><img src="/images/docker/runner-gitlab.png"></p><h6 id="ä¿®æ”¹é…ç½®æ–‡ä»¶-1"><a href="#ä¿®æ”¹é…ç½®æ–‡ä»¶-1" class="headerlink" title="ä¿®æ”¹é…ç½®æ–‡ä»¶"></a>ä¿®æ”¹é…ç½®æ–‡ä»¶</h6><pre><code class="hljs shell">vim /srv/gitlab-runner/config/config.toml</code></pre><p>æ‰¾åˆ°<code>volumes</code>é…ç½®ï¼Œä¿®æ”¹ç»“æœä¸ºå¦‚ä¸‹ï¼Œåˆ†åˆ«æ˜¯æŒ‚è½½äº†å®¿ä¸»æœºdockerçš„sockæ–‡ä»¶å’ŒMavençš„ç¼“å­˜ï¼Œå‡å°‘æ‹‰å–JaråŒ…çš„æ—¶é—´æ¶ˆè€—ï¼Œå…¶ä¸­<code>&quot;/data/.m2/:/.m2/&quot;</code>è¿™å—ä¸ºMavençš„JaråŒ…å­˜æ”¾åœ°å€ï¼Œå·¦è¾¹ä¸ºå®¿ä¸»æœºç›®å½•ï¼Œå³è¾¹ä¸ºå®¹å™¨å†…çš„JaråŒ…å­˜å‚¨è·¯å¾„ï¼Œè¿™ä¸ªéœ€è¦æ ¹æ®è‡ªå·±ä½¿ç”¨çš„Mavené•œåƒè€Œå®š</p><pre><code class="hljs shell">volumes = [&quot;/cache&quot;,&quot;/var/run/docker.sock:/var/run/docker.sock&quot;,&quot;/data/.m2/:/.m2/&quot;]</code></pre><p>åœ¨<code>volumes</code>é…ç½®ä¸‹æ–¹å¢åŠ ä¸€è¡Œé…ç½®ï¼Œé˜²æ­¢Runneré‡å¤æ‹‰å–é•œåƒ</p><pre><code class="hljs shell">pull_policy = &quot;if-not-present&quot;</code></pre><p>æœ€åé‡å¯Runner</p><pre><code class="hljs shell">docker restart gitlab-runner</code></pre><h5 id="éƒ¨ç½²harbor"><a href="#éƒ¨ç½²harbor" class="headerlink" title="éƒ¨ç½²harbor"></a>éƒ¨ç½²harbor</h5><h6 id="å®‰è£…æœ€æ–°çš„docker-compose"><a href="#å®‰è£…æœ€æ–°çš„docker-compose" class="headerlink" title="å®‰è£…æœ€æ–°çš„docker-compose"></a>å®‰è£…æœ€æ–°çš„docker-compose</h6><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> ä¸‹è½½</span>wget https://github.com/docker/compose/releases/download/1.28.6/docker-compose-Linux-x86_64<span class="hljs-meta">#</span><span class="bash"> ç§»åŠ¨åˆ°/usr/<span class="hljs-built_in">local</span>/bin</span>mv docker-compose-Linux-x86_64 /usr/local/bin<span class="hljs-meta">#</span><span class="bash"> æ”¹å</span>mv docker-compose-Linux-x86_64 docker-compose</code></pre><p>å°†å¯æ‰§è¡Œæƒé™ç”¨äºäºŒè¿›åˆ¶æ–‡ä»¶</p><pre><code class="hljs shell">sudo chmod +x /usr/local/bin/docker-compose</code></pre><h6 id="ä¸‹è½½Harbor"><a href="#ä¸‹è½½Harbor" class="headerlink" title="ä¸‹è½½Harbor"></a>ä¸‹è½½Harbor</h6><p><code>githubåœ°å€ï¼š</code><a href="https://github.com/vmware/harbor/releases/%60">https://github.com/vmware/harbor/releases/`</a></p><pre><code class="hljs shell">wget https://github.com/goharbor/harbor/releases/download/v2.2.1/harbor-online-installer-v2.2.1.tgz</code></pre><h6 id="é…ç½®Harbor"><a href="#é…ç½®Harbor" class="headerlink" title="é…ç½®Harbor"></a>é…ç½®Harbor</h6><p>è¿›å…¥Harboræ–‡ä»¶å¤¹ï¼Œæ‰¾åˆ°<code>harbor.yml</code>æ–‡ä»¶ï¼Œå¹¶é…ç½®</p><pre><code class="hljs yml"><span class="hljs-string">cd</span> <span class="hljs-string">/srv/harbor</span><span class="hljs-string">cp</span> <span class="hljs-string">harbor.yml.tmpl</span> <span class="hljs-string">harbor.yml</span><span class="hljs-string">vim</span> <span class="hljs-string">harbor.yml</span><span class="hljs-attr">hostname:</span> <span class="hljs-string">xx.xx.xx.xx</span>   <span class="hljs-comment"># éœ€è¦é…ç½®</span><span class="hljs-comment"># http related config</span><span class="hljs-attr">http:</span>  <span class="hljs-comment"># port for http, default is 80. If https enabled, this port will redirect to https port</span>  <span class="hljs-attr">port:</span> <span class="hljs-number">5000</span>      <span class="hljs-comment"># éœ€è¦é…ç½® ç¡®ä¿æœªå®‰è£…registryå®¹å™¨</span><span class="hljs-comment"># httpséœ€è¦æ³¨é‡Šæ‰</span><span class="hljs-comment"># https related config</span><span class="hljs-comment">#https:</span>  <span class="hljs-comment"># https port for harbor, default is 443</span>  <span class="hljs-comment"># port: 443</span>  <span class="hljs-comment"># The path of cert and key files for nginx</span>  <span class="hljs-comment"># certificate: /your/certificate/path</span>  <span class="hljs-comment"># private_key: /your/private/key/path</span></code></pre><h6 id="å¯åŠ¨"><a href="#å¯åŠ¨" class="headerlink" title="å¯åŠ¨"></a>å¯åŠ¨</h6><p>åœ¨harboræ–‡ä»¶å¤¹æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å¯åŠ¨harbor</p><pre><code class="hljs cmake">./<span class="hljs-keyword">install</span>.sh</code></pre><p>å¯åŠ¨å®Œæ¯•åæµè§ˆå™¨è®¿é—®<code>http://ä½ è®¾ç½®çš„IPæˆ–è€…åŸŸå:ä½ è®¾ç½®çš„ç«¯å£</code>ï¼Œè´¦å·é»˜è®¤ä¸ºï¼šadminï¼Œå¯†ç ï¼šHarbor12345ï¼Œç™»å½•åå°±è¿›å…¥äº†ä¸»é¡µ</p><p><img src="/images/docker/habor-container.png"></p><p><img src="/images/docker/habor.png"></p><h6 id="pushé•œåƒ"><a href="#pushé•œåƒ" class="headerlink" title="pushé•œåƒ"></a>pushé•œåƒ</h6><p><strong>ä¿®æ”¹ä¸‹é…ç½®</strong></p><p>ç”±äºdockerçš„ç‰ˆæœ¬ä»13å¼€å§‹ï¼Œregisteråªèƒ½ç”¨httpsï¼Œè¿™é‡Œé…ç½®çš„éƒ½æ˜¯httpçš„ï¼Œæ‰€ä»¥è¦å…ˆåœ¨<code>/etc/docker/</code>ç›®å½•åˆ›å»º<code>daemon.json</code>æ–‡ä»¶å¹¶åŠ å…¥å¦‚ä¸‹</p><pre><code class="hljs shell">&#123; &quot;insecure-registries&quot;:[&quot;xxx:5000&quot;] &#125;</code></pre><p>é‡å¯docker</p><pre><code class="hljs shell">systemctl restart docker</code></pre><p>é‡å¯harborç›¸å…³çš„å®¹å™¨ï¼Œå› ä¸ºé‡å¯dockeråè¿™äº›éƒ½å…³é—­äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬é€šè¿‡<code>docker ps -a</code>æ‰¾åˆ°æ‰€æœ‰ä¸harborç›¸å…³çš„é•œåƒï¼Œé€šè¿‡<code>docker restart xx xx xx</code>å¯¹åº”å®¹å™¨åé‡å¯å³å¯</p><h6 id="æŠ¥é”™äº‘é›†"><a href="#æŠ¥é”™äº‘é›†" class="headerlink" title="æŠ¥é”™äº‘é›†"></a>æŠ¥é”™äº‘é›†</h6><pre><code class="hljs shell">prepare base dir is set to /usr/local/harbordocker: Error response from daemon: OCI runtime create failed: container_linux.go:349: starting container process caused &quot;process_linux.go:449: container init caused \&quot;write /proc/self/attr/keycreate: permission denied\&quot;&quot;: unknown.Â <span class="hljs-meta">#</span><span class="bash"> è§£å†³åŠæ³•</span>æŠŠ/etc/selinuxä¸‹çš„configæ–‡ä»¶ä¸­çš„SELINUX=enforcingÂ  æ”¹ä¸ºÂ SELINUX=disabledÂ é‡åˆ°æŠ¥é”™ï¼šERROR:root:Please specify hostnameï¼Œ é‚£åŸå› æ˜¯å¯åŠ¨harboræ—¶æ²¡æœ‰ä¿®æ”¹harbor.ymlé‡Œçš„å†…å®¹ã€‚Â <span class="hljs-meta">#</span><span class="bash"> è§£å†³åŠæ³•</span>æŠŠé…ç½®æ–‡ä»¶ä¸­é»˜è®¤çš„hostname: reg.mydomain.comï¼Œ æ”¹ä¸ºæœ¬åœ°çš„ipã€‚Â æ¯”å¦‚ï¼š hostnameï¼šxx.xx.xx.xxÂ é‡åˆ°æŠ¥é”™ï¼šERROR:root:Error: The protocol is https but attribute ssl_cert is not setã€‚ åŸå› æ˜¯harbor.ymlä¸­é»˜è®¤æ˜¯é…ç½®httpsçš„ç«¯å£åŠè¯ä¹¦è·¯å¾„çš„ã€‚<span class="hljs-meta">#</span><span class="bash"> è§£å†³åŠæ³•</span>æŠŠè¿™äº›é…ç½®éƒ½æ³¨é‡Šæ‰ã€‚<span class="hljs-meta">#</span><span class="bash"> https related config</span><span class="hljs-meta">#</span><span class="bash"> https:</span><span class="hljs-meta">Â Â #</span><span class="bash"> https port <span class="hljs-keyword">for</span> harbor, default is 443</span><span class="hljs-meta">Â Â #</span><span class="bash"> port: 443</span><span class="hljs-meta">Â Â #</span><span class="bash"> The path of cert and key files <span class="hljs-keyword">for</span> nginx</span><span class="hljs-meta">Â Â #</span><span class="bash"> certificate: /your/certificate/path</span><span class="hljs-meta">Â Â #</span><span class="bash"> private_key: /your/private/key/path</span>Â ä¸Šè¿°é—®é¢˜éƒ½è§£å†³ï¼Œå¹¶ä¸”install.shæ­£ç¡®è¿è¡Œåï¼Œ ä¿¡æ¯å¦‚ä¸‹ï¼šâœ” ----Harbor has been installed and started successfully.----</code></pre><h5 id="éƒ¨ç½²RegistryæœåŠ¡å™¨"><a href="#éƒ¨ç½²RegistryæœåŠ¡å™¨" class="headerlink" title="éƒ¨ç½²RegistryæœåŠ¡å™¨"></a>éƒ¨ç½²RegistryæœåŠ¡å™¨</h5><blockquote><p>å¦‚æœéœ€è¦å®‰è£…haborï¼Œæœ€å¥½å°†Registryå®¹å™¨åœæ‰æˆ–è€… å®¹å™¨åä¸èƒ½ä¸ºregistry.</p></blockquote><p>Docker RegistryæœåŠ¡å™¨æ•´åˆå¾ˆå¤šæœåŠ¡ï¼Œé…ç½®çš„å‚æ•°éå¸¸å¤šï¼ŒåŒ…æ‹¬ï¼šå­˜å‚¨ï¼ŒRedisï¼ŒAuthï¼Œæ—¥å¿—ï¼Œä¸­é—´ä»¶ï¼Œç›‘æ§ï¼ŒHTTPï¼Œé€šçŸ¥ï¼Œå¥åº·æ£€æŸ¥ï¼Œä»£ç†ï¼Œå…¼å®¹æ€§ã€‚</p><p>éƒ¨ç½²æœåŠ¡å™¨éå¸¸ç®€å•ï¼Œåªéœ€è¦ä¸€æ¡å‘½ä»¤ï¼Œæ˜ å°„5000ç«¯å£åˆ°å®¹å™¨ï¼Œrestartæœºåˆ¶ä¸ºæ€»æ˜¯ï¼Œå¹¶åˆ†é…å½“å‰ç›®å½•ä¸‹çš„dataç›®å½•ä½œä¸ºå®¹å™¨å·ï¼Œå­˜å‚¨é•œåƒæ•°æ®ã€‚å¯ä»¥é…ç½®HTTPSæ–¹å¼çš„è®¿é—®ï¼Œå‚è€ƒDockerå®˜æ–¹æ–‡æ¡£ï¼Œå¦‚æœæ˜¯åœ¨å±€åŸŸç½‘å†…è®¿é—®è¿™ä¸ªæ–¹å¼å³å¯æ»¡è¶³éœ€æ±‚ã€‚</p><h6 id="éƒ¨ç½²"><a href="#éƒ¨ç½²" class="headerlink" title="éƒ¨ç½²"></a>éƒ¨ç½²</h6><pre><div class="caption"><span>shellÂ ell</span></div><code class="hljs sh">docker run -d \    -p 5000:5000 \    --restart always \    --name registry \    -e  REGISTRY_STORAGE_FILESYSTEM_ROOTDIRECTORY=/srv/registry \    -e REGISTRY_STORAGE_DELETE_ENABLED=<span class="hljs-literal">true</span> \    -v /srv/registry/data:/var/lib/registry \    registry:latest</code></pre><h6 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h6><p>ä»Dockerå®˜æ–¹çš„hubæ‹‰å–ubuntué•œåƒï¼Œè¿™æ˜¯ç®€å†™çš„æ–¹å¼ï¼Œå®Œæ•´çš„å‘½ä»¤æ˜¯è¿™æ ·çš„<code>docker pull docker.io/library/ubuntu</code>ï¼Œå¹¶å‘½åä¸º<code>localhost:5000/ubuntu</code>ã€‚</p><pre><code class="hljs bash">docker pull ubuntu &amp;&amp; docker tag ubuntu localhost:5000/ubuntu</code></pre><p>æ¨é€é•œåƒåˆ°æœ¬åœ°çš„RegistryæœåŠ¡å™¨</p><pre><code class="hljs bash">docker push localhost:5000/ubuntu</code></pre><p>åˆ é™¤å®¿ä¸»æœºçš„localhost:5000/ubuntuå¹¶æ‹‰å–RegistryæœåŠ¡å™¨çš„ubuntué•œåƒ</p><pre><code class="hljs bash">docker rmi -f localhost:5000/ubuntudocker pull localhost:5000/ubuntu</code></pre><h6 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h6><p>é…ç½®RegistryæœåŠ¡å™¨çš„æ–¹å¼æœ‰ä¸¤ç§ï¼Œä¸€ç§æ˜¯åœ¨è¿è¡Œå®¹å™¨æŒ‡å®šç¯å¢ƒå˜é‡é‡å†™é…ç½®æ–‡ä»¶ï¼Œå¦ä¸€ç§æ˜¯ç›´æ¥æ˜ å°„yamlé…ç½®æ–‡ä»¶ã€‚</p><p>ä½¿ç”¨é…ç½®æ–‡ä»¶çš„æ–¹å¼ï¼Œè¿ç§»æ–¹ä¾¿ã€‚</p><p><strong>ç¯å¢ƒå˜é‡é‡å†™é…ç½®é€‰é¡¹</strong></p><p>æ¯”å¦‚é‡å†™é…ç½®æ–‡ä»¶å­˜å‚¨é€‰é¡¹ï¼Œæ–‡ä»¶é…ç½®å¦‚ä¸‹æ‰€ç¤º</p><pre><code class="hljs yaml"><span class="hljs-attr">storage:</span>  <span class="hljs-attr">filesystem:</span>    <span class="hljs-attr">rootdirectory:</span> <span class="hljs-string">/var/lib/registry</span></code></pre><p>é‚£ä¹ˆè¿è¡ŒRegisteryå®¹å™¨æ—¶å°±éœ€è¦æŒ‡å®šç¯å¢ƒå˜é‡<code>REGISTRY_STORAGE_FILESYSTEM_ROOTDIRECTORY=/somewhere</code></p><pre><code class="hljs bash">docker run -d -p 5000:5000 --restart=always --name registry \  -v /srv/registry/data:/var/lib/registry \  -e  REGISTRY_STORAGE_FILESYSTEM_ROOTDIRECTORY=/srv/registry \  registry:2</code></pre><p><strong>è¦†ç›–é…ç½®æ–‡ä»¶</strong></p><p>å¯ä»¥ä½¿ç”¨æŒ‚è½½å·çš„æ–¹å¼è¦†ç›–é…ç½®</p><pre><code class="hljs bash">docker run -d -p 5000:5000 --restart=always --name registry \             -v /srv/registry:/etc/docker/registry \             registry:latest</code></pre><p>æŒ‚è½½å½“å‰ç›®å½•ä¸‹config.ymlè¦†ç›–å®¹å™¨çš„/etc/docker/registry/config.ymlæ–‡ä»¶ï¼Œä¸‹é¢æ˜¯æ•´ä¸ªé…ç½®æ–‡ä»¶</p><pre><code class="hljs yaml"><span class="hljs-attr">version:</span> <span class="hljs-number">0.1</span><span class="hljs-attr">log:</span> <span class="hljs-comment">## æ—¥å¿—é€‰é¡¹</span>  <span class="hljs-attr">level:</span> <span class="hljs-string">debug</span>  <span class="hljs-attr">formatter:</span> <span class="hljs-string">text</span>  <span class="hljs-attr">fields:</span>    <span class="hljs-attr">service:</span> <span class="hljs-string">registry</span>    <span class="hljs-attr">environment:</span> <span class="hljs-string">staging</span>  <span class="hljs-attr">hooks:</span>    <span class="hljs-bullet">-</span> <span class="hljs-attr">type:</span> <span class="hljs-string">mail</span>      <span class="hljs-attr">disabled:</span> <span class="hljs-literal">true</span>      <span class="hljs-attr">levels:</span>        <span class="hljs-bullet">-</span> <span class="hljs-string">panic</span>      <span class="hljs-attr">options:</span>        <span class="hljs-attr">smtp:</span> <span class="hljs-comment">## é‚®ä»¶é€šçŸ¥é…ç½®</span>          <span class="hljs-attr">addr:</span> <span class="hljs-string">mail.example.com:25</span>          <span class="hljs-attr">username:</span> <span class="hljs-string">mailuser</span>          <span class="hljs-attr">password:</span> <span class="hljs-string">password</span>          <span class="hljs-attr">insecure:</span> <span class="hljs-literal">true</span>        <span class="hljs-attr">from:</span> <span class="hljs-string">sender@example.com</span>        <span class="hljs-attr">to:</span>          <span class="hljs-bullet">-</span> <span class="hljs-string">errors@example.com</span><span class="hljs-attr">loglevel:</span> <span class="hljs-string">debug</span> <span class="hljs-comment"># å³å°†å¼ƒç”¨: ä½¿ç”¨Logæ›¿ä»£</span><span class="hljs-attr">storage:</span> <span class="hljs-comment">##å­˜å‚¨é€‰é¡¹ï¼Œ</span>  <span class="hljs-attr">filesystem:</span> <span class="hljs-comment">## æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿï¼Œä¹Ÿå¯ä»¥æ˜¯äº‘åˆ†å¸ƒå¼å­˜å‚¨ï¼Œæ¯”å¦‚å¾®è½¯Azureï¼Œäºšé©¬é€ŠS3ï¼Œswiftï¼ŒOSS</span>    <span class="hljs-attr">rootdirectory:</span> <span class="hljs-string">/var/lib/registry</span>    <span class="hljs-attr">maxthreads:</span> <span class="hljs-number">100</span> <span class="hljs-comment">##æœ€å¤§çº¿ç¨‹æ•°</span><span class="hljs-attr">auth:</span> <span class="hljs-comment">#ç”¨æˆ·éªŒè¯</span>  <span class="hljs-attr">silly:</span>    <span class="hljs-attr">realm:</span> <span class="hljs-string">silly-realm</span>    <span class="hljs-attr">service:</span> <span class="hljs-string">silly-service</span>  <span class="hljs-attr">token:</span>    <span class="hljs-attr">realm:</span> <span class="hljs-string">token-realm</span>    <span class="hljs-attr">service:</span> <span class="hljs-string">token-service</span>    <span class="hljs-attr">issuer:</span> <span class="hljs-string">registry-token-issuer</span>    <span class="hljs-attr">rootcertbundle:</span> <span class="hljs-string">/root/certs/bundle</span>  <span class="hljs-attr">htpasswd:</span>    <span class="hljs-attr">realm:</span> <span class="hljs-string">basic-realm</span>    <span class="hljs-attr">path:</span> <span class="hljs-string">/path/to/htpasswd</span><span class="hljs-attr">middleware:</span> <span class="hljs-comment">##ä¸­é—´ä»¶ç±»å‹æœ‰registryï¼Œrepositoryï¼Œstorageä¸‰ç§ï¼Œæ¯ç§ä¸­é—´ä»¶å¯ä»¥åƒä¸‹é¢çš„æ–¹å¼ä½¿ç”¨</span>  <span class="hljs-attr">registry:</span>    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">ARegistryMiddleware</span>      <span class="hljs-attr">options:</span>        <span class="hljs-attr">foo:</span> <span class="hljs-string">bar</span>  <span class="hljs-attr">storage:</span>    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">ARegistryMiddleware</span><span class="hljs-attr">reporting:</span> <span class="hljs-comment">##ç›‘æ§ï¼Œå¯ä»¥ä½¿ç”¨ä¸€äº›åœ¨çº¿çš„ç›‘æ§å·¥å…·åŒ…æ‹¬bugsnagï¼Œnewrelic</span>  <span class="hljs-attr">newrelic:</span>    <span class="hljs-attr">licensekey:</span> <span class="hljs-string">newreliclicensekey</span>    <span class="hljs-attr">name:</span> <span class="hljs-string">newrelicname</span>    <span class="hljs-attr">verbose:</span> <span class="hljs-literal">true</span><span class="hljs-attr">http:</span> <span class="hljs-comment">## ç”±Nginxæä¾›çš„HTTPæœåŠ¡ï¼Œå¯ä»¥æŠŠå®ƒç†è§£æˆé…ç½®Nginx</span>  <span class="hljs-attr">addr:</span> <span class="hljs-string">localhost:5000</span>  <span class="hljs-attr">prefix:</span> <span class="hljs-string">/my/nested/registry/</span>  <span class="hljs-attr">host:</span> <span class="hljs-string">https://myregistryaddress.org:5000</span>  <span class="hljs-attr">secret:</span> <span class="hljs-string">asecretforlocaldevelopment</span>  <span class="hljs-attr">relativeurls:</span> <span class="hljs-literal">false</span>  <span class="hljs-attr">tls:</span>    <span class="hljs-attr">certificate:</span> <span class="hljs-string">/path/to/x509/public</span>    <span class="hljs-attr">key:</span> <span class="hljs-string">/path/to/x509/private</span>    <span class="hljs-attr">clientcas:</span>      <span class="hljs-bullet">-</span> <span class="hljs-string">/path/to/ca.pem</span>      <span class="hljs-bullet">-</span> <span class="hljs-string">/path/to/another/ca.pem</span>    <span class="hljs-attr">letsencrypt:</span>      <span class="hljs-attr">cachefile:</span> <span class="hljs-string">/path/to/cache-file</span>      <span class="hljs-attr">email:</span> <span class="hljs-string">emailused@letsencrypt.com</span>  <span class="hljs-attr">debug:</span>    <span class="hljs-attr">addr:</span> <span class="hljs-string">localhost:5001</span>  <span class="hljs-attr">headers:</span>    <span class="hljs-attr">X-Content-Type-Options:</span> [<span class="hljs-string">nosniff</span>]<span class="hljs-attr">notifications:</span> <span class="hljs-comment">## äº‹ä»¶é€šçŸ¥ï¼Œå½“RegistryæœåŠ¡å™¨å‘ç”Ÿæ‹‰å–ï¼Œæ¨é€ç­‰æ—¶å‘é€äº‹ä»¶åˆ°endpoints</span>  <span class="hljs-attr">endpoints:</span>    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">alistener</span>      <span class="hljs-attr">disabled:</span> <span class="hljs-literal">false</span>      <span class="hljs-attr">url:</span> <span class="hljs-string">https://my.listener.com/event</span>      <span class="hljs-attr">headers:</span> <span class="hljs-string">&lt;http.Header&gt;</span>      <span class="hljs-attr">timeout:</span> <span class="hljs-number">500</span>      <span class="hljs-attr">threshold:</span> <span class="hljs-number">5</span>      <span class="hljs-attr">backoff:</span> <span class="hljs-number">1000</span><span class="hljs-attr">redis:</span> <span class="hljs-comment">##è¿™ä¸ªç”¨è¿‡çš„éƒ½æ‡‚</span>  <span class="hljs-attr">addr:</span> <span class="hljs-string">localhost:6379</span>  <span class="hljs-attr">password:</span> <span class="hljs-string">asecret</span>  <span class="hljs-attr">db:</span> <span class="hljs-number">0</span>  <span class="hljs-attr">dialtimeout:</span> <span class="hljs-string">10ms</span>  <span class="hljs-attr">readtimeout:</span> <span class="hljs-string">10ms</span>  <span class="hljs-attr">writetimeout:</span> <span class="hljs-string">10ms</span>  <span class="hljs-attr">pool:</span>    <span class="hljs-attr">maxidle:</span> <span class="hljs-number">16</span>    <span class="hljs-attr">maxactive:</span> <span class="hljs-number">64</span>    <span class="hljs-attr">idletimeout:</span> <span class="hljs-string">300s</span><span class="hljs-attr">health:</span> <span class="hljs-comment">## å¥åº·æ£€æŸ¥åŒ…æ‹¬å­˜å‚¨é©±åŠ¨ï¼Œfileï¼ŒhttpæœåŠ¡ï¼Œtcpçš„å¯ç”¨æ€§æ£€æŸ¥</span>  <span class="hljs-attr">storagedriver:</span>    <span class="hljs-attr">enabled:</span> <span class="hljs-literal">true</span>    <span class="hljs-attr">interval:</span> <span class="hljs-string">10s</span>    <span class="hljs-attr">threshold:</span> <span class="hljs-number">3</span>  <span class="hljs-attr">file:</span>    <span class="hljs-bullet">-</span> <span class="hljs-attr">file:</span> <span class="hljs-string">/path/to/checked/file</span>      <span class="hljs-attr">interval:</span> <span class="hljs-string">10s</span>  <span class="hljs-attr">http:</span>    <span class="hljs-bullet">-</span> <span class="hljs-attr">uri:</span> <span class="hljs-string">http://server.to.check/must/return/200</span>      <span class="hljs-attr">headers:</span>        <span class="hljs-attr">Authorization:</span> [<span class="hljs-string">Basic</span> <span class="hljs-string">QWxhZGRpbjpvcGVuIHNlc2FtZQ==</span>]      <span class="hljs-attr">statuscode:</span> <span class="hljs-number">200</span>      <span class="hljs-attr">timeout:</span> <span class="hljs-string">3s</span>      <span class="hljs-attr">interval:</span> <span class="hljs-string">10s</span>      <span class="hljs-attr">threshold:</span> <span class="hljs-number">3</span>  <span class="hljs-attr">tcp:</span>    <span class="hljs-bullet">-</span> <span class="hljs-attr">addr:</span> <span class="hljs-string">redis-server.domain.com:6379</span>      <span class="hljs-attr">timeout:</span> <span class="hljs-string">3s</span>      <span class="hljs-attr">interval:</span> <span class="hljs-string">10s</span>      <span class="hljs-attr">threshold:</span> <span class="hljs-number">3</span><span class="hljs-attr">proxy:</span> <span class="hljs-comment">## å¯ä»¥é•œåƒDocker Hubçš„ä»“åº“</span>  <span class="hljs-attr">remoteurl:</span> <span class="hljs-string">https://registry-1.docker.io</span>  <span class="hljs-attr">username:</span> [<span class="hljs-string">username</span>]  <span class="hljs-attr">password:</span> [<span class="hljs-string">password</span>]<span class="hljs-attr">compatibility:</span>   <span class="hljs-attr">schema1:</span>    <span class="hljs-attr">signingkeyfile:</span> <span class="hljs-string">/etc/registry/key.json</span></code></pre><h5 id="Gitlab-ci-yml"><a href="#Gitlab-ci-yml" class="headerlink" title="Gitlab-ci.yml"></a>Gitlab-ci.yml</h5><pre><code class="hljs yml"><span class="hljs-comment"># å®šä¹‰å…¨å±€å˜é‡</span><span class="hljs-attr">variables:</span>  <span class="hljs-attr">PROJECT:</span> <span class="hljs-string">&quot;offer&quot;</span>  <span class="hljs-comment"># è¿™é‡Œå®šä¹‰äº†Mavençš„jaråŒ…å­˜æ”¾åœ°å€ï¼Œä¸æˆ‘ä»¬æ„å»ºmavenç§æœçš„æ—¶å€™è®¾ç½®çš„å­˜æ”¾åœ°å€ä¸€è‡´</span>  <span class="hljs-attr">MAVEN_REPO:</span> <span class="hljs-string">&quot;/.m2&quot;</span>  <span class="hljs-attr">CI_REGISTRY_USER:</span> <span class="hljs-string">&quot;xxx&quot;</span>  <span class="hljs-attr">CI_REGISTRY_PASSWORD:</span> <span class="hljs-string">&quot;xxx&quot;</span>  <span class="hljs-comment"># ä»“åº“åœ°å€</span>  <span class="hljs-attr">CI_REGISTRY:</span> <span class="hljs-string">&quot;xx.xx.xx.xx:5000/&quot;</span>  <span class="hljs-comment"># é•œåƒå…¨ç§°</span>  <span class="hljs-attr">CI_REGISTRY_IMAGE:</span> <span class="hljs-string">&quot;mlja/offer&quot;</span>  <span class="hljs-attr">CI_COMMIT_REF_SLUG:</span> <span class="hljs-string">&quot;&quot;</span>  <span class="hljs-attr">CI_COMMIT_SHA:</span> <span class="hljs-string">&quot;&quot;</span>  <span class="hljs-comment"># å…¨å±€è„šæœ¬ï¼Œä¼šè¿è¡Œåœ¨å„ä¸ªé˜¶æ®µçš„scriptå‰ï¼Œå¦‚æœæŸä¸ªé˜¶æ®µé‡Œé¢å­˜åœ¨before_scriptï¼Œé‚£ä¹ˆä»¥é‚£ä¸ªé˜¶æ®µé‡Œçš„ä¸ºä¸»</span><span class="hljs-attr">before_script:</span>  <span class="hljs-comment"># è¿™é‡Œå®šä¹‰äº†æ‰“åŒ…æˆåŠŸåçš„Dockeré•œåƒåç§°ï¼Œæ¯ä¸€æ¬¡æäº¤ä»£ç åæ„å»ºæˆåŠŸçš„é•œåƒåç§°éƒ½æ˜¯å”¯ä¸€çš„</span>  <span class="hljs-bullet">-</span> <span class="hljs-string">export</span> <span class="hljs-string">IMAGE_FULL_NAME=$&#123;CI_REGISTRY_IMAGE&#125;:$&#123;CI_COMMIT_REF_SLUG&#125;-$&#123;CI_COMMIT_SHA&#125;</span><span class="hljs-comment"># å®šä¹‰CIæ‰§è¡Œçš„é˜¶æ®µï¼Œè¿™é‡Œå¯ä»¥è‡ªå·±æ ¹æ®æƒ…å†µå®šä¹‰å¤šå°‘ä¸ªé˜¶æ®µ</span><span class="hljs-attr">stages:</span>  <span class="hljs-bullet">-</span> <span class="hljs-string">compile</span>  <span class="hljs-bullet">-</span> <span class="hljs-string">build</span>  <span class="hljs-bullet">-</span> <span class="hljs-string">run</span><span class="hljs-comment"># ç¼–è¯‘:</span><span class="hljs-attr">compile:</span>  <span class="hljs-comment"># å½“å‰é˜¶æ®µçš„æ‰§è¡Œé•œåƒï¼Œè¿™æ˜¯è‡ªå·±æ„å»ºçš„é•œåƒ</span>  <span class="hljs-attr">image:</span> <span class="hljs-string">xx.xx.xx.xx:5000/root/maven:latest</span>  <span class="hljs-comment"># å±äºä¸Šé¢å®šä¹‰çš„å“ªä¸€ä¸ªé˜¶æ®µ</span>  <span class="hljs-attr">stage:</span> <span class="hljs-string">compile</span>  <span class="hljs-comment"># æ˜¯å¦å…è®¸å¤±è´¥ï¼Œå…è®¸çš„è¯å¦‚æœå½“å‰é˜¶æ®µè¿è¡Œå¤±è´¥è¿˜ä¼šç»§ç»­æ‰§è¡Œä¸‹ä¸€ä¸ªé˜¶æ®µ</span>  <span class="hljs-attr">allow_failure:</span> <span class="hljs-literal">true</span>  <span class="hljs-comment"># åªåœ¨å“ªä¸ªåˆ†æ”¯ç”Ÿæ•ˆ</span>  <span class="hljs-attr">only:</span>    <span class="hljs-bullet">-</span> <span class="hljs-string">master</span>  <span class="hljs-comment"># è¿™é‡Œå°±æ˜¯è¦é€‰æ‹©å“ªä¸ªrunneræ¥æ‰§è¡Œäº†ï¼Œå¡«å†™åˆ›å»ºrunneræ—¶å€™æŒ‡å®šçš„æ ‡ç­¾</span>  <span class="hljs-attr">tags:</span>    <span class="hljs-bullet">-</span> <span class="hljs-string">test</span>  <span class="hljs-comment"># è¿è¡Œè„šæœ¬</span>  <span class="hljs-attr">script:</span>    <span class="hljs-bullet">-</span> <span class="hljs-string">mvn</span> <span class="hljs-string">-Dmaven.repo.local=$MAVEN_REPO</span> <span class="hljs-string">clean</span> <span class="hljs-string">package</span> <span class="hljs-string">-Dmaven.test.skip=true</span>  <span class="hljs-comment"># å› ä¸ºæ˜¯Mavenç¼–è¯‘ï¼Œæ‰€ä»¥ä¼šæœ‰JaråŒ…äº§ç‰©ï¼Œè¿™é‡Œå®šä¹‰äº§ç‰©çš„è¿‡æœŸæ—¶é—´</span>  <span class="hljs-attr">artifacts:</span>    <span class="hljs-attr">name:</span> <span class="hljs-string">$PROJECT</span>    <span class="hljs-attr">expire_in:</span> <span class="hljs-number">7</span> <span class="hljs-string">days</span>    <span class="hljs-attr">paths:</span>      <span class="hljs-bullet">-</span> <span class="hljs-string">target/*.jar</span><span class="hljs-comment"># æ„å»ºé•œåƒ:</span><span class="hljs-attr">build:</span>  <span class="hljs-attr">image:</span> <span class="hljs-string">docker:stable</span>  <span class="hljs-attr">stage:</span> <span class="hljs-string">build</span>  <span class="hljs-attr">script:</span>    <span class="hljs-comment"># è¿™é‡Œçš„å˜é‡ä¼šè‡ªåŠ¨è·å–ä½ å½“å‰æ¨é€ä»£ç çš„gitlabç”¨æˆ·å’Œå¯†ç ä»¥åŠä»“åº“åœ°å€</span>    <span class="hljs-bullet">-</span> <span class="hljs-string">docker</span> <span class="hljs-string">login</span> <span class="hljs-string">--username</span> <span class="hljs-string">$CI_REGISTRY_USER</span> <span class="hljs-string">--password</span> <span class="hljs-string">$CI_REGISTRY_PASSWORD</span> <span class="hljs-string">$CI_REGISTRY</span>    <span class="hljs-comment"># è¿™é‡Œçš„å˜é‡å°±æ˜¯æˆ‘ä»¬å…¨å±€é…ç½®å®šä¹‰çš„äº†</span>    <span class="hljs-bullet">-</span> <span class="hljs-string">docker</span> <span class="hljs-string">build</span> <span class="hljs-string">-t</span> <span class="hljs-string">$IMAGE_FULL_NAME</span> <span class="hljs-string">.</span>    <span class="hljs-bullet">-</span> <span class="hljs-string">docker</span> <span class="hljs-string">push</span> <span class="hljs-string">$IMAGE_FULL_NAME</span>    <span class="hljs-bullet">-</span> <span class="hljs-string">rm</span> <span class="hljs-string">-rf</span> <span class="hljs-string">target</span>    <span class="hljs-bullet">-</span> <span class="hljs-string">docker</span> <span class="hljs-string">rmi</span> <span class="hljs-string">$IMAGE_FULL_NAME</span>  <span class="hljs-attr">only:</span>    <span class="hljs-bullet">-</span> <span class="hljs-string">master</span>  <span class="hljs-attr">tags:</span>    <span class="hljs-bullet">-</span> <span class="hljs-string">test</span><span class="hljs-comment"># è¿è¡Œ:</span><span class="hljs-attr">run:</span>  <span class="hljs-attr">image:</span> <span class="hljs-string">docker:stable</span>  <span class="hljs-attr">stage:</span> <span class="hljs-string">run</span>  <span class="hljs-attr">script:</span>    <span class="hljs-bullet">-</span> <span class="hljs-string">docker</span> <span class="hljs-string">run</span> <span class="hljs-string">-d</span> <span class="hljs-string">--name</span> <span class="hljs-string">$PROJECT</span> <span class="hljs-string">-p</span> <span class="hljs-number">7777</span><span class="hljs-string">:7777</span> <span class="hljs-string">$IMAGE_FULL_NAME</span>  <span class="hljs-attr">only:</span>    <span class="hljs-bullet">-</span> <span class="hljs-string">master</span>  <span class="hljs-attr">tags:</span>    <span class="hljs-bullet">-</span> <span class="hljs-string">test</span></code></pre><h5 id="éƒ¨ç½²jenkins"><a href="#éƒ¨ç½²jenkins" class="headerlink" title="éƒ¨ç½²jenkins"></a><strong>éƒ¨ç½²jenkins</strong></h5><pre><code class="hljs shell">mkdir -p /srv/jenkinschown -R 1000:1000 /srv/jenkins/docker pull jenkins/jenkins:alpinedocker inspect jenkins/jenkins:alpinedocker run --detach \    --publish 8080:8080 --publish 50000:50000 \    --restart unless-stopped \    --name jenkins \    --volume /srv/jenkins:/var/jenkins_home \    jenkins/jenkins:alpine</code></pre><h5 id="éƒ¨ç½²RabbitMQ"><a href="#éƒ¨ç½²RabbitMQ" class="headerlink" title="éƒ¨ç½²RabbitMQ"></a><strong>éƒ¨ç½²RabbitMQ</strong></h5><p>è·å–æŸ¥è¯¢çš„é•œåƒ </p><pre><code class="hljs shell">docker search rabbitmq:management</code></pre><p><img src="/images/docker/15.png"></p><p>æ‹‰å–é•œåƒ </p><pre><code class="hljs shell">docker pull rabbitmq:management</code></pre><p><img src="/images/docker/16.png"></p><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> è¿è¡Œé•œåƒ    </span>docker run -d \    -p 5672:5672 -p 15672:15672 \    --restart=always \    --name rabbitmq \    -v `pwd`/data:/var/lib/rabbitmq \    -e RABBITMQ_DEFAULT_USER=admin -e RABBITMQ_DEFAULT_PASS=2018251 \     rabbitmq:management</code></pre><pre><code class="hljs shell">docker run \-p 6379:6379 \--name myredis \-v /weitrue/install/redis/redis.conf:/etc/redis/redis.conf  \-v /weitrue/install/redis/data:/data \-d redis redis-server /etc/redis/redis.conf \--appendonly yes</code></pre>]]></content>
    
    
    <categories>
      
      <category>Develop</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Docker</tag>
      
      <tag>Linux</tag>
      
      <tag>Center OS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€Macã€‘Macä½¿ç”¨</title>
    <link href="/2020/06/22/mac/"/>
    <url>/2020/06/22/mac/</url>
    
    <content type="html"><![CDATA[<blockquote><p>åŸºäºXNU<a href="https://baike.baidu.com/item/%E6%B7%B7%E5%90%88%E5%86%85%E6%A0%B8/4239577">æ··åˆå†…æ ¸</a>çš„é¦–ä¸ªåœ¨å•†ç”¨é¢†åŸŸæˆåŠŸçš„<a href="https://baike.baidu.com/item/%E5%9B%BE%E5%BD%A2%E7%94%A8%E6%88%B7%E7%95%8C%E9%9D%A2/3352324">å›¾å½¢ç”¨æˆ·ç•Œé¢</a>æ“ä½œç³»ç»Ÿï¼Œå¹¶ä¸”å¾ˆå°‘å—åˆ°ç”µè„‘ç—…æ¯’çš„è¢­å‡»ã€‚<a id="more"></a> </p></blockquote><h3 id="Homebrew"><a href="#Homebrew" class="headerlink" title="Homebrew"></a>Homebrew</h3><h4 id="å®˜ç½‘"><a href="#å®˜ç½‘" class="headerlink" title="å®˜ç½‘:"></a>å®˜ç½‘:</h4><p><a href="https://docs.brew.sh/Installation.html">https://docs.brew.sh/Installation.html</a></p><h4 id="gihubæº"><a href="#gihubæº" class="headerlink" title="gihubæº"></a>gihubæº</h4><p><a href="https://github.com/Homebrew/install">https://github.com/Homebrew/install</a></p><h4 id="homebrewå®‰è£…"><a href="#homebrewå®‰è£…" class="headerlink" title="homebrewå®‰è£…"></a>homebrewå®‰è£…</h4><pre><code class="hljs awk"><span class="hljs-regexp">/usr/</span>bin<span class="hljs-regexp">/ruby -e &quot;$(curl -fsSL https:/</span><span class="hljs-regexp">/raw.githubusercontent.com/</span>Homebrew<span class="hljs-regexp">/install/m</span>aster/install)<span class="hljs-string">&quot;</span></code></pre><p>å¯èƒ½ä¼šå‡ºç°æŠ¥é”™</p><pre><code class="hljs routeros">curl: (7) Failed <span class="hljs-keyword">to</span> connect <span class="hljs-keyword">to</span> raw.githubusercontent.com<span class="hljs-built_in"> port </span>443:<span class="hljs-built_in"> Connection </span>refused</code></pre><p>æ ¹æ®æç¤ºå¯ä»¥çŸ¥é“è¢«raw.githubusercontent.comæ‹’ç»è®¿é—®ï¼Œæ‰“å¼€æµè§ˆå™¨è®¿é—®<a href="https://raw.githubusercontent.comä¹Ÿæ˜¯å¤±è´¥çš„,æ‰€ä»¥æ­¤æ—¶æ˜¯ç”µè„‘ä¸https//raw.githubusercontent.com%E7%9A%84%E8%BF%9E%E6%8E%A5%E9%97%AE%E9%A2%98%EF%BC%9A%E5%8F%AF%E4%BB%A5%E8%80%83%E8%99%91ruby%E7%9A%84%E6%9B%B4%E6%96%B0%E6%BA%90">https://raw.githubusercontent.comä¹Ÿæ˜¯å¤±è´¥çš„ï¼Œæ‰€ä»¥æ­¤æ—¶æ˜¯ç”µè„‘ä¸https://raw.githubusercontent.comçš„è¿æ¥é—®é¢˜ï¼šå¯ä»¥è€ƒè™‘rubyçš„æ›´æ–°æº</a></p><pre><code class="hljs shell">æŸ¥çœ‹å½“å‰æ›´æ–°æºgem sources -l                // é»˜è®¤æƒ…å†µä¸‹ä¼šæ˜¾ç¤ºhttps://rubygems.org/ è¯¥rubyæºåœ¨å¢™å†…ï¼Œå¾ˆå¤šå†…å®¹æ— æ³•è®¿é—®åˆ°gem source -a https://gems.ruby-china.com    // æ›´æ–°æ›´æ–°æºä¸ºhttps://gems.ruby-china.comgem sources --remove https://rubygems.org/   // åˆ é™¤åŸæ›´æ–°æºgem sources -l      ã€€ã€€ã€€ã€€ã€€ã€€               // æ£€æµ‹æ˜¯å¦æˆåŠŸ</code></pre><p>ç»§ç»­å®‰è£…</p><p><img src="/images/mac/clipboard.png" alt="img"></p><p><code>brew -v</code>æ£€æŸ¥æ˜¯å¦å·²å®‰è£…æˆåŠŸ</p><pre><code class="hljs shell">Homebrew 2.4.0 Homebrew/homebrew-core (git revision c948b; last commit 2020-06-13)</code></pre><h4 id="åŸºæœ¬ç”¨æ³•"><a href="#åŸºæœ¬ç”¨æ³•" class="headerlink" title="åŸºæœ¬ç”¨æ³•"></a>åŸºæœ¬ç”¨æ³•</h4><p>åŸºäºbrewå®‰è£…çš„æ‰€æœ‰è½¯ä»¶åŠå…¶ä¾èµ–å‡ä¼šå®‰è£…åˆ°ç›®å½•<code>/usr/local/Cellar</code></p><h5 id="Brew-å¸®åŠ©ä¿¡æ¯"><a href="#Brew-å¸®åŠ©ä¿¡æ¯" class="headerlink" title="Brew å¸®åŠ©ä¿¡æ¯"></a>Brew å¸®åŠ©ä¿¡æ¯</h5><pre><code class="hljs properties"><span class="hljs-meta">$</span> <span class="hljs-string">brew help</span><span class="hljs-attr">Example</span> <span class="hljs-string">usage:</span>  <span class="hljs-attr">brew</span> <span class="hljs-string">search [TEXT|/REGEX/]</span>  <span class="hljs-attr">brew</span> <span class="hljs-string">info [FORMULA...]</span>  <span class="hljs-attr">brew</span> <span class="hljs-string">install FORMULA...</span>  <span class="hljs-attr">brew</span> <span class="hljs-string">update</span>  <span class="hljs-attr">brew</span> <span class="hljs-string">upgrade [FORMULA...]</span>  <span class="hljs-attr">brew</span> <span class="hljs-string">uninstall FORMULA...</span>  <span class="hljs-attr">brew</span> <span class="hljs-string">list [FORMULA...]</span><span class="hljs-attr">Troubleshooting</span>:<span class="hljs-string"></span>  <span class="hljs-attr">brew</span> <span class="hljs-string">config</span>  <span class="hljs-attr">brew</span> <span class="hljs-string">doctor</span>  <span class="hljs-attr">brew</span> <span class="hljs-string">install --verbose --debug FORMULA</span><span class="hljs-attr">Contributing</span>:<span class="hljs-string"></span>  <span class="hljs-attr">brew</span> <span class="hljs-string">create [URL [--no-fetch]]</span>  <span class="hljs-attr">brew</span> <span class="hljs-string">edit [FORMULA...]</span><span class="hljs-attr">Further</span> <span class="hljs-string">help:</span>  <span class="hljs-attr">brew</span> <span class="hljs-string">commands</span>  <span class="hljs-attr">brew</span> <span class="hljs-string">help [COMMAND]</span>  <span class="hljs-attr">man</span> <span class="hljs-string">brew</span>  <span class="hljs-attr">https</span>:<span class="hljs-string">//docs.brew.sh</span></code></pre><h5 id="å­å‘½ä»¤å¸®åŠ©ä¿¡æ¯"><a href="#å­å‘½ä»¤å¸®åŠ©ä¿¡æ¯" class="headerlink" title="å­å‘½ä»¤å¸®åŠ©ä¿¡æ¯"></a>å­å‘½ä»¤å¸®åŠ©ä¿¡æ¯</h5><p><code>brew help [COMMAND]æˆ–brew [COMMAND] -h</code> ç”¨äºæŸ¥çœ‹å…·ä½“æŸä¸ªå­å‘½ä»¤çš„å¸®åŠ©ä¿¡æ¯ã€‚</p><p>ä¾‹å¦‚ï¼ŒæŸ¥çœ‹<code>install</code>å‘½ä»¤çš„å¸®åŠ©è¯¦æƒ…ï¼š</p><pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> brew install -h</span>Usage: brew install [options] formulaInstall formula. Additional options specific to formula may be appended tothe command.Unless HOMEBREW_NO_INSTALL_CLEANUP is set, brew cleanup will then be run forthe installed formulae or, every 30 days, for all formulae.    -d, --debug                      If brewing fails, open an interactive                                     debugging session with access to IRB or a                                     shell inside the temporary build directory.        --env                        If std is passed, use the standard build                                     environment instead of superenv. If super                                     is passed, use superenv even if the formula                                     specifies the standard build environment.        --ignore-dependencies        An unsupported Homebrew development flag to                                     skip installing any dependencies of any                                     kind. If the dependencies are not already                                     present, the formula will have issues. If                                     you&#x27;re not developing Homebrew, consider                                     adjusting your PATH rather than using this                                     flag.        --only-dependencies          Install the dependencies with specified                                     options but do not install the formula                                     itself.        --cc                         Attempt to compile using the specified                                     compiler, which should be the name of the                                     compiler&#x27;s executable, e.g. gcc-7 for GCC                                     7. In order to use LLVM&#x27;s clang, specify                                     llvm_clang. To use the Apple-provided                                     clang, specify clang. This option will                                     only accept compilers that are provided by                                     Homebrew or bundled with macOS. Please do                                     not file issues if you encounter errors                                     while using this option.    -s, --build-from-source          Compile formula from source even if a                                     bottle is provided. Dependencies will still                                     be installed from bottles if they are                                     available.        --force-bottle               Install from a bottle if it exists for the                                     current or newest version of macOS, even if                                     it would not normally be used for                                     installation.        --include-test               Install testing dependencies required to                                     run brew test formula.        --devel                      If formula defines it, install the                                     development version.        --HEAD                       If formula defines it, install the HEAD                                     version, aka. master, trunk, unstable.        --fetch-HEAD                 Fetch the upstream repository to detect if                                     the HEAD installation of the formula is                                     outdated. Otherwise, the repository&#x27;s HEAD                                     will only be checked for updates when a new                                     stable or development version has been                                     released.        --keep-tmp                   Retain the temporary files created during                                     installation.        --build-bottle               Prepare the formula for eventual bottling                                     during installation, skipping any                                     post-install steps.        --bottle-arch                Optimise bottles for the specified                                     architecture rather than the oldest                                     architecture supported by the version of                                     macOS the bottles are built on.    -f, --force                      Install without checking for previously                                     installed keg-only or non-migrated                                     versions.    -v, --verbose                    Print the verification and postinstall                                     steps.        --display-times              Print install times for each formula at the                                     end of the run.    -i, --interactive                Download and patch formula, then open a                                     shell. This allows the user to run                                     ./configure --help and otherwise                                     determine how to turn the software package                                     into a Homebrew package.    -g, --git                        Create a Git repository, useful for                                     creating patches to the software.    -h, --help                       Show this message.</code></pre><h5 id="æœç´¢è½¯ä»¶"><a href="#æœç´¢è½¯ä»¶" class="headerlink" title="æœç´¢è½¯ä»¶"></a>æœç´¢è½¯ä»¶</h5><p> <code>brew search [TEXT|/REGEX/]</code> ç”¨äºæœç´¢è½¯ä»¶ï¼Œæ”¯æŒä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼è¿›è¡Œå¤æ‚çš„æœç´¢ã€‚</p><p>ä¾‹å¦‚ï¼ŒæŸ¥è¯¢é™æ€åšå®¢ç”Ÿæˆå·¥å…·hugoï¼š</p><pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> brew search hugo</span>==&gt; Formulaehugo</code></pre><h5 id="æŸ¥çœ‹è½¯ä»¶ä¿¡æ¯"><a href="#æŸ¥çœ‹è½¯ä»¶ä¿¡æ¯" class="headerlink" title="æŸ¥çœ‹è½¯ä»¶ä¿¡æ¯"></a>æŸ¥çœ‹è½¯ä»¶ä¿¡æ¯</h5><p> <code>brew info [FORMULA...]</code> ç”¨äºæŸ¥è¯¢è½¯ä»¶çš„è¯¦ç»†ä¿¡æ¯ã€‚</p><p>ä¾‹å¦‚ï¼ŒæŸ¥çœ‹è½¯ä»¶hugoçš„è¯¦ç»†ä¿¡æ¯ï¼š</p><pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> brew search hugo</span>==&gt; Formulaehugo<span class="hljs-meta">$</span><span class="bash"> brew info hugo</span>hugo: stable 0.72.0 (bottled), HEADConfigurable static site generatorhttps://gohugo.io/Not installedFrom: https://mirrors.tuna.tsinghua.edu.cn/git/homebrew/homebrew-core.git/Formula/hugo.rb==&gt; DependenciesBuild: go âœ˜==&gt; Options--HEADInstall HEAD version==&gt; Analyticsinstall: 26,782 (30 days), 84,656 (90 days), 287,304 (365 days)install-on-request: 26,266 (30 days), 82,887 (90 days), 279,634 (365 days)build-error: 0 (30 days)</code></pre><p>ä»¥ä¸ŠæŸ¥è¯¢æ‰€å¾—ä¿¡æ¯ï¼ŒåŒ…å«äº†è½¯ä»¶çš„æœ€æ–°å¯ç”¨ç‰ˆæœ¬ï¼Œæœ¬æœºæ˜¯å¦å·²å®‰è£…ï¼Œæœ¬æœºå·²å®‰è£…çš„ç‰ˆæœ¬ï¼Œå®‰è£…çš„è·¯å¾„ã€å¤§å°ã€æ—¶é—´ã€Tap æºï¼Œæ‰€ä¾èµ–çš„åŒ…ï¼Œä»¥åŠå®‰è£…çš„å¯é€‰é¡¹ç­‰è¯¦ç»†ä¿¡æ¯ã€‚è€Œè¿™äº›ä¿¡æ¯å¯ä»¥å¸®åŠ©æˆ‘ä»¬å¾ˆæ–¹ä¾¿å¿«æ·çš„äº†è§£å¦‚ä½•å¯¹è¯¥è½¯ä»¶è¿›è¡Œç›¸åº”çš„æ“ä½œã€‚</p><h5 id="å®‰è£…è½¯ä»¶åŒ…"><a href="#å®‰è£…è½¯ä»¶åŒ…" class="headerlink" title="å®‰è£…è½¯ä»¶åŒ…"></a>å®‰è£…è½¯ä»¶åŒ…</h5><p> <code>brew install FORMULA... </code>ç”¨äºå®‰è£…ä¸€ä¸ªæˆ–å¤šä¸ªè½¯ä»¶ã€‚</p><p>ä¾‹å¦‚ï¼Œå®‰è£…è½¯ä»¶hugoï¼š</p><pre><code class="hljs mipsasm"><span class="hljs-keyword">brew </span><span class="hljs-keyword">install </span>hugo</code></pre><p>å®‰è£…è½¯ä»¶å‘½ä»¤æ‰§è¡Œä¹‹å‰ï¼Œbrew ä¸€èˆ¬ä¼šå…ˆæ£€æŸ¥æ›´æ–° Homebrew è‡ªèº«åŠ Tap æºã€‚</p><h5 id="æ›´æ–°è½¯ä»¶åŒ…"><a href="#æ›´æ–°è½¯ä»¶åŒ…" class="headerlink" title="æ›´æ–°è½¯ä»¶åŒ…"></a>æ›´æ–°è½¯ä»¶åŒ…</h5><p> <code>brew upgrade [FORMULA...]</code> ç”¨äºæ›´æ–°ä¸€ä¸ªæˆ–å¤šä¸ªè½¯ä»¶ï¼Œä¸æŒ‡å®šè½¯ä»¶ååˆ™æ›´æ–°æ‰€æœ‰è½¯ä»¶ã€‚</p><h5 id="å¸è½½è½¯ä»¶åŒ…"><a href="#å¸è½½è½¯ä»¶åŒ…" class="headerlink" title="å¸è½½è½¯ä»¶åŒ…"></a>å¸è½½è½¯ä»¶åŒ…</h5><p><code>brew uninstall FORMULA...</code> ç”¨äºå¸è½½æŒ‡å®šçš„ä¸€ä¸ªæˆ–å¤šä¸ªè½¯ä»¶</p><p><code>brew uninstall --force FORMULA...</code> å½»åº•å¸è½½æŒ‡å®šè½¯ä»¶ï¼ŒåŒ…æ‹¬æ—§ç‰ˆæœ¬</p><h5 id="å·²å®‰è£…çš„è½¯ä»¶åˆ—è¡¨"><a href="#å·²å®‰è£…çš„è½¯ä»¶åˆ—è¡¨" class="headerlink" title="å·²å®‰è£…çš„è½¯ä»¶åˆ—è¡¨"></a>å·²å®‰è£…çš„è½¯ä»¶åˆ—è¡¨</h5><p> <code>brew list</code> ç”¨äºæŸ¥è¯¢æœ¬æœºå·²å®‰è£…çš„è½¯ä»¶åˆ—è¡¨</p><pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> brew list</span>aprgettextlz4pcre2pythonsqliteutf8procapr-utilgomysql-clientperlpython@2subversionxzgdbmlibzipopenssl@1.1pkg-configreadlinetldr</code></pre><h5 id="æœåŠ¡ç®¡ç†"><a href="#æœåŠ¡ç®¡ç†" class="headerlink" title="æœåŠ¡ç®¡ç†"></a>æœåŠ¡ç®¡ç†</h5><p> <code>brew services</code> ç”¨äºæ–¹ä¾¿çš„ç®¡ç† brew å®‰è£…çš„è½¯ä»¶è½¯ä»¶ï¼Œç±»ä¼¼äº Linux ä¸‹çš„ service å‘½ä»¤ã€‚</p><h5 id="æ£€æŸ¥å¯æ›´æ–°çš„è½¯ä»¶åˆ—è¡¨"><a href="#æ£€æŸ¥å¯æ›´æ–°çš„è½¯ä»¶åˆ—è¡¨" class="headerlink" title="æ£€æŸ¥å¯æ›´æ–°çš„è½¯ä»¶åˆ—è¡¨"></a>æ£€æŸ¥å¯æ›´æ–°çš„è½¯ä»¶åˆ—è¡¨</h5><p> <code>brew outdated</code> å¯æŸ¥è¯¢æœ‰æ›´æ–°ç‰ˆæœ¬çš„è½¯ä»¶</p><pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> brew outdated </span>gettext (0.20.1) &lt; 0.20.2_1go (1.13.8) &lt; 1.14.3libzip (1.6.1) &lt; 1.7.1mysql-client (8.0.18) &lt; 8.0.19openssl@1.1 (1.1.1d) &lt; 1.1.1gpcre2 (10.34) &lt; 10.35perl (5.30.1) &lt; 5.30.3pkg-config (0.29.2) &lt; 0.29.2_3python (3.7.6_1) &lt; 3.7.7readline (8.0.1) &lt; 8.0.4sqlite (3.30.1) &lt; 3.32.1subversion (1.13.0_1) &lt; 1.14.0_1utf8proc (2.4.0) &lt; 2.5.0xz (5.2.4) &lt; 5.2.5</code></pre><h5 id="æ¸…ç†è½¯ä»¶"><a href="#æ¸…ç†è½¯ä»¶" class="headerlink" title="æ¸…ç†è½¯ä»¶"></a>æ¸…ç†è½¯ä»¶</h5><p><code>brew cleanup -n</code> åˆ—å‡ºéœ€è¦æ¸…ç†çš„å†…å®¹</p><p><code>brew cleanup</code> æ¸…ç†æ‰€æœ‰çš„è¿‡æ—¶è½¯ä»¶ </p><p><code>brew cleanup [FORMULA]</code> æ¸…ç†æŒ‡å®šè½¯ä»¶çš„è¿‡æ—¶åŒ…</p><h5 id="æŸ¥çœ‹é…ç½®ä¿¡æ¯"><a href="#æŸ¥çœ‹é…ç½®ä¿¡æ¯" class="headerlink" title="æŸ¥çœ‹é…ç½®ä¿¡æ¯"></a>æŸ¥çœ‹é…ç½®ä¿¡æ¯</h5><p><code>brew config</code> ç”¨äºæŸ¥çœ‹ brew æ‰€åœ¨ç¯å¢ƒåŠç›¸å…³çš„é…ç½®æƒ…å†µ</p><pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> brew config</span>HOMEBREW_VERSION: 2.4.0ORIGIN: https://mirrors.tuna.tsinghua.edu.cn/git/homebrew/homebrew-cask-drivers.gitHEAD: 28ed0801ed5807e176e62a3ba66e47ec867ec17dLast commit: 3 days agoCore tap ORIGIN: https://mirrors.tuna.tsinghua.edu.cn/git/homebrew/homebrew-core.gitCore tap HEAD: c948bc65d13a2bdd43e5ef2ed4196930c731283cCore tap last commit: 11 hours agoHOMEBREW_PREFIX: /usr/localHOMEBREW_BOTTLE_DOMAIN: https://mirrors.tuna.tsinghua.edu.cn/homebrew-bottlesHOMEBREW_MAKE_JOBS: 8CPU: octa-core 64-bit kabylakeHomebrew Ruby: 2.6.3 =&gt; /usr/local/Homebrew/Library/Homebrew/vendor/portable-ruby/2.6.3_1/bin/rubyClang: 11.0 build 1103Git: 2.24.1 =&gt; /Library/Developer/CommandLineTools/usr/bin/gitCurl: 7.64.1 =&gt; /usr/bin/curlJava: 1.8.0_212macOS: 10.15.4-x86_64CLT: 1103.0.32.29Xcode: N/A</code></pre><h5 id="è¯Šæ–­é—®é¢˜"><a href="#è¯Šæ–­é—®é¢˜" class="headerlink" title="è¯Šæ–­é—®é¢˜"></a>è¯Šæ–­é—®é¢˜</h5><p> <code>brew doctor</code> è¯Šæ–­å½“å‰ brew å­˜åœ¨å“ªäº›é—®é¢˜ï¼Œå¹¶ç»™å‡ºè§£å†³æ–¹æ¡ˆ</p><h5 id="ä»“åº“ç®¡ç†"><a href="#ä»“åº“ç®¡ç†" class="headerlink" title="ä»“åº“ç®¡ç†"></a>ä»“åº“ç®¡ç†</h5><p><code>brew tap</code> å·²å®‰è£…çš„ä»“åº“åˆ—è¡¨</p><p><code>brew tap [--full] user/repo [URL]</code> æ·»åŠ ä»“åº“</p><p><code>brew untap tap</code> ç§»é™¤ä»“åº“</p><pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> brew tap</span>homebrew/caskhomebrew/cask-drivershomebrew/cask-fontshomebrew/corehomebrew/servicestldr-pages/tldr</code></pre><h4 id="é•œåƒæº"><a href="#é•œåƒæº" class="headerlink" title="é•œåƒæº"></a>é•œåƒæº</h4><p>æ¸…åå¤§å­¦å¼€æºè½¯ä»¶é•œåƒç«™</p><p><a href="https://mirrors.tuna.tsinghua.edu.cn/help/homebrew/">Homebrew é•œåƒä½¿ç”¨å¸®åŠ©</a></p><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> æ›¿æ¢ç°æœ‰ä¸Šæ¸¸</span><span class="hljs-meta">#</span><span class="bash"> ä»¥ä¸‹é’ˆå¯¹ mac OS ç³»ç»Ÿä¸Šçš„ Homebrew</span>git -C &quot;$(brew --repo homebrew/core)&quot; remote set-url origin https://mirrors.tuna.tsinghua.edu.cn/git/homebrew/homebrew-core.gitgit -C &quot;$(brew --repo homebrew/cask)&quot; remote set-url origin https://mirrors.tuna.tsinghua.edu.cn/git/homebrew/homebrew-cask.gitgit -C &quot;$(brew --repo homebrew/cask-fonts)&quot; remote set-url origin https://mirrors.tuna.tsinghua.edu.cn/git/homebrew/homebrew-cask-fonts.gitgit -C &quot;$(brew --repo homebrew/cask-drivers)&quot; remote set-url origin https://mirrors.tuna.tsinghua.edu.cn/git/homebrew/homebrew-cask-drivers.git<span class="hljs-meta">#</span><span class="bash"> æ›´æ¢åæµ‹è¯•å·¥ä½œæ˜¯å¦æ­£å¸¸</span>brew update<span class="hljs-meta">#</span><span class="bash"> å¤åŸ</span><span class="hljs-meta">#</span><span class="bash"> ä»¥ä¸‹é’ˆå¯¹ mac OS ç³»ç»Ÿä¸Šçš„ Homebrew</span>git -C &quot;$(brew --repo homebrew/core)&quot; remote set-url origin https://github.com/Homebrew/homebrew-core.gitgit -C &quot;$(brew --repo homebrew/cask)&quot; remote set-url origin https://github.com/Homebrew/homebrew-cask.gitgit -C &quot;$(brew --repo homebrew/cask-fonts)&quot; remote set-url origin https://github.com/Homebrew/homebrew-cask-fonts.gitgit -C &quot;$(brew --repo homebrew/cask-drivers)&quot; remote set-url origin https://github.com/Homebrew/homebrew-cask-drivers.git<span class="hljs-meta">#</span><span class="bash"> æ›´æ¢åæµ‹è¯•å·¥ä½œæ˜¯å¦æ­£å¸¸</span>brew update</code></pre><p><a href="https://mirrors.tuna.tsinghua.edu.cn/help/homebrew-bottles/">Homebrew-bottles é•œåƒä½¿ç”¨å¸®åŠ©</a></p><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> ä¸´æ—¶æ›¿æ¢</span>export HOMEBREW_BOTTLE_DOMAIN=https://mirrors.tuna.tsinghua.edu.cn/homebrew-bottles<span class="hljs-meta">#</span><span class="bash"> é•¿æœŸæ›¿æ¢</span>echo &#x27;export HOMEBREW_BOTTLE_DOMAIN=https://mirrors.tuna.tsinghua.edu.cn/homebrew-bottles&#x27; &gt;&gt; ~/.bash_profilesource ~/.bash_profile</code></pre><h3 id="Pythonè™šæ‹Ÿç¯å¢ƒï¼ˆVirtualEnvï¼‰"><a href="#Pythonè™šæ‹Ÿç¯å¢ƒï¼ˆVirtualEnvï¼‰" class="headerlink" title="Pythonè™šæ‹Ÿç¯å¢ƒï¼ˆVirtualEnvï¼‰"></a>Pythonè™šæ‹Ÿç¯å¢ƒï¼ˆVirtualEnvï¼‰</h3><h4 id="virtualenv"><a href="#virtualenv" class="headerlink" title="virtualenv"></a>virtualenv</h4><h5 id="å®‰è£…virtualenvç¯å¢ƒ"><a href="#å®‰è£…virtualenvç¯å¢ƒ" class="headerlink" title="å®‰è£…virtualenvç¯å¢ƒ"></a>å®‰è£…virtualenvç¯å¢ƒ</h5><pre><code class="hljs shell">pip install virtualenv<span class="hljs-meta">#</span><span class="bash">æ£€æŸ¥æ˜¯å¦å®‰è£…æˆåŠŸ</span>virtualenv --version</code></pre><h5 id="åˆ›å»ºä»¥åŠä½¿ç”¨è™šæ‹Ÿç¯å¢ƒ"><a href="#åˆ›å»ºä»¥åŠä½¿ç”¨è™šæ‹Ÿç¯å¢ƒ" class="headerlink" title="åˆ›å»ºä»¥åŠä½¿ç”¨è™šæ‹Ÿç¯å¢ƒ"></a>åˆ›å»ºä»¥åŠä½¿ç”¨è™šæ‹Ÿç¯å¢ƒ</h5><h6 id="åˆ›å»ºæ—¶æŒ‡å®šä½ç½®æ–¹å¼"><a href="#åˆ›å»ºæ—¶æŒ‡å®šä½ç½®æ–¹å¼" class="headerlink" title="åˆ›å»ºæ—¶æŒ‡å®šä½ç½®æ–¹å¼"></a>åˆ›å»ºæ—¶æŒ‡å®šä½ç½®æ–¹å¼</h6><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> åˆ›å»ºpython3ç¯å¢ƒ</span>virtualenv -p python3 ~/Projects/PythonEnv/py3_normal/<span class="hljs-meta">#</span><span class="bash"> è¿›å…¥è™šæ‹Ÿç¯å¢ƒ</span>cd ~/Projects/PythonEnv/py3_normal/binsource activate<span class="hljs-meta">#</span><span class="bash"> é€€å‡ºç¯å¢ƒ</span>deactivate</code></pre><h6 id="è™šæ‹Ÿç¯å¢ƒç®¡ç†å™¨æ–¹å¼"><a href="#è™šæ‹Ÿç¯å¢ƒç®¡ç†å™¨æ–¹å¼" class="headerlink" title="è™šæ‹Ÿç¯å¢ƒç®¡ç†å™¨æ–¹å¼"></a>è™šæ‹Ÿç¯å¢ƒç®¡ç†å™¨æ–¹å¼</h6><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> å®‰è£…è™šæ‹Ÿç¯å¢ƒç®¡ç†å™¨</span>pip install virtualenvwrapper<span class="hljs-meta">#</span><span class="bash"> é…ç½®è™šæ‹Ÿç¯å¢ƒç®¡ç†å™¨ç¯å¢ƒ-æ·»åŠ é…ç½®</span>vim ~/.bash_profileWORKON_HOME=~/Projects/PythonEnvPROJECT_HOME=~/Projects/MyPythonexport WORKON_HOMEexport PROJECT_HOMEVIRTUALENVWRAPPER_PYTHON=/usr/local/bin/python3source /usr/local/bin/virtualenvwrapper.sh<span class="hljs-meta">#</span><span class="bash">ä¿å­˜-ç”Ÿæ•ˆé…ç½®</span>source ~/.bash_profile<span class="hljs-meta">#</span><span class="bash"> åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ</span><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment"># åˆ›å»ºpython2çš„è™šæ‹Ÿç¯å¢ƒ</span></span>mkvirtualenv &lt;è™šæ‹Ÿç¯å¢ƒå&gt;<span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment"># åˆ›å»ºpython3çš„è™šæ‹Ÿç¯å¢ƒ</span></span>mkvirtualenv -p python3 &lt;è™šæ‹Ÿç¯å¢ƒå&gt;<span class="hljs-meta">#</span><span class="bash"> è¿›å…¥/åˆ‡æ¢è™šæ‹Ÿç¯å¢ƒ</span>workon &lt;è™šæ‹Ÿç¯å¢ƒå&gt;<span class="hljs-meta">#</span><span class="bash"> é€€å‡ºè™šæ‹Ÿç¯å¢ƒ</span>deactivate<span class="hljs-meta">#</span><span class="bash"> å…¶ä»–å‘½ä»¤</span>lsvirtualenv   # æŸ¥çœ‹è™šæ‹Ÿç¯å¢ƒåˆ—è¡¨lssitepackages # æŸ¥çœ‹å½“å‰ç¯å¢ƒä¸­å®‰è£…çš„é‚£äº›åŒ…ï¼ˆå¯åŠ¨è™šæ‹Ÿç¯å¢ƒåï¼‰rmvirtualenv   # è™šæ‹Ÿç¯å¢ƒå åˆ é™¤è™šæ‹Ÿç¯å¢ƒ</code></pre><h4 id="Anaconda-or-Miniconda"><a href="#Anaconda-or-Miniconda" class="headerlink" title="Anaconda or Miniconda"></a>Anaconda or Miniconda</h4><h5 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h5><p>æ¸…åå¤§å­¦å¼€æºè½¯ä»¶é•œåƒç«™ <a href="https://mirrors.tuna.tsinghua.edu.cn/anaconda/miniconda/">https://mirrors.tuna.tsinghua.edu.cn/anaconda/miniconda/</a></p><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> Download</span>wget https://mirrors.tuna.tsinghua.edu.cn/anaconda/miniconda/Miniconda-3.4.2-MacOSX-x86_64.sh<span class="hljs-meta">#</span><span class="bash"> Install</span>bash Miniconda-3.4.2-MacOSX-x86_64.sh<span class="hljs-meta">#</span><span class="bash"> Activate</span>source .bashrc</code></pre><h5 id="åˆ›å»ºä»¥åŠä½¿ç”¨è™šæ‹Ÿç¯å¢ƒ-1"><a href="#åˆ›å»ºä»¥åŠä½¿ç”¨è™šæ‹Ÿç¯å¢ƒ-1" class="headerlink" title="åˆ›å»ºä»¥åŠä½¿ç”¨è™šæ‹Ÿç¯å¢ƒ"></a>åˆ›å»ºä»¥åŠä½¿ç”¨è™šæ‹Ÿç¯å¢ƒ</h5><pre><code class="hljs shell">- Create a new environment, installing named packages into it:    conda create --name environment_name python=2.7 matplotlib- List all environments:    conda info --envs- Load or unload an environment:    conda activate|deactivate environment_name- Delete an environment (remove all packages):    conda remove --name environment_name --all- Search conda channels for a package by name:    conda search package_name- Install packages into the current environment:    conda install python=3.4 numpy- List currently installed packages in current environment:    conda list- Delete unused packages and caches:    conda clean --all</code></pre><h3 id="Python-pip-é…ç½®å›½å†…æº-pip-install-Read-timed-out"><a href="#Python-pip-é…ç½®å›½å†…æº-pip-install-Read-timed-out" class="headerlink" title="Python pip é…ç½®å›½å†…æº[pip install Read timed out]"></a>Python pip é…ç½®å›½å†…æº[pip install Read timed out]</h3><h4 id="ã€æ–¹å¼ä¸€ã€‘ä¸´æ—¶ç”Ÿæ•ˆ"><a href="#ã€æ–¹å¼ä¸€ã€‘ä¸´æ—¶ç”Ÿæ•ˆ" class="headerlink" title="ã€æ–¹å¼ä¸€ã€‘ä¸´æ—¶ç”Ÿæ•ˆ"></a>ã€æ–¹å¼ä¸€ã€‘ä¸´æ—¶ç”Ÿæ•ˆ</h4><pre><code class="hljs awk"><span class="hljs-comment"># åœ¨å®‰è£…æ—¶åŠ ä¸Šé•œåƒæº</span>pip install &lt;åº“å&gt; -i https:<span class="hljs-regexp">//</span>pypi.douban.com<span class="hljs-regexp">/simple/</span> --trusted-host pypi.douban.compyth</code></pre><p><strong>æ–¹å¼äºŒã€‘æ°¸ä¹…æŒ‡å®š</strong></p><h5 id="å›½å†…æºåˆ—è¡¨ï¼ˆæ¨èç”¨é˜¿é‡Œäº‘çš„ï¼‰"><a href="#å›½å†…æºåˆ—è¡¨ï¼ˆæ¨èç”¨é˜¿é‡Œäº‘çš„ï¼‰" class="headerlink" title="å›½å†…æºåˆ—è¡¨ï¼ˆæ¨èç”¨é˜¿é‡Œäº‘çš„ï¼‰"></a>å›½å†…æºåˆ—è¡¨ï¼ˆæ¨èç”¨é˜¿é‡Œäº‘çš„ï¼‰</h5><p>é˜¿é‡Œäº‘<code>http://mirrors.aliyun.com/pypi/simple/</code></p><p>ä¸­å›½ç§‘æŠ€å¤§å­¦ <code>https://pypi.mirrors.ustc.edu.cn/simple/</code></p><p>è±†ç“£ (douban) <code>https://pypi.douban.com/simple/</code></p><p>æ¸…åå¤§å­¦ <code>https://pypi.tuna.tsinghua.edu.cn/simple/</code></p><p>ä¸­å›½ç§‘å­¦æŠ€æœ¯å¤§å­¦ <code>http://pypi.mirrors.ustc.edu.cn/simple/</code></p><h5 id="æ°¸ä¹…æŒ‡å®šæ–¹å¼"><a href="#æ°¸ä¹…æŒ‡å®šæ–¹å¼" class="headerlink" title="æ°¸ä¹…æŒ‡å®šæ–¹å¼"></a>æ°¸ä¹…æŒ‡å®šæ–¹å¼</h5><pre><code class="hljs shell">mkdir .pip# åœ¨å®¶ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ª.pipç›®å½•~ cd pip~ touch pip.conf # åˆ›å»ºä¸€ä¸ªpipé…ç½®æ–‡ä»¶<span class="hljs-meta">#</span><span class="bash"> å†™å…¥é…ç½®</span>[global]index-url = http://mirrors.aliyun.com/pypi/simple/[install]trusted-host = mirrors.aliyun.com</code></pre><h3 id="æ›´æ–°Pythonç‰ˆæœ¬å-å‘½ä»¤è¡Œä¸‹pip-å‘½ä»¤æŠ¥é”™"><a href="#æ›´æ–°Pythonç‰ˆæœ¬å-å‘½ä»¤è¡Œä¸‹pip-å‘½ä»¤æŠ¥é”™" class="headerlink" title="æ›´æ–°Pythonç‰ˆæœ¬å,å‘½ä»¤è¡Œä¸‹pip å‘½ä»¤æŠ¥é”™"></a>æ›´æ–°Pythonç‰ˆæœ¬å,å‘½ä»¤è¡Œä¸‹pip å‘½ä»¤æŠ¥é”™</h3><p>ç”µè„‘ä¸­Python3ç”±3.7æ›´æ–°åˆ°3.9åï¼Œåœ¨å‘½ä»¤è¡Œä¸‹ä½¿ç”¨<code>pip list</code>æŠ¥ä»¥ä¸‹é”™è¯¯</p><pre><code class="hljs gradle">zsh: <span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/bin/</span>pip: bad interpreter: <span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/opt/</span>python<span class="hljs-regexp">/bin/</span>python3.<span class="hljs-number">7</span>: no such <span class="hljs-keyword">file</span> or directory</code></pre><p>ä½†æ˜¯å‘½ä»¤<code>pip3 list</code>å¯ä»¥æ­£å¸¸ä½¿ç”¨ï¼Œè¿™æ˜¯éœ€è¦è€ƒè™‘<code>pip</code>æŒ‡å‘çš„pythonè®¾ç½®æ˜¯å¦æ­£ç¡®</p><pre><code class="hljs zsh"><span class="hljs-comment"># æŸ¥çœ‹pipå‘½ä»¤é…ç½®æ–‡ä»¶</span><span class="hljs-built_in">which</span> pip/usr/<span class="hljs-built_in">local</span>/bin/pip<span class="hljs-comment"># æŸ¥çœ‹pip3å‘½ä»¤é…ç½®æ–‡ä»¶</span>/usr/<span class="hljs-built_in">local</span>/bin/pip3</code></pre><p>å¯¹æ¯”å‘ç°/usr/local/bin/pipæŒ‡å‘çš„pythonç‰ˆæœ¬æ—¶3.7ï¼Œ/usr/local/bin/pip3æŒ‡å‘çš„æ˜¯æ­£ç¡®çš„ã€‚å› æ­¤ï¼Œå°†/usr/local/bin/pipæŒ‡å‘pythonç‰ˆæœ¬çš„é…ç½®ä¿®æ”¹æˆ/usr/local/bin/pip3æŒ‡å‘çš„é…ç½®ã€‚</p><h3 id="å¼€å‘é…ç½®"><a href="#å¼€å‘é…ç½®" class="headerlink" title="å¼€å‘é…ç½®"></a>å¼€å‘é…ç½®</h3><h4 id="Iterm2"><a href="#Iterm2" class="headerlink" title="Iterm2"></a>Iterm2</h4><h4 id="oh-my-zsh"><a href="#oh-my-zsh" class="headerlink" title="oh-my-zsh"></a>oh-my-zsh</h4><h4 id="tldr"><a href="#tldr" class="headerlink" title="tldr"></a>tldr</h4><h3 id="Catalinaå‡çº§Sur-Bigé‡åˆ°çš„å‘"><a href="#Catalinaå‡çº§Sur-Bigé‡åˆ°çš„å‘" class="headerlink" title="Catalinaå‡çº§Sur Bigé‡åˆ°çš„å‘"></a>Catalinaå‡çº§Sur Bigé‡åˆ°çš„å‘</h3><h4 id="Homebrew-1"><a href="#Homebrew-1" class="headerlink" title="Homebrew"></a>Homebrew</h4><h5 id="brewæŠ¥é”™ï¼š-initializeâ€™-Version-value-must-be-a-string-got-a-NilClass-TypeError"><a href="#brewæŠ¥é”™ï¼š-initializeâ€™-Version-value-must-be-a-string-got-a-NilClass-TypeError" class="headerlink" title="brewæŠ¥é”™ï¼š`initializeâ€™: Version value must be a string; got a NilClass () (TypeError)"></a>brewæŠ¥é”™ï¼š`initializeâ€™: Version value must be a string; got a NilClass () (TypeError)</h5><pre><code class="hljs Python">brew <span class="hljs-built_in">list</span>Traceback (most recent call last):    <span class="hljs-number">11</span>: <span class="hljs-keyword">from</span> /usr/local/Homebrew/Library/Homebrew/brew.rb:<span class="hljs-number">23</span>:<span class="hljs-keyword">in</span> `&lt;main&gt;<span class="hljs-string">&#x27;</span><span class="hljs-string">    10: from /usr/local/Homebrew/Library/Homebrew/brew.rb:23:in `require_relative&#x27;</span>     <span class="hljs-number">9</span>: <span class="hljs-keyword">from</span> /usr/local/Homebrew/Library/Homebrew/<span class="hljs-keyword">global</span>.rb:<span class="hljs-number">29</span>:<span class="hljs-keyword">in</span> `&lt;top (required)&gt;<span class="hljs-string">&#x27;</span><span class="hljs-string">     8: from /System/Library/Frameworks/Ruby.framework/Versions/2.6/usr/lib/ruby/2.6.0/rubygems/core_ext/kernel_require.rb:54:in `require&#x27;</span>     <span class="hljs-number">7</span>: <span class="hljs-keyword">from</span> /System/Library/Frameworks/Ruby.framework/Versions/<span class="hljs-number">2.6</span>/usr/lib/ruby/<span class="hljs-number">2.6</span><span class="hljs-number">.0</span>/rubygems/core_ext/kernel_require.rb:<span class="hljs-number">54</span>:<span class="hljs-keyword">in</span> `require<span class="hljs-string">&#x27;</span><span class="hljs-string">     6: from /usr/local/Homebrew/Library/Homebrew/os.rb:3:in `&lt;top (required)&gt;&#x27;</span>     <span class="hljs-number">5</span>: <span class="hljs-keyword">from</span> /usr/local/Homebrew/Library/Homebrew/os.rb:<span class="hljs-number">21</span>:<span class="hljs-keyword">in</span> `&lt;module:OS&gt;<span class="hljs-string">&#x27;</span><span class="hljs-string">     4: from /usr/local/Homebrew/Library/Homebrew/os/mac.rb:58:in `prerelease?&#x27;</span>     <span class="hljs-number">3</span>: <span class="hljs-keyword">from</span> /usr/local/Homebrew/Library/Homebrew/os/mac.rb:<span class="hljs-number">24</span>:<span class="hljs-keyword">in</span> `version<span class="hljs-string">&#x27;</span><span class="hljs-string">     2: from /usr/local/Homebrew/Library/Homebrew/os/mac.rb:24:in `new&#x27;</span>     <span class="hljs-number">1</span>: <span class="hljs-keyword">from</span> /usr/local/Homebrew/Library/Homebrew/os/mac/version.rb:<span class="hljs-number">26</span>:<span class="hljs-keyword">in</span> `initialize<span class="hljs-string">&#x27;</span><span class="hljs-string">/usr/local/Homebrew/Library/Homebrew/version.rb:368:in `initialize&#x27;</span>: Version value must be a string; got a NilClass () (TypeError)</code></pre><p>æ ¹æ®Tracebackä¿¡æ¯å¯ä»¥å‘ç°/usr/local/Homebrew/Library/Homebrew/os/mac/version.rbä¸­æŠ¥é”™,vimæ‰“å¼€è¯¥æ–‡ä»¶</p><pre><code class="hljs Python">vim /usr/local/Homebrew/Library/Homebrew/os/mac/version.rb<span class="hljs-comment"># typed: true</span><span class="hljs-comment"># frozen_string_literal: true</span>require <span class="hljs-string">&quot;hardware&quot;</span>require <span class="hljs-string">&quot;version&quot;</span>module OS  module Mac    <span class="hljs-comment"># A macOS version.</span>    <span class="hljs-comment">#</span>    <span class="hljs-comment"># @api private</span>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Version</span> &lt; :</span>:Version      SYMBOLS =         catalina:    <span class="hljs-string">&quot;10.15&quot;</span>,        mojave:      <span class="hljs-string">&quot;10.14&quot;</span>,        high_sierra: <span class="hljs-string">&quot;10.13&quot;</span>,        sierra:      <span class="hljs-string">&quot;10.12&quot;</span>,        el_capitan:  <span class="hljs-string">&quot;10.11&quot;</span>,        yosemite:    <span class="hljs-string">&quot;10.10&quot;</span>,      &#125;.freeze      <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">self</span>.<span class="hljs-title">from_symbol</span>(<span class="hljs-params">sym</span>)</span>        str = SYMBOLS.fetch(sym) &#123; raise MacOSVersionError, sym &#125;        new(<span class="hljs-built_in">str</span>)      end      <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">initialize</span>(<span class="hljs-params">value</span>)</span><span class="hljs-function">        <span class="hljs-title">super</span>(<span class="hljs-params">value</span>)</span><span class="hljs-function"></span>        raise MacOSVersionError, value unless value.match?(/\A1\d+(?:\.\d+)&#123;0,2&#125;\Z/)</code></pre><p>ä»ä»£ç ä¸­å¯ä»¥çœ‹å‡º,è¯¥ç‰ˆæœ¬çš„Homebrewä¸æ”¯æŒSur Bigç³»ç»Ÿ,äºæ˜¯è§£å†³æ–¹æ¡ˆæ˜¯æ›´æ–°Homebrew</p><pre><code class="hljs bash">brew update-reset</code></pre><p>ç»“æœ,brewæ²¡äº†,å‘½ä»¤è¾“å…¥brewæŠ¥é”™</p><pre><code class="hljs bash">zsh:brew: <span class="hljs-built_in">command</span> not found</code></pre><p>æ— å¥ˆåªèƒ½é‡æ–°å®‰è£…</p><p>ä½†æ˜¯è¿™æ¬¡å°±æ²¡æœ‰é‚£ä¹ˆå¹¸è¿,rubyæºå·²æ›´æ¢æˆå›½å†…çš„</p><p>ä½¿ç”¨ç§‘å­¦ä¸Šç½‘,ä¹Ÿæ— æ³•è®¿é—®<a href="https://raw.githubusercontent.com/">https://raw.githubusercontent.com</a></p><p>äºæ˜¯åªèƒ½å¦å¯»æ–¹æ³•,Googleä¸Šæ‰¾åˆ°.bashè„šæœ¬</p><p>æ¡Œé¢åˆ›å»º.bashæ–‡ä»¶</p><pre><code class="hljs awk">vim <span class="hljs-regexp">/Desktop/</span>brew_install.sh</code></pre><p>è„šæœ¬å†…å®¹</p><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/bash</span><span class="hljs-built_in">set</span> -u<span class="hljs-comment"># First check if the OS is Linux.</span><span class="hljs-keyword">if</span> [[ <span class="hljs-string">&quot;<span class="hljs-subst">$(uname)</span>&quot;</span> = <span class="hljs-string">&quot;Linux&quot;</span> ]]; <span class="hljs-keyword">then</span>  HOMEBREW_ON_LINUX=1<span class="hljs-keyword">fi</span><span class="hljs-comment"># Check if macOS is ARM</span><span class="hljs-keyword">if</span> [[ <span class="hljs-string">&quot;<span class="hljs-subst">$(uname -m)</span>&quot;</span> = <span class="hljs-string">&quot;arm64&quot;</span> ]] &amp;&amp; [[ <span class="hljs-string">&quot;<span class="hljs-subst">$(uname)</span>&quot;</span> = <span class="hljs-string">&quot;Darwin&quot;</span> ]]; <span class="hljs-keyword">then</span>  HOMEBREW_APPLE_SILICON=1<span class="hljs-keyword">fi</span><span class="hljs-comment"># On macOS, this script installs to /usr/local only.</span><span class="hljs-comment"># On Linux, it installs to /home/linuxbrew/.linuxbrew if you have sudo access</span><span class="hljs-comment"># and ~/.linuxbrew otherwise.</span><span class="hljs-comment"># To install elsewhere (which is unsupported)</span><span class="hljs-comment"># you can untar https://github.com/Homebrew/brew/tarball/master</span><span class="hljs-comment"># anywhere you like.</span><span class="hljs-keyword">if</span> [[ -z <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;HOMEBREW_ON_LINUX-&#125;</span>&quot;</span> ]]; <span class="hljs-keyword">then</span>  HOMEBREW_PREFIX=<span class="hljs-string">&quot;/usr/local&quot;</span>  HOMEBREW_REPOSITORY=<span class="hljs-string">&quot;/usr/local/Homebrew&quot;</span>  HOMEBREW_CACHE=<span class="hljs-string">&quot;<span class="hljs-variable">$&#123;HOME&#125;</span>/Library/Caches/Homebrew&quot;</span>  STAT=<span class="hljs-string">&quot;stat -f&quot;</span>  CHOWN=<span class="hljs-string">&quot;/usr/sbin/chown&quot;</span>  CHGRP=<span class="hljs-string">&quot;/usr/bin/chgrp&quot;</span>  GROUP=<span class="hljs-string">&quot;admin&quot;</span>  TOUCH=<span class="hljs-string">&quot;/usr/bin/touch&quot;</span><span class="hljs-keyword">else</span>  HOMEBREW_PREFIX_DEFAULT=<span class="hljs-string">&quot;/home/linuxbrew/.linuxbrew&quot;</span>  HOMEBREW_CACHE=<span class="hljs-string">&quot;<span class="hljs-variable">$&#123;HOME&#125;</span>/.cache/Homebrew&quot;</span>  STAT=<span class="hljs-string">&quot;stat --printf&quot;</span>  CHOWN=<span class="hljs-string">&quot;/bin/chown&quot;</span>  CHGRP=<span class="hljs-string">&quot;/bin/chgrp&quot;</span>  GROUP=<span class="hljs-string">&quot;<span class="hljs-subst">$(id -gn)</span>&quot;</span>  TOUCH=<span class="hljs-string">&quot;/bin/touch&quot;</span><span class="hljs-keyword">fi</span>BREW_REPO=<span class="hljs-string">&quot;https://github.com/Homebrew/brew&quot;</span><span class="hljs-comment"># <span class="hljs-doctag">TODO:</span> bump version when new macOS is released</span>MACOS_LATEST_SUPPORTED=<span class="hljs-string">&quot;10.15&quot;</span><span class="hljs-comment"># <span class="hljs-doctag">TODO:</span> bump version when new macOS is released</span>MACOS_OLDEST_SUPPORTED=<span class="hljs-string">&quot;10.13&quot;</span><span class="hljs-comment"># For Homebrew on Linux</span>REQUIRED_RUBY_VERSION=2.6  <span class="hljs-comment"># https://github.com/Homebrew/brew/pull/6556</span>REQUIRED_GLIBC_VERSION=2.13  <span class="hljs-comment"># https://docs.brew.sh/Homebrew-on-Linux#requirements</span><span class="hljs-comment"># no analytics during installation</span><span class="hljs-built_in">export</span> HOMEBREW_NO_ANALYTICS_THIS_RUN=1<span class="hljs-built_in">export</span> HOMEBREW_NO_ANALYTICS_MESSAGE_OUTPUT=1<span class="hljs-comment"># string formatters</span><span class="hljs-keyword">if</span> [[ -t 1 ]]; <span class="hljs-keyword">then</span>  <span class="hljs-function"><span class="hljs-title">tty_escape</span></span>() &#123; <span class="hljs-built_in">printf</span> <span class="hljs-string">&quot;\033[%sm&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$1</span>&quot;</span>; &#125;<span class="hljs-keyword">else</span>  <span class="hljs-function"><span class="hljs-title">tty_escape</span></span>() &#123; :; &#125;<span class="hljs-keyword">fi</span><span class="hljs-function"><span class="hljs-title">tty_mkbold</span></span>() &#123; tty_escape <span class="hljs-string">&quot;1;<span class="hljs-variable">$1</span>&quot;</span>; &#125;tty_underline=<span class="hljs-string">&quot;<span class="hljs-subst">$(tty_escape <span class="hljs-string">&quot;4;39&quot;</span>)</span>&quot;</span>tty_blue=<span class="hljs-string">&quot;<span class="hljs-subst">$(tty_mkbold 34)</span>&quot;</span>tty_red=<span class="hljs-string">&quot;<span class="hljs-subst">$(tty_mkbold 31)</span>&quot;</span>tty_bold=<span class="hljs-string">&quot;<span class="hljs-subst">$(tty_mkbold 39)</span>&quot;</span>tty_reset=<span class="hljs-string">&quot;<span class="hljs-subst">$(tty_escape 0)</span>&quot;</span><span class="hljs-function"><span class="hljs-title">have_sudo_access</span></span>() &#123;  <span class="hljs-built_in">local</span> -a args  <span class="hljs-keyword">if</span> [[ -n <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;SUDO_ASKPASS-&#125;</span>&quot;</span> ]]; <span class="hljs-keyword">then</span>    args=(<span class="hljs-string">&quot;-A&quot;</span>)  <span class="hljs-keyword">fi</span>  <span class="hljs-keyword">if</span> [[ -z <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;HAVE_SUDO_ACCESS-&#125;</span>&quot;</span> ]]; <span class="hljs-keyword">then</span>    <span class="hljs-keyword">if</span> [[ -n <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;args[*]-&#125;</span>&quot;</span> ]]; <span class="hljs-keyword">then</span>      /usr/bin/sudo <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;args[@]&#125;</span>&quot;</span> -l mkdir &amp;&gt;/dev/null    <span class="hljs-keyword">else</span>      /usr/bin/sudo -l mkdir &amp;&gt;/dev/null    <span class="hljs-keyword">fi</span>    HAVE_SUDO_ACCESS=<span class="hljs-string">&quot;$?&quot;</span>  <span class="hljs-keyword">fi</span>  <span class="hljs-keyword">if</span> [[ -z <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;HOMEBREW_ON_LINUX-&#125;</span>&quot;</span> ]] &amp;&amp; [[ <span class="hljs-string">&quot;<span class="hljs-variable">$HAVE_SUDO_ACCESS</span>&quot;</span> -ne 0 ]]; <span class="hljs-keyword">then</span>    abort <span class="hljs-string">&quot;Need sudo access on macOS (e.g. the user <span class="hljs-variable">$USER</span> to be an Administrator)!&quot;</span>  <span class="hljs-keyword">fi</span>  <span class="hljs-built_in">return</span> <span class="hljs-string">&quot;<span class="hljs-variable">$HAVE_SUDO_ACCESS</span>&quot;</span>&#125;<span class="hljs-function"><span class="hljs-title">shell_join</span></span>() &#123;  <span class="hljs-built_in">local</span> arg  <span class="hljs-built_in">printf</span> <span class="hljs-string">&quot;%s&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$1</span>&quot;</span>  <span class="hljs-built_in">shift</span>  <span class="hljs-keyword">for</span> arg <span class="hljs-keyword">in</span> <span class="hljs-string">&quot;<span class="hljs-variable">$@</span>&quot;</span>; <span class="hljs-keyword">do</span>    <span class="hljs-built_in">printf</span> <span class="hljs-string">&quot; &quot;</span>    <span class="hljs-built_in">printf</span> <span class="hljs-string">&quot;%s&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;arg// /\ &#125;</span>&quot;</span>  <span class="hljs-keyword">done</span>&#125;<span class="hljs-function"><span class="hljs-title">chomp</span></span>() &#123;  <span class="hljs-built_in">printf</span> <span class="hljs-string">&quot;%s&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;1/&quot;$&#x27;\n&#x27;&quot;/&#125;</span>&quot;</span>&#125;<span class="hljs-function"><span class="hljs-title">ohai</span></span>() &#123;  <span class="hljs-built_in">printf</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;tty_blue&#125;</span>==&gt;<span class="hljs-variable">$&#123;tty_bold&#125;</span> %s<span class="hljs-variable">$&#123;tty_reset&#125;</span>\n&quot;</span> <span class="hljs-string">&quot;<span class="hljs-subst">$(shell_join <span class="hljs-string">&quot;<span class="hljs-variable">$@</span>&quot;</span>)</span>&quot;</span>&#125;<span class="hljs-function"><span class="hljs-title">warn</span></span>() &#123;  <span class="hljs-built_in">printf</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;tty_red&#125;</span>Warning<span class="hljs-variable">$&#123;tty_reset&#125;</span>: %s\n&quot;</span> <span class="hljs-string">&quot;<span class="hljs-subst">$(chomp <span class="hljs-string">&quot;<span class="hljs-variable">$1</span>&quot;</span>)</span>&quot;</span>&#125;<span class="hljs-function"><span class="hljs-title">abort</span></span>() &#123;  <span class="hljs-built_in">printf</span> <span class="hljs-string">&quot;%s\n&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$1</span>&quot;</span>  <span class="hljs-built_in">exit</span> 1&#125;<span class="hljs-function"><span class="hljs-title">execute</span></span>() &#123;  <span class="hljs-keyword">if</span> ! <span class="hljs-string">&quot;<span class="hljs-variable">$@</span>&quot;</span>; <span class="hljs-keyword">then</span>    abort <span class="hljs-string">&quot;<span class="hljs-subst">$(printf <span class="hljs-string">&quot;Failed during: %s&quot;</span> <span class="hljs-string">&quot;<span class="hljs-subst">$(shell_join <span class="hljs-string">&quot;<span class="hljs-variable">$@</span>&quot;</span>)</span>&quot;</span>)</span>&quot;</span>  <span class="hljs-keyword">fi</span>&#125;<span class="hljs-function"><span class="hljs-title">execute_sudo</span></span>() &#123;  <span class="hljs-built_in">local</span> -a args=(<span class="hljs-string">&quot;<span class="hljs-variable">$@</span>&quot;</span>)  <span class="hljs-keyword">if</span> [[ -n <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;SUDO_ASKPASS-&#125;</span>&quot;</span> ]]; <span class="hljs-keyword">then</span>    args=(<span class="hljs-string">&quot;-A&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;args[@]&#125;</span>&quot;</span>)  <span class="hljs-keyword">fi</span>  <span class="hljs-keyword">if</span> have_sudo_access; <span class="hljs-keyword">then</span>    ohai <span class="hljs-string">&quot;/usr/bin/sudo&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;args[@]&#125;</span>&quot;</span>    execute <span class="hljs-string">&quot;/usr/bin/sudo&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;args[@]&#125;</span>&quot;</span>  <span class="hljs-keyword">else</span>    ohai <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;args[@]&#125;</span>&quot;</span>    execute <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;args[@]&#125;</span>&quot;</span>  <span class="hljs-keyword">fi</span>&#125;<span class="hljs-function"><span class="hljs-title">getc</span></span>() &#123;  <span class="hljs-built_in">local</span> save_state  save_state=$(/bin/stty -g)  /bin/stty raw -<span class="hljs-built_in">echo</span>  IFS= <span class="hljs-built_in">read</span> -r -n 1 -d <span class="hljs-string">&#x27;&#x27;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$@</span>&quot;</span>  /bin/stty <span class="hljs-string">&quot;<span class="hljs-variable">$save_state</span>&quot;</span>&#125;<span class="hljs-function"><span class="hljs-title">wait_for_user</span></span>() &#123;  <span class="hljs-built_in">local</span> c  <span class="hljs-built_in">echo</span>  <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Press RETURN to continue or any other key to abort&quot;</span>  getc c  <span class="hljs-comment"># we test for \r and \n because some stuff does \r instead</span>  <span class="hljs-keyword">if</span> ! [[ <span class="hljs-string">&quot;<span class="hljs-variable">$c</span>&quot;</span> == $<span class="hljs-string">&#x27;\r&#x27;</span> || <span class="hljs-string">&quot;<span class="hljs-variable">$c</span>&quot;</span> == $<span class="hljs-string">&#x27;\n&#x27;</span> ]]; <span class="hljs-keyword">then</span>    <span class="hljs-built_in">exit</span> 1  <span class="hljs-keyword">fi</span>&#125;<span class="hljs-function"><span class="hljs-title">major_minor</span></span>() &#123;  <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;1%%.*&#125;</span>.<span class="hljs-subst">$(x=<span class="hljs-string">&quot;<span class="hljs-variable">$&#123;1#*.&#125;</span>&quot;</span>; echo <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;x%%.*&#125;</span>&quot;</span>)</span>&quot;</span>&#125;<span class="hljs-keyword">if</span> [[ -z <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;HOMEBREW_ON_LINUX-&#125;</span>&quot;</span> ]]; <span class="hljs-keyword">then</span>  macos_version=<span class="hljs-string">&quot;<span class="hljs-subst">$(major_minor <span class="hljs-string">&quot;<span class="hljs-subst">$(/usr/bin/sw_vers -productVersion)</span>&quot;</span>)</span>&quot;</span><span class="hljs-keyword">fi</span><span class="hljs-function"><span class="hljs-title">version_gt</span></span>() &#123;  [[ <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;1%.*&#125;</span>&quot;</span> -gt <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;2%.*&#125;</span>&quot;</span> ]] || [[ <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;1%.*&#125;</span>&quot;</span> -eq <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;2%.*&#125;</span>&quot;</span> &amp;&amp; <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;1#*.&#125;</span>&quot;</span> -gt <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;2#*.&#125;</span>&quot;</span> ]]&#125;<span class="hljs-function"><span class="hljs-title">version_ge</span></span>() &#123;  [[ <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;1%.*&#125;</span>&quot;</span> -gt <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;2%.*&#125;</span>&quot;</span> ]] || [[ <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;1%.*&#125;</span>&quot;</span> -eq <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;2%.*&#125;</span>&quot;</span> &amp;&amp; <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;1#*.&#125;</span>&quot;</span> -ge <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;2#*.&#125;</span>&quot;</span> ]]&#125;<span class="hljs-function"><span class="hljs-title">version_lt</span></span>() &#123;  [[ <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;1%.*&#125;</span>&quot;</span> -lt <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;2%.*&#125;</span>&quot;</span> ]] || [[ <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;1%.*&#125;</span>&quot;</span> -eq <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;2%.*&#125;</span>&quot;</span> &amp;&amp; <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;1#*.&#125;</span>&quot;</span> -lt <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;2#*.&#125;</span>&quot;</span> ]]&#125;<span class="hljs-function"><span class="hljs-title">should_install_git</span></span>() &#123;  <span class="hljs-keyword">if</span> [[ $(<span class="hljs-built_in">command</span> -v git) ]]; <span class="hljs-keyword">then</span>    <span class="hljs-built_in">return</span> 1  <span class="hljs-keyword">fi</span>&#125;<span class="hljs-function"><span class="hljs-title">should_install_command_line_tools</span></span>() &#123;  <span class="hljs-keyword">if</span> [[ -n <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;HOMEBREW_ON_LINUX-&#125;</span>&quot;</span> ]]; <span class="hljs-keyword">then</span>    <span class="hljs-built_in">return</span> 1  <span class="hljs-keyword">fi</span>  <span class="hljs-keyword">if</span> [[ -n <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;HOMEBREW_APPLE_SILICON-&#125;</span>&quot;</span> ]]; <span class="hljs-keyword">then</span>    <span class="hljs-built_in">return</span> 1;  <span class="hljs-keyword">fi</span>  <span class="hljs-keyword">if</span> version_gt <span class="hljs-string">&quot;<span class="hljs-variable">$macos_version</span>&quot;</span> <span class="hljs-string">&quot;10.13&quot;</span>; <span class="hljs-keyword">then</span>    ! [[ -e <span class="hljs-string">&quot;/Library/Developer/CommandLineTools/usr/bin/git&quot;</span> ]]  <span class="hljs-keyword">else</span>    ! [[ -e <span class="hljs-string">&quot;/Library/Developer/CommandLineTools/usr/bin/git&quot;</span> ]] ||      ! [[ -e <span class="hljs-string">&quot;/usr/include/iconv.h&quot;</span> ]]  <span class="hljs-keyword">fi</span>&#125;<span class="hljs-function"><span class="hljs-title">get_permission</span></span>() &#123;  <span class="hljs-variable">$STAT</span> <span class="hljs-string">&quot;%A&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$1</span>&quot;</span>&#125;<span class="hljs-function"><span class="hljs-title">user_only_chmod</span></span>() &#123;  [[ -d <span class="hljs-string">&quot;<span class="hljs-variable">$1</span>&quot;</span> ]] &amp;&amp; [[ <span class="hljs-string">&quot;<span class="hljs-subst">$(get_permission <span class="hljs-string">&quot;<span class="hljs-variable">$1</span>&quot;</span>)</span>&quot;</span> != <span class="hljs-string">&quot;755&quot;</span> ]]&#125;<span class="hljs-function"><span class="hljs-title">exists_but_not_writable</span></span>() &#123;  [[ -e <span class="hljs-string">&quot;<span class="hljs-variable">$1</span>&quot;</span> ]] &amp;&amp; ! [[ -r <span class="hljs-string">&quot;<span class="hljs-variable">$1</span>&quot;</span> &amp;&amp; -w <span class="hljs-string">&quot;<span class="hljs-variable">$1</span>&quot;</span> &amp;&amp; -x <span class="hljs-string">&quot;<span class="hljs-variable">$1</span>&quot;</span> ]]&#125;<span class="hljs-function"><span class="hljs-title">get_owner</span></span>() &#123;  <span class="hljs-variable">$STAT</span> <span class="hljs-string">&quot;%u&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$1</span>&quot;</span>&#125;<span class="hljs-function"><span class="hljs-title">file_not_owned</span></span>() &#123;  [[ <span class="hljs-string">&quot;<span class="hljs-subst">$(get_owner <span class="hljs-string">&quot;<span class="hljs-variable">$1</span>&quot;</span>)</span>&quot;</span> != <span class="hljs-string">&quot;<span class="hljs-subst">$(id -u)</span>&quot;</span> ]]&#125;<span class="hljs-function"><span class="hljs-title">get_group</span></span>() &#123;  <span class="hljs-variable">$STAT</span> <span class="hljs-string">&quot;%g&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$1</span>&quot;</span>&#125;<span class="hljs-function"><span class="hljs-title">file_not_grpowned</span></span>() &#123;  [[ <span class="hljs-string">&quot; <span class="hljs-subst">$(id -G <span class="hljs-string">&quot;<span class="hljs-variable">$USER</span>&quot;</span>)</span> &quot;</span> != *<span class="hljs-string">&quot; <span class="hljs-subst">$(get_group <span class="hljs-string">&quot;<span class="hljs-variable">$1</span>&quot;</span>)</span> &quot;</span>*  ]]&#125;<span class="hljs-comment"># Please sync with &#x27;test_ruby()&#x27; in &#x27;Library/Homebrew/utils/ruby.sh&#x27; from Homebrew/brew repository.</span><span class="hljs-function"><span class="hljs-title">test_ruby</span></span> () &#123;  <span class="hljs-keyword">if</span> [[ ! -x <span class="hljs-variable">$1</span> ]]  <span class="hljs-keyword">then</span>    <span class="hljs-built_in">return</span> 1  <span class="hljs-keyword">fi</span>  <span class="hljs-string">&quot;<span class="hljs-variable">$1</span>&quot;</span> --enable-frozen-string-literal --<span class="hljs-built_in">disable</span>=gems,did_you_mean,rubyopt -rrubygems -e \    <span class="hljs-string">&quot;abort if Gem::Version.new(RUBY_VERSION.to_s.dup).to_s.split(&#x27;.&#x27;).first(2) != \</span><span class="hljs-string">              Gem::Version.new(&#x27;<span class="hljs-variable">$REQUIRED_RUBY_VERSION</span>&#x27;).to_s.split(&#x27;.&#x27;).first(2)&quot;</span> 2&gt;/dev/null&#125;<span class="hljs-function"><span class="hljs-title">no_usable_ruby</span></span>() &#123;  <span class="hljs-built_in">local</span> ruby_exec  IFS=$<span class="hljs-string">&#x27;\n&#x27;</span> <span class="hljs-comment"># Do word splitting on new lines only</span>  <span class="hljs-keyword">for</span> ruby_exec <span class="hljs-keyword">in</span> $(<span class="hljs-built_in">which</span> -a ruby); <span class="hljs-keyword">do</span>    <span class="hljs-keyword">if</span> test_ruby <span class="hljs-string">&quot;<span class="hljs-variable">$ruby_exec</span>&quot;</span>; <span class="hljs-keyword">then</span>      <span class="hljs-built_in">return</span> 1    <span class="hljs-keyword">fi</span>  <span class="hljs-keyword">done</span>  IFS=$<span class="hljs-string">&#x27; \t\n&#x27;</span> <span class="hljs-comment"># Restore IFS to its default value</span>  <span class="hljs-built_in">return</span> 0&#125;<span class="hljs-function"><span class="hljs-title">outdated_glibc</span></span>() &#123;  <span class="hljs-built_in">local</span> glibc_version  glibc_version=$(ldd --version | head -n1 | grep -o <span class="hljs-string">&#x27;[0-9.]*$&#x27;</span> | grep -o <span class="hljs-string">&#x27;^[0-9]\+\.[0-9]\+&#x27;</span>)  version_lt <span class="hljs-string">&quot;<span class="hljs-variable">$glibc_version</span>&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$REQUIRED_GLIBC_VERSION</span>&quot;</span>&#125;<span class="hljs-keyword">if</span> [[ -n <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;HOMEBREW_ON_LINUX-&#125;</span>&quot;</span> ]] &amp;&amp; no_usable_ruby &amp;&amp; outdated_glibc<span class="hljs-keyword">then</span>    abort <span class="hljs-string">&quot;<span class="hljs-subst">$(cat &lt;&lt;-EOFABORT</span></span><span class="hljs-string"><span class="hljs-subst">    Homebrew requires Ruby $REQUIRED_RUBY_VERSION which was not found on your system.</span></span><span class="hljs-string"><span class="hljs-subst">    Homebrew portable Ruby requires Glibc version $REQUIRED_GLIBC_VERSION or newer,</span></span><span class="hljs-string"><span class="hljs-subst">    and your Glibc version is too old.</span></span><span class="hljs-string"><span class="hljs-subst">    See $&#123;tty_underline&#125;https://docs.brew.sh/Homebrew-on-Linux#requirements$&#123;tty_reset&#125;</span></span><span class="hljs-string"><span class="hljs-subst">    Install Ruby $REQUIRED_RUBY_VERSION and add its location to your PATH.</span></span><span class="hljs-string"><span class="hljs-subst">    EOFABORT</span></span><span class="hljs-string"><span class="hljs-subst">    )</span>&quot;</span><span class="hljs-keyword">fi</span><span class="hljs-comment"># USER isn&#x27;t always set so provide a fall back for the installer and subprocesses.</span><span class="hljs-keyword">if</span> [[ -z <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;USER-&#125;</span>&quot;</span> ]]; <span class="hljs-keyword">then</span>  USER=<span class="hljs-string">&quot;<span class="hljs-subst">$(chomp <span class="hljs-string">&quot;<span class="hljs-subst">$(id -un)</span>&quot;</span>)</span>&quot;</span>  <span class="hljs-built_in">export</span> USER<span class="hljs-keyword">fi</span><span class="hljs-comment"># Invalidate sudo timestamp before exiting (if it wasn&#x27;t active before).</span><span class="hljs-keyword">if</span> ! /usr/bin/sudo -n -v 2&gt;/dev/null; <span class="hljs-keyword">then</span>  <span class="hljs-built_in">trap</span> <span class="hljs-string">&#x27;/usr/bin/sudo -k&#x27;</span> EXIT<span class="hljs-keyword">fi</span><span class="hljs-comment"># Things can fail later if `pwd` doesn&#x27;t exist.</span><span class="hljs-comment"># Also sudo prints a warning message for no good reason</span><span class="hljs-built_in">cd</span> <span class="hljs-string">&quot;/usr&quot;</span> || <span class="hljs-built_in">exit</span> 1<span class="hljs-comment">####################################################################### script</span><span class="hljs-keyword">if</span> should_install_git; <span class="hljs-keyword">then</span>    abort <span class="hljs-string">&quot;<span class="hljs-subst">$(cat &lt;&lt;EOABORT</span></span><span class="hljs-string"><span class="hljs-subst">You must install Git before installing Homebrew. See:</span></span><span class="hljs-string"><span class="hljs-subst">  $&#123;tty_underline&#125;https://docs.brew.sh/Installation$&#123;tty_reset&#125;</span></span><span class="hljs-string"><span class="hljs-subst">EOABORT</span></span><span class="hljs-string"><span class="hljs-subst">)</span>&quot;</span><span class="hljs-keyword">fi</span><span class="hljs-keyword">if</span> [[ -z <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;HOMEBREW_ON_LINUX-&#125;</span>&quot;</span> ]]; <span class="hljs-keyword">then</span> have_sudo_access<span class="hljs-keyword">else</span>  <span class="hljs-keyword">if</span> [[ -n <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;CI-&#125;</span>&quot;</span> ]] || [[ -w <span class="hljs-string">&quot;<span class="hljs-variable">$HOMEBREW_PREFIX_DEFAULT</span>&quot;</span> ]] || [[ -w <span class="hljs-string">&quot;/home/linuxbrew&quot;</span> ]] || [[ -w <span class="hljs-string">&quot;/home&quot;</span> ]]; <span class="hljs-keyword">then</span>    HOMEBREW_PREFIX=<span class="hljs-string">&quot;<span class="hljs-variable">$HOMEBREW_PREFIX_DEFAULT</span>&quot;</span>  <span class="hljs-keyword">else</span>    <span class="hljs-built_in">trap</span> <span class="hljs-built_in">exit</span> SIGINT    <span class="hljs-keyword">if</span> [[ $(/usr/bin/sudo -n -l mkdir 2&gt;&amp;1) != *<span class="hljs-string">&quot;mkdir&quot;</span>* ]]; <span class="hljs-keyword">then</span>      ohai <span class="hljs-string">&quot;Select the Homebrew installation directory&quot;</span>      <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;- <span class="hljs-variable">$&#123;tty_bold&#125;</span>Enter your password<span class="hljs-variable">$&#123;tty_reset&#125;</span> to install to <span class="hljs-variable">$&#123;tty_underline&#125;</span><span class="hljs-variable">$&#123;HOMEBREW_PREFIX_DEFAULT&#125;</span><span class="hljs-variable">$&#123;tty_reset&#125;</span> (<span class="hljs-variable">$&#123;tty_bold&#125;</span>recommended<span class="hljs-variable">$&#123;tty_reset&#125;</span>)&quot;</span>      <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;- <span class="hljs-variable">$&#123;tty_bold&#125;</span>Press Control-D<span class="hljs-variable">$&#123;tty_reset&#125;</span> to install to <span class="hljs-variable">$&#123;tty_underline&#125;</span><span class="hljs-variable">$HOME</span>/.linuxbrew<span class="hljs-variable">$&#123;tty_reset&#125;</span>&quot;</span>      <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;- <span class="hljs-variable">$&#123;tty_bold&#125;</span>Press Control-C<span class="hljs-variable">$&#123;tty_reset&#125;</span> to cancel installation&quot;</span>    <span class="hljs-keyword">fi</span>    <span class="hljs-keyword">if</span> have_sudo_access; <span class="hljs-keyword">then</span>      HOMEBREW_PREFIX=<span class="hljs-string">&quot;<span class="hljs-variable">$HOMEBREW_PREFIX_DEFAULT</span>&quot;</span>    <span class="hljs-keyword">else</span>      HOMEBREW_PREFIX=<span class="hljs-string">&quot;<span class="hljs-variable">$HOME</span>/.linuxbrew&quot;</span>    <span class="hljs-keyword">fi</span>    <span class="hljs-built_in">trap</span> - SIGINT  <span class="hljs-keyword">fi</span>  HOMEBREW_REPOSITORY=<span class="hljs-string">&quot;<span class="hljs-variable">$&#123;HOMEBREW_PREFIX&#125;</span>/Homebrew&quot;</span><span class="hljs-keyword">fi</span><span class="hljs-keyword">if</span> [[ <span class="hljs-string">&quot;<span class="hljs-variable">$UID</span>&quot;</span> == <span class="hljs-string">&quot;0&quot;</span> ]]; <span class="hljs-keyword">then</span>  abort <span class="hljs-string">&quot;Don&#x27;t run this as root!&quot;</span><span class="hljs-keyword">elif</span> [[ -d <span class="hljs-string">&quot;<span class="hljs-variable">$HOMEBREW_PREFIX</span>&quot;</span> &amp;&amp; ! -x <span class="hljs-string">&quot;<span class="hljs-variable">$HOMEBREW_PREFIX</span>&quot;</span> ]]; <span class="hljs-keyword">then</span>  abort <span class="hljs-string">&quot;<span class="hljs-subst">$(cat &lt;&lt;EOABORT</span></span><span class="hljs-string"><span class="hljs-subst">The Homebrew prefix, $&#123;HOMEBREW_PREFIX&#125;, exists but is not searchable. If this is</span></span><span class="hljs-string"><span class="hljs-subst">not intentional, please restore the default permissions and try running the</span></span><span class="hljs-string"><span class="hljs-subst">installer again:</span></span><span class="hljs-string"><span class="hljs-subst">    sudo chmod 775 $&#123;HOMEBREW_PREFIX&#125;</span></span><span class="hljs-string"><span class="hljs-subst">EOABORT</span></span><span class="hljs-string"><span class="hljs-subst">)</span>&quot;</span><span class="hljs-keyword">fi</span><span class="hljs-keyword">if</span> [[ -z <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;HOMEBREW_ON_LINUX-&#125;</span>&quot;</span> ]]; <span class="hljs-keyword">then</span>  <span class="hljs-keyword">if</span> version_lt <span class="hljs-string">&quot;<span class="hljs-variable">$macos_version</span>&quot;</span> <span class="hljs-string">&quot;10.7&quot;</span>; <span class="hljs-keyword">then</span>    abort <span class="hljs-string">&quot;<span class="hljs-subst">$(cat &lt;&lt;EOABORT</span></span><span class="hljs-string"><span class="hljs-subst">Your Mac OS X version is too old. See:</span></span><span class="hljs-string"><span class="hljs-subst">  $&#123;tty_underline&#125;https://github.com/mistydemeo/tigerbrew$&#123;tty_reset&#125;</span></span><span class="hljs-string"><span class="hljs-subst">EOABORT</span></span><span class="hljs-string"><span class="hljs-subst">)</span>&quot;</span>  <span class="hljs-keyword">elif</span> version_lt <span class="hljs-string">&quot;<span class="hljs-variable">$macos_version</span>&quot;</span> <span class="hljs-string">&quot;10.9&quot;</span>; <span class="hljs-keyword">then</span>    abort <span class="hljs-string">&quot;Your OS X version is too old&quot;</span>  <span class="hljs-keyword">elif</span> version_gt <span class="hljs-string">&quot;<span class="hljs-variable">$macos_version</span>&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$MACOS_LATEST_SUPPORTED</span>&quot;</span> || \    version_lt <span class="hljs-string">&quot;<span class="hljs-variable">$macos_version</span>&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$MACOS_OLDEST_SUPPORTED</span>&quot;</span>; <span class="hljs-keyword">then</span>    who=<span class="hljs-string">&quot;We&quot;</span>    what=<span class="hljs-string">&quot;&quot;</span>    <span class="hljs-keyword">if</span> version_gt <span class="hljs-string">&quot;<span class="hljs-variable">$macos_version</span>&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$MACOS_LATEST_SUPPORTED</span>&quot;</span>; <span class="hljs-keyword">then</span>      what=<span class="hljs-string">&quot;pre-release version&quot;</span>    <span class="hljs-keyword">else</span>      who+=<span class="hljs-string">&quot; (and Apple)&quot;</span>      what=<span class="hljs-string">&quot;old version&quot;</span>    <span class="hljs-keyword">fi</span>    ohai <span class="hljs-string">&quot;You are using macOS <span class="hljs-variable">$&#123;macos_version&#125;</span>.&quot;</span>    ohai <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;who&#125;</span> do not provide support for this <span class="hljs-variable">$&#123;what&#125;</span>.&quot;</span>    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-subst">$(cat &lt;&lt;EOS</span></span><span class="hljs-string"><span class="hljs-subst">This installation may not succeed.</span></span><span class="hljs-string"><span class="hljs-subst">After installation, you will encounter build failures with some formulae.</span></span><span class="hljs-string"><span class="hljs-subst">Please create pull requests instead of asking for help on Homebrew\&#x27;s GitHub,</span></span><span class="hljs-string"><span class="hljs-subst">Discourse, Twitter or IRC. You are responsible for resolving any issues you</span></span><span class="hljs-string"><span class="hljs-subst">experience while you are running this $&#123;what&#125;.</span></span><span class="hljs-string"><span class="hljs-subst">EOS</span></span><span class="hljs-string"><span class="hljs-subst">)</span></span><span class="hljs-string">&quot;</span>  <span class="hljs-keyword">fi</span><span class="hljs-keyword">fi</span>ohai <span class="hljs-string">&quot;This script will install:&quot;</span><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;HOMEBREW_PREFIX&#125;</span>/bin/brew&quot;</span><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;HOMEBREW_PREFIX&#125;</span>/share/doc/homebrew&quot;</span><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;HOMEBREW_PREFIX&#125;</span>/share/man/man1/brew.1&quot;</span><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;HOMEBREW_PREFIX&#125;</span>/share/zsh/site-functions/_brew&quot;</span><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;HOMEBREW_PREFIX&#125;</span>/etc/bash_completion.d/brew&quot;</span><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;HOMEBREW_REPOSITORY&#125;</span>&quot;</span><span class="hljs-comment"># Keep relatively in sync with</span><span class="hljs-comment"># https://github.com/Homebrew/brew/blob/master/Library/Homebrew/keg.rb</span>directories=(bin etc include lib sbin share opt var             Frameworks             etc/bash_completion.d lib/pkgconfig             share/aclocal share/doc share/info share/locale share/man             share/man/man1 share/man/man2 share/man/man3 share/man/man4             share/man/man5 share/man/man6 share/man/man7 share/man/man8             var/<span class="hljs-built_in">log</span> var/homebrew var/homebrew/linked             bin/brew)group_chmods=()<span class="hljs-keyword">for</span> dir <span class="hljs-keyword">in</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;directories[@]&#125;</span>&quot;</span>; <span class="hljs-keyword">do</span>  <span class="hljs-keyword">if</span> exists_but_not_writable <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;HOMEBREW_PREFIX&#125;</span>/<span class="hljs-variable">$&#123;dir&#125;</span>&quot;</span>; <span class="hljs-keyword">then</span>    group_chmods+=(<span class="hljs-string">&quot;<span class="hljs-variable">$&#123;HOMEBREW_PREFIX&#125;</span>/<span class="hljs-variable">$&#123;dir&#125;</span>&quot;</span>)  <span class="hljs-keyword">fi</span><span class="hljs-keyword">done</span><span class="hljs-comment"># zsh refuses to read from these directories if group writable</span>directories=(share/zsh share/zsh/site-functions)zsh_dirs=()<span class="hljs-keyword">for</span> dir <span class="hljs-keyword">in</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;directories[@]&#125;</span>&quot;</span>; <span class="hljs-keyword">do</span>  zsh_dirs+=(<span class="hljs-string">&quot;<span class="hljs-variable">$&#123;HOMEBREW_PREFIX&#125;</span>/<span class="hljs-variable">$&#123;dir&#125;</span>&quot;</span>)<span class="hljs-keyword">done</span>directories=(bin etc include lib sbin share var opt             share/zsh share/zsh/site-functions             var/homebrew var/homebrew/linked             Cellar Caskroom Homebrew Frameworks)mkdirs=()<span class="hljs-keyword">for</span> dir <span class="hljs-keyword">in</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;directories[@]&#125;</span>&quot;</span>; <span class="hljs-keyword">do</span>  <span class="hljs-keyword">if</span> ! [[ -d <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;HOMEBREW_PREFIX&#125;</span>/<span class="hljs-variable">$&#123;dir&#125;</span>&quot;</span> ]]; <span class="hljs-keyword">then</span>    mkdirs+=(<span class="hljs-string">&quot;<span class="hljs-variable">$&#123;HOMEBREW_PREFIX&#125;</span>/<span class="hljs-variable">$&#123;dir&#125;</span>&quot;</span>)  <span class="hljs-keyword">fi</span><span class="hljs-keyword">done</span>user_chmods=()<span class="hljs-keyword">if</span> [[ <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;#zsh_dirs[@]&#125;</span>&quot;</span> -gt 0 ]]; <span class="hljs-keyword">then</span>  <span class="hljs-keyword">for</span> dir <span class="hljs-keyword">in</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;zsh_dirs[@]&#125;</span>&quot;</span>; <span class="hljs-keyword">do</span>    <span class="hljs-keyword">if</span> user_only_chmod <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;dir&#125;</span>&quot;</span>; <span class="hljs-keyword">then</span>      user_chmods+=(<span class="hljs-string">&quot;<span class="hljs-variable">$&#123;dir&#125;</span>&quot;</span>)    <span class="hljs-keyword">fi</span>  <span class="hljs-keyword">done</span><span class="hljs-keyword">fi</span>chmods=()<span class="hljs-keyword">if</span> [[ <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;#group_chmods[@]&#125;</span>&quot;</span> -gt 0 ]]; <span class="hljs-keyword">then</span>  chmods+=(<span class="hljs-string">&quot;<span class="hljs-variable">$&#123;group_chmods[@]&#125;</span>&quot;</span>)<span class="hljs-keyword">fi</span><span class="hljs-keyword">if</span> [[ <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;#user_chmods[@]&#125;</span>&quot;</span> -gt 0 ]]; <span class="hljs-keyword">then</span>  chmods+=(<span class="hljs-string">&quot;<span class="hljs-variable">$&#123;user_chmods[@]&#125;</span>&quot;</span>)<span class="hljs-keyword">fi</span>chowns=()chgrps=()<span class="hljs-keyword">if</span> [[ <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;#chmods[@]&#125;</span>&quot;</span> -gt 0 ]]; <span class="hljs-keyword">then</span>  <span class="hljs-keyword">for</span> dir <span class="hljs-keyword">in</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;chmods[@]&#125;</span>&quot;</span>; <span class="hljs-keyword">do</span>    <span class="hljs-keyword">if</span> file_not_owned <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;dir&#125;</span>&quot;</span>; <span class="hljs-keyword">then</span>      chowns+=(<span class="hljs-string">&quot;<span class="hljs-variable">$&#123;dir&#125;</span>&quot;</span>)    <span class="hljs-keyword">fi</span>    <span class="hljs-keyword">if</span> file_not_grpowned <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;dir&#125;</span>&quot;</span>; <span class="hljs-keyword">then</span>      chgrps+=(<span class="hljs-string">&quot;<span class="hljs-variable">$&#123;dir&#125;</span>&quot;</span>)    <span class="hljs-keyword">fi</span>  <span class="hljs-keyword">done</span><span class="hljs-keyword">fi</span><span class="hljs-keyword">if</span> [[ <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;#group_chmods[@]&#125;</span>&quot;</span> -gt 0 ]]; <span class="hljs-keyword">then</span>  ohai <span class="hljs-string">&quot;The following existing directories will be made group writable:&quot;</span>  <span class="hljs-built_in">printf</span> <span class="hljs-string">&quot;%s\n&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;group_chmods[@]&#125;</span>&quot;</span><span class="hljs-keyword">fi</span><span class="hljs-keyword">if</span> [[ <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;#user_chmods[@]&#125;</span>&quot;</span> -gt 0 ]]; <span class="hljs-keyword">then</span>  ohai <span class="hljs-string">&quot;The following existing directories will be made writable by user only:&quot;</span>  <span class="hljs-built_in">printf</span> <span class="hljs-string">&quot;%s\n&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;user_chmods[@]&#125;</span>&quot;</span><span class="hljs-keyword">fi</span><span class="hljs-keyword">if</span> [[ <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;#chowns[@]&#125;</span>&quot;</span> -gt 0 ]]; <span class="hljs-keyword">then</span>  ohai <span class="hljs-string">&quot;The following existing directories will have their owner set to <span class="hljs-variable">$&#123;tty_underline&#125;</span><span class="hljs-variable">$&#123;USER&#125;</span><span class="hljs-variable">$&#123;tty_reset&#125;</span>:&quot;</span>  <span class="hljs-built_in">printf</span> <span class="hljs-string">&quot;%s\n&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;chowns[@]&#125;</span>&quot;</span><span class="hljs-keyword">fi</span><span class="hljs-keyword">if</span> [[ <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;#chgrps[@]&#125;</span>&quot;</span> -gt 0 ]]; <span class="hljs-keyword">then</span>  ohai <span class="hljs-string">&quot;The following existing directories will have their group set to <span class="hljs-variable">$&#123;tty_underline&#125;</span><span class="hljs-variable">$&#123;GROUP&#125;</span><span class="hljs-variable">$&#123;tty_reset&#125;</span>:&quot;</span>  <span class="hljs-built_in">printf</span> <span class="hljs-string">&quot;%s\n&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;chgrps[@]&#125;</span>&quot;</span><span class="hljs-keyword">fi</span><span class="hljs-keyword">if</span> [[ <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;#mkdirs[@]&#125;</span>&quot;</span> -gt 0 ]]; <span class="hljs-keyword">then</span>  ohai <span class="hljs-string">&quot;The following new directories will be created:&quot;</span>  <span class="hljs-built_in">printf</span> <span class="hljs-string">&quot;%s\n&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;mkdirs[@]&#125;</span>&quot;</span><span class="hljs-keyword">fi</span><span class="hljs-keyword">if</span> should_install_command_line_tools; <span class="hljs-keyword">then</span>  ohai <span class="hljs-string">&quot;The Xcode Command Line Tools will be installed.&quot;</span><span class="hljs-keyword">fi</span><span class="hljs-keyword">if</span> [[ -t 0 &amp;&amp; -z <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;CI-&#125;</span>&quot;</span> ]]; <span class="hljs-keyword">then</span>  wait_for_user<span class="hljs-keyword">fi</span><span class="hljs-keyword">if</span> [[ -d <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;HOMEBREW_PREFIX&#125;</span>&quot;</span> ]]; <span class="hljs-keyword">then</span>  <span class="hljs-keyword">if</span> [[ <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;#chmods[@]&#125;</span>&quot;</span> -gt 0 ]]; <span class="hljs-keyword">then</span>    execute_sudo <span class="hljs-string">&quot;/bin/chmod&quot;</span> <span class="hljs-string">&quot;u+rwx&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;chmods[@]&#125;</span>&quot;</span>  <span class="hljs-keyword">fi</span>  <span class="hljs-keyword">if</span> [[ <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;#group_chmods[@]&#125;</span>&quot;</span> -gt 0 ]]; <span class="hljs-keyword">then</span>    execute_sudo <span class="hljs-string">&quot;/bin/chmod&quot;</span> <span class="hljs-string">&quot;g+rwx&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;group_chmods[@]&#125;</span>&quot;</span>  <span class="hljs-keyword">fi</span>  <span class="hljs-keyword">if</span> [[ <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;#user_chmods[@]&#125;</span>&quot;</span> -gt 0 ]]; <span class="hljs-keyword">then</span>    execute_sudo <span class="hljs-string">&quot;/bin/chmod&quot;</span> <span class="hljs-string">&quot;755&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;user_chmods[@]&#125;</span>&quot;</span>  <span class="hljs-keyword">fi</span>  <span class="hljs-keyword">if</span> [[ <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;#chowns[@]&#125;</span>&quot;</span> -gt 0 ]]; <span class="hljs-keyword">then</span>    execute_sudo <span class="hljs-string">&quot;<span class="hljs-variable">$CHOWN</span>&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$USER</span>&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;chowns[@]&#125;</span>&quot;</span>  <span class="hljs-keyword">fi</span>  <span class="hljs-keyword">if</span> [[ <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;#chgrps[@]&#125;</span>&quot;</span> -gt 0 ]]; <span class="hljs-keyword">then</span>    execute_sudo <span class="hljs-string">&quot;<span class="hljs-variable">$CHGRP</span>&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$GROUP</span>&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;chgrps[@]&#125;</span>&quot;</span>  <span class="hljs-keyword">fi</span><span class="hljs-keyword">else</span>  execute_sudo <span class="hljs-string">&quot;/bin/mkdir&quot;</span> <span class="hljs-string">&quot;-p&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;HOMEBREW_PREFIX&#125;</span>&quot;</span>  <span class="hljs-keyword">if</span> [[ -z <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;HOMEBREW_ON_LINUX-&#125;</span>&quot;</span> ]]; <span class="hljs-keyword">then</span>    execute_sudo <span class="hljs-string">&quot;<span class="hljs-variable">$CHOWN</span>&quot;</span> <span class="hljs-string">&quot;root:wheel&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;HOMEBREW_PREFIX&#125;</span>&quot;</span>  <span class="hljs-keyword">else</span>    execute_sudo <span class="hljs-string">&quot;<span class="hljs-variable">$CHOWN</span>&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$USER</span>:<span class="hljs-variable">$GROUP</span>&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;HOMEBREW_PREFIX&#125;</span>&quot;</span>  <span class="hljs-keyword">fi</span><span class="hljs-keyword">fi</span><span class="hljs-keyword">if</span> [[ <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;#mkdirs[@]&#125;</span>&quot;</span> -gt 0 ]]; <span class="hljs-keyword">then</span>  execute_sudo <span class="hljs-string">&quot;/bin/mkdir&quot;</span> <span class="hljs-string">&quot;-p&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;mkdirs[@]&#125;</span>&quot;</span>  execute_sudo <span class="hljs-string">&quot;/bin/chmod&quot;</span> <span class="hljs-string">&quot;g+rwx&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;mkdirs[@]&#125;</span>&quot;</span>  execute_sudo <span class="hljs-string">&quot;<span class="hljs-variable">$CHOWN</span>&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$USER</span>&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;mkdirs[@]&#125;</span>&quot;</span>  execute_sudo <span class="hljs-string">&quot;<span class="hljs-variable">$CHGRP</span>&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$GROUP</span>&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;mkdirs[@]&#125;</span>&quot;</span><span class="hljs-keyword">fi</span><span class="hljs-keyword">if</span> ! [[ -d <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;HOMEBREW_CACHE&#125;</span>&quot;</span> ]]; <span class="hljs-keyword">then</span>  <span class="hljs-keyword">if</span> [[ -z <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;HOMEBREW_ON_LINUX-&#125;</span>&quot;</span> ]]; <span class="hljs-keyword">then</span>    execute_sudo <span class="hljs-string">&quot;/bin/mkdir&quot;</span> <span class="hljs-string">&quot;-p&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;HOMEBREW_CACHE&#125;</span>&quot;</span>  <span class="hljs-keyword">else</span>    execute <span class="hljs-string">&quot;/bin/mkdir&quot;</span> <span class="hljs-string">&quot;-p&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;HOMEBREW_CACHE&#125;</span>&quot;</span>  <span class="hljs-keyword">fi</span><span class="hljs-keyword">fi</span><span class="hljs-keyword">if</span> exists_but_not_writable <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;HOMEBREW_CACHE&#125;</span>&quot;</span>; <span class="hljs-keyword">then</span>  execute_sudo <span class="hljs-string">&quot;/bin/chmod&quot;</span> <span class="hljs-string">&quot;g+rwx&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;HOMEBREW_CACHE&#125;</span>&quot;</span><span class="hljs-keyword">fi</span><span class="hljs-keyword">if</span> file_not_owned <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;HOMEBREW_CACHE&#125;</span>&quot;</span>; <span class="hljs-keyword">then</span>  execute_sudo <span class="hljs-string">&quot;<span class="hljs-variable">$CHOWN</span>&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$USER</span>&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;HOMEBREW_CACHE&#125;</span>&quot;</span><span class="hljs-keyword">fi</span><span class="hljs-keyword">if</span> file_not_grpowned <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;HOMEBREW_CACHE&#125;</span>&quot;</span>; <span class="hljs-keyword">then</span>  execute_sudo <span class="hljs-string">&quot;<span class="hljs-variable">$CHGRP</span>&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$GROUP</span>&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;HOMEBREW_CACHE&#125;</span>&quot;</span><span class="hljs-keyword">fi</span><span class="hljs-keyword">if</span> [[ -d <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;HOMEBREW_CACHE&#125;</span>&quot;</span> ]]; <span class="hljs-keyword">then</span>  execute <span class="hljs-string">&quot;<span class="hljs-variable">$TOUCH</span>&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;HOMEBREW_CACHE&#125;</span>/.cleaned&quot;</span><span class="hljs-keyword">fi</span><span class="hljs-keyword">if</span> should_install_command_line_tools &amp;&amp; version_ge <span class="hljs-string">&quot;<span class="hljs-variable">$macos_version</span>&quot;</span> <span class="hljs-string">&quot;10.13&quot;</span>; <span class="hljs-keyword">then</span>  ohai <span class="hljs-string">&quot;Searching online for the Command Line Tools&quot;</span>  <span class="hljs-comment"># This temporary file prompts the &#x27;softwareupdate&#x27; utility to list the Command Line Tools</span>  clt_placeholder=<span class="hljs-string">&quot;/tmp/.com.apple.dt.CommandLineTools.installondemand.in-progress&quot;</span>  execute_sudo <span class="hljs-string">&quot;<span class="hljs-variable">$TOUCH</span>&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$clt_placeholder</span>&quot;</span>  clt_label_command=<span class="hljs-string">&quot;/usr/sbin/softwareupdate -l |</span><span class="hljs-string">                      grep -B 1 -E &#x27;Command Line Tools&#x27; |</span><span class="hljs-string">                      awk -F&#x27;*&#x27; &#x27;/^ *\\*/ &#123;print \$2&#125;&#x27; |</span><span class="hljs-string">                      sed -e &#x27;s/^ *Label: //&#x27; -e &#x27;s/^ *//&#x27; |</span><span class="hljs-string">                      sort -V |</span><span class="hljs-string">                      tail -n1&quot;</span>  clt_label=<span class="hljs-string">&quot;<span class="hljs-subst">$(chomp <span class="hljs-string">&quot;<span class="hljs-subst">$(/bin/bash -c <span class="hljs-string">&quot;<span class="hljs-variable">$clt_label_command</span>&quot;</span>)</span>&quot;</span>)</span>&quot;</span>  <span class="hljs-keyword">if</span> [[ -n <span class="hljs-string">&quot;<span class="hljs-variable">$clt_label</span>&quot;</span> ]]; <span class="hljs-keyword">then</span>    ohai <span class="hljs-string">&quot;Installing <span class="hljs-variable">$clt_label</span>&quot;</span>    execute_sudo <span class="hljs-string">&quot;/usr/sbin/softwareupdate&quot;</span> <span class="hljs-string">&quot;-i&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$clt_label</span>&quot;</span>    execute_sudo <span class="hljs-string">&quot;/bin/rm&quot;</span> <span class="hljs-string">&quot;-f&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$clt_placeholder</span>&quot;</span>    execute_sudo <span class="hljs-string">&quot;/usr/bin/xcode-select&quot;</span> <span class="hljs-string">&quot;--switch&quot;</span> <span class="hljs-string">&quot;/Library/Developer/CommandLineTools&quot;</span>  <span class="hljs-keyword">fi</span><span class="hljs-keyword">fi</span><span class="hljs-comment"># Headless install may have failed, so fallback to original &#x27;xcode-select&#x27; method</span><span class="hljs-keyword">if</span> should_install_command_line_tools &amp;&amp; <span class="hljs-built_in">test</span> -t 0; <span class="hljs-keyword">then</span>  ohai <span class="hljs-string">&quot;Installing the Command Line Tools (expect a GUI popup):&quot;</span>  execute_sudo <span class="hljs-string">&quot;/usr/bin/xcode-select&quot;</span> <span class="hljs-string">&quot;--install&quot;</span>  <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Press any key when the installation has completed.&quot;</span>  getc  execute_sudo <span class="hljs-string">&quot;/usr/bin/xcode-select&quot;</span> <span class="hljs-string">&quot;--switch&quot;</span> <span class="hljs-string">&quot;/Library/Developer/CommandLineTools&quot;</span><span class="hljs-keyword">fi</span><span class="hljs-keyword">if</span> [[ -z <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;HOMEBREW_ON_LINUX-&#125;</span>&quot;</span> ]] &amp;&amp; ! output=<span class="hljs-string">&quot;<span class="hljs-subst">$(/usr/bin/xcrun clang 2&gt;&amp;1)</span>&quot;</span> &amp;&amp; [[ <span class="hljs-string">&quot;<span class="hljs-variable">$output</span>&quot;</span> == *<span class="hljs-string">&quot;license&quot;</span>* ]]; <span class="hljs-keyword">then</span>  abort <span class="hljs-string">&quot;<span class="hljs-subst">$(cat &lt;&lt;EOABORT</span></span><span class="hljs-string"><span class="hljs-subst">You have not agreed to the Xcode license.</span></span><span class="hljs-string"><span class="hljs-subst">Before running the installer again please agree to the license by opening</span></span><span class="hljs-string"><span class="hljs-subst">Xcode.app or running:</span></span><span class="hljs-string"><span class="hljs-subst">    sudo xcodebuild -license</span></span><span class="hljs-string"><span class="hljs-subst">EOABORT</span></span><span class="hljs-string"><span class="hljs-subst">)</span>&quot;</span><span class="hljs-keyword">fi</span>ohai <span class="hljs-string">&quot;Downloading and installing Homebrew...&quot;</span>(  <span class="hljs-built_in">cd</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;HOMEBREW_REPOSITORY&#125;</span>&quot;</span> &gt;/dev/null || <span class="hljs-built_in">return</span>  <span class="hljs-comment"># we do it in four steps to avoid merge errors when reinstalling</span>  execute <span class="hljs-string">&quot;git&quot;</span> <span class="hljs-string">&quot;init&quot;</span> <span class="hljs-string">&quot;-q&quot;</span>  <span class="hljs-comment"># &quot;git remote add&quot; will fail if the remote is defined in the global config</span>  execute <span class="hljs-string">&quot;git&quot;</span> <span class="hljs-string">&quot;config&quot;</span> <span class="hljs-string">&quot;remote.origin.url&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;BREW_REPO&#125;</span>&quot;</span>  execute <span class="hljs-string">&quot;git&quot;</span> <span class="hljs-string">&quot;config&quot;</span> <span class="hljs-string">&quot;remote.origin.fetch&quot;</span> <span class="hljs-string">&quot;+refs/heads/*:refs/remotes/origin/*&quot;</span>  <span class="hljs-comment"># ensure we don&#x27;t munge line endings on checkout</span>  execute <span class="hljs-string">&quot;git&quot;</span> <span class="hljs-string">&quot;config&quot;</span> <span class="hljs-string">&quot;core.autocrlf&quot;</span> <span class="hljs-string">&quot;false&quot;</span>  execute <span class="hljs-string">&quot;git&quot;</span> <span class="hljs-string">&quot;fetch&quot;</span> <span class="hljs-string">&quot;origin&quot;</span> <span class="hljs-string">&quot;--force&quot;</span>  execute <span class="hljs-string">&quot;git&quot;</span> <span class="hljs-string">&quot;fetch&quot;</span> <span class="hljs-string">&quot;origin&quot;</span> <span class="hljs-string">&quot;--tags&quot;</span> <span class="hljs-string">&quot;--force&quot;</span>  execute <span class="hljs-string">&quot;git&quot;</span> <span class="hljs-string">&quot;reset&quot;</span> <span class="hljs-string">&quot;--hard&quot;</span> <span class="hljs-string">&quot;origin/master&quot;</span>  execute <span class="hljs-string">&quot;ln&quot;</span> <span class="hljs-string">&quot;-sf&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;HOMEBREW_REPOSITORY&#125;</span>/bin/brew&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;HOMEBREW_PREFIX&#125;</span>/bin/brew&quot;</span>  execute <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;HOMEBREW_PREFIX&#125;</span>/bin/brew&quot;</span> <span class="hljs-string">&quot;update&quot;</span> <span class="hljs-string">&quot;--force&quot;</span>) || <span class="hljs-built_in">exit</span> 1<span class="hljs-keyword">if</span> [[ <span class="hljs-string">&quot;:<span class="hljs-variable">$&#123;PATH&#125;</span>:&quot;</span> != *<span class="hljs-string">&quot;:<span class="hljs-variable">$&#123;HOMEBREW_PREFIX&#125;</span>/bin:&quot;</span>* ]]; <span class="hljs-keyword">then</span>  warn <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;HOMEBREW_PREFIX&#125;</span>/bin is not in your PATH.&quot;</span><span class="hljs-keyword">fi</span>ohai <span class="hljs-string">&quot;Installation successful!&quot;</span><span class="hljs-built_in">echo</span><span class="hljs-comment"># Use the shell&#x27;s audible bell.</span><span class="hljs-keyword">if</span> [[ -t 1 ]]; <span class="hljs-keyword">then</span>  <span class="hljs-built_in">printf</span> <span class="hljs-string">&quot;\a&quot;</span><span class="hljs-keyword">fi</span><span class="hljs-comment"># Use an extra newline and bold to avoid this being missed.</span>ohai <span class="hljs-string">&quot;Homebrew has enabled anonymous aggregate formulae and cask analytics.&quot;</span><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-subst">$(cat &lt;&lt;EOS</span></span><span class="hljs-string"><span class="hljs-subst">$&#123;tty_bold&#125;Read the analytics documentation (and how to opt-out)</span> here:</span><span class="hljs-string">  <span class="hljs-variable">$&#123;tty_underline&#125;</span>https://docs.brew.sh/Analytics<span class="hljs-variable">$&#123;tty_reset&#125;</span></span><span class="hljs-string">No analytics data has been sent yet (or will be during this \`install\` run).</span><span class="hljs-string">EOS</span><span class="hljs-string">)</span><span class="hljs-string">&quot;</span>ohai <span class="hljs-string">&quot;Homebrew is run entirely by unpaid volunteers. Please consider donating:&quot;</span><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-subst">$(cat &lt;&lt;EOS</span></span><span class="hljs-string"><span class="hljs-subst">  $&#123;tty_underline&#125;https://github.com/Homebrew/brew#donations$&#123;tty_reset&#125;</span></span><span class="hljs-string"><span class="hljs-subst">EOS</span></span><span class="hljs-string"><span class="hljs-subst">)</span></span><span class="hljs-string">&quot;</span>(  <span class="hljs-built_in">cd</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;HOMEBREW_REPOSITORY&#125;</span>&quot;</span> &gt;/dev/null || <span class="hljs-built_in">return</span>  execute <span class="hljs-string">&quot;git&quot;</span> <span class="hljs-string">&quot;config&quot;</span> <span class="hljs-string">&quot;--replace-all&quot;</span> <span class="hljs-string">&quot;homebrew.analyticsmessage&quot;</span> <span class="hljs-string">&quot;true&quot;</span>  execute <span class="hljs-string">&quot;git&quot;</span> <span class="hljs-string">&quot;config&quot;</span> <span class="hljs-string">&quot;--replace-all&quot;</span> <span class="hljs-string">&quot;homebrew.caskanalyticsmessage&quot;</span> <span class="hljs-string">&quot;true&quot;</span>) || <span class="hljs-built_in">exit</span> 1ohai <span class="hljs-string">&quot;Next steps:&quot;</span><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;- Run \`brew help\` to get started&quot;</span><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;- Further documentation: &quot;</span><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;    <span class="hljs-variable">$&#123;tty_underline&#125;</span>https://docs.brew.sh<span class="hljs-variable">$&#123;tty_reset&#125;</span>&quot;</span><span class="hljs-keyword">if</span> [[ -n <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;HOMEBREW_ON_LINUX-&#125;</span>&quot;</span> ]]; <span class="hljs-keyword">then</span>  <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;<span class="hljs-variable">$SHELL</span>&quot;</span> <span class="hljs-keyword">in</span>    */bash*)      <span class="hljs-keyword">if</span> [[ -r <span class="hljs-string">&quot;<span class="hljs-variable">$HOME</span>/.bash_profile&quot;</span> ]]; <span class="hljs-keyword">then</span>        shell_profile=<span class="hljs-string">&quot;<span class="hljs-variable">$HOME</span>/.bash_profile&quot;</span>      <span class="hljs-keyword">else</span>        shell_profile=<span class="hljs-string">&quot;<span class="hljs-variable">$HOME</span>/.profile&quot;</span>      <span class="hljs-keyword">fi</span>      ;;    */zsh*)      shell_profile=<span class="hljs-string">&quot;<span class="hljs-variable">$HOME</span>/.zprofile&quot;</span>      ;;    *)      shell_profile=<span class="hljs-string">&quot;<span class="hljs-variable">$HOME</span>/.profile&quot;</span>      ;;  <span class="hljs-keyword">esac</span>  cat &lt;&lt;<span class="hljs-string">EOS</span><span class="hljs-string">- Install the Homebrew dependencies if you have sudo access:</span><span class="hljs-string">  $&#123;tty_bold&#125;Debian, Ubuntu, etc.$&#123;tty_reset&#125;</span><span class="hljs-string">    sudo apt-get install build-essential</span><span class="hljs-string">  $&#123;tty_bold&#125;Fedora, Red Hat, CentOS, etc.$&#123;tty_reset&#125;</span><span class="hljs-string">    sudo yum groupinstall &#x27;Development Tools&#x27;</span><span class="hljs-string">  See $&#123;tty_underline&#125;https://docs.brew.sh/linux$&#123;tty_reset&#125; for more information.</span><span class="hljs-string">- Configure Homebrew in your $&#123;tty_underline&#125;$&#123;shell_profile&#125;$&#123;tty_reset&#125; by running</span><span class="hljs-string">    echo &#x27;eval \$($&#123;HOMEBREW_PREFIX&#125;/bin/brew shellenv)&#x27; &gt;&gt; $&#123;shell_profile&#125;</span><span class="hljs-string">- Add Homebrew to your $&#123;tty_bold&#125;PATH$&#123;tty_reset&#125;</span><span class="hljs-string">    eval \$($&#123;HOMEBREW_PREFIX&#125;/bin/brew shellenv)</span><span class="hljs-string">- We recommend that you install GCC by running:</span><span class="hljs-string">    brew install gcc</span><span class="hljs-string"></span><span class="hljs-string">EOS</span><span class="hljs-keyword">fi</span></code></pre><p>æ‰§è¡Œå‰,éœ€è¦ç»™æ”¹è„šæœ¬èµ‹æƒé™</p><pre><code class="hljs bash">sudo chmod -R 777 brew_install.sh./brew_install.sh</code></pre><p>ç­‰å¾…å®‰è£…æˆåŠŸ(ä¸­é—´æœ‰è¿‡ä¸¤æ¬¡å¤±è´¥,ä¸»è¦åŸå› æ˜¯åŸæ¥å®‰è£…çš„Homebrewæ²¡æœ‰å¸è½½å¹²å‡€)</p><h4 id="VMware-Fusion"><a href="#VMware-Fusion" class="headerlink" title="VMware Fusion"></a>VMware Fusion</h4><h5 id="ç‰©ç†å†…å­˜ä¸è¶³ï¼Œæ— æ³•ä½¿ç”¨é…ç½®çš„è®¾ç½®å¼€å¯è™šæ‹Ÿæœº"><a href="#ç‰©ç†å†…å­˜ä¸è¶³ï¼Œæ— æ³•ä½¿ç”¨é…ç½®çš„è®¾ç½®å¼€å¯è™šæ‹Ÿæœº" class="headerlink" title="ç‰©ç†å†…å­˜ä¸è¶³ï¼Œæ— æ³•ä½¿ç”¨é…ç½®çš„è®¾ç½®å¼€å¯è™šæ‹Ÿæœº"></a>ç‰©ç†å†…å­˜ä¸è¶³ï¼Œæ— æ³•ä½¿ç”¨é…ç½®çš„è®¾ç½®å¼€å¯è™šæ‹Ÿæœº</h5><p>åŸæ¥çš„VMware Fusion ç‰ˆæœ¬æ˜¯11</p><p><img src="/images/mac/vmfusion_11.png"></p><p>Googleåå‘ç°12å¯ä»¥ç”¨,äºæ˜¯ä¸‹è½½äº†VMware Fusionå®‰è£…,äº²æµ‹å¯ç”¨</p><h5 id="æ— æ³•å°†â€œEthernet0â€è¿æ¥åˆ°è™šæ‹Ÿç½‘ç»œâ€œ-dev-vmnet8â€ã€‚"><a href="#æ— æ³•å°†â€œEthernet0â€è¿æ¥åˆ°è™šæ‹Ÿç½‘ç»œâ€œ-dev-vmnet8â€ã€‚" class="headerlink" title="æ— æ³•å°†â€œEthernet0â€è¿æ¥åˆ°è™šæ‹Ÿç½‘ç»œâ€œ/dev/vmnet8â€ã€‚"></a>æ— æ³•å°†â€œEthernet0â€è¿æ¥åˆ°è™šæ‹Ÿç½‘ç»œâ€œ/dev/vmnet8â€ã€‚</h5><p>VMware Fusionå‡çº§åˆ°12åï¼Œè¿‡äº†å‡ å¤©æ‰“å¼€è™šæ‹Ÿæœºæ—¶ï¼Œå‘ç°â€œEthernet0â€è¿æ¥åˆ°è™šæ‹Ÿç½‘ç»œâ€œ/dev/vmnet8â€</p><p>è°·æ­Œäº†å¥½ä¹…åå‘ç°</p><pre><code class="hljs zsh">sudo rm /Library/Preferences/SystemConfiguration/NetworkInterfaces.plist &amp;&amp; sudo killall -9 configd</code></pre><p>è§£å†³æ–¹å¼æ¥æºï¼š</p><p><a href="https://communities.vmware.com/t5/VMware-Fusion-Discussions/No-Ethernet-Connection-VMware-Fusion-12-macOS-Big-Sur-Beta-6/m-p/2303833#M140209">https://communities.vmware.com/t5/VMware-Fusion-Discussions/No-Ethernet-Connection-VMware-Fusion-12-macOS-Big-Sur-Beta-6/m-p/2303833#M140209</a></p><p>å¦å¤–ï¼Œå½“è‹¹æœç”µè„‘å…±äº«wifiæ—¶ï¼Œä¹Ÿä¼šé€ æˆè¿™ä¸ªç»“æœã€‚æ‰€ä»¥å…±äº«ç½‘ç»œä¹Ÿéœ€è¦å…³é—­ã€‚</p><h3 id="å‘½ä»¤è¡ŒæŸ¥çœ‹ä¿å­˜çš„å¯†ç "><a href="#å‘½ä»¤è¡ŒæŸ¥çœ‹ä¿å­˜çš„å¯†ç " class="headerlink" title="å‘½ä»¤è¡ŒæŸ¥çœ‹ä¿å­˜çš„å¯†ç "></a>å‘½ä»¤è¡ŒæŸ¥çœ‹ä¿å­˜çš„å¯†ç </h3><h4 id="security-find-generic-password-ga-â€œwifiåç§°â€"><a href="#security-find-generic-password-ga-â€œwifiåç§°â€" class="headerlink" title="security find-generic-password -ga â€œwifiåç§°â€"></a>security find-generic-password -ga â€œwifiåç§°â€</h4><p><img src="/images/mac/wifi.png"></p>]]></content>
    
    
    <categories>
      
      <category>Develop</category>
      
    </categories>
    
    
    <tags>
      
      <tag>mac</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€Macã€‘hadoopå¼€å‘ç¯å¢ƒé…ç½®</title>
    <link href="/2020/06/17/hadoop-dev-env/"/>
    <url>/2020/06/17/hadoop-dev-env/</url>
    
    <content type="html"><![CDATA[<blockquote><a id="more"></a></blockquote><h3 id="hdfsçš„java-APIå¼€å‘ç¯å¢ƒå‡†å¤‡"><a href="#hdfsçš„java-APIå¼€å‘ç¯å¢ƒå‡†å¤‡" class="headerlink" title="hdfsçš„java APIå¼€å‘ç¯å¢ƒå‡†å¤‡"></a>hdfsçš„java APIå¼€å‘ç¯å¢ƒå‡†å¤‡</h3><h4 id="ä¿®æ”¹hostsæ–‡ä»¶"><a href="#ä¿®æ”¹hostsæ–‡ä»¶" class="headerlink" title="ä¿®æ”¹hostsæ–‡ä»¶"></a>ä¿®æ”¹hostsæ–‡ä»¶</h4><ul><li><p>macä¸‹ä¿®æ”¹hostsæ–‡ä»¶</p><p>æ–‡ä»¶æ‰€åœ¨ä½ç½®<code>/etc/hosts</code></p><p>å°†è™šæ‹Ÿæœºä¸­/etc/hostsæ–‡ä»¶ä¸€ä¸‹å†…å®¹ï¼Œæ·»åŠ åˆ°ä»¥ä¸Šhostsæ–‡ä»¶æœ«å°¾</p></li></ul><pre><code class="hljs accesslog"><span class="hljs-number">192.168.51.100</span> node01.hadoop.com node01<span class="hljs-number">192.168.51.110</span> node02.hadoop.com node02<span class="hljs-number">192.168.51.120</span> node03.hadoop.com node03</code></pre><h4 id="å®‰è£…jdk"><a href="#å®‰è£…jdk" class="headerlink" title="å®‰è£…jdk"></a>å®‰è£…jdk</h4><p>æ‹·è´é›†ç¾¤ç¯å¢ƒä¸‹çš„jdkåˆ°æœ¬åœ°</p><pre><code class="hljs routeros"><span class="hljs-comment">#æ·»åŠ ä»¥ä¸‹é…ç½®å†…å®¹ï¼Œé…ç½®jdkç¯å¢ƒå˜é‡</span><span class="hljs-builtin-name">export</span> <span class="hljs-attribute">JAVA_HOME</span>=/weitrue/install/jdk1.8.0_141<span class="hljs-builtin-name">export</span> <span class="hljs-attribute">PATH</span>=<span class="hljs-variable">$PATH</span>:$JAVA_HOME/binCopy</code></pre><p>è®©ä¿®æ”¹é©¬ä¸Šç”Ÿæ•ˆ</p><pre><code class="hljs gradle"><span class="hljs-keyword">source</span> <span class="hljs-regexp">/etc/</span>profile</code></pre><h4 id="macä¸‹hadoopç¯å¢ƒé…ç½®"><a href="#macä¸‹hadoopç¯å¢ƒé…ç½®" class="headerlink" title="macä¸‹hadoopç¯å¢ƒé…ç½®"></a>macä¸‹hadoopç¯å¢ƒé…ç½®</h4><p>æ‹·è´é›†ç¾¤ç¯å¢ƒä¸‹<code>hadoop-2.6.0-cdh5.14.2</code>ç›®å½•æ–‡ä»¶åˆ°æœ¬åœ°ï¼Œé…ç½®ç¯å¢ƒå˜é‡</p><p><img src="/images/hadoop-dev-env/hadoop.png"></p><h4 id="å®‰è£…maven"><a href="#å®‰è£…maven" class="headerlink" title="å®‰è£…maven"></a>å®‰è£…maven</h4><h5 id="mavenæ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#mavenæ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="mavenæ˜¯ä»€ä¹ˆï¼Ÿ"></a>mavenæ˜¯ä»€ä¹ˆï¼Ÿ</h5><p>Apache Mavenæ˜¯ä¸€ä¸ªè½¯ä»¶é¡¹ç›®ç®¡ç†å’Œç†è§£å·¥å…·ã€‚åŸºäºé¡¹ç›®å¯¹è±¡æ¨¡å‹ï¼ˆPOMï¼‰çš„æ¦‚å¿µï¼ŒMavenå¯ä»¥ä»ä¸€ä¸ªä¸­å¿ƒä¿¡æ¯ç®¡ç†é¡¹ç›®çš„æ„å»ºï¼ŒæŠ¥å‘Šå’Œæ–‡æ¡£ã€‚</p><h5 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h5><p>è§£å‹å®‰è£…åŒ…<code>apache-maven-3.6.1-bin.zip</code>åˆ°å®‰è£…ç›®å½•</p><p>ç¼–è¾‘<code>.bash_profile</code>ï¼Œæ–°å¢mavenç¯å¢ƒé…ç½®</p><p><img src="/images/hadoop-dev-env/maven.png"></p><h6 id="mavençš„ä»“åº“"><a href="#mavençš„ä»“åº“" class="headerlink" title="mavençš„ä»“åº“"></a>mavençš„ä»“åº“</h6><ul><li><p>åˆ›å»ºmavenå·¥ç¨‹åï¼Œmavenä¼šè‡ªåŠ¨çš„å»æœ¬åœ°ä»“åº“æŸ¥çœ‹æ—¶å€™æœ‰æ‰€éœ€çš„jaråŒ…ï¼Œå¦‚æœæ²¡æœ‰çš„è¯ï¼Œé»˜è®¤å»ä¸­å¤®ä»“åº“ï¼Œå°†jaråŒ…ä¸‹è½½åˆ°æœ¬åœ°ï¼›ä»¥åå¦‚æœå†æ¬¡ä½¿ç”¨æ­¤jaræ—¶ï¼Œå°±ç›´æ¥ä½¿ç”¨æœ¬åœ°ä»“åº“çš„jarå³å¯</p></li><li><p>æ­¤è¿‡ç¨‹æ˜¯mavenè‡ªåŠ¨å®Œæˆçš„</p></li><li><p>æœ¬åœ°ä»“åº“ï¼š</p><p><img src="/images/hadoop-dev-env/repo.png"></p></li><li><p>ç§æœä»“åº“ï¼šå°±æ˜¯æˆ‘ä»¬è‡ªå·±æ­å»ºçš„ä¸€ä¸ªè¿œç¨‹ä»“åº“</p></li><li><p>ä¸­å¤®ä»“åº“ï¼šæ˜¯å®˜æ–¹æˆ–è€…ç¬¬ä¸‰æ–¹æä¾›çš„ä»“åº“</p></li></ul><h6 id="settingsæ–‡ä»¶"><a href="#settingsæ–‡ä»¶" class="headerlink" title="settingsæ–‡ä»¶"></a>settingsæ–‡ä»¶</h6><ul><li>å£°æ˜æ–‡ä»¶è§„èŒƒ</li></ul><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">settings</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://maven.apache.org/SETTINGS/1.0.0&quot;</span></span><span class="hljs-tag">          <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><span class="hljs-tag">          <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;http://maven.apache.org/SETTINGS/1.0.0 http://maven.apache.org/xsd/settings-1.0.0.xsd&quot;</span>&gt;</span></code></pre><ul><li>æœ¬åœ°ä»“åº“è·¯å¾„</li></ul><p><code>&lt;localRepository&gt;/path/to/local/repo&lt;/localRepository&gt;</code></p><ul><li>Mavenæ˜¯å¦éœ€è¦å’Œç”¨æˆ·äº¤äº’ä»¥è·å¾—è¾“å…¥ã€‚å¦‚æœMavenéœ€è¦å’Œç”¨æˆ·äº¤äº’ä»¥è·å¾—è¾“å…¥ï¼Œåˆ™è®¾ç½®æˆtrueï¼Œåä¹‹åˆ™åº”ä¸ºfalseã€‚é»˜è®¤ä¸ºtrue </li></ul><p><code>&lt;interactiveMode&gt;true&lt;/interactiveMode&gt;</code></p><ul><li>è¡¨ç¤ºMavenæ˜¯å¦éœ€è¦åœ¨ç¦»çº¿æ¨¡å¼ä¸‹è¿è¡Œã€‚å¦‚æœæ„å»ºç³»ç»Ÿéœ€è¦åœ¨ç¦»çº¿æ¨¡å¼ä¸‹è¿è¡Œï¼Œåˆ™ä¸ºtrueï¼Œé»˜è®¤ä¸ºfalseã€‚å½“ç”±äºç½‘ç»œè®¾ç½®åŸå› æˆ–è€…å®‰å…¨å› ç´ ï¼Œæ„å»ºæœåŠ¡å™¨ä¸èƒ½è¿æ¥è¿œç¨‹ä»“åº“çš„æ—¶å€™ï¼Œè¯¥é…ç½®å°±ååˆ†æœ‰ç”¨ </li></ul><p><code>&lt;offline&gt;false&lt;/offline&gt;</code></p><ul><li>å½“æ’ä»¶çš„ç»„ç»‡Idï¼ˆgroupIdï¼‰æ²¡æœ‰æ˜¾å¼æä¾›æ—¶ï¼Œä¾›æœå¯»æ’ä»¶ç»„ç»‡Idï¼ˆgroupIdï¼‰çš„åˆ—è¡¨ã€‚è¯¥å…ƒç´ åŒ…å«ä¸€ä¸ªpluginGroupå…ƒç´ åˆ—è¡¨ï¼Œæ¯ä¸ªå­å…ƒç´ åŒ…å«äº†ä¸€ä¸ªç»„ç»‡Idï¼ˆgroupIdï¼‰ã€‚</li></ul><p><code>pluginGroups</code></p><ul><li>ä¸ºä»“åº“åˆ—è¡¨é…ç½®çš„ä¸‹è½½é•œåƒåˆ—è¡¨ </li></ul><p><code>mirrors</code></p><h6 id="pomæ–‡ä»¶"><a href="#pomæ–‡ä»¶" class="headerlink" title="pomæ–‡ä»¶"></a>pomæ–‡ä»¶</h6><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">modelVersion</span>&gt;</span>4.0.0<span class="hljs-tag">&lt;/<span class="hljs-name">modelVersion</span>&gt;</span>     é¡¹ç›®çš„æ¨¡æ¿ç‰ˆæœ¬<span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.hadoop<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>         å¯ä»¥ç”¨è¿™ä¸ªæ¥æ ‡è¯†å…¬å¸<span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>TestFlume<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>     å¯ä»¥æ ‡è¯†å·¥ç¨‹çš„ä½œç”¨<span class="hljs-tag">&lt;<span class="hljs-name">packaging</span>&gt;</span>jar<span class="hljs-tag">&lt;/<span class="hljs-name">packaging</span>&gt;</span>             æŒ‡å®šæ‰“åŒ…ç±»å‹       <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.0-SNAPSHOT<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>        åˆ¶å®šé¡¹ç›®ç‰ˆæœ¬<span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span>...<span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span>       é¡¹ç›®çš„ä¾èµ–å…³ç³»<span class="hljs-tag">&lt;<span class="hljs-name">build</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">build</span>&gt;</span>                        æ„å»ºé¡¹ç›®çš„ä¿¡æ¯</code></pre><p>æ€»é¡¹ç›®/ pom.xml æ€»é¡¹ç›®çš„pomé…ç½®æ–‡ä»¶ </p><p>å­é¡¹ç›®1/ pom.xml å­é¡¹ç›®1çš„pomæ–‡ä»¶ </p><p>å­é¡¹ç›®2/ pom.xml å­é¡¹ç›®2çš„pomæ–‡ä»¶ </p><h6 id="mavenç®€å•çš„å‘½ä»¤"><a href="#mavenç®€å•çš„å‘½ä»¤" class="headerlink" title="mavenç®€å•çš„å‘½ä»¤"></a>mavenç®€å•çš„å‘½ä»¤</h6><p>mvn clean </p><p>mvn clean package</p><p>mvn install:install-file -Dfile=junit-3.8.2.jar -DgroupId=junit -DartifactId=junit -Dversion=3.8.2 -Dpackaging=jar</p><p>å¦‚æœä¾èµ–ä¸‹è½½æœ‰é—®é¢˜ï¼Œéœ€è¦è‡ªå·±æ·»åŠ ä¾èµ–åŒ…è¿›ä»“åº“ï¼Œä¸è¦å¤åˆ¶ç²˜è´´ï¼Œè¦ç”¨ mvn installè¿™ä¸ªå‘½ä»¤å°†jaråŒ…æ‰“è¿›ä»“åº“</p><h5 id="å®‰è£…idea"><a href="#å®‰è£…idea" class="headerlink" title="å®‰è£…idea"></a>å®‰è£…idea</h5>]]></content>
    
    
    <categories>
      
      <category>Bdata</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Hadoop</tag>
      
      <tag>å¤§æ•°æ®</tag>
      
      <tag>mac</tag>
      
      <tag>Java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€Macã€‘æ­å»ºhadoopé›†ç¾¤ç¯å¢ƒï¼ˆä¸‰å°ï¼‰</title>
    <link href="/2020/06/15/hadoop-env/"/>
    <url>/2020/06/15/hadoop-env/</url>
    
    <content type="html"><![CDATA[<blockquote><p>The Apache Hadoop software library is a framework that allows for the distributed processing of large data sets across clusters of computers using simple programming models. It is designed to scale up from single servers to thousands of machines, each offering local computation and storage. Rather than rely on hardware to deliver high-availability, the library itself is designed to detect and handle failures at the application layer, so delivering a highly-available service on top of a cluster of computers, each of which may be prone to failures.<a id="more"></a> </p></blockquote><h3 id="1-ä¸‰å°linuxæœåŠ¡å™¨çš„å®‰è£…"><a href="#1-ä¸‰å°linuxæœåŠ¡å™¨çš„å®‰è£…" class="headerlink" title="1. ä¸‰å°linuxæœåŠ¡å™¨çš„å®‰è£…"></a>1. ä¸‰å°linuxæœåŠ¡å™¨çš„å®‰è£…</h3><h4 id="1-å®‰è£…VmWare-Fusion"><a href="#1-å®‰è£…VmWare-Fusion" class="headerlink" title="1. å®‰è£…VmWare Fusion"></a>1. å®‰è£…VmWare Fusion</h4><p><img src="/images/hadoop-env/fusion.png"></p><h4 id="2-é€šè¿‡Vmwareå®‰è£…ä¸‰å°linuxæœºå™¨"><a href="#2-é€šè¿‡Vmwareå®‰è£…ä¸‰å°linuxæœºå™¨" class="headerlink" title="2.é€šè¿‡Vmwareå®‰è£…ä¸‰å°linuxæœºå™¨"></a>2.é€šè¿‡Vmwareå®‰è£…ä¸‰å°linuxæœºå™¨</h4><p><img src="/images/hadoop-env/linux.png"></p><h4 id="3-ä¸ºlinuxè™šæ‹Ÿæœºè®¾ç½®ç½‘ç»œé…ç½®"><a href="#3-ä¸ºlinuxè™šæ‹Ÿæœºè®¾ç½®ç½‘ç»œé…ç½®" class="headerlink" title="3.ä¸ºlinuxè™šæ‹Ÿæœºè®¾ç½®ç½‘ç»œé…ç½®"></a>3.ä¸ºlinuxè™šæ‹Ÿæœºè®¾ç½®ç½‘ç»œé…ç½®</h4><p>å®‰è£…VMWare FusionæˆåŠŸåï¼ŒMac OSä¼šæ–°å¢ä¸¤å¼ ç½‘å¡vmnet1ä»¥åŠvmnet8ï¼Œå…¶ä¸­vmnet1æ˜¯Host-onlyæ¨¡å¼ï¼Œvmnet8æ˜¯NATæ¨¡å¼ï¼Œè¿™é‡Œé€‰æ‹©vmnet8ä½¿ç”¨NATè¿›è¡Œç½‘ç»œè®¾ç½®ã€‚</p><h5 id="1-ä¿®æ”¹Fusionç½‘ç»œé…ç½®"><a href="#1-ä¿®æ”¹Fusionç½‘ç»œé…ç½®" class="headerlink" title="1.ä¿®æ”¹Fusionç½‘ç»œé…ç½®"></a>1.ä¿®æ”¹Fusionç½‘ç»œé…ç½®</h5><p>ä¿®æ”¹é…ç½®æ–‡ä»¶:/Library/Preferences/VMware\ Fusion/networking</p><p><img src="/images/hadoop-env/fusion_net.png"></p><h5 id="2-ä¿®æ”¹ç½‘å…³"><a href="#2-ä¿®æ”¹ç½‘å…³" class="headerlink" title="2.ä¿®æ”¹ç½‘å…³"></a>2.ä¿®æ”¹ç½‘å…³</h5><p>ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼š/Library/Preferences/VMware Fusion/vmnet8/nat.conf</p><p><img src="/images/hadoop-env/net8.png"></p><h5 id="3-ä¿®æ”¹linuxè™šæ‹Ÿæœºç½‘å¡"><a href="#3-ä¿®æ”¹linuxè™šæ‹Ÿæœºç½‘å¡" class="headerlink" title="3.ä¿®æ”¹linuxè™šæ‹Ÿæœºç½‘å¡"></a>3.ä¿®æ”¹linuxè™šæ‹Ÿæœºç½‘å¡</h5><p>ä¿®æ”¹é…ç½®æ–‡ä»¶(æœåŠ¡å™¨ç‰ˆlinux):/etc/sysconfig/network-scripts/ifcfg-ens33</p><p><img src="/images/hadoop-env/linux_net.png"></p><p>æ›´æ”¹å®Œæˆé…ç½®ï¼Œé‡å¯ç½‘ç»œæœåŠ¡</p><pre><code class="hljs shell">systemctl restart network</code></pre><p>å®‰è£…ä¸€äº›å¸¸ç”¨çš„è½¯ä»¶</p><pre><code class="hljs shell">yum -y install vimyum -y install net-tools</code></pre><p>å…³æœº</p><pre><code class="hljs angelscript">init <span class="hljs-number">0</span></code></pre><h5 id="4-å…‹éš†ç¬¬ä¸€å°linuxè™šæ‹Ÿæœº"><a href="#4-å…‹éš†ç¬¬ä¸€å°linuxè™šæ‹Ÿæœº" class="headerlink" title="4.å…‹éš†ç¬¬ä¸€å°linuxè™šæ‹Ÿæœº"></a>4.å…‹éš†ç¬¬ä¸€å°linuxè™šæ‹Ÿæœº</h5><p>ç°åœ¨å·²ç»æœ‰äº†ç§å­æœºå™¨äº†ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ç§å­æœºå™¨è¿›è¡Œå¤åˆ¶æˆ–è€…å…‹éš†å‡ºä¸‰å°æœºå™¨</p><h6 id="æ›´æ”¹å…‹éš†æœºå™¨çš„IPåœ°å€"><a href="#æ›´æ”¹å…‹éš†æœºå™¨çš„IPåœ°å€" class="headerlink" title="æ›´æ”¹å…‹éš†æœºå™¨çš„IPåœ°å€"></a>æ›´æ”¹å…‹éš†æœºå™¨çš„IPåœ°å€</h6><ul><li><p>ä¸‰å°æœºå™¨çš„ipåœ°å€åˆ†åˆ«æ˜¯<code>192.168.51.100ã€192.168.51.110ã€192.168.51.120</code></p></li><li><p>å…‹éš†å‡ºæ¥çš„æœºå™¨IPåœ°å€ä¸ç§å­çš„ipåœ°å€ä¸€æ ·ï¼Œæˆ‘ä»¬å°†ç¬¬äºŒå°æœºå™¨çš„IPåœ°å€æ›´æ”¹ä¸º192.168.51.110å³å¯</p></li><li><p>å¯åŠ¨è™šæ‹Ÿæœºï¼Œå¹¶é€šè¿‡rootç”¨æˆ·ï¼Œå¯†ç ******æ¥è¿›è¡Œç™»å½•ï¼Œç„¶åæ¥æ›´æ”¹linuxæœºå™¨çš„IPåœ°å€</p></li></ul><pre><code class="hljs shell">vi /etc/sysconfig/network-scripts/ifcfg-ens33</code></pre><pre><code class="hljs shell">IPADDR=192.168.51.110NETMASK=255.255.255.0GATEWAY=192.168.51.1DNS1=8.8.8.8</code></pre><ul><li><p>ä¾ç…§ä¸Šé¢æ­¥éª¤ï¼Œæ¥ç€å…‹éš†ç¬¬ä¸‰å°æœºå™¨ï¼Œå¹¶å°†ç¬¬ä¸‰å°æœºå™¨çš„IPåœ°å€è®¾ç½®ä¸º</p><p>192.168.51.120</p></li></ul><h3 id="2-å®‰è£…å¤§æ•°æ®é›†ç¾¤å‰ç¯å¢ƒå‡†å¤‡"><a href="#2-å®‰è£…å¤§æ•°æ®é›†ç¾¤å‰ç¯å¢ƒå‡†å¤‡" class="headerlink" title="2.å®‰è£…å¤§æ•°æ®é›†ç¾¤å‰ç¯å¢ƒå‡†å¤‡"></a>2.å®‰è£…å¤§æ•°æ®é›†ç¾¤å‰ç¯å¢ƒå‡†å¤‡</h3><h4 id="1-ä¸‰å°è™šæ‹Ÿæœºå…³é—­é˜²ç«å¢™"><a href="#1-ä¸‰å°è™šæ‹Ÿæœºå…³é—­é˜²ç«å¢™" class="headerlink" title="1. ä¸‰å°è™šæ‹Ÿæœºå…³é—­é˜²ç«å¢™"></a>1. ä¸‰å°è™šæ‹Ÿæœºå…³é—­é˜²ç«å¢™</h4><p>ä¸‰å°æœºå™¨æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼ˆ<font color="red">root</font>ç”¨æˆ·æ¥æ‰§è¡Œï¼‰</p><pre><code class="hljs shell">systemctl stop firewalldsystemctl disable firewalld</code></pre><h4 id="2-ä¸‰å°æœºå™¨å…³é—­selinux"><a href="#2-ä¸‰å°æœºå™¨å…³é—­selinux" class="headerlink" title="2. ä¸‰å°æœºå™¨å…³é—­selinux"></a>2. ä¸‰å°æœºå™¨å…³é—­selinux</h4><p>ä¸‰å°æœºå™¨æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å…³é—­selinux</p><pre><code class="hljs shell">vim /etc/sysconfig/selinuxSELINUX=disabled</code></pre><h4 id="3-ä¸‰å°æœºå™¨æ›´æ”¹ä¸»æœºå"><a href="#3-ä¸‰å°æœºå™¨æ›´æ”¹ä¸»æœºå" class="headerlink" title="3. ä¸‰å°æœºå™¨æ›´æ”¹ä¸»æœºå"></a>3. ä¸‰å°æœºå™¨æ›´æ”¹ä¸»æœºå</h4><p>ä¸‰å°æœºå™¨æ‰§è¡Œä»¥ä¸‹å‘½ä»¤æ›´æ”¹ä¸»æœºå</p><pre><code class="hljs shell">vim /etc/hostname</code></pre><p>ç¬¬ä¸€å°æœºå™¨æ›´æ”¹å†…å®¹</p><pre><code class="hljs css"><span class="hljs-selector-tag">node01</span><span class="hljs-selector-class">.hadoop</span><span class="hljs-selector-class">.com</span></code></pre><p>ç¬¬äºŒå°æœºå™¨æ›´æ”¹å†…å®¹</p><pre><code class="hljs css"><span class="hljs-selector-tag">node02</span><span class="hljs-selector-class">.hadoop</span><span class="hljs-selector-class">.com</span></code></pre><p>ç¬¬ä¸‰å°æœºå™¨æ›´æ”¹å†…å®¹</p><pre><code class="hljs css"><span class="hljs-selector-tag">node03</span><span class="hljs-selector-class">.hadoop</span><span class="hljs-selector-class">.com</span></code></pre><h4 id="4-ä¸‰å°æœºå™¨åšä¸»æœºåä¸IPåœ°å€çš„æ˜ å°„"><a href="#4-ä¸‰å°æœºå™¨åšä¸»æœºåä¸IPåœ°å€çš„æ˜ å°„" class="headerlink" title="4. ä¸‰å°æœºå™¨åšä¸»æœºåä¸IPåœ°å€çš„æ˜ å°„"></a>4. ä¸‰å°æœºå™¨åšä¸»æœºåä¸IPåœ°å€çš„æ˜ å°„</h4><p>ä¸‰å°æœºå™¨æ‰§è¡Œä»¥ä¸‹å‘½ä»¤æ›´æ”¹ä¸»æœºåä¸IPåœ°å€çš„æ˜ å°„/etc/hosts</p><pre><code class="hljs shell">192.168.51.100 node01.hadoop.com node01192.168.51.110 node02.hadoop.com node02192.168.51.120 node03.hadoop.com node03</code></pre><h4 id="5-ä¸‰å°æœºå™¨æ—¶é’ŸåŒæ­¥"><a href="#5-ä¸‰å°æœºå™¨æ—¶é’ŸåŒæ­¥" class="headerlink" title="5. ä¸‰å°æœºå™¨æ—¶é’ŸåŒæ­¥"></a>5. ä¸‰å°æœºå™¨æ—¶é’ŸåŒæ­¥</h4><h5 id="ç¬¬ä¸€ç§åŒæ­¥æ–¹å¼ï¼šé€šè¿‡ç½‘ç»œè¿›è¡Œæ—¶é’ŸåŒæ­¥"><a href="#ç¬¬ä¸€ç§åŒæ­¥æ–¹å¼ï¼šé€šè¿‡ç½‘ç»œè¿›è¡Œæ—¶é’ŸåŒæ­¥" class="headerlink" title="ç¬¬ä¸€ç§åŒæ­¥æ–¹å¼ï¼šé€šè¿‡ç½‘ç»œè¿›è¡Œæ—¶é’ŸåŒæ­¥"></a>ç¬¬ä¸€ç§åŒæ­¥æ–¹å¼ï¼šé€šè¿‡ç½‘ç»œè¿›è¡Œæ—¶é’ŸåŒæ­¥</h5><p>é€šè¿‡ç½‘ç»œè¿æ¥å¤–ç½‘è¿›è¡Œæ—¶é’ŸåŒæ­¥,å¿…é¡»ä¿è¯è™šæ‹Ÿæœºè¿ä¸Šå¤–ç½‘</p><p>ä¸‰å°æœºå™¨éƒ½å®‰è£…ntpdate</p><pre><code class="hljs shell">yum -y install ntpdate</code></pre><p>é˜¿é‡Œäº‘æ—¶é’ŸåŒæ­¥æœåŠ¡å™¨</p><pre><code class="hljs css"><span class="hljs-selector-tag">ntpdate</span> <span class="hljs-selector-tag">ntp4</span><span class="hljs-selector-class">.aliyun</span><span class="hljs-selector-class">.com</span></code></pre><p>ä¸‰å°æœºå™¨å®šæ—¶ä»»åŠ¡</p><pre><code class="hljs shell">crontab -e</code></pre><p>æ·»åŠ å¦‚ä¸‹å†…å®¹</p><pre><code class="hljs shell">*/1 * * * * /usr/sbin/ntpdate ntp4.aliyun.com;</code></pre><h4 id="6-ä¸‰å°æœºå™¨æ·»åŠ æ™®é€šç”¨æˆ·"><a href="#6-ä¸‰å°æœºå™¨æ·»åŠ æ™®é€šç”¨æˆ·" class="headerlink" title="6. ä¸‰å°æœºå™¨æ·»åŠ æ™®é€šç”¨æˆ·"></a>6. ä¸‰å°æœºå™¨æ·»åŠ æ™®é€šç”¨æˆ·</h4><p>ä¸‰å°linuxæœåŠ¡å™¨ç»Ÿä¸€æ·»åŠ æ™®é€šç”¨æˆ·hadoopï¼Œå¹¶ç»™ä»¥sudoæƒé™ï¼Œç”¨äºä»¥åæ‰€æœ‰çš„å¤§æ•°æ®è½¯ä»¶çš„å®‰è£…</p><p>å¹¶ç»Ÿä¸€è®¾ç½®æ™®é€šç”¨æˆ·çš„å¯†ç ä¸º ==<strong>**</strong>==</p><pre><code class="hljs shell">useradd hadooppasswd hadoop</code></pre><p>æ™®é€šç”¨æˆ·çš„å¯†ç è®¾ç½®ä¸º******</p><p>ä¸‰å°æœºå™¨ä¸ºæ™®é€šç”¨æˆ·æ·»åŠ sudoæƒé™</p><pre><code class="hljs shell">visudo</code></pre><p> å¢åŠ å¦‚ä¸‹å†…å®¹</p><pre><code class="hljs shell">hadoop ALL=(ALL)    ALL</code></pre><h4 id="7-ä¸‰å°å®šä¹‰ç»Ÿä¸€ç›®å½•"><a href="#7-ä¸‰å°å®šä¹‰ç»Ÿä¸€ç›®å½•" class="headerlink" title="7. ä¸‰å°å®šä¹‰ç»Ÿä¸€ç›®å½•"></a>7. ä¸‰å°å®šä¹‰ç»Ÿä¸€ç›®å½•</h4><p>å®šä¹‰ä¸‰å°linuxæœåŠ¡å™¨è½¯ä»¶å‹ç¼©åŒ…å­˜æ”¾ç›®å½•ï¼Œä»¥åŠè§£å‹åå®‰è£…ç›®å½•ï¼Œä¸‰å°æœºå™¨æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œåˆ›å»ºä¸¤ä¸ªæ–‡ä»¶å¤¹ï¼Œä¸€ä¸ªç”¨äºå­˜æ”¾è½¯ä»¶å‹ç¼©åŒ…ç›®å½•ï¼Œä¸€ä¸ªç”¨äºå­˜æ”¾è§£å‹åç›®å½•</p><pre><code class="hljs shell">mkdir -p /weitrue/soft   # è½¯ä»¶å‹ç¼©åŒ…å­˜æ”¾ç›®å½•mkdir -p /weitrue/install # è½¯ä»¶è§£å‹åå­˜æ”¾ç›®å½•chown -R hadoop:hadoop /weitrue  # å°†æ–‡ä»¶å¤¹æƒé™æ›´æ”¹ä¸ºhadoopç”¨æˆ·</code></pre><h4 id="8-ä¸‰å°æœºå™¨hadoopç”¨æˆ·å…å¯†ç ç™»å½•"><a href="#8-ä¸‰å°æœºå™¨hadoopç”¨æˆ·å…å¯†ç ç™»å½•" class="headerlink" title="8. ä¸‰å°æœºå™¨hadoopç”¨æˆ·å…å¯†ç ç™»å½•"></a>8. ä¸‰å°æœºå™¨hadoopç”¨æˆ·å…å¯†ç ç™»å½•</h4><p>åˆ‡æ¢ç”¨æˆ·ä¸ºhadoop</p><pre><code class="hljs shell">su hadoop</code></pre><p>ç¬¬ä¸€æ­¥ï¼šä¸‰å°æœºå™¨åœ¨<font color="red">hadoop</font>ç”¨æˆ·ä¸‹æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ç”Ÿæˆå…¬é’¥ä¸ç§é’¥</p><pre><code class="hljs shell">ssh-keygen -t rsa</code></pre><p><font color="red">æ‰§è¡Œä¸Šè¿°å‘½ä»¤ä¹‹åï¼ŒæŒ‰ä¸‰æ¬¡Enteré”®å³å¯ç”Ÿæˆäº†</font></p><p>ç¬¬äºŒæ­¥ï¼šä¸‰å°æœºå™¨åœ¨hadoopç”¨æˆ·ä¸‹ï¼Œæ‰§è¡Œå‘½ä»¤æ‹·è´å…¬é’¥åˆ°node01æœåŠ¡å™¨</p><pre><code class="hljs shell">ssh-copy-id node01</code></pre><p>ç¬¬ä¸‰æ­¥ï¼šnode01æœåŠ¡å™¨å°†å…¬é’¥æ‹·è´ç»™node02ä¸node03</p><p>node01åœ¨hadoopç”¨æˆ·ä¸‹ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œå°†authorized_keysæ‹·è´åˆ°node02ä¸node03æœåŠ¡å™¨</p><pre><code class="hljs shell">cd /home/hadoop/.ssh/scp authorized_keys node02:$PWDscp authorized_keys node03:$PWD</code></pre><p>ç¬¬å››æ­¥ï¼šéªŒè¯ï¼›ä»ä»»æ„èŠ‚ç‚¹æ˜¯å¦èƒ½å…ç§˜é’¥ç™»é™†å…¶ä»–èŠ‚ç‚¹ï¼›å¦‚node01å…å¯†ç™»é™†node02</p><pre><code class="hljs sh">ssh node02</code></pre><h4 id="9-ä¸‰å°æœºå™¨å…³æœºé‡å¯"><a href="#9-ä¸‰å°æœºå™¨å…³æœºé‡å¯" class="headerlink" title="9. ä¸‰å°æœºå™¨å…³æœºé‡å¯"></a>9. ä¸‰å°æœºå™¨å…³æœºé‡å¯</h4><p>ä¸‰å°æœºå™¨åœ¨hadoopç”¨æˆ·ä¸‹æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œå®ç°å…³æœºé‡å¯</p><pre><code class="hljs shell">sudo reboot -h now</code></pre><h4 id="10-ä¸‰å°æœºå™¨å®‰è£…jdk"><a href="#10-ä¸‰å°æœºå™¨å®‰è£…jdk" class="headerlink" title="10. ä¸‰å°æœºå™¨å®‰è£…jdk"></a>10. ä¸‰å°æœºå™¨å®‰è£…jdk</h4><ul><li><p>ä½¿ç”¨hadoopç”¨æˆ·æ¥é‡æ–°è¿æ¥ä¸‰å°æœºå™¨ï¼Œç„¶åä½¿ç”¨hadoopç”¨æˆ·æ¥å®‰è£…jdkè½¯ä»¶</p></li><li><p>ä¸Šä¼ å‹ç¼©åŒ…åˆ°ç¬¬ä¸€å°æœåŠ¡å™¨çš„/weitrue/softä¸‹é¢ï¼Œç„¶åè¿›è¡Œè§£å‹ï¼Œé…ç½®ç¯å¢ƒå˜é‡å³å¯ï¼Œä¸‰å°æœºå™¨éƒ½ä¾æ¬¡å®‰è£…å³å¯</p></li></ul><pre><code class="hljs shell">cd /weitrue/soft/tar -xzvf jdk-8u141-linux-x64.tar.gz -C /weitrue/install/sudo vim /etc/profile</code></pre><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">æ·»åŠ ä»¥ä¸‹é…ç½®å†…å®¹ï¼Œé…ç½®jdkç¯å¢ƒå˜é‡</span>export JAVA_HOME=/weitrue/install/jdk1.8.0_141export PATH=$PATH:$JAVA_HOME/bin</code></pre><p>è®©ä¿®æ”¹é©¬ä¸Šç”Ÿæ•ˆ</p><pre><code class="hljs shell">source /etc/profile</code></pre><h3 id="3-hadoopé›†ç¾¤çš„å®‰è£…"><a href="#3-hadoopé›†ç¾¤çš„å®‰è£…" class="headerlink" title="3. hadoopé›†ç¾¤çš„å®‰è£…"></a>3. hadoopé›†ç¾¤çš„å®‰è£…</h3><p>æ³¨æ„ï¼šè¿™é‡Œä½¿ç”¨æ‰“åŒ…å¥½çš„åŒ…â€œhadoop-2.6.0-cdh5.14.2_after_compile.tar.gzâ€å®‰è£…éƒ¨ç½²é›†ç¾¤</p><p>ç¼–è¯‘æ²¡æœ‰ä»€ä¹ˆæŠ€å·§ï¼Œä¸»è¦è·Ÿç½‘ç»œå¥½åæœ‰å…³</p><h4 id="1-CDHè½¯ä»¶ç‰ˆæœ¬é‡æ–°è¿›è¡Œç¼–è¯‘"><a href="#1-CDHè½¯ä»¶ç‰ˆæœ¬é‡æ–°è¿›è¡Œç¼–è¯‘" class="headerlink" title="1. CDHè½¯ä»¶ç‰ˆæœ¬é‡æ–°è¿›è¡Œç¼–è¯‘"></a>1. CDHè½¯ä»¶ç‰ˆæœ¬é‡æ–°è¿›è¡Œç¼–è¯‘</h4><h4 id="2-hadoopé›†ç¾¤çš„å®‰è£…"><a href="#2-hadoopé›†ç¾¤çš„å®‰è£…" class="headerlink" title="2. hadoopé›†ç¾¤çš„å®‰è£…"></a>2. hadoopé›†ç¾¤çš„å®‰è£…</h4><p>å®‰è£…ç¯å¢ƒæœåŠ¡éƒ¨ç½²è§„åˆ’</p><table><thead><tr><th>æœåŠ¡å™¨IP</th><th>192.168.51.100</th><th>192.168.51.110</th><th>192.168.51.120</th></tr></thead><tbody><tr><td>HDFS</td><td>NameNode</td><td></td><td></td></tr><tr><td>HDFS</td><td>SecondaryNameNode</td><td></td><td></td></tr><tr><td>HDFS</td><td>DataNode</td><td>DataNode</td><td>DataNode</td></tr><tr><td>YARN</td><td>ResourceManager</td><td></td><td></td></tr><tr><td>YARN</td><td>NodeManager</td><td>NodeManager</td><td>NodeManager</td></tr><tr><td>å†å²æ—¥å¿—æœåŠ¡å™¨</td><td>JobHistoryServer</td><td></td><td></td></tr></tbody></table><h5 id="ç¬¬ä¸€æ­¥ï¼šä¸Šä¼ å‹ç¼©åŒ…å¹¶è§£å‹"><a href="#ç¬¬ä¸€æ­¥ï¼šä¸Šä¼ å‹ç¼©åŒ…å¹¶è§£å‹" class="headerlink" title="ç¬¬ä¸€æ­¥ï¼šä¸Šä¼ å‹ç¼©åŒ…å¹¶è§£å‹"></a>ç¬¬ä¸€æ­¥ï¼šä¸Šä¼ å‹ç¼©åŒ…å¹¶è§£å‹</h5><ul><li>å°†æˆ‘ä»¬é‡æ–°ç¼–è¯‘ä¹‹åæ”¯æŒsnappyå‹ç¼©çš„hadoopåŒ…ä¸Šä¼ åˆ°ç¬¬ä¸€å°æœåŠ¡å™¨å¹¶è§£å‹ï¼›ç¬¬ä¸€å°æœºå™¨æ‰§è¡Œä»¥ä¸‹å‘½ä»¤</li></ul><pre><code class="hljs shell">cd /weitrue/soft/tar -xzvf hadoop-2.6.0-cdh5.14.2_after_compile.tar.gz -C /weitrue/install/</code></pre><h5 id="ç¬¬äºŒæ­¥ï¼šæŸ¥çœ‹hadoopæ”¯æŒçš„å‹ç¼©æ–¹å¼ä»¥åŠæœ¬åœ°åº“"><a href="#ç¬¬äºŒæ­¥ï¼šæŸ¥çœ‹hadoopæ”¯æŒçš„å‹ç¼©æ–¹å¼ä»¥åŠæœ¬åœ°åº“" class="headerlink" title="ç¬¬äºŒæ­¥ï¼šæŸ¥çœ‹hadoopæ”¯æŒçš„å‹ç¼©æ–¹å¼ä»¥åŠæœ¬åœ°åº“"></a>ç¬¬äºŒæ­¥ï¼šæŸ¥çœ‹hadoopæ”¯æŒçš„å‹ç¼©æ–¹å¼ä»¥åŠæœ¬åœ°åº“</h5><p>ç¬¬ä¸€å°æœºå™¨æ‰§è¡Œä»¥ä¸‹å‘½ä»¤</p><pre><code class="hljs shell">cd /weitrue/install/hadoop-2.6.0-cdh5.14.2bin/hadoop checknative</code></pre><p>å¦‚æœå‡ºç°opensslä¸ºfalseï¼Œé‚£ä¹ˆæ‰€æœ‰æœºå™¨åœ¨çº¿å®‰è£…opensslå³å¯ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œè™šæ‹Ÿæœºè”ç½‘ä¹‹åå°±å¯ä»¥åœ¨çº¿è¿›è¡Œå®‰è£…äº†</p><pre><code class="hljs shell">sudo yum -y install openssl-devel</code></pre><h5 id="ç¬¬ä¸‰æ­¥ï¼šä¿®æ”¹é…ç½®æ–‡ä»¶"><a href="#ç¬¬ä¸‰æ­¥ï¼šä¿®æ”¹é…ç½®æ–‡ä»¶" class="headerlink" title="ç¬¬ä¸‰æ­¥ï¼šä¿®æ”¹é…ç½®æ–‡ä»¶"></a>ç¬¬ä¸‰æ­¥ï¼šä¿®æ”¹é…ç½®æ–‡ä»¶</h5><h6 id="ä¿®æ”¹hadoop-env-sh"><a href="#ä¿®æ”¹hadoop-env-sh" class="headerlink" title="ä¿®æ”¹hadoop-env.sh"></a>ä¿®æ”¹hadoop-env.sh</h6><p>ç¬¬ä¸€å°æœºå™¨æ‰§è¡Œä»¥ä¸‹å‘½ä»¤</p><pre><code class="hljs shell">cd /weitrue/install/hadoop-2.6.0-cdh5.14.2/etc/hadoopvim hadoop-env.sh</code></pre><pre><code class="hljs shell">export JAVA_HOME=/weitrue/install/jdk1.8.0_141</code></pre><h6 id="ä¿®æ”¹core-site-xml"><a href="#ä¿®æ”¹core-site-xml" class="headerlink" title="ä¿®æ”¹core-site.xml"></a>ä¿®æ”¹core-site.xml</h6><p>ç¬¬ä¸€å°æœºå™¨æ‰§è¡Œä»¥ä¸‹å‘½ä»¤</p><pre><code class="hljs shell">cd /weitrue/install/hadoop-2.6.0-cdh5.14.2/etc/hadoopvim core-site.xml</code></pre><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">configuration</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>fs.defaultFS<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>hdfs://node01:8020<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span>    <span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>hadoop.tmp.dir<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>/weitrue/install/hadoop-2.6.0-cdh5.14.2/hadoopDatas/tempDatas<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span>    <span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>    <span class="hljs-comment">&lt;!-- ç¼“å†²åŒºå¤§å°ï¼Œå®é™…å·¥ä½œä¸­æ ¹æ®æœåŠ¡å™¨æ€§èƒ½åŠ¨æ€è°ƒæ•´ --&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>io.file.buffer.size<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>4096<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span>    <span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>    <span class="hljs-comment">&lt;!-- å¼€å¯hdfsçš„åƒåœ¾æ¡¶æœºåˆ¶ï¼Œåˆ é™¤æ‰çš„æ•°æ®å¯ä»¥ä»åƒåœ¾æ¡¶ä¸­å›æ”¶ï¼Œå•ä½åˆ†é’Ÿ --&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>fs.trash.interval<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>10080<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span>    <span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">configuration</span>&gt;</span></code></pre><h6 id="ä¿®æ”¹hdfs-site-xml"><a href="#ä¿®æ”¹hdfs-site-xml" class="headerlink" title="ä¿®æ”¹hdfs-site.xml"></a>ä¿®æ”¹hdfs-site.xml</h6><p>ç¬¬ä¸€å°æœºå™¨æ‰§è¡Œä»¥ä¸‹å‘½ä»¤</p><pre><code class="hljs shell">cd /weitrue/install/hadoop-2.6.0-cdh5.14.2/etc/hadoopvim hdfs-site.xml</code></pre><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">configuration</span>&gt;</span><span class="hljs-comment">&lt;!-- NameNodeå­˜å‚¨å…ƒæ•°æ®ä¿¡æ¯çš„è·¯å¾„ï¼Œå®é™…å·¥ä½œä¸­ï¼Œä¸€èˆ¬å…ˆç¡®å®šç£ç›˜çš„æŒ‚è½½ç›®å½•ï¼Œç„¶åå¤šä¸ªç›®å½•ç”¨ï¼Œè¿›è¡Œåˆ†å‰²   --&gt;</span> <span class="hljs-comment">&lt;!--   é›†ç¾¤åŠ¨æ€ä¸Šä¸‹çº¿ </span><span class="hljs-comment">&lt;property&gt;</span><span class="hljs-comment">&lt;name&gt;dfs.hosts&lt;/name&gt;</span><span class="hljs-comment">&lt;value&gt;/weitrue/install/hadoop-2.6.0-cdh5.14.2/etc/hadoop/accept_host&lt;/value&gt;</span><span class="hljs-comment">&lt;/property&gt;</span><span class="hljs-comment">&lt;property&gt;</span><span class="hljs-comment">&lt;name&gt;dfs.hosts.exclude&lt;/name&gt;</span><span class="hljs-comment">&lt;value&gt;/weitrue/install/hadoop-2.6.0-cdh5.14.2/etc/hadoop/deny_host&lt;/value&gt;</span><span class="hljs-comment">&lt;/property&gt;</span><span class="hljs-comment">--&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>dfs.namenode.secondary.http-address<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>node01:50090<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>dfs.namenode.http-address<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>node01:50070<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>dfs.namenode.name.dir<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>file:///weitrue/install/hadoop-2.6.0-cdh5.14.2/hadoopDatas/namenodeDatas<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><span class="hljs-comment">&lt;!-- å®šä¹‰dataNodeæ•°æ®å­˜å‚¨çš„èŠ‚ç‚¹ä½ç½®ï¼Œå®é™…å·¥ä½œä¸­ï¼Œä¸€èˆ¬å…ˆç¡®å®šç£ç›˜çš„æŒ‚è½½ç›®å½•ï¼Œç„¶åå¤šä¸ªç›®å½•ç”¨ï¼Œè¿›è¡Œåˆ†å‰² --&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>dfs.datanode.data.dir<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>file:///weitrue/install/hadoop-2.6.0-cdh5.14.2/hadoopDatas/datanodeDatas<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>dfs.namenode.edits.dir<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>file:///weitrue/install/hadoop-2.6.0-cdh5.14.2/hadoopDatas/dfs/nn/edits<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>dfs.namenode.checkpoint.dir<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>file:///weitrue/install/hadoop-2.6.0-cdh5.14.2/hadoopDatas/dfs/snn/name<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>dfs.namenode.checkpoint.edits.dir<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>file:///weitrue/install/hadoop-2.6.0-cdh5.14.2/hadoopDatas/dfs/nn/snn/edits<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>dfs.replication<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>3<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>dfs.permissions<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>false<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>dfs.blocksize<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>134217728<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">configuration</span>&gt;</span></code></pre><h6 id="ä¿®æ”¹mapred-site-xml"><a href="#ä¿®æ”¹mapred-site-xml" class="headerlink" title="ä¿®æ”¹mapred-site.xml"></a>ä¿®æ”¹mapred-site.xml</h6><p>ç¬¬ä¸€å°æœºå™¨æ‰§è¡Œä»¥ä¸‹å‘½ä»¤</p><pre><code class="hljs shell">cd /weitrue/install/hadoop-2.6.0-cdh5.14.2/etc/hadoopmv mapred-site.xml.template mapred-site.xml vim mapred-site.xml</code></pre><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">configuration</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>mapreduce.framework.name<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>yarn<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span>    <span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>mapreduce.job.ubertask.enable<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span>    <span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>mapreduce.jobhistory.address<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>node01:10020<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span>    <span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>mapreduce.jobhistory.webapp.address<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>node01:19888<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span>    <span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">configuration</span>&gt;</span></code></pre><h6 id="ä¿®æ”¹yarn-site-xml"><a href="#ä¿®æ”¹yarn-site-xml" class="headerlink" title="ä¿®æ”¹yarn-site.xml"></a>ä¿®æ”¹yarn-site.xml</h6><p>ç¬¬ä¸€å°æœºå™¨æ‰§è¡Œä»¥ä¸‹å‘½ä»¤</p><pre><code class="hljs shell">cd /weitrue/install/hadoop-2.6.0-cdh5.14.2/etc/hadoopvim yarn-site.xml</code></pre><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">configuration</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>yarn.resourcemanager.hostname<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>node01<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span>    <span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>yarn.nodemanager.aux-services<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>mapreduce_shuffle<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span>    <span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">configuration</span>&gt;</span></code></pre><h6 id="ä¿®æ”¹slavesæ–‡ä»¶"><a href="#ä¿®æ”¹slavesæ–‡ä»¶" class="headerlink" title="ä¿®æ”¹slavesæ–‡ä»¶"></a>ä¿®æ”¹slavesæ–‡ä»¶</h6><p>ç¬¬ä¸€å°æœºå™¨æ‰§è¡Œä»¥ä¸‹å‘½ä»¤</p><pre><code class="hljs shell">cd /weitrue/install/hadoop-2.6.0-cdh5.14.2/etc/hadoopvim slaves</code></pre><p>åŸå†…å®¹æ›¿æ¢ä¸º</p><pre><code class="hljs gcode"><span class="hljs-symbol">node01</span><span class="hljs-symbol">node02</span><span class="hljs-symbol">node03</span></code></pre><h5 id="ç¬¬å››æ­¥ï¼šåˆ›å»ºæ–‡ä»¶å­˜æ”¾ç›®å½•"><a href="#ç¬¬å››æ­¥ï¼šåˆ›å»ºæ–‡ä»¶å­˜æ”¾ç›®å½•" class="headerlink" title="ç¬¬å››æ­¥ï¼šåˆ›å»ºæ–‡ä»¶å­˜æ”¾ç›®å½•"></a>ç¬¬å››æ­¥ï¼šåˆ›å»ºæ–‡ä»¶å­˜æ”¾ç›®å½•</h5><p>ç¬¬ä¸€å°æœºå™¨æ‰§è¡Œä»¥ä¸‹å‘½ä»¤</p><p>node01æœºå™¨ä¸Šé¢åˆ›å»ºä»¥ä¸‹ç›®å½•</p><pre><code class="hljs shell">mkdir -p /weitrue/install/hadoop-2.6.0-cdh5.14.2/hadoopDatas/tempDatasmkdir -p /weitrue/install/hadoop-2.6.0-cdh5.14.2/hadoopDatas/namenodeDatasmkdir -p /weitrue/install/hadoop-2.6.0-cdh5.14.2/hadoopDatas/datanodeDatas mkdir -p /weitrue/install/hadoop-2.6.0-cdh5.14.2/hadoopDatas/dfs/nn/editsmkdir -p /weitrue/install/hadoop-2.6.0-cdh5.14.2/hadoopDatas/dfs/snn/namemkdir -p /weitrue/install/hadoop-2.6.0-cdh5.14.2/hadoopDatas/dfs/nn/snn/edits</code></pre><h5 id="ç¬¬äº”æ­¥ï¼šå®‰è£…åŒ…çš„åˆ†å‘scpä¸rsync"><a href="#ç¬¬äº”æ­¥ï¼šå®‰è£…åŒ…çš„åˆ†å‘scpä¸rsync" class="headerlink" title="ç¬¬äº”æ­¥ï¼šå®‰è£…åŒ…çš„åˆ†å‘scpä¸rsync"></a>ç¬¬äº”æ­¥ï¼šå®‰è£…åŒ…çš„åˆ†å‘scpä¸rsync</h5><p>åœ¨linuxå½“ä¸­ï¼Œç”¨äºå‘è¿œç¨‹æœåŠ¡å™¨æ‹·è´æ–‡ä»¶æˆ–è€…æ–‡ä»¶å¤¹å¯ä»¥ä½¿ç”¨scpæˆ–è€…rsyncï¼Œè¿™ä¸¤ä¸ªå‘½ä»¤åŠŸèƒ½ç±»ä¼¼éƒ½æ˜¯å‘è¿œç¨‹æœåŠ¡å™¨è¿›è¡Œæ‹·è´ï¼Œåªä¸è¿‡scpæ˜¯å…¨é‡æ‹·è´ï¼Œrsyncå¯ä»¥åšåˆ°å¢é‡æ‹·è´ï¼Œrsyncçš„æ•ˆç‡æ¯”scpæ›´é«˜ä¸€äº›</p><h6 id="é€šè¿‡scpç›´æ¥æ‹·è´"><a href="#é€šè¿‡scpç›´æ¥æ‹·è´" class="headerlink" title="é€šè¿‡scpç›´æ¥æ‹·è´"></a>é€šè¿‡scpç›´æ¥æ‹·è´</h6><p>scpï¼ˆsecure copyï¼‰å®‰å…¨æ‹·è´</p><p>å¯ä»¥é€šè¿‡scpè¿›è¡Œä¸åŒæœåŠ¡å™¨ä¹‹é—´çš„æ–‡ä»¶æˆ–è€…æ–‡ä»¶å¤¹çš„å¤åˆ¶</p><p>ä½¿ç”¨è¯­æ³• </p><pre><code class="hljs shell">scp -r sourceFile  username@host:destpath</code></pre><p>ç”¨æ³•ç¤ºä¾‹</p><pre><code class="hljs shell">scp -r hadoop-lzo-0.4.20.jar hadoop@node01:/weitrue/</code></pre><p>node01æ‰§è¡Œä»¥ä¸‹å‘½ä»¤è¿›è¡Œæ‹·è´</p><pre><code class="hljs shell">cd /weitrue/install/scp -r hadoop-2.6.0-cdh5.14.2/ node02:$PWDscp -r hadoop-2.6.0-cdh5.14.2/ node03:$PWD</code></pre><h5 id="ç¬¬å…­æ­¥ï¼šé…ç½®hadoopçš„ç¯å¢ƒå˜é‡"><a href="#ç¬¬å…­æ­¥ï¼šé…ç½®hadoopçš„ç¯å¢ƒå˜é‡" class="headerlink" title="ç¬¬å…­æ­¥ï¼šé…ç½®hadoopçš„ç¯å¢ƒå˜é‡"></a>ç¬¬å…­æ­¥ï¼šé…ç½®hadoopçš„ç¯å¢ƒå˜é‡</h5><p>ä¸‰å°æœºå™¨éƒ½è¦è¿›è¡Œé…ç½®hadoopçš„ç¯å¢ƒå˜é‡</p><p>ä¸‰å°æœºå™¨æ‰§è¡Œä»¥ä¸‹å‘½ä»¤</p><pre><code class="hljs shell">sudo vim /etc/profile</code></pre><pre><code class="hljs shell">export HADOOP_HOME=/weitrue/install/hadoop-2.6.0-cdh5.14.2export PATH=$PATH:$HADOOP_HOME/bin:$HADOOP_HOME/sbin</code></pre><p>é…ç½®å®Œæˆä¹‹åç”Ÿæ•ˆ</p><pre><code class="hljs shell">source /etc/profile</code></pre><h5 id="ç¬¬ä¸ƒæ­¥ï¼šé›†ç¾¤å¯åŠ¨"><a href="#ç¬¬ä¸ƒæ­¥ï¼šé›†ç¾¤å¯åŠ¨" class="headerlink" title="ç¬¬ä¸ƒæ­¥ï¼šé›†ç¾¤å¯åŠ¨"></a>ç¬¬ä¸ƒæ­¥ï¼šé›†ç¾¤å¯åŠ¨</h5><h6 id="1-æ ¼å¼åŒ–é›†ç¾¤"><a href="#1-æ ¼å¼åŒ–é›†ç¾¤" class="headerlink" title="1. æ ¼å¼åŒ–é›†ç¾¤"></a>1. æ ¼å¼åŒ–é›†ç¾¤</h6><p>è¦å¯åŠ¨ Hadoop é›†ç¾¤ï¼Œéœ€è¦å¯åŠ¨ HDFS å’Œ YARN ä¸¤ä¸ªé›†ç¾¤ã€‚ </p><p>æ³¨æ„ï¼šé¦–æ¬¡å¯åŠ¨HDFSæ—¶ï¼Œå¿…é¡»å¯¹å…¶è¿›è¡Œæ ¼å¼åŒ–æ“ä½œã€‚æœ¬è´¨ä¸Šæ˜¯ä¸€äº›æ¸…ç†å’Œå‡†å¤‡å·¥ä½œï¼Œå› ä¸ºæ­¤æ—¶çš„ HDFS åœ¨ç‰©ç†ä¸Šè¿˜æ˜¯ä¸å­˜åœ¨çš„ã€‚<font color="red">æ ¼å¼åŒ–æ“ä½œåªæœ‰åœ¨é¦–æ¬¡å¯åŠ¨çš„æ—¶å€™éœ€è¦ï¼Œä»¥åå†ä¹Ÿä¸éœ€è¦äº†</font></p><p><font color="red">node01æ‰§è¡Œä¸€éå³å¯</font></p><pre><code class="hljs shell">hdfs namenode -format</code></pre><p>æˆ–è€…</p><pre><code class="hljs shell">hadoop namenode â€“format</code></pre><p><img src="/images/hadoop-env/hadoop.png"></p><p>å¯åŠ¨é›†ç¾¤æœ‰ä¸¤ç§æ–¹å¼ï¼šâ‘ è„šæœ¬ä¸€é”®å¯åŠ¨ï¼›â‘¡å•ä¸ªè¿›ç¨‹é€ä¸ªå¯åŠ¨</p><h6 id="2-è„šæœ¬ä¸€é”®å¯åŠ¨"><a href="#2-è„šæœ¬ä¸€é”®å¯åŠ¨" class="headerlink" title="2. è„šæœ¬ä¸€é”®å¯åŠ¨"></a>2. è„šæœ¬ä¸€é”®å¯åŠ¨</h6><p>å¦‚æœé…ç½®äº† etc/hadoop/slaves å’Œ ssh å…å¯†ç™»å½•ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ç¨‹åºè„šæœ¬å¯åŠ¨æ‰€æœ‰Hadoop ä¸¤ä¸ªé›†ç¾¤çš„ç›¸å…³è¿›ç¨‹ï¼Œåœ¨ä¸»èŠ‚ç‚¹æ‰€è®¾å®šçš„æœºå™¨ä¸Šæ‰§è¡Œã€‚</p><p>å¯åŠ¨é›†ç¾¤</p><p>node01èŠ‚ç‚¹ä¸Šæ‰§è¡Œä»¥ä¸‹å‘½ä»¤</p><p>ç¬¬ä¸€å°æœºå™¨æ‰§è¡Œä»¥ä¸‹å‘½ä»¤(hadoop/sbinç›®å½•ä¸‹)</p><pre><code class="hljs shell">start-dfs.shstart-yarn.shmr-jobhistory-daemon.sh start historyserver</code></pre><p>åœæ­¢é›†ç¾¤ï¼š</p><pre><code class="hljs shell">stop-dfs.shstop-yarn.sh</code></pre><h6 id="3-å•ä¸ªè¿›ç¨‹é€ä¸ªå¯åŠ¨"><a href="#3-å•ä¸ªè¿›ç¨‹é€ä¸ªå¯åŠ¨" class="headerlink" title="3. å•ä¸ªè¿›ç¨‹é€ä¸ªå¯åŠ¨"></a>3. å•ä¸ªè¿›ç¨‹é€ä¸ªå¯åŠ¨</h6><pre><code class="hljs shell">åœ¨ä¸»èŠ‚ç‚¹ä¸Šä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å¯åŠ¨ HDFS NameNodeï¼š hadoop-daemon.sh start namenode åœ¨æ¯ä¸ªä»èŠ‚ç‚¹ä¸Šä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å¯åŠ¨ HDFS DataNodeï¼š hadoop-daemon.sh start datanodeåœ¨ä¸»èŠ‚ç‚¹ä¸Šä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å¯åŠ¨ YARN ResourceManagerï¼š yarn-daemon.sh start resourcemanager åœ¨æ¯ä¸ªä»èŠ‚ç‚¹ä¸Šä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å¯åŠ¨ YARN nodemanagerï¼š yarn-daemon.sh start nodemanager ä»¥ä¸Šè„šæœ¬ä½äº$HADOOP_HOME/sbin/ç›®å½•ä¸‹ã€‚å¦‚æœæƒ³è¦åœæ­¢æŸä¸ªèŠ‚ç‚¹ä¸ŠæŸä¸ªè§’è‰²ï¼Œåªéœ€è¦æŠŠå‘½ä»¤ä¸­çš„start æ”¹ä¸ºstop å³å¯ã€‚</code></pre><h6 id="4-ä¸€é”®å¯åŠ¨hadoopé›†ç¾¤çš„è„šæœ¬"><a href="#4-ä¸€é”®å¯åŠ¨hadoopé›†ç¾¤çš„è„šæœ¬" class="headerlink" title="4.ä¸€é”®å¯åŠ¨hadoopé›†ç¾¤çš„è„šæœ¬"></a>4.ä¸€é”®å¯åŠ¨hadoopé›†ç¾¤çš„è„šæœ¬</h6><p>æˆ‘ä»¬ä¹Ÿå¯ä»¥åˆ›å»ºä¸€é”®å¯åŠ¨hadoopçš„è„šæœ¬ï¼Œä»¥åå¯åŠ¨hadoopéƒ½å¯ä»¥é€šè¿‡ä¸€ä¸ªè„šæœ¬å³å¯</p><p>åœ¨node01æœåŠ¡å™¨çš„/home/hadoop/binç›®å½•ä¸‹åˆ›å»ºè„šæœ¬</p><pre><code class="hljs shell">[hadoop@node01 bin]$ cd /home/hadoop/bin/[hadoop@node01 bin]$ vim hadoop.sh</code></pre><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">!/bin/bash</span>case $1 in&quot;start&quot; )&#123; source /etc/profile; /weitrue/install/hadoop-2.6.0-cdh5.14.2/sbin/start-dfs.sh /weitrue/install/hadoop-2.6.0-cdh5.14.2/sbin/start-yarn.sh /weitrue/install/hadoop-2.6.0-cdh5.14.2/sbin/mr-jobhistory-daemon.sh start historyserver&#125;;;&quot;stop&quot;)&#123; /weitrue/install/hadoop-2.6.0-cdh5.14.2/sbin/stop-dfs.sh /weitrue/install/hadoop-2.6.0-cdh5.14.2/sbin/stop-yarn.sh /weitrue/install/hadoop-2.6.0-cdh5.14.2/sbin/mr-jobhistory-daemon.sh stop  historyserver&#125;;;esac</code></pre><p>ä¿®æ”¹è„šæœ¬æƒé™</p><pre><code class="hljs shell">[hadoop@node01 bin]$ chmod 777 hadoop.sh[hadoop@node01 bin]$ ./hadoop.sh start  # å¯åŠ¨hadoopé›†ç¾¤[hadoop@node01 bin]$ ./hadoop.sh stop   # åœæ­¢hadoopé›†ç¾¤</code></pre><h5 id="ç¬¬å…«æ­¥ï¼šæµè§ˆå™¨æŸ¥çœ‹å¯åŠ¨é¡µé¢"><a href="#ç¬¬å…«æ­¥ï¼šæµè§ˆå™¨æŸ¥çœ‹å¯åŠ¨é¡µé¢" class="headerlink" title="ç¬¬å…«æ­¥ï¼šæµè§ˆå™¨æŸ¥çœ‹å¯åŠ¨é¡µé¢"></a>ç¬¬å…«æ­¥ï¼šæµè§ˆå™¨æŸ¥çœ‹å¯åŠ¨é¡µé¢</h5><p>hdfsé›†ç¾¤è®¿é—®åœ°å€</p><p><a href="http://192.168.51.100:50070/">http://192.168.51.100:50070/</a></p><p>yarné›†ç¾¤è®¿é—®åœ°å€</p><p><a href="http://192.168.51.100:8088/">http://192.168.51.100:8088</a></p><p>jobhistoryè®¿é—®åœ°å€ï¼š</p><p><a href="http://192.168.51.100:19888/">http://192.168.51.100:19888</a></p><p>==å¦‚æœè¦å…³é—­ç”µè„‘æ—¶ï¼Œæ¸…ä¸€å®šè¦æŒ‰ç…§ä»¥ä¸‹é¡ºåºæ“ä½œï¼Œå¦åˆ™é›†ç¾¤å¯èƒ½ä¼šå‡ºé—®é¢˜==</p><ul><li><p>å…³é—­hadoopé›†ç¾¤</p></li><li><p>å…³é—­è™šæ‹Ÿæœº</p></li><li><p>å…³é—­ç”µè„‘</p></li></ul>]]></content>
    
    
    <categories>
      
      <category>Bdata</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Hadoop</tag>
      
      <tag>å¤§æ•°æ®</tag>
      
      <tag>mac</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€ALLã€‘Gitå­¦ä¹ ç¬”è®°</title>
    <link href="/2020/06/14/git/"/>
    <url>/2020/06/14/git/</url>
    
    <content type="html"><![CDATA[<blockquote><p>a <a href="http://git-scm.com/about/free-and-open-source">free and open source</a> distributed version control system designed to handle everything from small to very large projects with speed and efficiency.<a id="more"></a> </p></blockquote><h3 id="å¸¸ç”¨å‘½ä»¤"><a href="#å¸¸ç”¨å‘½ä»¤" class="headerlink" title="å¸¸ç”¨å‘½ä»¤"></a>å¸¸ç”¨å‘½ä»¤</h3><h4 id="git-config"><a href="#git-config" class="headerlink" title="git config"></a><code>git config</code></h4><pre><code class="hljs shell">git config --list                               # æŸ¥çœ‹gitæ‰€æœ‰é…ç½®git config --global --unset user.name           # åˆ é™¤ç”¨æˆ·git config --global --edit                      # ç¼–è¾‘é…ç½®æ–‡ä»¶git config --system --list                      # æŸ¥çœ‹ç³»ç»Ÿé…ç½®git config --global --list                      # æŸ¥çœ‹å½“å‰ç”¨æˆ·ï¼ˆglobalï¼‰é…ç½®git config --local --list                       # æŸ¥çœ‹å½“å‰ä»“åº“é…ç½®ä¿¡æ¯</code></pre><h4 id="git-branch"><a href="#git-branch" class="headerlink" title="git branch"></a><code>git branch</code></h4><p>åˆ›å»ºã€é‡å‘½åã€æŸ¥çœ‹ã€åˆ é™¤é¡¹ç›®åˆ†æ”¯ï¼Œé€šè¿‡ Git åšé¡¹ç›®å¼€å‘æ—¶ï¼Œä¸€èˆ¬éƒ½æ˜¯åœ¨å¼€å‘åˆ†æ”¯ä¸­è¿›è¡Œï¼Œå¼€å‘å®Œæˆååˆå¹¶åˆ†æ”¯åˆ°ä¸»å¹²ã€‚</p><pre><code class="hljs shell">git branch &lt;some_branch&gt;                        # åˆ›å»ºåˆ†æ”¯git branch -m &lt;old_branch&gt; &lt;new_branch&gt;         # é‡å‘½ååˆ†æ”¯git branch -D &lt;some_branch&gt;                     # åˆ é™¤åˆ†æ”¯git branch                                      # æŸ¥çœ‹æœ¬åœ°æ‰€æœ‰åˆ†æ”¯git branch -a                                   # æŸ¥çœ‹æ‰€æœ‰åˆ†æ”¯ï¼ˆæœ¬åœ°å’Œè¿œç¨‹ï¼‰git branch -r                                   # æŸ¥çœ‹è¿œç¨‹ç‰ˆæœ¬åº“ä¸Šçš„åˆ†æ”¯åˆ—è¡¨ï¼ŒåŠ ä¸Š -d å‚æ•°å¯ä»¥åˆ é™¤è¿œç¨‹ç‰ˆæœ¬åº“ä¸Šçš„åˆ†æ”¯git branch -vv                                  # æŸ¥çœ‹å¸¦æœ‰æœ€åæäº¤idã€æœ€è¿‘æäº¤åŸå› ç­‰ä¿¡æ¯çš„æœ¬åœ°ç‰ˆæœ¬åº“åˆ†æ”¯åˆ—è¡¨</code></pre><h4 id="git-tag"><a href="#git-tag" class="headerlink" title="git tag"></a><code>git tag</code></h4><p>ä¸ºé¡¹ç›®æ ‡è®°é‡Œç¨‹ç¢‘</p><pre><code class="hljs shell">git tag publish/xxxgit push origin publish/xxx</code></pre><p>å½“æˆ‘ä»¬å®ŒæˆæŸä¸ªåŠŸèƒ½éœ€æ±‚å‡†å¤‡å‘å¸ƒä¸Šçº¿æ—¶ï¼Œåº”è¯¥å°†æ­¤æ¬¡å®Œæ•´çš„é¡¹ç›®ä»£ç åšä¸ªæ ‡è®°ï¼Œå¹¶å°†è¿™ä¸ªæ ‡è®°å¥½çš„ç‰ˆæœ¬å‘å¸ƒåˆ°çº¿ä¸Šï¼Œè¿™é‡Œæˆ‘ä»¬ä»¥ publish/xxx ä¸ºæ ‡è®°åå¹¶å‘å¸ƒï¼Œå½“çœ‹åˆ°å‘½ä»¤è¡Œè¿”å›å¦‚ä¸‹å†…å®¹åˆ™è¡¨ç¤ºå‘å¸ƒæˆåŠŸäº†ã€‚</p><pre><code class="hljs shell">Total 0 (delta 0), reused 0 (delta 0)To https://github.com/xxx/xxx.github.com.git * [new tag]         publish/xxx -&gt; publish/xxx.gitignore</code></pre><h4 id="git-merge"><a href="#git-merge" class="headerlink" title="git merge"></a><code>git merge</code></h4><p>å°†å…¶å®ƒåˆ†æ”¯åˆå¹¶åˆ°å½“å‰åˆ†æ”¯</p><pre><code class="hljs shell">git merge --squash<span class="hljs-meta">#</span><span class="bash">å°†å¾…åˆå¹¶åˆ†æ”¯ä¸Šçš„ commit åˆå¹¶æˆä¸€ä¸ªæ–°çš„ commit æ”¾å…¥å½“å‰åˆ†æ”¯ï¼Œé€‚ç”¨äºå¾…åˆå¹¶åˆ†æ”¯çš„æäº¤è®°å½•ä¸éœ€è¦ä¿ç•™çš„æƒ…å†µ</span>git merge --no-ff<span class="hljs-meta">#</span><span class="bash">é»˜è®¤æƒ…å†µä¸‹ï¼ŒGit æ‰§è¡Œ<span class="hljs-string">&quot;å¿«è¿›å¼åˆå¹¶&quot;</span>ï¼ˆfast-farward mergeï¼‰ï¼Œä¼šç›´æ¥å°† Master åˆ†æ”¯æŒ‡å‘ Develop åˆ†æ”¯ï¼Œä½¿ç”¨ --no-ff å‚æ•°åï¼Œä¼šæ‰§è¡Œæ­£å¸¸åˆå¹¶ï¼Œåœ¨ Master åˆ†æ”¯ä¸Šç”Ÿæˆä¸€ä¸ªæ–°èŠ‚ç‚¹ï¼Œä¿è¯ç‰ˆæœ¬æ¼”è¿›æ›´æ¸…æ™°ã€‚</span>git merge --no-edit<span class="hljs-meta">#</span><span class="bash">åœ¨æ²¡æœ‰å†²çªçš„æƒ…å†µä¸‹åˆå¹¶ï¼Œä¸æƒ³æ‰‹åŠ¨ç¼–è¾‘æäº¤åŸå› ï¼Œè€Œæ˜¯ç”¨ Git è‡ªåŠ¨ç”Ÿæˆçš„ç±»ä¼¼ Merge branch <span class="hljs-string">&#x27;test&#x27;</span>çš„æ–‡å­—ç›´æ¥æäº¤</span></code></pre><h4 id="git-stash"><a href="#git-stash" class="headerlink" title="git stash"></a><code>git stash</code></h4><p>åœ¨Gitçš„æ ˆä¸­ä¿å­˜å½“å‰ä¿®æ”¹æˆ–åˆ é™¤çš„å·¥ä½œè¿›åº¦ï¼Œå½“ä½ åœ¨ä¸€ä¸ªåˆ†æ”¯é‡ŒåšæŸé¡¹åŠŸèƒ½å¼€å‘æ—¶ï¼Œæ¥åˆ°é€šçŸ¥æŠŠæ˜¨å¤©å·²ç»æµ‹è¯•å®Œæ²¡é—®é¢˜çš„ä»£ç å‘å¸ƒåˆ°çº¿ä¸Šï¼Œä½†è¿™æ—¶ä½ å·²ç»åœ¨è¿™ä¸ªåˆ†æ”¯é‡ŒåŠ å…¥äº†å…¶å®ƒæœªæäº¤çš„ä»£ç ï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥æŠŠè¿™äº›æœªæäº¤çš„ä»£ç å­˜åˆ°æ ˆé‡Œã€‚</p><pre><code class="hljs shell">git stash<span class="hljs-meta">#</span><span class="bash">å°†æœªæäº¤çš„æ–‡ä»¶ä¿å­˜åˆ°Gitæ ˆä¸­</span>git stash list<span class="hljs-meta">#</span><span class="bash">æŸ¥çœ‹æ ˆä¸­ä¿å­˜çš„åˆ—è¡¨</span>git stash show stash@&#123;0&#125;<span class="hljs-meta">#</span><span class="bash">æ˜¾ç¤ºæ ˆä¸­å…¶ä¸­ä¸€æ¡è®°å½•</span>git stash drop stash@&#123;0&#125;<span class="hljs-meta">#</span><span class="bash">ç§»é™¤æ ˆä¸­å…¶ä¸­ä¸€æ¡è®°å½•</span>git stash pop<span class="hljs-meta">#</span><span class="bash">ä»Gitæ ˆä¸­æ£€å‡ºæœ€æ–°ä¿å­˜çš„ä¸€æ¡è®°å½•ï¼Œå¹¶å°†å®ƒä»æ ˆä¸­ç§»é™¤</span>git stash apply stash@&#123;0&#125;<span class="hljs-meta">#</span><span class="bash">ä»Gitæ ˆä¸­æ£€å‡ºå…¶ä¸­ä¸€æ¡è®°å½•ï¼Œä½†ä¸ä»æ ˆä¸­ç§»é™¤</span>git stash branch new_banch<span class="hljs-meta">#</span><span class="bash">æŠŠå½“å‰æ ˆä¸­æœ€è¿‘ä¸€æ¬¡è®°å½•æ£€å‡ºå¹¶åˆ›å»ºä¸€ä¸ªæ–°åˆ†æ”¯</span>git stash clear<span class="hljs-meta">#</span><span class="bash">æ¸…ç©ºæ ˆé‡Œçš„æ‰€æœ‰è®°å½•</span>git stash create<span class="hljs-meta">#</span><span class="bash">ä¸ºå½“å‰ä¿®æ”¹æˆ–åˆ é™¤çš„æ–‡ä»¶åˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰çš„æ ˆå¹¶è¿”å›ä¸€ä¸ªIDï¼Œæ­¤æ—¶å¹¶æœªçœŸæ­£å­˜å‚¨åˆ°æ ˆé‡Œ</span>git stash store xxxxxx<span class="hljs-meta">#</span><span class="bash">å°† create æ–¹æ³•é‡Œè¿”å›çš„IDæ”¾åˆ° store åé¢ï¼Œæ­¤æ—¶åœ¨æ ˆé‡ŒçœŸæ­£åˆ›å»ºäº†ä¸€ä¸ªè®°å½•ï¼Œä½†å½“å‰ä¿®æ”¹æˆ–åˆ é™¤çš„æ–‡ä»¶å¹¶æœªä»å·¥ä½œåŒºç§»é™¤</span><span class="hljs-meta">$</span><span class="bash"> git stash create</span>09eb9a97ad632d0825be1ece361936d1d0bdb5c7<span class="hljs-meta">$</span><span class="bash"> git stash store 09eb9a97ad632d0825be1ece361936d1d0bdb5c7</span><span class="hljs-meta">$</span><span class="bash"> git stash list</span>stash@&#123;0&#125;: Created via &quot;git stash store&quot;</code></pre><h4 id="git-log"><a href="#git-log" class="headerlink" title="git log"></a><code>git log</code></h4><pre><code class="hljs shell">git log -p                                      # æ˜¾ç¤ºå¸¦æäº¤å·®å¼‚å¯¹æ¯”çš„å†å²è®°å½•git log demo.html                               # æ˜¾ç¤º demo.html æ–‡ä»¶çš„å†å²è®°å½•git log --since=&quot;2 weeks ago&quot;                   # æ˜¾ç¤º2å‘¨å‰å¼€å§‹åˆ°ç°åœ¨çš„å†å²è®°å½•ï¼Œå…¶å®ƒæ—¶é—´å¯ä»¥ç±»æ¨git log --before=&quot;2 weeks ago&quot;                  # æ˜¾ç¤ºæˆªæ­¢åˆ°2å‘¨å‰çš„å†å²è®°å½•ï¼Œå…¶å®ƒæ—¶é—´å¯ä»¥ç±»æ¨git log -10                                     # æ˜¾ç¤ºæœ€è¿‘10æ¡å†å²è®°å½•git log f5f630a..HEAD                           # æ˜¾ç¤ºä»æäº¤ID f5f630a åˆ° HEAD ä¹‹é—´çš„è®°å½•ï¼ŒHEAD å¯ä»¥ä¸ºç©ºæˆ–å…¶å®ƒæäº¤IDgit log --pretty=oneline                        # åœ¨ä¸€è¡Œä¸­è¾“å‡ºç®€çŸ­çš„å†å²è®°å½•git log --pretty=format:&quot;%h&quot;                    # æ ¼å¼åŒ–è¾“å‡ºå†å²è®°å½•</code></pre><p>Git ç”¨å„ç§ placeholder æ¥å†³å®šå„ç§æ˜¾ç¤ºå†…å®¹ï¼Œå¸¸ç”¨çš„æ˜¾ç¤ºå¦‚ä¸‹ï¼š</p><pre><code class="hljs shell"><span class="hljs-meta">%</span><span class="bash">H:                                             <span class="hljs-comment"># commit hash</span></span><span class="hljs-meta">%</span><span class="bash">h:                                             <span class="hljs-comment"># ç¼©çŸ­çš„commit hash</span></span><span class="hljs-meta">%</span><span class="bash">T:                                             <span class="hljs-comment"># tree hash</span></span><span class="hljs-meta">%</span><span class="bash">t:                                             <span class="hljs-comment"># ç¼©çŸ­çš„ tree hash</span></span><span class="hljs-meta">%</span><span class="bash">P:                                             <span class="hljs-comment"># parent hashes</span></span><span class="hljs-meta">%</span><span class="bash">p:                                             <span class="hljs-comment"># ç¼©çŸ­çš„ parent hashes</span></span><span class="hljs-meta">%</span><span class="bash">an:                                            <span class="hljs-comment"># ä½œè€…åå­—</span></span><span class="hljs-meta">%</span><span class="bash">aN:                                            <span class="hljs-comment"># mailmapçš„ä½œè€…å</span></span><span class="hljs-meta">%</span><span class="bash">ae:                                            <span class="hljs-comment"># ä½œè€…é‚®ç®±</span></span><span class="hljs-meta">%</span><span class="bash">ad:                                            <span class="hljs-comment"># æ—¥æœŸ (--date= åˆ¶å®šçš„æ ¼å¼)</span></span><span class="hljs-meta">%</span><span class="bash">ar:                                            <span class="hljs-comment"># æ—¥æœŸ, ç›¸å¯¹æ ¼å¼(1 day ago)</span></span><span class="hljs-meta">%</span><span class="bash">cn:                                            <span class="hljs-comment"># æäº¤è€…åå­—</span></span><span class="hljs-meta">%</span><span class="bash">ce:                                            <span class="hljs-comment"># æäº¤è€… email</span></span><span class="hljs-meta">%</span><span class="bash"><span class="hljs-built_in">cd</span>:                                            <span class="hljs-comment"># æäº¤æ—¥æœŸ (--date= åˆ¶å®šçš„æ ¼å¼)</span></span><span class="hljs-meta">%</span><span class="bash">cr:                                            <span class="hljs-comment"># æäº¤æ—¥æœŸ, ç›¸å¯¹æ ¼å¼(1 day ago)</span></span><span class="hljs-meta">%</span><span class="bash">d:                                             <span class="hljs-comment"># refåç§°</span></span><span class="hljs-meta">%</span><span class="bash">s:                                             <span class="hljs-comment"># commitä¿¡æ¯æ ‡é¢˜</span></span><span class="hljs-meta">%</span><span class="bash">b:                                             <span class="hljs-comment"># commitä¿¡æ¯å†…å®¹</span></span><span class="hljs-meta">%</span><span class="bash">n:                                             <span class="hljs-comment"># æ¢è¡Œ</span></span></code></pre><h4 id="å¦‚æœè¿œç«¯ä»“åº“æ²¡æœ‰ä¸æœ¬åœ°ä»“åº“å…³è”"><a href="#å¦‚æœè¿œç«¯ä»“åº“æ²¡æœ‰ä¸æœ¬åœ°ä»“åº“å…³è”" class="headerlink" title="å¦‚æœè¿œç«¯ä»“åº“æ²¡æœ‰ä¸æœ¬åœ°ä»“åº“å…³è”"></a>å¦‚æœè¿œç«¯ä»“åº“æ²¡æœ‰ä¸æœ¬åœ°ä»“åº“å…³è”</h4><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> æœ¬åœ°æ‰§è¡Œï¼ˆè¿œç«¯éœ€è¦åˆ›å»ºäºæœ¬åœ°ç›¸åŒåç§°çš„é¡¹ç›®ï¼‰</span><span class="hljs-meta">$</span><span class="bash"> git init</span><span class="hljs-meta">$</span><span class="bash"> git remote add origin https://github.com/xxx/xxx.git</span><span class="hljs-meta">$</span><span class="bash"> git add -A</span><span class="hljs-meta">$</span><span class="bash"> git commit -m <span class="hljs-string">&quot;first commit&quot;</span></span><span class="hljs-meta">$</span><span class="bash"> git push -u origin master</span></code></pre><h4 id="åˆ‡æ¢åˆ†æ”¯"><a href="#åˆ‡æ¢åˆ†æ”¯" class="headerlink" title="åˆ‡æ¢åˆ†æ”¯"></a>åˆ‡æ¢åˆ†æ”¯</h4><pre><code class="hljs shell">git status                                      # æŸ¥çœ‹gitçŠ¶æ€  git branch                                      # æŸ¥çœ‹gitåˆ†æ”¯  git checkout feature/new_branch                 # åˆ‡æ¢åˆ°feature/new_branchåˆ†æ”¯</code></pre><h4 id="æäº¤ä»£ç "><a href="#æäº¤ä»£ç " class="headerlink" title="æäº¤ä»£ç "></a>æäº¤ä»£ç </h4><pre><code class="hljs shell">git add .                                       # æ·»åŠ æ•°æ®åˆ°é•œåƒä»“åº“                                                                                             # æäº¤å•ä¸ªæ–‡ä»¶ï¼Œè¿›å…¥ä½ è¦æäº¤çš„æ–‡ä»¶ç›®å½•                                                          # git add &lt;ä½ è¦æäº¤çš„æ–‡ä»¶&gt; git commit -m &#x27;ä½ è¦å†™çš„æ³¨é‡Š&#x27;                      # æäº¤åˆ°æœ¬åœ°é•œåƒä»“åº“git push -u origin feature/new_branch           # æäº¤åˆ°è¿œç¨‹é•œåƒä»“åº“</code></pre><h4 id="è¿œç¨‹åˆ†æ”¯æ‹‰å–åˆ°æœ¬åœ°"><a href="#è¿œç¨‹åˆ†æ”¯æ‹‰å–åˆ°æœ¬åœ°" class="headerlink" title="è¿œç¨‹åˆ†æ”¯æ‹‰å–åˆ°æœ¬åœ°"></a>è¿œç¨‹åˆ†æ”¯æ‹‰å–åˆ°æœ¬åœ°</h4><pre><code class="hljs shell">git branch -a                                   # æŸ¥è¯¢æ‰€æœ‰åˆ†æ”¯,åŒ…æ‹¬è¿œç¨‹åˆ†æ”¯ git checkout -b release remotes/origin/release  # å°†è¿œç¨‹releaseåˆ†æ”¯æ‹‰å–åˆ°æœ¬åœ°ï¼Œå¹¶åœ¨æœ¬åœ°åˆ›å»ºreleaseåˆ†æ”¯</code></pre><p>ç»¿è‰²æ˜¯å½“å‰æ‰€åœ¨æœ¬åœ°åˆ†æ”¯ï¼Œç™½è‰²æ˜¯æœ¬åœ°åˆ†æ”¯ï¼Œçº¢è‰²æ˜¯è¿œç¨‹åˆ†æ”¯<br><img src="/images/git/git-a.png"></p><h4 id="åˆ†æ”¯ä»£ç æ‹‰å–æäº¤æµç¨‹"><a href="#åˆ†æ”¯ä»£ç æ‹‰å–æäº¤æµç¨‹" class="headerlink" title="åˆ†æ”¯ä»£ç æ‹‰å–æäº¤æµç¨‹"></a>åˆ†æ”¯ä»£ç æ‹‰å–æäº¤æµç¨‹</h4><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment"># è·å–ä¸»å¹²æœ€æ–°ä»£ç  </span></span><span class="hljs-meta">$</span><span class="bash"> git <span class="hljs-built_in">clone</span> &lt;repo&gt; </span><span class="hljs-meta">$</span><span class="bash"> git checkout develop                        <span class="hljs-comment"># åˆ‡æ¢åˆ°developåˆ†æ”¯ </span></span><span class="hljs-meta">$</span><span class="bash"> git pull                                    <span class="hljs-comment"># åŒæ­¥åˆ†æ”¯ </span></span><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment"># æ–°å»ºä¸€ä¸ªå¼€å‘åˆ†æ”¯my_feature </span></span><span class="hljs-meta">$</span><span class="bash"> git checkout -b feature/my_feature  </span><span class="hljs-meta">$</span><span class="bash"> git branch                                  <span class="hljs-comment"># ç¡®è®¤å·²åˆ‡æ¢åˆ°å½“å‰åˆ†æ”¯</span></span><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment"># æäº¤ä»£ç </span></span><span class="hljs-meta">$</span><span class="bash"> git add --all æˆ–è€… git add .                 <span class="hljs-comment"># ä¿å­˜æ‰€æœ‰çš„ä¿®æ”¹å˜åŒ–  </span></span><span class="hljs-meta">$</span><span class="bash"> git status                                  <span class="hljs-comment"># æŸ¥çœ‹å‘ç”Ÿå˜åŠ¨çš„æ–‡ä»¶ </span></span><span class="hljs-meta">$</span><span class="bash"> git commit -m <span class="hljs-string">&quot;implement api architecture&quot;</span>  <span class="hljs-comment"># ç¼–è¾‘å¤‡æ³¨ </span></span><span class="hljs-meta">$</span><span class="bash"> git push origin -u feature/my_feature       <span class="hljs-comment"># å°†åˆ†æ”¯ä»£ç pushåˆ°æœåŠ¡å™¨</span></span><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment"># åˆå¹¶åˆ†æ”¯feature/my_featureåˆ°develop </span></span><span class="hljs-meta">$</span><span class="bash"> git checkout develop </span><span class="hljs-meta">$</span><span class="bash"> git pull                                    <span class="hljs-comment"># ç¡®ä¿developåˆ†æ”¯æ˜¯æœ€æ–°çš„ </span></span><span class="hljs-meta">$</span><span class="bash"> git merge --no-ff feature/my_feature  </span><span class="hljs-meta">#</span><span class="bash"> åˆ†æ”¯å¼€å‘è¿‡ç¨‹ä¸­ï¼Œä¸ºäº†å‡å°‘å†²çªï¼Œå°½é‡è¦å¤šä¸ä¸»å¹²åŒæ­¥ </span><span class="hljs-meta">$</span><span class="bash"> git fetch origin </span><span class="hljs-meta">$</span><span class="bash"> git rebase origin/develop </span><span class="hljs-meta">$</span><span class="bash"> git add .                                   <span class="hljs-comment"># è§£å†³å†²çªåadd </span></span><span class="hljs-meta">$</span><span class="bash"> git rebase --<span class="hljs-built_in">continue</span></span><span class="hljs-meta">#</span><span class="bash">åˆ é™¤åˆ†æ”¯ </span><span class="hljs-meta">$</span><span class="bash"> git branch -d feature/my_feature</span><span class="hljs-meta">#</span><span class="bash">å–æ¶ˆcommit </span><span class="hljs-meta">$</span><span class="bash"> git reset --hard &lt;commit <span class="hljs-built_in">log</span>&gt;</span></code></pre><h3 id="åŠ¨å›¾å›¾è§£"><a href="#åŠ¨å›¾å›¾è§£" class="headerlink" title="åŠ¨å›¾å›¾è§£"></a>åŠ¨å›¾å›¾è§£</h3><h4 id="åˆå¹¶"><a href="#åˆå¹¶" class="headerlink" title="åˆå¹¶"></a>åˆå¹¶</h4><p>æ‹¥æœ‰å¤šä¸ªåˆ†æ”¯æ˜¯å¾ˆæ–¹ä¾¿çš„ï¼Œè¿™æ ·å¯ä»¥å°†ä¸åŒçš„æ–°ä¿®æ”¹äº’ç›¸éš”ç¦»å¼€ï¼Œè€Œä¸”è¿˜èƒ½ç¡®ä¿ä½ ä¸ä¼šæ„å¤–åœ°å‘ç”Ÿäº§ä»£ç æ¨é€æœªç»è®¸å¯æˆ–ç ´æŸçš„ä»£ç ä¿®æ”¹ã€‚ä½†ä¸€æ—¦è¿™äº›ä¿®æ”¹å¾—åˆ°äº†æ‰¹å‡†è®¸å¯ï¼Œæˆ‘ä»¬å°±éœ€è¦å°†å…¶éƒ¨ç½²åˆ°æˆ‘ä»¬çš„ç”Ÿäº§åˆ†æ”¯ä¸­ï¼</p><p>å¯å°†ä¸€ä¸ªåˆ†æ”¯çš„ä¿®æ”¹èå…¥åˆ°å¦ä¸€ä¸ªåˆ†æ”¯çš„ä¸€ç§æ–¹å¼æ˜¯æ‰§è¡Œ git mergeã€‚Git å¯æ‰§è¡Œä¸¤ç§ç±»å‹çš„åˆå¹¶ï¼šfast-forward å’Œ no-fast-forwardã€‚ç°åœ¨ä½ å¯èƒ½åˆ†ä¸æ¸…ï¼Œä½†æˆ‘ä»¬é©¬ä¸Šå°±æ¥çœ‹çœ‹å®ƒä»¬çš„å·®å¼‚æ‰€åœ¨ã€‚</p><h5 id="Fast-forward-â€”ff"><a href="#Fast-forward-â€”ff" class="headerlink" title="Fast-forward (â€”ff)"></a>Fast-forward (â€”ff)</h5><p>åœ¨å½“å‰åˆ†æ”¯ç›¸æ¯”äºæˆ‘ä»¬è¦åˆå¹¶çš„åˆ†æ”¯æ²¡æœ‰é¢å¤–çš„æäº¤ï¼ˆcommitï¼‰æ—¶ï¼Œå¯ä»¥æ‰§è¡Œ fast-forward åˆå¹¶ã€‚Git å¾ˆæ‡’ï¼Œé¦–å…ˆä¼šå°è¯•æ‰§è¡Œæœ€ç®€å•çš„é€‰é¡¹ï¼šfast-forwardï¼è¿™ç±»åˆå¹¶ä¸ä¼šåˆ›å»ºæ–°çš„æäº¤ï¼Œè€Œæ˜¯ä¼šå°†æˆ‘ä»¬æ­£åœ¨åˆå¹¶çš„åˆ†æ”¯ä¸Šçš„æäº¤ç›´æ¥åˆå¹¶åˆ°å½“å‰åˆ†æ”¯ã€‚</p><p><img src="/images/git/image1.gif"></p><p>å®Œç¾ï¼ç°åœ¨ï¼Œæˆ‘ä»¬åœ¨ dev åˆ†æ”¯ä¸Šæ‰€åšçš„æ‰€æœ‰æ”¹å˜éƒ½åˆå¹¶åˆ°äº† master åˆ†æ”¯ä¸Šã€‚é‚£ä¹ˆ no-fast-forward åˆæ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿ</p><h5 id="No-fast-foward-â€”no-ff"><a href="#No-fast-foward-â€”no-ff" class="headerlink" title="No-fast-foward (â€”no-ff)"></a>No-fast-foward (â€”no-ff)</h5><p>å¦‚æœä½ çš„å½“å‰åˆ†æ”¯ç›¸æ¯”äºä½ æƒ³è¦åˆå¹¶çš„åˆ†æ”¯æ²¡æœ‰ä»»ä½•æäº¤ï¼Œé‚£å½“ç„¶å¾ˆå¥½ï¼Œä½†å¾ˆé—æ†¾ç°å®æƒ…å†µå¾ˆå°‘å¦‚æ­¤ï¼å¦‚æœæˆ‘ä»¬åœ¨å½“å‰åˆ†æ”¯ä¸Šæäº¤æˆ‘ä»¬æƒ³è¦åˆå¹¶çš„åˆ†æ”¯ä¸å…·å¤‡çš„æ”¹å˜ï¼Œé‚£ä¹ˆ git å°†ä¼šæ‰§è¡Œ no-fast-forward åˆå¹¶ã€‚</p><p>ä½¿ç”¨ no-fast-forward åˆå¹¶æ—¶ï¼ŒGit ä¼šåœ¨å½“å‰æ´»åŠ¨åˆ†æ”¯ä¸Šåˆ›å»ºæ–°çš„ merging commitã€‚è¿™ä¸ªæäº¤çš„çˆ¶æäº¤ï¼ˆparent commitï¼‰å³æŒ‡å‘è¿™ä¸ªæ´»åŠ¨åˆ†æ”¯ï¼Œä¹ŸæŒ‡å‘æˆ‘ä»¬æƒ³è¦åˆå¹¶çš„åˆ†æ”¯ï¼</p><p><img src="/images/git/image2.gif"></p><p>æ²¡ä»€ä¹ˆå¤§ä¸äº†çš„ï¼Œå®Œç¾çš„åˆå¹¶ï¼ç°åœ¨ï¼Œæˆ‘ä»¬åœ¨ dev åˆ†æ”¯ä¸Šæ‰€åšçš„æ‰€æœ‰æ”¹å˜éƒ½åˆå¹¶åˆ°äº† master åˆ†æ”¯ä¸Šã€‚</p><h5 id="åˆå¹¶å†²çª"><a href="#åˆå¹¶å†²çª" class="headerlink" title="åˆå¹¶å†²çª"></a>åˆå¹¶å†²çª</h5><p>å°½ç®¡ Git èƒ½å¤Ÿå¾ˆå¥½åœ°å†³å®šå¦‚ä½•åˆå¹¶åˆ†æ”¯ä»¥åŠå¦‚ä½•å‘æ–‡ä»¶æ·»åŠ ä¿®æ”¹ï¼Œä½†å®ƒå¹¶ä¸æ€»æ˜¯èƒ½å®Œå…¨è‡ªå·±åšå†³å®šã€‚å½“æˆ‘ä»¬æƒ³è¦åˆå¹¶çš„ä¸¤ä¸ªåˆ†æ”¯çš„åŒä¸€æ–‡ä»¶ä¸­çš„åŒä¸€è¡Œä»£ç ä¸Šæœ‰ä¸åŒçš„ä¿®æ”¹ï¼Œæˆ–è€…ä¸€ä¸ªåˆ†æ”¯åˆ é™¤äº†ä¸€ä¸ªæ–‡ä»¶è€Œå¦ä¸€ä¸ªåˆ†æ”¯ä¿®æ”¹äº†è¿™ä¸ªæ–‡ä»¶æ—¶ï¼ŒGit å°±ä¸çŸ¥é“å¦‚ä½•å–èˆäº†ã€‚</p><p>åœ¨è¿™æ ·çš„æƒ…å†µä¸‹ï¼ŒGit ä¼šè¯¢é—®ä½ æƒ³è¦ä¿ç•™å“ªç§é€‰æ‹©ï¼Ÿå‡è®¾åœ¨è¿™ä¸¤ä¸ªåˆ†æ”¯ä¸­ï¼Œæˆ‘ä»¬éƒ½ç¼–è¾‘äº† README.md çš„ç¬¬ä¸€è¡Œã€‚</p><p><img src="/images/git/image3.png"></p><p>å¦‚æœæˆ‘ä»¬æƒ³æŠŠ dev åˆå¹¶åˆ° masterï¼Œå°±ä¼šå‡ºç°ä¸€ä¸ªåˆå¹¶å†²çªï¼šä½ æƒ³è¦æ ‡é¢˜æ˜¯ Hello! è¿˜æ˜¯ Hey!ï¼Ÿ</p><p>å½“å°è¯•åˆå¹¶è¿™äº›åˆ†æ”¯æ—¶ï¼ŒGit ä¼šå‘ä½ å±•ç¤ºå†²çªå‡ºç°çš„ä½ç½®ã€‚æˆ‘ä»¬å¯ä»¥æ‰‹åŠ¨ç§»é™¤æˆ‘ä»¬ä¸æƒ³ä¿ç•™çš„ä¿®æ”¹ï¼Œä¿å­˜è¿™äº›ä¿®æ”¹ï¼Œå†æ¬¡æ·»åŠ è¿™ä¸ªå·²ä¿®æ”¹çš„æ–‡ä»¶ï¼Œç„¶åæäº¤è¿™äº›ä¿®æ”¹ã€‚</p><p><img src="/images/git/image4.gif"></p><p>å®Œæˆï¼å°½ç®¡åˆå¹¶å†²çªå¾€å¾€å¾ˆè®©äººåŒçƒ¦ï¼Œä½†è¿™æ˜¯åˆç†çš„ï¼šGit ä¸åº”è¯¥ççŒœæˆ‘ä»¬æƒ³è¦ä¿ç•™å“ªäº›ä¿®æ”¹ã€‚</p><h4 id="å˜åŸºï¼ˆRebasingï¼‰"><a href="#å˜åŸºï¼ˆRebasingï¼‰" class="headerlink" title="å˜åŸºï¼ˆRebasingï¼‰"></a>å˜åŸºï¼ˆRebasingï¼‰</h4><p>æˆ‘ä»¬åˆšçœ‹åˆ°å¯é€šè¿‡æ‰§è¡Œ git merge å°†ä¸€ä¸ªåˆ†æ”¯çš„ä¿®æ”¹åº”ç”¨åˆ°å¦ä¸€ä¸ªåˆ†æ”¯ã€‚å¦ä¸€ç§å¯å°†ä¸€ä¸ªåˆ†æ”¯çš„ä¿®æ”¹èå…¥åˆ°å¦ä¸€ä¸ªåˆ†æ”¯çš„æ–¹å¼æ˜¯æ‰§è¡Œ git rebaseã€‚</p><p>git rebase ä¼šå°†å½“å‰åˆ†æ”¯çš„æäº¤å¤åˆ¶åˆ°æŒ‡å®šçš„åˆ†æ”¯ä¹‹ä¸Šã€‚</p><p><img src="/images/git/image5.gif"></p><p>å®Œç¾ï¼Œç°åœ¨æˆ‘ä»¬åœ¨ dev åˆ†æ”¯ä¸Šè·å–äº† master åˆ†æ”¯ä¸Šçš„æ‰€æœ‰ä¿®æ”¹ã€‚</p><p>å˜åŸºä¸åˆå¹¶æœ‰ä¸€ä¸ªé‡å¤§çš„åŒºåˆ«ï¼šGit ä¸ä¼šå°è¯•ç¡®å®šè¦ä¿ç•™æˆ–ä¸ä¿ç•™å“ªäº›æ–‡ä»¶ã€‚æˆ‘ä»¬æ‰§è¡Œ rebase çš„åˆ†æ”¯æ€»æ˜¯å«æœ‰æˆ‘ä»¬æƒ³è¦ä¿ç•™çš„æœ€æ–°è¿‘çš„ä¿®æ”¹ï¼è¿™æ ·æˆ‘ä»¬ä¸ä¼šé‡åˆ°ä»»ä½•åˆå¹¶å†²çªï¼Œè€Œä¸”å¯ä»¥ä¿ç•™ä¸€ä¸ªæ¼‚äº®çš„ã€çº¿æ€§çš„ Git å†å²è®°å½•ã€‚</p><p>ä¸Šé¢è¿™ä¸ªä¾‹å­å±•ç¤ºäº†åœ¨ master åˆ†æ”¯ä¸Šçš„å˜åŸºã€‚ä½†æ˜¯ï¼Œåœ¨æ›´å¤§å‹çš„é¡¹ç›®ä¸­ï¼Œä½ é€šå¸¸ä¸éœ€è¦è¿™æ ·çš„æ“ä½œã€‚git rebase åœ¨ä¸ºå¤åˆ¶çš„æäº¤åˆ›å»ºæ–°çš„ hash æ—¶ä¼šä¿®æ”¹é¡¹ç›®çš„å†å²è®°å½•ã€‚</p><p>å¦‚æœä½ åœ¨å¼€å‘ä¸€ä¸ª feature åˆ†æ”¯å¹¶ä¸” master åˆ†æ”¯å·²ç»æ›´æ–°è¿‡ï¼Œé‚£ä¹ˆå˜åŸºå°±å¾ˆå¥½ç”¨ã€‚ä½ å¯ä»¥åœ¨ä½ çš„åˆ†æ”¯ä¸Šè·å–æ‰€æœ‰æ›´æ–°ï¼Œè¿™èƒ½é˜²æ­¢æœªæ¥å‡ºç°åˆå¹¶å†²çªã€‚</p><h4 id="äº¤äº’å¼å˜åŸºï¼ˆInteractive-Rebaseï¼‰"><a href="#äº¤äº’å¼å˜åŸºï¼ˆInteractive-Rebaseï¼‰" class="headerlink" title="äº¤äº’å¼å˜åŸºï¼ˆInteractive Rebaseï¼‰"></a>äº¤äº’å¼å˜åŸºï¼ˆInteractive Rebaseï¼‰</h4><p>åœ¨ä¸ºæäº¤æ‰§è¡Œå˜åŸºä¹‹å‰ï¼Œæˆ‘ä»¬å¯ä»¥ä¿®æ”¹å®ƒä»¬ï¼æˆ‘ä»¬å¯ä»¥ä½¿ç”¨äº¤äº’å¼å˜åŸºæ¥å®Œæˆè¿™ä¸€ä»»åŠ¡ã€‚äº¤äº’å¼å˜åŸºåœ¨ä½ å½“å‰å¼€å‘çš„åˆ†æ”¯ä¸Šä»¥åŠæƒ³è¦ä¿®æ”¹æŸäº›æäº¤æ—¶ä¼šå¾ˆæœ‰ç”¨ã€‚</p><p>åœ¨æˆ‘ä»¬æ­£åœ¨ rebase çš„æäº¤ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥æ‰§è¡Œä»¥ä¸‹ 6 ä¸ªåŠ¨ä½œï¼š</p><p>rewordï¼šä¿®æ”¹æäº¤ä¿¡æ¯ï¼›</p><p>editï¼šä¿®æ”¹æ­¤æäº¤ï¼›</p><p>squashï¼šå°†æäº¤èåˆåˆ°å‰ä¸€ä¸ªæäº¤ä¸­ï¼›</p><p>fixupï¼šå°†æäº¤èåˆåˆ°å‰ä¸€ä¸ªæäº¤ä¸­ï¼Œä¸ä¿ç•™è¯¥æäº¤çš„æ—¥å¿—æ¶ˆæ¯ï¼›</p><p>execï¼šåœ¨æ¯ä¸ªæäº¤ä¸Šè¿è¡Œæˆ‘ä»¬æƒ³è¦ rebase çš„å‘½ä»¤ï¼›</p><p>dropï¼šç§»é™¤è¯¥æäº¤ã€‚</p><p>å¾ˆæ£’ï¼è¿™æ ·æˆ‘ä»¬å°±èƒ½å®Œå…¨æ§åˆ¶æˆ‘ä»¬çš„æäº¤äº†ã€‚å¦‚æœä½ æƒ³è¦ç§»é™¤ä¸€ä¸ªæäº¤ï¼Œåªéœ€ drop å³å¯ã€‚</p><p><img src="/images/git/image6.gif"></p><p>å¦‚æœä½ æƒ³æŠŠå¤šä¸ªæäº¤èåˆåˆ°ä¸€èµ·ä»¥ä¾¿å¾—åˆ°æ¸…æ™°çš„æäº¤å†å²ï¼Œé‚£ä¹Ÿæ²¡æœ‰é—®é¢˜ï¼</p><p><img src="/images/git/image7.gif"></p><p>äº¤äº’å¼å˜åŸºèƒ½ä¸ºä½ åœ¨ rebase æ—¶æä¾›å¤§é‡æ§åˆ¶ï¼Œç”šè‡³å¯ä»¥æ§åˆ¶å½“å‰çš„æ´»åŠ¨åˆ†æ”¯ã€‚</p><h4 id="é‡ç½®ï¼ˆResettingï¼‰"><a href="#é‡ç½®ï¼ˆResettingï¼‰" class="headerlink" title="é‡ç½®ï¼ˆResettingï¼‰"></a>é‡ç½®ï¼ˆResettingï¼‰</h4><p>å½“æˆ‘ä»¬ä¸æƒ³è¦ä¹‹å‰æäº¤çš„ä¿®æ”¹æ—¶ï¼Œå°±ä¼šç”¨åˆ°è¿™ä¸ªå‘½ä»¤ã€‚ä¹Ÿè®¸è¿™æ˜¯ä¸€ä¸ª WIP æäº¤æˆ–è€…å¯èƒ½æ˜¯å¼•å…¥äº† bug çš„æäº¤ï¼Œè¿™æ—¶å€™å°±è¦æ‰§è¡Œ git resetã€‚</p><p>git reset èƒ½è®©æˆ‘ä»¬ä¸å†ä½¿ç”¨å½“å‰å°é¢ä¸Šçš„æ–‡ä»¶ï¼Œè®©æˆ‘ä»¬å¯ä»¥æ§åˆ¶ HEAD åº”è¯¥æŒ‡å‘çš„ä½ç½®ã€‚</p><h5 id="è½¯é‡ç½®"><a href="#è½¯é‡ç½®" class="headerlink" title="è½¯é‡ç½®"></a>è½¯é‡ç½®</h5><p>è½¯é‡ç½®ä¼šå°† HEAD ç§»è‡³æŒ‡å®šçš„æäº¤ï¼ˆæˆ–ä¸ HEAD ç›¸æ¯”çš„æäº¤çš„ç´¢å¼•ï¼‰ï¼Œè€Œä¸ä¼šç§»é™¤è¯¥æäº¤ä¹‹ååŠ å…¥çš„ä¿®æ”¹ï¼</p><p>å‡è®¾æˆ‘ä»¬ä¸æƒ³ä¿ç•™æ·»åŠ äº†ä¸€ä¸ª style.css æ–‡ä»¶çš„æäº¤ 9e78iï¼Œè€Œä¸”æˆ‘ä»¬ä¹Ÿä¸æƒ³ä¿ç•™æ·»åŠ äº†ä¸€ä¸ª index.js æ–‡ä»¶çš„æäº¤ 035ccã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬ç¡®å®åˆæƒ³è¦ä¿ç•™æ–°æ·»åŠ çš„ style.css å’Œ index.js æ–‡ä»¶ï¼è¿™æ˜¯è½¯é‡ç½®çš„ä¸€ä¸ªå®Œç¾ç”¨ä¾‹ã€‚</p><p><img src="/images/git/image8.gif"></p><p>è¾“å…¥ git status åï¼Œä½ ä¼šçœ‹åˆ°æˆ‘ä»¬ä»ç„¶å¯ä»¥è®¿é—®åœ¨ä¹‹å‰çš„æäº¤ä¸Šåšè¿‡çš„æ‰€æœ‰ä¿®æ”¹ã€‚è¿™å¾ˆå¥½ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥ä¿®å¤è¿™äº›æ–‡ä»¶çš„å†…å®¹ï¼Œä¹‹åå†é‡æ–°æäº¤å®ƒä»¬ï¼</p><h5 id="ç¡¬é‡ç½®"><a href="#ç¡¬é‡ç½®" class="headerlink" title="ç¡¬é‡ç½®"></a>ç¡¬é‡ç½®</h5><p>æœ‰æ—¶å€™æˆ‘ä»¬å¹¶ä¸æƒ³ä¿ç•™ç‰¹å®šæäº¤å¼•å…¥çš„ä¿®æ”¹ã€‚ä¸åŒäºè½¯é‡ç½®ï¼Œæˆ‘ä»¬åº”è¯¥å†ä¹Ÿæ— éœ€è®¿é—®å®ƒä»¬ã€‚Git åº”è¯¥ç›´æ¥å°†æ•´ä½“çŠ¶æ€ç›´æ¥é‡ç½®åˆ°ç‰¹å®šæäº¤ä¹‹å‰çš„çŠ¶æ€ï¼šè¿™ç”šè‡³åŒ…æ‹¬ä½ åœ¨å·¥ä½œç›®å½•ä¸­å’Œæš‚å­˜æ–‡ä»¶ä¸Šçš„ä¿®æ”¹ã€‚</p><p><img src="/images/git/image9.gif"></p><p>Git ä¸¢å¼ƒäº† 9e78i å’Œ 035cc å¼•å…¥çš„ä¿®æ”¹ï¼Œå¹¶å°†çŠ¶æ€é‡ç½®åˆ°äº† ec5be çš„çŠ¶æ€ã€‚</p><h4 id="è¿˜åŸï¼ˆRevertingï¼‰"><a href="#è¿˜åŸï¼ˆRevertingï¼‰" class="headerlink" title="è¿˜åŸï¼ˆRevertingï¼‰"></a>è¿˜åŸï¼ˆRevertingï¼‰</h4><p>å¦ä¸€ç§æ’¤é”€ä¿®æ”¹çš„æ–¹æ³•æ˜¯æ‰§è¡Œ git revertã€‚é€šè¿‡å¯¹ç‰¹å®šçš„æäº¤æ‰§è¡Œè¿˜åŸæ“ä½œï¼Œæˆ‘ä»¬ä¼šåˆ›å»ºä¸€ä¸ªåŒ…å«å·²è¿˜åŸä¿®æ”¹çš„æ–°æäº¤ã€‚</p><p>å‡è®¾ ec5be æ·»åŠ äº†ä¸€ä¸ª index.js æ–‡ä»¶ã€‚ä½†ä¹‹åæˆ‘ä»¬å‘ç°å…¶å®æˆ‘ä»¬å†ä¹Ÿä¸éœ€è¦ç”±è¿™ä¸ªæäº¤å¼•å…¥çš„ä¿®æ”¹äº†ã€‚é‚£å°±è¿˜åŸ ec5be æäº¤å§ï¼</p><p><img src="/images/git/image10.gif"></p><p>å®Œç¾ï¼æäº¤ 9e78i è¿˜åŸäº†ç”±æäº¤ ec5be å¼•å…¥çš„ä¿®æ”¹ã€‚åœ¨æ’¤é”€ç‰¹å®šçš„æäº¤æ—¶ï¼Œgit revert éå¸¸æœ‰ç”¨ï¼ŒåŒæ—¶ä¹Ÿä¸ä¼šä¿®æ”¹åˆ†æ”¯çš„å†å²ã€‚</p><h4 id="æ‹£é€‰ï¼ˆCherry-pickingï¼‰"><a href="#æ‹£é€‰ï¼ˆCherry-pickingï¼‰" class="headerlink" title="æ‹£é€‰ï¼ˆCherry-pickingï¼‰"></a>æ‹£é€‰ï¼ˆCherry-pickingï¼‰</h4><p>å½“ä¸€ä¸ªç‰¹å®šåˆ†æ”¯åŒ…å«æˆ‘ä»¬çš„æ´»åŠ¨åˆ†æ”¯éœ€è¦çš„æŸä¸ªæäº¤æ—¶ï¼Œæˆ‘ä»¬å¯¹é‚£ä¸ªæäº¤æ‰§è¡Œ cherry-pickï¼å¯¹ä¸€ä¸ªæäº¤æ‰§è¡Œ cherry-pick æ—¶ï¼Œæˆ‘ä»¬ä¼šåœ¨æ´»åŠ¨åˆ†æ”¯ä¸Šåˆ›å»ºä¸€ä¸ªæ–°çš„æäº¤ï¼Œå…¶ä¸­åŒ…å«ç”±æ‹£é€‰å‡ºæ¥çš„æäº¤æ‰€å¼•å…¥çš„ä¿®æ”¹ã€‚</p><p>å‡è®¾ dev åˆ†æ”¯ä¸Šçš„æäº¤ 76d12 ä¸º index.js æ–‡ä»¶æ·»åŠ äº†ä¸€é¡¹ä¿®æ”¹ï¼Œè€Œæˆ‘ä»¬å¸Œæœ›å°†å…¶æ•´åˆåˆ° master åˆ†æ”¯ä¸­ã€‚æˆ‘ä»¬å¹¶ä¸æƒ³è¦æ•´ä¸ª dev åˆ†æ”¯ï¼Œè€Œåªéœ€è¦è¿™ä¸ªæäº¤ï¼</p><p><img src="/images/git/image11.gif"></p><p>ç°åœ¨ master åˆ†æ”¯åŒ…å« 76d12 å¼•å…¥çš„ä¿®æ”¹äº†ã€‚</p><h4 id="å–å›ï¼ˆFetchingï¼‰"><a href="#å–å›ï¼ˆFetchingï¼‰" class="headerlink" title="å–å›ï¼ˆFetchingï¼‰"></a>å–å›ï¼ˆFetchingï¼‰</h4><p>å¦‚æœä½ æœ‰ä¸€ä¸ªè¿œç¨‹ Git åˆ†æ”¯ï¼Œæ¯”å¦‚åœ¨ GitHub ä¸Šçš„åˆ†æ”¯ï¼Œå½“è¿œç¨‹åˆ†æ”¯ä¸ŠåŒ…å«å½“å‰åˆ†æ”¯æ²¡æœ‰çš„æäº¤æ—¶ï¼Œå¯ä»¥ä½¿ç”¨å–å›ã€‚æ¯”å¦‚å½“åˆå¹¶äº†å¦ä¸€ä¸ªåˆ†æ”¯æˆ–ä½ çš„åŒäº‹æ¨é€äº†ä¸€ä¸ªå¿«é€Ÿä¿®å¤æ—¶ã€‚</p><p>é€šè¿‡åœ¨è¿™ä¸ªè¿œç¨‹åˆ†æ”¯ä¸Šæ‰§è¡Œ git fetchï¼Œæˆ‘ä»¬å°±å¯åœ¨æœ¬åœ°è·å–è¿™äº›ä¿®æ”¹ã€‚è¿™ä¸ä¼šä»¥ä»»ä½•æ–¹å¼å½±å“ä½ çš„æœ¬åœ°åˆ†æ”¯ï¼šfetch åªæ˜¯å•çº¯åœ°ä¸‹è½½æ–°çš„æ•°æ®è€Œå·²ã€‚</p><p><img src="/images/git/image12.gif"></p><p>ç°åœ¨æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è‡ªä¸Šæ¬¡æ¨é€ä»¥æ¥çš„æ‰€æœ‰ä¿®æ”¹äº†ã€‚è¿™äº›æ–°æ•°æ®ä¹Ÿå·²ç»åœ¨æœ¬åœ°äº†ï¼Œæˆ‘ä»¬å¯ä»¥å†³å®šç”¨è¿™äº›æ–°æ•°æ®åšä»€ä¹ˆäº†ã€‚</p><h4 id="æ‹‰å–ï¼ˆPullingï¼‰"><a href="#æ‹‰å–ï¼ˆPullingï¼‰" class="headerlink" title="æ‹‰å–ï¼ˆPullingï¼‰"></a>æ‹‰å–ï¼ˆPullingï¼‰</h4><p>å°½ç®¡ git fetch å¯ç”¨äºè·å–æŸä¸ªåˆ†æ”¯çš„è¿œç¨‹ä¿¡æ¯ï¼Œä½†æˆ‘ä»¬ä¹Ÿå¯ä»¥æ‰§è¡Œ git pullã€‚git pull å®é™…ä¸Šæ˜¯ä¸¤ä¸ªå‘½ä»¤åˆæˆäº†ä¸€ä¸ªï¼šgit fetch å’Œ git mergeã€‚å½“æˆ‘ä»¬ä»æ¥æºæ‹‰å–ä¿®æ”¹æ—¶ï¼Œæˆ‘ä»¬é¦–å…ˆæ˜¯åƒ git fetch é‚£æ ·å–å›æ‰€æœ‰æ•°æ®ï¼Œç„¶åæœ€æ–°çš„ä¿®æ”¹ä¼šè‡ªåŠ¨åˆå¹¶åˆ°æœ¬åœ°åˆ†æ”¯ä¸­ã€‚</p><p><img src="/images/git/image13.gif"></p><p>å¾ˆå¥½ï¼Œæˆ‘ä»¬ç°åœ¨ä¸è¿œç¨‹åˆ†æ”¯å®Œç¾åŒæ­¥äº†ï¼Œå¹¶ä¸”ä¹Ÿæœ‰äº†æ‰€æœ‰æœ€æ–°çš„ä¿®æ”¹ï¼</p><h4 id="Reflog"><a href="#Reflog" class="headerlink" title="Reflog"></a>Reflog</h4><p>æ¯ä¸ªäººéƒ½ä¼šçŠ¯é”™ï¼Œä½†çŠ¯é”™å…¶å®æ²¡å•¥ï¼æœ‰æ—¶å€™ä½ å¯èƒ½æ„Ÿè§‰ä½ æŠŠ git repo å®Œå…¨æåäº†ï¼Œè®©ä½ æƒ³å®Œå…¨åˆ äº†äº†äº‹ã€‚</p><p>git reflog æ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„å‘½ä»¤ï¼Œå¯ä»¥å±•ç¤ºå·²ç»æ‰§è¡Œè¿‡çš„æ‰€æœ‰åŠ¨ä½œçš„æ—¥å¿—ã€‚åŒ…æ‹¬åˆå¹¶ã€é‡ç½®ã€è¿˜åŸï¼ŒåŸºæœ¬ä¸ŠåŒ…å«ä½ å¯¹ä½ çš„åˆ†æ”¯æ‰€åšçš„ä»»ä½•ä¿®æ”¹ã€‚</p><p><img src="/images/git/image14.gif"></p><p>å¦‚æœä½ çŠ¯äº†é”™ï¼Œä½ å¯ä»¥æ ¹æ® reflog æä¾›çš„ä¿¡æ¯é€šè¿‡é‡ç½® HEAD æ¥è½»æ¾åœ°é‡åšï¼</p><p>å‡è®¾æˆ‘ä»¬å®é™…ä¸Šå¹¶ä¸éœ€è¦åˆå¹¶åŸæœ‰åˆ†æ”¯ã€‚å½“æˆ‘ä»¬æ‰§è¡Œ git reflog å‘½ä»¤æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™ä¸ª repo çš„çŠ¶æ€åœ¨åˆå¹¶å‰ä½äº HEAD@{1}ã€‚é‚£æˆ‘ä»¬å°±æ‰§è¡Œä¸€æ¬¡ git resetï¼Œå°† HEAD é‡æ–°æŒ‡å‘åœ¨ HEAD@{1} çš„ä½ç½®ã€‚</p><p><img src="/images/git/image15.gif"></p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœ€æ–°çš„åŠ¨ä½œå·²è¢«æ¨é€ç»™ reflogã€‚</p><h3 id="Octotree-Chrome-github-æµè§ˆæ’ä»¶"><a href="#Octotree-Chrome-github-æµè§ˆæ’ä»¶" class="headerlink" title="Octotree: Chrome github æµè§ˆæ’ä»¶"></a>Octotree: Chrome github æµè§ˆæ’ä»¶</h3><p> å¯ä»¥æŠŠ github é¡¹ç›®çš„ç›®å½•æ ‘ç»“æ„å±•ç¤ºå‡ºæ¥ </p><p><img src="/images/git/octotree_1.jpg"></p><p><img src="/images/git/octotree_2.jpg"></p><h4 id="GitHubæœç´¢"><a href="#GitHubæœç´¢" class="headerlink" title="GitHubæœç´¢"></a>GitHubæœç´¢</h4><p> å‡å¦‚ï¼Œæ­£åœ¨åšä¸€ä¸ªpythoné¡¹ç›®ï¼Œæ­£å¥½è¦ç”¨åˆ°ä¸€ä¸ªçˆ¬è™«å¤„ç†çš„æ¡†æ¶ï¼Œå…³é”®è¯å°±æ˜¯ <strong>Spider</strong> ï¼Œé‚£å°±å¯ä»¥å…ˆè¯•è¯•æœç´¢é¡¹ç›®åç§°é‡Œé¢åŒ…å« <strong>Spider</strong> çš„é¡¹ç›®ï¼š </p><h5 id="in-name-Spider"><a href="#in-name-Spider" class="headerlink" title="in:name Spider"></a>in:name Spider</h5><p><img src="/images/git/git_hub_1.jpg"></p><h5 id="in-name-Spider-stars-gt-3000"><a href="#in-name-Spider-stars-gt-3000" class="headerlink" title="in:name Spider stars:&gt;3000"></a>in:name Spider stars:&gt;3000</h5><p>å¦‚æœ éœ€è¦çº¦æŸæœç´¢ç»“æœçš„staræ•°å¤§äº3000+ </p><p><img src="/images/git/github_2.jpg"></p><h5 id="in-name-Spider-stars-gt-3000-forks-gt-1000"><a href="#in-name-Spider-stars-gt-3000-forks-gt-1000" class="headerlink" title="in:name Spider stars:&gt;3000 forks:&gt;1000"></a>in:name Spider stars:&gt;3000 forks:&gt;1000</h5><p>å¦‚æœéœ€è¦æ›´å°èŒƒå›´, å¯ä»¥çº¦æŸforkæ•° </p><p><img src="/images/git/github_3.jpg"></p><h5 id="in-name-Spider-stars-gt-3000-forks-gt-1000-language-python"><a href="#in-name-Spider-stars-gt-3000-forks-gt-1000-language-python" class="headerlink" title="in:name Spider stars:&gt;3000 forks:&gt;1000 language:python"></a>in:name Spider stars:&gt;3000 forks:&gt;1000 language:python</h5><p>å½“ç„¶ï¼Œä¹Ÿå¯ä»¥çº¦æŸè¯­è¨€</p><p><img src="/images/git/github_4.jpg"></p><h5 id="in-readme-Spider-stars-gt-3000-forks-gt-1000-language-python"><a href="#in-readme-Spider-stars-gt-3000-forks-gt-1000-language-python" class="headerlink" title="in:readme Spider stars:&gt;3000 forks:&gt;1000 language:python"></a>in:readme Spider stars:&gt;3000 forks:&gt;1000 language:python</h5><p> å¦‚æœä¸ç¡®å®šå…³é”®è¯æ˜¯å¦ä¼šå‘½ä¸­é¡¹ç›®åç§°ï¼Œé‚£å¯ä»¥é€šè¿‡ <strong>readme</strong> æ¥æœç´¢ ã€‚æ­¤æ—¶ï¼Œå°±éœ€è¦é‡æ–°è°ƒæ•´ starå’Œforkæ•° äº†ã€‚</p><p><img src="/images/git/github_5.jpg"></p><h5 id="in-description-Spider-stars-gt-3000-forks-gt-1000-language-python"><a href="#in-description-Spider-stars-gt-3000-forks-gt-1000-language-python" class="headerlink" title="in:description Spider stars:&gt;3000 forks:&gt;1000 language:python"></a>in:description Spider stars:&gt;3000 forks:&gt;1000 language:python</h5><p>å¦‚æœï¼Œæˆ‘ä»¬æƒ³è¦æ‰¾çš„é¡¹ç›®ï¼Œæƒ³ä¸åˆ°ä¸€ä¸ªè‹±æ–‡å…³é”®è¯å»æè¿°ï¼Œæ€ä¹ˆåŠï¼Ÿ</p><p>è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ç›´æ¥ç”¨ä¸€ç§ç®€å•ç²—æš´çš„æ–¹å¼ï¼ŒæŒ‰ç…§ <strong>description</strong> çš„æ–¹å¼æ¥æœç´¢ï¼š</p><p><img src="/images/git/github_6.jpg"></p><h5 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h5><p>æ ¹æ®å¼€æºé¡¹ç›®çš„ä¸»è¦ç»„æˆéƒ¨åˆ†ï¼š</p><p>â€‹    â—† name: é¡¹ç›®å</p><p>â€‹    â—† description: é¡¹ç›®çš„ç®€è¦æè¿°</p><p>â€‹    â—† é¡¹ç›®çš„æºç </p><p>â€‹    â—† README.md: é¡¹ç›®çš„è¯¦ç»†æƒ…å†µçš„ä»‹ç»</p><pre><code class="hljs markdown">|      ç­›é€‰æ¡ä»¶       |            å¤‡æ³¨            || ------------------ | ------------------------- || in:name xxx        | æŒ‰ç…§é¡¹ç›®åæœç´¢              ï½œ| in:readme xxx      | æŒ‰ç…§READMEæœç´¢             ï½œ| in:description xxx | æŒ‰ç…§descriptionæœç´¢        ï½œ| stars:&gt;xxx         | starsæ•°å¤§äºxxx             ï½œ| forks:&gt;xxx         | forksæ•°å¤§äºxxx             ï½œ| language:xxx       | ç¼–ç¨‹è¯­è¨€æ˜¯xxx              ï½œ| pushed:&gt;YYYY-MM-DD | æœ€åæ›´æ–°æ—¶é—´å¤§äºYYYY-MM-DD  ï½œ</code></pre>]]></content>
    
    
    <categories>
      
      <category>Develop</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Git</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€Goã€‘å¹¶å‘ä¹‹é“</title>
    <link href="/2020/06/14/golang-concurrency/"/>
    <url>/2020/06/14/golang-concurrency/</url>
    
    <content type="html"><![CDATA[<blockquote></blockquote><h3 id="goroutine"><a href="#goroutine" class="headerlink" title="goroutine"></a><code>goroutine</code></h3><p><img src="/images/golang/goroutine.png"></p><h4 id="åç¨‹-Coroutine"><a href="#åç¨‹-Coroutine" class="headerlink" title="åç¨‹ Coroutine"></a>åç¨‹ <code>Coroutine</code></h4><ul><li><p><em>è½»é‡çº§</em>çº¿ç¨‹</p></li><li><p><strong>éæŠ¢å å¼</strong>å¤šä»»åŠ¡å¤„ç†ï¼Œç”±åç¨‹ä¸»åŠ¨äº¤å‡ºæ§åˆ¶æƒ</p></li><li><p>ç¼–è¯‘å™¨/è§£é‡Šå™¨/è™šæ‹Ÿæœºå±‚çš„å¤šä»»åŠ¡</p></li><li><p>å¤šä¸ªåç¨‹å¯ä»¥åœ¨ä¸€ä¸ªæˆ–è€…å¤šä¸ªçº¿ç¨‹ä¸Šè¿è¡Œ</p></li></ul><h5 id="å…¶ä»–è¯­è¨€å¯¹åç¨‹çš„æ”¯æŒ"><a href="#å…¶ä»–è¯­è¨€å¯¹åç¨‹çš„æ”¯æŒ" class="headerlink" title="å…¶ä»–è¯­è¨€å¯¹åç¨‹çš„æ”¯æŒ"></a>å…¶ä»–è¯­è¨€å¯¹åç¨‹çš„æ”¯æŒ</h5><p><code>Java</code>ï¼šæ ‡å‡†åº“ä¸æ”¯æŒ</p><p><code>Python</code>ï¼š3.5ç‰ˆæœ¬å‰ä½¿ç”¨yieldå…³é”®å­—</p><p>â€‹                 3.5ä»¥åï¼Œ <code>async def æ–¹æ³•å</code>å®ç°åç¨‹çš„åŸç”Ÿæ”¯æŒ</p><h5 id="å¯èƒ½åˆ‡æ¢goroutineçš„äº‹ä»¶"><a href="#å¯èƒ½åˆ‡æ¢goroutineçš„äº‹ä»¶" class="headerlink" title="å¯èƒ½åˆ‡æ¢goroutineçš„äº‹ä»¶"></a>å¯èƒ½åˆ‡æ¢<code>goroutine</code>çš„äº‹ä»¶</h5><ul><li><p><code>I/O, Select</code></p></li><li><p><code>channel</code></p></li><li><p>ç­‰å¾…é”</p></li><li><p>å‡½æ•°è°ƒç”¨</p></li><li><p><code>runtime.Gosched()</code></p></li><li><p><code>.e.g</code></p></li></ul><pre><code class="hljs go"><span class="hljs-keyword">import</span> (<span class="hljs-string">&quot;fmt&quot;</span><span class="hljs-string">&quot;time&quot;</span>)<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">Run</span><span class="hljs-params">()</span></span>  &#123;<span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">100</span>; i ++ &#123;<span class="hljs-keyword">go</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(j <span class="hljs-keyword">int</span>)</span></span> &#123;<span class="hljs-keyword">for</span>&#123;fmt.Println(<span class="hljs-string">&quot;go run from&quot;</span>, j)&#125;&#125;(i)&#125;time.Sleep(time.Minute)&#125;</code></pre><h4 id="channel"><a href="#channel" class="headerlink" title="channel"></a><code>channel</code></h4><p><img src="/images/golang/channel.png"></p><pre><code class="hljs go"><span class="hljs-keyword">import</span> (<span class="hljs-string">&quot;fmt&quot;</span><span class="hljs-string">&quot;time&quot;</span>)<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">works</span><span class="hljs-params">(id <span class="hljs-keyword">int</span>, c <span class="hljs-keyword">chan</span> <span class="hljs-keyword">int</span>)</span></span>  &#123;<span class="hljs-comment">// ä¸æ–­çš„ä»channelå–</span><span class="hljs-keyword">for</span>  &#123;fmt.Printf(<span class="hljs-string">&quot;channel %d receive %c\n&quot;</span>, id, &lt;-c)&#125;&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">workIfNotClose</span><span class="hljs-params">(id <span class="hljs-keyword">int</span>, c <span class="hljs-keyword">chan</span> <span class="hljs-keyword">int</span>)</span></span>  &#123;<span class="hljs-comment">// æ¥æ”¶æ–¹åˆ¤æ–­channelä¸­æœ‰æ•°æ®å°±ä¸æ–­çš„ä»channelå–</span><span class="hljs-keyword">for</span>  &#123;n, ok := &lt;-c<span class="hljs-keyword">if</span> !ok&#123;<span class="hljs-keyword">break</span>&#125;fmt.Printf(<span class="hljs-string">&quot;channel %d receive %c\n&quot;</span>, id, n)&#125;&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">workIfNotCloseSimple</span><span class="hljs-params">(id <span class="hljs-keyword">int</span>, c <span class="hljs-keyword">chan</span> <span class="hljs-keyword">int</span>)</span></span>  &#123;<span class="hljs-comment">// æ¥æ”¶æ–¹åˆ¤æ–­channelä¸­æœ‰æ•°æ®å°±ä¸æ–­çš„ä»channelå–</span><span class="hljs-keyword">for</span> n := <span class="hljs-keyword">range</span> c&#123;fmt.Printf(<span class="hljs-string">&quot;channel %d receive %c\n&quot;</span>, id, n)&#125;&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">createWorks</span><span class="hljs-params">(id <span class="hljs-keyword">int</span>)</span> <span class="hljs-title">chan</span>&lt;- <span class="hljs-title">int</span></span> &#123;c := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">chan</span> <span class="hljs-keyword">int</span>)<span class="hljs-keyword">go</span> works(id, c)<span class="hljs-keyword">return</span> c&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">first</span><span class="hljs-params">()</span></span>  &#123;<span class="hljs-comment">// åˆ›å»ºchannelç”¨ä¾‹</span><span class="hljs-keyword">var</span> chans [<span class="hljs-number">10</span>]<span class="hljs-keyword">chan</span> <span class="hljs-keyword">int</span><span class="hljs-keyword">for</span>  i := <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++ &#123;chans[i] = <span class="hljs-built_in">make</span>(<span class="hljs-keyword">chan</span> <span class="hljs-keyword">int</span>)<span class="hljs-keyword">go</span> works(i, chans[i])&#125;<span class="hljs-comment">// å¾€channelæ”¾</span><span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++ &#123;chans[i] &lt;- <span class="hljs-string">&#x27;a&#x27;</span> + i&#125;<span class="hljs-comment">// å¾€channelæ”¾</span><span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++ &#123;chans[i] &lt;- <span class="hljs-string">&#x27;A&#x27;</span> + i&#125;&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">second</span><span class="hljs-params">()</span></span>  &#123;<span class="hljs-comment">// åªèƒ½å‘æ•°æ®  chan&lt;- int å°†channel ä½œä¸ºå‡½æ•°è¿”å›å‚æ•°  å³ channelä¹Ÿæ˜¯ä¸€ç­‰å…¬æ°‘</span><span class="hljs-keyword">var</span> chann [<span class="hljs-number">10</span>] <span class="hljs-keyword">chan</span>&lt;- <span class="hljs-keyword">int</span><span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++ &#123;chann[i] = createWorks(i)&#125;<span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++ &#123;chann[i] &lt;- <span class="hljs-string">&#x27;k&#x27;</span> + i&#125;<span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++ &#123;chann[i] &lt;- <span class="hljs-string">&#x27;K&#x27;</span> + i&#125;&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">thirdBufferedChannel</span><span class="hljs-params">()</span></span> &#123;<span class="hljs-comment">// channelç¼“å†²åŒº   å¯ä»¥æ”¾å…¥ä¸å¤§äºç¼“å†²åŒºçš„å¤§å°æ—¶ï¼Œå¯ä»¥ä¸ç”¨å–</span>c := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">chan</span> <span class="hljs-keyword">int</span>, <span class="hljs-number">4</span>)<span class="hljs-keyword">go</span> works(<span class="hljs-number">0</span>, c)c &lt;- <span class="hljs-string">&#x27;u&#x27;</span>c &lt;- <span class="hljs-string">&#x27;v&#x27;</span>c &lt;- <span class="hljs-string">&#x27;w&#x27;</span>c &lt;- <span class="hljs-string">&#x27;x&#x27;</span>c &lt;- <span class="hljs-string">&#x27;y&#x27;</span>&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">channelClose</span><span class="hljs-params">()</span></span>  &#123;c := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">chan</span> <span class="hljs-keyword">int</span>, <span class="hljs-number">4</span>)<span class="hljs-keyword">go</span> workIfNotCloseSimple(<span class="hljs-number">0</span>, c)c &lt;- <span class="hljs-string">&#x27;U&#x27;</span>c &lt;- <span class="hljs-string">&#x27;V&#x27;</span>c &lt;- <span class="hljs-string">&#x27;W&#x27;</span><span class="hljs-built_in">close</span>(c)&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">ChanDemo</span><span class="hljs-params">()</span></span>  &#123;<span class="hljs-comment">//  channelä¹Ÿæ˜¯ä¸€ç­‰å…¬æ°‘</span>first()second()fmt.Println(<span class="hljs-string">&quot;-----------------&quot;</span>)thirdBufferedChannel()channelClose()time.Sleep(time.Second)&#125;<span class="hljs-comment">// è¾“å‡º</span>channel <span class="hljs-number">7</span> receive hchannel <span class="hljs-number">9</span> receive jchannel <span class="hljs-number">8</span> receive ichannel <span class="hljs-number">5</span> receive fchannel <span class="hljs-number">3</span> receive dchannel <span class="hljs-number">6</span> receive gchannel <span class="hljs-number">4</span> receive echannel <span class="hljs-number">2</span> receive cchannel <span class="hljs-number">1</span> receive bchannel <span class="hljs-number">0</span> receive achannel <span class="hljs-number">0</span> receive A-----------------channel <span class="hljs-number">4</span> receive Echannel <span class="hljs-number">3</span> receive Dchannel <span class="hljs-number">1</span> receive Bchannel <span class="hljs-number">7</span> receive Hchannel <span class="hljs-number">2</span> receive Cchannel <span class="hljs-number">5</span> receive Fchannel <span class="hljs-number">6</span> receive Gchannel <span class="hljs-number">9</span> receive Jchannel <span class="hljs-number">8</span> receive Ichannel <span class="hljs-number">0</span> receive kchannel <span class="hljs-number">1</span> receive lchannel <span class="hljs-number">2</span> receive mchannel <span class="hljs-number">3</span> receive nchannel <span class="hljs-number">4</span> receive ochannel <span class="hljs-number">5</span> receive pchannel <span class="hljs-number">6</span> receive qchannel <span class="hljs-number">7</span> receive rchannel <span class="hljs-number">7</span> receive Rchannel <span class="hljs-number">8</span> receive schannel <span class="hljs-number">8</span> receive Schannel <span class="hljs-number">3</span> receive Nchannel <span class="hljs-number">5</span> receive Pchannel <span class="hljs-number">0</span> receive Kchannel <span class="hljs-number">6</span> receive Qchannel <span class="hljs-number">9</span> receive tchannel <span class="hljs-number">9</span> receive Tchannel <span class="hljs-number">2</span> receive Mchannel <span class="hljs-number">4</span> receive Ochannel <span class="hljs-number">1</span> receive L-----------------channel <span class="hljs-number">0</span> receive uchannel <span class="hljs-number">0</span> receive vchannel <span class="hljs-number">0</span> receive wchannel <span class="hljs-number">0</span> receive xchannel <span class="hljs-number">0</span> receive ychannel <span class="hljs-number">0</span> receive Uchannel <span class="hljs-number">0</span> receive Vchannel <span class="hljs-number">0</span> receive WExiting.</code></pre><h5 id="é€šè¿‡é€šä¿¡æ¥å…±äº«å†…å­˜"><a href="#é€šè¿‡é€šä¿¡æ¥å…±äº«å†…å­˜" class="headerlink" title="é€šè¿‡é€šä¿¡æ¥å…±äº«å†…å­˜"></a>é€šè¿‡é€šä¿¡æ¥å…±äº«å†…å­˜</h5><pre><code class="hljs go"><span class="hljs-comment">/**</span><span class="hljs-comment"> * Author: Wang P</span><span class="hljs-comment"> * Version: 1.0.0</span><span class="hljs-comment"> * Date: 2021/2/5 ä¸‹åˆ5:05</span><span class="hljs-comment"> * Description:</span><span class="hljs-comment"> **/</span><span class="hljs-keyword">package</span> goroutines<span class="hljs-keyword">import</span> (<span class="hljs-string">&quot;fmt&quot;</span>)<span class="hljs-keyword">type</span> Worker <span class="hljs-keyword">struct</span> &#123;in <span class="hljs-keyword">chan</span> <span class="hljs-keyword">int</span>done <span class="hljs-keyword">chan</span> <span class="hljs-keyword">bool</span>&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">doWork</span><span class="hljs-params">(id <span class="hljs-keyword">int</span>, w Worker)</span></span>  &#123;<span class="hljs-comment">// æ¥æ”¶æ–¹åˆ¤æ–­channelä¸­æœ‰æ•°æ®å°±ä¸æ–­çš„ä»channelå–</span><span class="hljs-keyword">for</span> n := <span class="hljs-keyword">range</span> w.in&#123;fmt.Printf(<span class="hljs-string">&quot;channel %d receive %c\n&quot;</span>, id, n)w.done &lt;- <span class="hljs-literal">true</span>&#125;&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">createWorkers</span><span class="hljs-params">(id <span class="hljs-keyword">int</span>)</span> <span class="hljs-title">Worker</span></span> &#123;w := Worker&#123;in: <span class="hljs-built_in">make</span>(<span class="hljs-keyword">chan</span> <span class="hljs-keyword">int</span>),done: <span class="hljs-built_in">make</span>(<span class="hljs-keyword">chan</span> <span class="hljs-keyword">bool</span>),&#125;<span class="hljs-keyword">go</span> doWork(id, w)<span class="hljs-keyword">return</span> w&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">communicate</span><span class="hljs-params">()</span></span>  &#123;<span class="hljs-comment">// åªèƒ½å‘æ•°æ®  chan&lt;- int å°†channel ä½œä¸ºå‡½æ•°è¿”å›å‚æ•°  å³ channelä¹Ÿæ˜¯ä¸€ç­‰å…¬æ°‘</span><span class="hljs-keyword">var</span> works [<span class="hljs-number">10</span>]Worker<span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++ &#123;works[i] = createWorkers(i)&#125;<span class="hljs-keyword">for</span> i, worker := <span class="hljs-keyword">range</span> works&#123;worker.in &lt;- <span class="hljs-string">&#x27;a&#x27;</span> + i&#125;<span class="hljs-keyword">for</span> _, worker := <span class="hljs-keyword">range</span> works&#123;&lt;- worker.done&#125;<span class="hljs-keyword">for</span> i, worker := <span class="hljs-keyword">range</span> works&#123;worker.in &lt;- <span class="hljs-string">&#x27;A&#x27;</span> + i&#125;<span class="hljs-keyword">for</span> _, worker := <span class="hljs-keyword">range</span> works&#123;&lt;- worker.done&#125;&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">doWork2</span><span class="hljs-params">(id <span class="hljs-keyword">int</span>, w Worker)</span></span>  &#123;<span class="hljs-comment">// æ¥æ”¶æ–¹åˆ¤æ–­channelä¸­æœ‰æ•°æ®å°±ä¸æ–­çš„ä»channelå–</span><span class="hljs-keyword">for</span> n := <span class="hljs-keyword">range</span> w.in&#123;fmt.Printf(<span class="hljs-string">&quot;channel %d receive %c\n&quot;</span>, id, n)<span class="hljs-keyword">go</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> &#123;w.done &lt;- <span class="hljs-literal">true</span>&#125;()&#125;&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">createWorkers2</span><span class="hljs-params">(id <span class="hljs-keyword">int</span>)</span> <span class="hljs-title">Worker</span></span> &#123;w := Worker&#123;in: <span class="hljs-built_in">make</span>(<span class="hljs-keyword">chan</span> <span class="hljs-keyword">int</span>),done: <span class="hljs-built_in">make</span>(<span class="hljs-keyword">chan</span> <span class="hljs-keyword">bool</span>),&#125;<span class="hljs-keyword">go</span> doWork2(id, w)<span class="hljs-keyword">return</span> w&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">communicateDoneAll</span><span class="hljs-params">()</span></span>  &#123;<span class="hljs-comment">// åªèƒ½å‘æ•°æ®  chan&lt;- int å°†channel ä½œä¸ºå‡½æ•°è¿”å›å‚æ•°  å³ channelä¹Ÿæ˜¯ä¸€ç­‰å…¬æ°‘</span><span class="hljs-keyword">var</span> worksAll [<span class="hljs-number">10</span>]Worker<span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++ &#123;worksAll[i] = createWorkers2(i)&#125;<span class="hljs-keyword">for</span> i, worker := <span class="hljs-keyword">range</span> worksAll &#123;worker.in &lt;- <span class="hljs-string">&#x27;j&#x27;</span> + i&#125;<span class="hljs-keyword">for</span> i, worker := <span class="hljs-keyword">range</span> worksAll &#123;worker.in &lt;- <span class="hljs-string">&#x27;J&#x27;</span> + i&#125;<span class="hljs-comment">// ç­‰æ‰€æœ‰ä»»åŠ¡éƒ½å–å®Œ å†ç»“æŸ</span><span class="hljs-keyword">for</span> _, worker := <span class="hljs-keyword">range</span> worksAll &#123;&lt;- worker.done&lt;- worker.done&#125;&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">communicateDemo</span><span class="hljs-params">()</span></span>  &#123;communicate()fmt.Println(<span class="hljs-string">&quot;----------------&quot;</span>)communicateDoneAll()&#125;<span class="hljs-comment">// è¾“å‡º</span>channel <span class="hljs-number">7</span> receive hchannel <span class="hljs-number">5</span> receive fchannel <span class="hljs-number">8</span> receive ichannel <span class="hljs-number">9</span> receive jchannel <span class="hljs-number">2</span> receive cchannel <span class="hljs-number">3</span> receive dchannel <span class="hljs-number">1</span> receive bchannel <span class="hljs-number">0</span> receive achannel <span class="hljs-number">4</span> receive echannel <span class="hljs-number">6</span> receive gchannel <span class="hljs-number">6</span> receive Gchannel <span class="hljs-number">7</span> receive Hchannel <span class="hljs-number">8</span> receive Ichannel <span class="hljs-number">9</span> receive Jchannel <span class="hljs-number">0</span> receive Achannel <span class="hljs-number">1</span> receive Bchannel <span class="hljs-number">2</span> receive Cchannel <span class="hljs-number">3</span> receive Dchannel <span class="hljs-number">5</span> receive Fchannel <span class="hljs-number">4</span> receive E----------------channel <span class="hljs-number">0</span> receive jchannel <span class="hljs-number">1</span> receive kchannel <span class="hljs-number">4</span> receive nchannel <span class="hljs-number">2</span> receive lchannel <span class="hljs-number">3</span> receive mchannel <span class="hljs-number">2</span> receive Lchannel <span class="hljs-number">8</span> receive rchannel <span class="hljs-number">0</span> receive Jchannel <span class="hljs-number">1</span> receive Kchannel <span class="hljs-number">7</span> receive qchannel <span class="hljs-number">5</span> receive ochannel <span class="hljs-number">9</span> receive schannel <span class="hljs-number">3</span> receive Mchannel <span class="hljs-number">5</span> receive Ochannel <span class="hljs-number">6</span> receive pchannel <span class="hljs-number">4</span> receive Nchannel <span class="hljs-number">6</span> receive Pchannel <span class="hljs-number">9</span> receive Schannel <span class="hljs-number">7</span> receive Qchannel <span class="hljs-number">8</span> receive R</code></pre><h5 id="åˆ©ç”¨channeléå†æ ‘"><a href="#åˆ©ç”¨channeléå†æ ‘" class="headerlink" title="åˆ©ç”¨channeléå†æ ‘"></a>åˆ©ç”¨channeléå†æ ‘</h5><pre><code class="hljs go"><span class="hljs-keyword">package</span> goroutines<span class="hljs-keyword">import</span> <span class="hljs-string">&quot;fmt&quot;</span><span class="hljs-keyword">type</span> Node <span class="hljs-keyword">struct</span> &#123;Value       <span class="hljs-keyword">int</span>Left, Right *Node&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">createNode</span><span class="hljs-params">(value <span class="hljs-keyword">int</span>)</span> *<span class="hljs-title">Node</span></span> &#123;<span class="hljs-keyword">return</span> &amp;Node&#123;Value: value&#125;&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(node *Node)</span> <span class="hljs-title">setValue</span><span class="hljs-params">(value <span class="hljs-keyword">int</span>)</span></span> &#123;<span class="hljs-comment">// æ¥æ”¶è€…ä½¿ç”¨æŒ‡é’ˆæ‰å¯ä»¥æ”¹å˜ç»“æ„å†…å®¹</span><span class="hljs-keyword">if</span> node == <span class="hljs-literal">nil</span> &#123;fmt.Println(<span class="hljs-string">&quot;Setting Value to nil node. Ignored.&quot;</span>)<span class="hljs-keyword">return</span>&#125;node.Value = value&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(node *Node)</span> <span class="hljs-title">print</span><span class="hljs-params">()</span></span> &#123;<span class="hljs-keyword">if</span> node == <span class="hljs-literal">nil</span> &#123;<span class="hljs-keyword">return</span>&#125;fmt.Print(node.Value, <span class="hljs-string">&quot; &quot;</span>)&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(node *Node)</span><span class="hljs-title">travelsWithFunc</span><span class="hljs-params">(f <span class="hljs-keyword">func</span>(*Node)</span>)</span> &#123;<span class="hljs-keyword">if</span> node == <span class="hljs-literal">nil</span> &#123;<span class="hljs-keyword">return</span>&#125;node.Left.travelsWithFunc(f)f(node)node.Right.travelsWithFunc(f)&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(node *Node)</span><span class="hljs-title">travelWithChannel</span><span class="hljs-params">()</span> <span class="hljs-title">chan</span> *<span class="hljs-title">Node</span></span>&#123;c := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">chan</span> *Node)<span class="hljs-keyword">go</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> &#123;node.travelsWithFunc(<span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(node *Node)</span></span> &#123;c &lt;- node&#125;)<span class="hljs-built_in">close</span>(c)&#125;()<span class="hljs-keyword">return</span> c&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">initTree</span><span class="hljs-params">()</span> *<span class="hljs-title">Node</span></span> &#123;<span class="hljs-keyword">var</span> root Noderoot = Node&#123;Value: <span class="hljs-number">3</span>&#125;root.Left = &amp;Node&#123;&#125;root.Right = &amp;Node&#123;<span class="hljs-number">5</span>, <span class="hljs-literal">nil</span>, <span class="hljs-literal">nil</span>&#125;root.Right.Left = <span class="hljs-built_in">new</span>(Node)root.Left.Right = createNode(<span class="hljs-number">2</span>)root.Right.Left.setValue(<span class="hljs-number">4</span>)<span class="hljs-keyword">return</span> &amp;root&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">Demo</span><span class="hljs-params">()</span></span>  &#123;t := initTree()<span class="hljs-comment">// è®¡æ•°</span>  nodeCount := <span class="hljs-number">0</span>t.travelsWithFunc(<span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(node *Node)</span></span> &#123;nodeCount++&#125;)fmt.Println(<span class="hljs-string">&quot;Node counts&quot;</span>, nodeCount)<span class="hljs-comment">// æ ‘ä¸­æœ€å¤§å€¼</span>  c := t.travelWithChannel()maxNode := <span class="hljs-number">0</span><span class="hljs-comment">// ä»channelä¸­å–</span><span class="hljs-keyword">for</span> n := <span class="hljs-keyword">range</span> c &#123;<span class="hljs-keyword">if</span> maxNode &lt; n.Value &#123;maxNode = n.Value&#125;&#125;fmt.Println(<span class="hljs-string">&quot;Max node:&quot;</span>, maxNode)&#125;</code></pre><h4 id="Selectè°ƒåº¦"><a href="#Selectè°ƒåº¦" class="headerlink" title="Selectè°ƒåº¦"></a><code>Select</code>è°ƒåº¦</h4><pre><code class="hljs go"><span class="hljs-comment">/**</span><span class="hljs-comment"> * Author: Wang P</span><span class="hljs-comment"> * Version: 1.0.0</span><span class="hljs-comment"> * Date: 2021/2/5 ä¸Šåˆ10:37</span><span class="hljs-comment"> * Description: select</span><span class="hljs-comment"> **/</span><span class="hljs-keyword">package</span> goroutines<span class="hljs-keyword">import</span> (<span class="hljs-string">&quot;fmt&quot;</span><span class="hljs-string">&quot;math/rand&quot;</span><span class="hljs-string">&quot;time&quot;</span>)<span class="hljs-keyword">type</span> SelectWorker <span class="hljs-keyword">struct</span> &#123;id <span class="hljs-keyword">string</span>c <span class="hljs-keyword">chan</span> <span class="hljs-keyword">int</span>&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(w *SelectWorker)</span> <span class="hljs-title">setValue</span><span class="hljs-params">(id <span class="hljs-keyword">string</span>)</span></span>  &#123;w.id = id&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">selectNotBlock</span><span class="hljs-params">(c1, c2 <span class="hljs-keyword">chan</span> <span class="hljs-keyword">int</span>)</span></span>  &#123;<span class="hljs-keyword">for</span> &#123;<span class="hljs-keyword">select</span> &#123;<span class="hljs-keyword">case</span> n := &lt;- c1:fmt.Printf(<span class="hljs-string">&quot;receice %d from c1\n&quot;</span>, n)<span class="hljs-keyword">case</span> n := &lt;-c2:fmt.Printf(<span class="hljs-string">&quot;receice %d from c2\n&quot;</span>, n)<span class="hljs-keyword">default</span>:fmt.Println(<span class="hljs-string">&quot;not receive anything&quot;</span>)&#125;&#125;&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">selectBlock</span><span class="hljs-params">(c1, c2 <span class="hljs-keyword">chan</span> <span class="hljs-keyword">int</span>)</span></span>  &#123;<span class="hljs-keyword">for</span> &#123;<span class="hljs-keyword">select</span> &#123;<span class="hljs-keyword">case</span> n := &lt;- c1:fmt.Printf(<span class="hljs-string">&quot;receice %d from c1\n&quot;</span>, n)<span class="hljs-keyword">case</span> n := &lt;-c2:fmt.Printf(<span class="hljs-string">&quot;receice %d from c2\n&quot;</span>, n)&#125;&#125;&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">selectWorkConditionBlock</span><span class="hljs-params">(rw, sw1, sw2 SelectWorker)</span></span>  &#123;<span class="hljs-keyword">var</span> values []<span class="hljs-keyword">int</span>id := <span class="hljs-string">&quot;&quot;</span>endTime := time.After(time.Second * <span class="hljs-number">10</span>)tick := time.Tick(time.Second)<span class="hljs-keyword">for</span> &#123;activeWorker := SelectWorker&#123;c:  <span class="hljs-literal">nil</span>,&#125;<span class="hljs-keyword">var</span> activeValue <span class="hljs-keyword">int</span><span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(values) &gt;<span class="hljs-number">0</span> &#123;rw.setValue(id)activeWorker = rwactiveValue = values[<span class="hljs-number">0</span>]&#125;<span class="hljs-keyword">select</span> &#123;<span class="hljs-keyword">case</span> n := &lt;-sw1.c:id = sw1.idvalues = <span class="hljs-built_in">append</span>(values, n)<span class="hljs-keyword">case</span> n := &lt;-sw2.c:id = sw2.idvalues = <span class="hljs-built_in">append</span>(values, n)<span class="hljs-keyword">case</span> activeWorker.c &lt;- activeValue:values = values[<span class="hljs-number">1</span>:]<span class="hljs-keyword">case</span> &lt;-time.After(time.Millisecond * <span class="hljs-number">600</span>):  <span class="hljs-comment">// 500æ¯«ç§’æœªäº§ç”Ÿæ•°æ®</span>fmt.Println(<span class="hljs-string">&quot;ç¨‹åºè¶…æ—¶&quot;</span>)<span class="hljs-keyword">case</span> &lt;- tick:fmt.Println(<span class="hljs-string">&quot;queue len = &quot;</span>, <span class="hljs-built_in">len</span>(values))<span class="hljs-keyword">case</span> &lt;- endTime:  <span class="hljs-comment">// ç¨‹åºæ‰§è¡Œåˆ°endTimeæ—¶ç»“æŸ</span>fmt.Println(<span class="hljs-string">&quot;ç¨‹åºæ‰§è¡Œç»“æŸ&quot;</span>)<span class="hljs-keyword">return</span>&#125;&#125;&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">generateChannel</span><span class="hljs-params">()</span> <span class="hljs-title">chan</span> <span class="hljs-title">int</span></span>&#123;c := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">chan</span> <span class="hljs-keyword">int</span>)<span class="hljs-keyword">go</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> &#123;i := <span class="hljs-number">0</span><span class="hljs-keyword">for</span> &#123;time.Sleep(time.Duration(rand.Intn(<span class="hljs-number">1000</span>)) * time.Millisecond)c &lt;- ii++&#125;&#125;()<span class="hljs-keyword">return</span> c&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">generateWorkChannel</span><span class="hljs-params">(id <span class="hljs-keyword">string</span>)</span> <span class="hljs-title">SelectWorker</span></span> &#123;w := SelectWorker&#123;id:id,c: <span class="hljs-built_in">make</span>(<span class="hljs-keyword">chan</span> <span class="hljs-keyword">int</span>),&#125;<span class="hljs-keyword">go</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> &#123;i := <span class="hljs-number">0</span><span class="hljs-keyword">for</span> &#123;time.Sleep(time.Duration(rand.Intn(<span class="hljs-number">1000</span>)) * time.Millisecond)w.c &lt;- ii++&#125;&#125;()<span class="hljs-keyword">return</span> w&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">selectWorks</span><span class="hljs-params">(id <span class="hljs-keyword">string</span>, rw SelectWorker)</span></span>  &#123;<span class="hljs-comment">// ä¸æ–­çš„ä»channelå–</span><span class="hljs-keyword">for</span>  &#123;fmt.Printf(<span class="hljs-string">&quot;channel %s from %s receive %d\n&quot;</span>, id, rw.id, &lt;-rw.c)time.Sleep(time.Second)&#125;&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">createSelectWorks</span><span class="hljs-params">(id <span class="hljs-keyword">string</span>)</span> <span class="hljs-title">SelectWorker</span></span> &#123;rw := SelectWorker&#123;c:  <span class="hljs-built_in">make</span>(<span class="hljs-keyword">chan</span> <span class="hljs-keyword">int</span>),&#125;<span class="hljs-keyword">go</span> selectWorks(id, rw)<span class="hljs-keyword">return</span> rw&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">channelSelectBlock</span><span class="hljs-params">()</span></span>  &#123;<span class="hljs-keyword">var</span> c1, c2 = generateChannel(), generateChannel()selectBlock(c1, c2)&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">channelSelectWork</span><span class="hljs-params">()</span></span>  &#123;<span class="hljs-keyword">var</span> sw1, sw2 = generateWorkChannel(<span class="hljs-string">&quot;send worker1&quot;</span>), generateWorkChannel(<span class="hljs-string">&quot;send worker2&quot;</span>)rw := createSelectWorks(<span class="hljs-string">&quot;receive work1&quot;</span>)selectWorkConditionBlock(rw, sw1, sw2)&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">selectDemo</span><span class="hljs-params">()</span></span>  &#123;<span class="hljs-comment">//var c1, c2 chan int</span><span class="hljs-comment">//selectNotBlock(c1, c2)</span><span class="hljs-comment">//channelSelectBlock()</span>channelSelectWork()&#125;</code></pre><h4 id="åŒæ­¥æœºåˆ¶"><a href="#åŒæ­¥æœºåˆ¶" class="headerlink" title="åŒæ­¥æœºåˆ¶"></a>åŒæ­¥æœºåˆ¶</h4><ul><li><code>WaitGroup</code></li></ul><p>åŸºäº<code>WaitGroup</code>å®ç°é€šä¿¡æ¥å…±äº«å†…å­˜</p><pre><code class="hljs go"><span class="hljs-comment">/**</span><span class="hljs-comment"> * Author: Wang P</span><span class="hljs-comment"> * Version: 1.0.0</span><span class="hljs-comment"> * Date: 2021/2/5 ä¸‹åˆ5:37</span><span class="hljs-comment"> * Description: åŸºäºWaitGroupå®ç°é€šä¿¡æ¥å…±äº«å†…å­˜</span><span class="hljs-comment"> **/</span><span class="hljs-keyword">package</span> goroutines<span class="hljs-keyword">import</span> (<span class="hljs-string">&quot;fmt&quot;</span><span class="hljs-string">&quot;sync&quot;</span>)<span class="hljs-keyword">type</span> WorkerWG <span class="hljs-keyword">struct</span> &#123;in <span class="hljs-keyword">chan</span> <span class="hljs-keyword">int</span>wg *sync.WaitGroup&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">doWorkWaitDone</span><span class="hljs-params">(id <span class="hljs-keyword">int</span>, w WorkerWG)</span></span>  &#123;<span class="hljs-comment">// æ¥æ”¶æ–¹åˆ¤æ–­channelä¸­æœ‰æ•°æ®å°±ä¸æ–­çš„ä»channelå–</span><span class="hljs-keyword">for</span> n := <span class="hljs-keyword">range</span> w.in&#123;fmt.Printf(<span class="hljs-string">&quot;channel %d receive %c\n&quot;</span>, id, n)w.wg.Done()&#125;&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">createWaitDoneWorkers</span><span class="hljs-params">(id <span class="hljs-keyword">int</span>, wg *sync.WaitGroup)</span> <span class="hljs-title">WorkerWG</span></span> &#123;w := WorkerWG&#123;in: <span class="hljs-built_in">make</span>(<span class="hljs-keyword">chan</span> <span class="hljs-keyword">int</span>),wg: wg,&#125;<span class="hljs-keyword">go</span> doWorkWaitDone(id, w)<span class="hljs-keyword">return</span> w&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">communicateWaitDone</span><span class="hljs-params">()</span></span>  &#123;<span class="hljs-comment">// åªèƒ½å‘æ•°æ®  chan&lt;- int å°†channel ä½œä¸ºå‡½æ•°è¿”å›å‚æ•°  å³ channelä¹Ÿæ˜¯ä¸€ç­‰å…¬æ°‘</span><span class="hljs-keyword">var</span> works [<span class="hljs-number">10</span>]WorkerWG<span class="hljs-keyword">var</span> wg sync.WaitGroup<span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++ &#123;works[i] = createWaitDoneWorkers(i, &amp;wg)&#125;<span class="hljs-comment">//wg.Add(20)</span><span class="hljs-keyword">for</span> i, worker := <span class="hljs-keyword">range</span> works&#123;worker.in &lt;- <span class="hljs-string">&#x27;a&#x27;</span> + iwg.Add(<span class="hljs-number">1</span>)&#125;<span class="hljs-keyword">for</span> i, worker := <span class="hljs-keyword">range</span> works&#123;worker.in &lt;- <span class="hljs-string">&#x27;A&#x27;</span> + iwg.Add(<span class="hljs-number">1</span>)&#125;wg.Wait()&#125;<span class="hljs-keyword">type</span> WorkerWG2 <span class="hljs-keyword">struct</span> &#123;in <span class="hljs-keyword">chan</span> <span class="hljs-keyword">int</span>done <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span>  // å‡½æ•°å¼ç¼–ç¨‹</span>&#125;<span class="hljs-comment">// WorkerWGå°è£…</span><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">doWorkWaitDone2</span><span class="hljs-params">(id <span class="hljs-keyword">int</span>, w WorkerWG2)</span></span>  &#123;<span class="hljs-comment">// æ¥æ”¶æ–¹åˆ¤æ–­channelä¸­æœ‰æ•°æ®å°±ä¸æ–­çš„ä»channelå–</span><span class="hljs-keyword">for</span> n := <span class="hljs-keyword">range</span> w.in&#123;fmt.Printf(<span class="hljs-string">&quot;channel %d receive %c\n&quot;</span>, id, n)w.done()&#125;&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">createWaitDoneWorkers2</span><span class="hljs-params">(id <span class="hljs-keyword">int</span>, wg *sync.WaitGroup)</span> <span class="hljs-title">WorkerWG2</span></span> &#123;w := WorkerWG2&#123;in: <span class="hljs-built_in">make</span>(<span class="hljs-keyword">chan</span> <span class="hljs-keyword">int</span>),done: <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> &#123;wg.Done()&#125;,&#125;<span class="hljs-keyword">go</span> doWorkWaitDone2(id, w)<span class="hljs-keyword">return</span> w&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">communicateWaitDone2</span><span class="hljs-params">()</span></span>  &#123;<span class="hljs-comment">// åªèƒ½å‘æ•°æ®  chan&lt;- int å°†channel ä½œä¸ºå‡½æ•°è¿”å›å‚æ•°  å³ channelä¹Ÿæ˜¯ä¸€ç­‰å…¬æ°‘</span><span class="hljs-keyword">var</span> works [<span class="hljs-number">10</span>]WorkerWG2<span class="hljs-keyword">var</span> wg sync.WaitGroup<span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++ &#123;works[i] = createWaitDoneWorkers2(i, &amp;wg)&#125;wg.Add(<span class="hljs-number">20</span>)<span class="hljs-keyword">for</span> i, worker := <span class="hljs-keyword">range</span> works&#123;worker.in &lt;- <span class="hljs-string">&#x27;a&#x27;</span> + i<span class="hljs-comment">//wg.Add(1)</span>&#125;<span class="hljs-keyword">for</span> i, worker := <span class="hljs-keyword">range</span> works&#123;worker.in &lt;- <span class="hljs-string">&#x27;A&#x27;</span> + i<span class="hljs-comment">//wg.Add(1)</span>&#125;wg.Wait()&#125;<span class="hljs-comment">// è¾“å‡º</span>channel <span class="hljs-number">7</span> receive hchannel <span class="hljs-number">5</span> receive fchannel <span class="hljs-number">6</span> receive gchannel <span class="hljs-number">0</span> receive achannel <span class="hljs-number">8</span> receive ichannel <span class="hljs-number">1</span> receive bchannel <span class="hljs-number">3</span> receive dchannel <span class="hljs-number">2</span> receive cchannel <span class="hljs-number">4</span> receive echannel <span class="hljs-number">9</span> receive jchannel <span class="hljs-number">9</span> receive Jchannel <span class="hljs-number">3</span> receive Dchannel <span class="hljs-number">0</span> receive Achannel <span class="hljs-number">5</span> receive Fchannel <span class="hljs-number">2</span> receive Cchannel <span class="hljs-number">4</span> receive Echannel <span class="hljs-number">6</span> receive Gchannel <span class="hljs-number">1</span> receive Bchannel <span class="hljs-number">7</span> receive Hchannel <span class="hljs-number">8</span> receive Ichannel <span class="hljs-number">9</span> receive jchannel <span class="hljs-number">6</span> receive gchannel <span class="hljs-number">8</span> receive ichannel <span class="hljs-number">4</span> receive echannel <span class="hljs-number">0</span> receive achannel <span class="hljs-number">0</span> receive Achannel <span class="hljs-number">2</span> receive cchannel <span class="hljs-number">3</span> receive dchannel <span class="hljs-number">5</span> receive fchannel <span class="hljs-number">1</span> receive bchannel <span class="hljs-number">1</span> receive Bchannel <span class="hljs-number">7</span> receive hchannel <span class="hljs-number">7</span> receive Hchannel <span class="hljs-number">3</span> receive Dchannel <span class="hljs-number">5</span> receive Fchannel <span class="hljs-number">4</span> receive Echannel <span class="hljs-number">6</span> receive Gchannel <span class="hljs-number">9</span> receive Jchannel <span class="hljs-number">2</span> receive Cchannel <span class="hljs-number">8</span> receive I</code></pre><ul><li><code>Mutux</code></li></ul><pre><code class="hljs go"><span class="hljs-comment">/**</span><span class="hljs-comment"> * Author: Wang P</span><span class="hljs-comment"> * Version: 1.0.0</span><span class="hljs-comment"> * Date: 2021/2/5 ä¸‹åˆ2:34</span><span class="hljs-comment"> * Description:</span><span class="hljs-comment"> **/</span><span class="hljs-keyword">package</span> goroutines<span class="hljs-keyword">import</span> (<span class="hljs-string">&quot;fmt&quot;</span><span class="hljs-string">&quot;sync&quot;</span><span class="hljs-string">&quot;time&quot;</span>)<span class="hljs-keyword">type</span> AtomicInt <span class="hljs-keyword">struct</span> &#123;value <span class="hljs-keyword">int</span>lock sync.Mutex&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(a *AtomicInt)</span> <span class="hljs-title">increase</span><span class="hljs-params">()</span></span>  &#123;fmt.Println(<span class="hljs-string">&quot;safe Increase&quot;</span>)<span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span>&#123;<span class="hljs-comment">//a.lock.Lock()</span><span class="hljs-comment">//defer a.lock.Unlock()</span>a.value++&#125;()&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(a *AtomicInt)</span> <span class="hljs-title">get</span><span class="hljs-params">()</span> <span class="hljs-title">int</span></span> &#123;<span class="hljs-comment">//a.lock.Lock()</span><span class="hljs-comment">//defer a.lock.Unlock()</span><span class="hljs-keyword">return</span> a.value&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">AtomicDemo</span><span class="hljs-params">()</span></span>  &#123; i := AtomicInt&#123;&#125; i.increase() <span class="hljs-keyword">go</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> &#123; i.increase() &#125;()time.Sleep(time.Millisecond) fmt.Println(i.get())&#125;<span class="hljs-comment">// è¾“å‡º</span>xxx@xxxdeMacBook-Pro î‚° ~/Projects/golang/src/offer/note î‚° î‚  master Â±âœš î‚° <span class="hljs-keyword">go</span> run -race main.<span class="hljs-keyword">go</span>safe Increasesafe Increase==================WARNING: DATA RACERead at <span class="hljs-number">0x00c000134010</span> by main goroutine:  offer/note/goroutines.(*AtomicInt).get()      /Users/wangpeng/Projects/golang/src/offer/note/goroutines/atomic.<span class="hljs-keyword">go</span>:<span class="hljs-number">33</span> +<span class="hljs-number">0xab</span>  offer/note/goroutines.AtomicDemo()      /Users/wangpeng/Projects/golang/src/offer/note/goroutines/atomic.<span class="hljs-keyword">go</span>:<span class="hljs-number">43</span> +<span class="hljs-number">0xb4</span>  main.main()      /Users/wangpeng/Projects/golang/src/offer/note/main.<span class="hljs-keyword">go</span>:<span class="hljs-number">75</span> +<span class="hljs-number">0x2f</span>Previous write at <span class="hljs-number">0x00c000134010</span> by goroutine <span class="hljs-number">7</span>:  offer/note/goroutines.(*AtomicInt).increase.func1()      /Users/wangpeng/Projects/golang/src/offer/note/goroutines/atomic.<span class="hljs-keyword">go</span>:<span class="hljs-number">26</span> +<span class="hljs-number">0xbd</span>  offer/note/goroutines.(*AtomicInt).increase()      /Users/wangpeng/Projects/golang/src/offer/note/goroutines/atomic.<span class="hljs-keyword">go</span>:<span class="hljs-number">27</span> +<span class="hljs-number">0x9e</span>  offer/note/goroutines.AtomicDemo.func1()      /Users/wangpeng/Projects/golang/src/offer/note/goroutines/atomic.<span class="hljs-keyword">go</span>:<span class="hljs-number">40</span> +<span class="hljs-number">0x38</span>Goroutine <span class="hljs-number">7</span> (finished) created at:  offer/note/goroutines.AtomicDemo()      /Users/wangpeng/Projects/golang/src/offer/note/goroutines/atomic.<span class="hljs-keyword">go</span>:<span class="hljs-number">39</span> +<span class="hljs-number">0x90</span>  main.main()      /Users/wangpeng/Projects/golang/src/offer/note/main.<span class="hljs-keyword">go</span>:<span class="hljs-number">75</span> +<span class="hljs-number">0x2f</span>==================<span class="hljs-number">2</span>Found <span class="hljs-number">1</span> data race(s)exit status <span class="hljs-number">66</span></code></pre><pre><code class="hljs go"><span class="hljs-comment">/**</span><span class="hljs-comment"> * Author: Wang P</span><span class="hljs-comment"> * Version: 1.0.0</span><span class="hljs-comment"> * Date: 2021/2/5 ä¸‹åˆ2:34</span><span class="hljs-comment"> * Description:</span><span class="hljs-comment"> **/</span><span class="hljs-keyword">package</span> goroutines<span class="hljs-keyword">import</span> (<span class="hljs-string">&quot;fmt&quot;</span><span class="hljs-string">&quot;sync&quot;</span><span class="hljs-string">&quot;time&quot;</span>)<span class="hljs-keyword">type</span> AtomicInt <span class="hljs-keyword">struct</span> &#123;value <span class="hljs-keyword">int</span>lock sync.Mutex&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(a *AtomicInt)</span> <span class="hljs-title">increase</span><span class="hljs-params">()</span></span>  &#123;fmt.Println(<span class="hljs-string">&quot;safe Increase&quot;</span>)<span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span>&#123;a.lock.Lock()<span class="hljs-keyword">defer</span> a.lock.Unlock()a.value++&#125;()&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(a *AtomicInt)</span> <span class="hljs-title">get</span><span class="hljs-params">()</span> <span class="hljs-title">int</span></span> &#123;a.lock.Lock()<span class="hljs-keyword">defer</span> a.lock.Unlock()<span class="hljs-keyword">return</span> a.value&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">AtomicDemo</span><span class="hljs-params">()</span></span>  &#123; i := AtomicInt&#123;&#125; i.increase() <span class="hljs-keyword">go</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> &#123; i.increase() &#125;()time.Sleep(time.Millisecond) fmt.Println(i.get())&#125;<span class="hljs-comment">// è¾“å‡º</span>xxx@xxxdeMacBook-Pro î‚° ~/Projects/golang/src/offer/note î‚° î‚  master Â±âœš î‚° <span class="hljs-keyword">go</span> run -race main.<span class="hljs-keyword">go</span>safe Increasesafe Increase<span class="hljs-number">2</span></code></pre><ul><li><code>Cond</code></li></ul>]]></content>
    
    
    <categories>
      
      <category>Golang</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Go</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€windowsã€‘åŸºäºDjangoæ„å»ºä¸å¼€å‘åœ¨çº¿å­¦ä¹ é¡¹ç›®</title>
    <link href="/2020/06/14/django-web-windows/"/>
    <url>/2020/06/14/django-web-windows/</url>
    
    <content type="html"><![CDATA[<p><img src="/images/django-web/logo.jpg"><a id="more"></a> </p><h3 id="é¡¹ç›®åˆ›å»º"><a href="#é¡¹ç›®åˆ›å»º" class="headerlink" title="é¡¹ç›®åˆ›å»º"></a>é¡¹ç›®åˆ›å»º</h3><p><strong>1.å®‰è£…ç¬¬ä¸‰æ–¹åº“Django</strong></p><p><img src="/images/django-web/1.png"></p><p><strong>2.pycharmåˆ›å»ºDjangoé¡¹ç›®</strong></p><p><img src="/images/django-web/2.png"></p><h3 id="æ•°æ®åº“ç¯å¢ƒä¸èµ„æºå±‚è®¾ç½®"><a href="#æ•°æ®åº“ç¯å¢ƒä¸èµ„æºå±‚è®¾ç½®" class="headerlink" title="æ•°æ®åº“ç¯å¢ƒä¸èµ„æºå±‚è®¾ç½®"></a>æ•°æ®åº“ç¯å¢ƒä¸èµ„æºå±‚è®¾ç½®</h3><p><strong>3.å®‰è£…mysqlç¬¬ä¸‰æ–¹åº“</strong></p><p><img src="/images/django-web/3.png"></p><p><strong>4.é…ç½®mysqlæ•°æ®åº“ç¯å¢ƒ</strong></p><p><img src="/images/django-web/4.png"></p><p><strong>5.ç”Ÿæˆdjangoé»˜è®¤æ•°æ®è¡¨</strong></p><p>tool â€“&gt;Run manage.py task</p><pre><code class="hljs ebnf"><span class="hljs-attribute">makemigrations</span> <span class="hljs-attribute">migrate</span></code></pre><p><img src="/images/django-web/5.png"></p><p>æŸ¥çœ‹æ•°æ®è¡¨ï¼Œä¼šå‘ç°ç”Ÿæˆäº†djangoçš„æ•°æ®è¡¨</p><p><img src="/images/django-web/5-1.png"></p><p><strong>6.åˆ›å»ºä¸€ä¸ªapp</strong></p><p>startapp user</p><p><img src="/images/django-web/6-1.png"></p><p>é¡¹ç›®ç›®å½•ä¸‹ä¼šç”Ÿæˆ</p><p><img src="/images/django-web/6-2.png"></p><p><strong>7.è‡ªå®šä¹‰userè¡¨</strong></p><p>Djangoç”Ÿæˆçš„userè¡¨</p><ul><li>id: ä¸»é”®, password å¯†ç , last_login Djangoè‡ªåŠ¨è®°å½•ç”¨æˆ·æœ€åç™»å½•æ—¶é—´,ã€‚</li><li>is_superuser è¡¨æ˜ç”¨æˆ·æ˜¯å¦æ˜¯è¶…çº§ç”¨æˆ·(åå°ç®¡ç†ä¼šç”¨åˆ°)ã€‚</li><li>username ç”¨æˆ·åå­—æ®µä¸è¦éšä¾¿æ”¹åŠ¨, email é‚®ç®±,</li><li>is_staff è¡¨ç¤ºæ˜¯å¦æ˜¯å‘˜å·¥(åå°ç®¡ç†ä¼šç”¨åˆ°)ã€‚</li><li>is_active ç”¨æˆ·æ˜¯å¦æ˜¯æ¿€æ´»çŠ¶æ€, date_joined æ³¨å†Œæ—¶é—´ã€‚</li></ul><p>è¿™äº›å¾€å¾€ä¸èƒ½æ»¡è¶³æˆ‘ä»¬è‡ªèº«çš„éœ€æ±‚ï¼Œå› æ­¤éœ€è¦è‡ªå®šä¹‰userè¡¨ï¼Œåœ¨userä¸‹çš„models.pyæ–‡ä»¶æ·»åŠ ä»£ç </p><pre><code class="hljs python"><span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> datetime<span class="hljs-keyword">from</span> django.db <span class="hljs-keyword">import</span> models<span class="hljs-keyword">from</span> django.contrib.auth.models <span class="hljs-keyword">import</span> AbstractUser<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TbUser</span>(<span class="hljs-params">AbstractUser</span>):</span>    nickname = models.CharField(null=<span class="hljs-literal">True</span>, max_length=<span class="hljs-number">50</span>, verbose_name=<span class="hljs-string">&#x27;æ˜µç§°&#x27;</span>,)    birthday = models.DateField(null=<span class="hljs-literal">True</span>, verbose_name=<span class="hljs-string">&#x27;ç”Ÿæ—¥&#x27;</span>)    gender = models.IntegerField(choices=((<span class="hljs-number">1</span>, <span class="hljs-string">&#x27;ç”·&#x27;</span>), (<span class="hljs-number">0</span>, <span class="hljs-string">&#x27;å¥³&#x27;</span>)), verbose_name=<span class="hljs-string">&#x27;æ€§åˆ«&#x27;</span>, default=<span class="hljs-number">1</span>)    address = models.CharField(null=<span class="hljs-literal">True</span>, max_length=<span class="hljs-number">200</span>, verbose_name=<span class="hljs-string">&#x27;åœ°å€&#x27;</span>)    phone = models.CharField(null=<span class="hljs-literal">True</span>, blank=<span class="hljs-literal">True</span>, max_length=<span class="hljs-number">11</span>, verbose_name=<span class="hljs-string">&#x27;æ‰‹æœº&#x27;</span>)    head = models.ImageField(upload_to=<span class="hljs-string">&#x27;image/%Y/%m&#x27;</span>, max_length=<span class="hljs-number">100</span>, verbose_name=<span class="hljs-string">&#x27;å¤´åƒ&#x27;</span>, default=<span class="hljs-string">&#x27;image/default_m.png&#x27;</span>) <span class="hljs-comment"># æ³¨æ„è¿™é‡Œçš„headä½¿ç”¨ImageFieldï¼Œéœ€è¦å®‰è£…ä¾èµ–åº“pip install pillow</span>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Meta</span>:</span>        db_table = <span class="hljs-string">&#x27;tb_user&#x27;</span>        verbose_name = <span class="hljs-string">&#x27;ç”¨æˆ·ä¿¡æ¯&#x27;</span>        verbose_name_plural = verbose_name    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__str__</span>(<span class="hljs-params">self</span>):</span>        <span class="hljs-keyword">return</span> self.username</code></pre><p>ä¿®æ”¹settings.pyæ–‡ä»¶</p><p><img src="/images/django-web/7-1.png"></p><p>åœ¨è¿™é‡Œï¼Œdef <strong>str</strong>(self)ï¼šæ–¹æ³•åœ¨python3.xç‰ˆæœ¬ä½¿ç”¨ï¼Œç”¨äºåå°å±•ç¤ºæ ·å¼æ˜¯æ˜¾ç¤ºçš„æ˜¯ç”¨æˆ·åã€‚ä¿å­˜åï¼Œä½¿ç”¨djangoæ•ç²é‡æ–°ç”Ÿæˆè¡¨</p><p>tool â€“&gt;Run manage.py task</p><pre><code class="hljs routeros">makemigrations<span class="hljs-built_in"> user </span>migrate user</code></pre><p>åˆ›å»ºåå°ç®¡ç†ç”¨æˆ·</p><pre><code class="hljs ebnf"><span class="hljs-attribute">createsuperuser</span></code></pre><p>å¡«å†™ç”¨æˆ·åã€é‚®ç®±å’Œå¯†ç </p><p><img src="/images/django-web/7-2.png"></p><p>å¯ä»¥æŸ¥çœ‹åˆ°æ•°æ®åº“ä¸­æ–°å¢ä¸€æ¡æ•°æ®</p><p><img src="/images/django-web/7-3.png"></p><p>è¿™æ ·å°±å¯ä»¥ç™»å½•åå°ç®¡ç†é¡µé¢äº†</p><h3 id="åå°é›†æˆ"><a href="#åå°é›†æˆ" class="headerlink" title="åå°é›†æˆ"></a>åå°é›†æˆ</h3><p><strong>8.é›†æˆxadminç»„ä»¶</strong></p><p>python3.xæ— æ³•ç›´æ¥ä½¿ç”¨å®‰è£…åŒ…</p><pre><code class="hljs awk">pip install git+git:<span class="hljs-regexp">//gi</span>thub.com<span class="hljs-regexp">/sshwsfc/</span>xadmin.git@django2</code></pre><p>æˆ–è€…è®¿é—®<code>https://github.com/sshwsfc/xadmin/tree/django2 </code>ï¼Œ</p><p>æˆ–<code>git clone -b django2  https://github.com/sshwsfc/xadmin.git </code>å°†xadminç›®å½•ä¸‹æ–‡ä»¶æ‹·è´åˆ°é¡¹ç›®ä¸‹</p><p><img src="/images/django-web/8-1.png"></p><p>åœ¨settings.pyæ–‡ä»¶ä¸‹æ·»åŠ ç›¸åº”é…ç½®</p><p><img src="/images/django-web/8-2.png"></p><p>æŠŠurlsä¸­é»˜è®¤adminæŒ‡å‘Xadmin</p><pre><code class="hljs python"><span class="hljs-comment"># å¯¼å…¥ xadminï¼Œæ›¿æ¢admin</span><span class="hljs-keyword">import</span> xadminurlpatterns = [    path(<span class="hljs-string">&#x27;xadmin/&#x27;</span>, xadmin.site.urls),, <span class="hljs-comment"># django2ä¸­ä¹Ÿå¯ä»¥æ˜¯ url(r&#x27;^xadmin/&#x27;, xadmin.site.urls)</span>]</code></pre><p>ç‚¹å‡»Tools èœå•ä¸‹ Run manage.py Task</p><pre><code class="hljs ebnf"><span class="hljs-attribute">makemigrations</span> <span class="hljs-attribute">migrate</span></code></pre><p>è®¿é—®<a href="http://127.0.0.1/admin/">http://127.0.0.1/admin/</a></p><p><img src="/images/django-web/8-3.png"></p><p>æ–°å»ºuser/adminx.pyï¼Œè¿›è¡Œapp modelæ³¨å†Œï¼š</p><pre><code class="hljs python"><span class="hljs-comment"># åˆ›å»ºxadminçš„å…¨å±€ç®¡ç†å™¨å¹¶ä¸viewç»‘å®šã€‚</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BaseSetting</span>(<span class="hljs-params"><span class="hljs-built_in">object</span></span>):</span>    <span class="hljs-comment"># å¼€å¯ä¸»é¢˜åŠŸèƒ½</span>    enable_themes = <span class="hljs-literal">True</span>    use_bootswatch = <span class="hljs-literal">True</span><span class="hljs-comment"># xadmin å…¨å±€é…ç½®å‚æ•°ä¿¡æ¯è®¾ç½®</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">GlobalSettings</span>(<span class="hljs-params"><span class="hljs-built_in">object</span></span>):</span>    site_title = <span class="hljs-string">&quot;supe-waæ…•è¯¾å°ç«™&quot;</span>    site_footer = <span class="hljs-string">&quot;supe-waæ…•è¯¾å°ç«™|åå°ç®¡ç†ç³»ç»Ÿ&quot;</span>    <span class="hljs-comment"># æ”¶èµ·èœå•</span>    menu_style = <span class="hljs-string">&quot;accordion&quot;</span>    <span class="hljs-comment"># è‡ªå®šä¹‰å¯¼èˆªæ¥¼ç›®å½•</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_site_menu</span>(<span class="hljs-params">self</span>):</span>        <span class="hljs-keyword">return</span> (            &#123;<span class="hljs-string">&#x27;title&#x27;</span>: <span class="hljs-string">&#x27;è¯¾ç¨‹ä¿¡æ¯ç®¡ç†&#x27;</span>, <span class="hljs-string">&#x27;menus&#x27;</span>: (                &#123;<span class="hljs-string">&#x27;title&#x27;</span>: <span class="hljs-string">&#x27;è¯¾ç¨‹ä¿¡æ¯ç®¡ç†&#x27;</span>, <span class="hljs-string">&#x27;url&#x27;</span>: self.get_model_url(TbCourse, <span class="hljs-string">&#x27;changelist&#x27;</span>)&#125;,                &#123;<span class="hljs-string">&#x27;title&#x27;</span>: <span class="hljs-string">&#x27;ç« èŠ‚ä¿¡æ¯ç®¡ç†&#x27;</span>, <span class="hljs-string">&#x27;url&#x27;</span>: self.get_model_url(TbCourseLesson, <span class="hljs-string">&#x27;changelist&#x27;</span>)&#125;,                &#123;<span class="hljs-string">&#x27;title&#x27;</span>: <span class="hljs-string">&#x27;è§†é¢‘ä¿¡æ¯ç®¡ç†&#x27;</span>, <span class="hljs-string">&#x27;url&#x27;</span>: self.get_model_url(TbCourseVideo, <span class="hljs-string">&#x27;changelist&#x27;</span>)&#125;,                &#123;<span class="hljs-string">&#x27;title&#x27;</span>: <span class="hljs-string">&#x27;è¯¾ç¨‹èµ„æºç®¡ç†&#x27;</span>, <span class="hljs-string">&#x27;url&#x27;</span>: self.get_model_url(TbCourseResource, <span class="hljs-string">&#x27;changelist&#x27;</span>)&#125;,                &#123;<span class="hljs-string">&#x27;title&#x27;</span>: <span class="hljs-string">&#x27;è¯¾ç¨‹è¯„è®ºç®¡ç†&#x27;</span>, <span class="hljs-string">&#x27;url&#x27;</span>: self.get_model_url(TbCourseComment, <span class="hljs-string">&#x27;changelist&#x27;</span>)&#125;,            )&#125;,            &#123;<span class="hljs-string">&#x27;title&#x27;</span>: <span class="hljs-string">&#x27;æœºæ„ä¿¡æ¯ç®¡ç†&#x27;</span>, <span class="hljs-string">&#x27;menus&#x27;</span>: (                &#123;<span class="hljs-string">&#x27;title&#x27;</span>: <span class="hljs-string">&#x27;åŸå¸‚ä¿¡æ¯ç®¡ç†&#x27;</span>, <span class="hljs-string">&#x27;url&#x27;</span>: self.get_model_url(TcCityDict, <span class="hljs-string">&#x27;changelist&#x27;</span>)&#125;,                &#123;<span class="hljs-string">&#x27;title&#x27;</span>: <span class="hljs-string">&#x27;æœºæ„ä¿¡æ¯ç®¡ç†&#x27;</span>, <span class="hljs-string">&#x27;url&#x27;</span>: self.get_model_url(TbOrg, <span class="hljs-string">&#x27;changelist&#x27;</span>)&#125;,                &#123;<span class="hljs-string">&#x27;title&#x27;</span>: <span class="hljs-string">&#x27;æœºæ„è®²å¸ˆç®¡ç†&#x27;</span>, <span class="hljs-string">&#x27;url&#x27;</span>: self.get_model_url(TbOrgTeacher, <span class="hljs-string">&#x27;changelist&#x27;</span>)&#125;,            )&#125;,            &#123;<span class="hljs-string">&#x27;title&#x27;</span>: <span class="hljs-string">&#x27;ç”¨æˆ·ä¿¡æ¯ç®¡ç†&#x27;</span>, <span class="hljs-string">&#x27;menus&#x27;</span>: (                &#123;<span class="hljs-string">&#x27;title&#x27;</span>: <span class="hljs-string">&#x27;ç”¨æˆ·ä¿¡æ¯ç®¡ç†&#x27;</span>, <span class="hljs-string">&#x27;url&#x27;</span>: self.get_model_url(TbUser, <span class="hljs-string">&#x27;changelist&#x27;</span>)&#125;,                &#123;<span class="hljs-string">&#x27;title&#x27;</span>: <span class="hljs-string">&#x27;ç”¨æˆ·éªŒè¯ç®¡ç†&#x27;</span>, <span class="hljs-string">&#x27;url&#x27;</span>: self.get_model_url(TbEmailVerifyRecord, <span class="hljs-string">&#x27;changelist&#x27;</span>)&#125;,                &#123;<span class="hljs-string">&#x27;title&#x27;</span>: <span class="hljs-string">&#x27;ç”¨æˆ·è¯¾ç¨‹ç®¡ç†&#x27;</span>, <span class="hljs-string">&#x27;url&#x27;</span>: self.get_model_url(TbUserCourse, <span class="hljs-string">&#x27;changelist&#x27;</span>)&#125;,                &#123;<span class="hljs-string">&#x27;title&#x27;</span>: <span class="hljs-string">&#x27;ç”¨æˆ·æ”¶è—ç®¡ç†&#x27;</span>, <span class="hljs-string">&#x27;url&#x27;</span>: self.get_model_url(TbUserFavorite, <span class="hljs-string">&#x27;changelist&#x27;</span>)&#125;,                &#123;<span class="hljs-string">&#x27;title&#x27;</span>: <span class="hljs-string">&#x27;ç”¨æˆ·æ¶ˆæ¯ç®¡ç†&#x27;</span>, <span class="hljs-string">&#x27;url&#x27;</span>: self.get_model_url(TbUserMessage, <span class="hljs-string">&#x27;changelist&#x27;</span>)&#125;,            )&#125;,            &#123;<span class="hljs-string">&#x27;title&#x27;</span>: <span class="hljs-string">&#x27;ç³»ç»Ÿä¿¡æ¯ç®¡ç†&#x27;</span>, <span class="hljs-string">&#x27;menus&#x27;</span>: (                &#123;<span class="hljs-string">&#x27;title&#x27;</span>: <span class="hljs-string">&#x27;ç”¨æˆ·å’¨è¯¢&#x27;</span>, <span class="hljs-string">&#x27;url&#x27;</span>: self.get_model_url(TbUserAsk, <span class="hljs-string">&#x27;changelist&#x27;</span>)&#125;,                &#123;<span class="hljs-string">&#x27;title&#x27;</span>: <span class="hljs-string">&#x27;é¦–é¡µè½®æ’­&#x27;</span>, <span class="hljs-string">&#x27;url&#x27;</span>: self.get_model_url(TcBanner, <span class="hljs-string">&#x27;changelist&#x27;</span>)&#125;,                &#123;<span class="hljs-string">&#x27;title&#x27;</span>: <span class="hljs-string">&#x27;ç”¨æˆ·åˆ†ç»„&#x27;</span>, <span class="hljs-string">&#x27;url&#x27;</span>: self.get_model_url(Group, <span class="hljs-string">&#x27;changelist&#x27;</span>)&#125;,                &#123;<span class="hljs-string">&#x27;title&#x27;</span>: <span class="hljs-string">&#x27;ç”¨æˆ·æƒé™&#x27;</span>, <span class="hljs-string">&#x27;url&#x27;</span>: self.get_model_url(Permission, <span class="hljs-string">&#x27;changelist&#x27;</span>)&#125;,                &#123;<span class="hljs-string">&#x27;title&#x27;</span>: <span class="hljs-string">&#x27;æ—¥å¿—è®°å½•&#x27;</span>, <span class="hljs-string">&#x27;url&#x27;</span>: self.get_model_url(Log, <span class="hljs-string">&#x27;changelist&#x27;</span>)&#125;,            )&#125;,)            <span class="hljs-comment"># å°†å…¨å±€é…ç½®ç®¡ç†ä¸viewç»‘å®šæ³¨å†Œ</span>xadmin.site.register(views.CommAdminView, GlobalSettings)xadmin.site.register(views.BaseAdminView, BaseSetting)</code></pre><p>ç™»å½•å</p><p><img src="/images/django-web/8-4.png"></p>]]></content>
    
    
    <categories>
      
      <category>Python</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Python</tag>
      
      <tag>Windows</tag>
      
      <tag>Django</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
